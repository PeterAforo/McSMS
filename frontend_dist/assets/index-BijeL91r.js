(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const o of c.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function a(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(l){if(l.ep)return;l.ep=!0;const c=a(l);fetch(l.href,c)}})();var HH=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function QC(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var V0={exports:{}},Ox={};var Zv;function RC(){if(Zv)return Ox;Zv=1;var t=Symbol.for("react.transitional.element"),s=Symbol.for("react.fragment");function a(r,l,c){var o=null;if(c!==void 0&&(o=""+c),l.key!==void 0&&(o=""+l.key),"key"in l){c={};for(var m in l)m!=="key"&&(c[m]=l[m])}else c=l;return l=c.ref,{$$typeof:t,type:r,key:o,ref:l!==void 0?l:null,props:c}}return Ox.Fragment=s,Ox.jsx=a,Ox.jsxs=a,Ox}var eN;function MC(){return eN||(eN=1,V0.exports=RC()),V0.exports}var e=MC(),Y0={exports:{}},Gs={};var tN;function IC(){if(tN)return Gs;tN=1;var t=Symbol.for("react.transitional.element"),s=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),o=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),N=Symbol.iterator;function f(I){return I===null||typeof I!="object"?null:(I=N&&I[N]||I["@@iterator"],typeof I=="function"?I:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,U={};function D(I,H,ae){this.props=I,this.context=H,this.refs=U,this.updater=ae||y}D.prototype.isReactComponent={},D.prototype.setState=function(I,H){if(typeof I!="object"&&typeof I!="function"&&I!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,I,H,"setState")},D.prototype.forceUpdate=function(I){this.updater.enqueueForceUpdate(this,I,"forceUpdate")};function M(){}M.prototype=D.prototype;function K(I,H,ae){this.props=I,this.context=H,this.refs=U,this.updater=ae||y}var $=K.prototype=new M;$.constructor=K,v($,D.prototype),$.isPureReactComponent=!0;var P=Array.isArray;function se(){}var z={H:null,A:null,T:null,S:null},R=Object.prototype.hasOwnProperty;function j(I,H,ae){var k=ae.ref;return{$$typeof:t,type:I,key:H,ref:k!==void 0?k:null,props:ae}}function T(I,H){return j(I.type,H,I.props)}function Q(I){return typeof I=="object"&&I!==null&&I.$$typeof===t}function E(I){var H={"=":"=0",":":"=2"};return"$"+I.replace(/[=:]/g,function(ae){return H[ae]})}var te=/\/+/g;function C(I,H){return typeof I=="object"&&I!==null&&I.key!=null?E(""+I.key):H.toString(36)}function O(I){switch(I.status){case"fulfilled":return I.value;case"rejected":throw I.reason;default:switch(typeof I.status=="string"?I.then(se,se):(I.status="pending",I.then(function(H){I.status==="pending"&&(I.status="fulfilled",I.value=H)},function(H){I.status==="pending"&&(I.status="rejected",I.reason=H)})),I.status){case"fulfilled":return I.value;case"rejected":throw I.reason}}throw I}function V(I,H,ae,k,B){var w=typeof I;(w==="undefined"||w==="boolean")&&(I=null);var oe=!1;if(I===null)oe=!0;else switch(w){case"bigint":case"string":case"number":oe=!0;break;case"object":switch(I.$$typeof){case t:case s:oe=!0;break;case A:return oe=I._init,V(oe(I._payload),H,ae,k,B)}}if(oe)return B=B(I),oe=k===""?"."+C(I,0):k,P(B)?(ae="",oe!=null&&(ae=oe.replace(te,"$&/")+"/"),V(B,H,ae,"",function(je){return je})):B!=null&&(Q(B)&&(B=T(B,ae+(B.key==null||I&&I.key===B.key?"":(""+B.key).replace(te,"$&/")+"/")+oe)),H.push(B)),1;oe=0;var ne=k===""?".":k+":";if(P(I))for(var Fe=0;Fe<I.length;Fe++)k=I[Fe],w=ne+C(k,Fe),oe+=V(k,H,ae,w,B);else if(Fe=f(I),typeof Fe=="function")for(I=Fe.call(I),Fe=0;!(k=I.next()).done;)k=k.value,w=ne+C(k,Fe++),oe+=V(k,H,ae,w,B);else if(w==="object"){if(typeof I.then=="function")return V(O(I),H,ae,k,B);throw H=String(I),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(I).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.")}return oe}function re(I,H,ae){if(I==null)return I;var k=[],B=0;return V(I,k,"","",function(w){return H.call(ae,w,B++)}),k}function ge(I){if(I._status===-1){var H=I._result;H=H(),H.then(function(ae){(I._status===0||I._status===-1)&&(I._status=1,I._result=ae)},function(ae){(I._status===0||I._status===-1)&&(I._status=2,I._result=ae)}),I._status===-1&&(I._status=0,I._result=H)}if(I._status===1)return I._result.default;throw I._result}var xe=typeof reportError=="function"?reportError:function(I){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var H=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof I=="object"&&I!==null&&typeof I.message=="string"?String(I.message):String(I),error:I});if(!window.dispatchEvent(H))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",I);return}console.error(I)},Z={map:re,forEach:function(I,H,ae){re(I,function(){H.apply(this,arguments)},ae)},count:function(I){var H=0;return re(I,function(){H++}),H},toArray:function(I){return re(I,function(H){return H})||[]},only:function(I){if(!Q(I))throw Error("React.Children.only expected to receive a single React element child.");return I}};return Gs.Activity=g,Gs.Children=Z,Gs.Component=D,Gs.Fragment=a,Gs.Profiler=l,Gs.PureComponent=K,Gs.StrictMode=r,Gs.Suspense=u,Gs.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=z,Gs.__COMPILER_RUNTIME={__proto__:null,c:function(I){return z.H.useMemoCache(I)}},Gs.cache=function(I){return function(){return I.apply(null,arguments)}},Gs.cacheSignal=function(){return null},Gs.cloneElement=function(I,H,ae){if(I==null)throw Error("The argument must be a React element, but you passed "+I+".");var k=v({},I.props),B=I.key;if(H!=null)for(w in H.key!==void 0&&(B=""+H.key),H)!R.call(H,w)||w==="key"||w==="__self"||w==="__source"||w==="ref"&&H.ref===void 0||(k[w]=H[w]);var w=arguments.length-2;if(w===1)k.children=ae;else if(1<w){for(var oe=Array(w),ne=0;ne<w;ne++)oe[ne]=arguments[ne+2];k.children=oe}return j(I.type,B,k)},Gs.createContext=function(I){return I={$$typeof:o,_currentValue:I,_currentValue2:I,_threadCount:0,Provider:null,Consumer:null},I.Provider=I,I.Consumer={$$typeof:c,_context:I},I},Gs.createElement=function(I,H,ae){var k,B={},w=null;if(H!=null)for(k in H.key!==void 0&&(w=""+H.key),H)R.call(H,k)&&k!=="key"&&k!=="__self"&&k!=="__source"&&(B[k]=H[k]);var oe=arguments.length-2;if(oe===1)B.children=ae;else if(1<oe){for(var ne=Array(oe),Fe=0;Fe<oe;Fe++)ne[Fe]=arguments[Fe+2];B.children=ne}if(I&&I.defaultProps)for(k in oe=I.defaultProps,oe)B[k]===void 0&&(B[k]=oe[k]);return j(I,w,B)},Gs.createRef=function(){return{current:null}},Gs.forwardRef=function(I){return{$$typeof:m,render:I}},Gs.isValidElement=Q,Gs.lazy=function(I){return{$$typeof:A,_payload:{_status:-1,_result:I},_init:ge}},Gs.memo=function(I,H){return{$$typeof:x,type:I,compare:H===void 0?null:H}},Gs.startTransition=function(I){var H=z.T,ae={};z.T=ae;try{var k=I(),B=z.S;B!==null&&B(ae,k),typeof k=="object"&&k!==null&&typeof k.then=="function"&&k.then(se,xe)}catch(w){xe(w)}finally{H!==null&&ae.types!==null&&(H.types=ae.types),z.T=H}},Gs.unstable_useCacheRefresh=function(){return z.H.useCacheRefresh()},Gs.use=function(I){return z.H.use(I)},Gs.useActionState=function(I,H,ae){return z.H.useActionState(I,H,ae)},Gs.useCallback=function(I,H){return z.H.useCallback(I,H)},Gs.useContext=function(I){return z.H.useContext(I)},Gs.useDebugValue=function(){},Gs.useDeferredValue=function(I,H){return z.H.useDeferredValue(I,H)},Gs.useEffect=function(I,H){return z.H.useEffect(I,H)},Gs.useEffectEvent=function(I){return z.H.useEffectEvent(I)},Gs.useId=function(){return z.H.useId()},Gs.useImperativeHandle=function(I,H,ae){return z.H.useImperativeHandle(I,H,ae)},Gs.useInsertionEffect=function(I,H){return z.H.useInsertionEffect(I,H)},Gs.useLayoutEffect=function(I,H){return z.H.useLayoutEffect(I,H)},Gs.useMemo=function(I,H){return z.H.useMemo(I,H)},Gs.useOptimistic=function(I,H){return z.H.useOptimistic(I,H)},Gs.useReducer=function(I,H,ae){return z.H.useReducer(I,H,ae)},Gs.useRef=function(I){return z.H.useRef(I)},Gs.useState=function(I){return z.H.useState(I)},Gs.useSyncExternalStore=function(I,H,ae){return z.H.useSyncExternalStore(I,H,ae)},Gs.useTransition=function(){return z.H.useTransition()},Gs.version="19.2.0",Gs}var sN;function ty(){return sN||(sN=1,Y0.exports=IC()),Y0.exports}var h=ty();const Mp=QC(h);var W0={exports:{}},zx={},X0={exports:{}},J0={};var aN;function $C(){return aN||(aN=1,(function(t){function s(V,re){var ge=V.length;V.push(re);e:for(;0<ge;){var xe=ge-1>>>1,Z=V[xe];if(0<l(Z,re))V[xe]=re,V[ge]=Z,ge=xe;else break e}}function a(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var re=V[0],ge=V.pop();if(ge!==re){V[0]=ge;e:for(var xe=0,Z=V.length,I=Z>>>1;xe<I;){var H=2*(xe+1)-1,ae=V[H],k=H+1,B=V[k];if(0>l(ae,ge))k<Z&&0>l(B,ae)?(V[xe]=B,V[k]=ge,xe=k):(V[xe]=ae,V[H]=ge,xe=H);else if(k<Z&&0>l(B,ge))V[xe]=B,V[k]=ge,xe=k;else break e}}return re}function l(V,re){var ge=V.sortIndex-re.sortIndex;return ge!==0?ge:V.id-re.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;t.unstable_now=function(){return c.now()}}else{var o=Date,m=o.now();t.unstable_now=function(){return o.now()-m}}var u=[],x=[],A=1,g=null,N=3,f=!1,y=!1,v=!1,U=!1,D=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,K=typeof setImmediate<"u"?setImmediate:null;function $(V){for(var re=a(x);re!==null;){if(re.callback===null)r(x);else if(re.startTime<=V)r(x),re.sortIndex=re.expirationTime,s(u,re);else break;re=a(x)}}function P(V){if(v=!1,$(V),!y)if(a(u)!==null)y=!0,se||(se=!0,E());else{var re=a(x);re!==null&&O(P,re.startTime-V)}}var se=!1,z=-1,R=5,j=-1;function T(){return U?!0:!(t.unstable_now()-j<R)}function Q(){if(U=!1,se){var V=t.unstable_now();j=V;var re=!0;try{e:{y=!1,v&&(v=!1,M(z),z=-1),f=!0;var ge=N;try{t:{for($(V),g=a(u);g!==null&&!(g.expirationTime>V&&T());){var xe=g.callback;if(typeof xe=="function"){g.callback=null,N=g.priorityLevel;var Z=xe(g.expirationTime<=V);if(V=t.unstable_now(),typeof Z=="function"){g.callback=Z,$(V),re=!0;break t}g===a(u)&&r(u),$(V)}else r(u);g=a(u)}if(g!==null)re=!0;else{var I=a(x);I!==null&&O(P,I.startTime-V),re=!1}}break e}finally{g=null,N=ge,f=!1}re=void 0}}finally{re?E():se=!1}}}var E;if(typeof K=="function")E=function(){K(Q)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,C=te.port2;te.port1.onmessage=Q,E=function(){C.postMessage(null)}}else E=function(){D(Q,0)};function O(V,re){z=D(function(){V(t.unstable_now())},re)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return N},t.unstable_next=function(V){switch(N){case 1:case 2:case 3:var re=3;break;default:re=N}var ge=N;N=re;try{return V()}finally{N=ge}},t.unstable_requestPaint=function(){U=!0},t.unstable_runWithPriority=function(V,re){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var ge=N;N=V;try{return re()}finally{N=ge}},t.unstable_scheduleCallback=function(V,re,ge){var xe=t.unstable_now();switch(typeof ge=="object"&&ge!==null?(ge=ge.delay,ge=typeof ge=="number"&&0<ge?xe+ge:xe):ge=xe,V){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=ge+Z,V={id:A++,callback:re,priorityLevel:V,startTime:ge,expirationTime:Z,sortIndex:-1},ge>xe?(V.sortIndex=ge,s(x,V),a(u)===null&&V===a(x)&&(v?(M(z),z=-1):v=!0,O(P,ge-xe))):(V.sortIndex=Z,s(u,V),y||f||(y=!0,se||(se=!0,E()))),V},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(V){var re=N;return function(){var ge=N;N=re;try{return V.apply(this,arguments)}finally{N=ge}}}})(J0)),J0}var rN;function HC(){return rN||(rN=1,X0.exports=$C()),X0.exports}var Z0={exports:{}},Yn={};var nN;function PC(){if(nN)return Yn;nN=1;var t=ty();function s(u){var x="https://react.dev/errors/"+u;if(1<arguments.length){x+="?args[]="+encodeURIComponent(arguments[1]);for(var A=2;A<arguments.length;A++)x+="&args[]="+encodeURIComponent(arguments[A])}return"Minified React error #"+u+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var r={d:{f:a,r:function(){throw Error(s(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},l=Symbol.for("react.portal");function c(u,x,A){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:g==null?null:""+g,children:u,containerInfo:x,implementation:A}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(u,x){if(u==="font")return"";if(typeof x=="string")return x==="use-credentials"?x:""}return Yn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Yn.createPortal=function(u,x){var A=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!x||x.nodeType!==1&&x.nodeType!==9&&x.nodeType!==11)throw Error(s(299));return c(u,x,null,A)},Yn.flushSync=function(u){var x=o.T,A=r.p;try{if(o.T=null,r.p=2,u)return u()}finally{o.T=x,r.p=A,r.d.f()}},Yn.preconnect=function(u,x){typeof u=="string"&&(x?(x=x.crossOrigin,x=typeof x=="string"?x==="use-credentials"?x:"":void 0):x=null,r.d.C(u,x))},Yn.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},Yn.preinit=function(u,x){if(typeof u=="string"&&x&&typeof x.as=="string"){var A=x.as,g=m(A,x.crossOrigin),N=typeof x.integrity=="string"?x.integrity:void 0,f=typeof x.fetchPriority=="string"?x.fetchPriority:void 0;A==="style"?r.d.S(u,typeof x.precedence=="string"?x.precedence:void 0,{crossOrigin:g,integrity:N,fetchPriority:f}):A==="script"&&r.d.X(u,{crossOrigin:g,integrity:N,fetchPriority:f,nonce:typeof x.nonce=="string"?x.nonce:void 0})}},Yn.preinitModule=function(u,x){if(typeof u=="string")if(typeof x=="object"&&x!==null){if(x.as==null||x.as==="script"){var A=m(x.as,x.crossOrigin);r.d.M(u,{crossOrigin:A,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0})}}else x==null&&r.d.M(u)},Yn.preload=function(u,x){if(typeof u=="string"&&typeof x=="object"&&x!==null&&typeof x.as=="string"){var A=x.as,g=m(A,x.crossOrigin);r.d.L(u,A,{crossOrigin:g,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0,type:typeof x.type=="string"?x.type:void 0,fetchPriority:typeof x.fetchPriority=="string"?x.fetchPriority:void 0,referrerPolicy:typeof x.referrerPolicy=="string"?x.referrerPolicy:void 0,imageSrcSet:typeof x.imageSrcSet=="string"?x.imageSrcSet:void 0,imageSizes:typeof x.imageSizes=="string"?x.imageSizes:void 0,media:typeof x.media=="string"?x.media:void 0})}},Yn.preloadModule=function(u,x){if(typeof u=="string")if(x){var A=m(x.as,x.crossOrigin);r.d.m(u,{as:typeof x.as=="string"&&x.as!=="script"?x.as:void 0,crossOrigin:A,integrity:typeof x.integrity=="string"?x.integrity:void 0})}else r.d.m(u)},Yn.requestFormReset=function(u){r.d.r(u)},Yn.unstable_batchedUpdates=function(u,x){return u(x)},Yn.useFormState=function(u,x,A){return o.H.useFormState(u,x,A)},Yn.useFormStatus=function(){return o.H.useHostTransitionStatus()},Yn.version="19.2.0",Yn}var lN;function OC(){if(lN)return Z0.exports;lN=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(s){console.error(s)}}return t(),Z0.exports=PC(),Z0.exports}var iN;function zC(){if(iN)return zx;iN=1;var t=HC(),s=ty(),a=OC();function r(n){var i="https://react.dev/errors/"+n;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)i+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function c(n){var i=n,d=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,(i.flags&4098)!==0&&(d=i.return),n=i.return;while(n)}return i.tag===3?d:null}function o(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function m(n){if(n.tag===31){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function u(n){if(c(n)!==n)throw Error(r(188))}function x(n){var i=n.alternate;if(!i){if(i=c(n),i===null)throw Error(r(188));return i!==n?null:n}for(var d=n,p=i;;){var _=d.return;if(_===null)break;var L=_.alternate;if(L===null){if(p=_.return,p!==null){d=p;continue}break}if(_.child===L.child){for(L=_.child;L;){if(L===d)return u(_),n;if(L===p)return u(_),i;L=L.sibling}throw Error(r(188))}if(d.return!==p.return)d=_,p=L;else{for(var ue=!1,Re=_.child;Re;){if(Re===d){ue=!0,d=_,p=L;break}if(Re===p){ue=!0,p=_,d=L;break}Re=Re.sibling}if(!ue){for(Re=L.child;Re;){if(Re===d){ue=!0,d=L,p=_;break}if(Re===p){ue=!0,p=L,d=_;break}Re=Re.sibling}if(!ue)throw Error(r(189))}}if(d.alternate!==p)throw Error(r(190))}if(d.tag!==3)throw Error(r(188));return d.stateNode.current===d?n:i}function A(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n;for(n=n.child;n!==null;){if(i=A(n),i!==null)return i;n=n.sibling}return null}var g=Object.assign,N=Symbol.for("react.element"),f=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),U=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),M=Symbol.for("react.consumer"),K=Symbol.for("react.context"),$=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),se=Symbol.for("react.suspense_list"),z=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),j=Symbol.for("react.activity"),T=Symbol.for("react.memo_cache_sentinel"),Q=Symbol.iterator;function E(n){return n===null||typeof n!="object"?null:(n=Q&&n[Q]||n["@@iterator"],typeof n=="function"?n:null)}var te=Symbol.for("react.client.reference");function C(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===te?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case v:return"Fragment";case D:return"Profiler";case U:return"StrictMode";case P:return"Suspense";case se:return"SuspenseList";case j:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case y:return"Portal";case K:return n.displayName||"Context";case M:return(n._context.displayName||"Context")+".Consumer";case $:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case z:return i=n.displayName||null,i!==null?i:C(n.type)||"Memo";case R:i=n._payload,n=n._init;try{return C(n(i))}catch{}}return null}var O=Array.isArray,V=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,re=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ge={pending:!1,data:null,method:null,action:null},xe=[],Z=-1;function I(n){return{current:n}}function H(n){0>Z||(n.current=xe[Z],xe[Z]=null,Z--)}function ae(n,i){Z++,xe[Z]=n.current,n.current=i}var k=I(null),B=I(null),w=I(null),oe=I(null);function ne(n,i){switch(ae(w,i),ae(B,n),ae(k,null),i.nodeType){case 9:case 11:n=(n=i.documentElement)&&(n=n.namespaceURI)?vv(n):0;break;default:if(n=i.tagName,i=i.namespaceURI)i=vv(i),n=Nv(i,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}H(k),ae(k,n)}function Fe(){H(k),H(B),H(w)}function je(n){n.memoizedState!==null&&ae(oe,n);var i=k.current,d=Nv(i,n.type);i!==d&&(ae(B,n),ae(k,d))}function Ge(n){B.current===n&&(H(k),H(B)),oe.current===n&&(H(oe),Ix._currentValue=ge)}var ze,Xe;function st(n){if(ze===void 0)try{throw Error()}catch(d){var i=d.stack.trim().match(/\n( *(at )?)/);ze=i&&i[1]||"",Xe=-1<d.stack.indexOf(`
    at`)?" (<anonymous>)":-1<d.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ze+n+Xe}var ce=!1;function _e(n,i){if(!n||ce)return"";ce=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(i){var It=function(){throw Error()};if(Object.defineProperty(It.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(It,[])}catch(St){var jt=St}Reflect.construct(n,[],It)}else{try{It.call()}catch(St){jt=St}n.call(It.prototype)}}else{try{throw Error()}catch(St){jt=St}(It=n())&&typeof It.catch=="function"&&It.catch(function(){})}}catch(St){if(St&&jt&&typeof St.stack=="string")return[St.stack,jt.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var _=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");_&&_.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var L=p.DetermineComponentFrameRoot(),ue=L[0],Re=L[1];if(ue&&Re){var tt=ue.split(`
`),yt=Re.split(`
`);for(_=p=0;p<tt.length&&!tt[p].includes("DetermineComponentFrameRoot");)p++;for(;_<yt.length&&!yt[_].includes("DetermineComponentFrameRoot");)_++;if(p===tt.length||_===yt.length)for(p=tt.length-1,_=yt.length-1;1<=p&&0<=_&&tt[p]!==yt[_];)_--;for(;1<=p&&0<=_;p--,_--)if(tt[p]!==yt[_]){if(p!==1||_!==1)do if(p--,_--,0>_||tt[p]!==yt[_]){var Dt=`
`+tt[p].replace(" at new "," at ");return n.displayName&&Dt.includes("<anonymous>")&&(Dt=Dt.replace("<anonymous>",n.displayName)),Dt}while(1<=p&&0<=_);break}}}finally{ce=!1,Error.prepareStackTrace=d}return(d=n?n.displayName||n.name:"")?st(d):""}function le(n,i){switch(n.tag){case 26:case 27:case 5:return st(n.type);case 16:return st("Lazy");case 13:return n.child!==i&&i!==null?st("Suspense Fallback"):st("Suspense");case 19:return st("SuspenseList");case 0:case 15:return _e(n.type,!1);case 11:return _e(n.type.render,!1);case 1:return _e(n.type,!0);case 31:return st("Activity");default:return""}}function Pe(n){try{var i="",d=null;do i+=le(n,d),d=n,n=n.return;while(n);return i}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var we=Object.prototype.hasOwnProperty,fe=t.unstable_scheduleCallback,ye=t.unstable_cancelCallback,Ke=t.unstable_shouldYield,ve=t.unstable_requestPaint,ie=t.unstable_now,q=t.unstable_getCurrentPriorityLevel,pe=t.unstable_ImmediatePriority,Me=t.unstable_UserBlockingPriority,Se=t.unstable_NormalPriority,Ne=t.unstable_LowPriority,et=t.unstable_IdlePriority,Ce=t.log,ft=t.unstable_setDisableYieldValue,qe=null,W=null;function Ie(n){if(typeof Ce=="function"&&ft(n),W&&typeof W.setStrictMode=="function")try{W.setStrictMode(qe,n)}catch{}}var mt=Math.clz32?Math.clz32:J,pt=Math.log,kt=Math.LN2;function J(n){return n>>>=0,n===0?32:31-(pt(n)/kt|0)|0}var Je=256,_t=262144,$t=4194304;function me(n){var i=n&42;if(i!==0)return i;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Ze(n,i,d){var p=n.pendingLanes;if(p===0)return 0;var _=0,L=n.suspendedLanes,ue=n.pingedLanes;n=n.warmLanes;var Re=p&134217727;return Re!==0?(p=Re&~L,p!==0?_=me(p):(ue&=Re,ue!==0?_=me(ue):d||(d=Re&~n,d!==0&&(_=me(d))))):(Re=p&~L,Re!==0?_=me(Re):ue!==0?_=me(ue):d||(d=p&~n,d!==0&&(_=me(d)))),_===0?0:i!==0&&i!==_&&(i&L)===0&&(L=_&-_,d=i&-i,L>=d||L===32&&(d&4194048)!==0)?i:_}function ct(n,i){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&i)===0}function Yt(n,i){switch(n){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function be(){var n=$t;return $t<<=1,($t&62914560)===0&&($t=4194304),n}function lt(n){for(var i=[],d=0;31>d;d++)i.push(n);return i}function Ue(n,i){n.pendingLanes|=i,i!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Ct(n,i,d,p,_,L){var ue=n.pendingLanes;n.pendingLanes=d,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=d,n.entangledLanes&=d,n.errorRecoveryDisabledLanes&=d,n.shellSuspendCounter=0;var Re=n.entanglements,tt=n.expirationTimes,yt=n.hiddenUpdates;for(d=ue&~d;0<d;){var Dt=31-mt(d),It=1<<Dt;Re[Dt]=0,tt[Dt]=-1;var jt=yt[Dt];if(jt!==null)for(yt[Dt]=null,Dt=0;Dt<jt.length;Dt++){var St=jt[Dt];St!==null&&(St.lane&=-536870913)}d&=~It}p!==0&&Et(n,p,0),L!==0&&_===0&&n.tag!==0&&(n.suspendedLanes|=L&~(ue&~i))}function Et(n,i,d){n.pendingLanes|=i,n.suspendedLanes&=~i;var p=31-mt(i);n.entangledLanes|=i,n.entanglements[p]=n.entanglements[p]|1073741824|d&261930}function Rs(n,i){var d=n.entangledLanes|=i;for(n=n.entanglements;d;){var p=31-mt(d),_=1<<p;_&i|n[p]&i&&(n[p]|=i),d&=~_}}function He(n,i){var d=i&-i;return d=(d&42)!==0?1:Te(d),(d&(n.suspendedLanes|i))!==0?0:d}function Te(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function bt(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Xt(){var n=re.p;return n!==0?n:(n=window.event,n===void 0?32:qv(n.type))}function ls(n,i){var d=re.p;try{return re.p=n,i()}finally{re.p=d}}var Ts=Math.random().toString(36).slice(2),ss="__reactFiber$"+Ts,he="__reactProps$"+Ts,Ht="__reactContainer$"+Ts,Zt="__reactEvents$"+Ts,Ee="__reactListeners$"+Ts,zt="__reactHandles$"+Ts,is="__reactResources$"+Ts,pa="__reactMarker$"+Ts;function ba(n){delete n[ss],delete n[he],delete n[Zt],delete n[Ee],delete n[zt]}function xn(n){var i=n[ss];if(i)return i;for(var d=n.parentNode;d;){if(i=d[Ht]||d[ss]){if(d=i.alternate,i.child!==null||d!==null&&d.child!==null)for(n=Fv(n);n!==null;){if(d=n[ss])return d;n=Fv(n)}return i}n=d,d=n.parentNode}return null}function zr(n){if(n=n[ss]||n[Ht]){var i=n.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return n}return null}function De(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n.stateNode;throw Error(r(33))}function Jt(n){var i=n[is];return i||(i=n[is]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function rs(n){n[pa]=!0}var dr=new Set,Ae={};function es(n,i){ws(n,i),ws(n+"Capture",i)}function ws(n,i){for(Ae[n]=i,n=0;n<i.length;n++)dr.add(i[n])}var Da=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ii={},Kl={};function mr(n){return we.call(Kl,n)?!0:we.call(Ii,n)?!1:Da.test(n)?Kl[n]=!0:(Ii[n]=!0,!1)}function hn(n,i,d){if(mr(i))if(d===null)n.removeAttribute(i);else{switch(typeof d){case"undefined":case"function":case"symbol":n.removeAttribute(i);return;case"boolean":var p=i.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){n.removeAttribute(i);return}}n.setAttribute(i,""+d)}}function Vl(n,i,d){if(d===null)n.removeAttribute(i);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(i);return}n.setAttribute(i,""+d)}}function dl(n,i,d,p){if(p===null)n.removeAttribute(d);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(d);return}n.setAttributeNS(i,d,""+p)}}function da(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function $i(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Nl(n,i,d){var p=Object.getOwnPropertyDescriptor(n.constructor.prototype,i);if(!n.hasOwnProperty(i)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var _=p.get,L=p.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return _.call(this)},set:function(ue){d=""+ue,L.call(this,ue)}}),Object.defineProperty(n,i,{enumerable:p.enumerable}),{getValue:function(){return d},setValue:function(ue){d=""+ue},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function mi(n){if(!n._valueTracker){var i=$i(n)?"checked":"value";n._valueTracker=Nl(n,i,""+n[i])}}function to(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var d=i.getValue(),p="";return n&&(p=$i(n)?n.checked?"true":"false":n.value),n=p,n!==d?(i.setValue(n),!0):!1}function pn(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Nr=/[\n"\\]/g;function ur(n){return n.replace(Nr,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function _c(n,i,d,p,_,L,ue,Re){n.name="",ue!=null&&typeof ue!="function"&&typeof ue!="symbol"&&typeof ue!="boolean"?n.type=ue:n.removeAttribute("type"),i!=null?ue==="number"?(i===0&&n.value===""||n.value!=i)&&(n.value=""+da(i)):n.value!==""+da(i)&&(n.value=""+da(i)):ue!=="submit"&&ue!=="reset"||n.removeAttribute("value"),i!=null?Cc(n,ue,da(i)):d!=null?Cc(n,ue,da(d)):p!=null&&n.removeAttribute("value"),_==null&&L!=null&&(n.defaultChecked=!!L),_!=null&&(n.checked=_&&typeof _!="function"&&typeof _!="symbol"),Re!=null&&typeof Re!="function"&&typeof Re!="symbol"&&typeof Re!="boolean"?n.name=""+da(Re):n.removeAttribute("name")}function Vo(n,i,d,p,_,L,ue,Re){if(L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"&&(n.type=L),i!=null||d!=null){if(!(L!=="submit"&&L!=="reset"||i!=null)){mi(n);return}d=d!=null?""+da(d):"",i=i!=null?""+da(i):d,Re||i===n.value||(n.value=i),n.defaultValue=i}p=p??_,p=typeof p!="function"&&typeof p!="symbol"&&!!p,n.checked=Re?n.checked:!!p,n.defaultChecked=!!p,ue!=null&&typeof ue!="function"&&typeof ue!="symbol"&&typeof ue!="boolean"&&(n.name=ue),mi(n)}function Cc(n,i,d){i==="number"&&pn(n.ownerDocument)===n||n.defaultValue===""+d||(n.defaultValue=""+d)}function Gr(n,i,d,p){if(n=n.options,i){i={};for(var _=0;_<d.length;_++)i["$"+d[_]]=!0;for(d=0;d<n.length;d++)_=i.hasOwnProperty("$"+n[d].value),n[d].selected!==_&&(n[d].selected=_),_&&p&&(n[d].defaultSelected=!0)}else{for(d=""+da(d),i=null,_=0;_<n.length;_++){if(n[_].value===d){n[_].selected=!0,p&&(n[_].defaultSelected=!0);return}i!==null||n[_].disabled||(i=n[_])}i!==null&&(i.selected=!0)}}function so(n,i,d){if(i!=null&&(i=""+da(i),i!==n.value&&(n.value=i),d==null)){n.defaultValue!==i&&(n.defaultValue=i);return}n.defaultValue=d!=null?""+da(d):""}function ao(n,i,d,p){if(i==null){if(p!=null){if(d!=null)throw Error(r(92));if(O(p)){if(1<p.length)throw Error(r(93));p=p[0]}d=p}d==null&&(d=""),i=d}d=da(i),n.defaultValue=d,p=n.textContent,p===d&&p!==""&&p!==null&&(n.value=p),mi(n)}function ml(n,i){if(i){var d=n.firstChild;if(d&&d===n.lastChild&&d.nodeType===3){d.nodeValue=i;return}}n.textContent=i}var Y=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function vt(n,i,d){var p=i.indexOf("--")===0;d==null||typeof d=="boolean"||d===""?p?n.setProperty(i,""):i==="float"?n.cssFloat="":n[i]="":p?n.setProperty(i,d):typeof d!="number"||d===0||Y.has(i)?i==="float"?n.cssFloat=d:n[i]=(""+d).trim():n[i]=d+"px"}function Ss(n,i,d){if(i!=null&&typeof i!="object")throw Error(r(62));if(n=n.style,d!=null){for(var p in d)!d.hasOwnProperty(p)||i!=null&&i.hasOwnProperty(p)||(p.indexOf("--")===0?n.setProperty(p,""):p==="float"?n.cssFloat="":n[p]="");for(var _ in i)p=i[_],i.hasOwnProperty(_)&&d[_]!==p&&vt(n,_,p)}else for(var L in i)i.hasOwnProperty(L)&&vt(n,L,i[L])}function xr(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ul=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),hr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function qn(n){return hr.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function Yl(){}var Hi=null;function ro(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Sc=null,Es=null;function $m(n){var i=zr(n);if(i&&(n=i.stateNode)){var d=n[he]||null;e:switch(n=i.stateNode,i.type){case"input":if(_c(n,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name),i=d.name,d.type==="radio"&&i!=null){for(d=n;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll('input[name="'+ur(""+i)+'"][type="radio"]'),i=0;i<d.length;i++){var p=d[i];if(p!==n&&p.form===n.form){var _=p[he]||null;if(!_)throw Error(r(90));_c(p,_.value,_.defaultValue,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name)}}for(i=0;i<d.length;i++)p=d[i],p.form===n.form&&to(p)}break e;case"textarea":so(n,d.value,d.defaultValue);break e;case"select":i=d.value,i!=null&&Gr(n,!!d.multiple,i,!1)}}}var Vd=!1;function Hm(n,i,d){if(Vd)return n(i,d);Vd=!0;try{var p=n(i);return p}finally{if(Vd=!1,(Sc!==null||Es!==null)&&(Ap(),Sc&&(i=Sc,n=Es,Es=Sc=null,$m(i),n)))for(i=0;i<n.length;i++)$m(n[i])}}function xl(n,i){var d=n.stateNode;if(d===null)return null;var p=d[he]||null;if(p===null)return null;d=p[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(n=n.type,p=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!p;break e;default:n=!1}if(n)return null;if(d&&typeof d!="function")throw Error(r(231,i,typeof d));return d}var An=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Yd=!1;if(An)try{var no={};Object.defineProperty(no,"passive",{get:function(){Yd=!0}}),window.addEventListener("test",no,no),window.removeEventListener("test",no,no)}catch{Yd=!1}var hl=null,lo=null,ui=null;function Pm(){if(ui)return ui;var n,i=lo,d=i.length,p,_="value"in hl?hl.value:hl.textContent,L=_.length;for(n=0;n<d&&i[n]===_[n];n++);var ue=d-n;for(p=1;p<=ue&&i[d-p]===_[L-p];p++);return ui=_.slice(n,1<p?1-p:void 0)}function wl(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function Yo(){return!0}function Wo(){return!1}function sn(n){function i(d,p,_,L,ue){this._reactName=d,this._targetInst=_,this.type=p,this.nativeEvent=L,this.target=ue,this.currentTarget=null;for(var Re in n)n.hasOwnProperty(Re)&&(d=n[Re],this[Re]=d?d(L):L[Re]);return this.isDefaultPrevented=(L.defaultPrevented!=null?L.defaultPrevented:L.returnValue===!1)?Yo:Wo,this.isPropagationStopped=Wo,this}return g(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Yo)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Yo)},persist:function(){},isPersistent:Yo}),i}var xi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_l=sn(xi),Pi=g({},xi,{view:0,detail:0}),Xo=sn(Pi),io,Oi,zi,co=g({},Pi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ms,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==zi&&(zi&&n.type==="mousemove"?(io=n.screenX-zi.screenX,Oi=n.screenY-zi.screenY):Oi=io=0,zi=n),io)},movementY:function(n){return"movementY"in n?n.movementY:Oi}}),Wd=sn(co),Gi=g({},co,{dataTransfer:0}),qi=sn(Gi),Om=g({},Pi,{relatedTarget:0}),Ki=sn(Om),zm=g({},xi,{animationName:0,elapsedTime:0,pseudoElement:0}),G=sn(zm),ke=g({},xi,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),We=sn(ke),at=g({},xi,{data:0}),ot=sn(at),Tt={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Gt={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},As={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ys(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=As[n])?!!i[n]:!1}function Ms(){return ys}var Os=g({},Pi,{key:function(n){if(n.key){var i=Tt[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=wl(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Gt[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ms,charCode:function(n){return n.type==="keypress"?wl(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?wl(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),ma=sn(Os),tr=g({},co,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wr=sn(tr),Ia=g({},Pi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ms}),qr=sn(Ia),Fr=g({},xi,{propertyName:0,elapsedTime:0,pseudoElement:0}),gn=sn(Fr),Vi=g({},co,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Wl=sn(Vi),Yi=g({},xi,{newState:0,oldState:0}),Xd=sn(Yi),Jo=[9,13,27,32],hi=An&&"CompositionEvent"in window,Xl=null;An&&"documentMode"in document&&(Xl=document.documentMode);var oo=An&&"TextEvent"in window&&!Xl,Wi=An&&(!hi||Xl&&8<Xl&&11>=Xl),an=" ",kc=!1;function Bc(n,i){switch(n){case"keyup":return Jo.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Zo(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var pi=!1;function Rn(n,i){switch(n){case"compositionend":return Zo(i);case"keypress":return i.which!==32?null:(kc=!0,an);case"textInput":return n=i.data,n===an&&kc?null:n;default:return null}}function Xi(n,i){if(pi)return n==="compositionend"||!hi&&Bc(n,i)?(n=Pm(),ui=lo=hl=null,pi=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Wi&&i.locale!=="ko"?null:i.data;default:return null}}var ed={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Jd(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!ed[n.type]:i==="textarea"}function pl(n,i,d,p){Sc?Es?Es.push(p):Es=[p]:Sc=p,i=Np(i,"onChange"),0<i.length&&(d=new _l("onChange","change",null,d,p),n.push({event:d,listeners:i}))}var Jl=null,Ji=null;function Zd(n){Av(n,0)}function Zl(n){var i=De(n);if(to(i))return n}function Fc(n,i){if(n==="change")return i}var Kn=!1;if(An){var Mn;if(An){var Ai="oninput"in document;if(!Ai){var gi=document.createElement("div");gi.setAttribute("oninput","return;"),Ai=typeof gi.oninput=="function"}Mn=Ai}else Mn=!1;Kn=Mn&&(!document.documentMode||9<document.documentMode)}function Zi(){Jl&&(Jl.detachEvent("onpropertychange",td),Ji=Jl=null)}function td(n){if(n.propertyName==="value"&&Zl(Ji)){var i=[];pl(i,Ji,n,ro(n)),Hm(Zd,i)}}function sd(n,i,d){n==="focusin"?(Zi(),Jl=i,Ji=d,Jl.attachEvent("onpropertychange",td)):n==="focusout"&&Zi()}function _r(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Zl(Ji)}function Gm(n,i){if(n==="click")return Zl(i)}function fi(n,i){if(n==="input"||n==="change")return Zl(i)}function bi(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var fn=typeof Object.is=="function"?Object.is:bi;function ec(n,i){if(fn(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var d=Object.keys(n),p=Object.keys(i);if(d.length!==p.length)return!1;for(p=0;p<d.length;p++){var _=d[p];if(!we.call(i,_)||!fn(n[_],i[_]))return!1}return!0}function ad(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function rd(n,i){var d=ad(n);n=0;for(var p;d;){if(d.nodeType===3){if(p=n+d.textContent.length,n<=i&&p>=i)return{node:d,offset:i-n};n=p}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=ad(d)}}function tc(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?tc(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function sc(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var i=pn(n.document);i instanceof n.HTMLIFrameElement;){try{var d=typeof i.contentWindow.location.href=="string"}catch{d=!1}if(d)n=i.contentWindow;else break;i=pn(n.document)}return i}function yi(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}var mo=An&&"documentMode"in document&&11>=document.documentMode,Al=null,ac=null,Cn=null,Cl=!1;function ya(n,i,d){var p=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Cl||Al==null||Al!==pn(p)||(p=Al,"selectionStart"in p&&yi(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Cn&&ec(Cn,p)||(Cn=p,p=Np(ac,"onSelect"),0<p.length&&(i=new _l("onSelect","select",null,i,d),n.push({event:i,listeners:p}),i.target=Al)))}function ua(n,i){var d={};return d[n.toLowerCase()]=i.toLowerCase(),d["Webkit"+n]="webkit"+i,d["Moz"+n]="moz"+i,d}var $a={animationend:ua("Animation","AnimationEnd"),animationiteration:ua("Animation","AnimationIteration"),animationstart:ua("Animation","AnimationStart"),transitionrun:ua("Transition","TransitionRun"),transitionstart:ua("Transition","TransitionStart"),transitioncancel:ua("Transition","TransitionCancel"),transitionend:ua("Transition","TransitionEnd")},Cr={},ji={};An&&(ji=document.createElement("div").style,"AnimationEvent"in window||(delete $a.animationend.animation,delete $a.animationiteration.animation,delete $a.animationstart.animation),"TransitionEvent"in window||delete $a.transitionend.transition);function ei(n){if(Cr[n])return Cr[n];if(!$a[n])return n;var i=$a[n],d;for(d in i)if(i.hasOwnProperty(d)&&d in ji)return Cr[n]=i[d];return n}var uo=ei("animationend"),em=ei("animationiteration"),cx=ei("animationstart"),qh=ei("transitionrun"),Kh=ei("transitionstart"),Vh=ei("transitioncancel"),ox=ei("transitionend"),dx=new Map,xo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");xo.push("scrollEnd");function Sl(n,i){dx.set(n,i),es(i,[n])}var tm=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},gl=[],ho=0,qm=0;function sm(){for(var n=ho,i=qm=ho=0;i<n;){var d=gl[i];gl[i++]=null;var p=gl[i];gl[i++]=null;var _=gl[i];gl[i++]=null;var L=gl[i];if(gl[i++]=null,p!==null&&_!==null){var ue=p.pending;ue===null?_.next=_:(_.next=ue.next,ue.next=_),p.pending=_}L!==0&&rm(d,_,L)}}function am(n,i,d,p){gl[ho++]=n,gl[ho++]=i,gl[ho++]=d,gl[ho++]=p,qm|=p,n.lanes|=p,n=n.alternate,n!==null&&(n.lanes|=p)}function Km(n,i,d,p){return am(n,i,d,p),Sn(n)}function rc(n,i){return am(n,null,null,i),Sn(n)}function rm(n,i,d){n.lanes|=d;var p=n.alternate;p!==null&&(p.lanes|=d);for(var _=!1,L=n.return;L!==null;)L.childLanes|=d,p=L.alternate,p!==null&&(p.childLanes|=d),L.tag===22&&(n=L.stateNode,n===null||n._visibility&1||(_=!0)),n=L,L=L.return;return n.tag===3?(L=n.stateNode,_&&i!==null&&(_=31-mt(d),n=L.hiddenUpdates,p=n[_],p===null?n[_]=[i]:p.push(i),i.lane=d|536870912),L):null}function Sn(n){if(50<Dx)throw Dx=0,f0=null,Error(r(185));for(var i=n.return;i!==null;)n=i,i=n.return;return n.tag===3?n.stateNode:null}var bn={};function Vm(n,i,d,p){this.tag=n,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kn(n,i,d,p){return new Vm(n,i,d,p)}function Ym(n){return n=n.prototype,!(!n||!n.isReactComponent)}function kl(n,i){var d=n.alternate;return d===null?(d=kn(n.tag,i,n.key,n.mode),d.elementType=n.elementType,d.type=n.type,d.stateNode=n.stateNode,d.alternate=n,n.alternate=d):(d.pendingProps=i,d.type=n.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=n.flags&65011712,d.childLanes=n.childLanes,d.lanes=n.lanes,d.child=n.child,d.memoizedProps=n.memoizedProps,d.memoizedState=n.memoizedState,d.updateQueue=n.updateQueue,i=n.dependencies,d.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},d.sibling=n.sibling,d.index=n.index,d.ref=n.ref,d.refCleanup=n.refCleanup,d}function nm(n,i){n.flags&=65011714;var d=n.alternate;return d===null?(n.childLanes=0,n.lanes=i,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=d.childLanes,n.lanes=d.lanes,n.child=d.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=d.memoizedProps,n.memoizedState=d.memoizedState,n.updateQueue=d.updateQueue,n.type=d.type,i=d.dependencies,n.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),n}function nd(n,i,d,p,_,L){var ue=0;if(p=n,typeof n=="function")Ym(n)&&(ue=1);else if(typeof n=="string")ue=wC(n,d,k.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case j:return n=kn(31,d,i,_),n.elementType=j,n.lanes=L,n;case v:return Ec(d.children,_,L,i);case U:ue=8,_|=24;break;case D:return n=kn(12,d,i,_|2),n.elementType=D,n.lanes=L,n;case P:return n=kn(13,d,i,_),n.elementType=P,n.lanes=L,n;case se:return n=kn(19,d,i,_),n.elementType=se,n.lanes=L,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case K:ue=10;break e;case M:ue=9;break e;case $:ue=11;break e;case z:ue=14;break e;case R:ue=16,p=null;break e}ue=29,d=Error(r(130,n===null?"null":typeof n,"")),p=null}return i=kn(ue,d,i,_),i.elementType=n,i.type=p,i.lanes=L,i}function Ec(n,i,d,p){return n=kn(7,n,p,i),n.lanes=d,n}function lm(n,i,d){return n=kn(6,n,null,i),n.lanes=d,n}function Wm(n){var i=kn(18,null,null,0);return i.stateNode=n,i}function ld(n,i,d){return i=kn(4,n.children!==null?n.children:[],n.key,i),i.lanes=d,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}var Xm=new WeakMap;function Bl(n,i){if(typeof n=="object"&&n!==null){var d=Xm.get(n);return d!==void 0?d:(i={value:n,source:i,stack:Pe(i)},Xm.set(n,i),i)}return{value:n,source:i,stack:Pe(i)}}var id=[],po=0,Jm=null,im=0,Fl=[],El=0,Dc=null,Dl=1,Ul="";function fl(n,i){id[po++]=im,id[po++]=Jm,Jm=n,im=i}function Yh(n,i,d){Fl[El++]=Dl,Fl[El++]=Ul,Fl[El++]=Dc,Dc=n;var p=Dl;n=Ul;var _=32-mt(p)-1;p&=~(1<<_),d+=1;var L=32-mt(i)+_;if(30<L){var ue=_-_%5;L=(p&(1<<ue)-1).toString(32),p>>=ue,_-=ue,Dl=1<<32-mt(i)+_|d<<_|p,Ul=L+n}else Dl=1<<L|d<<_|p,Ul=n}function mx(n){n.return!==null&&(fl(n,1),Yh(n,1,0))}function Zm(n){for(;n===Jm;)Jm=id[--po],id[po]=null,im=id[--po],id[po]=null;for(;n===Dc;)Dc=Fl[--El],Fl[El]=null,Ul=Fl[--El],Fl[El]=null,Dl=Fl[--El],Fl[El]=null}function Wh(n,i){Fl[El++]=Dl,Fl[El++]=Ul,Fl[El++]=Dc,Dl=i.id,Ul=i.overflow,Dc=n}var yn=null,Va=null,ea=!1,In=null,pr=!1,ti=Error(r(519));function Uc(n){var i=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw cd(Bl(i,n)),ti}function ux(n){var i=n.stateNode,d=n.type,p=n.memoizedProps;switch(i[ss]=n,i[he]=p,d){case"dialog":sa("cancel",i),sa("close",i);break;case"iframe":case"object":case"embed":sa("load",i);break;case"video":case"audio":for(d=0;d<Tx.length;d++)sa(Tx[d],i);break;case"source":sa("error",i);break;case"img":case"image":case"link":sa("error",i),sa("load",i);break;case"details":sa("toggle",i);break;case"input":sa("invalid",i),Vo(i,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":sa("invalid",i);break;case"textarea":sa("invalid",i),ao(i,p.value,p.defaultValue,p.children)}d=p.children,typeof d!="string"&&typeof d!="number"&&typeof d!="bigint"||i.textContent===""+d||p.suppressHydrationWarning===!0||yv(i.textContent,d)?(p.popover!=null&&(sa("beforetoggle",i),sa("toggle",i)),p.onScroll!=null&&sa("scroll",i),p.onScrollEnd!=null&&sa("scrollend",i),p.onClick!=null&&(i.onclick=Yl),i=!0):i=!1,i||Uc(n,!0)}function nc(n){for(yn=n.return;yn;)switch(yn.tag){case 5:case 31:case 13:pr=!1;return;case 27:case 3:pr=!0;return;default:yn=yn.return}}function jn(n){if(n!==yn)return!1;if(!ea)return nc(n),ea=!0,!1;var i=n.tag,d;if((d=i!==3&&i!==27)&&((d=i===5)&&(d=n.type,d=!(d!=="form"&&d!=="button")||U0(n.type,n.memoizedProps)),d=!d),d&&Va&&Uc(n),nc(n),i===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));Va=Bv(n)}else if(i===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));Va=Bv(n)}else i===27?(i=Va,vd(n.type)?(n=M0,M0=null,Va=n):Va=i):Va=yn?_i(n.stateNode.nextSibling):null;return!0}function Ao(){Va=yn=null,ea=!1}function xx(){var n=In;return n!==null&&(Il===null?Il=n:Il.push.apply(Il,n),In=null),n}function cd(n){In===null?In=[n]:In.push(n)}var eu=I(null),Tc=null,vi=null;function Lc(n,i,d){ae(eu,i._currentValue),i._currentValue=d}function Tl(n){n._currentValue=eu.current,H(eu)}function od(n,i,d){for(;n!==null;){var p=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,p!==null&&(p.childLanes|=i)):p!==null&&(p.childLanes&i)!==i&&(p.childLanes|=i),n===d)break;n=n.return}}function go(n,i,d,p){var _=n.child;for(_!==null&&(_.return=n);_!==null;){var L=_.dependencies;if(L!==null){var ue=_.child;L=L.firstContext;e:for(;L!==null;){var Re=L;L=_;for(var tt=0;tt<i.length;tt++)if(Re.context===i[tt]){L.lanes|=d,Re=L.alternate,Re!==null&&(Re.lanes|=d),od(L.return,d,n),p||(ue=null);break e}L=Re.next}}else if(_.tag===18){if(ue=_.return,ue===null)throw Error(r(341));ue.lanes|=d,L=ue.alternate,L!==null&&(L.lanes|=d),od(ue,d,n),ue=null}else ue=_.child;if(ue!==null)ue.return=_;else for(ue=_;ue!==null;){if(ue===n){ue=null;break}if(_=ue.sibling,_!==null){_.return=ue.return,ue=_;break}ue=ue.return}_=ue}}function Qc(n,i,d,p){n=null;for(var _=i,L=!1;_!==null;){if(!L){if((_.flags&524288)!==0)L=!0;else if((_.flags&262144)!==0)break}if(_.tag===10){var ue=_.alternate;if(ue===null)throw Error(r(387));if(ue=ue.memoizedProps,ue!==null){var Re=_.type;fn(_.pendingProps.value,ue.value)||(n!==null?n.push(Re):n=[Re])}}else if(_===oe.current){if(ue=_.alternate,ue===null)throw Error(r(387));ue.memoizedState.memoizedState!==_.memoizedState.memoizedState&&(n!==null?n.push(Ix):n=[Ix])}_=_.return}n!==null&&go(i,n,d,p),i.flags|=262144}function tu(n){for(n=n.firstContext;n!==null;){if(!fn(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Rc(n){Tc=n,vi=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function vn(n){return Xh(Tc,n)}function su(n,i){return Tc===null&&Rc(n),Xh(n,i)}function Xh(n,i){var d=i._currentValue;if(i={context:i,memoizedValue:d,next:null},vi===null){if(n===null)throw Error(r(308));vi=i,n.dependencies={lanes:0,firstContext:i},n.flags|=524288}else vi=vi.next=i;return d}var Rg=typeof AbortController<"u"?AbortController:function(){var n=[],i=this.signal={aborted:!1,addEventListener:function(d,p){n.push(p)}};this.abort=function(){i.aborted=!0,n.forEach(function(d){return d()})}},Mg=t.unstable_scheduleCallback,Ig=t.unstable_NormalPriority,Sr={$$typeof:K,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function dd(){return{controller:new Rg,data:new Map,refCount:0}}function cm(n){n.refCount--,n.refCount===0&&Mg(Ig,function(){n.controller.abort()})}var om=null,au=0,b=0,S=null;function X(n,i){if(om===null){var d=om=[];au=0,b=w0(),S={status:"pending",value:void 0,then:function(p){d.push(p)}}}return au++,i.then(de,de),i}function de(){if(--au===0&&om!==null){S!==null&&(S.status="fulfilled");var n=om;om=null,b=0,S=null;for(var i=0;i<n.length;i++)(0,n[i])()}}function Be(n,i){var d=[],p={status:"pending",value:null,reason:null,then:function(_){d.push(_)}};return n.then(function(){p.status="fulfilled",p.value=i;for(var _=0;_<d.length;_++)(0,d[_])(i)},function(_){for(p.status="rejected",p.reason=_,_=0;_<d.length;_++)(0,d[_])(void 0)}),p}var Le=V.S;V.S=function(n,i){zj=ie(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&X(n,i),Le!==null&&Le(n,i)};var Qe=I(null);function $e(){var n=Qe.current;return n!==null?n:Wa.pooledCache}function Oe(n,i){i===null?ae(Qe,Qe.current):ae(Qe,i.pool)}function Ye(){var n=$e();return n===null?null:{parent:Sr._currentValue,pool:n}}var rt=Error(r(460)),At=Error(r(474)),Ve=Error(r(542)),it={then:function(){}};function ut(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Ft(n,i,d){switch(d=n[d],d===void 0?n.push(i):d!==i&&(i.then(Yl,Yl),i=d),i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,Vt(n),n;default:if(typeof i.status=="string")i.then(Yl,Yl);else{if(n=Wa,n!==null&&100<n.shellSuspendCounter)throw Error(r(482));n=i,n.status="pending",n.then(function(p){if(i.status==="pending"){var _=i;_.status="fulfilled",_.value=p}},function(p){if(i.status==="pending"){var _=i;_.status="rejected",_.reason=p}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,Vt(n),n}throw Bt=i,rt}}function ht(n){try{var i=n._init;return i(n._payload)}catch(d){throw d!==null&&typeof d=="object"&&typeof d.then=="function"?(Bt=d,rt):d}}var Bt=null;function Lt(){if(Bt===null)throw Error(r(459));var n=Bt;return Bt=null,n}function Vt(n){if(n===rt||n===Ve)throw Error(r(483))}var Pt=null,fs=0;function cs(n){var i=fs;return fs+=1,Pt===null&&(Pt=[]),Ft(Pt,n,i)}function Hs(n,i){i=i.props.ref,n.ref=i!==void 0?i:null}function ps(n,i){throw i.$$typeof===N?Error(r(525)):(n=Object.prototype.toString.call(i),Error(r(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n)))}function Zs(n){function i(dt,nt){if(n){var gt=dt.deletions;gt===null?(dt.deletions=[nt],dt.flags|=16):gt.push(nt)}}function d(dt,nt){if(!n)return null;for(;nt!==null;)i(dt,nt),nt=nt.sibling;return null}function p(dt){for(var nt=new Map;dt!==null;)dt.key!==null?nt.set(dt.key,dt):nt.set(dt.index,dt),dt=dt.sibling;return nt}function _(dt,nt){return dt=kl(dt,nt),dt.index=0,dt.sibling=null,dt}function L(dt,nt,gt){return dt.index=gt,n?(gt=dt.alternate,gt!==null?(gt=gt.index,gt<nt?(dt.flags|=67108866,nt):gt):(dt.flags|=67108866,nt)):(dt.flags|=1048576,nt)}function ue(dt){return n&&dt.alternate===null&&(dt.flags|=67108866),dt}function Re(dt,nt,gt,Qt){return nt===null||nt.tag!==6?(nt=lm(gt,dt.mode,Qt),nt.return=dt,nt):(nt=_(nt,gt),nt.return=dt,nt)}function tt(dt,nt,gt,Qt){var Bs=gt.type;return Bs===v?Dt(dt,nt,gt.props.children,Qt,gt.key):nt!==null&&(nt.elementType===Bs||typeof Bs=="object"&&Bs!==null&&Bs.$$typeof===R&&ht(Bs)===nt.type)?(nt=_(nt,gt.props),Hs(nt,gt),nt.return=dt,nt):(nt=nd(gt.type,gt.key,gt.props,null,dt.mode,Qt),Hs(nt,gt),nt.return=dt,nt)}function yt(dt,nt,gt,Qt){return nt===null||nt.tag!==4||nt.stateNode.containerInfo!==gt.containerInfo||nt.stateNode.implementation!==gt.implementation?(nt=ld(gt,dt.mode,Qt),nt.return=dt,nt):(nt=_(nt,gt.children||[]),nt.return=dt,nt)}function Dt(dt,nt,gt,Qt,Bs){return nt===null||nt.tag!==7?(nt=Ec(gt,dt.mode,Qt,Bs),nt.return=dt,nt):(nt=_(nt,gt),nt.return=dt,nt)}function It(dt,nt,gt){if(typeof nt=="string"&&nt!==""||typeof nt=="number"||typeof nt=="bigint")return nt=lm(""+nt,dt.mode,gt),nt.return=dt,nt;if(typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case f:return gt=nd(nt.type,nt.key,nt.props,null,dt.mode,gt),Hs(gt,nt),gt.return=dt,gt;case y:return nt=ld(nt,dt.mode,gt),nt.return=dt,nt;case R:return nt=ht(nt),It(dt,nt,gt)}if(O(nt)||E(nt))return nt=Ec(nt,dt.mode,gt,null),nt.return=dt,nt;if(typeof nt.then=="function")return It(dt,cs(nt),gt);if(nt.$$typeof===K)return It(dt,su(dt,nt),gt);ps(dt,nt)}return null}function jt(dt,nt,gt,Qt){var Bs=nt!==null?nt.key:null;if(typeof gt=="string"&&gt!==""||typeof gt=="number"||typeof gt=="bigint")return Bs!==null?null:Re(dt,nt,""+gt,Qt);if(typeof gt=="object"&&gt!==null){switch(gt.$$typeof){case f:return gt.key===Bs?tt(dt,nt,gt,Qt):null;case y:return gt.key===Bs?yt(dt,nt,gt,Qt):null;case R:return gt=ht(gt),jt(dt,nt,gt,Qt)}if(O(gt)||E(gt))return Bs!==null?null:Dt(dt,nt,gt,Qt,null);if(typeof gt.then=="function")return jt(dt,nt,cs(gt),Qt);if(gt.$$typeof===K)return jt(dt,nt,su(dt,gt),Qt);ps(dt,gt)}return null}function St(dt,nt,gt,Qt,Bs){if(typeof Qt=="string"&&Qt!==""||typeof Qt=="number"||typeof Qt=="bigint")return dt=dt.get(gt)||null,Re(nt,dt,""+Qt,Bs);if(typeof Qt=="object"&&Qt!==null){switch(Qt.$$typeof){case f:return dt=dt.get(Qt.key===null?gt:Qt.key)||null,tt(nt,dt,Qt,Bs);case y:return dt=dt.get(Qt.key===null?gt:Qt.key)||null,yt(nt,dt,Qt,Bs);case R:return Qt=ht(Qt),St(dt,nt,gt,Qt,Bs)}if(O(Qt)||E(Qt))return dt=dt.get(gt)||null,Dt(nt,dt,Qt,Bs,null);if(typeof Qt.then=="function")return St(dt,nt,gt,cs(Qt),Bs);if(Qt.$$typeof===K)return St(dt,nt,gt,su(nt,Qt),Bs);ps(nt,Qt)}return null}function gs(dt,nt,gt,Qt){for(var Bs=null,_a=null,js=nt,Ys=nt=0,ca=null;js!==null&&Ys<gt.length;Ys++){js.index>Ys?(ca=js,js=null):ca=js.sibling;var Ca=jt(dt,js,gt[Ys],Qt);if(Ca===null){js===null&&(js=ca);break}n&&js&&Ca.alternate===null&&i(dt,js),nt=L(Ca,nt,Ys),_a===null?Bs=Ca:_a.sibling=Ca,_a=Ca,js=ca}if(Ys===gt.length)return d(dt,js),ea&&fl(dt,Ys),Bs;if(js===null){for(;Ys<gt.length;Ys++)js=It(dt,gt[Ys],Qt),js!==null&&(nt=L(js,nt,Ys),_a===null?Bs=js:_a.sibling=js,_a=js);return ea&&fl(dt,Ys),Bs}for(js=p(js);Ys<gt.length;Ys++)ca=St(js,dt,Ys,gt[Ys],Qt),ca!==null&&(n&&ca.alternate!==null&&js.delete(ca.key===null?Ys:ca.key),nt=L(ca,nt,Ys),_a===null?Bs=ca:_a.sibling=ca,_a=ca);return n&&js.forEach(function(Sd){return i(dt,Sd)}),ea&&fl(dt,Ys),Bs}function Ls(dt,nt,gt,Qt){if(gt==null)throw Error(r(151));for(var Bs=null,_a=null,js=nt,Ys=nt=0,ca=null,Ca=gt.next();js!==null&&!Ca.done;Ys++,Ca=gt.next()){js.index>Ys?(ca=js,js=null):ca=js.sibling;var Sd=jt(dt,js,Ca.value,Qt);if(Sd===null){js===null&&(js=ca);break}n&&js&&Sd.alternate===null&&i(dt,js),nt=L(Sd,nt,Ys),_a===null?Bs=Sd:_a.sibling=Sd,_a=Sd,js=ca}if(Ca.done)return d(dt,js),ea&&fl(dt,Ys),Bs;if(js===null){for(;!Ca.done;Ys++,Ca=gt.next())Ca=It(dt,Ca.value,Qt),Ca!==null&&(nt=L(Ca,nt,Ys),_a===null?Bs=Ca:_a.sibling=Ca,_a=Ca);return ea&&fl(dt,Ys),Bs}for(js=p(js);!Ca.done;Ys++,Ca=gt.next())Ca=St(js,dt,Ys,Ca.value,Qt),Ca!==null&&(n&&Ca.alternate!==null&&js.delete(Ca.key===null?Ys:Ca.key),nt=L(Ca,nt,Ys),_a===null?Bs=Ca:_a.sibling=Ca,_a=Ca);return n&&js.forEach(function(LC){return i(dt,LC)}),ea&&fl(dt,Ys),Bs}function za(dt,nt,gt,Qt){if(typeof gt=="object"&&gt!==null&&gt.type===v&&gt.key===null&&(gt=gt.props.children),typeof gt=="object"&&gt!==null){switch(gt.$$typeof){case f:e:{for(var Bs=gt.key;nt!==null;){if(nt.key===Bs){if(Bs=gt.type,Bs===v){if(nt.tag===7){d(dt,nt.sibling),Qt=_(nt,gt.props.children),Qt.return=dt,dt=Qt;break e}}else if(nt.elementType===Bs||typeof Bs=="object"&&Bs!==null&&Bs.$$typeof===R&&ht(Bs)===nt.type){d(dt,nt.sibling),Qt=_(nt,gt.props),Hs(Qt,gt),Qt.return=dt,dt=Qt;break e}d(dt,nt);break}else i(dt,nt);nt=nt.sibling}gt.type===v?(Qt=Ec(gt.props.children,dt.mode,Qt,gt.key),Qt.return=dt,dt=Qt):(Qt=nd(gt.type,gt.key,gt.props,null,dt.mode,Qt),Hs(Qt,gt),Qt.return=dt,dt=Qt)}return ue(dt);case y:e:{for(Bs=gt.key;nt!==null;){if(nt.key===Bs)if(nt.tag===4&&nt.stateNode.containerInfo===gt.containerInfo&&nt.stateNode.implementation===gt.implementation){d(dt,nt.sibling),Qt=_(nt,gt.children||[]),Qt.return=dt,dt=Qt;break e}else{d(dt,nt);break}else i(dt,nt);nt=nt.sibling}Qt=ld(gt,dt.mode,Qt),Qt.return=dt,dt=Qt}return ue(dt);case R:return gt=ht(gt),za(dt,nt,gt,Qt)}if(O(gt))return gs(dt,nt,gt,Qt);if(E(gt)){if(Bs=E(gt),typeof Bs!="function")throw Error(r(150));return gt=Bs.call(gt),Ls(dt,nt,gt,Qt)}if(typeof gt.then=="function")return za(dt,nt,cs(gt),Qt);if(gt.$$typeof===K)return za(dt,nt,su(dt,gt),Qt);ps(dt,gt)}return typeof gt=="string"&&gt!==""||typeof gt=="number"||typeof gt=="bigint"?(gt=""+gt,nt!==null&&nt.tag===6?(d(dt,nt.sibling),Qt=_(nt,gt),Qt.return=dt,dt=Qt):(d(dt,nt),Qt=lm(gt,dt.mode,Qt),Qt.return=dt,dt=Qt),ue(dt)):d(dt,nt)}return function(dt,nt,gt,Qt){try{fs=0;var Bs=za(dt,nt,gt,Qt);return Pt=null,Bs}catch(js){if(js===rt||js===Ve)throw js;var _a=kn(29,js,null,dt.mode);return _a.lanes=Qt,_a.return=dt,_a}finally{}}}var Ya=Zs(!0),zs=Zs(!1),os=!1;function ts(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function sr(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Ds(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Ks(n,i,d){var p=n.updateQueue;if(p===null)return null;if(p=p.shared,(Ea&2)!==0){var _=p.pending;return _===null?i.next=i:(i.next=_.next,_.next=i),p.pending=i,i=Sn(n),rm(n,null,d),i}return am(n,p,i,d),Sn(n)}function Ba(n,i,d){if(i=i.updateQueue,i!==null&&(i=i.shared,(d&4194048)!==0)){var p=i.lanes;p&=n.pendingLanes,d|=p,i.lanes=d,Rs(n,d)}}function Kr(n,i){var d=n.updateQueue,p=n.alternate;if(p!==null&&(p=p.updateQueue,d===p)){var _=null,L=null;if(d=d.firstBaseUpdate,d!==null){do{var ue={lane:d.lane,tag:d.tag,payload:d.payload,callback:null,next:null};L===null?_=L=ue:L=L.next=ue,d=d.next}while(d!==null);L===null?_=L=i:L=L.next=i}else _=L=i;d={baseState:p.baseState,firstBaseUpdate:_,lastBaseUpdate:L,shared:p.shared,callbacks:p.callbacks},n.updateQueue=d;return}n=d.lastBaseUpdate,n===null?d.firstBaseUpdate=i:n.next=i,d.lastBaseUpdate=i}var Nn=!1;function Ha(){if(Nn){var n=S;if(n!==null)throw n}}function Er(n,i,d,p){Nn=!1;var _=n.updateQueue;os=!1;var L=_.firstBaseUpdate,ue=_.lastBaseUpdate,Re=_.shared.pending;if(Re!==null){_.shared.pending=null;var tt=Re,yt=tt.next;tt.next=null,ue===null?L=yt:ue.next=yt,ue=tt;var Dt=n.alternate;Dt!==null&&(Dt=Dt.updateQueue,Re=Dt.lastBaseUpdate,Re!==ue&&(Re===null?Dt.firstBaseUpdate=yt:Re.next=yt,Dt.lastBaseUpdate=tt))}if(L!==null){var It=_.baseState;ue=0,Dt=yt=tt=null,Re=L;do{var jt=Re.lane&-536870913,St=jt!==Re.lane;if(St?(ia&jt)===jt:(p&jt)===jt){jt!==0&&jt===b&&(Nn=!0),Dt!==null&&(Dt=Dt.next={lane:0,tag:Re.tag,payload:Re.payload,callback:null,next:null});e:{var gs=n,Ls=Re;jt=i;var za=d;switch(Ls.tag){case 1:if(gs=Ls.payload,typeof gs=="function"){It=gs.call(za,It,jt);break e}It=gs;break e;case 3:gs.flags=gs.flags&-65537|128;case 0:if(gs=Ls.payload,jt=typeof gs=="function"?gs.call(za,It,jt):gs,jt==null)break e;It=g({},It,jt);break e;case 2:os=!0}}jt=Re.callback,jt!==null&&(n.flags|=64,St&&(n.flags|=8192),St=_.callbacks,St===null?_.callbacks=[jt]:St.push(jt))}else St={lane:jt,tag:Re.tag,payload:Re.payload,callback:Re.callback,next:null},Dt===null?(yt=Dt=St,tt=It):Dt=Dt.next=St,ue|=jt;if(Re=Re.next,Re===null){if(Re=_.shared.pending,Re===null)break;St=Re,Re=St.next,St.next=null,_.lastBaseUpdate=St,_.shared.pending=null}}while(!0);Dt===null&&(tt=It),_.baseState=tt,_.firstBaseUpdate=yt,_.lastBaseUpdate=Dt,L===null&&(_.shared.lanes=0),gd|=ue,n.lanes=ue,n.memoizedState=It}}function Bn(n,i){if(typeof n!="function")throw Error(r(191,n));n.call(i)}function Dr(n,i){var d=n.callbacks;if(d!==null)for(n.callbacks=null,n=0;n<d.length;n++)Bn(d[n],i)}var Xs=I(null),Aa=I(0);function ar(n,i){n=So,ae(Aa,n),ae(Xs,i),So=n|i.baseLanes}function ja(){ae(Aa,So),ae(Xs,Xs.current)}function Vr(){So=Aa.current,H(Xs),H(Aa)}var rr=I(null),ga=null;function kr(n){var i=n.alternate;ae(xa,xa.current&1),ae(rr,n),ga===null&&(i===null||Xs.current!==null||i.memoizedState!==null)&&(ga=n)}function Fa(n){ae(xa,xa.current),ae(rr,n),ga===null&&(ga=n)}function Ur(n){n.tag===22?(ae(xa,xa.current),ae(rr,n),ga===null&&(ga=n)):Tr()}function Tr(){ae(xa,xa.current),ae(rr,rr.current)}function Ta(n){H(rr),ga===n&&(ga=null),H(xa)}var xa=I(0);function Fn(n){for(var i=n;i!==null;){if(i.tag===13){var d=i.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||Q0(d)||R0(d)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Ar=0,Cs=null,ks=null,fa=null,Vn=!1,Ll=!1,$n=!1,Lr=0,Mc=0,Ic=null,ru=0;function Pa(){throw Error(r(321))}function hx(n,i){if(i===null)return!1;for(var d=0;d<i.length&&d<n.length;d++)if(!fn(n[d],i[d]))return!1;return!0}function px(n,i,d,p,_,L){return Ar=L,Cs=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,V.H=n===null||n.memoizedState===null?tj:Kg,$n=!1,L=d(p,_),$n=!1,Ll&&(L=lc(i,d,p,_)),nu(n),L}function nu(n){V.H=Nx;var i=ks!==null&&ks.next!==null;if(Ar=0,fa=ks=Cs=null,Vn=!1,Mc=0,Ic=null,i)throw Error(r(300));n===null||nn||(n=n.dependencies,n!==null&&tu(n)&&(nn=!0))}function lc(n,i,d,p){Cs=n;var _=0;do{if(Ll&&(Ic=null),Mc=0,Ll=!1,25<=_)throw Error(r(301));if(_+=1,fa=ks=null,n.updateQueue!=null){var L=n.updateQueue;L.lastEffect=null,L.events=null,L.stores=null,L.memoCache!=null&&(L.memoCache.index=0)}V.H=sj,L=i(d,p)}while(Ll);return L}function $g(){var n=V.H,i=n.useState()[0];return i=typeof i.then=="function"?$c(i):i,n=n.useState()[0],(ks!==null?ks.memoizedState:null)!==n&&(Cs.flags|=1024),i}function Ax(){var n=Lr!==0;return Lr=0,n}function gx(n,i,d){i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~d}function lu(n){if(Vn){for(n=n.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Vn=!1}Ar=0,fa=ks=Cs=null,Ll=!1,Mc=Lr=0,Ic=null}function rn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fa===null?Cs.memoizedState=fa=n:fa=fa.next=n,fa}function gr(){if(ks===null){var n=Cs.alternate;n=n!==null?n.memoizedState:null}else n=ks.next;var i=fa===null?Cs.memoizedState:fa.next;if(i!==null)fa=i,ks=n;else{if(n===null)throw Cs.alternate===null?Error(r(467)):Error(r(310));ks=n,n={memoizedState:ks.memoizedState,baseState:ks.baseState,baseQueue:ks.baseQueue,queue:ks.queue,next:null},fa===null?Cs.memoizedState=fa=n:fa=fa.next=n}return fa}function dm(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function $c(n){var i=Mc;return Mc+=1,Ic===null&&(Ic=[]),n=Ft(Ic,n,i),i=Cs,(fa===null?i.memoizedState:fa.next)===null&&(i=i.alternate,V.H=i===null||i.memoizedState===null?tj:Kg),n}function md(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return $c(n);if(n.$$typeof===K)return vn(n)}throw Error(r(438,String(n)))}function fo(n){var i=null,d=Cs.updateQueue;if(d!==null&&(i=d.memoCache),i==null){var p=Cs.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(i={data:p.data.map(function(_){return _.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),d===null&&(d=dm(),Cs.updateQueue=d),d.memoCache=i,d=i.data[i.index],d===void 0)for(d=i.data[i.index]=Array(n),p=0;p<n;p++)d[p]=T;return i.index++,d}function Ni(n,i){return typeof i=="function"?i(n):i}function iu(n){var i=gr();return ud(i,ks,n)}function ud(n,i,d){var p=n.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=d;var _=n.baseQueue,L=p.pending;if(L!==null){if(_!==null){var ue=_.next;_.next=L.next,L.next=ue}i.baseQueue=_=L,p.pending=null}if(L=n.baseState,_===null)n.memoizedState=L;else{i=_.next;var Re=ue=null,tt=null,yt=i,Dt=!1;do{var It=yt.lane&-536870913;if(It!==yt.lane?(ia&It)===It:(Ar&It)===It){var jt=yt.revertLane;if(jt===0)tt!==null&&(tt=tt.next={lane:0,revertLane:0,gesture:null,action:yt.action,hasEagerState:yt.hasEagerState,eagerState:yt.eagerState,next:null}),It===b&&(Dt=!0);else if((Ar&jt)===jt){yt=yt.next,jt===b&&(Dt=!0);continue}else It={lane:0,revertLane:yt.revertLane,gesture:null,action:yt.action,hasEagerState:yt.hasEagerState,eagerState:yt.eagerState,next:null},tt===null?(Re=tt=It,ue=L):tt=tt.next=It,Cs.lanes|=jt,gd|=jt;It=yt.action,$n&&d(L,It),L=yt.hasEagerState?yt.eagerState:d(L,It)}else jt={lane:It,revertLane:yt.revertLane,gesture:yt.gesture,action:yt.action,hasEagerState:yt.hasEagerState,eagerState:yt.eagerState,next:null},tt===null?(Re=tt=jt,ue=L):tt=tt.next=jt,Cs.lanes|=It,gd|=It;yt=yt.next}while(yt!==null&&yt!==i);if(tt===null?ue=L:tt.next=Re,!fn(L,n.memoizedState)&&(nn=!0,Dt&&(d=S,d!==null)))throw d;n.memoizedState=L,n.baseState=ue,n.baseQueue=tt,p.lastRenderedState=L}return _===null&&(p.lanes=0),[n.memoizedState,p.dispatch]}function cu(n){var i=gr(),d=i.queue;if(d===null)throw Error(r(311));d.lastRenderedReducer=n;var p=d.dispatch,_=d.pending,L=i.memoizedState;if(_!==null){d.pending=null;var ue=_=_.next;do L=n(L,ue.action),ue=ue.next;while(ue!==_);fn(L,i.memoizedState)||(nn=!0),i.memoizedState=L,i.baseQueue===null&&(i.baseState=L),d.lastRenderedState=L}return[L,p]}function ou(n,i,d){var p=Cs,_=gr(),L=ea;if(L){if(d===void 0)throw Error(r(407));d=d()}else d=i();var ue=!fn((ks||_).memoizedState,d);if(ue&&(_.memoizedState=d,nn=!0),_=_.queue,Hg(bx.bind(null,p,_,n),[n]),_.getSnapshot!==i||ue||fa!==null&&fa.memoizedState.tag&1){if(p.flags|=2048,yo(9,{destroy:void 0},fx.bind(null,p,_,d,i),null),Wa===null)throw Error(r(349));L||(Ar&127)!==0||ic(p,i,d)}return d}function ic(n,i,d){n.flags|=16384,n={getSnapshot:i,value:d},i=Cs.updateQueue,i===null?(i=dm(),Cs.updateQueue=i,i.stores=[n]):(d=i.stores,d===null?i.stores=[n]:d.push(n))}function fx(n,i,d,p){i.value=d,i.getSnapshot=p,Jh(i)&&yx(n)}function bx(n,i,d){return d(function(){Jh(i)&&yx(n)})}function Jh(n){var i=n.getSnapshot;n=n.value;try{var d=i();return!fn(n,d)}catch{return!0}}function yx(n){var i=rc(n,2);i!==null&&$l(i,n,2)}function Hc(n){var i=rn();if(typeof n=="function"){var d=n;if(n=d(),$n){Ie(!0);try{d()}finally{Ie(!1)}}}return i.memoizedState=i.baseState=n,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ni,lastRenderedState:n},i}function Zh(n,i,d,p){return n.baseState=d,ud(n,ks,typeof p=="function"?p:Ni)}function ep(n,i,d,p,_){if(rp(n))throw Error(r(485));if(n=i.action,n!==null){var L={payload:_,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ue){L.listeners.push(ue)}};V.T!==null?d(!0):L.isTransition=!1,p(L),d=i.pending,d===null?(L.next=i.pending=L,tp(i,L)):(L.next=d.next,i.pending=d.next=L)}}function tp(n,i){var d=i.action,p=i.payload,_=n.state;if(i.isTransition){var L=V.T,ue={};V.T=ue;try{var Re=d(_,p),tt=V.S;tt!==null&&tt(ue,Re),jx(n,i,Re)}catch(yt){bo(n,i,yt)}finally{L!==null&&ue.types!==null&&(L.types=ue.types),V.T=L}}else try{L=d(_,p),jx(n,i,L)}catch(yt){bo(n,i,yt)}}function jx(n,i,d){d!==null&&typeof d=="object"&&typeof d.then=="function"?d.then(function(p){sp(n,i,p)},function(p){return bo(n,i,p)}):sp(n,i,d)}function sp(n,i,d){i.status="fulfilled",i.value=d,du(i),n.state=d,i=n.pending,i!==null&&(d=i.next,d===i?n.pending=null:(d=d.next,i.next=d,tp(n,d)))}function bo(n,i,d){var p=n.pending;if(n.pending=null,p!==null){p=p.next;do i.status="rejected",i.reason=d,du(i),i=i.next;while(i!==p)}n.action=null}function du(n){n=n.listeners;for(var i=0;i<n.length;i++)(0,n[i])()}function mm(n,i){return i}function wi(n,i){if(ea){var d=Wa.formState;if(d!==null){e:{var p=Cs;if(ea){if(Va){t:{for(var _=Va,L=pr;_.nodeType!==8;){if(!L){_=null;break t}if(_=_i(_.nextSibling),_===null){_=null;break t}}L=_.data,_=L==="F!"||L==="F"?_:null}if(_){Va=_i(_.nextSibling),p=_.data==="F!";break e}}Uc(p)}p=!1}p&&(i=d[0])}}return d=rn(),d.memoizedState=d.baseState=i,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mm,lastRenderedState:i},d.queue=p,d=Jy.bind(null,Cs,p),p.dispatch=d,p=Hc(!1),L=qg.bind(null,Cs,!1,p.queue),p=rn(),_={state:i,dispatch:null,action:n,pending:null},p.queue=_,d=ep.bind(null,Cs,_,L,d),_.dispatch=d,p.memoizedState=n,[i,d,!1]}function cc(n){var i=gr();return oc(i,ks,n)}function oc(n,i,d){if(i=ud(n,i,mm)[0],n=iu(Ni)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var p=$c(i)}catch(ue){throw ue===rt?Ve:ue}else p=i;i=gr();var _=i.queue,L=_.dispatch;return d!==i.memoizedState&&(Cs.flags|=2048,yo(9,{destroy:void 0},mu.bind(null,_,d),null)),[p,L,n]}function mu(n,i){n.action=i}function uu(n){var i=gr(),d=ks;if(d!==null)return oc(i,d,n);gr(),i=i.memoizedState,d=gr();var p=d.queue.dispatch;return d.memoizedState=n,[i,p,!1]}function yo(n,i,d,p){return n={tag:n,create:d,deps:p,inst:i,next:null},i=Cs.updateQueue,i===null&&(i=dm(),Cs.updateQueue=i),d=i.lastEffect,d===null?i.lastEffect=n.next=n:(p=d.next,d.next=n,n.next=p,i.lastEffect=n),n}function ap(){return gr().memoizedState}function xd(n,i,d,p){var _=rn();Cs.flags|=n,_.memoizedState=yo(1|i,{destroy:void 0},d,p===void 0?null:p)}function hd(n,i,d,p){var _=gr();p=p===void 0?null:p;var L=_.memoizedState.inst;ks!==null&&p!==null&&hx(p,ks.memoizedState.deps)?_.memoizedState=yo(i,L,d,p):(Cs.flags|=n,_.memoizedState=yo(1|i,L,d,p))}function My(n,i){xd(8390656,8,n,i)}function Hg(n,i){hd(2048,8,n,i)}function B_(n){Cs.flags|=4;var i=Cs.updateQueue;if(i===null)i=dm(),Cs.updateQueue=i,i.events=[n];else{var d=i.events;d===null?i.events=[n]:d.push(n)}}function Iy(n){var i=gr().memoizedState;return B_({ref:i,nextImpl:n}),function(){if((Ea&2)!==0)throw Error(r(440));return i.impl.apply(void 0,arguments)}}function $y(n,i){return hd(4,2,n,i)}function Hy(n,i){return hd(4,4,n,i)}function Py(n,i){if(typeof i=="function"){n=n();var d=i(n);return function(){typeof d=="function"?d():i(null)}}if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function Oy(n,i,d){d=d!=null?d.concat([n]):null,hd(4,4,Py.bind(null,i,n),d)}function Pg(){}function zy(n,i){var d=gr();i=i===void 0?null:i;var p=d.memoizedState;return i!==null&&hx(i,p[1])?p[0]:(d.memoizedState=[n,i],n)}function Gy(n,i){var d=gr();i=i===void 0?null:i;var p=d.memoizedState;if(i!==null&&hx(i,p[1]))return p[0];if(p=n(),$n){Ie(!0);try{n()}finally{Ie(!1)}}return d.memoizedState=[p,i],p}function Og(n,i,d){return d===void 0||(Ar&1073741824)!==0&&(ia&261930)===0?n.memoizedState=i:(n.memoizedState=d,n=qj(),Cs.lanes|=n,gd|=n,d)}function qy(n,i,d,p){return fn(d,i)?d:Xs.current!==null?(n=Og(n,d,p),fn(n,i)||(nn=!0),n):(Ar&42)===0||(Ar&1073741824)!==0&&(ia&261930)===0?(nn=!0,n.memoizedState=d):(n=qj(),Cs.lanes|=n,gd|=n,i)}function Ky(n,i,d,p,_){var L=re.p;re.p=L!==0&&8>L?L:8;var ue=V.T,Re={};V.T=Re,qg(n,!1,i,d);try{var tt=_(),yt=V.S;if(yt!==null&&yt(Re,tt),tt!==null&&typeof tt=="object"&&typeof tt.then=="function"){var Dt=Be(tt,p);vx(n,i,Dt,ri(n))}else vx(n,i,p,ri(n))}catch(It){vx(n,i,{then:function(){},status:"rejected",reason:It},ri())}finally{re.p=L,ue!==null&&Re.types!==null&&(ue.types=Re.types),V.T=ue}}function F_(){}function zg(n,i,d,p){if(n.tag!==5)throw Error(r(476));var _=Vy(n).queue;Ky(n,_,i,ge,d===null?F_:function(){return Yy(n),d(p)})}function Vy(n){var i=n.memoizedState;if(i!==null)return i;i={memoizedState:ge,baseState:ge,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ni,lastRenderedState:ge},next:null};var d={};return i.next={memoizedState:d,baseState:d,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ni,lastRenderedState:d},next:null},n.memoizedState=i,n=n.alternate,n!==null&&(n.memoizedState=i),i}function Yy(n){var i=Vy(n);i.next===null&&(i=n.alternate.memoizedState),vx(n,i.next.queue,{},ri())}function Gg(){return vn(Ix)}function Wy(){return gr().memoizedState}function Xy(){return gr().memoizedState}function E_(n){for(var i=n.return;i!==null;){switch(i.tag){case 24:case 3:var d=ri();n=Ds(d);var p=Ks(i,n,d);p!==null&&($l(p,i,d),Ba(p,i,d)),i={cache:dd()},n.payload=i;return}i=i.return}}function D_(n,i,d){var p=ri();d={lane:p,revertLane:0,gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},rp(n)?Zy(i,d):(d=Km(n,i,d,p),d!==null&&($l(d,n,p),ej(d,i,p)))}function Jy(n,i,d){var p=ri();vx(n,i,d,p)}function vx(n,i,d,p){var _={lane:p,revertLane:0,gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null};if(rp(n))Zy(i,_);else{var L=n.alternate;if(n.lanes===0&&(L===null||L.lanes===0)&&(L=i.lastRenderedReducer,L!==null))try{var ue=i.lastRenderedState,Re=L(ue,d);if(_.hasEagerState=!0,_.eagerState=Re,fn(Re,ue))return am(n,i,_,0),Wa===null&&sm(),!1}catch{}finally{}if(d=Km(n,i,_,p),d!==null)return $l(d,n,p),ej(d,i,p),!0}return!1}function qg(n,i,d,p){if(p={lane:2,revertLane:w0(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},rp(n)){if(i)throw Error(r(479))}else i=Km(n,d,p,2),i!==null&&$l(i,n,2)}function rp(n){var i=n.alternate;return n===Cs||i!==null&&i===Cs}function Zy(n,i){Ll=Vn=!0;var d=n.pending;d===null?i.next=i:(i.next=d.next,d.next=i),n.pending=i}function ej(n,i,d){if((d&4194048)!==0){var p=i.lanes;p&=n.pendingLanes,d|=p,i.lanes=d,Rs(n,d)}}var Nx={readContext:vn,use:md,useCallback:Pa,useContext:Pa,useEffect:Pa,useImperativeHandle:Pa,useLayoutEffect:Pa,useInsertionEffect:Pa,useMemo:Pa,useReducer:Pa,useRef:Pa,useState:Pa,useDebugValue:Pa,useDeferredValue:Pa,useTransition:Pa,useSyncExternalStore:Pa,useId:Pa,useHostTransitionStatus:Pa,useFormState:Pa,useActionState:Pa,useOptimistic:Pa,useMemoCache:Pa,useCacheRefresh:Pa};Nx.useEffectEvent=Pa;var tj={readContext:vn,use:md,useCallback:function(n,i){return rn().memoizedState=[n,i===void 0?null:i],n},useContext:vn,useEffect:My,useImperativeHandle:function(n,i,d){d=d!=null?d.concat([n]):null,xd(4194308,4,Py.bind(null,i,n),d)},useLayoutEffect:function(n,i){return xd(4194308,4,n,i)},useInsertionEffect:function(n,i){xd(4,2,n,i)},useMemo:function(n,i){var d=rn();i=i===void 0?null:i;var p=n();if($n){Ie(!0);try{n()}finally{Ie(!1)}}return d.memoizedState=[p,i],p},useReducer:function(n,i,d){var p=rn();if(d!==void 0){var _=d(i);if($n){Ie(!0);try{d(i)}finally{Ie(!1)}}}else _=i;return p.memoizedState=p.baseState=_,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:_},p.queue=n,n=n.dispatch=D_.bind(null,Cs,n),[p.memoizedState,n]},useRef:function(n){var i=rn();return n={current:n},i.memoizedState=n},useState:function(n){n=Hc(n);var i=n.queue,d=Jy.bind(null,Cs,i);return i.dispatch=d,[n.memoizedState,d]},useDebugValue:Pg,useDeferredValue:function(n,i){var d=rn();return Og(d,n,i)},useTransition:function(){var n=Hc(!1);return n=Ky.bind(null,Cs,n.queue,!0,!1),rn().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,i,d){var p=Cs,_=rn();if(ea){if(d===void 0)throw Error(r(407));d=d()}else{if(d=i(),Wa===null)throw Error(r(349));(ia&127)!==0||ic(p,i,d)}_.memoizedState=d;var L={value:d,getSnapshot:i};return _.queue=L,My(bx.bind(null,p,L,n),[n]),p.flags|=2048,yo(9,{destroy:void 0},fx.bind(null,p,L,d,i),null),d},useId:function(){var n=rn(),i=Wa.identifierPrefix;if(ea){var d=Ul,p=Dl;d=(p&~(1<<32-mt(p)-1)).toString(32)+d,i="_"+i+"R_"+d,d=Lr++,0<d&&(i+="H"+d.toString(32)),i+="_"}else d=ru++,i="_"+i+"r_"+d.toString(32)+"_";return n.memoizedState=i},useHostTransitionStatus:Gg,useFormState:wi,useActionState:wi,useOptimistic:function(n){var i=rn();i.memoizedState=i.baseState=n;var d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=d,i=qg.bind(null,Cs,!0,d),d.dispatch=i,[n,i]},useMemoCache:fo,useCacheRefresh:function(){return rn().memoizedState=E_.bind(null,Cs)},useEffectEvent:function(n){var i=rn(),d={impl:n};return i.memoizedState=d,function(){if((Ea&2)!==0)throw Error(r(440));return d.impl.apply(void 0,arguments)}}},Kg={readContext:vn,use:md,useCallback:zy,useContext:vn,useEffect:Hg,useImperativeHandle:Oy,useInsertionEffect:$y,useLayoutEffect:Hy,useMemo:Gy,useReducer:iu,useRef:ap,useState:function(){return iu(Ni)},useDebugValue:Pg,useDeferredValue:function(n,i){var d=gr();return qy(d,ks.memoizedState,n,i)},useTransition:function(){var n=iu(Ni)[0],i=gr().memoizedState;return[typeof n=="boolean"?n:$c(n),i]},useSyncExternalStore:ou,useId:Wy,useHostTransitionStatus:Gg,useFormState:cc,useActionState:cc,useOptimistic:function(n,i){var d=gr();return Zh(d,ks,n,i)},useMemoCache:fo,useCacheRefresh:Xy};Kg.useEffectEvent=Iy;var sj={readContext:vn,use:md,useCallback:zy,useContext:vn,useEffect:Hg,useImperativeHandle:Oy,useInsertionEffect:$y,useLayoutEffect:Hy,useMemo:Gy,useReducer:cu,useRef:ap,useState:function(){return cu(Ni)},useDebugValue:Pg,useDeferredValue:function(n,i){var d=gr();return ks===null?Og(d,n,i):qy(d,ks.memoizedState,n,i)},useTransition:function(){var n=cu(Ni)[0],i=gr().memoizedState;return[typeof n=="boolean"?n:$c(n),i]},useSyncExternalStore:ou,useId:Wy,useHostTransitionStatus:Gg,useFormState:uu,useActionState:uu,useOptimistic:function(n,i){var d=gr();return ks!==null?Zh(d,ks,n,i):(d.baseState=n,[n,d.queue.dispatch])},useMemoCache:fo,useCacheRefresh:Xy};sj.useEffectEvent=Iy;function Vg(n,i,d,p){i=n.memoizedState,d=d(p,i),d=d==null?i:g({},i,d),n.memoizedState=d,n.lanes===0&&(n.updateQueue.baseState=d)}var Yg={enqueueSetState:function(n,i,d){n=n._reactInternals;var p=ri(),_=Ds(p);_.payload=i,d!=null&&(_.callback=d),i=Ks(n,_,p),i!==null&&($l(i,n,p),Ba(i,n,p))},enqueueReplaceState:function(n,i,d){n=n._reactInternals;var p=ri(),_=Ds(p);_.tag=1,_.payload=i,d!=null&&(_.callback=d),i=Ks(n,_,p),i!==null&&($l(i,n,p),Ba(i,n,p))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var d=ri(),p=Ds(d);p.tag=2,i!=null&&(p.callback=i),i=Ks(n,p,d),i!==null&&($l(i,n,d),Ba(i,n,d))}};function aj(n,i,d,p,_,L,ue){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(p,L,ue):i.prototype&&i.prototype.isPureReactComponent?!ec(d,p)||!ec(_,L):!0}function rj(n,i,d,p){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(d,p),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(d,p),i.state!==n&&Yg.enqueueReplaceState(i,i.state,null)}function um(n,i){var d=i;if("ref"in i){d={};for(var p in i)p!=="ref"&&(d[p]=i[p])}if(n=n.defaultProps){d===i&&(d=g({},d));for(var _ in n)d[_]===void 0&&(d[_]=n[_])}return d}function nj(n){tm(n)}function lj(n){console.error(n)}function ij(n){tm(n)}function np(n,i){try{var d=n.onUncaughtError;d(i.value,{componentStack:i.stack})}catch(p){setTimeout(function(){throw p})}}function cj(n,i,d){try{var p=n.onCaughtError;p(d.value,{componentStack:d.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(_){setTimeout(function(){throw _})}}function Wg(n,i,d){return d=Ds(d),d.tag=3,d.payload={element:null},d.callback=function(){np(n,i)},d}function oj(n){return n=Ds(n),n.tag=3,n}function dj(n,i,d,p){var _=d.type.getDerivedStateFromError;if(typeof _=="function"){var L=p.value;n.payload=function(){return _(L)},n.callback=function(){cj(i,d,p)}}var ue=d.stateNode;ue!==null&&typeof ue.componentDidCatch=="function"&&(n.callback=function(){cj(i,d,p),typeof _!="function"&&(fd===null?fd=new Set([this]):fd.add(this));var Re=p.stack;this.componentDidCatch(p.value,{componentStack:Re!==null?Re:""})})}function U_(n,i,d,p,_){if(d.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(i=d.alternate,i!==null&&Qc(i,d,_,!0),d=rr.current,d!==null){switch(d.tag){case 31:case 13:return ga===null?gp():d.alternate===null&&Qr===0&&(Qr=3),d.flags&=-257,d.flags|=65536,d.lanes=_,p===it?d.flags|=16384:(i=d.updateQueue,i===null?d.updateQueue=new Set([p]):i.add(p),j0(n,p,_)),!1;case 22:return d.flags|=65536,p===it?d.flags|=16384:(i=d.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([p])},d.updateQueue=i):(d=i.retryQueue,d===null?i.retryQueue=new Set([p]):d.add(p)),j0(n,p,_)),!1}throw Error(r(435,d.tag))}return j0(n,p,_),gp(),!1}if(ea)return i=rr.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=_,p!==ti&&(n=Error(r(422),{cause:p}),cd(Bl(n,d)))):(p!==ti&&(i=Error(r(423),{cause:p}),cd(Bl(i,d))),n=n.current.alternate,n.flags|=65536,_&=-_,n.lanes|=_,p=Bl(p,d),_=Wg(n.stateNode,p,_),Kr(n,_),Qr!==4&&(Qr=2)),!1;var L=Error(r(520),{cause:p});if(L=Bl(L,d),Ex===null?Ex=[L]:Ex.push(L),Qr!==4&&(Qr=2),i===null)return!0;p=Bl(p,d),d=i;do{switch(d.tag){case 3:return d.flags|=65536,n=_&-_,d.lanes|=n,n=Wg(d.stateNode,p,n),Kr(d,n),!1;case 1:if(i=d.type,L=d.stateNode,(d.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||L!==null&&typeof L.componentDidCatch=="function"&&(fd===null||!fd.has(L))))return d.flags|=65536,_&=-_,d.lanes|=_,_=oj(_),dj(_,n,d,p),Kr(d,_),!1}d=d.return}while(d!==null);return!1}var Xg=Error(r(461)),nn=!1;function Hn(n,i,d,p){i.child=n===null?zs(i,null,d,p):Ya(i,n.child,d,p)}function mj(n,i,d,p,_){d=d.render;var L=i.ref;if("ref"in p){var ue={};for(var Re in p)Re!=="ref"&&(ue[Re]=p[Re])}else ue=p;return Rc(i),p=px(n,i,d,ue,L,_),Re=Ax(),n!==null&&!nn?(gx(n,i,_),jo(n,i,_)):(ea&&Re&&mx(i),i.flags|=1,Hn(n,i,p,_),i.child)}function uj(n,i,d,p,_){if(n===null){var L=d.type;return typeof L=="function"&&!Ym(L)&&L.defaultProps===void 0&&d.compare===null?(i.tag=15,i.type=L,xj(n,i,L,p,_)):(n=nd(d.type,null,p,i,i.mode,_),n.ref=i.ref,n.return=i,i.child=n)}if(L=n.child,!n0(n,_)){var ue=L.memoizedProps;if(d=d.compare,d=d!==null?d:ec,d(ue,p)&&n.ref===i.ref)return jo(n,i,_)}return i.flags|=1,n=kl(L,p),n.ref=i.ref,n.return=i,i.child=n}function xj(n,i,d,p,_){if(n!==null){var L=n.memoizedProps;if(ec(L,p)&&n.ref===i.ref)if(nn=!1,i.pendingProps=p=L,n0(n,_))(n.flags&131072)!==0&&(nn=!0);else return i.lanes=n.lanes,jo(n,i,_)}return Jg(n,i,d,p,_)}function hj(n,i,d,p){var _=p.children,L=n!==null?n.memoizedState:null;if(n===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((i.flags&128)!==0){if(L=L!==null?L.baseLanes|d:d,n!==null){for(p=i.child=n.child,_=0;p!==null;)_=_|p.lanes|p.childLanes,p=p.sibling;p=_&~L}else p=0,i.child=null;return pj(n,i,L,d,p)}if((d&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},n!==null&&Oe(i,L!==null?L.cachePool:null),L!==null?ar(i,L):ja(),Ur(i);else return p=i.lanes=536870912,pj(n,i,L!==null?L.baseLanes|d:d,d,p)}else L!==null?(Oe(i,L.cachePool),ar(i,L),Tr(),i.memoizedState=null):(n!==null&&Oe(i,null),ja(),Tr());return Hn(n,i,_,d),i.child}function wx(n,i){return n!==null&&n.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function pj(n,i,d,p,_){var L=$e();return L=L===null?null:{parent:Sr._currentValue,pool:L},i.memoizedState={baseLanes:d,cachePool:L},n!==null&&Oe(i,null),ja(),Ur(i),n!==null&&Qc(n,i,p,!0),i.childLanes=_,null}function lp(n,i){return i=cp({mode:i.mode,children:i.children},n.mode),i.ref=n.ref,n.child=i,i.return=n,i}function Aj(n,i,d){return Ya(i,n.child,null,d),n=lp(i,i.pendingProps),n.flags|=2,Ta(i),i.memoizedState=null,n}function T_(n,i,d){var p=i.pendingProps,_=(i.flags&128)!==0;if(i.flags&=-129,n===null){if(ea){if(p.mode==="hidden")return n=lp(i,p),i.lanes=536870912,wx(null,n);if(Fa(i),(n=Va)?(n=kv(n,pr),n=n!==null&&n.data==="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:Dc!==null?{id:Dl,overflow:Ul}:null,retryLane:536870912,hydrationErrors:null},d=Wm(n),d.return=i,i.child=d,yn=i,Va=null)):n=null,n===null)throw Uc(i);return i.lanes=536870912,null}return lp(i,p)}var L=n.memoizedState;if(L!==null){var ue=L.dehydrated;if(Fa(i),_)if(i.flags&256)i.flags&=-257,i=Aj(n,i,d);else if(i.memoizedState!==null)i.child=n.child,i.flags|=128,i=null;else throw Error(r(558));else if(nn||Qc(n,i,d,!1),_=(d&n.childLanes)!==0,nn||_){if(p=Wa,p!==null&&(ue=He(p,d),ue!==0&&ue!==L.retryLane))throw L.retryLane=ue,rc(n,ue),$l(p,n,ue),Xg;gp(),i=Aj(n,i,d)}else n=L.treeContext,Va=_i(ue.nextSibling),yn=i,ea=!0,In=null,pr=!1,n!==null&&Wh(i,n),i=lp(i,p),i.flags|=4096;return i}return n=kl(n.child,{mode:p.mode,children:p.children}),n.ref=i.ref,i.child=n,n.return=i,n}function ip(n,i){var d=i.ref;if(d===null)n!==null&&n.ref!==null&&(i.flags|=4194816);else{if(typeof d!="function"&&typeof d!="object")throw Error(r(284));(n===null||n.ref!==d)&&(i.flags|=4194816)}}function Jg(n,i,d,p,_){return Rc(i),d=px(n,i,d,p,void 0,_),p=Ax(),n!==null&&!nn?(gx(n,i,_),jo(n,i,_)):(ea&&p&&mx(i),i.flags|=1,Hn(n,i,d,_),i.child)}function gj(n,i,d,p,_,L){return Rc(i),i.updateQueue=null,d=lc(i,p,d,_),nu(n),p=Ax(),n!==null&&!nn?(gx(n,i,L),jo(n,i,L)):(ea&&p&&mx(i),i.flags|=1,Hn(n,i,d,L),i.child)}function fj(n,i,d,p,_){if(Rc(i),i.stateNode===null){var L=bn,ue=d.contextType;typeof ue=="object"&&ue!==null&&(L=vn(ue)),L=new d(p,L),i.memoizedState=L.state!==null&&L.state!==void 0?L.state:null,L.updater=Yg,i.stateNode=L,L._reactInternals=i,L=i.stateNode,L.props=p,L.state=i.memoizedState,L.refs={},ts(i),ue=d.contextType,L.context=typeof ue=="object"&&ue!==null?vn(ue):bn,L.state=i.memoizedState,ue=d.getDerivedStateFromProps,typeof ue=="function"&&(Vg(i,d,ue,p),L.state=i.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof L.getSnapshotBeforeUpdate=="function"||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(ue=L.state,typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount(),ue!==L.state&&Yg.enqueueReplaceState(L,L.state,null),Er(i,p,L,_),Ha(),L.state=i.memoizedState),typeof L.componentDidMount=="function"&&(i.flags|=4194308),p=!0}else if(n===null){L=i.stateNode;var Re=i.memoizedProps,tt=um(d,Re);L.props=tt;var yt=L.context,Dt=d.contextType;ue=bn,typeof Dt=="object"&&Dt!==null&&(ue=vn(Dt));var It=d.getDerivedStateFromProps;Dt=typeof It=="function"||typeof L.getSnapshotBeforeUpdate=="function",Re=i.pendingProps!==Re,Dt||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(Re||yt!==ue)&&rj(i,L,p,ue),os=!1;var jt=i.memoizedState;L.state=jt,Er(i,p,L,_),Ha(),yt=i.memoizedState,Re||jt!==yt||os?(typeof It=="function"&&(Vg(i,d,It,p),yt=i.memoizedState),(tt=os||aj(i,d,tt,p,jt,yt,ue))?(Dt||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount()),typeof L.componentDidMount=="function"&&(i.flags|=4194308)):(typeof L.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=p,i.memoizedState=yt),L.props=p,L.state=yt,L.context=ue,p=tt):(typeof L.componentDidMount=="function"&&(i.flags|=4194308),p=!1)}else{L=i.stateNode,sr(n,i),ue=i.memoizedProps,Dt=um(d,ue),L.props=Dt,It=i.pendingProps,jt=L.context,yt=d.contextType,tt=bn,typeof yt=="object"&&yt!==null&&(tt=vn(yt)),Re=d.getDerivedStateFromProps,(yt=typeof Re=="function"||typeof L.getSnapshotBeforeUpdate=="function")||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(ue!==It||jt!==tt)&&rj(i,L,p,tt),os=!1,jt=i.memoizedState,L.state=jt,Er(i,p,L,_),Ha();var St=i.memoizedState;ue!==It||jt!==St||os||n!==null&&n.dependencies!==null&&tu(n.dependencies)?(typeof Re=="function"&&(Vg(i,d,Re,p),St=i.memoizedState),(Dt=os||aj(i,d,Dt,p,jt,St,tt)||n!==null&&n.dependencies!==null&&tu(n.dependencies))?(yt||typeof L.UNSAFE_componentWillUpdate!="function"&&typeof L.componentWillUpdate!="function"||(typeof L.componentWillUpdate=="function"&&L.componentWillUpdate(p,St,tt),typeof L.UNSAFE_componentWillUpdate=="function"&&L.UNSAFE_componentWillUpdate(p,St,tt)),typeof L.componentDidUpdate=="function"&&(i.flags|=4),typeof L.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof L.componentDidUpdate!="function"||ue===n.memoizedProps&&jt===n.memoizedState||(i.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||ue===n.memoizedProps&&jt===n.memoizedState||(i.flags|=1024),i.memoizedProps=p,i.memoizedState=St),L.props=p,L.state=St,L.context=tt,p=Dt):(typeof L.componentDidUpdate!="function"||ue===n.memoizedProps&&jt===n.memoizedState||(i.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||ue===n.memoizedProps&&jt===n.memoizedState||(i.flags|=1024),p=!1)}return L=p,ip(n,i),p=(i.flags&128)!==0,L||p?(L=i.stateNode,d=p&&typeof d.getDerivedStateFromError!="function"?null:L.render(),i.flags|=1,n!==null&&p?(i.child=Ya(i,n.child,null,_),i.child=Ya(i,null,d,_)):Hn(n,i,d,_),i.memoizedState=L.state,n=i.child):n=jo(n,i,_),n}function bj(n,i,d,p){return Ao(),i.flags|=256,Hn(n,i,d,p),i.child}var Zg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function e0(n){return{baseLanes:n,cachePool:Ye()}}function t0(n,i,d){return n=n!==null?n.childLanes&~d:0,i&&(n|=ai),n}function yj(n,i,d){var p=i.pendingProps,_=!1,L=(i.flags&128)!==0,ue;if((ue=L)||(ue=n!==null&&n.memoizedState===null?!1:(xa.current&2)!==0),ue&&(_=!0,i.flags&=-129),ue=(i.flags&32)!==0,i.flags&=-33,n===null){if(ea){if(_?kr(i):Tr(),(n=Va)?(n=kv(n,pr),n=n!==null&&n.data!=="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:Dc!==null?{id:Dl,overflow:Ul}:null,retryLane:536870912,hydrationErrors:null},d=Wm(n),d.return=i,i.child=d,yn=i,Va=null)):n=null,n===null)throw Uc(i);return R0(n)?i.lanes=32:i.lanes=536870912,null}var Re=p.children;return p=p.fallback,_?(Tr(),_=i.mode,Re=cp({mode:"hidden",children:Re},_),p=Ec(p,_,d,null),Re.return=i,p.return=i,Re.sibling=p,i.child=Re,p=i.child,p.memoizedState=e0(d),p.childLanes=t0(n,ue,d),i.memoizedState=Zg,wx(null,p)):(kr(i),s0(i,Re))}var tt=n.memoizedState;if(tt!==null&&(Re=tt.dehydrated,Re!==null)){if(L)i.flags&256?(kr(i),i.flags&=-257,i=a0(n,i,d)):i.memoizedState!==null?(Tr(),i.child=n.child,i.flags|=128,i=null):(Tr(),Re=p.fallback,_=i.mode,p=cp({mode:"visible",children:p.children},_),Re=Ec(Re,_,d,null),Re.flags|=2,p.return=i,Re.return=i,p.sibling=Re,i.child=p,Ya(i,n.child,null,d),p=i.child,p.memoizedState=e0(d),p.childLanes=t0(n,ue,d),i.memoizedState=Zg,i=wx(null,p));else if(kr(i),R0(Re)){if(ue=Re.nextSibling&&Re.nextSibling.dataset,ue)var yt=ue.dgst;ue=yt,p=Error(r(419)),p.stack="",p.digest=ue,cd({value:p,source:null,stack:null}),i=a0(n,i,d)}else if(nn||Qc(n,i,d,!1),ue=(d&n.childLanes)!==0,nn||ue){if(ue=Wa,ue!==null&&(p=He(ue,d),p!==0&&p!==tt.retryLane))throw tt.retryLane=p,rc(n,p),$l(ue,n,p),Xg;Q0(Re)||gp(),i=a0(n,i,d)}else Q0(Re)?(i.flags|=192,i.child=n.child,i=null):(n=tt.treeContext,Va=_i(Re.nextSibling),yn=i,ea=!0,In=null,pr=!1,n!==null&&Wh(i,n),i=s0(i,p.children),i.flags|=4096);return i}return _?(Tr(),Re=p.fallback,_=i.mode,tt=n.child,yt=tt.sibling,p=kl(tt,{mode:"hidden",children:p.children}),p.subtreeFlags=tt.subtreeFlags&65011712,yt!==null?Re=kl(yt,Re):(Re=Ec(Re,_,d,null),Re.flags|=2),Re.return=i,p.return=i,p.sibling=Re,i.child=p,wx(null,p),p=i.child,Re=n.child.memoizedState,Re===null?Re=e0(d):(_=Re.cachePool,_!==null?(tt=Sr._currentValue,_=_.parent!==tt?{parent:tt,pool:tt}:_):_=Ye(),Re={baseLanes:Re.baseLanes|d,cachePool:_}),p.memoizedState=Re,p.childLanes=t0(n,ue,d),i.memoizedState=Zg,wx(n.child,p)):(kr(i),d=n.child,n=d.sibling,d=kl(d,{mode:"visible",children:p.children}),d.return=i,d.sibling=null,n!==null&&(ue=i.deletions,ue===null?(i.deletions=[n],i.flags|=16):ue.push(n)),i.child=d,i.memoizedState=null,d)}function s0(n,i){return i=cp({mode:"visible",children:i},n.mode),i.return=n,n.child=i}function cp(n,i){return n=kn(22,n,null,i),n.lanes=0,n}function a0(n,i,d){return Ya(i,n.child,null,d),n=s0(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function jj(n,i,d){n.lanes|=i;var p=n.alternate;p!==null&&(p.lanes|=i),od(n.return,i,d)}function r0(n,i,d,p,_,L){var ue=n.memoizedState;ue===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:p,tail:d,tailMode:_,treeForkCount:L}:(ue.isBackwards=i,ue.rendering=null,ue.renderingStartTime=0,ue.last=p,ue.tail=d,ue.tailMode=_,ue.treeForkCount=L)}function vj(n,i,d){var p=i.pendingProps,_=p.revealOrder,L=p.tail;p=p.children;var ue=xa.current,Re=(ue&2)!==0;if(Re?(ue=ue&1|2,i.flags|=128):ue&=1,ae(xa,ue),Hn(n,i,p,d),p=ea?im:0,!Re&&n!==null&&(n.flags&128)!==0)e:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&jj(n,d,i);else if(n.tag===19)jj(n,d,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(_){case"forwards":for(d=i.child,_=null;d!==null;)n=d.alternate,n!==null&&Fn(n)===null&&(_=d),d=d.sibling;d=_,d===null?(_=i.child,i.child=null):(_=d.sibling,d.sibling=null),r0(i,!1,_,d,L,p);break;case"backwards":case"unstable_legacy-backwards":for(d=null,_=i.child,i.child=null;_!==null;){if(n=_.alternate,n!==null&&Fn(n)===null){i.child=_;break}n=_.sibling,_.sibling=d,d=_,_=n}r0(i,!0,d,null,L,p);break;case"together":r0(i,!1,null,null,void 0,p);break;default:i.memoizedState=null}return i.child}function jo(n,i,d){if(n!==null&&(i.dependencies=n.dependencies),gd|=i.lanes,(d&i.childLanes)===0)if(n!==null){if(Qc(n,i,d,!1),(d&i.childLanes)===0)return null}else return null;if(n!==null&&i.child!==n.child)throw Error(r(153));if(i.child!==null){for(n=i.child,d=kl(n,n.pendingProps),i.child=d,d.return=i;n.sibling!==null;)n=n.sibling,d=d.sibling=kl(n,n.pendingProps),d.return=i;d.sibling=null}return i.child}function n0(n,i){return(n.lanes&i)!==0?!0:(n=n.dependencies,!!(n!==null&&tu(n)))}function L_(n,i,d){switch(i.tag){case 3:ne(i,i.stateNode.containerInfo),Lc(i,Sr,n.memoizedState.cache),Ao();break;case 27:case 5:je(i);break;case 4:ne(i,i.stateNode.containerInfo);break;case 10:Lc(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,Fa(i),null;break;case 13:var p=i.memoizedState;if(p!==null)return p.dehydrated!==null?(kr(i),i.flags|=128,null):(d&i.child.childLanes)!==0?yj(n,i,d):(kr(i),n=jo(n,i,d),n!==null?n.sibling:null);kr(i);break;case 19:var _=(n.flags&128)!==0;if(p=(d&i.childLanes)!==0,p||(Qc(n,i,d,!1),p=(d&i.childLanes)!==0),_){if(p)return vj(n,i,d);i.flags|=128}if(_=i.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),ae(xa,xa.current),p)break;return null;case 22:return i.lanes=0,hj(n,i,d,i.pendingProps);case 24:Lc(i,Sr,n.memoizedState.cache)}return jo(n,i,d)}function Nj(n,i,d){if(n!==null)if(n.memoizedProps!==i.pendingProps)nn=!0;else{if(!n0(n,d)&&(i.flags&128)===0)return nn=!1,L_(n,i,d);nn=(n.flags&131072)!==0}else nn=!1,ea&&(i.flags&1048576)!==0&&Yh(i,im,i.index);switch(i.lanes=0,i.tag){case 16:e:{var p=i.pendingProps;if(n=ht(i.elementType),i.type=n,typeof n=="function")Ym(n)?(p=um(n,p),i.tag=1,i=fj(null,i,n,p,d)):(i.tag=0,i=Jg(null,i,n,p,d));else{if(n!=null){var _=n.$$typeof;if(_===$){i.tag=11,i=mj(null,i,n,p,d);break e}else if(_===z){i.tag=14,i=uj(null,i,n,p,d);break e}}throw i=C(n)||n,Error(r(306,i,""))}}return i;case 0:return Jg(n,i,i.type,i.pendingProps,d);case 1:return p=i.type,_=um(p,i.pendingProps),fj(n,i,p,_,d);case 3:e:{if(ne(i,i.stateNode.containerInfo),n===null)throw Error(r(387));p=i.pendingProps;var L=i.memoizedState;_=L.element,sr(n,i),Er(i,p,null,d);var ue=i.memoizedState;if(p=ue.cache,Lc(i,Sr,p),p!==L.cache&&go(i,[Sr],d,!0),Ha(),p=ue.element,L.isDehydrated)if(L={element:p,isDehydrated:!1,cache:ue.cache},i.updateQueue.baseState=L,i.memoizedState=L,i.flags&256){i=bj(n,i,p,d);break e}else if(p!==_){_=Bl(Error(r(424)),i),cd(_),i=bj(n,i,p,d);break e}else{switch(n=i.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(Va=_i(n.firstChild),yn=i,ea=!0,In=null,pr=!0,d=zs(i,null,p,d),i.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling}else{if(Ao(),p===_){i=jo(n,i,d);break e}Hn(n,i,p,d)}i=i.child}return i;case 26:return ip(n,i),n===null?(d=Tv(i.type,null,i.pendingProps,null))?i.memoizedState=d:ea||(d=i.type,n=i.pendingProps,p=wp(w.current).createElement(d),p[ss]=i,p[he]=n,Pn(p,d,n),rs(p),i.stateNode=p):i.memoizedState=Tv(i.type,n.memoizedProps,i.pendingProps,n.memoizedState),null;case 27:return je(i),n===null&&ea&&(p=i.stateNode=Ev(i.type,i.pendingProps,w.current),yn=i,pr=!0,_=Va,vd(i.type)?(M0=_,Va=_i(p.firstChild)):Va=_),Hn(n,i,i.pendingProps.children,d),ip(n,i),n===null&&(i.flags|=4194304),i.child;case 5:return n===null&&ea&&((_=p=Va)&&(p=mC(p,i.type,i.pendingProps,pr),p!==null?(i.stateNode=p,yn=i,Va=_i(p.firstChild),pr=!1,_=!0):_=!1),_||Uc(i)),je(i),_=i.type,L=i.pendingProps,ue=n!==null?n.memoizedProps:null,p=L.children,U0(_,L)?p=null:ue!==null&&U0(_,ue)&&(i.flags|=32),i.memoizedState!==null&&(_=px(n,i,$g,null,null,d),Ix._currentValue=_),ip(n,i),Hn(n,i,p,d),i.child;case 6:return n===null&&ea&&((n=d=Va)&&(d=uC(d,i.pendingProps,pr),d!==null?(i.stateNode=d,yn=i,Va=null,n=!0):n=!1),n||Uc(i)),null;case 13:return yj(n,i,d);case 4:return ne(i,i.stateNode.containerInfo),p=i.pendingProps,n===null?i.child=Ya(i,null,p,d):Hn(n,i,p,d),i.child;case 11:return mj(n,i,i.type,i.pendingProps,d);case 7:return Hn(n,i,i.pendingProps,d),i.child;case 8:return Hn(n,i,i.pendingProps.children,d),i.child;case 12:return Hn(n,i,i.pendingProps.children,d),i.child;case 10:return p=i.pendingProps,Lc(i,i.type,p.value),Hn(n,i,p.children,d),i.child;case 9:return _=i.type._context,p=i.pendingProps.children,Rc(i),_=vn(_),p=p(_),i.flags|=1,Hn(n,i,p,d),i.child;case 14:return uj(n,i,i.type,i.pendingProps,d);case 15:return xj(n,i,i.type,i.pendingProps,d);case 19:return vj(n,i,d);case 31:return T_(n,i,d);case 22:return hj(n,i,d,i.pendingProps);case 24:return Rc(i),p=vn(Sr),n===null?(_=$e(),_===null&&(_=Wa,L=dd(),_.pooledCache=L,L.refCount++,L!==null&&(_.pooledCacheLanes|=d),_=L),i.memoizedState={parent:p,cache:_},ts(i),Lc(i,Sr,_)):((n.lanes&d)!==0&&(sr(n,i),Er(i,null,null,d),Ha()),_=n.memoizedState,L=i.memoizedState,_.parent!==p?(_={parent:p,cache:p},i.memoizedState=_,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=_),Lc(i,Sr,p)):(p=L.cache,Lc(i,Sr,p),p!==_.cache&&go(i,[Sr],d,!0))),Hn(n,i,i.pendingProps.children,d),i.child;case 29:throw i.pendingProps}throw Error(r(156,i.tag))}function vo(n){n.flags|=4}function l0(n,i,d,p,_){if((i=(n.mode&32)!==0)&&(i=!1),i){if(n.flags|=16777216,(_&335544128)===_)if(n.stateNode.complete)n.flags|=8192;else if(Wj())n.flags|=8192;else throw Bt=it,At}else n.flags&=-16777217}function wj(n,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Iv(i))if(Wj())n.flags|=8192;else throw Bt=it,At}function op(n,i){i!==null&&(n.flags|=4),n.flags&16384&&(i=n.tag!==22?be():536870912,n.lanes|=i,Au|=i)}function _x(n,i){if(!ea)switch(n.tailMode){case"hidden":i=n.tail;for(var d=null;i!==null;)i.alternate!==null&&(d=i),i=i.sibling;d===null?n.tail=null:d.sibling=null;break;case"collapsed":d=n.tail;for(var p=null;d!==null;)d.alternate!==null&&(p=d),d=d.sibling;p===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:p.sibling=null}}function nr(n){var i=n.alternate!==null&&n.alternate.child===n.child,d=0,p=0;if(i)for(var _=n.child;_!==null;)d|=_.lanes|_.childLanes,p|=_.subtreeFlags&65011712,p|=_.flags&65011712,_.return=n,_=_.sibling;else for(_=n.child;_!==null;)d|=_.lanes|_.childLanes,p|=_.subtreeFlags,p|=_.flags,_.return=n,_=_.sibling;return n.subtreeFlags|=p,n.childLanes=d,i}function Q_(n,i,d){var p=i.pendingProps;switch(Zm(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nr(i),null;case 1:return nr(i),null;case 3:return d=i.stateNode,p=null,n!==null&&(p=n.memoizedState.cache),i.memoizedState.cache!==p&&(i.flags|=2048),Tl(Sr),Fe(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(n===null||n.child===null)&&(jn(i)?vo(i):n===null||n.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,xx())),nr(i),null;case 26:var _=i.type,L=i.memoizedState;return n===null?(vo(i),L!==null?(nr(i),wj(i,L)):(nr(i),l0(i,_,null,p,d))):L?L!==n.memoizedState?(vo(i),nr(i),wj(i,L)):(nr(i),i.flags&=-16777217):(n=n.memoizedProps,n!==p&&vo(i),nr(i),l0(i,_,n,p,d)),null;case 27:if(Ge(i),d=w.current,_=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==p&&vo(i);else{if(!p){if(i.stateNode===null)throw Error(r(166));return nr(i),null}n=k.current,jn(i)?ux(i):(n=Ev(_,p,d),i.stateNode=n,vo(i))}return nr(i),null;case 5:if(Ge(i),_=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==p&&vo(i);else{if(!p){if(i.stateNode===null)throw Error(r(166));return nr(i),null}if(L=k.current,jn(i))ux(i);else{var ue=wp(w.current);switch(L){case 1:L=ue.createElementNS("http://www.w3.org/2000/svg",_);break;case 2:L=ue.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;default:switch(_){case"svg":L=ue.createElementNS("http://www.w3.org/2000/svg",_);break;case"math":L=ue.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;case"script":L=ue.createElement("div"),L.innerHTML="<script><\/script>",L=L.removeChild(L.firstChild);break;case"select":L=typeof p.is=="string"?ue.createElement("select",{is:p.is}):ue.createElement("select"),p.multiple?L.multiple=!0:p.size&&(L.size=p.size);break;default:L=typeof p.is=="string"?ue.createElement(_,{is:p.is}):ue.createElement(_)}}L[ss]=i,L[he]=p;e:for(ue=i.child;ue!==null;){if(ue.tag===5||ue.tag===6)L.appendChild(ue.stateNode);else if(ue.tag!==4&&ue.tag!==27&&ue.child!==null){ue.child.return=ue,ue=ue.child;continue}if(ue===i)break e;for(;ue.sibling===null;){if(ue.return===null||ue.return===i)break e;ue=ue.return}ue.sibling.return=ue.return,ue=ue.sibling}i.stateNode=L;e:switch(Pn(L,_,p),_){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&vo(i)}}return nr(i),l0(i,i.type,n===null?null:n.memoizedProps,i.pendingProps,d),null;case 6:if(n&&i.stateNode!=null)n.memoizedProps!==p&&vo(i);else{if(typeof p!="string"&&i.stateNode===null)throw Error(r(166));if(n=w.current,jn(i)){if(n=i.stateNode,d=i.memoizedProps,p=null,_=yn,_!==null)switch(_.tag){case 27:case 5:p=_.memoizedProps}n[ss]=i,n=!!(n.nodeValue===d||p!==null&&p.suppressHydrationWarning===!0||yv(n.nodeValue,d)),n||Uc(i,!0)}else n=wp(n).createTextNode(p),n[ss]=i,i.stateNode=n}return nr(i),null;case 31:if(d=i.memoizedState,n===null||n.memoizedState!==null){if(p=jn(i),d!==null){if(n===null){if(!p)throw Error(r(318));if(n=i.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(557));n[ss]=i}else Ao(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;nr(i),n=!1}else d=xx(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=d),n=!0;if(!n)return i.flags&256?(Ta(i),i):(Ta(i),null);if((i.flags&128)!==0)throw Error(r(558))}return nr(i),null;case 13:if(p=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(_=jn(i),p!==null&&p.dehydrated!==null){if(n===null){if(!_)throw Error(r(318));if(_=i.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(r(317));_[ss]=i}else Ao(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;nr(i),_=!1}else _=xx(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=_),_=!0;if(!_)return i.flags&256?(Ta(i),i):(Ta(i),null)}return Ta(i),(i.flags&128)!==0?(i.lanes=d,i):(d=p!==null,n=n!==null&&n.memoizedState!==null,d&&(p=i.child,_=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(_=p.alternate.memoizedState.cachePool.pool),L=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(L=p.memoizedState.cachePool.pool),L!==_&&(p.flags|=2048)),d!==n&&d&&(i.child.flags|=8192),op(i,i.updateQueue),nr(i),null);case 4:return Fe(),n===null&&k0(i.stateNode.containerInfo),nr(i),null;case 10:return Tl(i.type),nr(i),null;case 19:if(H(xa),p=i.memoizedState,p===null)return nr(i),null;if(_=(i.flags&128)!==0,L=p.rendering,L===null)if(_)_x(p,!1);else{if(Qr!==0||n!==null&&(n.flags&128)!==0)for(n=i.child;n!==null;){if(L=Fn(n),L!==null){for(i.flags|=128,_x(p,!1),n=L.updateQueue,i.updateQueue=n,op(i,n),i.subtreeFlags=0,n=d,d=i.child;d!==null;)nm(d,n),d=d.sibling;return ae(xa,xa.current&1|2),ea&&fl(i,p.treeForkCount),i.child}n=n.sibling}p.tail!==null&&ie()>hp&&(i.flags|=128,_=!0,_x(p,!1),i.lanes=4194304)}else{if(!_)if(n=Fn(L),n!==null){if(i.flags|=128,_=!0,n=n.updateQueue,i.updateQueue=n,op(i,n),_x(p,!0),p.tail===null&&p.tailMode==="hidden"&&!L.alternate&&!ea)return nr(i),null}else 2*ie()-p.renderingStartTime>hp&&d!==536870912&&(i.flags|=128,_=!0,_x(p,!1),i.lanes=4194304);p.isBackwards?(L.sibling=i.child,i.child=L):(n=p.last,n!==null?n.sibling=L:i.child=L,p.last=L)}return p.tail!==null?(n=p.tail,p.rendering=n,p.tail=n.sibling,p.renderingStartTime=ie(),n.sibling=null,d=xa.current,ae(xa,_?d&1|2:d&1),ea&&fl(i,p.treeForkCount),n):(nr(i),null);case 22:case 23:return Ta(i),Vr(),p=i.memoizedState!==null,n!==null?n.memoizedState!==null!==p&&(i.flags|=8192):p&&(i.flags|=8192),p?(d&536870912)!==0&&(i.flags&128)===0&&(nr(i),i.subtreeFlags&6&&(i.flags|=8192)):nr(i),d=i.updateQueue,d!==null&&op(i,d.retryQueue),d=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(d=n.memoizedState.cachePool.pool),p=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(p=i.memoizedState.cachePool.pool),p!==d&&(i.flags|=2048),n!==null&&H(Qe),null;case 24:return d=null,n!==null&&(d=n.memoizedState.cache),i.memoizedState.cache!==d&&(i.flags|=2048),Tl(Sr),nr(i),null;case 25:return null;case 30:return null}throw Error(r(156,i.tag))}function R_(n,i){switch(Zm(i),i.tag){case 1:return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return Tl(Sr),Fe(),n=i.flags,(n&65536)!==0&&(n&128)===0?(i.flags=n&-65537|128,i):null;case 26:case 27:case 5:return Ge(i),null;case 31:if(i.memoizedState!==null){if(Ta(i),i.alternate===null)throw Error(r(340));Ao()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 13:if(Ta(i),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(r(340));Ao()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return H(xa),null;case 4:return Fe(),null;case 10:return Tl(i.type),null;case 22:case 23:return Ta(i),Vr(),n!==null&&H(Qe),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 24:return Tl(Sr),null;case 25:return null;default:return null}}function _j(n,i){switch(Zm(i),i.tag){case 3:Tl(Sr),Fe();break;case 26:case 27:case 5:Ge(i);break;case 4:Fe();break;case 31:i.memoizedState!==null&&Ta(i);break;case 13:Ta(i);break;case 19:H(xa);break;case 10:Tl(i.type);break;case 22:case 23:Ta(i),Vr(),n!==null&&H(Qe);break;case 24:Tl(Sr)}}function Cx(n,i){try{var d=i.updateQueue,p=d!==null?d.lastEffect:null;if(p!==null){var _=p.next;d=_;do{if((d.tag&n)===n){p=void 0;var L=d.create,ue=d.inst;p=L(),ue.destroy=p}d=d.next}while(d!==_)}}catch(Re){Qa(i,i.return,Re)}}function pd(n,i,d){try{var p=i.updateQueue,_=p!==null?p.lastEffect:null;if(_!==null){var L=_.next;p=L;do{if((p.tag&n)===n){var ue=p.inst,Re=ue.destroy;if(Re!==void 0){ue.destroy=void 0,_=i;var tt=d,yt=Re;try{yt()}catch(Dt){Qa(_,tt,Dt)}}}p=p.next}while(p!==L)}}catch(Dt){Qa(i,i.return,Dt)}}function Cj(n){var i=n.updateQueue;if(i!==null){var d=n.stateNode;try{Dr(i,d)}catch(p){Qa(n,n.return,p)}}}function Sj(n,i,d){d.props=um(n.type,n.memoizedProps),d.state=n.memoizedState;try{d.componentWillUnmount()}catch(p){Qa(n,i,p)}}function Sx(n,i){try{var d=n.ref;if(d!==null){switch(n.tag){case 26:case 27:case 5:var p=n.stateNode;break;case 30:p=n.stateNode;break;default:p=n.stateNode}typeof d=="function"?n.refCleanup=d(p):d.current=p}}catch(_){Qa(n,i,_)}}function Pc(n,i){var d=n.ref,p=n.refCleanup;if(d!==null)if(typeof p=="function")try{p()}catch(_){Qa(n,i,_)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof d=="function")try{d(null)}catch(_){Qa(n,i,_)}else d.current=null}function kj(n){var i=n.type,d=n.memoizedProps,p=n.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":d.autoFocus&&p.focus();break e;case"img":d.src?p.src=d.src:d.srcSet&&(p.srcset=d.srcSet)}}catch(_){Qa(n,n.return,_)}}function i0(n,i,d){try{var p=n.stateNode;nC(p,n.type,d,i),p[he]=i}catch(_){Qa(n,n.return,_)}}function Bj(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&vd(n.type)||n.tag===4}function c0(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Bj(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&vd(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function o0(n,i,d){var p=n.tag;if(p===5||p===6)n=n.stateNode,i?(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d).insertBefore(n,i):(i=d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,i.appendChild(n),d=d._reactRootContainer,d!=null||i.onclick!==null||(i.onclick=Yl));else if(p!==4&&(p===27&&vd(n.type)&&(d=n.stateNode,i=null),n=n.child,n!==null))for(o0(n,i,d),n=n.sibling;n!==null;)o0(n,i,d),n=n.sibling}function dp(n,i,d){var p=n.tag;if(p===5||p===6)n=n.stateNode,i?d.insertBefore(n,i):d.appendChild(n);else if(p!==4&&(p===27&&vd(n.type)&&(d=n.stateNode),n=n.child,n!==null))for(dp(n,i,d),n=n.sibling;n!==null;)dp(n,i,d),n=n.sibling}function Fj(n){var i=n.stateNode,d=n.memoizedProps;try{for(var p=n.type,_=i.attributes;_.length;)i.removeAttributeNode(_[0]);Pn(i,p,d),i[ss]=n,i[he]=d}catch(L){Qa(n,n.return,L)}}var No=!1,ln=!1,d0=!1,Ej=typeof WeakSet=="function"?WeakSet:Set,En=null;function M_(n,i){if(n=n.containerInfo,E0=Ep,n=sc(n),yi(n)){if("selectionStart"in n)var d={start:n.selectionStart,end:n.selectionEnd};else e:{d=(d=n.ownerDocument)&&d.defaultView||window;var p=d.getSelection&&d.getSelection();if(p&&p.rangeCount!==0){d=p.anchorNode;var _=p.anchorOffset,L=p.focusNode;p=p.focusOffset;try{d.nodeType,L.nodeType}catch{d=null;break e}var ue=0,Re=-1,tt=-1,yt=0,Dt=0,It=n,jt=null;t:for(;;){for(var St;It!==d||_!==0&&It.nodeType!==3||(Re=ue+_),It!==L||p!==0&&It.nodeType!==3||(tt=ue+p),It.nodeType===3&&(ue+=It.nodeValue.length),(St=It.firstChild)!==null;)jt=It,It=St;for(;;){if(It===n)break t;if(jt===d&&++yt===_&&(Re=ue),jt===L&&++Dt===p&&(tt=ue),(St=It.nextSibling)!==null)break;It=jt,jt=It.parentNode}It=St}d=Re===-1||tt===-1?null:{start:Re,end:tt}}else d=null}d=d||{start:0,end:0}}else d=null;for(D0={focusedElem:n,selectionRange:d},Ep=!1,En=i;En!==null;)if(i=En,n=i.child,(i.subtreeFlags&1028)!==0&&n!==null)n.return=i,En=n;else for(;En!==null;){switch(i=En,L=i.alternate,n=i.flags,i.tag){case 0:if((n&4)!==0&&(n=i.updateQueue,n=n!==null?n.events:null,n!==null))for(d=0;d<n.length;d++)_=n[d],_.ref.impl=_.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&L!==null){n=void 0,d=i,_=L.memoizedProps,L=L.memoizedState,p=d.stateNode;try{var gs=um(d.type,_);n=p.getSnapshotBeforeUpdate(gs,L),p.__reactInternalSnapshotBeforeUpdate=n}catch(Ls){Qa(d,d.return,Ls)}}break;case 3:if((n&1024)!==0){if(n=i.stateNode.containerInfo,d=n.nodeType,d===9)L0(n);else if(d===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":L0(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(r(163))}if(n=i.sibling,n!==null){n.return=i.return,En=n;break}En=i.return}}function Dj(n,i,d){var p=d.flags;switch(d.tag){case 0:case 11:case 15:_o(n,d),p&4&&Cx(5,d);break;case 1:if(_o(n,d),p&4)if(n=d.stateNode,i===null)try{n.componentDidMount()}catch(ue){Qa(d,d.return,ue)}else{var _=um(d.type,i.memoizedProps);i=i.memoizedState;try{n.componentDidUpdate(_,i,n.__reactInternalSnapshotBeforeUpdate)}catch(ue){Qa(d,d.return,ue)}}p&64&&Cj(d),p&512&&Sx(d,d.return);break;case 3:if(_o(n,d),p&64&&(n=d.updateQueue,n!==null)){if(i=null,d.child!==null)switch(d.child.tag){case 27:case 5:i=d.child.stateNode;break;case 1:i=d.child.stateNode}try{Dr(n,i)}catch(ue){Qa(d,d.return,ue)}}break;case 27:i===null&&p&4&&Fj(d);case 26:case 5:_o(n,d),i===null&&p&4&&kj(d),p&512&&Sx(d,d.return);break;case 12:_o(n,d);break;case 31:_o(n,d),p&4&&Lj(n,d);break;case 13:_o(n,d),p&4&&Qj(n,d),p&64&&(n=d.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(d=K_.bind(null,d),xC(n,d))));break;case 22:if(p=d.memoizedState!==null||No,!p){i=i!==null&&i.memoizedState!==null||ln,_=No;var L=ln;No=p,(ln=i)&&!L?Co(n,d,(d.subtreeFlags&8772)!==0):_o(n,d),No=_,ln=L}break;case 30:break;default:_o(n,d)}}function Uj(n){var i=n.alternate;i!==null&&(n.alternate=null,Uj(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&ba(i)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var fr=null,Ql=!1;function wo(n,i,d){for(d=d.child;d!==null;)Tj(n,i,d),d=d.sibling}function Tj(n,i,d){if(W&&typeof W.onCommitFiberUnmount=="function")try{W.onCommitFiberUnmount(qe,d)}catch{}switch(d.tag){case 26:ln||Pc(d,i),wo(n,i,d),d.memoizedState?d.memoizedState.count--:d.stateNode&&(d=d.stateNode,d.parentNode.removeChild(d));break;case 27:ln||Pc(d,i);var p=fr,_=Ql;vd(d.type)&&(fr=d.stateNode,Ql=!1),wo(n,i,d),Qx(d.stateNode),fr=p,Ql=_;break;case 5:ln||Pc(d,i);case 6:if(p=fr,_=Ql,fr=null,wo(n,i,d),fr=p,Ql=_,fr!==null)if(Ql)try{(fr.nodeType===9?fr.body:fr.nodeName==="HTML"?fr.ownerDocument.body:fr).removeChild(d.stateNode)}catch(L){Qa(d,i,L)}else try{fr.removeChild(d.stateNode)}catch(L){Qa(d,i,L)}break;case 18:fr!==null&&(Ql?(n=fr,Cv(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,d.stateNode),wu(n)):Cv(fr,d.stateNode));break;case 4:p=fr,_=Ql,fr=d.stateNode.containerInfo,Ql=!0,wo(n,i,d),fr=p,Ql=_;break;case 0:case 11:case 14:case 15:pd(2,d,i),ln||pd(4,d,i),wo(n,i,d);break;case 1:ln||(Pc(d,i),p=d.stateNode,typeof p.componentWillUnmount=="function"&&Sj(d,i,p)),wo(n,i,d);break;case 21:wo(n,i,d);break;case 22:ln=(p=ln)||d.memoizedState!==null,wo(n,i,d),ln=p;break;default:wo(n,i,d)}}function Lj(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{wu(n)}catch(d){Qa(i,i.return,d)}}}function Qj(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{wu(n)}catch(d){Qa(i,i.return,d)}}function I_(n){switch(n.tag){case 31:case 13:case 19:var i=n.stateNode;return i===null&&(i=n.stateNode=new Ej),i;case 22:return n=n.stateNode,i=n._retryCache,i===null&&(i=n._retryCache=new Ej),i;default:throw Error(r(435,n.tag))}}function mp(n,i){var d=I_(n);i.forEach(function(p){if(!d.has(p)){d.add(p);var _=V_.bind(null,n,p);p.then(_,_)}})}function Rl(n,i){var d=i.deletions;if(d!==null)for(var p=0;p<d.length;p++){var _=d[p],L=n,ue=i,Re=ue;e:for(;Re!==null;){switch(Re.tag){case 27:if(vd(Re.type)){fr=Re.stateNode,Ql=!1;break e}break;case 5:fr=Re.stateNode,Ql=!1;break e;case 3:case 4:fr=Re.stateNode.containerInfo,Ql=!0;break e}Re=Re.return}if(fr===null)throw Error(r(160));Tj(L,ue,_),fr=null,Ql=!1,L=_.alternate,L!==null&&(L.return=null),_.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)Rj(i,n),i=i.sibling}var dc=null;function Rj(n,i){var d=n.alternate,p=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:Rl(i,n),Ml(n),p&4&&(pd(3,n,n.return),Cx(3,n),pd(5,n,n.return));break;case 1:Rl(i,n),Ml(n),p&512&&(ln||d===null||Pc(d,d.return)),p&64&&No&&(n=n.updateQueue,n!==null&&(p=n.callbacks,p!==null&&(d=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=d===null?p:d.concat(p))));break;case 26:var _=dc;if(Rl(i,n),Ml(n),p&512&&(ln||d===null||Pc(d,d.return)),p&4){var L=d!==null?d.memoizedState:null;if(p=n.memoizedState,d===null)if(p===null)if(n.stateNode===null){e:{p=n.type,d=n.memoizedProps,_=_.ownerDocument||_;t:switch(p){case"title":L=_.getElementsByTagName("title")[0],(!L||L[pa]||L[ss]||L.namespaceURI==="http://www.w3.org/2000/svg"||L.hasAttribute("itemprop"))&&(L=_.createElement(p),_.head.insertBefore(L,_.querySelector("head > title"))),Pn(L,p,d),L[ss]=n,rs(L),p=L;break e;case"link":var ue=Rv("link","href",_).get(p+(d.href||""));if(ue){for(var Re=0;Re<ue.length;Re++)if(L=ue[Re],L.getAttribute("href")===(d.href==null||d.href===""?null:d.href)&&L.getAttribute("rel")===(d.rel==null?null:d.rel)&&L.getAttribute("title")===(d.title==null?null:d.title)&&L.getAttribute("crossorigin")===(d.crossOrigin==null?null:d.crossOrigin)){ue.splice(Re,1);break t}}L=_.createElement(p),Pn(L,p,d),_.head.appendChild(L);break;case"meta":if(ue=Rv("meta","content",_).get(p+(d.content||""))){for(Re=0;Re<ue.length;Re++)if(L=ue[Re],L.getAttribute("content")===(d.content==null?null:""+d.content)&&L.getAttribute("name")===(d.name==null?null:d.name)&&L.getAttribute("property")===(d.property==null?null:d.property)&&L.getAttribute("http-equiv")===(d.httpEquiv==null?null:d.httpEquiv)&&L.getAttribute("charset")===(d.charSet==null?null:d.charSet)){ue.splice(Re,1);break t}}L=_.createElement(p),Pn(L,p,d),_.head.appendChild(L);break;default:throw Error(r(468,p))}L[ss]=n,rs(L),p=L}n.stateNode=p}else Mv(_,n.type,n.stateNode);else n.stateNode=Qv(_,p,n.memoizedProps);else L!==p?(L===null?d.stateNode!==null&&(d=d.stateNode,d.parentNode.removeChild(d)):L.count--,p===null?Mv(_,n.type,n.stateNode):Qv(_,p,n.memoizedProps)):p===null&&n.stateNode!==null&&i0(n,n.memoizedProps,d.memoizedProps)}break;case 27:Rl(i,n),Ml(n),p&512&&(ln||d===null||Pc(d,d.return)),d!==null&&p&4&&i0(n,n.memoizedProps,d.memoizedProps);break;case 5:if(Rl(i,n),Ml(n),p&512&&(ln||d===null||Pc(d,d.return)),n.flags&32){_=n.stateNode;try{ml(_,"")}catch(gs){Qa(n,n.return,gs)}}p&4&&n.stateNode!=null&&(_=n.memoizedProps,i0(n,_,d!==null?d.memoizedProps:_)),p&1024&&(d0=!0);break;case 6:if(Rl(i,n),Ml(n),p&4){if(n.stateNode===null)throw Error(r(162));p=n.memoizedProps,d=n.stateNode;try{d.nodeValue=p}catch(gs){Qa(n,n.return,gs)}}break;case 3:if(Sp=null,_=dc,dc=_p(i.containerInfo),Rl(i,n),dc=_,Ml(n),p&4&&d!==null&&d.memoizedState.isDehydrated)try{wu(i.containerInfo)}catch(gs){Qa(n,n.return,gs)}d0&&(d0=!1,Mj(n));break;case 4:p=dc,dc=_p(n.stateNode.containerInfo),Rl(i,n),Ml(n),dc=p;break;case 12:Rl(i,n),Ml(n);break;case 31:Rl(i,n),Ml(n),p&4&&(p=n.updateQueue,p!==null&&(n.updateQueue=null,mp(n,p)));break;case 13:Rl(i,n),Ml(n),n.child.flags&8192&&n.memoizedState!==null!=(d!==null&&d.memoizedState!==null)&&(xp=ie()),p&4&&(p=n.updateQueue,p!==null&&(n.updateQueue=null,mp(n,p)));break;case 22:_=n.memoizedState!==null;var tt=d!==null&&d.memoizedState!==null,yt=No,Dt=ln;if(No=yt||_,ln=Dt||tt,Rl(i,n),ln=Dt,No=yt,Ml(n),p&8192)e:for(i=n.stateNode,i._visibility=_?i._visibility&-2:i._visibility|1,_&&(d===null||tt||No||ln||xm(n)),d=null,i=n;;){if(i.tag===5||i.tag===26){if(d===null){tt=d=i;try{if(L=tt.stateNode,_)ue=L.style,typeof ue.setProperty=="function"?ue.setProperty("display","none","important"):ue.display="none";else{Re=tt.stateNode;var It=tt.memoizedProps.style,jt=It!=null&&It.hasOwnProperty("display")?It.display:null;Re.style.display=jt==null||typeof jt=="boolean"?"":(""+jt).trim()}}catch(gs){Qa(tt,tt.return,gs)}}}else if(i.tag===6){if(d===null){tt=i;try{tt.stateNode.nodeValue=_?"":tt.memoizedProps}catch(gs){Qa(tt,tt.return,gs)}}}else if(i.tag===18){if(d===null){tt=i;try{var St=tt.stateNode;_?Sv(St,!0):Sv(tt.stateNode,!1)}catch(gs){Qa(tt,tt.return,gs)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===n)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break e;for(;i.sibling===null;){if(i.return===null||i.return===n)break e;d===i&&(d=null),i=i.return}d===i&&(d=null),i.sibling.return=i.return,i=i.sibling}p&4&&(p=n.updateQueue,p!==null&&(d=p.retryQueue,d!==null&&(p.retryQueue=null,mp(n,d))));break;case 19:Rl(i,n),Ml(n),p&4&&(p=n.updateQueue,p!==null&&(n.updateQueue=null,mp(n,p)));break;case 30:break;case 21:break;default:Rl(i,n),Ml(n)}}function Ml(n){var i=n.flags;if(i&2){try{for(var d,p=n.return;p!==null;){if(Bj(p)){d=p;break}p=p.return}if(d==null)throw Error(r(160));switch(d.tag){case 27:var _=d.stateNode,L=c0(n);dp(n,L,_);break;case 5:var ue=d.stateNode;d.flags&32&&(ml(ue,""),d.flags&=-33);var Re=c0(n);dp(n,Re,ue);break;case 3:case 4:var tt=d.stateNode.containerInfo,yt=c0(n);o0(n,yt,tt);break;default:throw Error(r(161))}}catch(Dt){Qa(n,n.return,Dt)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function Mj(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var i=n;Mj(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),n=n.sibling}}function _o(n,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)Dj(n,i.alternate,i),i=i.sibling}function xm(n){for(n=n.child;n!==null;){var i=n;switch(i.tag){case 0:case 11:case 14:case 15:pd(4,i,i.return),xm(i);break;case 1:Pc(i,i.return);var d=i.stateNode;typeof d.componentWillUnmount=="function"&&Sj(i,i.return,d),xm(i);break;case 27:Qx(i.stateNode);case 26:case 5:Pc(i,i.return),xm(i);break;case 22:i.memoizedState===null&&xm(i);break;case 30:xm(i);break;default:xm(i)}n=n.sibling}}function Co(n,i,d){for(d=d&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var p=i.alternate,_=n,L=i,ue=L.flags;switch(L.tag){case 0:case 11:case 15:Co(_,L,d),Cx(4,L);break;case 1:if(Co(_,L,d),p=L,_=p.stateNode,typeof _.componentDidMount=="function")try{_.componentDidMount()}catch(yt){Qa(p,p.return,yt)}if(p=L,_=p.updateQueue,_!==null){var Re=p.stateNode;try{var tt=_.shared.hiddenCallbacks;if(tt!==null)for(_.shared.hiddenCallbacks=null,_=0;_<tt.length;_++)Bn(tt[_],Re)}catch(yt){Qa(p,p.return,yt)}}d&&ue&64&&Cj(L),Sx(L,L.return);break;case 27:Fj(L);case 26:case 5:Co(_,L,d),d&&p===null&&ue&4&&kj(L),Sx(L,L.return);break;case 12:Co(_,L,d);break;case 31:Co(_,L,d),d&&ue&4&&Lj(_,L);break;case 13:Co(_,L,d),d&&ue&4&&Qj(_,L);break;case 22:L.memoizedState===null&&Co(_,L,d),Sx(L,L.return);break;case 30:break;default:Co(_,L,d)}i=i.sibling}}function m0(n,i){var d=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(d=n.memoizedState.cachePool.pool),n=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(n=i.memoizedState.cachePool.pool),n!==d&&(n!=null&&n.refCount++,d!=null&&cm(d))}function u0(n,i){n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&cm(n))}function mc(n,i,d,p){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Ij(n,i,d,p),i=i.sibling}function Ij(n,i,d,p){var _=i.flags;switch(i.tag){case 0:case 11:case 15:mc(n,i,d,p),_&2048&&Cx(9,i);break;case 1:mc(n,i,d,p);break;case 3:mc(n,i,d,p),_&2048&&(n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&cm(n)));break;case 12:if(_&2048){mc(n,i,d,p),n=i.stateNode;try{var L=i.memoizedProps,ue=L.id,Re=L.onPostCommit;typeof Re=="function"&&Re(ue,i.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(tt){Qa(i,i.return,tt)}}else mc(n,i,d,p);break;case 31:mc(n,i,d,p);break;case 13:mc(n,i,d,p);break;case 23:break;case 22:L=i.stateNode,ue=i.alternate,i.memoizedState!==null?L._visibility&2?mc(n,i,d,p):kx(n,i):L._visibility&2?mc(n,i,d,p):(L._visibility|=2,xu(n,i,d,p,(i.subtreeFlags&10256)!==0||!1)),_&2048&&m0(ue,i);break;case 24:mc(n,i,d,p),_&2048&&u0(i.alternate,i);break;default:mc(n,i,d,p)}}function xu(n,i,d,p,_){for(_=_&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var L=n,ue=i,Re=d,tt=p,yt=ue.flags;switch(ue.tag){case 0:case 11:case 15:xu(L,ue,Re,tt,_),Cx(8,ue);break;case 23:break;case 22:var Dt=ue.stateNode;ue.memoizedState!==null?Dt._visibility&2?xu(L,ue,Re,tt,_):kx(L,ue):(Dt._visibility|=2,xu(L,ue,Re,tt,_)),_&&yt&2048&&m0(ue.alternate,ue);break;case 24:xu(L,ue,Re,tt,_),_&&yt&2048&&u0(ue.alternate,ue);break;default:xu(L,ue,Re,tt,_)}i=i.sibling}}function kx(n,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var d=n,p=i,_=p.flags;switch(p.tag){case 22:kx(d,p),_&2048&&m0(p.alternate,p);break;case 24:kx(d,p),_&2048&&u0(p.alternate,p);break;default:kx(d,p)}i=i.sibling}}var Bx=8192;function hu(n,i,d){if(n.subtreeFlags&Bx)for(n=n.child;n!==null;)$j(n,i,d),n=n.sibling}function $j(n,i,d){switch(n.tag){case 26:hu(n,i,d),n.flags&Bx&&n.memoizedState!==null&&_C(d,dc,n.memoizedState,n.memoizedProps);break;case 5:hu(n,i,d);break;case 3:case 4:var p=dc;dc=_p(n.stateNode.containerInfo),hu(n,i,d),dc=p;break;case 22:n.memoizedState===null&&(p=n.alternate,p!==null&&p.memoizedState!==null?(p=Bx,Bx=16777216,hu(n,i,d),Bx=p):hu(n,i,d));break;default:hu(n,i,d)}}function Hj(n){var i=n.alternate;if(i!==null&&(n=i.child,n!==null)){i.child=null;do i=n.sibling,n.sibling=null,n=i;while(n!==null)}}function Fx(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var d=0;d<i.length;d++){var p=i[d];En=p,Oj(p,n)}Hj(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Pj(n),n=n.sibling}function Pj(n){switch(n.tag){case 0:case 11:case 15:Fx(n),n.flags&2048&&pd(9,n,n.return);break;case 3:Fx(n);break;case 12:Fx(n);break;case 22:var i=n.stateNode;n.memoizedState!==null&&i._visibility&2&&(n.return===null||n.return.tag!==13)?(i._visibility&=-3,up(n)):Fx(n);break;default:Fx(n)}}function up(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var d=0;d<i.length;d++){var p=i[d];En=p,Oj(p,n)}Hj(n)}for(n=n.child;n!==null;){switch(i=n,i.tag){case 0:case 11:case 15:pd(8,i,i.return),up(i);break;case 22:d=i.stateNode,d._visibility&2&&(d._visibility&=-3,up(i));break;default:up(i)}n=n.sibling}}function Oj(n,i){for(;En!==null;){var d=En;switch(d.tag){case 0:case 11:case 15:pd(8,d,i);break;case 23:case 22:if(d.memoizedState!==null&&d.memoizedState.cachePool!==null){var p=d.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:cm(d.memoizedState.cache)}if(p=d.child,p!==null)p.return=d,En=p;else e:for(d=n;En!==null;){p=En;var _=p.sibling,L=p.return;if(Uj(p),p===d){En=null;break e}if(_!==null){_.return=L,En=_;break e}En=L}}}var $_={getCacheForType:function(n){var i=vn(Sr),d=i.data.get(n);return d===void 0&&(d=n(),i.data.set(n,d)),d},cacheSignal:function(){return vn(Sr).controller.signal}},H_=typeof WeakMap=="function"?WeakMap:Map,Ea=0,Wa=null,ta=null,ia=0,La=0,si=null,Ad=!1,pu=!1,x0=!1,So=0,Qr=0,gd=0,hm=0,h0=0,ai=0,Au=0,Ex=null,Il=null,p0=!1,xp=0,zj=0,hp=1/0,pp=null,fd=null,wn=0,bd=null,gu=null,ko=0,A0=0,g0=null,Gj=null,Dx=0,f0=null;function ri(){return(Ea&2)!==0&&ia!==0?ia&-ia:V.T!==null?w0():Xt()}function qj(){if(ai===0)if((ia&536870912)===0||ea){var n=_t;_t<<=1,(_t&3932160)===0&&(_t=262144),ai=n}else ai=536870912;return n=rr.current,n!==null&&(n.flags|=32),ai}function $l(n,i,d){(n===Wa&&(La===2||La===9)||n.cancelPendingCommit!==null)&&(fu(n,0),yd(n,ia,ai,!1)),Ue(n,d),((Ea&2)===0||n!==Wa)&&(n===Wa&&((Ea&2)===0&&(hm|=d),Qr===4&&yd(n,ia,ai,!1)),Oc(n))}function Kj(n,i,d){if((Ea&6)!==0)throw Error(r(327));var p=!d&&(i&127)===0&&(i&n.expiredLanes)===0||ct(n,i),_=p?z_(n,i):y0(n,i,!0),L=p;do{if(_===0){pu&&!p&&yd(n,i,0,!1);break}else{if(d=n.current.alternate,L&&!P_(d)){_=y0(n,i,!1),L=!1;continue}if(_===2){if(L=i,n.errorRecoveryDisabledLanes&L)var ue=0;else ue=n.pendingLanes&-536870913,ue=ue!==0?ue:ue&536870912?536870912:0;if(ue!==0){i=ue;e:{var Re=n;_=Ex;var tt=Re.current.memoizedState.isDehydrated;if(tt&&(fu(Re,ue).flags|=256),ue=y0(Re,ue,!1),ue!==2){if(x0&&!tt){Re.errorRecoveryDisabledLanes|=L,hm|=L,_=4;break e}L=Il,Il=_,L!==null&&(Il===null?Il=L:Il.push.apply(Il,L))}_=ue}if(L=!1,_!==2)continue}}if(_===1){fu(n,0),yd(n,i,0,!0);break}e:{switch(p=n,L=_,L){case 0:case 1:throw Error(r(345));case 4:if((i&4194048)!==i)break;case 6:yd(p,i,ai,!Ad);break e;case 2:Il=null;break;case 3:case 5:break;default:throw Error(r(329))}if((i&62914560)===i&&(_=xp+300-ie(),10<_)){if(yd(p,i,ai,!Ad),Ze(p,0,!0)!==0)break e;ko=i,p.timeoutHandle=wv(Vj.bind(null,p,d,Il,pp,p0,i,ai,hm,Au,Ad,L,"Throttled",-0,0),_);break e}Vj(p,d,Il,pp,p0,i,ai,hm,Au,Ad,L,null,-0,0)}}break}while(!0);Oc(n)}function Vj(n,i,d,p,_,L,ue,Re,tt,yt,Dt,It,jt,St){if(n.timeoutHandle=-1,It=i.subtreeFlags,It&8192||(It&16785408)===16785408){It={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Yl},$j(i,L,It);var gs=(L&62914560)===L?xp-ie():(L&4194048)===L?zj-ie():0;if(gs=CC(It,gs),gs!==null){ko=L,n.cancelPendingCommit=gs(sv.bind(null,n,i,L,d,p,_,ue,Re,tt,Dt,It,null,jt,St)),yd(n,L,ue,!yt);return}}sv(n,i,L,d,p,_,ue,Re,tt)}function P_(n){for(var i=n;;){var d=i.tag;if((d===0||d===11||d===15)&&i.flags&16384&&(d=i.updateQueue,d!==null&&(d=d.stores,d!==null)))for(var p=0;p<d.length;p++){var _=d[p],L=_.getSnapshot;_=_.value;try{if(!fn(L(),_))return!1}catch{return!1}}if(d=i.child,i.subtreeFlags&16384&&d!==null)d.return=i,i=d;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function yd(n,i,d,p){i&=~h0,i&=~hm,n.suspendedLanes|=i,n.pingedLanes&=~i,p&&(n.warmLanes|=i),p=n.expirationTimes;for(var _=i;0<_;){var L=31-mt(_),ue=1<<L;p[L]=-1,_&=~ue}d!==0&&Et(n,d,i)}function Ap(){return(Ea&6)===0?(Ux(0),!1):!0}function b0(){if(ta!==null){if(La===0)var n=ta.return;else n=ta,vi=Tc=null,lu(n),Pt=null,fs=0,n=ta;for(;n!==null;)_j(n.alternate,n),n=n.return;ta=null}}function fu(n,i){var d=n.timeoutHandle;d!==-1&&(n.timeoutHandle=-1,cC(d)),d=n.cancelPendingCommit,d!==null&&(n.cancelPendingCommit=null,d()),ko=0,b0(),Wa=n,ta=d=kl(n.current,null),ia=i,La=0,si=null,Ad=!1,pu=ct(n,i),x0=!1,Au=ai=h0=hm=gd=Qr=0,Il=Ex=null,p0=!1,(i&8)!==0&&(i|=i&32);var p=n.entangledLanes;if(p!==0)for(n=n.entanglements,p&=i;0<p;){var _=31-mt(p),L=1<<_;i|=n[_],p&=~L}return So=i,sm(),d}function Yj(n,i){Cs=null,V.H=Nx,i===rt||i===Ve?(i=Lt(),La=3):i===At?(i=Lt(),La=4):La=i===Xg?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,si=i,ta===null&&(Qr=1,np(n,Bl(i,n.current)))}function Wj(){var n=rr.current;return n===null?!0:(ia&4194048)===ia?ga===null:(ia&62914560)===ia||(ia&536870912)!==0?n===ga:!1}function Xj(){var n=V.H;return V.H=Nx,n===null?Nx:n}function Jj(){var n=V.A;return V.A=$_,n}function gp(){Qr=4,Ad||(ia&4194048)!==ia&&rr.current!==null||(pu=!0),(gd&134217727)===0&&(hm&134217727)===0||Wa===null||yd(Wa,ia,ai,!1)}function y0(n,i,d){var p=Ea;Ea|=2;var _=Xj(),L=Jj();(Wa!==n||ia!==i)&&(pp=null,fu(n,i)),i=!1;var ue=Qr;e:do try{if(La!==0&&ta!==null){var Re=ta,tt=si;switch(La){case 8:b0(),ue=6;break e;case 3:case 2:case 9:case 6:rr.current===null&&(i=!0);var yt=La;if(La=0,si=null,bu(n,Re,tt,yt),d&&pu){ue=0;break e}break;default:yt=La,La=0,si=null,bu(n,Re,tt,yt)}}O_(),ue=Qr;break}catch(Dt){Yj(n,Dt)}while(!0);return i&&n.shellSuspendCounter++,vi=Tc=null,Ea=p,V.H=_,V.A=L,ta===null&&(Wa=null,ia=0,sm()),ue}function O_(){for(;ta!==null;)Zj(ta)}function z_(n,i){var d=Ea;Ea|=2;var p=Xj(),_=Jj();Wa!==n||ia!==i?(pp=null,hp=ie()+500,fu(n,i)):pu=ct(n,i);e:do try{if(La!==0&&ta!==null){i=ta;var L=si;t:switch(La){case 1:La=0,si=null,bu(n,i,L,1);break;case 2:case 9:if(ut(L)){La=0,si=null,ev(i);break}i=function(){La!==2&&La!==9||Wa!==n||(La=7),Oc(n)},L.then(i,i);break e;case 3:La=7;break e;case 4:La=5;break e;case 7:ut(L)?(La=0,si=null,ev(i)):(La=0,si=null,bu(n,i,L,7));break;case 5:var ue=null;switch(ta.tag){case 26:ue=ta.memoizedState;case 5:case 27:var Re=ta;if(ue?Iv(ue):Re.stateNode.complete){La=0,si=null;var tt=Re.sibling;if(tt!==null)ta=tt;else{var yt=Re.return;yt!==null?(ta=yt,fp(yt)):ta=null}break t}}La=0,si=null,bu(n,i,L,5);break;case 6:La=0,si=null,bu(n,i,L,6);break;case 8:b0(),Qr=6;break e;default:throw Error(r(462))}}G_();break}catch(Dt){Yj(n,Dt)}while(!0);return vi=Tc=null,V.H=p,V.A=_,Ea=d,ta!==null?0:(Wa=null,ia=0,sm(),Qr)}function G_(){for(;ta!==null&&!Ke();)Zj(ta)}function Zj(n){var i=Nj(n.alternate,n,So);n.memoizedProps=n.pendingProps,i===null?fp(n):ta=i}function ev(n){var i=n,d=i.alternate;switch(i.tag){case 15:case 0:i=gj(d,i,i.pendingProps,i.type,void 0,ia);break;case 11:i=gj(d,i,i.pendingProps,i.type.render,i.ref,ia);break;case 5:lu(i);default:_j(d,i),i=ta=nm(i,So),i=Nj(d,i,So)}n.memoizedProps=n.pendingProps,i===null?fp(n):ta=i}function bu(n,i,d,p){vi=Tc=null,lu(i),Pt=null,fs=0;var _=i.return;try{if(U_(n,_,i,d,ia)){Qr=1,np(n,Bl(d,n.current)),ta=null;return}}catch(L){if(_!==null)throw ta=_,L;Qr=1,np(n,Bl(d,n.current)),ta=null;return}i.flags&32768?(ea||p===1?n=!0:pu||(ia&536870912)!==0?n=!1:(Ad=n=!0,(p===2||p===9||p===3||p===6)&&(p=rr.current,p!==null&&p.tag===13&&(p.flags|=16384))),tv(i,n)):fp(i)}function fp(n){var i=n;do{if((i.flags&32768)!==0){tv(i,Ad);return}n=i.return;var d=Q_(i.alternate,i,So);if(d!==null){ta=d;return}if(i=i.sibling,i!==null){ta=i;return}ta=i=n}while(i!==null);Qr===0&&(Qr=5)}function tv(n,i){do{var d=R_(n.alternate,n);if(d!==null){d.flags&=32767,ta=d;return}if(d=n.return,d!==null&&(d.flags|=32768,d.subtreeFlags=0,d.deletions=null),!i&&(n=n.sibling,n!==null)){ta=n;return}ta=n=d}while(n!==null);Qr=6,ta=null}function sv(n,i,d,p,_,L,ue,Re,tt){n.cancelPendingCommit=null;do bp();while(wn!==0);if((Ea&6)!==0)throw Error(r(327));if(i!==null){if(i===n.current)throw Error(r(177));if(L=i.lanes|i.childLanes,L|=qm,Ct(n,d,L,ue,Re,tt),n===Wa&&(ta=Wa=null,ia=0),gu=i,bd=n,ko=d,A0=L,g0=_,Gj=p,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,Y_(Se,function(){return iv(),null})):(n.callbackNode=null,n.callbackPriority=0),p=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||p){p=V.T,V.T=null,_=re.p,re.p=2,ue=Ea,Ea|=4;try{M_(n,i,d)}finally{Ea=ue,re.p=_,V.T=p}}wn=1,av(),rv(),nv()}}function av(){if(wn===1){wn=0;var n=bd,i=gu,d=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||d){d=V.T,V.T=null;var p=re.p;re.p=2;var _=Ea;Ea|=4;try{Rj(i,n);var L=D0,ue=sc(n.containerInfo),Re=L.focusedElem,tt=L.selectionRange;if(ue!==Re&&Re&&Re.ownerDocument&&tc(Re.ownerDocument.documentElement,Re)){if(tt!==null&&yi(Re)){var yt=tt.start,Dt=tt.end;if(Dt===void 0&&(Dt=yt),"selectionStart"in Re)Re.selectionStart=yt,Re.selectionEnd=Math.min(Dt,Re.value.length);else{var It=Re.ownerDocument||document,jt=It&&It.defaultView||window;if(jt.getSelection){var St=jt.getSelection(),gs=Re.textContent.length,Ls=Math.min(tt.start,gs),za=tt.end===void 0?Ls:Math.min(tt.end,gs);!St.extend&&Ls>za&&(ue=za,za=Ls,Ls=ue);var dt=rd(Re,Ls),nt=rd(Re,za);if(dt&&nt&&(St.rangeCount!==1||St.anchorNode!==dt.node||St.anchorOffset!==dt.offset||St.focusNode!==nt.node||St.focusOffset!==nt.offset)){var gt=It.createRange();gt.setStart(dt.node,dt.offset),St.removeAllRanges(),Ls>za?(St.addRange(gt),St.extend(nt.node,nt.offset)):(gt.setEnd(nt.node,nt.offset),St.addRange(gt))}}}}for(It=[],St=Re;St=St.parentNode;)St.nodeType===1&&It.push({element:St,left:St.scrollLeft,top:St.scrollTop});for(typeof Re.focus=="function"&&Re.focus(),Re=0;Re<It.length;Re++){var Qt=It[Re];Qt.element.scrollLeft=Qt.left,Qt.element.scrollTop=Qt.top}}Ep=!!E0,D0=E0=null}finally{Ea=_,re.p=p,V.T=d}}n.current=i,wn=2}}function rv(){if(wn===2){wn=0;var n=bd,i=gu,d=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||d){d=V.T,V.T=null;var p=re.p;re.p=2;var _=Ea;Ea|=4;try{Dj(n,i.alternate,i)}finally{Ea=_,re.p=p,V.T=d}}wn=3}}function nv(){if(wn===4||wn===3){wn=0,ve();var n=bd,i=gu,d=ko,p=Gj;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?wn=5:(wn=0,gu=bd=null,lv(n,n.pendingLanes));var _=n.pendingLanes;if(_===0&&(fd=null),bt(d),i=i.stateNode,W&&typeof W.onCommitFiberRoot=="function")try{W.onCommitFiberRoot(qe,i,void 0,(i.current.flags&128)===128)}catch{}if(p!==null){i=V.T,_=re.p,re.p=2,V.T=null;try{for(var L=n.onRecoverableError,ue=0;ue<p.length;ue++){var Re=p[ue];L(Re.value,{componentStack:Re.stack})}}finally{V.T=i,re.p=_}}(ko&3)!==0&&bp(),Oc(n),_=n.pendingLanes,(d&261930)!==0&&(_&42)!==0?n===f0?Dx++:(Dx=0,f0=n):Dx=0,Ux(0)}}function lv(n,i){(n.pooledCacheLanes&=i)===0&&(i=n.pooledCache,i!=null&&(n.pooledCache=null,cm(i)))}function bp(){return av(),rv(),nv(),iv()}function iv(){if(wn!==5)return!1;var n=bd,i=A0;A0=0;var d=bt(ko),p=V.T,_=re.p;try{re.p=32>d?32:d,V.T=null,d=g0,g0=null;var L=bd,ue=ko;if(wn=0,gu=bd=null,ko=0,(Ea&6)!==0)throw Error(r(331));var Re=Ea;if(Ea|=4,Pj(L.current),Ij(L,L.current,ue,d),Ea=Re,Ux(0,!1),W&&typeof W.onPostCommitFiberRoot=="function")try{W.onPostCommitFiberRoot(qe,L)}catch{}return!0}finally{re.p=_,V.T=p,lv(n,i)}}function cv(n,i,d){i=Bl(d,i),i=Wg(n.stateNode,i,2),n=Ks(n,i,2),n!==null&&(Ue(n,2),Oc(n))}function Qa(n,i,d){if(n.tag===3)cv(n,n,d);else for(;i!==null;){if(i.tag===3){cv(i,n,d);break}else if(i.tag===1){var p=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(fd===null||!fd.has(p))){n=Bl(d,n),d=oj(2),p=Ks(i,d,2),p!==null&&(dj(d,p,i,n),Ue(p,2),Oc(p));break}}i=i.return}}function j0(n,i,d){var p=n.pingCache;if(p===null){p=n.pingCache=new H_;var _=new Set;p.set(i,_)}else _=p.get(i),_===void 0&&(_=new Set,p.set(i,_));_.has(d)||(x0=!0,_.add(d),n=q_.bind(null,n,i,d),i.then(n,n))}function q_(n,i,d){var p=n.pingCache;p!==null&&p.delete(i),n.pingedLanes|=n.suspendedLanes&d,n.warmLanes&=~d,Wa===n&&(ia&d)===d&&(Qr===4||Qr===3&&(ia&62914560)===ia&&300>ie()-xp?(Ea&2)===0&&fu(n,0):h0|=d,Au===ia&&(Au=0)),Oc(n)}function ov(n,i){i===0&&(i=be()),n=rc(n,i),n!==null&&(Ue(n,i),Oc(n))}function K_(n){var i=n.memoizedState,d=0;i!==null&&(d=i.retryLane),ov(n,d)}function V_(n,i){var d=0;switch(n.tag){case 31:case 13:var p=n.stateNode,_=n.memoizedState;_!==null&&(d=_.retryLane);break;case 19:p=n.stateNode;break;case 22:p=n.stateNode._retryCache;break;default:throw Error(r(314))}p!==null&&p.delete(i),ov(n,d)}function Y_(n,i){return fe(n,i)}var yp=null,yu=null,v0=!1,jp=!1,N0=!1,jd=0;function Oc(n){n!==yu&&n.next===null&&(yu===null?yp=yu=n:yu=yu.next=n),jp=!0,v0||(v0=!0,X_())}function Ux(n,i){if(!N0&&jp){N0=!0;do for(var d=!1,p=yp;p!==null;){if(n!==0){var _=p.pendingLanes;if(_===0)var L=0;else{var ue=p.suspendedLanes,Re=p.pingedLanes;L=(1<<31-mt(42|n)+1)-1,L&=_&~(ue&~Re),L=L&201326741?L&201326741|1:L?L|2:0}L!==0&&(d=!0,xv(p,L))}else L=ia,L=Ze(p,p===Wa?L:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(L&3)===0||ct(p,L)||(d=!0,xv(p,L));p=p.next}while(d);N0=!1}}function W_(){dv()}function dv(){jp=v0=!1;var n=0;jd!==0&&iC()&&(n=jd);for(var i=ie(),d=null,p=yp;p!==null;){var _=p.next,L=mv(p,i);L===0?(p.next=null,d===null?yp=_:d.next=_,_===null&&(yu=d)):(d=p,(n!==0||(L&3)!==0)&&(jp=!0)),p=_}wn!==0&&wn!==5||Ux(n),jd!==0&&(jd=0)}function mv(n,i){for(var d=n.suspendedLanes,p=n.pingedLanes,_=n.expirationTimes,L=n.pendingLanes&-62914561;0<L;){var ue=31-mt(L),Re=1<<ue,tt=_[ue];tt===-1?((Re&d)===0||(Re&p)!==0)&&(_[ue]=Yt(Re,i)):tt<=i&&(n.expiredLanes|=Re),L&=~Re}if(i=Wa,d=ia,d=Ze(n,n===i?d:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),p=n.callbackNode,d===0||n===i&&(La===2||La===9)||n.cancelPendingCommit!==null)return p!==null&&p!==null&&ye(p),n.callbackNode=null,n.callbackPriority=0;if((d&3)===0||ct(n,d)){if(i=d&-d,i===n.callbackPriority)return i;switch(p!==null&&ye(p),bt(d)){case 2:case 8:d=Me;break;case 32:d=Se;break;case 268435456:d=et;break;default:d=Se}return p=uv.bind(null,n),d=fe(d,p),n.callbackPriority=i,n.callbackNode=d,i}return p!==null&&p!==null&&ye(p),n.callbackPriority=2,n.callbackNode=null,2}function uv(n,i){if(wn!==0&&wn!==5)return n.callbackNode=null,n.callbackPriority=0,null;var d=n.callbackNode;if(bp()&&n.callbackNode!==d)return null;var p=ia;return p=Ze(n,n===Wa?p:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),p===0?null:(Kj(n,p,i),mv(n,ie()),n.callbackNode!=null&&n.callbackNode===d?uv.bind(null,n):null)}function xv(n,i){if(bp())return null;Kj(n,i,!0)}function X_(){oC(function(){(Ea&6)!==0?fe(pe,W_):dv()})}function w0(){if(jd===0){var n=b;n===0&&(n=Je,Je<<=1,(Je&261888)===0&&(Je=256)),jd=n}return jd}function hv(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:qn(""+n)}function pv(n,i){var d=i.ownerDocument.createElement("input");return d.name=i.name,d.value=i.value,n.id&&d.setAttribute("form",n.id),i.parentNode.insertBefore(d,i),n=new FormData(n),d.parentNode.removeChild(d),n}function J_(n,i,d,p,_){if(i==="submit"&&d&&d.stateNode===_){var L=hv((_[he]||null).action),ue=p.submitter;ue&&(i=(i=ue[he]||null)?hv(i.formAction):ue.getAttribute("formAction"),i!==null&&(L=i,ue=null));var Re=new _l("action","action",null,p,_);n.push({event:Re,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(jd!==0){var tt=ue?pv(_,ue):new FormData(_);zg(d,{pending:!0,data:tt,method:_.method,action:L},null,tt)}}else typeof L=="function"&&(Re.preventDefault(),tt=ue?pv(_,ue):new FormData(_),zg(d,{pending:!0,data:tt,method:_.method,action:L},L,tt))},currentTarget:_}]})}}for(var _0=0;_0<xo.length;_0++){var C0=xo[_0],Z_=C0.toLowerCase(),eC=C0[0].toUpperCase()+C0.slice(1);Sl(Z_,"on"+eC)}Sl(uo,"onAnimationEnd"),Sl(em,"onAnimationIteration"),Sl(cx,"onAnimationStart"),Sl("dblclick","onDoubleClick"),Sl("focusin","onFocus"),Sl("focusout","onBlur"),Sl(qh,"onTransitionRun"),Sl(Kh,"onTransitionStart"),Sl(Vh,"onTransitionCancel"),Sl(ox,"onTransitionEnd"),ws("onMouseEnter",["mouseout","mouseover"]),ws("onMouseLeave",["mouseout","mouseover"]),ws("onPointerEnter",["pointerout","pointerover"]),ws("onPointerLeave",["pointerout","pointerover"]),es("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),es("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),es("onBeforeInput",["compositionend","keypress","textInput","paste"]),es("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),es("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),es("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Tx="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Tx));function Av(n,i){i=(i&4)!==0;for(var d=0;d<n.length;d++){var p=n[d],_=p.event;p=p.listeners;e:{var L=void 0;if(i)for(var ue=p.length-1;0<=ue;ue--){var Re=p[ue],tt=Re.instance,yt=Re.currentTarget;if(Re=Re.listener,tt!==L&&_.isPropagationStopped())break e;L=Re,_.currentTarget=yt;try{L(_)}catch(Dt){tm(Dt)}_.currentTarget=null,L=tt}else for(ue=0;ue<p.length;ue++){if(Re=p[ue],tt=Re.instance,yt=Re.currentTarget,Re=Re.listener,tt!==L&&_.isPropagationStopped())break e;L=Re,_.currentTarget=yt;try{L(_)}catch(Dt){tm(Dt)}_.currentTarget=null,L=tt}}}}function sa(n,i){var d=i[Zt];d===void 0&&(d=i[Zt]=new Set);var p=n+"__bubble";d.has(p)||(gv(i,n,2,!1),d.add(p))}function S0(n,i,d){var p=0;i&&(p|=4),gv(d,n,p,i)}var vp="_reactListening"+Math.random().toString(36).slice(2);function k0(n){if(!n[vp]){n[vp]=!0,dr.forEach(function(d){d!=="selectionchange"&&(tC.has(d)||S0(d,!1,n),S0(d,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[vp]||(i[vp]=!0,S0("selectionchange",!1,i))}}function gv(n,i,d,p){switch(qv(i)){case 2:var _=BC;break;case 8:_=FC;break;default:_=O0}d=_.bind(null,i,d,n),_=void 0,!Yd||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(_=!0),p?_!==void 0?n.addEventListener(i,d,{capture:!0,passive:_}):n.addEventListener(i,d,!0):_!==void 0?n.addEventListener(i,d,{passive:_}):n.addEventListener(i,d,!1)}function B0(n,i,d,p,_){var L=p;if((i&1)===0&&(i&2)===0&&p!==null)e:for(;;){if(p===null)return;var ue=p.tag;if(ue===3||ue===4){var Re=p.stateNode.containerInfo;if(Re===_)break;if(ue===4)for(ue=p.return;ue!==null;){var tt=ue.tag;if((tt===3||tt===4)&&ue.stateNode.containerInfo===_)return;ue=ue.return}for(;Re!==null;){if(ue=xn(Re),ue===null)return;if(tt=ue.tag,tt===5||tt===6||tt===26||tt===27){p=L=ue;continue e}Re=Re.parentNode}}p=p.return}Hm(function(){var yt=L,Dt=ro(d),It=[];e:{var jt=dx.get(n);if(jt!==void 0){var St=_l,gs=n;switch(n){case"keypress":if(wl(d)===0)break e;case"keydown":case"keyup":St=ma;break;case"focusin":gs="focus",St=Ki;break;case"focusout":gs="blur",St=Ki;break;case"beforeblur":case"afterblur":St=Ki;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":St=Wd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":St=qi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":St=qr;break;case uo:case em:case cx:St=G;break;case ox:St=gn;break;case"scroll":case"scrollend":St=Xo;break;case"wheel":St=Wl;break;case"copy":case"cut":case"paste":St=We;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":St=wr;break;case"toggle":case"beforetoggle":St=Xd}var Ls=(i&4)!==0,za=!Ls&&(n==="scroll"||n==="scrollend"),dt=Ls?jt!==null?jt+"Capture":null:jt;Ls=[];for(var nt=yt,gt;nt!==null;){var Qt=nt;if(gt=Qt.stateNode,Qt=Qt.tag,Qt!==5&&Qt!==26&&Qt!==27||gt===null||dt===null||(Qt=xl(nt,dt),Qt!=null&&Ls.push(Lx(nt,Qt,gt))),za)break;nt=nt.return}0<Ls.length&&(jt=new St(jt,gs,null,d,Dt),It.push({event:jt,listeners:Ls}))}}if((i&7)===0){e:{if(jt=n==="mouseover"||n==="pointerover",St=n==="mouseout"||n==="pointerout",jt&&d!==Hi&&(gs=d.relatedTarget||d.fromElement)&&(xn(gs)||gs[Ht]))break e;if((St||jt)&&(jt=Dt.window===Dt?Dt:(jt=Dt.ownerDocument)?jt.defaultView||jt.parentWindow:window,St?(gs=d.relatedTarget||d.toElement,St=yt,gs=gs?xn(gs):null,gs!==null&&(za=c(gs),Ls=gs.tag,gs!==za||Ls!==5&&Ls!==27&&Ls!==6)&&(gs=null)):(St=null,gs=yt),St!==gs)){if(Ls=Wd,Qt="onMouseLeave",dt="onMouseEnter",nt="mouse",(n==="pointerout"||n==="pointerover")&&(Ls=wr,Qt="onPointerLeave",dt="onPointerEnter",nt="pointer"),za=St==null?jt:De(St),gt=gs==null?jt:De(gs),jt=new Ls(Qt,nt+"leave",St,d,Dt),jt.target=za,jt.relatedTarget=gt,Qt=null,xn(Dt)===yt&&(Ls=new Ls(dt,nt+"enter",gs,d,Dt),Ls.target=gt,Ls.relatedTarget=za,Qt=Ls),za=Qt,St&&gs)t:{for(Ls=sC,dt=St,nt=gs,gt=0,Qt=dt;Qt;Qt=Ls(Qt))gt++;Qt=0;for(var Bs=nt;Bs;Bs=Ls(Bs))Qt++;for(;0<gt-Qt;)dt=Ls(dt),gt--;for(;0<Qt-gt;)nt=Ls(nt),Qt--;for(;gt--;){if(dt===nt||nt!==null&&dt===nt.alternate){Ls=dt;break t}dt=Ls(dt),nt=Ls(nt)}Ls=null}else Ls=null;St!==null&&fv(It,jt,St,Ls,!1),gs!==null&&za!==null&&fv(It,za,gs,Ls,!0)}}e:{if(jt=yt?De(yt):window,St=jt.nodeName&&jt.nodeName.toLowerCase(),St==="select"||St==="input"&&jt.type==="file")var _a=Fc;else if(Jd(jt))if(Kn)_a=fi;else{_a=_r;var js=sd}else St=jt.nodeName,!St||St.toLowerCase()!=="input"||jt.type!=="checkbox"&&jt.type!=="radio"?yt&&xr(yt.elementType)&&(_a=Fc):_a=Gm;if(_a&&(_a=_a(n,yt))){pl(It,_a,d,Dt);break e}js&&js(n,jt,yt),n==="focusout"&&yt&&jt.type==="number"&&yt.memoizedProps.value!=null&&Cc(jt,"number",jt.value)}switch(js=yt?De(yt):window,n){case"focusin":(Jd(js)||js.contentEditable==="true")&&(Al=js,ac=yt,Cn=null);break;case"focusout":Cn=ac=Al=null;break;case"mousedown":Cl=!0;break;case"contextmenu":case"mouseup":case"dragend":Cl=!1,ya(It,d,Dt);break;case"selectionchange":if(mo)break;case"keydown":case"keyup":ya(It,d,Dt)}var Ys;if(hi)e:{switch(n){case"compositionstart":var ca="onCompositionStart";break e;case"compositionend":ca="onCompositionEnd";break e;case"compositionupdate":ca="onCompositionUpdate";break e}ca=void 0}else pi?Bc(n,d)&&(ca="onCompositionEnd"):n==="keydown"&&d.keyCode===229&&(ca="onCompositionStart");ca&&(Wi&&d.locale!=="ko"&&(pi||ca!=="onCompositionStart"?ca==="onCompositionEnd"&&pi&&(Ys=Pm()):(hl=Dt,lo="value"in hl?hl.value:hl.textContent,pi=!0)),js=Np(yt,ca),0<js.length&&(ca=new ot(ca,n,null,d,Dt),It.push({event:ca,listeners:js}),Ys?ca.data=Ys:(Ys=Zo(d),Ys!==null&&(ca.data=Ys)))),(Ys=oo?Rn(n,d):Xi(n,d))&&(ca=Np(yt,"onBeforeInput"),0<ca.length&&(js=new ot("onBeforeInput","beforeinput",null,d,Dt),It.push({event:js,listeners:ca}),js.data=Ys)),J_(It,n,yt,d,Dt)}Av(It,i)})}function Lx(n,i,d){return{instance:n,listener:i,currentTarget:d}}function Np(n,i){for(var d=i+"Capture",p=[];n!==null;){var _=n,L=_.stateNode;if(_=_.tag,_!==5&&_!==26&&_!==27||L===null||(_=xl(n,d),_!=null&&p.unshift(Lx(n,_,L)),_=xl(n,i),_!=null&&p.push(Lx(n,_,L))),n.tag===3)return p;n=n.return}return[]}function sC(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function fv(n,i,d,p,_){for(var L=i._reactName,ue=[];d!==null&&d!==p;){var Re=d,tt=Re.alternate,yt=Re.stateNode;if(Re=Re.tag,tt!==null&&tt===p)break;Re!==5&&Re!==26&&Re!==27||yt===null||(tt=yt,_?(yt=xl(d,L),yt!=null&&ue.unshift(Lx(d,yt,tt))):_||(yt=xl(d,L),yt!=null&&ue.push(Lx(d,yt,tt)))),d=d.return}ue.length!==0&&n.push({event:i,listeners:ue})}var aC=/\r\n?/g,rC=/\u0000|\uFFFD/g;function bv(n){return(typeof n=="string"?n:""+n).replace(aC,`
`).replace(rC,"")}function yv(n,i){return i=bv(i),bv(n)===i}function Oa(n,i,d,p,_,L){switch(d){case"children":typeof p=="string"?i==="body"||i==="textarea"&&p===""||ml(n,p):(typeof p=="number"||typeof p=="bigint")&&i!=="body"&&ml(n,""+p);break;case"className":Vl(n,"class",p);break;case"tabIndex":Vl(n,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Vl(n,d,p);break;case"style":Ss(n,p,L);break;case"data":if(i!=="object"){Vl(n,"data",p);break}case"src":case"href":if(p===""&&(i!=="a"||d!=="href")){n.removeAttribute(d);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){n.removeAttribute(d);break}p=qn(""+p),n.setAttribute(d,p);break;case"action":case"formAction":if(typeof p=="function"){n.setAttribute(d,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof L=="function"&&(d==="formAction"?(i!=="input"&&Oa(n,i,"name",_.name,_,null),Oa(n,i,"formEncType",_.formEncType,_,null),Oa(n,i,"formMethod",_.formMethod,_,null),Oa(n,i,"formTarget",_.formTarget,_,null)):(Oa(n,i,"encType",_.encType,_,null),Oa(n,i,"method",_.method,_,null),Oa(n,i,"target",_.target,_,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){n.removeAttribute(d);break}p=qn(""+p),n.setAttribute(d,p);break;case"onClick":p!=null&&(n.onclick=Yl);break;case"onScroll":p!=null&&sa("scroll",n);break;case"onScrollEnd":p!=null&&sa("scrollend",n);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(d=p.__html,d!=null){if(_.children!=null)throw Error(r(60));n.innerHTML=d}}break;case"multiple":n.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":n.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){n.removeAttribute("xlink:href");break}d=qn(""+p),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?n.setAttribute(d,""+p):n.removeAttribute(d);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?n.setAttribute(d,""):n.removeAttribute(d);break;case"capture":case"download":p===!0?n.setAttribute(d,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?n.setAttribute(d,p):n.removeAttribute(d);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?n.setAttribute(d,p):n.removeAttribute(d);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?n.removeAttribute(d):n.setAttribute(d,p);break;case"popover":sa("beforetoggle",n),sa("toggle",n),hn(n,"popover",p);break;case"xlinkActuate":dl(n,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":dl(n,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":dl(n,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":dl(n,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":dl(n,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":dl(n,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":dl(n,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":dl(n,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":dl(n,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":hn(n,"is",p);break;case"innerText":case"textContent":break;default:(!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(d=ul.get(d)||d,hn(n,d,p))}}function F0(n,i,d,p,_,L){switch(d){case"style":Ss(n,p,L);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(d=p.__html,d!=null){if(_.children!=null)throw Error(r(60));n.innerHTML=d}}break;case"children":typeof p=="string"?ml(n,p):(typeof p=="number"||typeof p=="bigint")&&ml(n,""+p);break;case"onScroll":p!=null&&sa("scroll",n);break;case"onScrollEnd":p!=null&&sa("scrollend",n);break;case"onClick":p!=null&&(n.onclick=Yl);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ae.hasOwnProperty(d))e:{if(d[0]==="o"&&d[1]==="n"&&(_=d.endsWith("Capture"),i=d.slice(2,_?d.length-7:void 0),L=n[he]||null,L=L!=null?L[d]:null,typeof L=="function"&&n.removeEventListener(i,L,_),typeof p=="function")){typeof L!="function"&&L!==null&&(d in n?n[d]=null:n.hasAttribute(d)&&n.removeAttribute(d)),n.addEventListener(i,p,_);break e}d in n?n[d]=p:p===!0?n.setAttribute(d,""):hn(n,d,p)}}}function Pn(n,i,d){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":sa("error",n),sa("load",n);var p=!1,_=!1,L;for(L in d)if(d.hasOwnProperty(L)){var ue=d[L];if(ue!=null)switch(L){case"src":p=!0;break;case"srcSet":_=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:Oa(n,i,L,ue,d,null)}}_&&Oa(n,i,"srcSet",d.srcSet,d,null),p&&Oa(n,i,"src",d.src,d,null);return;case"input":sa("invalid",n);var Re=L=ue=_=null,tt=null,yt=null;for(p in d)if(d.hasOwnProperty(p)){var Dt=d[p];if(Dt!=null)switch(p){case"name":_=Dt;break;case"type":ue=Dt;break;case"checked":tt=Dt;break;case"defaultChecked":yt=Dt;break;case"value":L=Dt;break;case"defaultValue":Re=Dt;break;case"children":case"dangerouslySetInnerHTML":if(Dt!=null)throw Error(r(137,i));break;default:Oa(n,i,p,Dt,d,null)}}Vo(n,L,Re,tt,yt,ue,_,!1);return;case"select":sa("invalid",n),p=ue=L=null;for(_ in d)if(d.hasOwnProperty(_)&&(Re=d[_],Re!=null))switch(_){case"value":L=Re;break;case"defaultValue":ue=Re;break;case"multiple":p=Re;default:Oa(n,i,_,Re,d,null)}i=L,d=ue,n.multiple=!!p,i!=null?Gr(n,!!p,i,!1):d!=null&&Gr(n,!!p,d,!0);return;case"textarea":sa("invalid",n),L=_=p=null;for(ue in d)if(d.hasOwnProperty(ue)&&(Re=d[ue],Re!=null))switch(ue){case"value":p=Re;break;case"defaultValue":_=Re;break;case"children":L=Re;break;case"dangerouslySetInnerHTML":if(Re!=null)throw Error(r(91));break;default:Oa(n,i,ue,Re,d,null)}ao(n,p,_,L);return;case"option":for(tt in d)if(d.hasOwnProperty(tt)&&(p=d[tt],p!=null))switch(tt){case"selected":n.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:Oa(n,i,tt,p,d,null)}return;case"dialog":sa("beforetoggle",n),sa("toggle",n),sa("cancel",n),sa("close",n);break;case"iframe":case"object":sa("load",n);break;case"video":case"audio":for(p=0;p<Tx.length;p++)sa(Tx[p],n);break;case"image":sa("error",n),sa("load",n);break;case"details":sa("toggle",n);break;case"embed":case"source":case"link":sa("error",n),sa("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(yt in d)if(d.hasOwnProperty(yt)&&(p=d[yt],p!=null))switch(yt){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:Oa(n,i,yt,p,d,null)}return;default:if(xr(i)){for(Dt in d)d.hasOwnProperty(Dt)&&(p=d[Dt],p!==void 0&&F0(n,i,Dt,p,d,void 0));return}}for(Re in d)d.hasOwnProperty(Re)&&(p=d[Re],p!=null&&Oa(n,i,Re,p,d,null))}function nC(n,i,d,p){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var _=null,L=null,ue=null,Re=null,tt=null,yt=null,Dt=null;for(St in d){var It=d[St];if(d.hasOwnProperty(St)&&It!=null)switch(St){case"checked":break;case"value":break;case"defaultValue":tt=It;default:p.hasOwnProperty(St)||Oa(n,i,St,null,p,It)}}for(var jt in p){var St=p[jt];if(It=d[jt],p.hasOwnProperty(jt)&&(St!=null||It!=null))switch(jt){case"type":L=St;break;case"name":_=St;break;case"checked":yt=St;break;case"defaultChecked":Dt=St;break;case"value":ue=St;break;case"defaultValue":Re=St;break;case"children":case"dangerouslySetInnerHTML":if(St!=null)throw Error(r(137,i));break;default:St!==It&&Oa(n,i,jt,St,p,It)}}_c(n,ue,Re,tt,yt,Dt,L,_);return;case"select":St=ue=Re=jt=null;for(L in d)if(tt=d[L],d.hasOwnProperty(L)&&tt!=null)switch(L){case"value":break;case"multiple":St=tt;default:p.hasOwnProperty(L)||Oa(n,i,L,null,p,tt)}for(_ in p)if(L=p[_],tt=d[_],p.hasOwnProperty(_)&&(L!=null||tt!=null))switch(_){case"value":jt=L;break;case"defaultValue":Re=L;break;case"multiple":ue=L;default:L!==tt&&Oa(n,i,_,L,p,tt)}i=Re,d=ue,p=St,jt!=null?Gr(n,!!d,jt,!1):!!p!=!!d&&(i!=null?Gr(n,!!d,i,!0):Gr(n,!!d,d?[]:"",!1));return;case"textarea":St=jt=null;for(Re in d)if(_=d[Re],d.hasOwnProperty(Re)&&_!=null&&!p.hasOwnProperty(Re))switch(Re){case"value":break;case"children":break;default:Oa(n,i,Re,null,p,_)}for(ue in p)if(_=p[ue],L=d[ue],p.hasOwnProperty(ue)&&(_!=null||L!=null))switch(ue){case"value":jt=_;break;case"defaultValue":St=_;break;case"children":break;case"dangerouslySetInnerHTML":if(_!=null)throw Error(r(91));break;default:_!==L&&Oa(n,i,ue,_,p,L)}so(n,jt,St);return;case"option":for(var gs in d)if(jt=d[gs],d.hasOwnProperty(gs)&&jt!=null&&!p.hasOwnProperty(gs))switch(gs){case"selected":n.selected=!1;break;default:Oa(n,i,gs,null,p,jt)}for(tt in p)if(jt=p[tt],St=d[tt],p.hasOwnProperty(tt)&&jt!==St&&(jt!=null||St!=null))switch(tt){case"selected":n.selected=jt&&typeof jt!="function"&&typeof jt!="symbol";break;default:Oa(n,i,tt,jt,p,St)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ls in d)jt=d[Ls],d.hasOwnProperty(Ls)&&jt!=null&&!p.hasOwnProperty(Ls)&&Oa(n,i,Ls,null,p,jt);for(yt in p)if(jt=p[yt],St=d[yt],p.hasOwnProperty(yt)&&jt!==St&&(jt!=null||St!=null))switch(yt){case"children":case"dangerouslySetInnerHTML":if(jt!=null)throw Error(r(137,i));break;default:Oa(n,i,yt,jt,p,St)}return;default:if(xr(i)){for(var za in d)jt=d[za],d.hasOwnProperty(za)&&jt!==void 0&&!p.hasOwnProperty(za)&&F0(n,i,za,void 0,p,jt);for(Dt in p)jt=p[Dt],St=d[Dt],!p.hasOwnProperty(Dt)||jt===St||jt===void 0&&St===void 0||F0(n,i,Dt,jt,p,St);return}}for(var dt in d)jt=d[dt],d.hasOwnProperty(dt)&&jt!=null&&!p.hasOwnProperty(dt)&&Oa(n,i,dt,null,p,jt);for(It in p)jt=p[It],St=d[It],!p.hasOwnProperty(It)||jt===St||jt==null&&St==null||Oa(n,i,It,jt,p,St)}function jv(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function lC(){if(typeof performance.getEntriesByType=="function"){for(var n=0,i=0,d=performance.getEntriesByType("resource"),p=0;p<d.length;p++){var _=d[p],L=_.transferSize,ue=_.initiatorType,Re=_.duration;if(L&&Re&&jv(ue)){for(ue=0,Re=_.responseEnd,p+=1;p<d.length;p++){var tt=d[p],yt=tt.startTime;if(yt>Re)break;var Dt=tt.transferSize,It=tt.initiatorType;Dt&&jv(It)&&(tt=tt.responseEnd,ue+=Dt*(tt<Re?1:(Re-yt)/(tt-yt)))}if(--p,i+=8*(L+ue)/(_.duration/1e3),n++,10<n)break}}if(0<n)return i/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var E0=null,D0=null;function wp(n){return n.nodeType===9?n:n.ownerDocument}function vv(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Nv(n,i){if(n===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&i==="foreignObject"?0:n}function U0(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var T0=null;function iC(){var n=window.event;return n&&n.type==="popstate"?n===T0?!1:(T0=n,!0):(T0=null,!1)}var wv=typeof setTimeout=="function"?setTimeout:void 0,cC=typeof clearTimeout=="function"?clearTimeout:void 0,_v=typeof Promise=="function"?Promise:void 0,oC=typeof queueMicrotask=="function"?queueMicrotask:typeof _v<"u"?function(n){return _v.resolve(null).then(n).catch(dC)}:wv;function dC(n){setTimeout(function(){throw n})}function vd(n){return n==="head"}function Cv(n,i){var d=i,p=0;do{var _=d.nextSibling;if(n.removeChild(d),_&&_.nodeType===8)if(d=_.data,d==="/$"||d==="/&"){if(p===0){n.removeChild(_),wu(i);return}p--}else if(d==="$"||d==="$?"||d==="$~"||d==="$!"||d==="&")p++;else if(d==="html")Qx(n.ownerDocument.documentElement);else if(d==="head"){d=n.ownerDocument.head,Qx(d);for(var L=d.firstChild;L;){var ue=L.nextSibling,Re=L.nodeName;L[pa]||Re==="SCRIPT"||Re==="STYLE"||Re==="LINK"&&L.rel.toLowerCase()==="stylesheet"||d.removeChild(L),L=ue}}else d==="body"&&Qx(n.ownerDocument.body);d=_}while(d);wu(i)}function Sv(n,i){var d=n;n=0;do{var p=d.nextSibling;if(d.nodeType===1?i?(d._stashedDisplay=d.style.display,d.style.display="none"):(d.style.display=d._stashedDisplay||"",d.getAttribute("style")===""&&d.removeAttribute("style")):d.nodeType===3&&(i?(d._stashedText=d.nodeValue,d.nodeValue=""):d.nodeValue=d._stashedText||""),p&&p.nodeType===8)if(d=p.data,d==="/$"){if(n===0)break;n--}else d!=="$"&&d!=="$?"&&d!=="$~"&&d!=="$!"||n++;d=p}while(d)}function L0(n){var i=n.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var d=i;switch(i=i.nextSibling,d.nodeName){case"HTML":case"HEAD":case"BODY":L0(d),ba(d);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(d.rel.toLowerCase()==="stylesheet")continue}n.removeChild(d)}}function mC(n,i,d,p){for(;n.nodeType===1;){var _=d;if(n.nodeName.toLowerCase()!==i.toLowerCase()){if(!p&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(p){if(!n[pa])switch(i){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(L=n.getAttribute("rel"),L==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(L!==_.rel||n.getAttribute("href")!==(_.href==null||_.href===""?null:_.href)||n.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin)||n.getAttribute("title")!==(_.title==null?null:_.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(L=n.getAttribute("src"),(L!==(_.src==null?null:_.src)||n.getAttribute("type")!==(_.type==null?null:_.type)||n.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin))&&L&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(i==="input"&&n.type==="hidden"){var L=_.name==null?null:""+_.name;if(_.type==="hidden"&&n.getAttribute("name")===L)return n}else return n;if(n=_i(n.nextSibling),n===null)break}return null}function uC(n,i,d){if(i==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!d||(n=_i(n.nextSibling),n===null))return null;return n}function kv(n,i){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!i||(n=_i(n.nextSibling),n===null))return null;return n}function Q0(n){return n.data==="$?"||n.data==="$~"}function R0(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function xC(n,i){var d=n.ownerDocument;if(n.data==="$~")n._reactRetry=i;else if(n.data!=="$?"||d.readyState!=="loading")i();else{var p=function(){i(),d.removeEventListener("DOMContentLoaded",p)};d.addEventListener("DOMContentLoaded",p),n._reactRetry=p}}function _i(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return n}var M0=null;function Bv(n){n=n.nextSibling;for(var i=0;n;){if(n.nodeType===8){var d=n.data;if(d==="/$"||d==="/&"){if(i===0)return _i(n.nextSibling);i--}else d!=="$"&&d!=="$!"&&d!=="$?"&&d!=="$~"&&d!=="&"||i++}n=n.nextSibling}return null}function Fv(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var d=n.data;if(d==="$"||d==="$!"||d==="$?"||d==="$~"||d==="&"){if(i===0)return n;i--}else d!=="/$"&&d!=="/&"||i++}n=n.previousSibling}return null}function Ev(n,i,d){switch(i=wp(d),n){case"html":if(n=i.documentElement,!n)throw Error(r(452));return n;case"head":if(n=i.head,!n)throw Error(r(453));return n;case"body":if(n=i.body,!n)throw Error(r(454));return n;default:throw Error(r(451))}}function Qx(n){for(var i=n.attributes;i.length;)n.removeAttributeNode(i[0]);ba(n)}var Ci=new Map,Dv=new Set;function _p(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Bo=re.d;re.d={f:hC,r:pC,D:AC,C:gC,L:fC,m:bC,X:jC,S:yC,M:vC};function hC(){var n=Bo.f(),i=Ap();return n||i}function pC(n){var i=zr(n);i!==null&&i.tag===5&&i.type==="form"?Yy(i):Bo.r(n)}var ju=typeof document>"u"?null:document;function Uv(n,i,d){var p=ju;if(p&&typeof i=="string"&&i){var _=ur(i);_='link[rel="'+n+'"][href="'+_+'"]',typeof d=="string"&&(_+='[crossorigin="'+d+'"]'),Dv.has(_)||(Dv.add(_),n={rel:n,crossOrigin:d,href:i},p.querySelector(_)===null&&(i=p.createElement("link"),Pn(i,"link",n),rs(i),p.head.appendChild(i)))}}function AC(n){Bo.D(n),Uv("dns-prefetch",n,null)}function gC(n,i){Bo.C(n,i),Uv("preconnect",n,i)}function fC(n,i,d){Bo.L(n,i,d);var p=ju;if(p&&n&&i){var _='link[rel="preload"][as="'+ur(i)+'"]';i==="image"&&d&&d.imageSrcSet?(_+='[imagesrcset="'+ur(d.imageSrcSet)+'"]',typeof d.imageSizes=="string"&&(_+='[imagesizes="'+ur(d.imageSizes)+'"]')):_+='[href="'+ur(n)+'"]';var L=_;switch(i){case"style":L=vu(n);break;case"script":L=Nu(n)}Ci.has(L)||(n=g({rel:"preload",href:i==="image"&&d&&d.imageSrcSet?void 0:n,as:i},d),Ci.set(L,n),p.querySelector(_)!==null||i==="style"&&p.querySelector(Rx(L))||i==="script"&&p.querySelector(Mx(L))||(i=p.createElement("link"),Pn(i,"link",n),rs(i),p.head.appendChild(i)))}}function bC(n,i){Bo.m(n,i);var d=ju;if(d&&n){var p=i&&typeof i.as=="string"?i.as:"script",_='link[rel="modulepreload"][as="'+ur(p)+'"][href="'+ur(n)+'"]',L=_;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":L=Nu(n)}if(!Ci.has(L)&&(n=g({rel:"modulepreload",href:n},i),Ci.set(L,n),d.querySelector(_)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(d.querySelector(Mx(L)))return}p=d.createElement("link"),Pn(p,"link",n),rs(p),d.head.appendChild(p)}}}function yC(n,i,d){Bo.S(n,i,d);var p=ju;if(p&&n){var _=Jt(p).hoistableStyles,L=vu(n);i=i||"default";var ue=_.get(L);if(!ue){var Re={loading:0,preload:null};if(ue=p.querySelector(Rx(L)))Re.loading=5;else{n=g({rel:"stylesheet",href:n,"data-precedence":i},d),(d=Ci.get(L))&&I0(n,d);var tt=ue=p.createElement("link");rs(tt),Pn(tt,"link",n),tt._p=new Promise(function(yt,Dt){tt.onload=yt,tt.onerror=Dt}),tt.addEventListener("load",function(){Re.loading|=1}),tt.addEventListener("error",function(){Re.loading|=2}),Re.loading|=4,Cp(ue,i,p)}ue={type:"stylesheet",instance:ue,count:1,state:Re},_.set(L,ue)}}}function jC(n,i){Bo.X(n,i);var d=ju;if(d&&n){var p=Jt(d).hoistableScripts,_=Nu(n),L=p.get(_);L||(L=d.querySelector(Mx(_)),L||(n=g({src:n,async:!0},i),(i=Ci.get(_))&&$0(n,i),L=d.createElement("script"),rs(L),Pn(L,"link",n),d.head.appendChild(L)),L={type:"script",instance:L,count:1,state:null},p.set(_,L))}}function vC(n,i){Bo.M(n,i);var d=ju;if(d&&n){var p=Jt(d).hoistableScripts,_=Nu(n),L=p.get(_);L||(L=d.querySelector(Mx(_)),L||(n=g({src:n,async:!0,type:"module"},i),(i=Ci.get(_))&&$0(n,i),L=d.createElement("script"),rs(L),Pn(L,"link",n),d.head.appendChild(L)),L={type:"script",instance:L,count:1,state:null},p.set(_,L))}}function Tv(n,i,d,p){var _=(_=w.current)?_p(_):null;if(!_)throw Error(r(446));switch(n){case"meta":case"title":return null;case"style":return typeof d.precedence=="string"&&typeof d.href=="string"?(i=vu(d.href),d=Jt(_).hoistableStyles,p=d.get(i),p||(p={type:"style",instance:null,count:0,state:null},d.set(i,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(d.rel==="stylesheet"&&typeof d.href=="string"&&typeof d.precedence=="string"){n=vu(d.href);var L=Jt(_).hoistableStyles,ue=L.get(n);if(ue||(_=_.ownerDocument||_,ue={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},L.set(n,ue),(L=_.querySelector(Rx(n)))&&!L._p&&(ue.instance=L,ue.state.loading=5),Ci.has(n)||(d={rel:"preload",as:"style",href:d.href,crossOrigin:d.crossOrigin,integrity:d.integrity,media:d.media,hrefLang:d.hrefLang,referrerPolicy:d.referrerPolicy},Ci.set(n,d),L||NC(_,n,d,ue.state))),i&&p===null)throw Error(r(528,""));return ue}if(i&&p!==null)throw Error(r(529,""));return null;case"script":return i=d.async,d=d.src,typeof d=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Nu(d),d=Jt(_).hoistableScripts,p=d.get(i),p||(p={type:"script",instance:null,count:0,state:null},d.set(i,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,n))}}function vu(n){return'href="'+ur(n)+'"'}function Rx(n){return'link[rel="stylesheet"]['+n+"]"}function Lv(n){return g({},n,{"data-precedence":n.precedence,precedence:null})}function NC(n,i,d,p){n.querySelector('link[rel="preload"][as="style"]['+i+"]")?p.loading=1:(i=n.createElement("link"),p.preload=i,i.addEventListener("load",function(){return p.loading|=1}),i.addEventListener("error",function(){return p.loading|=2}),Pn(i,"link",d),rs(i),n.head.appendChild(i))}function Nu(n){return'[src="'+ur(n)+'"]'}function Mx(n){return"script[async]"+n}function Qv(n,i,d){if(i.count++,i.instance===null)switch(i.type){case"style":var p=n.querySelector('style[data-href~="'+ur(d.href)+'"]');if(p)return i.instance=p,rs(p),p;var _=g({},d,{"data-href":d.href,"data-precedence":d.precedence,href:null,precedence:null});return p=(n.ownerDocument||n).createElement("style"),rs(p),Pn(p,"style",_),Cp(p,d.precedence,n),i.instance=p;case"stylesheet":_=vu(d.href);var L=n.querySelector(Rx(_));if(L)return i.state.loading|=4,i.instance=L,rs(L),L;p=Lv(d),(_=Ci.get(_))&&I0(p,_),L=(n.ownerDocument||n).createElement("link"),rs(L);var ue=L;return ue._p=new Promise(function(Re,tt){ue.onload=Re,ue.onerror=tt}),Pn(L,"link",p),i.state.loading|=4,Cp(L,d.precedence,n),i.instance=L;case"script":return L=Nu(d.src),(_=n.querySelector(Mx(L)))?(i.instance=_,rs(_),_):(p=d,(_=Ci.get(L))&&(p=g({},d),$0(p,_)),n=n.ownerDocument||n,_=n.createElement("script"),rs(_),Pn(_,"link",p),n.head.appendChild(_),i.instance=_);case"void":return null;default:throw Error(r(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(p=i.instance,i.state.loading|=4,Cp(p,d.precedence,n));return i.instance}function Cp(n,i,d){for(var p=d.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),_=p.length?p[p.length-1]:null,L=_,ue=0;ue<p.length;ue++){var Re=p[ue];if(Re.dataset.precedence===i)L=Re;else if(L!==_)break}L?L.parentNode.insertBefore(n,L.nextSibling):(i=d.nodeType===9?d.head:d,i.insertBefore(n,i.firstChild))}function I0(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.title==null&&(n.title=i.title)}function $0(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.integrity==null&&(n.integrity=i.integrity)}var Sp=null;function Rv(n,i,d){if(Sp===null){var p=new Map,_=Sp=new Map;_.set(d,p)}else _=Sp,p=_.get(d),p||(p=new Map,_.set(d,p));if(p.has(n))return p;for(p.set(n,null),d=d.getElementsByTagName(n),_=0;_<d.length;_++){var L=d[_];if(!(L[pa]||L[ss]||n==="link"&&L.getAttribute("rel")==="stylesheet")&&L.namespaceURI!=="http://www.w3.org/2000/svg"){var ue=L.getAttribute(i)||"";ue=n+ue;var Re=p.get(ue);Re?Re.push(L):p.set(ue,[L])}}return p}function Mv(n,i,d){n=n.ownerDocument||n,n.head.insertBefore(d,i==="title"?n.querySelector("head > title"):null)}function wC(n,i,d){if(d===1||i.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return n=i.disabled,typeof i.precedence=="string"&&n==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Iv(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function _C(n,i,d,p){if(d.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(d.state.loading&4)===0){if(d.instance===null){var _=vu(p.href),L=i.querySelector(Rx(_));if(L){i=L._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(n.count++,n=kp.bind(n),i.then(n,n)),d.state.loading|=4,d.instance=L,rs(L);return}L=i.ownerDocument||i,p=Lv(p),(_=Ci.get(_))&&I0(p,_),L=L.createElement("link"),rs(L);var ue=L;ue._p=new Promise(function(Re,tt){ue.onload=Re,ue.onerror=tt}),Pn(L,"link",p),d.instance=L}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(d,i),(i=d.state.preload)&&(d.state.loading&3)===0&&(n.count++,d=kp.bind(n),i.addEventListener("load",d),i.addEventListener("error",d))}}var H0=0;function CC(n,i){return n.stylesheets&&n.count===0&&Fp(n,n.stylesheets),0<n.count||0<n.imgCount?function(d){var p=setTimeout(function(){if(n.stylesheets&&Fp(n,n.stylesheets),n.unsuspend){var L=n.unsuspend;n.unsuspend=null,L()}},6e4+i);0<n.imgBytes&&H0===0&&(H0=62500*lC());var _=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&Fp(n,n.stylesheets),n.unsuspend)){var L=n.unsuspend;n.unsuspend=null,L()}},(n.imgBytes>H0?50:800)+i);return n.unsuspend=d,function(){n.unsuspend=null,clearTimeout(p),clearTimeout(_)}}:null}function kp(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Fp(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Bp=null;function Fp(n,i){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Bp=new Map,i.forEach(SC,n),Bp=null,kp.call(n))}function SC(n,i){if(!(i.state.loading&4)){var d=Bp.get(n);if(d)var p=d.get(null);else{d=new Map,Bp.set(n,d);for(var _=n.querySelectorAll("link[data-precedence],style[data-precedence]"),L=0;L<_.length;L++){var ue=_[L];(ue.nodeName==="LINK"||ue.getAttribute("media")!=="not all")&&(d.set(ue.dataset.precedence,ue),p=ue)}p&&d.set(null,p)}_=i.instance,ue=_.getAttribute("data-precedence"),L=d.get(ue)||p,L===p&&d.set(null,_),d.set(ue,_),this.count++,p=kp.bind(this),_.addEventListener("load",p),_.addEventListener("error",p),L?L.parentNode.insertBefore(_,L.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(_,n.firstChild)),i.state.loading|=4}}var Ix={$$typeof:K,Provider:null,Consumer:null,_currentValue:ge,_currentValue2:ge,_threadCount:0};function kC(n,i,d,p,_,L,ue,Re,tt){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=lt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=lt(0),this.hiddenUpdates=lt(null),this.identifierPrefix=p,this.onUncaughtError=_,this.onCaughtError=L,this.onRecoverableError=ue,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=tt,this.incompleteTransitions=new Map}function $v(n,i,d,p,_,L,ue,Re,tt,yt,Dt,It){return n=new kC(n,i,d,ue,tt,yt,Dt,It,Re),i=1,L===!0&&(i|=24),L=kn(3,null,null,i),n.current=L,L.stateNode=n,i=dd(),i.refCount++,n.pooledCache=i,i.refCount++,L.memoizedState={element:p,isDehydrated:d,cache:i},ts(L),n}function Hv(n){return n?(n=bn,n):bn}function Pv(n,i,d,p,_,L){_=Hv(_),p.context===null?p.context=_:p.pendingContext=_,p=Ds(i),p.payload={element:d},L=L===void 0?null:L,L!==null&&(p.callback=L),d=Ks(n,p,i),d!==null&&($l(d,n,i),Ba(d,n,i))}function Ov(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var d=n.retryLane;n.retryLane=d!==0&&d<i?d:i}}function P0(n,i){Ov(n,i),(n=n.alternate)&&Ov(n,i)}function zv(n){if(n.tag===13||n.tag===31){var i=rc(n,67108864);i!==null&&$l(i,n,67108864),P0(n,67108864)}}function Gv(n){if(n.tag===13||n.tag===31){var i=ri();i=Te(i);var d=rc(n,i);d!==null&&$l(d,n,i),P0(n,i)}}var Ep=!0;function BC(n,i,d,p){var _=V.T;V.T=null;var L=re.p;try{re.p=2,O0(n,i,d,p)}finally{re.p=L,V.T=_}}function FC(n,i,d,p){var _=V.T;V.T=null;var L=re.p;try{re.p=8,O0(n,i,d,p)}finally{re.p=L,V.T=_}}function O0(n,i,d,p){if(Ep){var _=z0(p);if(_===null)B0(n,i,p,Dp,d),Kv(n,p);else if(DC(_,n,i,d,p))p.stopPropagation();else if(Kv(n,p),i&4&&-1<EC.indexOf(n)){for(;_!==null;){var L=zr(_);if(L!==null)switch(L.tag){case 3:if(L=L.stateNode,L.current.memoizedState.isDehydrated){var ue=me(L.pendingLanes);if(ue!==0){var Re=L;for(Re.pendingLanes|=2,Re.entangledLanes|=2;ue;){var tt=1<<31-mt(ue);Re.entanglements[1]|=tt,ue&=~tt}Oc(L),(Ea&6)===0&&(hp=ie()+500,Ux(0))}}break;case 31:case 13:Re=rc(L,2),Re!==null&&$l(Re,L,2),Ap(),P0(L,2)}if(L=z0(p),L===null&&B0(n,i,p,Dp,d),L===_)break;_=L}_!==null&&p.stopPropagation()}else B0(n,i,p,null,d)}}function z0(n){return n=ro(n),G0(n)}var Dp=null;function G0(n){if(Dp=null,n=xn(n),n!==null){var i=c(n);if(i===null)n=null;else{var d=i.tag;if(d===13){if(n=o(i),n!==null)return n;n=null}else if(d===31){if(n=m(i),n!==null)return n;n=null}else if(d===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}return Dp=n,null}function qv(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(q()){case pe:return 2;case Me:return 8;case Se:case Ne:return 32;case et:return 268435456;default:return 32}default:return 32}}var q0=!1,Nd=null,wd=null,_d=null,$x=new Map,Hx=new Map,Cd=[],EC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Kv(n,i){switch(n){case"focusin":case"focusout":Nd=null;break;case"dragenter":case"dragleave":wd=null;break;case"mouseover":case"mouseout":_d=null;break;case"pointerover":case"pointerout":$x.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hx.delete(i.pointerId)}}function Px(n,i,d,p,_,L){return n===null||n.nativeEvent!==L?(n={blockedOn:i,domEventName:d,eventSystemFlags:p,nativeEvent:L,targetContainers:[_]},i!==null&&(i=zr(i),i!==null&&zv(i)),n):(n.eventSystemFlags|=p,i=n.targetContainers,_!==null&&i.indexOf(_)===-1&&i.push(_),n)}function DC(n,i,d,p,_){switch(i){case"focusin":return Nd=Px(Nd,n,i,d,p,_),!0;case"dragenter":return wd=Px(wd,n,i,d,p,_),!0;case"mouseover":return _d=Px(_d,n,i,d,p,_),!0;case"pointerover":var L=_.pointerId;return $x.set(L,Px($x.get(L)||null,n,i,d,p,_)),!0;case"gotpointercapture":return L=_.pointerId,Hx.set(L,Px(Hx.get(L)||null,n,i,d,p,_)),!0}return!1}function Vv(n){var i=xn(n.target);if(i!==null){var d=c(i);if(d!==null){if(i=d.tag,i===13){if(i=o(d),i!==null){n.blockedOn=i,ls(n.priority,function(){Gv(d)});return}}else if(i===31){if(i=m(d),i!==null){n.blockedOn=i,ls(n.priority,function(){Gv(d)});return}}else if(i===3&&d.stateNode.current.memoizedState.isDehydrated){n.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Up(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var d=z0(n.nativeEvent);if(d===null){d=n.nativeEvent;var p=new d.constructor(d.type,d);Hi=p,d.target.dispatchEvent(p),Hi=null}else return i=zr(d),i!==null&&zv(i),n.blockedOn=d,!1;i.shift()}return!0}function Yv(n,i,d){Up(n)&&d.delete(i)}function UC(){q0=!1,Nd!==null&&Up(Nd)&&(Nd=null),wd!==null&&Up(wd)&&(wd=null),_d!==null&&Up(_d)&&(_d=null),$x.forEach(Yv),Hx.forEach(Yv)}function Tp(n,i){n.blockedOn===i&&(n.blockedOn=null,q0||(q0=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,UC)))}var Lp=null;function Wv(n){Lp!==n&&(Lp=n,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Lp===n&&(Lp=null);for(var i=0;i<n.length;i+=3){var d=n[i],p=n[i+1],_=n[i+2];if(typeof p!="function"){if(G0(p||d)===null)continue;break}var L=zr(d);L!==null&&(n.splice(i,3),i-=3,zg(L,{pending:!0,data:_,method:d.method,action:p},p,_))}}))}function wu(n){function i(tt){return Tp(tt,n)}Nd!==null&&Tp(Nd,n),wd!==null&&Tp(wd,n),_d!==null&&Tp(_d,n),$x.forEach(i),Hx.forEach(i);for(var d=0;d<Cd.length;d++){var p=Cd[d];p.blockedOn===n&&(p.blockedOn=null)}for(;0<Cd.length&&(d=Cd[0],d.blockedOn===null);)Vv(d),d.blockedOn===null&&Cd.shift();if(d=(n.ownerDocument||n).$$reactFormReplay,d!=null)for(p=0;p<d.length;p+=3){var _=d[p],L=d[p+1],ue=_[he]||null;if(typeof L=="function")ue||Wv(d);else if(ue){var Re=null;if(L&&L.hasAttribute("formAction")){if(_=L,ue=L[he]||null)Re=ue.formAction;else if(G0(_)!==null)continue}else Re=ue.action;typeof Re=="function"?d[p+1]=Re:(d.splice(p,3),p-=3),Wv(d)}}}function Xv(){function n(L){L.canIntercept&&L.info==="react-transition"&&L.intercept({handler:function(){return new Promise(function(ue){return _=ue})},focusReset:"manual",scroll:"manual"})}function i(){_!==null&&(_(),_=null),p||setTimeout(d,20)}function d(){if(!p&&!navigation.transition){var L=navigation.currentEntry;L&&L.url!=null&&navigation.navigate(L.url,{state:L.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,_=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(d,100),function(){p=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),_!==null&&(_(),_=null)}}}function K0(n){this._internalRoot=n}Qp.prototype.render=K0.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(r(409));var d=i.current,p=ri();Pv(d,p,n,i,null,null)},Qp.prototype.unmount=K0.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;Pv(n.current,2,null,n,null,null),Ap(),i[Ht]=null}};function Qp(n){this._internalRoot=n}Qp.prototype.unstable_scheduleHydration=function(n){if(n){var i=Xt();n={blockedOn:null,target:n,priority:i};for(var d=0;d<Cd.length&&i!==0&&i<Cd[d].priority;d++);Cd.splice(d,0,n),d===0&&Vv(n)}};var Jv=s.version;if(Jv!=="19.2.0")throw Error(r(527,Jv,"19.2.0"));re.findDOMNode=function(n){var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(r(188)):(n=Object.keys(n).join(","),Error(r(268,n)));return n=x(i),n=n!==null?A(n):null,n=n===null?null:n.stateNode,n};var TC={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:V,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Rp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rp.isDisabled&&Rp.supportsFiber)try{qe=Rp.inject(TC),W=Rp}catch{}}return zx.createRoot=function(n,i){if(!l(n))throw Error(r(299));var d=!1,p="",_=nj,L=lj,ue=ij;return i!=null&&(i.unstable_strictMode===!0&&(d=!0),i.identifierPrefix!==void 0&&(p=i.identifierPrefix),i.onUncaughtError!==void 0&&(_=i.onUncaughtError),i.onCaughtError!==void 0&&(L=i.onCaughtError),i.onRecoverableError!==void 0&&(ue=i.onRecoverableError)),i=$v(n,1,!1,null,null,d,p,null,_,L,ue,Xv),n[Ht]=i.current,k0(n),new K0(i)},zx.hydrateRoot=function(n,i,d){if(!l(n))throw Error(r(299));var p=!1,_="",L=nj,ue=lj,Re=ij,tt=null;return d!=null&&(d.unstable_strictMode===!0&&(p=!0),d.identifierPrefix!==void 0&&(_=d.identifierPrefix),d.onUncaughtError!==void 0&&(L=d.onUncaughtError),d.onCaughtError!==void 0&&(ue=d.onCaughtError),d.onRecoverableError!==void 0&&(Re=d.onRecoverableError),d.formState!==void 0&&(tt=d.formState)),i=$v(n,1,!0,i,d??null,p,_,tt,L,ue,Re,Xv),i.context=Hv(null),d=i.current,p=ri(),p=Te(p),_=Ds(p),_.callback=null,Ks(d,_,p),d=p,i.current.lanes=d,Ue(i,d),Oc(i),n[Ht]=i.current,k0(n),new Qp(i)},zx.version="19.2.0",zx}var cN;function GC(){if(cN)return W0.exports;cN=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(s){console.error(s)}}return t(),W0.exports=zC(),W0.exports}var qC=GC();var oN="popstate";function KC(t={}){function s(r,l){let{pathname:c,search:o,hash:m}=r.location;return sb("",{pathname:c,search:o,hash:m},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function a(r,l){return typeof l=="string"?l:yh(l)}return YC(s,a,null,t)}function vr(t,s){if(t===!1||t===null||typeof t>"u")throw new Error(s)}function oi(t,s){if(!t){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function VC(){return Math.random().toString(36).substring(2,10)}function dN(t,s){return{usr:t.state,key:t.key,idx:s}}function sb(t,s,a=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof s=="string"?ex(s):s,state:a,key:s&&s.key||r||VC()}}function yh({pathname:t="/",search:s="",hash:a=""}){return s&&s!=="?"&&(t+=s.charAt(0)==="?"?s:"?"+s),a&&a!=="#"&&(t+=a.charAt(0)==="#"?a:"#"+a),t}function ex(t){let s={};if(t){let a=t.indexOf("#");a>=0&&(s.hash=t.substring(a),t=t.substring(0,a));let r=t.indexOf("?");r>=0&&(s.search=t.substring(r),t=t.substring(0,r)),t&&(s.pathname=t)}return s}function YC(t,s,a,r={}){let{window:l=document.defaultView,v5Compat:c=!1}=r,o=l.history,m="POP",u=null,x=A();x==null&&(x=0,o.replaceState({...o.state,idx:x},""));function A(){return(o.state||{idx:null}).idx}function g(){m="POP";let U=A(),D=U==null?null:U-x;x=U,u&&u({action:m,location:v.location,delta:D})}function N(U,D){m="PUSH";let M=sb(v.location,U,D);x=A()+1;let K=dN(M,x),$=v.createHref(M);try{o.pushState(K,"",$)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;l.location.assign($)}c&&u&&u({action:m,location:v.location,delta:1})}function f(U,D){m="REPLACE";let M=sb(v.location,U,D);x=A();let K=dN(M,x),$=v.createHref(M);o.replaceState(K,"",$),c&&u&&u({action:m,location:v.location,delta:0})}function y(U){return WC(U)}let v={get action(){return m},get location(){return t(l,o)},listen(U){if(u)throw new Error("A history only accepts one active listener");return l.addEventListener(oN,g),u=U,()=>{l.removeEventListener(oN,g),u=null}},createHref(U){return s(l,U)},createURL:y,encodeLocation(U){let D=y(U);return{pathname:D.pathname,search:D.search,hash:D.hash}},push:N,replace:f,go(U){return o.go(U)}};return v}function WC(t,s=!1){let a="http://localhost";typeof window<"u"&&(a=window.location.origin!=="null"?window.location.origin:window.location.href),vr(a,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:yh(t);return r=r.replace(/ $/,"%20"),!s&&r.startsWith("//")&&(r=a+r),new URL(r,a)}function f1(t,s,a="/"){return XC(t,s,a,!1)}function XC(t,s,a,r){let l=typeof s=="string"?ex(s):s,c=Po(l.pathname||"/",a);if(c==null)return null;let o=b1(t);JC(o);let m=null;for(let u=0;m==null&&u<o.length;++u){let x=o6(c);m=i6(o[u],x,r)}return m}function b1(t,s=[],a=[],r="",l=!1){let c=(o,m,u=l,x)=>{let A={relativePath:x===void 0?o.path||"":x,caseSensitive:o.caseSensitive===!0,childrenIndex:m,route:o};if(A.relativePath.startsWith("/")){if(!A.relativePath.startsWith(r)&&u)return;vr(A.relativePath.startsWith(r),`Absolute route path "${A.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),A.relativePath=A.relativePath.slice(r.length)}let g=Io([r,A.relativePath]),N=a.concat(A);o.children&&o.children.length>0&&(vr(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),b1(o.children,s,N,g,u)),!(o.path==null&&!o.index)&&s.push({path:g,score:n6(g,o.index),routesMeta:N})};return t.forEach((o,m)=>{if(o.path===""||!o.path?.includes("?"))c(o,m);else for(let u of y1(o.path))c(o,m,!0,u)}),s}function y1(t){let s=t.split("/");if(s.length===0)return[];let[a,...r]=s,l=a.endsWith("?"),c=a.replace(/\?$/,"");if(r.length===0)return l?[c,""]:[c];let o=y1(r.join("/")),m=[];return m.push(...o.map(u=>u===""?c:[c,u].join("/"))),l&&m.push(...o),m.map(u=>t.startsWith("/")&&u===""?"/":u)}function JC(t){t.sort((s,a)=>s.score!==a.score?a.score-s.score:l6(s.routesMeta.map(r=>r.childrenIndex),a.routesMeta.map(r=>r.childrenIndex)))}var ZC=/^:[\w-]+$/,e6=3,t6=2,s6=1,a6=10,r6=-2,mN=t=>t==="*";function n6(t,s){let a=t.split("/"),r=a.length;return a.some(mN)&&(r+=r6),s&&(r+=t6),a.filter(l=>!mN(l)).reduce((l,c)=>l+(ZC.test(c)?e6:c===""?s6:a6),r)}function l6(t,s){return t.length===s.length&&t.slice(0,-1).every((r,l)=>r===s[l])?t[t.length-1]-s[s.length-1]:0}function i6(t,s,a=!1){let{routesMeta:r}=t,l={},c="/",o=[];for(let m=0;m<r.length;++m){let u=r[m],x=m===r.length-1,A=c==="/"?s:s.slice(c.length)||"/",g=YA({path:u.relativePath,caseSensitive:u.caseSensitive,end:x},A),N=u.route;if(!g&&x&&a&&!r[r.length-1].route.index&&(g=YA({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},A)),!g)return null;Object.assign(l,g.params),o.push({params:l,pathname:Io([c,g.pathname]),pathnameBase:h6(Io([c,g.pathnameBase])),route:N}),g.pathnameBase!=="/"&&(c=Io([c,g.pathnameBase]))}return o}function YA(t,s){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[a,r]=c6(t.path,t.caseSensitive,t.end),l=s.match(a);if(!l)return null;let c=l[0],o=c.replace(/(.)\/+$/,"$1"),m=l.slice(1);return{params:r.reduce((x,{paramName:A,isOptional:g},N)=>{if(A==="*"){let y=m[N]||"";o=c.slice(0,c.length-y.length).replace(/(.)\/+$/,"$1")}const f=m[N];return g&&!f?x[A]=void 0:x[A]=(f||"").replace(/%2F/g,"/"),x},{}),pathname:c,pathnameBase:o,pattern:t}}function c6(t,s=!1,a=!0){oi(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],l="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,m,u)=>(r.push({paramName:m,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),l+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?l+="\\/*$":t!==""&&t!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,s?void 0:"i"),r]}function o6(t){try{return t.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return oi(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${s}).`),t}}function Po(t,s){if(s==="/")return t;if(!t.toLowerCase().startsWith(s.toLowerCase()))return null;let a=s.endsWith("/")?s.length-1:s.length,r=t.charAt(a);return r&&r!=="/"?null:t.slice(a)||"/"}var d6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,m6=t=>d6.test(t);function u6(t,s="/"){let{pathname:a,search:r="",hash:l=""}=typeof t=="string"?ex(t):t,c;if(a)if(m6(a))c=a;else{if(a.includes("//")){let o=a;a=a.replace(/\/\/+/g,"/"),oi(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${a}`)}a.startsWith("/")?c=uN(a.substring(1),"/"):c=uN(a,s)}else c=s;return{pathname:c,search:p6(r),hash:A6(l)}}function uN(t,s){let a=s.replace(/\/+$/,"").split("/");return t.split("/").forEach(l=>{l===".."?a.length>1&&a.pop():l!=="."&&a.push(l)}),a.length>1?a.join("/"):"/"}function ef(t,s,a,r){return`Cannot include a '${t}' character in a manually specified \`to.${s}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${a}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function x6(t){return t.filter((s,a)=>a===0||s.route.path&&s.route.path.length>0)}function sy(t){let s=x6(t);return s.map((a,r)=>r===s.length-1?a.pathname:a.pathnameBase)}function ay(t,s,a,r=!1){let l;typeof t=="string"?l=ex(t):(l={...t},vr(!l.pathname||!l.pathname.includes("?"),ef("?","pathname","search",l)),vr(!l.pathname||!l.pathname.includes("#"),ef("#","pathname","hash",l)),vr(!l.search||!l.search.includes("#"),ef("#","search","hash",l)));let c=t===""||l.pathname==="",o=c?"/":l.pathname,m;if(o==null)m=a;else{let g=s.length-1;if(!r&&o.startsWith("..")){let N=o.split("/");for(;N[0]==="..";)N.shift(),g-=1;l.pathname=N.join("/")}m=g>=0?s[g]:"/"}let u=u6(l,m),x=o&&o!=="/"&&o.endsWith("/"),A=(c||o===".")&&a.endsWith("/");return!u.pathname.endsWith("/")&&(x||A)&&(u.pathname+="/"),u}var Io=t=>t.join("/").replace(/\/\/+/g,"/"),h6=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),p6=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,A6=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function g6(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var j1=["POST","PUT","PATCH","DELETE"];new Set(j1);var f6=["GET",...j1];new Set(f6);var tx=h.createContext(null);tx.displayName="DataRouter";var Ag=h.createContext(null);Ag.displayName="DataRouterState";h.createContext(!1);var v1=h.createContext({isTransitioning:!1});v1.displayName="ViewTransition";var b6=h.createContext(new Map);b6.displayName="Fetchers";var y6=h.createContext(null);y6.displayName="Await";var yc=h.createContext(null);yc.displayName="Navigation";var Dh=h.createContext(null);Dh.displayName="Location";var Mi=h.createContext({outlet:null,matches:[],isDataRoute:!1});Mi.displayName="Route";var ry=h.createContext(null);ry.displayName="RouteError";function j6(t,{relative:s}={}){vr(sx(),"useHref() may be used only in the context of a <Router> component.");let{basename:a,navigator:r}=h.useContext(yc),{hash:l,pathname:c,search:o}=Uh(t,{relative:s}),m=c;return a!=="/"&&(m=c==="/"?a:Io([a,c])),r.createHref({pathname:m,search:o,hash:l})}function sx(){return h.useContext(Dh)!=null}function di(){return vr(sx(),"useLocation() may be used only in the context of a <Router> component."),h.useContext(Dh).location}var N1="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function w1(t){h.useContext(yc).static||h.useLayoutEffect(t)}function la(){let{isDataRoute:t}=h.useContext(Mi);return t?Q6():v6()}function v6(){vr(sx(),"useNavigate() may be used only in the context of a <Router> component.");let t=h.useContext(tx),{basename:s,navigator:a}=h.useContext(yc),{matches:r}=h.useContext(Mi),{pathname:l}=di(),c=JSON.stringify(sy(r)),o=h.useRef(!1);return w1(()=>{o.current=!0}),h.useCallback((u,x={})=>{if(oi(o.current,N1),!o.current)return;if(typeof u=="number"){a.go(u);return}let A=ay(u,JSON.parse(c),l,x.relative==="path");t==null&&s!=="/"&&(A.pathname=A.pathname==="/"?s:Io([s,A.pathname])),(x.replace?a.replace:a.push)(A,x.state,x)},[s,a,c,l,t])}var N6=h.createContext(null);function w6(t){let s=h.useContext(Mi).outlet;return h.useMemo(()=>s&&h.createElement(N6.Provider,{value:t},s),[s,t])}function qd(){let{matches:t}=h.useContext(Mi),s=t[t.length-1];return s?s.params:{}}function Uh(t,{relative:s}={}){let{matches:a}=h.useContext(Mi),{pathname:r}=di(),l=JSON.stringify(sy(a));return h.useMemo(()=>ay(t,JSON.parse(l),r,s==="path"),[t,l,r,s])}function _6(t,s){return _1(t,s)}function _1(t,s,a,r,l){vr(sx(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:c}=h.useContext(yc),{matches:o}=h.useContext(Mi),m=o[o.length-1],u=m?m.params:{},x=m?m.pathname:"/",A=m?m.pathnameBase:"/",g=m&&m.route;{let M=g&&g.path||"";C1(x,!g||M.endsWith("*")||M.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${x}" (under <Route path="${M}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${M}"> to <Route path="${M==="/"?"*":`${M}/*`}">.`)}let N=di(),f;if(s){let M=typeof s=="string"?ex(s):s;vr(A==="/"||M.pathname?.startsWith(A),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${A}" but pathname "${M.pathname}" was given in the \`location\` prop.`),f=M}else f=N;let y=f.pathname||"/",v=y;if(A!=="/"){let M=A.replace(/^\//,"").split("/");v="/"+y.replace(/^\//,"").split("/").slice(M.length).join("/")}let U=f1(t,{pathname:v});oi(g||U!=null,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),oi(U==null||U[U.length-1].route.element!==void 0||U[U.length-1].route.Component!==void 0||U[U.length-1].route.lazy!==void 0,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let D=F6(U&&U.map(M=>Object.assign({},M,{params:Object.assign({},u,M.params),pathname:Io([A,c.encodeLocation?c.encodeLocation(M.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:M.pathname]),pathnameBase:M.pathnameBase==="/"?A:Io([A,c.encodeLocation?c.encodeLocation(M.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:M.pathnameBase])})),o,a,r,l);return s&&D?h.createElement(Dh.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...f},navigationType:"POP"}},D):D}function C6(){let t=L6(),s=g6(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),a=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:r},c={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=h.createElement(h.Fragment,null,h.createElement("p",null," Hey developer "),h.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",h.createElement("code",{style:c},"ErrorBoundary")," or"," ",h.createElement("code",{style:c},"errorElement")," prop on your route.")),h.createElement(h.Fragment,null,h.createElement("h2",null,"Unexpected Application Error!"),h.createElement("h3",{style:{fontStyle:"italic"}},s),a?h.createElement("pre",{style:l},a):null,o)}var S6=h.createElement(C6,null),k6=class extends h.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,s){return s.location!==t.location||s.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:s.error,location:s.location,revalidation:t.revalidation||s.revalidation}}componentDidCatch(t,s){this.props.onError?this.props.onError(t,s):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?h.createElement(Mi.Provider,{value:this.props.routeContext},h.createElement(ry.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function B6({routeContext:t,match:s,children:a}){let r=h.useContext(tx);return r&&r.static&&r.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=s.route.id),h.createElement(Mi.Provider,{value:t},a)}function F6(t,s=[],a=null,r=null,l=null){if(t==null){if(!a)return null;if(a.errors)t=a.matches;else if(s.length===0&&!a.initialized&&a.matches.length>0)t=a.matches;else return null}let c=t,o=a?.errors;if(o!=null){let A=c.findIndex(g=>g.route.id&&o?.[g.route.id]!==void 0);vr(A>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),c=c.slice(0,Math.min(c.length,A+1))}let m=!1,u=-1;if(a)for(let A=0;A<c.length;A++){let g=c[A];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(u=A),g.route.id){let{loaderData:N,errors:f}=a,y=g.route.loader&&!N.hasOwnProperty(g.route.id)&&(!f||f[g.route.id]===void 0);if(g.route.lazy||y){m=!0,u>=0?c=c.slice(0,u+1):c=[c[0]];break}}}let x=a&&r?(A,g)=>{r(A,{location:a.location,params:a.matches?.[0]?.params??{},errorInfo:g})}:void 0;return c.reduceRight((A,g,N)=>{let f,y=!1,v=null,U=null;a&&(f=o&&g.route.id?o[g.route.id]:void 0,v=g.route.errorElement||S6,m&&(u<0&&N===0?(C1("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,U=null):u===N&&(y=!0,U=g.route.hydrateFallbackElement||null)));let D=s.concat(c.slice(0,N+1)),M=()=>{let K;return f?K=v:y?K=U:g.route.Component?K=h.createElement(g.route.Component,null):g.route.element?K=g.route.element:K=A,h.createElement(B6,{match:g,routeContext:{outlet:A,matches:D,isDataRoute:a!=null},children:K})};return a&&(g.route.ErrorBoundary||g.route.errorElement||N===0)?h.createElement(k6,{location:a.location,revalidation:a.revalidation,component:v,error:f,children:M(),routeContext:{outlet:null,matches:D,isDataRoute:!0},onError:x}):M()},null)}function ny(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function E6(t){let s=h.useContext(tx);return vr(s,ny(t)),s}function D6(t){let s=h.useContext(Ag);return vr(s,ny(t)),s}function U6(t){let s=h.useContext(Mi);return vr(s,ny(t)),s}function ly(t){let s=U6(t),a=s.matches[s.matches.length-1];return vr(a.route.id,`${t} can only be used on routes that contain a unique "id"`),a.route.id}function T6(){return ly("useRouteId")}function L6(){let t=h.useContext(ry),s=D6("useRouteError"),a=ly("useRouteError");return t!==void 0?t:s.errors?.[a]}function Q6(){let{router:t}=E6("useNavigate"),s=ly("useNavigate"),a=h.useRef(!1);return w1(()=>{a.current=!0}),h.useCallback(async(l,c={})=>{oi(a.current,N1),a.current&&(typeof l=="number"?t.navigate(l):await t.navigate(l,{fromRouteId:s,...c}))},[t,s])}var xN={};function C1(t,s,a){!s&&!xN[t]&&(xN[t]=!0,oi(!1,a))}h.memo(R6);function R6({routes:t,future:s,state:a,unstable_onError:r}){return _1(t,void 0,a,r,s)}function pc({to:t,replace:s,state:a,relative:r}){vr(sx(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=h.useContext(yc);oi(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:c}=h.useContext(Mi),{pathname:o}=di(),m=la(),u=ay(t,sy(c),o,r==="path"),x=JSON.stringify(u);return h.useEffect(()=>{m(JSON.parse(x),{replace:s,state:a,relative:r})},[m,x,r,s,a]),null}function M6(t){return w6(t.context)}function Ut(t){vr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function I6({basename:t="/",children:s=null,location:a,navigationType:r="POP",navigator:l,static:c=!1}){vr(!sx(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),m=h.useMemo(()=>({basename:o,navigator:l,static:c,future:{}}),[o,l,c]);typeof a=="string"&&(a=ex(a));let{pathname:u="/",search:x="",hash:A="",state:g=null,key:N="default"}=a,f=h.useMemo(()=>{let y=Po(u,o);return y==null?null:{location:{pathname:y,search:x,hash:A,state:g,key:N},navigationType:r}},[o,u,x,A,g,N,r]);return oi(f!=null,`<Router basename="${o}"> is not able to match the URL "${u}${x}${A}" because it does not start with the basename, so the <Router> won't render anything.`),f==null?null:h.createElement(yc.Provider,{value:m},h.createElement(Dh.Provider,{children:s,value:f}))}function $6({children:t,location:s}){return _6(ab(t),s)}function ab(t,s=[]){let a=[];return h.Children.forEach(t,(r,l)=>{if(!h.isValidElement(r))return;let c=[...s,l];if(r.type===h.Fragment){a.push.apply(a,ab(r.props.children,c));return}vr(r.type===Ut,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),vr(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||c.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=ab(r.props.children,c)),a.push(o)}),a}var FA="get",EA="application/x-www-form-urlencoded";function gg(t){return t!=null&&typeof t.tagName=="string"}function H6(t){return gg(t)&&t.tagName.toLowerCase()==="button"}function P6(t){return gg(t)&&t.tagName.toLowerCase()==="form"}function O6(t){return gg(t)&&t.tagName.toLowerCase()==="input"}function z6(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function G6(t,s){return t.button===0&&(!s||s==="_self")&&!z6(t)}function rb(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((s,a)=>{let r=t[a];return s.concat(Array.isArray(r)?r.map(l=>[a,l]):[[a,r]])},[]))}function q6(t,s){let a=rb(t);return s&&s.forEach((r,l)=>{a.has(l)||s.getAll(l).forEach(c=>{a.append(l,c)})}),a}var Ip=null;function K6(){if(Ip===null)try{new FormData(document.createElement("form"),0),Ip=!1}catch{Ip=!0}return Ip}var V6=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function tf(t){return t!=null&&!V6.has(t)?(oi(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${EA}"`),null):t}function Y6(t,s){let a,r,l,c,o;if(P6(t)){let m=t.getAttribute("action");r=m?Po(m,s):null,a=t.getAttribute("method")||FA,l=tf(t.getAttribute("enctype"))||EA,c=new FormData(t)}else if(H6(t)||O6(t)&&(t.type==="submit"||t.type==="image")){let m=t.form;if(m==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=t.getAttribute("formaction")||m.getAttribute("action");if(r=u?Po(u,s):null,a=t.getAttribute("formmethod")||m.getAttribute("method")||FA,l=tf(t.getAttribute("formenctype"))||tf(m.getAttribute("enctype"))||EA,c=new FormData(m,t),!K6()){let{name:x,type:A,value:g}=t;if(A==="image"){let N=x?`${x}.`:"";c.append(`${N}x`,"0"),c.append(`${N}y`,"0")}else x&&c.append(x,g)}}else{if(gg(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');a=FA,r=null,l=EA,o=t}return c&&l==="text/plain"&&(o=c,c=void 0),{action:r,method:a.toLowerCase(),encType:l,formData:c,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function iy(t,s){if(t===!1||t===null||typeof t>"u")throw new Error(s)}function W6(t,s,a){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname=`_root.${a}`:s&&Po(r.pathname,s)==="/"?r.pathname=`${s.replace(/\/$/,"")}/_root.${a}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${a}`,r}async function X6(t,s){if(t.id in s)return s[t.id];try{let a=await import(t.module);return s[t.id]=a,a}catch(a){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(a),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function J6(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function Z6(t,s,a){let r=await Promise.all(t.map(async l=>{let c=s.routes[l.route.id];if(c){let o=await X6(c,a);return o.links?o.links():[]}return[]}));return a3(r.flat(1).filter(J6).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function hN(t,s,a,r,l,c){let o=(u,x)=>a[x]?u.route.id!==a[x].route.id:!0,m=(u,x)=>a[x].pathname!==u.pathname||a[x].route.path?.endsWith("*")&&a[x].params["*"]!==u.params["*"];return c==="assets"?s.filter((u,x)=>o(u,x)||m(u,x)):c==="data"?s.filter((u,x)=>{let A=r.routes[u.route.id];if(!A||!A.hasLoader)return!1;if(o(u,x)||m(u,x))return!0;if(u.route.shouldRevalidate){let g=u.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:a[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function e3(t,s,{includeHydrateFallback:a}={}){return t3(t.map(r=>{let l=s.routes[r.route.id];if(!l)return[];let c=[l.module];return l.clientActionModule&&(c=c.concat(l.clientActionModule)),l.clientLoaderModule&&(c=c.concat(l.clientLoaderModule)),a&&l.hydrateFallbackModule&&(c=c.concat(l.hydrateFallbackModule)),l.imports&&(c=c.concat(l.imports)),c}).flat(1))}function t3(t){return[...new Set(t)]}function s3(t){let s={},a=Object.keys(t).sort();for(let r of a)s[r]=t[r];return s}function a3(t,s){let a=new Set;return new Set(s),t.reduce((r,l)=>{let c=JSON.stringify(s3(l));return a.has(c)||(a.add(c),r.push({key:c,link:l})),r},[])}function S1(){let t=h.useContext(tx);return iy(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function r3(){let t=h.useContext(Ag);return iy(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var cy=h.createContext(void 0);cy.displayName="FrameworkContext";function k1(){let t=h.useContext(cy);return iy(t,"You must render this element inside a <HydratedRouter> element"),t}function n3(t,s){let a=h.useContext(cy),[r,l]=h.useState(!1),[c,o]=h.useState(!1),{onFocus:m,onBlur:u,onMouseEnter:x,onMouseLeave:A,onTouchStart:g}=s,N=h.useRef(null);h.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let v=D=>{D.forEach(M=>{o(M.isIntersecting)})},U=new IntersectionObserver(v,{threshold:.5});return N.current&&U.observe(N.current),()=>{U.disconnect()}}},[t]),h.useEffect(()=>{if(r){let v=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(v)}}},[r]);let f=()=>{l(!0)},y=()=>{l(!1),o(!1)};return a?t!=="intent"?[c,N,{}]:[c,N,{onFocus:Gx(m,f),onBlur:Gx(u,y),onMouseEnter:Gx(x,f),onMouseLeave:Gx(A,y),onTouchStart:Gx(g,f)}]:[!1,N,{}]}function Gx(t,s){return a=>{t&&t(a),a.defaultPrevented||s(a)}}function l3({page:t,...s}){let{router:a}=S1(),r=h.useMemo(()=>f1(a.routes,t,a.basename),[a.routes,t,a.basename]);return r?h.createElement(c3,{page:t,matches:r,...s}):null}function i3(t){let{manifest:s,routeModules:a}=k1(),[r,l]=h.useState([]);return h.useEffect(()=>{let c=!1;return Z6(t,s,a).then(o=>{c||l(o)}),()=>{c=!0}},[t,s,a]),r}function c3({page:t,matches:s,...a}){let r=di(),{manifest:l,routeModules:c}=k1(),{basename:o}=S1(),{loaderData:m,matches:u}=r3(),x=h.useMemo(()=>hN(t,s,u,l,r,"data"),[t,s,u,l,r]),A=h.useMemo(()=>hN(t,s,u,l,r,"assets"),[t,s,u,l,r]),g=h.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let y=new Set,v=!1;if(s.forEach(D=>{let M=l.routes[D.route.id];!M||!M.hasLoader||(!x.some(K=>K.route.id===D.route.id)&&D.route.id in m&&c[D.route.id]?.shouldRevalidate||M.hasClientLoader?v=!0:y.add(D.route.id))}),y.size===0)return[];let U=W6(t,o,"data");return v&&y.size>0&&U.searchParams.set("_routes",s.filter(D=>y.has(D.route.id)).map(D=>D.route.id).join(",")),[U.pathname+U.search]},[o,m,r,l,x,s,t,c]),N=h.useMemo(()=>e3(A,l),[A,l]),f=i3(A);return h.createElement(h.Fragment,null,g.map(y=>h.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...a})),N.map(y=>h.createElement("link",{key:y,rel:"modulepreload",href:y,...a})),f.map(({key:y,link:v})=>h.createElement("link",{key:y,nonce:a.nonce,...v})))}function o3(...t){return s=>{t.forEach(a=>{typeof a=="function"?a(s):a!=null&&(a.current=s)})}}var B1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{B1&&(window.__reactRouterVersion="7.9.6")}catch{}function d3({basename:t,children:s,window:a}){let r=h.useRef();r.current==null&&(r.current=KC({window:a,v5Compat:!0}));let l=r.current,[c,o]=h.useState({action:l.action,location:l.location}),m=h.useCallback(u=>{h.startTransition(()=>o(u))},[o]);return h.useLayoutEffect(()=>l.listen(m),[l,m]),h.createElement(I6,{basename:t,children:s,location:c.location,navigationType:c.action,navigator:l})}var F1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,dn=h.forwardRef(function({onClick:s,discover:a="render",prefetch:r="none",relative:l,reloadDocument:c,replace:o,state:m,target:u,to:x,preventScrollReset:A,viewTransition:g,...N},f){let{basename:y}=h.useContext(yc),v=typeof x=="string"&&F1.test(x),U,D=!1;if(typeof x=="string"&&v&&(U=x,B1))try{let j=new URL(window.location.href),T=x.startsWith("//")?new URL(j.protocol+x):new URL(x),Q=Po(T.pathname,y);T.origin===j.origin&&Q!=null?x=Q+T.search+T.hash:D=!0}catch{oi(!1,`<Link to="${x}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let M=j6(x,{relative:l}),[K,$,P]=n3(r,N),se=h3(x,{replace:o,state:m,target:u,preventScrollReset:A,relative:l,viewTransition:g});function z(j){s&&s(j),j.defaultPrevented||se(j)}let R=h.createElement("a",{...N,...P,href:U||M,onClick:D||c?s:z,ref:o3(f,$),target:u,"data-discover":!v&&a==="render"?"true":void 0});return K&&!v?h.createElement(h.Fragment,null,R,h.createElement(l3,{page:M})):R});dn.displayName="Link";var m3=h.forwardRef(function({"aria-current":s="page",caseSensitive:a=!1,className:r="",end:l=!1,style:c,to:o,viewTransition:m,children:u,...x},A){let g=Uh(o,{relative:x.relative}),N=di(),f=h.useContext(Ag),{navigator:y,basename:v}=h.useContext(yc),U=f!=null&&b3(g)&&m===!0,D=y.encodeLocation?y.encodeLocation(g).pathname:g.pathname,M=N.pathname,K=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;a||(M=M.toLowerCase(),K=K?K.toLowerCase():null,D=D.toLowerCase()),K&&v&&(K=Po(K,v)||K);const $=D!=="/"&&D.endsWith("/")?D.length-1:D.length;let P=M===D||!l&&M.startsWith(D)&&M.charAt($)==="/",se=K!=null&&(K===D||!l&&K.startsWith(D)&&K.charAt(D.length)==="/"),z={isActive:P,isPending:se,isTransitioning:U},R=P?s:void 0,j;typeof r=="function"?j=r(z):j=[r,P?"active":null,se?"pending":null,U?"transitioning":null].filter(Boolean).join(" ");let T=typeof c=="function"?c(z):c;return h.createElement(dn,{...x,"aria-current":R,className:j,ref:A,style:T,to:o,viewTransition:m},typeof u=="function"?u(z):u)});m3.displayName="NavLink";var u3=h.forwardRef(({discover:t="render",fetcherKey:s,navigate:a,reloadDocument:r,replace:l,state:c,method:o=FA,action:m,onSubmit:u,relative:x,preventScrollReset:A,viewTransition:g,...N},f)=>{let y=g3(),v=f3(m,{relative:x}),U=o.toLowerCase()==="get"?"get":"post",D=typeof m=="string"&&F1.test(m),M=K=>{if(u&&u(K),K.defaultPrevented)return;K.preventDefault();let $=K.nativeEvent.submitter,P=$?.getAttribute("formmethod")||o;y($||K.currentTarget,{fetcherKey:s,method:P,navigate:a,replace:l,state:c,relative:x,preventScrollReset:A,viewTransition:g})};return h.createElement("form",{ref:f,method:U,action:v,onSubmit:r?u:M,...N,"data-discover":!D&&t==="render"?"true":void 0})});u3.displayName="Form";function x3(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function E1(t){let s=h.useContext(tx);return vr(s,x3(t)),s}function h3(t,{target:s,replace:a,state:r,preventScrollReset:l,relative:c,viewTransition:o}={}){let m=la(),u=di(),x=Uh(t,{relative:c});return h.useCallback(A=>{if(G6(A,s)){A.preventDefault();let g=a!==void 0?a:yh(u)===yh(x);m(t,{replace:g,state:r,preventScrollReset:l,relative:c,viewTransition:o})}},[u,m,x,a,r,s,t,l,c,o])}function ax(t){oi(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let s=h.useRef(rb(t)),a=h.useRef(!1),r=di(),l=h.useMemo(()=>q6(r.search,a.current?null:s.current),[r.search]),c=la(),o=h.useCallback((m,u)=>{const x=rb(typeof m=="function"?m(new URLSearchParams(l)):m);a.current=!0,c("?"+x,u)},[c,l]);return[l,o]}var p3=0,A3=()=>`__${String(++p3)}__`;function g3(){let{router:t}=E1("useSubmit"),{basename:s}=h.useContext(yc),a=T6();return h.useCallback(async(r,l={})=>{let{action:c,method:o,encType:m,formData:u,body:x}=Y6(r,s);if(l.navigate===!1){let A=l.fetcherKey||A3();await t.fetch(A,a,l.action||c,{preventScrollReset:l.preventScrollReset,formData:u,body:x,formMethod:l.method||o,formEncType:l.encType||m,flushSync:l.flushSync})}else await t.navigate(l.action||c,{preventScrollReset:l.preventScrollReset,formData:u,body:x,formMethod:l.method||o,formEncType:l.encType||m,replace:l.replace,state:l.state,fromRouteId:a,flushSync:l.flushSync,viewTransition:l.viewTransition})},[t,s,a])}function f3(t,{relative:s}={}){let{basename:a}=h.useContext(yc),r=h.useContext(Mi);vr(r,"useFormAction must be used inside a RouteContext");let[l]=r.matches.slice(-1),c={...Uh(t||".",{relative:s})},o=di();if(t==null){c.search=o.search;let m=new URLSearchParams(c.search),u=m.getAll("index");if(u.some(A=>A==="")){m.delete("index"),u.filter(g=>g).forEach(g=>m.append("index",g));let A=m.toString();c.search=A?`?${A}`:""}}return(!t||t===".")&&l.route.index&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),a!=="/"&&(c.pathname=c.pathname==="/"?a:Io([a,c.pathname])),yh(c)}function b3(t,{relative:s}={}){let a=h.useContext(v1);vr(a!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=E1("useViewTransitionState"),l=Uh(t,{relative:s});if(!a.isTransitioning)return!1;let c=Po(a.currentLocation.pathname,r)||a.currentLocation.pathname,o=Po(a.nextLocation.pathname,r)||a.nextLocation.pathname;return YA(l.pathname,o)!=null||YA(l.pathname,c)!=null}const pN=t=>{let s;const a=new Set,r=(x,A)=>{const g=typeof x=="function"?x(s):x;if(!Object.is(g,s)){const N=s;s=A??(typeof g!="object"||g===null)?g:Object.assign({},s,g),a.forEach(f=>f(s,N))}},l=()=>s,m={setState:r,getState:l,getInitialState:()=>u,subscribe:x=>(a.add(x),()=>a.delete(x))},u=s=t(r,l,m);return m},y3=(t=>t?pN(t):pN),j3=t=>t;function v3(t,s=j3){const a=Mp.useSyncExternalStore(t.subscribe,Mp.useCallback(()=>s(t.getState()),[t,s]),Mp.useCallback(()=>s(t.getInitialState()),[t,s]));return Mp.useDebugValue(a),a}const AN=t=>{const s=y3(t),a=r=>v3(s,r);return Object.assign(a,s),a},Th=(t=>t?AN(t):AN),N3=()=>{try{const t=localStorage.getItem("user");return t?JSON.parse(t):null}catch{return null}},Us=Th(t=>({user:N3(),token:localStorage.getItem("token")||null,isAuthenticated:!!localStorage.getItem("token"),login:(s,a)=>{localStorage.setItem("user",JSON.stringify(s)),localStorage.setItem("token",a),t({user:s,token:a,isAuthenticated:!0})},logout:()=>{localStorage.removeItem("user"),localStorage.removeItem("token"),t({user:null,token:null,isAuthenticated:!1})},updateUser:s=>{localStorage.setItem("user",JSON.stringify(s)),t({user:s})}}));function w3(t,s){let a;try{a=t()}catch{return}return{getItem:l=>{var c;const o=u=>u===null?null:JSON.parse(u,void 0),m=(c=a.getItem(l))!=null?c:null;return m instanceof Promise?m.then(o):o(m)},setItem:(l,c)=>a.setItem(l,JSON.stringify(c,void 0)),removeItem:l=>a.removeItem(l)}}const nb=t=>s=>{try{const a=t(s);return a instanceof Promise?a:{then(r){return nb(r)(a)},catch(r){return this}}}catch(a){return{then(r){return this},catch(r){return nb(r)(a)}}}},_3=(t,s)=>(a,r,l)=>{let c={storage:w3(()=>localStorage),partialize:v=>v,version:0,merge:(v,U)=>({...U,...v}),...s},o=!1;const m=new Set,u=new Set;let x=c.storage;if(!x)return t((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${c.name}', the given storage is currently unavailable.`),a(...v)},r,l);const A=()=>{const v=c.partialize({...r()});return x.setItem(c.name,{state:v,version:c.version})},g=l.setState;l.setState=(v,U)=>(g(v,U),A());const N=t((...v)=>(a(...v),A()),r,l);l.getInitialState=()=>N;let f;const y=()=>{var v,U;if(!x)return;o=!1,m.forEach(M=>{var K;return M((K=r())!=null?K:N)});const D=((U=c.onRehydrateStorage)==null?void 0:U.call(c,(v=r())!=null?v:N))||void 0;return nb(x.getItem.bind(x))(c.name).then(M=>{if(M)if(typeof M.version=="number"&&M.version!==c.version){if(c.migrate){const K=c.migrate(M.state,M.version);return K instanceof Promise?K.then($=>[!0,$]):[!0,K]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,M.state];return[!1,void 0]}).then(M=>{var K;const[$,P]=M;if(f=c.merge(P,(K=r())!=null?K:N),a(f,!0),$)return A()}).then(()=>{D?.(f,void 0),f=r(),o=!0,u.forEach(M=>M(f))}).catch(M=>{D?.(void 0,M)})};return l.persist={setOptions:v=>{c={...c,...v},v.storage&&(x=v.storage)},clearStorage:()=>{x?.removeItem(c.name)},getOptions:()=>c,rehydrate:()=>y(),hasHydrated:()=>o,onHydrate:v=>(m.add(v),()=>{m.delete(v)}),onFinishHydration:v=>(u.add(v),()=>{u.delete(v)})},c.skipHydration||y(),f||N},oy=_3,dy=Th(oy((t,s)=>({theme:"light",actualTheme:"light",dashboardWidgets:[{id:"stats",name:"Quick Stats",enabled:!0,order:0},{id:"calendar",name:"Calendar",enabled:!0,order:1},{id:"notifications",name:"Notifications",enabled:!0,order:2},{id:"attendance",name:"Attendance Chart",enabled:!0,order:3},{id:"finance",name:"Finance Overview",enabled:!0,order:4},{id:"recent",name:"Recent Activity",enabled:!0,order:5},{id:"quickActions",name:"Quick Actions",enabled:!0,order:6},{id:"weather",name:"Weather",enabled:!1,order:7}],sidebarCollapsed:!1,fontSize:"normal",reducedMotion:!1,highContrast:!1,setTheme:a=>{t({theme:a}),s().applyTheme()},applyTheme:()=>{const{theme:a}=s();let r=a;a==="system"&&(r=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),t({actualTheme:r}),r==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark");const l=document.querySelector('meta[name="theme-color"]');l&&l.setAttribute("content",r==="dark"?"#1f2937":"#1e40af")},toggleSidebar:()=>t(a=>({sidebarCollapsed:!a.sidebarCollapsed})),updateWidget:(a,r)=>{t(l=>({dashboardWidgets:l.dashboardWidgets.map(c=>c.id===a?{...c,...r}:c)}))},reorderWidgets:a=>t({dashboardWidgets:a}),setFontSize:a=>{t({fontSize:a}),document.documentElement.style.fontSize=a==="small"?"14px":a==="large"?"18px":"16px"},setReducedMotion:a=>{t({reducedMotion:a}),a?document.documentElement.classList.add("reduce-motion"):document.documentElement.classList.remove("reduce-motion")},setHighContrast:a=>{t({highContrast:a}),a?document.documentElement.classList.add("high-contrast"):document.documentElement.classList.remove("high-contrast")}}),{name:"mcsms-theme"}));typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{const t=dy.getState();t.theme==="system"&&t.applyTheme()});const C3=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),S3=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(s,a,r)=>r?r.toUpperCase():a.toLowerCase()),gN=t=>{const s=S3(t);return s.charAt(0).toUpperCase()+s.slice(1)},D1=(...t)=>t.filter((s,a,r)=>!!s&&s.trim()!==""&&r.indexOf(s)===a).join(" ").trim(),k3=t=>{for(const s in t)if(s.startsWith("aria-")||s==="role"||s==="title")return!0};var B3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const F3=h.forwardRef(({color:t="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:r,className:l="",children:c,iconNode:o,...m},u)=>h.createElement("svg",{ref:u,...B3,width:s,height:s,stroke:t,strokeWidth:r?Number(a)*24/Number(s):a,className:D1("lucide",l),...!c&&!k3(m)&&{"aria-hidden":"true"},...m},[...o.map(([x,A])=>h.createElement(x,A)),...Array.isArray(c)?c:[c]]));const xt=(t,s)=>{const a=h.forwardRef(({className:r,...l},c)=>h.createElement(F3,{ref:c,iconNode:s,className:D1(`lucide-${C3(gN(t))}`,`lucide-${t}`,r),...l}));return a.displayName=gN(t),a};const E3=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Ir=xt("activity",E3);const D3=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],my=xt("archive",D3);const U3=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],U1=xt("arrow-down-right",U3);const T3=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],uy=xt("arrow-down",T3);const L3=[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]],Q3=xt("arrow-left-right",L3);const R3=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ol=xt("arrow-left",R3);const M3=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],fN=xt("arrow-right-left",M3);const I3=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Pl=xt("arrow-right",I3);const $3=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],Li=xt("arrow-up-right",$3);const H3=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],xy=xt("arrow-up",H3);const P3=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],Is=xt("award",P3);const O3=[["path",{d:"M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5",key:"1u7htd"}],["path",{d:"M15 12h.01",key:"1k8ypt"}],["path",{d:"M19.38 6.813A9 9 0 0 1 20.8 10.2a2 2 0 0 1 0 3.6 9 9 0 0 1-17.6 0 2 2 0 0 1 0-3.6A9 9 0 0 1 12 3c2 0 3.5 1.1 3.5 2.5s-.9 2.5-2 2.5c-.8 0-1.5-.4-1.5-1",key:"11xh7x"}],["path",{d:"M9 12h.01",key:"157uk2"}]],T1=xt("baby",O3);const z3=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],nl=xt("bell",z3);const G3=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],q3=xt("bold",G3);const K3=[["path",{d:"M10 2v8l3-3 3 3V2",key:"sqw3rj"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],V3=xt("book-marked",K3);const Y3=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],as=xt("book-open",Y3);const W3=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],sf=xt("bot",W3);const X3=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],Jr=xt("brain",X3);const J3=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],Pr=xt("briefcase",J3);const Z3=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],eS=xt("building-2",Z3);const tS=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],mn=xt("building",tS);const sS=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],lb=xt("calculator",sS);const aS=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],jh=xt("calendar-days",aS);const rS=[["path",{d:"M16 19h6",key:"xwg31i"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M19 16v6",key:"tddt3s"}],["path",{d:"M21 12.598V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8.5",key:"1glfrc"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}]],nS=xt("calendar-plus",rS);const lS=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Ot=xt("calendar",lS);const iS=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Ld=xt("camera",iS);const cS=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Fs=xt("chart-column",cS);const oS=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]],L1=xt("chart-line",oS);const dS=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]],mS=xt("chart-no-axes-column",dS);const uS=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],Gl=xt("chart-pie",uS);const xS=[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]],Q1=xt("check-check",xS);const hS=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Tn=xt("check",hS);const pS=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],un=xt("chevron-down",pS);const AS=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],cr=xt("chevron-right",AS);const gS=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Kd=xt("chevron-left",gS);const fS=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],jl=xt("chevron-up",fS);const bS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ka=xt("circle-alert",bS);const yS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]],jS=xt("circle-arrow-down",yS);const vS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],NS=xt("circle-arrow-up",vS);const wS=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Mt=xt("circle-check-big",wS);const _S=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],DA=xt("circle-check",_S);const CS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Ac=xt("circle-question-mark",CS);const SS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Js=xt("circle-x",SS);const kS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],BS=xt("circle",kS);const FS=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],Wc=xt("clipboard-check",FS);const ES=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],Di=xt("clipboard-list",ES);const DS=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Wt=xt("clock",DS);const US=[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]],_u=xt("command",US);const TS=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],vl=xt("copy",TS);const LS=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],aa=xt("credit-card",LS);const QS=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],bN=xt("crown",QS);const RS=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],Pu=xt("database",RS);const MS=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],vs=xt("dollar-sign",MS);const IS=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],xs=xt("download",IS);const $S=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],vh=xt("external-link",$S);const HS=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],ib=xt("eye-off",HS);const PS=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],na=xt("eye",PS);const OS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],R1=xt("file-check",OS);const zS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],qo=xt("file-spreadsheet",zS);const GS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Kt=xt("file-text",GS);const qS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]],Iu=xt("file",qS);const KS=[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]],Dd=xt("fingerprint-pattern",KS);const VS=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],yN=xt("folder-open",VS);const YS=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],jN=xt("folder",YS);const WS=[["path",{d:"m15 17 5-5-5-5",key:"nf172w"}],["path",{d:"M4 18v-2a4 4 0 0 1 4-4h12",key:"jmiej9"}]],XS=xt("forward",WS);const JS=[["path",{d:"M14 13h2a2 2 0 0 1 2 2v2a2 2 0 0 0 4 0v-6.998a2 2 0 0 0-.59-1.42L18 5",key:"1wtuz0"}],["path",{d:"M14 21V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v16",key:"e09ifn"}],["path",{d:"M2 21h13",key:"1x0fut"}],["path",{d:"M3 9h11",key:"1p7c0w"}]],vN=xt("fuel",JS);const ZS=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Ko=xt("funnel",ZS);const ek=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["path",{d:"M11 18H8a2 2 0 0 1-2-2V9",key:"19pyzm"}]],tk=xt("git-compare",ek);const sk=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Ou=xt("globe",sk);const ak=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],Qs=xt("graduation-cap",ak);const rk=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],cb=xt("grid-3x3",rk);const nk=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],lk=xt("grip-vertical",nk);const ik=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],ck=xt("hard-drive",ik);const ok=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],Oo=xt("heart",ok);const dk=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Sa=xt("history",dk);const mk=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],Lh=xt("house",mk);const uk=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],hy=xt("image",uk);const xk=[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]],hk=xt("inbox",xk);const pk=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],fc=xt("info",pk);const Ak=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],gk=xt("italic",Ak);const fk=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],py=xt("key",fk);const bk=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Vc=xt("layers",bk);const yk=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],Nm=xt("layout-dashboard",yk);const jk=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],Sm=xt("lightbulb",jk);const vk=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],Qh=xt("link-2",vk);const Nk=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Hd=xt("link",Nk);const wk=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],Ay=xt("list",wk);const _k=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],hs=xt("loader-circle",_k);const Ck=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Ui=xt("lock",Ck);const Sk=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],M1=xt("log-out",Sk);const kk=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],ra=xt("mail",kk);const Bk=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Qn=xt("map-pin",Bk);const Fk=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],Ek=xt("maximize-2",Fk);const Dk=[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]],Uk=xt("medal",Dk);const Tk=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],zu=xt("message-circle",Tk);const Lk=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],wa=xt("message-square",Lk);const Qk=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M16.95 16.95A7 7 0 0 1 5 12v-2",key:"cqa7eg"}],["path",{d:"M18.89 13.23A7 7 0 0 0 19 12v-2",key:"16hl24"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}]],I1=xt("mic-off",Qk);const Rk=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],Nh=xt("mic",Rk);const Mk=[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]],Ik=xt("minimize-2",Mk);const $k=[["path",{d:"M5 12h14",key:"1ays0h"}]],WA=xt("minus",$k);const Hk=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],km=xt("monitor",Hk);const Pk=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],ob=xt("moon",Pk);const Ok=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],NN=xt("navigation",Ok);const zk=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],Gk=xt("palette",zk);const qk=[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"hbicv8"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11c-.11.7-.72 1.22-1.43 1.22H17",key:"1i94pl"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98C9.52 4.9 9 5.52 9 6.23V7",key:"1cofks"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]],Kk=xt("party-popper",qk);const Vk=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],fg=xt("pause",Vk);const Yk=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],Wk=xt("pen-tool",Yk);const Xk=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],ll=xt("pen",Xk);const Jk=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],gy=xt("percent",Jk);const Zk=[["path",{d:"M10.1 13.9a14 14 0 0 0 3.732 2.668 1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2 18 18 0 0 1-12.728-5.272",key:"1wngk7"}],["path",{d:"M22 2 2 22",key:"y4kqgn"}],["path",{d:"M4.76 13.582A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 .244.473",key:"10hv5p"}]],eB=xt("phone-off",Zk);const tB=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],er=xt("phone",tB);const sB=[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]],wN=xt("plane",sB);const aB=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Qi=xt("play",aB);const rB=[["path",{d:"M12 22v-5",key:"1ega77"}],["path",{d:"M9 8V2",key:"14iosj"}],["path",{d:"M15 8V2",key:"18g5xt"}],["path",{d:"M18 8v5a4 4 0 0 1-4 4h-4a4 4 0 0 1-4-4V8Z",key:"osxo6l"}]],fy=xt("plug",rB);const nB=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],qt=xt("plus",nB);const lB=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],or=xt("printer",lB);const iB=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]],cB=xt("qr-code",iB);const oB=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]],mh=xt("receipt",oB);const dB=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Ns=xt("refresh-cw",dB);const mB=[["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}],["path",{d:"m9 17-5-5 5-5",key:"nvlc11"}]],uB=xt("reply",mB);const xB=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],wh=xt("rocket",xB);const hB=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],_h=xt("rotate-ccw",hB);const pB=[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]],_N=xt("route",pB);const AB=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Br=xt("save",AB);const gB=[["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M18 5v16",key:"1ethyx"}],["path",{d:"m4 6 7.106-3.79a2 2 0 0 1 1.788 0L20 6",key:"zywc2d"}],["path",{d:"m6 11-3.52 2.147a1 1 0 0 0-.48.854V19a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a1 1 0 0 0-.48-.853L18 11",key:"1d4ql0"}],["path",{d:"M6 5v16",key:"1sn0nx"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],il=xt("school",gB);const fB=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Ws=xt("search",fB);const bB=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],va=xt("send",bB);const yB=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],jB=xt("server",yB);const vB=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ka=xt("settings",vB);const NB=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],$o=xt("share-2",NB);const wB=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m14.5 9.5-5 5",key:"17q4r4"}],["path",{d:"m9.5 9.5 5 5",key:"18nt4w"}]],_B=xt("shield-x",wB);const CB=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],$r=xt("shield",CB);const SB=[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]],kB=xt("shuffle",SB);const BB=[["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M12 21v-9",key:"17s77i"}],["path",{d:"M12 8V3",key:"13r4qs"}],["path",{d:"M17 16h4",key:"h1uq16"}],["path",{d:"M19 12V3",key:"o1uvq1"}],["path",{d:"M19 21v-5",key:"qua636"}],["path",{d:"M3 14h4",key:"bcjad9"}],["path",{d:"M5 10V3",key:"cb8scm"}],["path",{d:"M5 21v-7",key:"1w1uti"}]],$1=xt("sliders-vertical",BB);const FB=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],H1=xt("smartphone",FB);const EB=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],cl=xt("sparkles",EB);const DB=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],XA=xt("square-check-big",DB);const UB=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Na=xt("square-pen",UB);const TB=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],db=xt("square",TB);const LB=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],sl=xt("star",LB);const QB=[["path",{d:"M21 9a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 15 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2z",key:"1dfntj"}],["path",{d:"M15 3v5a1 1 0 0 0 1 1h5",key:"6s6qgf"}]],P1=xt("sticky-note",QB);const RB=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],mb=xt("sun",RB);const MB=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],IB=xt("table",MB);const $B=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],HB=xt("tag",$B);const PB=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Ln=xt("target",PB);const OB=[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]],$p=xt("test-tube",OB);const zB=[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]],UA=xt("thumbs-down",zB);const GB=[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]],TA=xt("thumbs-up",GB);const qB=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],CN=xt("timer",qB);const KB=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],us=xt("trash-2",KB);const VB=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],gc=xt("trending-down",VB);const YB=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],$s=xt("trending-up",YB);const WB=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],_s=xt("triangle-alert",WB);const XB=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],JA=xt("trophy",XB);const JB=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],Qo=xt("truck",JB);const ZB=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Hr=xt("upload",ZB);const eF=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Or=xt("user-check",eF);const tF=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Ti=xt("user-plus",tF);const sF=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],Rh=xt("user-x",sF);const aF=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ha=xt("user",aF);const rF=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Rt=xt("users",rF);const nF=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],al=xt("video",nF);const lF=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],iF=xt("volume-2",lF);const cF=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],oF=xt("volume-x",cF);const dF=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],Xc=xt("wallet",dF);const mF=[["path",{d:"M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2",key:"q3hayz"}],["path",{d:"m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06",key:"1go1hn"}],["path",{d:"m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8",key:"qlwsc0"}]],uF=xt("webhook",mF);const xF=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],hF=xt("wifi",xF);const pF=[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]],AF=xt("workflow",pF);const gF=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]],ub=xt("wrench",gF);const fF=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Nt=xt("x",fF);const bF=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Xu=xt("zap",bF),ee="https://eea.mcaforo.com/backend/api",xb="https://eea.mcaforo.com";function O1(t,s){return function(){return t.apply(s,arguments)}}const{toString:yF}=Object.prototype,{getPrototypeOf:by}=Object,{iterator:bg,toStringTag:z1}=Symbol,yg=(t=>s=>{const a=yF.call(s);return t[a]||(t[a]=a.slice(8,-1).toLowerCase())})(Object.create(null)),jc=t=>(t=t.toLowerCase(),s=>yg(s)===t),jg=t=>s=>typeof s===t,{isArray:rx}=Array,Ju=jg("undefined");function Mh(t){return t!==null&&!Ju(t)&&t.constructor!==null&&!Ju(t.constructor)&&Ol(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const G1=jc("ArrayBuffer");function jF(t){let s;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?s=ArrayBuffer.isView(t):s=t&&t.buffer&&G1(t.buffer),s}const vF=jg("string"),Ol=jg("function"),q1=jg("number"),Ih=t=>t!==null&&typeof t=="object",NF=t=>t===!0||t===!1,LA=t=>{if(yg(t)!=="object")return!1;const s=by(t);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(z1 in t)&&!(bg in t)},wF=t=>{if(!Ih(t)||Mh(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},_F=jc("Date"),CF=jc("File"),SF=jc("Blob"),kF=jc("FileList"),BF=t=>Ih(t)&&Ol(t.pipe),FF=t=>{let s;return t&&(typeof FormData=="function"&&t instanceof FormData||Ol(t.append)&&((s=yg(t))==="formdata"||s==="object"&&Ol(t.toString)&&t.toString()==="[object FormData]"))},EF=jc("URLSearchParams"),[DF,UF,TF,LF]=["ReadableStream","Request","Response","Headers"].map(jc),QF=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function $h(t,s,{allOwnKeys:a=!1}={}){if(t===null||typeof t>"u")return;let r,l;if(typeof t!="object"&&(t=[t]),rx(t))for(r=0,l=t.length;r<l;r++)s.call(null,t[r],r,t);else{if(Mh(t))return;const c=a?Object.getOwnPropertyNames(t):Object.keys(t),o=c.length;let m;for(r=0;r<o;r++)m=c[r],s.call(null,t[m],m,t)}}function K1(t,s){if(Mh(t))return null;s=s.toLowerCase();const a=Object.keys(t);let r=a.length,l;for(;r-- >0;)if(l=a[r],s===l.toLowerCase())return l;return null}const Bm=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,V1=t=>!Ju(t)&&t!==Bm;function hb(){const{caseless:t,skipUndefined:s}=V1(this)&&this||{},a={},r=(l,c)=>{const o=t&&K1(a,c)||c;LA(a[o])&&LA(l)?a[o]=hb(a[o],l):LA(l)?a[o]=hb({},l):rx(l)?a[o]=l.slice():(!s||!Ju(l))&&(a[o]=l)};for(let l=0,c=arguments.length;l<c;l++)arguments[l]&&$h(arguments[l],r);return a}const RF=(t,s,a,{allOwnKeys:r}={})=>($h(s,(l,c)=>{a&&Ol(l)?t[c]=O1(l,a):t[c]=l},{allOwnKeys:r}),t),MF=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),IF=(t,s,a,r)=>{t.prototype=Object.create(s.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:s.prototype}),a&&Object.assign(t.prototype,a)},$F=(t,s,a,r)=>{let l,c,o;const m={};if(s=s||{},t==null)return s;do{for(l=Object.getOwnPropertyNames(t),c=l.length;c-- >0;)o=l[c],(!r||r(o,t,s))&&!m[o]&&(s[o]=t[o],m[o]=!0);t=a!==!1&&by(t)}while(t&&(!a||a(t,s))&&t!==Object.prototype);return s},HF=(t,s,a)=>{t=String(t),(a===void 0||a>t.length)&&(a=t.length),a-=s.length;const r=t.indexOf(s,a);return r!==-1&&r===a},PF=t=>{if(!t)return null;if(rx(t))return t;let s=t.length;if(!q1(s))return null;const a=new Array(s);for(;s-- >0;)a[s]=t[s];return a},OF=(t=>s=>t&&s instanceof t)(typeof Uint8Array<"u"&&by(Uint8Array)),zF=(t,s)=>{const r=(t&&t[bg]).call(t);let l;for(;(l=r.next())&&!l.done;){const c=l.value;s.call(t,c[0],c[1])}},GF=(t,s)=>{let a;const r=[];for(;(a=t.exec(s))!==null;)r.push(a);return r},qF=jc("HTMLFormElement"),KF=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(a,r,l){return r.toUpperCase()+l}),SN=(({hasOwnProperty:t})=>(s,a)=>t.call(s,a))(Object.prototype),VF=jc("RegExp"),Y1=(t,s)=>{const a=Object.getOwnPropertyDescriptors(t),r={};$h(a,(l,c)=>{let o;(o=s(l,c,t))!==!1&&(r[c]=o||l)}),Object.defineProperties(t,r)},YF=t=>{Y1(t,(s,a)=>{if(Ol(t)&&["arguments","caller","callee"].indexOf(a)!==-1)return!1;const r=t[a];if(Ol(r)){if(s.enumerable=!1,"writable"in s){s.writable=!1;return}s.set||(s.set=()=>{throw Error("Can not rewrite read-only method '"+a+"'")})}})},WF=(t,s)=>{const a={},r=l=>{l.forEach(c=>{a[c]=!0})};return rx(t)?r(t):r(String(t).split(s)),a},XF=()=>{},JF=(t,s)=>t!=null&&Number.isFinite(t=+t)?t:s;function ZF(t){return!!(t&&Ol(t.append)&&t[z1]==="FormData"&&t[bg])}const eE=t=>{const s=new Array(10),a=(r,l)=>{if(Ih(r)){if(s.indexOf(r)>=0)return;if(Mh(r))return r;if(!("toJSON"in r)){s[l]=r;const c=rx(r)?[]:{};return $h(r,(o,m)=>{const u=a(o,l+1);!Ju(u)&&(c[m]=u)}),s[l]=void 0,c}}return r};return a(t,0)},tE=jc("AsyncFunction"),sE=t=>t&&(Ih(t)||Ol(t))&&Ol(t.then)&&Ol(t.catch),W1=((t,s)=>t?setImmediate:s?((a,r)=>(Bm.addEventListener("message",({source:l,data:c})=>{l===Bm&&c===a&&r.length&&r.shift()()},!1),l=>{r.push(l),Bm.postMessage(a,"*")}))(`axios@${Math.random()}`,[]):a=>setTimeout(a))(typeof setImmediate=="function",Ol(Bm.postMessage)),aE=typeof queueMicrotask<"u"?queueMicrotask.bind(Bm):typeof process<"u"&&process.nextTick||W1,rE=t=>t!=null&&Ol(t[bg]),wt={isArray:rx,isArrayBuffer:G1,isBuffer:Mh,isFormData:FF,isArrayBufferView:jF,isString:vF,isNumber:q1,isBoolean:NF,isObject:Ih,isPlainObject:LA,isEmptyObject:wF,isReadableStream:DF,isRequest:UF,isResponse:TF,isHeaders:LF,isUndefined:Ju,isDate:_F,isFile:CF,isBlob:SF,isRegExp:VF,isFunction:Ol,isStream:BF,isURLSearchParams:EF,isTypedArray:OF,isFileList:kF,forEach:$h,merge:hb,extend:RF,trim:QF,stripBOM:MF,inherits:IF,toFlatObject:$F,kindOf:yg,kindOfTest:jc,endsWith:HF,toArray:PF,forEachEntry:zF,matchAll:GF,isHTMLForm:qF,hasOwnProperty:SN,hasOwnProp:SN,reduceDescriptors:Y1,freezeMethods:YF,toObjectSet:WF,toCamelCase:KF,noop:XF,toFiniteNumber:JF,findKey:K1,global:Bm,isContextDefined:V1,isSpecCompliantForm:ZF,toJSONObject:eE,isAsyncFn:tE,isThenable:sE,setImmediate:W1,asap:aE,isIterable:rE};function Vs(t,s,a,r,l){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",s&&(this.code=s),a&&(this.config=a),r&&(this.request=r),l&&(this.response=l,this.status=l.status?l.status:null)}wt.inherits(Vs,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:wt.toJSONObject(this.config),code:this.code,status:this.status}}});const X1=Vs.prototype,J1={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{J1[t]={value:t}});Object.defineProperties(Vs,J1);Object.defineProperty(X1,"isAxiosError",{value:!0});Vs.from=(t,s,a,r,l,c)=>{const o=Object.create(X1);wt.toFlatObject(t,o,function(A){return A!==Error.prototype},x=>x!=="isAxiosError");const m=t&&t.message?t.message:"Error",u=s==null&&t?t.code:s;return Vs.call(o,m,u,a,r,l),t&&o.cause==null&&Object.defineProperty(o,"cause",{value:t,configurable:!0}),o.name=t&&t.name||"Error",c&&Object.assign(o,c),o};const nE=null;function pb(t){return wt.isPlainObject(t)||wt.isArray(t)}function Z1(t){return wt.endsWith(t,"[]")?t.slice(0,-2):t}function kN(t,s,a){return t?t.concat(s).map(function(l,c){return l=Z1(l),!a&&c?"["+l+"]":l}).join(a?".":""):s}function lE(t){return wt.isArray(t)&&!t.some(pb)}const iE=wt.toFlatObject(wt,{},null,function(s){return/^is[A-Z]/.test(s)});function vg(t,s,a){if(!wt.isObject(t))throw new TypeError("target must be an object");s=s||new FormData,a=wt.toFlatObject(a,{metaTokens:!0,dots:!1,indexes:!1},!1,function(v,U){return!wt.isUndefined(U[v])});const r=a.metaTokens,l=a.visitor||A,c=a.dots,o=a.indexes,u=(a.Blob||typeof Blob<"u"&&Blob)&&wt.isSpecCompliantForm(s);if(!wt.isFunction(l))throw new TypeError("visitor must be a function");function x(y){if(y===null)return"";if(wt.isDate(y))return y.toISOString();if(wt.isBoolean(y))return y.toString();if(!u&&wt.isBlob(y))throw new Vs("Blob is not supported. Use a Buffer instead.");return wt.isArrayBuffer(y)||wt.isTypedArray(y)?u&&typeof Blob=="function"?new Blob([y]):Buffer.from(y):y}function A(y,v,U){let D=y;if(y&&!U&&typeof y=="object"){if(wt.endsWith(v,"{}"))v=r?v:v.slice(0,-2),y=JSON.stringify(y);else if(wt.isArray(y)&&lE(y)||(wt.isFileList(y)||wt.endsWith(v,"[]"))&&(D=wt.toArray(y)))return v=Z1(v),D.forEach(function(K,$){!(wt.isUndefined(K)||K===null)&&s.append(o===!0?kN([v],$,c):o===null?v:v+"[]",x(K))}),!1}return pb(y)?!0:(s.append(kN(U,v,c),x(y)),!1)}const g=[],N=Object.assign(iE,{defaultVisitor:A,convertValue:x,isVisitable:pb});function f(y,v){if(!wt.isUndefined(y)){if(g.indexOf(y)!==-1)throw Error("Circular reference detected in "+v.join("."));g.push(y),wt.forEach(y,function(D,M){(!(wt.isUndefined(D)||D===null)&&l.call(s,D,wt.isString(M)?M.trim():M,v,N))===!0&&f(D,v?v.concat(M):[M])}),g.pop()}}if(!wt.isObject(t))throw new TypeError("data must be an object");return f(t),s}function BN(t){const s={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return s[r]})}function yy(t,s){this._pairs=[],t&&vg(t,this,s)}const e4=yy.prototype;e4.append=function(s,a){this._pairs.push([s,a])};e4.toString=function(s){const a=s?function(r){return s.call(this,r,BN)}:BN;return this._pairs.map(function(l){return a(l[0])+"="+a(l[1])},"").join("&")};function cE(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function t4(t,s,a){if(!s)return t;const r=a&&a.encode||cE;wt.isFunction(a)&&(a={serialize:a});const l=a&&a.serialize;let c;if(l?c=l(s,a):c=wt.isURLSearchParams(s)?s.toString():new yy(s,a).toString(r),c){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+c}return t}class FN{constructor(){this.handlers=[]}use(s,a,r){return this.handlers.push({fulfilled:s,rejected:a,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(s){this.handlers[s]&&(this.handlers[s]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(s){wt.forEach(this.handlers,function(r){r!==null&&s(r)})}}const s4={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},oE=typeof URLSearchParams<"u"?URLSearchParams:yy,dE=typeof FormData<"u"?FormData:null,mE=typeof Blob<"u"?Blob:null,uE={isBrowser:!0,classes:{URLSearchParams:oE,FormData:dE,Blob:mE},protocols:["http","https","file","blob","url","data"]},jy=typeof window<"u"&&typeof document<"u",Ab=typeof navigator=="object"&&navigator||void 0,xE=jy&&(!Ab||["ReactNative","NativeScript","NS"].indexOf(Ab.product)<0),hE=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",pE=jy&&window.location.href||"http://localhost",AE=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:jy,hasStandardBrowserEnv:xE,hasStandardBrowserWebWorkerEnv:hE,navigator:Ab,origin:pE},Symbol.toStringTag,{value:"Module"})),rl={...AE,...uE};function gE(t,s){return vg(t,new rl.classes.URLSearchParams,{visitor:function(a,r,l,c){return rl.isNode&&wt.isBuffer(a)?(this.append(r,a.toString("base64")),!1):c.defaultVisitor.apply(this,arguments)},...s})}function fE(t){return wt.matchAll(/\w+|\[(\w*)]/g,t).map(s=>s[0]==="[]"?"":s[1]||s[0])}function bE(t){const s={},a=Object.keys(t);let r;const l=a.length;let c;for(r=0;r<l;r++)c=a[r],s[c]=t[c];return s}function a4(t){function s(a,r,l,c){let o=a[c++];if(o==="__proto__")return!0;const m=Number.isFinite(+o),u=c>=a.length;return o=!o&&wt.isArray(l)?l.length:o,u?(wt.hasOwnProp(l,o)?l[o]=[l[o],r]:l[o]=r,!m):((!l[o]||!wt.isObject(l[o]))&&(l[o]=[]),s(a,r,l[o],c)&&wt.isArray(l[o])&&(l[o]=bE(l[o])),!m)}if(wt.isFormData(t)&&wt.isFunction(t.entries)){const a={};return wt.forEachEntry(t,(r,l)=>{s(fE(r),l,a,0)}),a}return null}function yE(t,s,a){if(wt.isString(t))try{return(s||JSON.parse)(t),wt.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(a||JSON.stringify)(t)}const Hh={transitional:s4,adapter:["xhr","http","fetch"],transformRequest:[function(s,a){const r=a.getContentType()||"",l=r.indexOf("application/json")>-1,c=wt.isObject(s);if(c&&wt.isHTMLForm(s)&&(s=new FormData(s)),wt.isFormData(s))return l?JSON.stringify(a4(s)):s;if(wt.isArrayBuffer(s)||wt.isBuffer(s)||wt.isStream(s)||wt.isFile(s)||wt.isBlob(s)||wt.isReadableStream(s))return s;if(wt.isArrayBufferView(s))return s.buffer;if(wt.isURLSearchParams(s))return a.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),s.toString();let m;if(c){if(r.indexOf("application/x-www-form-urlencoded")>-1)return gE(s,this.formSerializer).toString();if((m=wt.isFileList(s))||r.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return vg(m?{"files[]":s}:s,u&&new u,this.formSerializer)}}return c||l?(a.setContentType("application/json",!1),yE(s)):s}],transformResponse:[function(s){const a=this.transitional||Hh.transitional,r=a&&a.forcedJSONParsing,l=this.responseType==="json";if(wt.isResponse(s)||wt.isReadableStream(s))return s;if(s&&wt.isString(s)&&(r&&!this.responseType||l)){const o=!(a&&a.silentJSONParsing)&&l;try{return JSON.parse(s,this.parseReviver)}catch(m){if(o)throw m.name==="SyntaxError"?Vs.from(m,Vs.ERR_BAD_RESPONSE,this,null,this.response):m}}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:rl.classes.FormData,Blob:rl.classes.Blob},validateStatus:function(s){return s>=200&&s<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};wt.forEach(["delete","get","head","post","put","patch"],t=>{Hh.headers[t]={}});const jE=wt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),vE=t=>{const s={};let a,r,l;return t&&t.split(`
`).forEach(function(o){l=o.indexOf(":"),a=o.substring(0,l).trim().toLowerCase(),r=o.substring(l+1).trim(),!(!a||s[a]&&jE[a])&&(a==="set-cookie"?s[a]?s[a].push(r):s[a]=[r]:s[a]=s[a]?s[a]+", "+r:r)}),s},EN=Symbol("internals");function qx(t){return t&&String(t).trim().toLowerCase()}function QA(t){return t===!1||t==null?t:wt.isArray(t)?t.map(QA):String(t)}function NE(t){const s=Object.create(null),a=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=a.exec(t);)s[r[1]]=r[2];return s}const wE=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function af(t,s,a,r,l){if(wt.isFunction(r))return r.call(this,s,a);if(l&&(s=a),!!wt.isString(s)){if(wt.isString(r))return s.indexOf(r)!==-1;if(wt.isRegExp(r))return r.test(s)}}function _E(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(s,a,r)=>a.toUpperCase()+r)}function CE(t,s){const a=wt.toCamelCase(" "+s);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+a,{value:function(l,c,o){return this[r].call(this,s,l,c,o)},configurable:!0})})}let zl=class{constructor(s){s&&this.set(s)}set(s,a,r){const l=this;function c(m,u,x){const A=qx(u);if(!A)throw new Error("header name must be a non-empty string");const g=wt.findKey(l,A);(!g||l[g]===void 0||x===!0||x===void 0&&l[g]!==!1)&&(l[g||u]=QA(m))}const o=(m,u)=>wt.forEach(m,(x,A)=>c(x,A,u));if(wt.isPlainObject(s)||s instanceof this.constructor)o(s,a);else if(wt.isString(s)&&(s=s.trim())&&!wE(s))o(vE(s),a);else if(wt.isObject(s)&&wt.isIterable(s)){let m={},u,x;for(const A of s){if(!wt.isArray(A))throw TypeError("Object iterator must return a key-value pair");m[x=A[0]]=(u=m[x])?wt.isArray(u)?[...u,A[1]]:[u,A[1]]:A[1]}o(m,a)}else s!=null&&c(a,s,r);return this}get(s,a){if(s=qx(s),s){const r=wt.findKey(this,s);if(r){const l=this[r];if(!a)return l;if(a===!0)return NE(l);if(wt.isFunction(a))return a.call(this,l,r);if(wt.isRegExp(a))return a.exec(l);throw new TypeError("parser must be boolean|regexp|function")}}}has(s,a){if(s=qx(s),s){const r=wt.findKey(this,s);return!!(r&&this[r]!==void 0&&(!a||af(this,this[r],r,a)))}return!1}delete(s,a){const r=this;let l=!1;function c(o){if(o=qx(o),o){const m=wt.findKey(r,o);m&&(!a||af(r,r[m],m,a))&&(delete r[m],l=!0)}}return wt.isArray(s)?s.forEach(c):c(s),l}clear(s){const a=Object.keys(this);let r=a.length,l=!1;for(;r--;){const c=a[r];(!s||af(this,this[c],c,s,!0))&&(delete this[c],l=!0)}return l}normalize(s){const a=this,r={};return wt.forEach(this,(l,c)=>{const o=wt.findKey(r,c);if(o){a[o]=QA(l),delete a[c];return}const m=s?_E(c):String(c).trim();m!==c&&delete a[c],a[m]=QA(l),r[m]=!0}),this}concat(...s){return this.constructor.concat(this,...s)}toJSON(s){const a=Object.create(null);return wt.forEach(this,(r,l)=>{r!=null&&r!==!1&&(a[l]=s&&wt.isArray(r)?r.join(", "):r)}),a}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([s,a])=>s+": "+a).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(s){return s instanceof this?s:new this(s)}static concat(s,...a){const r=new this(s);return a.forEach(l=>r.set(l)),r}static accessor(s){const r=(this[EN]=this[EN]={accessors:{}}).accessors,l=this.prototype;function c(o){const m=qx(o);r[m]||(CE(l,o),r[m]=!0)}return wt.isArray(s)?s.forEach(c):c(s),this}};zl.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);wt.reduceDescriptors(zl.prototype,({value:t},s)=>{let a=s[0].toUpperCase()+s.slice(1);return{get:()=>t,set(r){this[a]=r}}});wt.freezeMethods(zl);function rf(t,s){const a=this||Hh,r=s||a,l=zl.from(r.headers);let c=r.data;return wt.forEach(t,function(m){c=m.call(a,c,l.normalize(),s?s.status:void 0)}),l.normalize(),c}function r4(t){return!!(t&&t.__CANCEL__)}function nx(t,s,a){Vs.call(this,t??"canceled",Vs.ERR_CANCELED,s,a),this.name="CanceledError"}wt.inherits(nx,Vs,{__CANCEL__:!0});function n4(t,s,a){const r=a.config.validateStatus;!a.status||!r||r(a.status)?t(a):s(new Vs("Request failed with status code "+a.status,[Vs.ERR_BAD_REQUEST,Vs.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a))}function SE(t){const s=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return s&&s[1]||""}function kE(t,s){t=t||10;const a=new Array(t),r=new Array(t);let l=0,c=0,o;return s=s!==void 0?s:1e3,function(u){const x=Date.now(),A=r[c];o||(o=x),a[l]=u,r[l]=x;let g=c,N=0;for(;g!==l;)N+=a[g++],g=g%t;if(l=(l+1)%t,l===c&&(c=(c+1)%t),x-o<s)return;const f=A&&x-A;return f?Math.round(N*1e3/f):void 0}}function BE(t,s){let a=0,r=1e3/s,l,c;const o=(x,A=Date.now())=>{a=A,l=null,c&&(clearTimeout(c),c=null),t(...x)};return[(...x)=>{const A=Date.now(),g=A-a;g>=r?o(x,A):(l=x,c||(c=setTimeout(()=>{c=null,o(l)},r-g)))},()=>l&&o(l)]}const ZA=(t,s,a=3)=>{let r=0;const l=kE(50,250);return BE(c=>{const o=c.loaded,m=c.lengthComputable?c.total:void 0,u=o-r,x=l(u),A=o<=m;r=o;const g={loaded:o,total:m,progress:m?o/m:void 0,bytes:u,rate:x||void 0,estimated:x&&m&&A?(m-o)/x:void 0,event:c,lengthComputable:m!=null,[s?"download":"upload"]:!0};t(g)},a)},DN=(t,s)=>{const a=t!=null;return[r=>s[0]({lengthComputable:a,total:t,loaded:r}),s[1]]},UN=t=>(...s)=>wt.asap(()=>t(...s)),FE=rl.hasStandardBrowserEnv?((t,s)=>a=>(a=new URL(a,rl.origin),t.protocol===a.protocol&&t.host===a.host&&(s||t.port===a.port)))(new URL(rl.origin),rl.navigator&&/(msie|trident)/i.test(rl.navigator.userAgent)):()=>!0,EE=rl.hasStandardBrowserEnv?{write(t,s,a,r,l,c,o){if(typeof document>"u")return;const m=[`${t}=${encodeURIComponent(s)}`];wt.isNumber(a)&&m.push(`expires=${new Date(a).toUTCString()}`),wt.isString(r)&&m.push(`path=${r}`),wt.isString(l)&&m.push(`domain=${l}`),c===!0&&m.push("secure"),wt.isString(o)&&m.push(`SameSite=${o}`),document.cookie=m.join("; ")},read(t){if(typeof document>"u")return null;const s=document.cookie.match(new RegExp("(?:^|; )"+t+"=([^;]*)"));return s?decodeURIComponent(s[1]):null},remove(t){this.write(t,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function DE(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function UE(t,s){return s?t.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):t}function l4(t,s,a){let r=!DE(s);return t&&(r||a==!1)?UE(t,s):s}const TN=t=>t instanceof zl?{...t}:t;function Lm(t,s){s=s||{};const a={};function r(x,A,g,N){return wt.isPlainObject(x)&&wt.isPlainObject(A)?wt.merge.call({caseless:N},x,A):wt.isPlainObject(A)?wt.merge({},A):wt.isArray(A)?A.slice():A}function l(x,A,g,N){if(wt.isUndefined(A)){if(!wt.isUndefined(x))return r(void 0,x,g,N)}else return r(x,A,g,N)}function c(x,A){if(!wt.isUndefined(A))return r(void 0,A)}function o(x,A){if(wt.isUndefined(A)){if(!wt.isUndefined(x))return r(void 0,x)}else return r(void 0,A)}function m(x,A,g){if(g in s)return r(x,A);if(g in t)return r(void 0,x)}const u={url:c,method:c,data:c,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:m,headers:(x,A,g)=>l(TN(x),TN(A),g,!0)};return wt.forEach(Object.keys({...t,...s}),function(A){const g=u[A]||l,N=g(t[A],s[A],A);wt.isUndefined(N)&&g!==m||(a[A]=N)}),a}const i4=t=>{const s=Lm({},t);let{data:a,withXSRFToken:r,xsrfHeaderName:l,xsrfCookieName:c,headers:o,auth:m}=s;if(s.headers=o=zl.from(o),s.url=t4(l4(s.baseURL,s.url,s.allowAbsoluteUrls),t.params,t.paramsSerializer),m&&o.set("Authorization","Basic "+btoa((m.username||"")+":"+(m.password?unescape(encodeURIComponent(m.password)):""))),wt.isFormData(a)){if(rl.hasStandardBrowserEnv||rl.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(wt.isFunction(a.getHeaders)){const u=a.getHeaders(),x=["content-type","content-length"];Object.entries(u).forEach(([A,g])=>{x.includes(A.toLowerCase())&&o.set(A,g)})}}if(rl.hasStandardBrowserEnv&&(r&&wt.isFunction(r)&&(r=r(s)),r||r!==!1&&FE(s.url))){const u=l&&c&&EE.read(c);u&&o.set(l,u)}return s},TE=typeof XMLHttpRequest<"u",LE=TE&&function(t){return new Promise(function(a,r){const l=i4(t);let c=l.data;const o=zl.from(l.headers).normalize();let{responseType:m,onUploadProgress:u,onDownloadProgress:x}=l,A,g,N,f,y;function v(){f&&f(),y&&y(),l.cancelToken&&l.cancelToken.unsubscribe(A),l.signal&&l.signal.removeEventListener("abort",A)}let U=new XMLHttpRequest;U.open(l.method.toUpperCase(),l.url,!0),U.timeout=l.timeout;function D(){if(!U)return;const K=zl.from("getAllResponseHeaders"in U&&U.getAllResponseHeaders()),P={data:!m||m==="text"||m==="json"?U.responseText:U.response,status:U.status,statusText:U.statusText,headers:K,config:t,request:U};n4(function(z){a(z),v()},function(z){r(z),v()},P),U=null}"onloadend"in U?U.onloadend=D:U.onreadystatechange=function(){!U||U.readyState!==4||U.status===0&&!(U.responseURL&&U.responseURL.indexOf("file:")===0)||setTimeout(D)},U.onabort=function(){U&&(r(new Vs("Request aborted",Vs.ECONNABORTED,t,U)),U=null)},U.onerror=function($){const P=$&&$.message?$.message:"Network Error",se=new Vs(P,Vs.ERR_NETWORK,t,U);se.event=$||null,r(se),U=null},U.ontimeout=function(){let $=l.timeout?"timeout of "+l.timeout+"ms exceeded":"timeout exceeded";const P=l.transitional||s4;l.timeoutErrorMessage&&($=l.timeoutErrorMessage),r(new Vs($,P.clarifyTimeoutError?Vs.ETIMEDOUT:Vs.ECONNABORTED,t,U)),U=null},c===void 0&&o.setContentType(null),"setRequestHeader"in U&&wt.forEach(o.toJSON(),function($,P){U.setRequestHeader(P,$)}),wt.isUndefined(l.withCredentials)||(U.withCredentials=!!l.withCredentials),m&&m!=="json"&&(U.responseType=l.responseType),x&&([N,y]=ZA(x,!0),U.addEventListener("progress",N)),u&&U.upload&&([g,f]=ZA(u),U.upload.addEventListener("progress",g),U.upload.addEventListener("loadend",f)),(l.cancelToken||l.signal)&&(A=K=>{U&&(r(!K||K.type?new nx(null,t,U):K),U.abort(),U=null)},l.cancelToken&&l.cancelToken.subscribe(A),l.signal&&(l.signal.aborted?A():l.signal.addEventListener("abort",A)));const M=SE(l.url);if(M&&rl.protocols.indexOf(M)===-1){r(new Vs("Unsupported protocol "+M+":",Vs.ERR_BAD_REQUEST,t));return}U.send(c||null)})},QE=(t,s)=>{const{length:a}=t=t?t.filter(Boolean):[];if(s||a){let r=new AbortController,l;const c=function(x){if(!l){l=!0,m();const A=x instanceof Error?x:this.reason;r.abort(A instanceof Vs?A:new nx(A instanceof Error?A.message:A))}};let o=s&&setTimeout(()=>{o=null,c(new Vs(`timeout ${s} of ms exceeded`,Vs.ETIMEDOUT))},s);const m=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(x=>{x.unsubscribe?x.unsubscribe(c):x.removeEventListener("abort",c)}),t=null)};t.forEach(x=>x.addEventListener("abort",c));const{signal:u}=r;return u.unsubscribe=()=>wt.asap(m),u}},RE=function*(t,s){let a=t.byteLength;if(a<s){yield t;return}let r=0,l;for(;r<a;)l=r+s,yield t.slice(r,l),r=l},ME=async function*(t,s){for await(const a of IE(t))yield*RE(a,s)},IE=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const s=t.getReader();try{for(;;){const{done:a,value:r}=await s.read();if(a)break;yield r}}finally{await s.cancel()}},LN=(t,s,a,r)=>{const l=ME(t,s);let c=0,o,m=u=>{o||(o=!0,r&&r(u))};return new ReadableStream({async pull(u){try{const{done:x,value:A}=await l.next();if(x){m(),u.close();return}let g=A.byteLength;if(a){let N=c+=g;a(N)}u.enqueue(new Uint8Array(A))}catch(x){throw m(x),x}},cancel(u){return m(u),l.return()}},{highWaterMark:2})},QN=64*1024,{isFunction:Hp}=wt,$E=(({Request:t,Response:s})=>({Request:t,Response:s}))(wt.global),{ReadableStream:RN,TextEncoder:MN}=wt.global,IN=(t,...s)=>{try{return!!t(...s)}catch{return!1}},HE=t=>{t=wt.merge.call({skipUndefined:!0},$E,t);const{fetch:s,Request:a,Response:r}=t,l=s?Hp(s):typeof fetch=="function",c=Hp(a),o=Hp(r);if(!l)return!1;const m=l&&Hp(RN),u=l&&(typeof MN=="function"?(y=>v=>y.encode(v))(new MN):async y=>new Uint8Array(await new a(y).arrayBuffer())),x=c&&m&&IN(()=>{let y=!1;const v=new a(rl.origin,{body:new RN,method:"POST",get duplex(){return y=!0,"half"}}).headers.has("Content-Type");return y&&!v}),A=o&&m&&IN(()=>wt.isReadableStream(new r("").body)),g={stream:A&&(y=>y.body)};l&&["text","arrayBuffer","blob","formData","stream"].forEach(y=>{!g[y]&&(g[y]=(v,U)=>{let D=v&&v[y];if(D)return D.call(v);throw new Vs(`Response type '${y}' is not supported`,Vs.ERR_NOT_SUPPORT,U)})});const N=async y=>{if(y==null)return 0;if(wt.isBlob(y))return y.size;if(wt.isSpecCompliantForm(y))return(await new a(rl.origin,{method:"POST",body:y}).arrayBuffer()).byteLength;if(wt.isArrayBufferView(y)||wt.isArrayBuffer(y))return y.byteLength;if(wt.isURLSearchParams(y)&&(y=y+""),wt.isString(y))return(await u(y)).byteLength},f=async(y,v)=>{const U=wt.toFiniteNumber(y.getContentLength());return U??N(v)};return async y=>{let{url:v,method:U,data:D,signal:M,cancelToken:K,timeout:$,onDownloadProgress:P,onUploadProgress:se,responseType:z,headers:R,withCredentials:j="same-origin",fetchOptions:T}=i4(y),Q=s||fetch;z=z?(z+"").toLowerCase():"text";let E=QE([M,K&&K.toAbortSignal()],$),te=null;const C=E&&E.unsubscribe&&(()=>{E.unsubscribe()});let O;try{if(se&&x&&U!=="get"&&U!=="head"&&(O=await f(R,D))!==0){let I=new a(v,{method:"POST",body:D,duplex:"half"}),H;if(wt.isFormData(D)&&(H=I.headers.get("content-type"))&&R.setContentType(H),I.body){const[ae,k]=DN(O,ZA(UN(se)));D=LN(I.body,QN,ae,k)}}wt.isString(j)||(j=j?"include":"omit");const V=c&&"credentials"in a.prototype,re={...T,signal:E,method:U.toUpperCase(),headers:R.normalize().toJSON(),body:D,duplex:"half",credentials:V?j:void 0};te=c&&new a(v,re);let ge=await(c?Q(te,T):Q(v,re));const xe=A&&(z==="stream"||z==="response");if(A&&(P||xe&&C)){const I={};["status","statusText","headers"].forEach(B=>{I[B]=ge[B]});const H=wt.toFiniteNumber(ge.headers.get("content-length")),[ae,k]=P&&DN(H,ZA(UN(P),!0))||[];ge=new r(LN(ge.body,QN,ae,()=>{k&&k(),C&&C()}),I)}z=z||"text";let Z=await g[wt.findKey(g,z)||"text"](ge,y);return!xe&&C&&C(),await new Promise((I,H)=>{n4(I,H,{data:Z,headers:zl.from(ge.headers),status:ge.status,statusText:ge.statusText,config:y,request:te})})}catch(V){throw C&&C(),V&&V.name==="TypeError"&&/Load failed|fetch/i.test(V.message)?Object.assign(new Vs("Network Error",Vs.ERR_NETWORK,y,te),{cause:V.cause||V}):Vs.from(V,V&&V.code,y,te)}}},PE=new Map,c4=t=>{let s=t&&t.env||{};const{fetch:a,Request:r,Response:l}=s,c=[r,l,a];let o=c.length,m=o,u,x,A=PE;for(;m--;)u=c[m],x=A.get(u),x===void 0&&A.set(u,x=m?new Map:HE(s)),A=x;return x};c4();const vy={http:nE,xhr:LE,fetch:{get:c4}};wt.forEach(vy,(t,s)=>{if(t){try{Object.defineProperty(t,"name",{value:s})}catch{}Object.defineProperty(t,"adapterName",{value:s})}});const $N=t=>`- ${t}`,OE=t=>wt.isFunction(t)||t===null||t===!1;function zE(t,s){t=wt.isArray(t)?t:[t];const{length:a}=t;let r,l;const c={};for(let o=0;o<a;o++){r=t[o];let m;if(l=r,!OE(r)&&(l=vy[(m=String(r)).toLowerCase()],l===void 0))throw new Vs(`Unknown adapter '${m}'`);if(l&&(wt.isFunction(l)||(l=l.get(s))))break;c[m||"#"+o]=l}if(!l){const o=Object.entries(c).map(([u,x])=>`adapter ${u} `+(x===!1?"is not supported by the environment":"is not available in the build"));let m=a?o.length>1?`since :
`+o.map($N).join(`
`):" "+$N(o[0]):"as no adapter specified";throw new Vs("There is no suitable adapter to dispatch the request "+m,"ERR_NOT_SUPPORT")}return l}const o4={getAdapter:zE,adapters:vy};function nf(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new nx(null,t)}function HN(t){return nf(t),t.headers=zl.from(t.headers),t.data=rf.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),o4.getAdapter(t.adapter||Hh.adapter,t)(t).then(function(r){return nf(t),r.data=rf.call(t,t.transformResponse,r),r.headers=zl.from(r.headers),r},function(r){return r4(r)||(nf(t),r&&r.response&&(r.response.data=rf.call(t,t.transformResponse,r.response),r.response.headers=zl.from(r.response.headers))),Promise.reject(r)})}const d4="1.13.2",Ng={};["object","boolean","number","function","string","symbol"].forEach((t,s)=>{Ng[t]=function(r){return typeof r===t||"a"+(s<1?"n ":" ")+t}});const PN={};Ng.transitional=function(s,a,r){function l(c,o){return"[Axios v"+d4+"] Transitional option '"+c+"'"+o+(r?". "+r:"")}return(c,o,m)=>{if(s===!1)throw new Vs(l(o," has been removed"+(a?" in "+a:"")),Vs.ERR_DEPRECATED);return a&&!PN[o]&&(PN[o]=!0,console.warn(l(o," has been deprecated since v"+a+" and will be removed in the near future"))),s?s(c,o,m):!0}};Ng.spelling=function(s){return(a,r)=>(console.warn(`${r} is likely a misspelling of ${s}`),!0)};function GE(t,s,a){if(typeof t!="object")throw new Vs("options must be an object",Vs.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let l=r.length;for(;l-- >0;){const c=r[l],o=s[c];if(o){const m=t[c],u=m===void 0||o(m,c,t);if(u!==!0)throw new Vs("option "+c+" must be "+u,Vs.ERR_BAD_OPTION_VALUE);continue}if(a!==!0)throw new Vs("Unknown option "+c,Vs.ERR_BAD_OPTION)}}const RA={assertOptions:GE,validators:Ng},zc=RA.validators;let Em=class{constructor(s){this.defaults=s||{},this.interceptors={request:new FN,response:new FN}}async request(s,a){try{return await this._request(s,a)}catch(r){if(r instanceof Error){let l={};Error.captureStackTrace?Error.captureStackTrace(l):l=new Error;const c=l.stack?l.stack.replace(/^.+\n/,""):"";try{r.stack?c&&!String(r.stack).endsWith(c.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+c):r.stack=c}catch{}}throw r}}_request(s,a){typeof s=="string"?(a=a||{},a.url=s):a=s||{},a=Lm(this.defaults,a);const{transitional:r,paramsSerializer:l,headers:c}=a;r!==void 0&&RA.assertOptions(r,{silentJSONParsing:zc.transitional(zc.boolean),forcedJSONParsing:zc.transitional(zc.boolean),clarifyTimeoutError:zc.transitional(zc.boolean)},!1),l!=null&&(wt.isFunction(l)?a.paramsSerializer={serialize:l}:RA.assertOptions(l,{encode:zc.function,serialize:zc.function},!0)),a.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?a.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:a.allowAbsoluteUrls=!0),RA.assertOptions(a,{baseUrl:zc.spelling("baseURL"),withXsrfToken:zc.spelling("withXSRFToken")},!0),a.method=(a.method||this.defaults.method||"get").toLowerCase();let o=c&&wt.merge(c.common,c[a.method]);c&&wt.forEach(["delete","get","head","post","put","patch","common"],y=>{delete c[y]}),a.headers=zl.concat(o,c);const m=[];let u=!0;this.interceptors.request.forEach(function(v){typeof v.runWhen=="function"&&v.runWhen(a)===!1||(u=u&&v.synchronous,m.unshift(v.fulfilled,v.rejected))});const x=[];this.interceptors.response.forEach(function(v){x.push(v.fulfilled,v.rejected)});let A,g=0,N;if(!u){const y=[HN.bind(this),void 0];for(y.unshift(...m),y.push(...x),N=y.length,A=Promise.resolve(a);g<N;)A=A.then(y[g++],y[g++]);return A}N=m.length;let f=a;for(;g<N;){const y=m[g++],v=m[g++];try{f=y(f)}catch(U){v.call(this,U);break}}try{A=HN.call(this,f)}catch(y){return Promise.reject(y)}for(g=0,N=x.length;g<N;)A=A.then(x[g++],x[g++]);return A}getUri(s){s=Lm(this.defaults,s);const a=l4(s.baseURL,s.url,s.allowAbsoluteUrls);return t4(a,s.params,s.paramsSerializer)}};wt.forEach(["delete","get","head","options"],function(s){Em.prototype[s]=function(a,r){return this.request(Lm(r||{},{method:s,url:a,data:(r||{}).data}))}});wt.forEach(["post","put","patch"],function(s){function a(r){return function(c,o,m){return this.request(Lm(m||{},{method:s,headers:r?{"Content-Type":"multipart/form-data"}:{},url:c,data:o}))}}Em.prototype[s]=a(),Em.prototype[s+"Form"]=a(!0)});let qE=class m4{constructor(s){if(typeof s!="function")throw new TypeError("executor must be a function.");let a;this.promise=new Promise(function(c){a=c});const r=this;this.promise.then(l=>{if(!r._listeners)return;let c=r._listeners.length;for(;c-- >0;)r._listeners[c](l);r._listeners=null}),this.promise.then=l=>{let c;const o=new Promise(m=>{r.subscribe(m),c=m}).then(l);return o.cancel=function(){r.unsubscribe(c)},o},s(function(c,o,m){r.reason||(r.reason=new nx(c,o,m),a(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(s){if(this.reason){s(this.reason);return}this._listeners?this._listeners.push(s):this._listeners=[s]}unsubscribe(s){if(!this._listeners)return;const a=this._listeners.indexOf(s);a!==-1&&this._listeners.splice(a,1)}toAbortSignal(){const s=new AbortController,a=r=>{s.abort(r)};return this.subscribe(a),s.signal.unsubscribe=()=>this.unsubscribe(a),s.signal}static source(){let s;return{token:new m4(function(l){s=l}),cancel:s}}};function KE(t){return function(a){return t.apply(null,a)}}function VE(t){return wt.isObject(t)&&t.isAxiosError===!0}const gb={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(gb).forEach(([t,s])=>{gb[s]=t});function u4(t){const s=new Em(t),a=O1(Em.prototype.request,s);return wt.extend(a,Em.prototype,s,{allOwnKeys:!0}),wt.extend(a,s,null,{allOwnKeys:!0}),a.create=function(l){return u4(Lm(t,l))},a}const F=u4(Hh);F.Axios=Em;F.CanceledError=nx;F.CancelToken=qE;F.isCancel=r4;F.VERSION=d4;F.toFormData=vg;F.AxiosError=Vs;F.Cancel=F.CanceledError;F.all=function(s){return Promise.all(s)};F.spread=KE;F.isAxiosError=VE;F.mergeConfig=Lm;F.AxiosHeaders=zl;F.formToJSON=t=>a4(wt.isHTMLForm(t)?new FormData(t):t);F.getAdapter=o4.getAdapter;F.HttpStatusCode=gb;F.default=F;const{Axios:zH,AxiosError:GH,CanceledError:qH,isCancel:KH,CancelToken:VH,VERSION:YH,all:WH,Cancel:XH,isAxiosError:JH,spread:ZH,toFormData:e9,AxiosHeaders:t9,HttpStatusCode:s9,formToJSON:a9,getAdapter:r9,mergeConfig:n9}=F,YE={fee:{keywords:["fee","fees","payment","pay","cost","tuition","amount","how much"],responses:["To view your fees, go to the Finance section in your dashboard.","You can pay fees online through Mobile Money (MTN, Vodafone, AirtelTigo) or card payment.","For fee inquiries, please contact the accounts office or check your invoice in the Payments section."]},payment:{keywords:["payment","pay","mobile money","momo","card","bank"],responses:["We accept multiple payment methods: Mobile Money (MTN MoMo, Vodafone Cash, AirtelTigo Money), Visa/Mastercard, and Bank Transfer.","To make a payment: Go to Payments  Select Invoice  Choose Payment Method  Complete Payment.","Payment receipts are automatically sent to your email and available in the Payments section."]},attendance:{keywords:["attendance","absent","present","late","missed","class"],responses:["You can view your child's attendance record in the Dashboard or Child Details section.","If your child is absent, please inform the school through the Messages section or call the office.","Attendance is marked daily by class teachers. You'll receive notifications for any absences."]},results:{keywords:["result","results","grade","grades","score","marks","exam","report"],responses:["View your child's results in the 'Results' section of the Parent Portal.","Report cards are published at the end of each term. You'll receive a notification when they're ready.","For grade inquiries, please message the subject teacher through the Messages section."]},homework:{keywords:["homework","assignment","assignments","task","project"],responses:["Check the Homework section to see all pending and completed assignments.","Homework is assigned by teachers with due dates. You'll receive notifications for new assignments.","If you have questions about homework, message the teacher directly through the app."]},timetable:{keywords:["timetable","schedule","class time","period","when"],responses:["The class timetable is available in the Timetable section of the dashboard.","Timetables show daily class schedules including subjects, teachers, and room numbers.","Any changes to the timetable will be notified through the app."]},transport:{keywords:["bus","transport","pick up","drop","route","driver"],responses:["Track your child's school bus in real-time through the Transport section.","Bus routes and schedules are available in the Transport module.","For transport issues, contact the transport coordinator through Messages."]},message:{keywords:["message","contact","teacher","communicate","talk","reach"],responses:["Use the Messages section to communicate with teachers and school administration.","You can send messages to any teacher or the admin office directly from the app.","All messages are saved in your inbox for future reference."]},admission:{keywords:["admission","enroll","enrolment","register","new student","apply"],responses:["To apply for admission, go to 'Apply for Admission' in the Parent Portal.","Required documents: Birth certificate, previous school records, passport photos.","Admission applications are reviewed within 5-7 working days."]},help:{keywords:["help","support","assist","how to","guide"],responses:["I'm here to help! You can ask me about fees, attendance, results, homework, timetable, transport, or messaging.","For technical issues, please contact support@school.com or call the IT helpdesk.","Use the search bar at the top to quickly find any feature in the app."]},greeting:{keywords:["hello","hi","hey","good morning","good afternoon","good evening"],responses:["Hello!  I'm your school assistant. How can I help you today?","Hi there! I can help you with fees, attendance, results, homework, and more. What do you need?","Welcome! Ask me anything about the school management system."]},thanks:{keywords:["thank","thanks","thank you","appreciate"],responses:["You're welcome! Is there anything else I can help you with?","Happy to help! Feel free to ask if you have more questions.","Anytime! Don't hesitate to reach out if you need more assistance."]}};function WE(){const{user:t}=Us(),[s,a]=h.useState(!1),[r,l]=h.useState(!1),[c,o]=h.useState([{id:1,type:"bot",text:`Hello${t?.name?`, ${t.name.split(" ")[0]}`:""}!  I'm your AI assistant. How can I help you today?`,time:new Date}]),[m,u]=h.useState(""),[x,A]=h.useState(!1),[g,N]=h.useState(!1),f=h.useRef(null),y=h.useRef(null);h.useEffect(()=>{f.current?.scrollIntoView({behavior:"smooth"})},[c]);const v=$=>{const P=$.toLowerCase();for(const[se,z]of Object.entries(YE))for(const R of z.keywords)if(P.includes(R)){const j=z.responses;return j[Math.floor(Math.random()*j.length)]}return`I'm not sure about that. You can ask me about:
 Fees & Payments
 Attendance
 Results & Grades
 Homework
 Timetable
 Transport
 Messaging

Or contact the school office for specific inquiries.`},U=async()=>{if(!m.trim())return;const $={id:Date.now(),type:"user",text:m,time:new Date};o(z=>[...z,$]),u(""),A(!0),await new Promise(z=>setTimeout(z,500+Math.random()*1e3));let P;try{P=(await F.post(`${ee}/chatbot.php`,{query:m,user_id:t?.id,user_type:t?.user_type})).data.response}catch{P=v(m)}const se={id:Date.now()+1,type:"bot",text:P,time:new Date};o(z=>[...z,se]),A(!1)},D=$=>{$.key==="Enter"&&!$.shiftKey&&($.preventDefault(),U())},M=$=>{if("speechSynthesis"in window)if(g)window.speechSynthesis.cancel(),N(!1);else{const P=new SpeechSynthesisUtterance($);P.onend=()=>N(!1),window.speechSynthesis.speak(P),N(!0)}},K=[{label:"Check Fees",query:"How do I check my fees?"},{label:"View Results",query:"Where can I see my results?"},{label:"Homework",query:"Show me pending homework"},{label:"Contact Teacher",query:"How do I message a teacher?"}];return s?e.jsx("div",{className:`fixed bottom-6 left-6 z-50 ${r?"w-72":"w-96"} transition-all duration-300`,children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl overflow-hidden border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(sf,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold",children:"AI Assistant"}),e.jsx("p",{className:"text-white/70 text-xs",children:"Always here to help"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>l(!r),className:"p-1.5 hover:bg-white/20 rounded-lg transition-colors",children:r?e.jsx(Ek,{className:"w-4 h-4 text-white"}):e.jsx(Ik,{className:"w-4 h-4 text-white"})}),e.jsx("button",{onClick:()=>a(!1),className:"p-1.5 hover:bg-white/20 rounded-lg transition-colors",children:e.jsx(Nt,{className:"w-4 h-4 text-white"})})]})]}),!r&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"h-80 overflow-y-auto p-4 space-y-4 bg-gray-50 dark:bg-gray-900",children:[c.map($=>e.jsx("div",{className:`flex ${$.type==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`flex items-start gap-2 max-w-[85%] ${$.type==="user"?"flex-row-reverse":""}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${$.type==="user"?"bg-blue-600 text-white":"bg-gradient-to-r from-blue-600 to-purple-600 text-white"}`,children:$.type==="user"?e.jsx(ha,{className:"w-4 h-4"}):e.jsx(sf,{className:"w-4 h-4"})}),e.jsxs("div",{className:`rounded-2xl px-4 py-2 ${$.type==="user"?"bg-blue-600 text-white rounded-tr-sm":"bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-200 rounded-tl-sm shadow-sm"}`,children:[e.jsx("p",{className:"text-sm whitespace-pre-line",children:$.text}),e.jsxs("div",{className:`flex items-center gap-2 mt-1 ${$.type==="user"?"justify-end":""}`,children:[e.jsx("span",{className:`text-xs ${$.type==="user"?"text-white/70":"text-gray-400"}`,children:$.time.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),$.type==="bot"&&e.jsx("button",{onClick:()=>M($.text),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:g?e.jsx(oF,{className:"w-3 h-3 text-gray-400"}):e.jsx(iF,{className:"w-3 h-3 text-gray-400"})})]})]})]})},$.id)),x&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-blue-600 to-purple-600 flex items-center justify-center",children:e.jsx(sf,{className:"w-4 h-4 text-white"})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl px-4 py-3 shadow-sm",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx("span",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("span",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("span",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})]}),e.jsx("div",{ref:f})]}),e.jsx("div",{className:"px-4 py-2 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:K.map(($,P)=>e.jsx("button",{onClick:()=>{u($.query),setTimeout(()=>U(),100)},className:"px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-xs whitespace-nowrap hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:$.label},P))})}),e.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{ref:y,type:"text",value:m,onChange:$=>u($.target.value),onKeyPress:D,placeholder:"Type your message...",className:"flex-1 px-4 py-2 bg-gray-100 dark:bg-gray-700 rounded-full text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 dark:text-white"}),e.jsx("button",{onClick:U,disabled:!m.trim()||x,className:"w-10 h-10 bg-gradient-to-r from-blue-600 to-purple-600 rounded-full flex items-center justify-center text-white disabled:opacity-50 hover:opacity-90 transition-opacity",children:x?e.jsx(hs,{className:"w-5 h-5 animate-spin"}):e.jsx(va,{className:"w-5 h-5"})})]})})]})]})}):e.jsxs("button",{onClick:()=>a(!0),className:"fixed bottom-6 left-6 w-14 h-14 bg-gradient-to-r from-blue-600 to-purple-600 rounded-full shadow-lg flex items-center justify-center text-white hover:scale-110 transition-transform z-50 group",children:[e.jsx(zu,{className:"w-6 h-6"}),e.jsx("span",{className:"absolute -top-2 -right-2 w-5 h-5 bg-red-500 rounded-full text-xs flex items-center justify-center animate-pulse",children:e.jsx(cl,{className:"w-3 h-3"})}),e.jsx("span",{className:"absolute right-full mr-3 bg-gray-900 text-white text-sm px-3 py-1 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",children:"AI Assistant"})]})}const x4=Th(oy((t,s)=>({settings:{school_name:"McSMS Pro",school_logo:null,school_tagline:"School Management System",school_abbreviation:"",school_address:"",school_phone:"",school_email:"",school_website:"",school_motto:""},loading:!1,lastFetched:null,fetchSettings:async(a=!1)=>{const r=s(),l=Date.now();if(!a&&r.lastFetched&&l-r.lastFetched<5e3)return r.settings;t({loading:!0});try{const c=await F.get(`${ee}/public_settings.php?_t=${l}`);if(c.data.success&&c.data.settings){const o=c.data.settings;return t({settings:o,lastFetched:l,loading:!1}),o}}catch(c){console.error("Failed to fetch school settings:",c)}return t({loading:!1}),r.settings},updateSettings:a=>{t(r=>({settings:{...r.settings,...a},lastFetched:Date.now()}))},refreshSettings:async()=>(t({lastFetched:null}),s().fetchSettings(!0)),clearCache:()=>{t({lastFetched:null})}}),{name:"school-settings-storage",partialize:t=>({settings:t.settings,lastFetched:t.lastFetched})}));function Ph(){const{settings:t,loading:s,fetchSettings:a,refreshSettings:r,updateSettings:l}=x4();return h.useEffect(()=>{a(!0)},[]),{settings:t,loading:s,refreshSettings:r,updateSettings:l}}function XE(){const{settings:t}=Ph();return h.useEffect(()=>{if(t.school_logo){const a=t.school_logo.startsWith("http")?t.school_logo:`${ee.replace("/backend/api","")}${t.school_logo}`;let r=document.querySelector("link[rel='icon']");r||(r=document.createElement("link"),r.rel="icon",document.head.appendChild(r)),r.type="image/png",r.href=a;let l=document.querySelector("link[rel='apple-touch-icon']");l||(l=document.createElement("link"),l.rel="apple-touch-icon",document.head.appendChild(l)),l.href=a}if(t.school_name){document.title=`${t.school_name} - School Management System`;let a=document.querySelector("meta[name='apple-mobile-web-app-title']");a&&(a.content=t.school_name);let r=document.querySelector("meta[name='description']");r&&(r.content=`${t.school_name} - ${t.school_tagline||"School Management System"}`)}if(t.primary_color){let a=document.querySelector("meta[name='theme-color']");a&&(a.content=t.primary_color)}let s=document.querySelector("link[rel='manifest']");if(s){const a=`${ee}/manifest.php?v=${Date.now()}`;s.href=a}},[t.school_logo,t.school_name,t.school_tagline,t.primary_color]),null}function ON({onClose:t}){const[s,a]=h.useState(!1),[r,l]=h.useState(""),[c,o]=h.useState(""),[m,u]=h.useState(null),[x,A]=h.useState(!1),g=h.useRef(null),N=la(),{user:f}=Us(),v=`/${f?.user_type||"admin"}`,U=[{patterns:["go to dashboard","open dashboard","show dashboard","dashboard"],action:()=>N(`${v}/dashboard`),response:"Opening dashboard",icon:Lh,category:"Navigation"},{patterns:["go to students","show students","open students","students list"],action:()=>N(`${v}/students`),response:"Opening students",icon:Rt,category:"Navigation"},{patterns:["go to teachers","show teachers","open teachers","teachers list"],action:()=>N(`${v}/teachers`),response:"Opening teachers",icon:Rt,category:"Navigation"},{patterns:["go to classes","show classes","open classes","class list"],action:()=>N(`${v}/classes`),response:"Opening classes",icon:as,category:"Navigation"},{patterns:["go to finance","show finance","open finance","payments","fees"],action:()=>N(`${v}/finance`),response:"Opening finance",icon:vs,category:"Navigation"},{patterns:["go to attendance","show attendance","open attendance","attendance"],action:()=>N(`${v}/attendance`),response:"Opening attendance",icon:Ot,category:"Navigation"},{patterns:["go to messages","show messages","open messages","inbox"],action:()=>N(`${v}/messages`),response:"Opening messages",icon:wa,category:"Navigation"},{patterns:["go to settings","show settings","open settings","preferences"],action:()=>N(`${v}/settings`),response:"Opening settings",icon:Ka,category:"Navigation"},{patterns:["go to help","show help","open help","help center","help me"],action:()=>N(`${v}/help`),response:"Opening help center",icon:Ac,category:"Navigation"},{patterns:["go to reports","show reports","open reports","analytics"],action:()=>N(`${v}/reports`),response:"Opening reports",icon:as,category:"Navigation"},{patterns:["search for *","find *","look for *"],action:z=>{const R=document.querySelector('input[type="search"], input[placeholder*="Search"]');R&&(R.value=z,R.dispatchEvent(new Event("input",{bubbles:!0})),R.focus())},response:z=>`Searching for ${z}`,icon:Ws,category:"Search"},{patterns:["log out","logout","sign out"],action:()=>{confirm("Are you sure you want to log out?")&&N("/login")},response:"Logging out",icon:_u,category:"Actions"},{patterns:["refresh","reload page","reload"],action:()=>window.location.reload(),response:"Refreshing page",icon:_u,category:"Actions"},{patterns:["go back","back","previous page"],action:()=>N(-1),response:"Going back",icon:_u,category:"Actions"},{patterns:["what time is it","current time","time"],action:()=>{},response:()=>`The current time is ${new Date().toLocaleTimeString()}`,icon:_u,category:"Info"},{patterns:["what day is it","today","date"],action:()=>{},response:()=>`Today is ${new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}`,icon:_u,category:"Info"}];h.useEffect(()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const z=window.SpeechRecognition||window.webkitSpeechRecognition;g.current=new z,g.current.continuous=!1,g.current.interimResults=!0,g.current.lang="en-US",g.current.onresult=R=>{const j=R.resultIndex,T=R.results[j],Q=T[0].transcript.toLowerCase().trim();l(Q),T.isFinal&&D(Q)},g.current.onerror=R=>{console.error("Speech recognition error:",R.error),a(!1),o("Error: "+R.error)},g.current.onend=()=>{a(!1)}}return()=>{g.current&&g.current.abort()}},[]);const D=h.useCallback(z=>{A(!0);for(const R of U)for(const j of R.patterns)if(j.includes("*")){const T=new RegExp("^"+j.replace("*","(.+)")+"$","i"),Q=z.match(T);if(Q){const E=Q[1];u(R);const te=typeof R.response=="function"?R.response(E):R.response;o(te),M(te),setTimeout(()=>{R.action(E),A(!1),t&&setTimeout(t,1e3)},1e3);return}}else if(z.includes(j)||j.includes(z)){u(R);const T=typeof R.response=="function"?R.response():R.response;o(T),M(T),setTimeout(()=>{R.action(),A(!1),t&&setTimeout(t,1e3)},1e3);return}o("I didn't understand that command. Try saying 'go to dashboard' or 'show students'."),M("I didn't understand that command."),A(!1)},[U,N,t]),M=z=>{if("speechSynthesis"in window){const R=new SpeechSynthesisUtterance(z);R.rate=1,R.pitch=1,window.speechSynthesis.speak(R)}},K=()=>{g.current&&(l(""),o(""),u(null),g.current.start(),a(!0))},$=()=>{g.current&&(g.current.stop(),a(!1))},P=()=>{s?$():K()},se=U.reduce((z,R)=>(z[R.category]||(z[R.category]=[]),z[R.category].push(R),z),{});return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden",children:[e.jsx("div",{className:"p-6 bg-gradient-to-r from-blue-600 to-purple-600 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-white/20 rounded-xl",children:e.jsx(_u,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:"Voice Commands"}),e.jsx("p",{className:"text-sm text-white/80",children:"Speak to navigate or perform actions"})]})]}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:e.jsx(Nt,{className:"w-5 h-5"})})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.jsx("button",{onClick:P,className:`w-24 h-24 rounded-full flex items-center justify-center transition-all ${s?"bg-red-500 animate-pulse shadow-lg shadow-red-500/50":"bg-gradient-to-r from-blue-500 to-purple-500 hover:shadow-lg hover:scale-105"}`,children:x?e.jsx(hs,{className:"w-10 h-10 text-white animate-spin"}):s?e.jsx(I1,{className:"w-10 h-10 text-white"}):e.jsx(Nh,{className:"w-10 h-10 text-white"})}),e.jsx("p",{className:"mt-3 text-sm text-gray-500 dark:text-gray-400",children:s?"Listening... Tap to stop":"Tap to start speaking"})]}),r&&e.jsxs("div",{className:"mb-4 p-4 bg-gray-100 dark:bg-gray-700 rounded-xl",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"You said:"}),e.jsxs("p",{className:"text-lg font-medium text-gray-900 dark:text-white",children:['"',r,'"']})]}),c&&e.jsx("div",{className:`mb-4 p-4 rounded-xl ${m?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":"bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[m&&e.jsx(m.icon,{className:"w-5 h-5"}),e.jsx("p",{className:"font-medium",children:c})]})}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3",children:"Available Commands"}),e.jsx("div",{className:"space-y-4 max-h-60 overflow-y-auto",children:Object.entries(se).map(([z,R])=>e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-400 dark:text-gray-500 mb-2",children:z}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:R.slice(0,4).map((j,T)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 dark:bg-gray-700/50 rounded-lg text-sm",children:[e.jsx(j.icon,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"text-gray-700 dark:text-gray-300 truncate",children:['"',j.patterns[0],'"']})]},T))})]},z))})]})]}),e.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-800/50 border-t border-gray-200 dark:border-gray-700",children:e.jsx("p",{className:"text-xs text-center text-gray-500 dark:text-gray-400",children:' Tip: Say "go to [page name]" to navigate, or "search for [query]" to search'})})]})})}function JE({variant:t="floating"}){const[s,a]=h.useState(!1),[r,l]=h.useState(!1);return h.useEffect(()=>{l("webkitSpeechRecognition"in window||"SpeechRecognition"in window)},[]),h.useEffect(()=>{const c=o=>{o.ctrlKey&&o.shiftKey&&o.key==="V"&&(o.preventDefault(),a(!0))};return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[]),r?t==="navbar"?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>a(!0),className:"p-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",title:"Voice Commands (Ctrl+Shift+V)",children:e.jsx(Nh,{className:"w-5 h-5"})}),s&&e.jsx(ON,{onClose:()=>a(!1)})]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>a(!0),className:"fixed bottom-36 right-6 w-12 h-12 bg-gradient-to-r from-blue-600 to-purple-600 rounded-full shadow-lg flex items-center justify-center text-white hover:scale-110 transition-transform z-40 group",title:"Voice Commands (Ctrl+Shift+V)",children:[e.jsx(Nh,{className:"w-5 h-5"}),e.jsx("span",{className:"absolute right-full mr-3 bg-gray-900 text-white text-xs px-2 py-1 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",children:"Voice Commands"})]}),s&&e.jsx(ON,{onClose:()=>a(!1)})]}):null}const h4=F.create({baseURL:ee,headers:{"Content-Type":"application/json"},withCredentials:!0});h4.interceptors.request.use(t=>{const s=localStorage.getItem("token");return s&&(t.headers.Authorization=`Bearer ${s}`),t},t=>Promise.reject(t));h4.interceptors.response.use(t=>t,t=>(t.response?.status===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(t)));const ZE={login:t=>F.post(`${ee}/auth.php`,t),register:t=>F.post(`${ee}/auth.php?action=register`,t),logout:()=>F.post(`${ee}/auth.php?action=logout`),me:()=>F.get(`${ee}/auth.php?action=me`)},Ch={getAll:t=>F.get(`${ee}/students.php`,{params:t}),getById:t=>F.get(`${ee}/students.php?id=${t}`),create:t=>F.post(`${ee}/students.php`,t),update:(t,s)=>F.put(`${ee}/students.php?id=${t}`,s),delete:t=>F.delete(`${ee}/students.php?id=${t}`),uploadPhoto:t=>F.post(`${ee}/upload_photo.php`,t,{headers:{"Content-Type":"multipart/form-data"}})},MA={getAll:t=>F.get(`${ee}/applications.php`,{params:t}),getById:t=>F.get(`${ee}/applications.php?id=${t}`),create:t=>F.post(`${ee}/applications.php`,t),approve:(t,s)=>F.post(`${ee}/applications.php?id=${t}&action=approve`,s),reject:(t,s)=>F.post(`${ee}/applications.php?id=${t}&action=reject`,s)},Bi={getAll:t=>F.get(`${ee}/classes.php`,{params:t}),getById:t=>F.get(`${ee}/classes.php?id=${t}`),create:t=>F.post(`${ee}/classes.php`,t),update:(t,s)=>F.put(`${ee}/classes.php?id=${t}`,s),delete:t=>F.delete(`${ee}/classes.php?id=${t}`)},Ud={getAll:()=>F.get(`${ee}/subjects.php`),getById:t=>F.get(`${ee}/subjects.php?id=${t}`),create:t=>F.post(`${ee}/subjects.php`,t),update:(t,s)=>F.put(`${ee}/subjects.php?id=${t}`,s),delete:t=>F.delete(`${ee}/subjects.php?id=${t}`)},yl={getAll:()=>F.get(`${ee}/terms.php`),getById:t=>F.get(`${ee}/terms.php?id=${t}`),create:t=>F.post(`${ee}/terms.php`,t),update:(t,s)=>F.put(`${ee}/terms.php?id=${t}`,s),delete:t=>F.delete(`${ee}/terms.php?id=${t}`),activate:t=>F.post(`${ee}/terms.php?id=${t}&action=activate`)},Pp={getAll:()=>F.get(`${ee}/teachers.php`),getById:t=>F.get(`${ee}/teachers.php?id=${t}`),create:t=>F.post(`${ee}/teachers.php`,t),update:(t,s)=>F.put(`${ee}/teachers.php?id=${t}`,s),delete:t=>F.delete(`${ee}/teachers.php?id=${t}`)},Op={getAll:()=>F.get(`${ee}/fee_groups.php`),getById:t=>F.get(`${ee}/fee_groups.php?id=${t}`),create:t=>F.post(`${ee}/fee_groups.php`,t),update:(t,s)=>F.put(`${ee}/fee_groups.php?id=${t}`,s),delete:t=>F.delete(`${ee}/fee_groups.php?id=${t}`)},ah={getAll:()=>F.get(`${ee}/fee_items.php`),getById:t=>F.get(`${ee}/fee_items.php?id=${t}`),create:t=>F.post(`${ee}/fee_items.php`,t),update:(t,s)=>F.put(`${ee}/fee_items.php?id=${t}`,s),delete:t=>F.delete(`${ee}/fee_items.php?id=${t}`)},jr={getDashboardStats:()=>F.get(`${ee}/finance.php?resource=dashboard`),getFeeRules:()=>F.get(`${ee}/finance.php?resource=fee_rules`),getFeeRuleById:t=>F.get(`${ee}/finance.php?resource=fee_rules&id=${t}`),createFeeRule:t=>F.post(`${ee}/finance.php?resource=fee_rules`,t),updateFeeRule:(t,s)=>F.put(`${ee}/finance.php?resource=fee_rules&id=${t}`,s),deleteFeeRule:t=>F.delete(`${ee}/finance.php?resource=fee_rules&id=${t}`),getInstallmentPlans:()=>F.get(`${ee}/finance.php?resource=installment_plans`),getInstallmentPlanById:t=>F.get(`${ee}/finance.php?resource=installment_plans&id=${t}`),createInstallmentPlan:t=>F.post(`${ee}/finance.php?resource=installment_plans`,t),updateInstallmentPlan:(t,s)=>F.put(`${ee}/finance.php?resource=installment_plans&id=${t}`,s),deleteInstallmentPlan:t=>F.delete(`${ee}/finance.php?resource=installment_plans&id=${t}`),getInvoices:t=>F.get(`${ee}/finance.php?resource=invoices`,{params:t}),getInvoiceById:t=>F.get(`${ee}/finance.php?resource=invoices&id=${t}`),getInvoiceStats:()=>F.get(`${ee}/finance.php?resource=invoices&action=stats`),createInvoice:t=>F.post(`${ee}/finance.php?resource=invoices`,t),approveInvoice:(t,s)=>F.post(`${ee}/finance.php?resource=invoices&id=${t}&action=approve`,s),rejectInvoice:(t,s)=>F.post(`${ee}/finance.php?resource=invoices&id=${t}&action=reject`,s),getPayments:()=>F.get(`${ee}/finance.php?resource=payments`),getPaymentById:t=>F.get(`${ee}/finance.php?resource=payments&id=${t}`),createPayment:t=>F.post(`${ee}/finance.php?resource=payments`,t)};function e7(){const t=la(),s=Us(A=>A.login),{settings:a}=Ph(),[r,l]=h.useState({email:"",password:""}),[c,o]=h.useState(""),[m,u]=h.useState(!1),x=async A=>{A.preventDefault(),o(""),u(!0);try{const g=await ZE.login(r),{user:N,token:f}=g.data;switch(s(N,f),N.user_type){case"super_admin":case"admin":t("/admin/dashboard");break;case"parent":t("/parent/dashboard");break;case"teacher":t("/teacher/dashboard");break;case"finance":t("/finance/dashboard");break;default:t("/admin/dashboard")}}catch(g){o(g.response?.data?.message||"Login failed. Please check your credentials.")}finally{u(!1)}};return e.jsxs("div",{className:"min-h-screen flex",children:[e.jsxs("div",{className:"hidden lg:flex lg:w-[60%] relative bg-gradient-to-br from-blue-600 via-purple-600 to-indigo-700 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}})}),e.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[e.jsx("div",{className:"absolute top-20 left-20 w-72 h-72 bg-white/10 rounded-full blur-3xl animate-pulse"}),e.jsx("div",{className:"absolute bottom-20 right-20 w-96 h-96 bg-purple-300/10 rounded-full blur-3xl animate-pulse",style:{animationDelay:"1s"}}),e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-blue-300/10 rounded-full blur-3xl animate-pulse",style:{animationDelay:"2s"}})]}),e.jsx("div",{className:"relative z-10 flex flex-col items-center justify-center w-full px-12 text-white",children:e.jsxs("div",{className:"text-center space-y-6 animate-fade-in",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-24 h-24 bg-white/20 backdrop-blur-lg rounded-full mb-6 animate-bounce-slow",children:e.jsx(Qs,{className:"w-14 h-14 text-white"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-6xl font-bold animate-slide-up",children:"Welcome to"}),e.jsx("h2",{className:"text-5xl font-extrabold bg-gradient-to-r from-yellow-200 via-pink-200 to-purple-200 bg-clip-text text-transparent animate-slide-up",style:{animationDelay:"0.2s"},children:a.school_name}),e.jsxs("div",{className:"flex items-center justify-center gap-2 animate-slide-up",style:{animationDelay:"0.4s"},children:[e.jsx(cl,{className:"w-6 h-6 text-yellow-300 animate-pulse"}),e.jsx("p",{className:"text-2xl font-light text-blue-100",children:a.school_tagline}),e.jsx(cl,{className:"w-6 h-6 text-yellow-300 animate-pulse"})]})]}),e.jsxs("div",{className:"mt-12 grid grid-cols-2 gap-6 max-w-2xl animate-slide-up",style:{animationDelay:"0.6s"},children:[e.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-xl p-6 hover:bg-white/20 transition-all duration-300 hover:scale-105",children:[e.jsx("div",{className:"text-3xl mb-2",children:""}),e.jsx("h3",{className:"font-semibold text-lg mb-1",children:"Smart Learning"}),e.jsx("p",{className:"text-sm text-blue-100",children:"AI-powered education platform"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-xl p-6 hover:bg-white/20 transition-all duration-300 hover:scale-105",children:[e.jsx("div",{className:"text-3xl mb-2",children:""}),e.jsx("h3",{className:"font-semibold text-lg mb-1",children:"Analytics"}),e.jsx("p",{className:"text-sm text-blue-100",children:"Real-time insights & reports"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-xl p-6 hover:bg-white/20 transition-all duration-300 hover:scale-105",children:[e.jsx("div",{className:"text-3xl mb-2",children:""}),e.jsx("h3",{className:"font-semibold text-lg mb-1",children:"Transport"}),e.jsx("p",{className:"text-sm text-blue-100",children:"GPS tracking & management"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-xl p-6 hover:bg-white/20 transition-all duration-300 hover:scale-105",children:[e.jsx("div",{className:"text-3xl mb-2",children:""}),e.jsx("h3",{className:"font-semibold text-lg mb-1",children:"AI Features"}),e.jsx("p",{className:"text-sm text-blue-100",children:"Intelligent automation"})]})]}),e.jsx("p",{className:"text-xl text-blue-100 mt-8 animate-slide-up",style:{animationDelay:"0.8s"},children:"Ghana Schools - GES & Cambridge Curriculum"})]})})]}),e.jsx("div",{className:"w-full lg:w-[40%] flex items-center justify-center p-8 bg-gray-50",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"lg:hidden text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-blue-600 to-purple-600 rounded-full mb-4",children:e.jsx(Qs,{className:"w-10 h-10 text-white"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:a.school_name})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 border border-gray-100",children:[e.jsxs("div",{className:"flex justify-center mb-6",children:[a.school_logo?e.jsx("img",{src:a.school_logo,alt:a.school_name,className:"h-20 w-20 object-contain rounded-xl",onError:A=>{A.target.style.display="none",A.target.nextElementSibling.style.display="flex"}}):null,e.jsx("div",{className:`${a.school_logo?"hidden":"flex"} items-center justify-center w-20 h-20 bg-gradient-to-br from-blue-600 to-purple-600 rounded-xl`,children:e.jsx(Qs,{className:"w-12 h-12 text-white"})})]}),e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Welcome Back"}),e.jsx("p",{className:"text-gray-600",children:"Sign in to continue to your dashboard"})]}),c&&e.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3",children:[e.jsx(ka,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-red-700",children:c})]}),e.jsxs("form",{onSubmit:x,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(ra,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"email",required:!0,className:"w-full pl-11 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"admin@school.com",value:r.email,onChange:A=>l({...r,email:A.target.value})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ui,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"password",required:!0,className:"w-full pl-11 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"",value:r.password,onChange:A=>l({...r,password:A.target.value})})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Remember me"})]}),e.jsx(dn,{to:"/forgot-password",className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Forgot password?"})]}),e.jsx("button",{type:"submit",disabled:m,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 rounded-lg font-semibold text-lg hover:from-blue-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 transform hover:scale-[1.02]",children:m?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing in..."]}):"Sign In"})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Don't have an account?"," ",e.jsx(dn,{to:"/register",className:"text-blue-600 hover:text-blue-700 font-semibold",children:"Register here"})]})})]}),e.jsx("div",{className:"mt-8 text-center text-gray-500 text-sm",children:e.jsxs("p",{children:[" 2025 ",a.school_name,". All rights reserved."]})})]})}),e.jsx("style",{children:`
        @keyframes fade-in {
          from {
            opacity: 0;
          }
          to {
            opacity: 1;
          }
        }

        @keyframes slide-up {
          from {
            opacity: 0;
            transform: translateY(30px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @keyframes bounce-slow {
          0%, 100% {
            transform: translateY(0);
          }
          50% {
            transform: translateY(-20px);
          }
        }

        .animate-fade-in {
          animation: fade-in 1s ease-out;
        }

        .animate-slide-up {
          animation: slide-up 0.8s ease-out forwards;
          opacity: 0;
        }

        .animate-bounce-slow {
          animation: bounce-slow 3s ease-in-out infinite;
        }
      `})]})}function t7(){la();const{settings:t}=Ph(),[s,a]=h.useState(!1),[r,l]=h.useState(!1),[c,o]=h.useState({name:"",email:"",phone:"",password:"",confirmPassword:""}),[m,u]=h.useState(""),x=async A=>{if(A.preventDefault(),u(""),c.password!==c.confirmPassword){u("Passwords do not match");return}if(c.password.length<6){u("Password must be at least 6 characters");return}try{a(!0),console.log("Submitting registration...",c);const g=await F.post(`${ee}/auth.php?action=register`,{name:c.name,email:c.email,phone:c.phone,password:c.password});console.log("Registration response:",g.data),g.data.success?l(!0):u("Registration failed. Please try again.")}catch(g){console.error("Registration error:",g),console.error("Error response:",g.response?.data);let N="Registration failed. Please try again.";g.response?.data&&((typeof g.response.data=="string"?g.response.data:JSON.stringify(g.response.data)).includes("Email already exists")?N="This email is already registered. Please use a different email or try logging in.":g.response.data.error&&(N=g.response.data.error)),u(N)}finally{a(!1)}};return r?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-green-600 to-emerald-700 p-4",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4 animate-bounce",children:e.jsx(Mt,{className:"w-12 h-12 text-green-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Registration Successful!"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Your account has been created and is pending approval from an administrator. You will receive an email once your account is approved."}),e.jsx(dn,{to:"/login",className:"w-full bg-gradient-to-r from-green-600 to-emerald-600 text-white py-3 rounded-lg font-semibold hover:from-green-700 hover:to-emerald-700 transition-all duration-200 inline-block",children:"Go to Login"})]})})}):e.jsxs("div",{className:"min-h-screen flex",children:[e.jsxs("div",{className:"hidden lg:flex lg:w-[60%] relative bg-gradient-to-br from-emerald-600 via-teal-600 to-cyan-700 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}})}),e.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[e.jsx("div",{className:"absolute top-20 left-20 w-72 h-72 bg-white/10 rounded-full blur-3xl animate-pulse"}),e.jsx("div",{className:"absolute bottom-20 right-20 w-96 h-96 bg-teal-300/10 rounded-full blur-3xl animate-pulse",style:{animationDelay:"1s"}}),e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-cyan-300/10 rounded-full blur-3xl animate-pulse",style:{animationDelay:"2s"}})]}),e.jsx("div",{className:"relative z-10 flex flex-col items-center justify-center w-full px-12 text-white",children:e.jsxs("div",{className:"text-center space-y-6 animate-fade-in",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-24 h-24 bg-white/20 backdrop-blur-lg rounded-full mb-6 animate-bounce-slow",children:e.jsx(Rt,{className:"w-14 h-14 text-white"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-6xl font-bold animate-slide-up",children:"Join"}),e.jsx("h2",{className:"text-5xl font-extrabold bg-gradient-to-r from-yellow-200 via-green-200 to-cyan-200 bg-clip-text text-transparent animate-slide-up",style:{animationDelay:"0.2s"},children:t.school_name}),e.jsxs("div",{className:"flex items-center justify-center gap-2 animate-slide-up",style:{animationDelay:"0.4s"},children:[e.jsx(cl,{className:"w-6 h-6 text-yellow-300 animate-pulse"}),e.jsx("p",{className:"text-2xl font-light text-emerald-100",children:t.school_tagline}),e.jsx(cl,{className:"w-6 h-6 text-yellow-300 animate-pulse"})]})]}),e.jsxs("div",{className:"mt-12 space-y-4 max-w-lg animate-slide-up",style:{animationDelay:"0.6s"},children:[e.jsx("div",{className:"bg-white/10 backdrop-blur-md rounded-xl p-6 hover:bg-white/20 transition-all duration-300 hover:scale-105",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center",children:e.jsx(as,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Access Learning Resources"}),e.jsx("p",{className:"text-sm text-emerald-100",children:"Complete course materials and assignments"})]})]})}),e.jsx("div",{className:"bg-white/10 backdrop-blur-md rounded-xl p-6 hover:bg-white/20 transition-all duration-300 hover:scale-105",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center",children:e.jsx(Is,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Track Your Progress"}),e.jsx("p",{className:"text-sm text-emerald-100",children:"Monitor grades, attendance, and achievements"})]})]})}),e.jsx("div",{className:"bg-white/10 backdrop-blur-md rounded-xl p-6 hover:bg-white/20 transition-all duration-300 hover:scale-105",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center",children:e.jsx(Rt,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Connect with Community"}),e.jsx("p",{className:"text-sm text-emerald-100",children:"Engage with teachers, students, and parents"})]})]})})]}),e.jsx("p",{className:"text-xl text-emerald-100 mt-8 animate-slide-up",style:{animationDelay:"0.8s"},children:"Empowering Education in Ghana"})]})})]}),e.jsx("div",{className:"w-full lg:w-[40%] flex items-center justify-center p-8 bg-gray-50",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"lg:hidden text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-emerald-600 to-teal-600 rounded-full mb-4",children:e.jsx(Qs,{className:"w-10 h-10 text-white"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t.school_name})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 border border-gray-100",children:[e.jsxs("div",{className:"flex justify-center mb-6",children:[t.school_logo?e.jsx("img",{src:t.school_logo,alt:t.school_name,className:"h-20 w-20 object-contain rounded-xl",onError:A=>{A.target.style.display="none",A.target.nextElementSibling.style.display="flex"}}):null,e.jsx("div",{className:`${t.school_logo?"hidden":"flex"} items-center justify-center w-20 h-20 bg-gradient-to-br from-emerald-600 to-teal-600 rounded-xl`,children:e.jsx(Qs,{className:"w-12 h-12 text-white"})})]}),e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Create Account"}),e.jsx("p",{className:"text-gray-600",children:"Register to access the system"})]}),m&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3",children:e.jsx("div",{className:"text-red-600 text-sm",children:m})}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Full Name *"}),e.jsxs("div",{className:"relative",children:[e.jsx(ha,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",required:!0,value:c.name,onChange:A=>o({...c,name:A.target.value}),className:"w-full pl-11 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all duration-200",placeholder:"Enter your full name"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Email Address *"}),e.jsxs("div",{className:"relative",children:[e.jsx(ra,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"email",required:!0,value:c.email,onChange:A=>o({...c,email:A.target.value}),className:"w-full pl-11 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all duration-200",placeholder:"your.email@example.com"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Phone Number *"}),e.jsxs("div",{className:"relative",children:[e.jsx(er,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"tel",required:!0,value:c.phone,onChange:A=>o({...c,phone:A.target.value}),className:"w-full pl-11 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all duration-200",placeholder:"0244123456"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ui,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"password",required:!0,value:c.password,onChange:A=>o({...c,password:A.target.value}),className:"w-full pl-11 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all duration-200",placeholder:"Minimum 6 characters"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Confirm Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ui,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"password",required:!0,value:c.confirmPassword,onChange:A=>o({...c,confirmPassword:A.target.value}),className:"w-full pl-11 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all duration-200",placeholder:"Re-enter password"})]})]}),e.jsx("button",{type:"submit",disabled:s,className:"w-full bg-gradient-to-r from-emerald-600 to-teal-600 text-white py-3 rounded-lg font-semibold text-lg hover:from-emerald-700 hover:to-teal-700 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 transform hover:scale-[1.02]",children:s?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating Account..."]}):"Create Account"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",e.jsx(dn,{to:"/login",className:"text-emerald-600 hover:text-emerald-700 font-semibold",children:"Sign In"})]})})]}),e.jsx("div",{className:"mt-8 text-center text-gray-500 text-sm",children:e.jsxs("p",{children:[" 2025 ",t.school_name,". All rights reserved."]})})]})}),e.jsx("style",{children:`
        @keyframes fade-in {
          from {
            opacity: 0;
          }
          to {
            opacity: 1;
          }
        }

        @keyframes slide-up {
          from {
            opacity: 0;
            transform: translateY(30px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @keyframes bounce-slow {
          0%, 100% {
            transform: translateY(0);
          }
          50% {
            transform: translateY(-20px);
          }
        }

        .animate-fade-in {
          animation: fade-in 1s ease-out;
        }

        .animate-slide-up {
          animation: slide-up 0.8s ease-out forwards;
          opacity: 0;
        }

        .animate-bounce-slow {
          animation: bounce-slow 3s ease-in-out infinite;
        }
      `})]})}function s7(){const{settings:t}=Ph(),[s,a]=h.useState(""),[r,l]=h.useState(!1),[c,o]=h.useState(!1),[m,u]=h.useState(""),x=async A=>{A.preventDefault(),u(""),l(!0);try{const g=await F.post("https://eea.mcaforo.com/backend/api/auth.php?action=forgot_password",{email:s});g.data.success?o(!0):u(g.data.message||"Failed to send reset link. Please try again.")}catch{u("An error occurred. Please try again later.")}finally{l(!1)}};return c?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-orange-600 to-red-700 p-4",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4 animate-bounce",children:e.jsx(Mt,{className:"w-12 h-12 text-green-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Check Your Email!"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["We've sent a password reset link to ",e.jsx("strong",{children:s}),". Please check your inbox and follow the instructions to reset your password."]}),e.jsx(dn,{to:"/login",className:"w-full bg-gradient-to-r from-orange-600 to-red-600 text-white py-3 rounded-lg font-semibold hover:from-orange-700 hover:to-red-700 transition-all duration-200 inline-block",children:"Back to Login"})]})})}):e.jsxs("div",{className:"min-h-screen flex",children:[e.jsxs("div",{className:"hidden lg:flex lg:w-[60%] relative bg-gradient-to-br from-orange-600 via-red-600 to-pink-700 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}})}),e.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[e.jsx("div",{className:"absolute top-20 left-20 w-72 h-72 bg-white/10 rounded-full blur-3xl animate-pulse"}),e.jsx("div",{className:"absolute bottom-20 right-20 w-96 h-96 bg-pink-300/10 rounded-full blur-3xl animate-pulse",style:{animationDelay:"1s"}}),e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-red-300/10 rounded-full blur-3xl animate-pulse",style:{animationDelay:"2s"}})]}),e.jsx("div",{className:"relative z-10 flex flex-col items-center justify-center w-full px-12 text-white",children:e.jsxs("div",{className:"text-center space-y-6 animate-fade-in",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-24 h-24 bg-white/20 backdrop-blur-lg rounded-full mb-6 animate-bounce-slow",children:e.jsx($r,{className:"w-14 h-14 text-white"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-6xl font-bold animate-slide-up",children:t.school_name}),e.jsx("h2",{className:"text-5xl font-extrabold bg-gradient-to-r from-yellow-200 via-orange-200 to-pink-200 bg-clip-text text-transparent animate-slide-up",style:{animationDelay:"0.2s"},children:"Password Reset"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 animate-slide-up",style:{animationDelay:"0.4s"},children:[e.jsx(cl,{className:"w-6 h-6 text-yellow-300 animate-pulse"}),e.jsx("p",{className:"text-2xl font-light text-orange-100",children:t.school_tagline}),e.jsx(cl,{className:"w-6 h-6 text-yellow-300 animate-pulse"})]})]}),e.jsxs("div",{className:"mt-12 space-y-4 max-w-lg animate-slide-up",style:{animationDelay:"0.6s"},children:[e.jsx("div",{className:"bg-white/10 backdrop-blur-md rounded-xl p-6 hover:bg-white/20 transition-all duration-300 hover:scale-105",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center",children:e.jsx(ra,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Email Verification"}),e.jsx("p",{className:"text-sm text-orange-100",children:"Secure reset link sent to your inbox"})]})]})}),e.jsx("div",{className:"bg-white/10 backdrop-blur-md rounded-xl p-6 hover:bg-white/20 transition-all duration-300 hover:scale-105",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center",children:e.jsx(py,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"One-Time Link"}),e.jsx("p",{className:"text-sm text-orange-100",children:"Reset link expires after single use"})]})]})}),e.jsx("div",{className:"bg-white/10 backdrop-blur-md rounded-xl p-6 hover:bg-white/20 transition-all duration-300 hover:scale-105",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center",children:e.jsx(Ui,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Encrypted Process"}),e.jsx("p",{className:"text-sm text-orange-100",children:"Your data is protected end-to-end"})]})]})})]}),e.jsx("p",{className:"text-xl text-orange-100 mt-8 animate-slide-up",style:{animationDelay:"0.8s"},children:"Your Security is Our Priority"})]})})]}),e.jsx("div",{className:"w-full lg:w-[40%] flex items-center justify-center p-8 bg-gray-50",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"lg:hidden text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-orange-600 to-red-600 rounded-full mb-4",children:e.jsx(Qs,{className:"w-10 h-10 text-white"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t.school_name})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 border border-gray-100",children:[e.jsxs("div",{className:"flex justify-center mb-6",children:[t.school_logo?e.jsx("img",{src:t.school_logo,alt:t.school_name,className:"h-20 w-20 object-contain rounded-xl",onError:A=>{A.target.style.display="none",A.target.nextElementSibling.style.display="flex"}}):null,e.jsx("div",{className:`${t.school_logo?"hidden":"flex"} items-center justify-center w-20 h-20 bg-gradient-to-br from-orange-600 to-red-600 rounded-xl`,children:e.jsx(Qs,{className:"w-12 h-12 text-white"})})]}),e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Forgot Password?"}),e.jsx("p",{className:"text-gray-600",children:"No worries! Enter your email and we'll send you reset instructions."})]}),m&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-700",children:m})}),e.jsxs("form",{onSubmit:x,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(ra,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"email",required:!0,value:s,onChange:A=>a(A.target.value),className:"w-full pl-11 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all duration-200",placeholder:"your.email@example.com"})]})]}),e.jsx("button",{type:"submit",disabled:r,className:"w-full bg-gradient-to-r from-orange-600 to-red-600 text-white py-3 rounded-lg font-semibold text-lg hover:from-orange-700 hover:to-red-700 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 transform hover:scale-[1.02]",children:r?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Sending Reset Link..."]}):"Send Reset Link"})]}),e.jsx("div",{className:"mt-8",children:e.jsxs(dn,{to:"/login",className:"flex items-center justify-center gap-2 text-gray-600 hover:text-gray-900 font-medium transition-colors",children:[e.jsx(ol,{className:"w-4 h-4"}),"Back to Login"]})})]}),e.jsx("div",{className:"mt-8 text-center text-gray-500 text-sm",children:e.jsxs("p",{children:[" 2025 ",t.school_name,". All rights reserved."]})})]})}),e.jsx("style",{children:`
        @keyframes fade-in {
          from {
            opacity: 0;
          }
          to {
            opacity: 1;
          }
        }

        @keyframes slide-up {
          from {
            opacity: 0;
            transform: translateY(30px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @keyframes bounce-slow {
          0%, 100% {
            transform: translateY(0);
          }
          50% {
            transform: translateY(-20px);
          }
        }

        .animate-fade-in {
          animation: fade-in 1s ease-out;
        }

        .animate-slide-up {
          animation: slide-up 0.8s ease-out forwards;
          opacity: 0;
        }

        .animate-bounce-slow {
          animation: bounce-slow 3s ease-in-out infinite;
        }
      `})]})}function a7(){const[t]=ax(),s=t.get("token"),[a,r]=h.useState("loading"),[l,c]=h.useState(""),[o,m]=h.useState(""),[u,x]=h.useState(""),[A,g]=h.useState(!1),[N,f]=h.useState(!1);h.useEffect(()=>{s?y():(r("error"),c("No activation token provided."))},[s]);const y=async()=>{try{const U=await F.get(`${ee}/email_activation.php?action=verify&token=${s}`);if(!U.data.valid){U.data.already_activated?(r("already_activated"),c("This account has already been activated.")):U.data.expired?(r("expired"),c("This activation link has expired.")):(r("error"),c(U.data.error||"Invalid activation token."));return}m(U.data.user_name);const D=await F.post(`${ee}/email_activation.php?action=activate`,{token:s});D.data.success?(r("success"),c(D.data.message)):(r("error"),c(D.data.error||"Failed to activate account."))}catch(U){console.error("Activation error:",U),r("error"),c(U.response?.data?.error||"An error occurred during activation.")}},v=async U=>{if(U.preventDefault(),!!u){g(!0);try{await F.get(`${ee}/email_activation.php?action=resend&email=${encodeURIComponent(u)}`),f(!0)}catch{f(!0)}finally{g(!1)}}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"max-w-md w-full",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 text-center",children:[a==="loading"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(hs,{className:"w-10 h-10 text-blue-600 animate-spin"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Activating Your Account"}),e.jsx("p",{className:"text-gray-600",children:"Please wait while we verify your activation link..."})]}),a==="success"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(Mt,{className:"w-10 h-10 text-green-600"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Account Activated!"}),o&&e.jsxs("p",{className:"text-gray-600 mb-4",children:["Welcome, ",o,"!"]}),e.jsx("p",{className:"text-gray-600 mb-6",children:l}),e.jsxs(dn,{to:"/login",className:"inline-flex items-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors",children:["Go to Login ",e.jsx(Pl,{className:"w-5 h-5"})]})]}),a==="already_activated"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(Mt,{className:"w-10 h-10 text-blue-600"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Already Activated"}),e.jsx("p",{className:"text-gray-600 mb-6",children:l}),e.jsxs(dn,{to:"/login",className:"inline-flex items-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors",children:["Go to Login ",e.jsx(Pl,{className:"w-5 h-5"})]})]}),a==="expired"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-20 h-20 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(Js,{className:"w-10 h-10 text-orange-600"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Link Expired"}),e.jsx("p",{className:"text-gray-600 mb-6",children:l}),N?e.jsx("div",{className:"bg-green-50 text-green-700 p-4 rounded-lg",children:e.jsx("p",{children:"If this email is registered, a new activation link has been sent."})}):e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Enter your email to receive a new activation link:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"email",value:u,onChange:U=>x(U.target.value),placeholder:"Your email address",className:"flex-1 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0}),e.jsx("button",{type:"submit",disabled:A,className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-700 disabled:opacity-50",children:A?e.jsx(hs,{className:"w-5 h-5 animate-spin"}):e.jsx(ra,{className:"w-5 h-5"})})]})]})]}),a==="error"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(Js,{className:"w-10 h-10 text-red-600"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Activation Failed"}),e.jsx("p",{className:"text-gray-600 mb-6",children:l}),N?e.jsx("div",{className:"bg-green-50 text-green-700 p-4 rounded-lg mb-4",children:e.jsx("p",{children:"If this email is registered, a new activation link has been sent."})}):e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Need a new activation link?"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"email",value:u,onChange:U=>x(U.target.value),placeholder:"Your email address",className:"flex-1 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0}),e.jsx("button",{type:"submit",disabled:A,className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-700 disabled:opacity-50",children:A?e.jsx(hs,{className:"w-5 h-5 animate-spin"}):"Resend"})]})]}),e.jsx("div",{className:"mt-6 pt-6 border-t",children:e.jsx(dn,{to:"/login",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Back to Login"})})]})]})})})}function r7(){const t=di(),{user:s,logout:a}=Us(),{settings:r}=Ph(),[l,c]=h.useState({}),o=h.useMemo(()=>{if(r.school_abbreviation)return r.school_abbreviation.toUpperCase();const v=r.school_name;if(!v)return"McSMS";const U=v.split(" ").filter(D=>D.length>0);return U.length===1?v.substring(0,Math.min(5,v.length)).toUpperCase():U.slice(0,5).map(D=>D.charAt(0).toUpperCase()).join("")},[r.school_abbreviation,r.school_name]),m=[{id:"main",label:"Main",icon:Nm,items:[{icon:Nm,label:"Dashboard",path:"/admin/dashboard"}]},{id:"users",label:"User Management",icon:Rt,items:[{icon:Rt,label:"Users",path:"/admin/users"},{icon:$r,label:"Roles & Permissions",path:"/admin/roles"}]},{id:"academic",label:"Academic",icon:Qs,items:[{icon:Qs,label:"Students",path:"/admin/students"},{icon:Wc,label:"Admissions",path:"/admin/admissions"},{icon:Rt,label:"Teachers",path:"/admin/teachers"},{icon:il,label:"Classes",path:"/admin/classes"},{icon:as,label:"Class Curriculum",path:"/admin/class-subjects"},{icon:Qs,label:"Education Levels",path:"/admin/education-levels"},{icon:as,label:"Subjects",path:"/admin/subjects"},{icon:Ot,label:"Terms",path:"/admin/terms"},{icon:Wt,label:"Timetable",path:"/admin/timetable"},{icon:R1,label:"Exams",path:"/admin/exams"},{icon:al,label:"LMS",path:"/admin/lms"}]},{id:"classroom",label:"Classroom",icon:il,items:[{icon:Mt,label:"Attendance",path:"/admin/attendance"},{icon:Is,label:"Grading",path:"/admin/grading"},{icon:as,label:"Homework",path:"/admin/homework"}]},{id:"finance",label:"Finance",icon:vs,items:[{icon:vs,label:"Overview",path:"/admin/finance"},{icon:aa,label:"Fee Structure",path:"/admin/fee-structure"},{icon:Kt,label:"Invoices",path:"/admin/invoices"},{icon:vs,label:"Payments",path:"/admin/payments"}]},{id:"advanced",label:"Advanced Features",icon:Jr,items:[{icon:$s,label:"Reports & Analytics",path:"/admin/analytics"},{icon:Gl,label:"Predictive Analytics",path:"/admin/advanced-analytics"},{icon:Qo,label:"Transport",path:"/admin/transport"},{icon:Pr,label:"HR Management",path:"/admin/hr-management"},{icon:Dd,label:"Biometric",path:"/admin/biometric"},{icon:mn,label:"Multi-School",path:"/admin/multi-school"},{icon:Jr,label:"AI Features",path:"/admin/ai-features"},{icon:Oo,label:"Alumni",path:"/admin/alumni"},{icon:al,label:"Video Conferencing",path:"/admin/video-conferencing"},{icon:fy,label:"Integrations",path:"/admin/integrations"}]},{id:"communication",label:"Communication",icon:wa,items:[{icon:wa,label:"Messages",path:"/admin/messages"},{icon:zu,label:"WhatsApp",path:"/admin/whatsapp"},{icon:er,label:"SMS",path:"/admin/sms"},{icon:ra,label:"Email",path:"/admin/email"}]},{id:"reports",label:"Reports & Data",icon:Fs,items:[{icon:Fs,label:"Reports",path:"/admin/reports"},{icon:qo,label:"Report Builder",path:"/admin/report-builder"},{icon:Hr,label:"Bulk Import",path:"/admin/import"},{icon:Ir,label:"System Logs",path:"/admin/logs"}]},{id:"system",label:"System",icon:ub,items:[{icon:$1,label:"System Configuration",path:"/admin/system-config"},{icon:Ns,label:"System Reset",path:"/admin/system-reset"},{icon:Ac,label:"Help Center",path:"/admin/help"}]}],u=[{id:"main",label:"Main",icon:Nm,items:[{icon:Nm,label:"Dashboard",path:"/teacher/dashboard"}]},{id:"teaching",label:"Teaching",icon:il,items:[{icon:il,label:"My Classes",path:"/teacher/classes"},{icon:Mt,label:"Attendance",path:"/teacher/attendance"},{icon:as,label:"Homework",path:"/teacher/homework"},{icon:Is,label:"Grading",path:"/teacher/grading"},{icon:Kt,label:"Student Reports",path:"/teacher/reports"},{icon:Ot,label:"Lesson Planning",path:"/teacher/lesson-planning"}]},{id:"students",label:"Student Tools",icon:Rt,items:[{icon:$s,label:"Progress Tracking",path:"/teacher/student-progress"},{icon:Oo,label:"Behavior Tracking",path:"/teacher/behavior"},{icon:Rt,label:"Seating Chart",path:"/teacher/seating"}]},{id:"resources",label:"Resources",icon:as,items:[{icon:as,label:"Resource Library",path:"/teacher/resources"},{icon:Wt,label:"Substitute Mode",path:"/teacher/substitute"}]},{id:"insights",label:"AI & Analytics",icon:Jr,items:[{icon:Jr,label:"AI Insights",path:"/teacher/ai-insights"}]},{id:"hr",label:"HR Portal",icon:Pr,items:[{icon:Pr,label:"HR Portal",path:"/teacher/hr-portal"}]},{id:"other",label:"Other",icon:Ka,items:[{icon:wa,label:"Messages",path:"/teacher/messages"},{icon:Ka,label:"Settings",path:"/teacher/settings"},{icon:Ac,label:"Help Center",path:"/teacher/help"}]}],x=[{id:"main",label:"Main",icon:Nm,items:[{icon:Nm,label:"Dashboard",path:"/parent/dashboard"}]},{id:"children",label:"My Children",icon:T1,items:[{icon:Ti,label:"Apply for Admission",path:"/parent/apply"},{icon:Mt,label:"Enroll for Term",path:"/parent/enroll"}]},{id:"academics",label:"Academics",icon:Qs,items:[{icon:as,label:"Homework",path:"/parent/homework"},{icon:Is,label:"Results & Performance",path:"/parent/results"}]},{id:"finance",label:"Finance",icon:vs,items:[{icon:Kt,label:"Invoices",path:"/parent/invoices"},{icon:vs,label:"Payments",path:"/parent/payments"}]},{id:"other",label:"Other",icon:Ka,items:[{icon:wa,label:"Messages",path:"/parent/messages"},{icon:Ka,label:"Settings",path:"/parent/settings"},{icon:Ac,label:"Help Center",path:"/parent/help"}]}],g=(()=>{switch(s?.user_type){case"admin":return m;case"teacher":return u;case"parent":return x;default:return m}})(),N=v=>t.pathname===v,f=v=>v.items.some(U=>t.pathname===U.path),y=v=>{c(U=>({...U,[v]:!U[v]}))};return h.useEffect(()=>{const v=g.find(U=>f(U));v&&!l[v.id]&&c(U=>({...U,[v.id]:!0}))},[t.pathname]),e.jsxs("div",{className:"w-64 bg-white border-r border-gray-200 h-screen flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[r.school_logo?e.jsx("img",{src:r.school_logo,alt:r.school_name,className:"w-10 h-10 object-contain rounded-lg",onError:v=>{v.target.style.display="none",v.target.nextElementSibling.style.display="flex"}}):null,e.jsx("div",{className:`w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center ${r.school_logo?"hidden":""}`,children:e.jsx(Qs,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold text-gray-900",children:o}),e.jsx("p",{className:"text-xs text-gray-500",children:r.school_tagline||"School Management"})]})]})}),e.jsx("nav",{className:"flex-1 overflow-y-auto p-4",children:e.jsx("div",{className:"space-y-1",children:g.map(v=>{const U=v.icon,D=l[v.id],M=f(v);if(v.items.length===1){const K=v.items[0],$=K.icon,P=N(K.path);return e.jsxs(dn,{to:K.path,className:`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${P?"bg-blue-50 text-blue-600":"text-gray-700 hover:bg-gray-50"}`,children:[e.jsx($,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:K.label})]},K.path)}return e.jsxs("div",{className:"mb-1",children:[e.jsxs("button",{onClick:()=>y(v.id),className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${M?"bg-blue-50 text-blue-600":"text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(U,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium flex-1 text-left",children:v.label}),D?e.jsx(un,{className:"w-4 h-4"}):e.jsx(cr,{className:"w-4 h-4"})]}),D&&e.jsx("div",{className:"ml-4 mt-1 space-y-1 border-l-2 border-gray-100 pl-2",children:v.items.map(K=>{const $=K.icon,P=N(K.path);return e.jsxs(dn,{to:K.path,className:`flex items-center gap-3 px-3 py-1.5 rounded-lg transition-colors text-sm ${P?"bg-blue-50 text-blue-600 font-medium":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,children:[e.jsx($,{className:"w-4 h-4"}),e.jsx("span",{className:"flex-1",children:K.label}),K.badge&&e.jsx("span",{className:`px-1.5 py-0.5 text-xs font-semibold rounded-full ${K.badge==="Danger"?"bg-red-500 text-white":"bg-gradient-to-r from-purple-500 to-blue-500 text-white"}`,children:K.badge})]},K.path)})})]},v.id)})})})]})}function n7({showLabel:t=!1,variant:s="icon"}){const{theme:a,setTheme:r,actualTheme:l}=dy(),[c,o]=h.useState(!1),m=[{id:"light",label:"Light",icon:mb,color:"text-yellow-500"},{id:"dark",label:"Dark",icon:ob,color:"text-blue-500"},{id:"system",label:"System",icon:km,color:"text-gray-500"}],u=m.find(A=>A.id===a)||m[0],x=u.icon;return s==="simple"?e.jsx("button",{onClick:()=>r(l==="dark"?"light":"dark"),className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:`Switch to ${l==="dark"?"light":"dark"} mode`,children:l==="dark"?e.jsx(mb,{className:"w-5 h-5 text-yellow-500"}):e.jsx(ob,{className:"w-5 h-5 text-gray-600"})}):e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>o(!c),className:"flex items-center gap-2 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[e.jsx(x,{className:`w-5 h-5 ${u.color}`}),t&&e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:u.label})]}),c&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>o(!1)}),e.jsx("div",{className:"absolute right-0 mt-2 w-40 bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 py-2 z-50",children:m.map(A=>{const g=A.icon;return e.jsxs("button",{onClick:()=>{r(A.id),o(!1)},className:`w-full flex items-center gap-3 px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors ${a===A.id?"bg-blue-50 dark:bg-blue-900/20":""}`,children:[e.jsx(g,{className:`w-4 h-4 ${A.color}`}),e.jsx("span",{className:`text-sm ${a===A.id?"font-medium text-blue-600 dark:text-blue-400":"text-gray-700 dark:text-gray-300"}`,children:A.label}),a===A.id&&e.jsx("span",{className:"ml-auto w-2 h-2 bg-blue-600 rounded-full"})]},A.id)})})]})]})}function l7({onResult:t,onClose:s,isOpen:a}){const[r,l]=h.useState(!1),[c,o]=h.useState(""),[m,u]=h.useState(""),[x,A]=h.useState(null);h.useEffect(()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const f=window.SpeechRecognition||window.webkitSpeechRecognition,y=new f;y.continuous=!1,y.interimResults=!0,y.lang="en-US",y.onstart=()=>{l(!0),u("")},y.onresult=v=>{const U=v.resultIndex,D=v.results[U],M=D[0].transcript;o(M),D.isFinal&&(t(M),l(!1))},y.onerror=v=>{u(`Error: ${v.error}`),l(!1)},y.onend=()=>{l(!1)},A(y)}else u("Speech recognition is not supported in this browser");return()=>{x&&x.stop()}},[]);const g=()=>{x&&(o(""),x.start())},N=()=>{x&&x.stop()};return a?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-8 max-w-md w-full text-center shadow-2xl",children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full",children:e.jsx(Nt,{className:"w-5 h-5 text-gray-500"})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Voice Search"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:r?"Listening...":"Click the microphone to start"})]}),e.jsx("button",{onClick:r?N:g,className:`w-24 h-24 rounded-full flex items-center justify-center mx-auto mb-6 transition-all ${r?"bg-red-500 animate-pulse scale-110":"bg-gradient-to-r from-blue-600 to-purple-600 hover:scale-105"}`,children:r?e.jsx(I1,{className:"w-10 h-10 text-white"}):e.jsx(Nh,{className:"w-10 h-10 text-white"})}),r&&e.jsx("div",{className:"flex justify-center gap-1 mb-4",children:[...Array(5)].map((f,y)=>e.jsx("div",{className:"w-1 bg-blue-600 rounded-full animate-pulse",style:{height:`${20+Math.random()*30}px`,animationDelay:`${y*100}ms`}},y))}),c&&e.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 rounded-xl p-4 mb-4",children:e.jsxs("p",{className:"text-gray-800 dark:text-gray-200 text-lg",children:['"',c,'"']})}),m&&e.jsx("p",{className:"text-red-500 text-sm",children:m}),e.jsxs("div",{className:"mt-6 text-sm text-gray-500 dark:text-gray-400",children:[e.jsx("p",{children:"Try saying:"}),e.jsx("div",{className:"flex flex-wrap justify-center gap-2 mt-2",children:["Search students","Show Class 6A","Find John Mensah","Open attendance"].map((f,y)=>e.jsxs("span",{className:"px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-xs",children:['"',f,'"']},y))})]})]})}):null}function i7({onResult:t}){const[s,a]=h.useState(!1),[r,l]=h.useState(!0);return h.useEffect(()=>{l("webkitSpeechRecognition"in window||"SpeechRecognition"in window)},[]),r?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>a(!0),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",title:"Voice Search",children:e.jsx(Nh,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})}),e.jsx(l7,{isOpen:s,onClose:()=>a(!1),onResult:c=>{t(c),a(!1)}})]}):null}function c7(){const{user:t,logout:s}=Us(),a=la();di();const[r,l]=h.useState(!1),[c,o]=h.useState(!1),[m,u]=h.useState(!1),[x,A]=h.useState(!1),[g,N]=h.useState(""),[f,y]=h.useState([]),[v,U]=h.useState(!1),[D,M]=h.useState([]),[K,$]=h.useState([]),[P,se]=h.useState(!1),[z,R]=h.useState(!1),j=h.useRef(null),T=h.useRef(null),Q=h.useRef(null),E=h.useRef(null);h.useEffect(()=>{t?.id&&(te(),C())},[t?.id]),h.useEffect(()=>{const w=oe=>{j.current&&!j.current.contains(oe.target)&&l(!1),T.current&&!T.current.contains(oe.target)&&o(!1),Q.current&&!Q.current.contains(oe.target)&&u(!1),E.current&&!E.current.contains(oe.target)&&A(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]);const te=async()=>{try{se(!0);const w=await F.get(`${ee}/notifications.php?user_id=${t.id}&limit=10`);M(w.data.notifications||[])}catch(w){console.error("Error fetching notifications:",w),M([])}finally{se(!1)}},C=async()=>{try{R(!0);let w=null;if(t?.user_type==="parent")try{const Xe=(await F.get(`${ee}/parents.php?user_id=${t.id}`)).data.parents||[];Xe.length>0&&(w=Xe[0].id)}catch{}const ne=(await F.get(`${ee}/messages.php?user_id=${t.id}&limit=10`)).data.messages||[],Fe=String(t.id),je=w?String(w):null,Ge=ne.filter(ze=>{const Xe=String(ze.recipient_id);return Xe===Fe||je&&Xe===je}).slice(0,5);$(Ge)}catch(w){console.error("Error fetching messages:",w),$([])}finally{R(!1)}},O=async w=>{console.log("Marking notification as read:",w);try{const oe=await F.put(`${ee}/notifications.php?id=${w}`,{is_read:!0});console.log("Mark as read response:",oe.data),M(ne=>ne.map(Fe=>String(Fe.id)===String(w)?{...Fe,is_read:!0}:Fe))}catch(oe){console.error("Error marking notification read:",oe)}},V=w=>!w.is_read&&w.is_read!==1&&w.is_read!=="1",re=D.filter(V).length,ge=K.filter(V).length,xe=()=>{s(),a("/login")},Z=async w=>{if(w.preventDefault(),g.trim()){U(!0),A(!0);try{const oe=await F.get(`${ee}/search.php?q=${encodeURIComponent(g)}&user_type=${t?.user_type}`);y(oe.data.results||[])}catch(oe){console.error("Search error:",oe),y([{type:"page",title:"Dashboard",path:`${k()}/dashboard`,icon:"dashboard"},{type:"page",title:"Settings",path:`${k()}/settings`,icon:"settings"}].filter(ne=>ne.title.toLowerCase().includes(g.toLowerCase())))}finally{U(!1)}}},I=w=>{const oe=w.target.value;if(N(oe),oe.length>=2){const ne=setTimeout(()=>Z({preventDefault:()=>{}}),300);return()=>clearTimeout(ne)}else A(!1),y([])},H=w=>{A(!1),N(""),w.path?a(w.path):w.type==="student"?a(`/admin/students/${w.id}`):w.type==="teacher"&&a(`/admin/teachers/${w.id}`)},ae=w=>{const oe={info:"bg-blue-100 text-blue-600",success:"bg-green-100 text-green-600",warning:"bg-orange-100 text-orange-600",error:"bg-red-100 text-red-600"};return oe[w]||oe.info},k=()=>t?.user_type==="admin"?"/admin":t?.user_type==="teacher"?"/teacher":t?.user_type==="parent"?"/parent":"/admin",B=w=>{if(!w)return"";const oe=new Date(w),Fe=Math.floor((new Date-oe)/1e3);return Fe<60?"Just now":Fe<3600?`${Math.floor(Fe/60)} min ago`:Fe<86400?`${Math.floor(Fe/3600)} hours ago`:Fe<604800?`${Math.floor(Fe/86400)} days ago`:oe.toLocaleDateString()};return e.jsxs("div",{className:"h-16 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 max-w-xl relative",ref:E,children:[e.jsxs("form",{onSubmit:Z,className:"relative flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",value:g,onChange:I,placeholder:"Search students, staff, pages...",className:"w-full pl-10 pr-10 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),g&&e.jsx("button",{type:"button",onClick:()=>{N(""),A(!1)},className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx(Nt,{className:"w-4 h-4"})})]}),e.jsx(i7,{onResult:w=>{N(w),Z({preventDefault:()=>{}})}})]}),x&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 z-50 max-h-96 overflow-y-auto",children:v?e.jsxs("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:[e.jsx(hs,{className:"w-5 h-5 animate-spin mx-auto mb-2"}),"Searching..."]}):f.length>0?e.jsx("div",{children:f.map((w,oe)=>e.jsxs("button",{onClick:()=>H(w),className:"w-full px-4 py-3 text-left hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center gap-3 border-b border-gray-100 dark:border-gray-700 last:border-0",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${w.type==="student"?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":w.type==="teacher"?"bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400":w.type==="page"?"bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:e.jsx(ha,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm text-gray-900 dark:text-white",children:w.title||w.name}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 capitalize",children:w.type})]})]},oe))}):e.jsxs("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400 text-sm",children:['No results found for "',g,'"']})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(JE,{variant:"navbar"}),e.jsx(dn,{to:`/${t?.user_type||"admin"}/help`,className:"p-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",title:"Help Center",children:e.jsx(Ac,{className:"w-5 h-5"})}),e.jsx(n7,{variant:"simple"}),e.jsxs("div",{className:"relative",ref:j,children:[e.jsxs("button",{onClick:()=>l(!r),className:"relative p-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[e.jsx(nl,{className:"w-5 h-5"}),re>0&&e.jsx("span",{className:"absolute top-1 right-1 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center text-white text-xs font-bold",children:re})]}),r&&e.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 z-50",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Notifications"}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[re," unread"]})]}),re>0&&e.jsx("button",{onClick:()=>D.forEach(w=>!w.is_read&&O(w.id)),className:"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300",children:"Mark all read"})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:P?e.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:e.jsx(hs,{className:"w-5 h-5 animate-spin mx-auto"})}):D.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:[e.jsx(nl,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No notifications yet"})]}):D.map(w=>e.jsx("div",{onClick:()=>{O(w.id),l(!1),w.link?a(w.link):a(`${k()}/notifications`)},className:`p-4 hover:bg-gray-50 dark:hover:bg-gray-700 border-b border-gray-100 dark:border-gray-700 cursor-pointer ${V(w)?"bg-blue-50 dark:bg-blue-900/20":""}`,children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 ${ae(w.type)}`,children:e.jsx(nl,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-medium text-sm text-gray-900 dark:text-white",children:w.title}),V(w)&&e.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"})]}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 line-clamp-2",children:w.message}),e.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:B(w.created_at)})]})]})},w.id))}),e.jsx("div",{className:"p-3 border-t border-gray-200 dark:border-gray-700 text-center",children:e.jsx("button",{onClick:()=>{l(!1),a(`${k()}/notifications`)},className:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 font-medium",children:"View All Notifications"})})]})]}),e.jsxs("div",{className:"relative",ref:T,children:[e.jsxs("button",{onClick:()=>o(!c),className:"relative p-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[e.jsx(ra,{className:"w-5 h-5"}),ge>0&&e.jsx("span",{className:"absolute top-1 right-1 w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs font-bold",children:ge})]}),c&&e.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 z-50",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Messages"}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[ge," unread messages"]})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:z?e.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:e.jsx(hs,{className:"w-5 h-5 animate-spin mx-auto"})}):K.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:[e.jsx(ra,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No messages yet"})]}):K.map(w=>e.jsx("div",{onClick:()=>{o(!1),a(`${k()}/messages`)},className:`p-4 hover:bg-gray-50 dark:hover:bg-gray-700 border-b border-gray-100 dark:border-gray-700 cursor-pointer ${V(w)?"bg-blue-50 dark:bg-blue-900/20":""}`,children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-white font-semibold text-sm",children:(w.sender_name||w.from||"U").charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"font-medium text-sm text-gray-900 dark:text-white",children:w.sender_name||w.from}),V(w)&&e.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"})]}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 truncate",children:w.subject||w.message}),e.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:B(w.created_at)})]})]})},w.id))}),e.jsx("div",{className:"p-3 border-t border-gray-200 dark:border-gray-700 text-center",children:e.jsx("button",{onClick:()=>{o(!1),a(`${k()}/messages`)},className:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 font-medium",children:"View All Messages"})})]})]}),e.jsxs("div",{className:"relative",ref:Q,children:[e.jsxs("div",{className:"flex items-center gap-3 pl-4 border-l border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t?.first_name&&t?.last_name?`${t.first_name} ${t.last_name}`:t?.name||"User"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 capitalize",children:t?.user_type||"User"})]}),e.jsxs("button",{onClick:()=>u(!m),className:"flex items-center gap-2 p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[e.jsxs("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center overflow-hidden",children:[t?.profile_picture?e.jsx("img",{src:t.profile_picture.startsWith("http")?t.profile_picture:`${ee.replace("/backend/api","")}${t.profile_picture}`,alt:"Profile",className:"w-full h-full object-cover",onError:w=>{w.target.style.display="none",w.target.nextSibling.style.display="flex"}}):null,e.jsx("span",{className:`text-white text-sm font-semibold ${t?.profile_picture?"hidden":"flex"}`,children:t?.first_name?.charAt(0).toUpperCase()||t?.name?.charAt(0).toUpperCase()||"U"})]}),e.jsx(un,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"})]})]}),m&&e.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 z-50",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:t?.first_name&&t?.last_name?`${t.first_name} ${t.last_name}`:t?.name||"User"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t?.email||"user@school.com"}),e.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1 capitalize",children:[t?.user_type||"User"," Account"]})]}),e.jsxs("div",{className:"py-2",children:[e.jsxs("button",{onClick:()=>{u(!1),a(`${k()}/profile`)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center gap-3",children:[e.jsx(ha,{className:"w-4 h-4"}),"My Profile"]}),e.jsxs("button",{onClick:()=>{u(!1),a(`${k()}/settings`)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center gap-3",children:[e.jsx(Ka,{className:"w-4 h-4"}),"Settings"]}),e.jsxs("button",{onClick:()=>{u(!1),a(`${k()}/messages`)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center gap-3",children:[e.jsx(wa,{className:"w-4 h-4"}),"Messages"]}),e.jsxs("button",{onClick:()=>{u(!1),a(`${k()}/notifications`)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center gap-3",children:[e.jsx(nl,{className:"w-4 h-4"}),"Notifications"]})]}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 py-2",children:e.jsxs("button",{onClick:xe,className:"w-full px-4 py-2 text-left text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 flex items-center gap-3",children:[e.jsx(M1,{className:"w-4 h-4"}),"Logout"]})})]})]})]})]})}function pm(){return e.jsxs("div",{className:"flex h-screen bg-gray-50",children:[e.jsx(r7,{}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(c7,{}),e.jsx("main",{className:"flex-1 overflow-y-auto p-6",children:e.jsx(M6,{})})]})]})}function o7({isOpen:t,onClose:s,onStart:a,onSkip:r}){const[l,c]=h.useState(0),[o,m]=h.useState(!1),[u,x]=h.useState(!1),[A,g]=h.useState(new Set),N=h.useRef(null),[f,y]=h.useState({school_name:"",school_motto:"",school_email:"",school_phone:"",school_address:"",school_logo:null,logoPreview:null}),[v,U]=h.useState({academic_year:`${new Date().getFullYear()}-${new Date().getFullYear()+1}`,term_name:"Term 1",start_date:"",end_date:""}),[D,M]=h.useState([{name:"",capacity:40}]),[K,$]=h.useState([{name:"",code:""}]),P={primary:["Nursery 1","Nursery 2","KG 1","KG 2","Class 1","Class 2","Class 3","Class 4","Class 5","Class 6"],jhs:["JHS 1","JHS 2","JHS 3"],shs:["SHS 1","SHS 2","SHS 3"],all:["Nursery 1","Nursery 2","KG 1","KG 2","Class 1","Class 2","Class 3","Class 4","Class 5","Class 6","JHS 1","JHS 2","JHS 3"]},se={primary:[{name:"English Language",code:"ENG"},{name:"Mathematics",code:"MATH"},{name:"Science",code:"SCI"},{name:"Social Studies",code:"SS"},{name:"Creative Arts",code:"CA"},{name:"Religious & Moral Education",code:"RME"},{name:"Ghanaian Language",code:"GHL"},{name:"French",code:"FRE"},{name:"ICT",code:"ICT"},{name:"Physical Education",code:"PE"}],jhs:[{name:"English Language",code:"ENG"},{name:"Mathematics",code:"MATH"},{name:"Integrated Science",code:"ISCI"},{name:"Social Studies",code:"SS"},{name:"Basic Design & Technology",code:"BDT"},{name:"Religious & Moral Education",code:"RME"},{name:"French",code:"FRE"},{name:"ICT",code:"ICT"},{name:"Ghanaian Language",code:"GHL"},{name:"Physical Education",code:"PE"}]},z=[{id:"welcome",title:"Welcome",icon:cl,description:"Get started with your school"},{id:"school",title:"School Info",icon:mn,description:"Basic school information"},{id:"academic",title:"Academic Year",icon:Ot,description:"Set up your first term"},{id:"classes",title:"Classes",icon:il,description:"Create your classes"},{id:"subjects",title:"Subjects",icon:as,description:"Add subjects taught"},{id:"complete",title:"Complete",icon:Mt,description:"You're all set!"}];h.useEffect(()=>{t&&R()},[t]);const R=async()=>{try{m(!0);const[B,w,oe,ne]=await Promise.all([F.get(`${ee}/system_config.php`).catch(()=>null),F.get(`${ee}/classes.php`).catch(()=>null),F.get(`${ee}/subjects.php`).catch(()=>null),F.get(`${ee}/terms.php`).catch(()=>null)]),Fe=new Set;if(B?.data?.config){const je=B.data.config;y(Ge=>({...Ge,school_name:je.school_name||"",school_motto:je.school_motto||"",school_email:je.school_email||"",school_phone:je.school_phone||"",school_address:je.school_address||"",logoPreview:je.school_logo||null})),je.school_name&&je.school_name.trim()&&Fe.add(1),je.current_academic_year&&je.current_academic_year.trim()&&(U(Ge=>({...Ge,academic_year:je.current_academic_year})),Fe.add(2))}ne?.data?.terms?.length>0&&Fe.add(2),w?.data?.classes?.length>0&&Fe.add(3),oe?.data?.subjects?.length>0&&Fe.add(4),g(Fe),Fe.has(1)&&Fe.has(2)&&Fe.has(3)&&Fe.has(4)&&s?.()}catch(B){console.error("Error fetching existing data:",B)}finally{m(!1)}},j=B=>{const w=B.target.files[0];if(w){if(w.size>2*1024*1024){alert("Logo must be less than 2MB");return}y(oe=>({...oe,school_logo:w,logoPreview:URL.createObjectURL(w)}))}},T=async()=>{x(!0);try{let B=null;if(f.school_logo instanceof File){const oe=new FormData;oe.append("logo",f.school_logo);const ne=await F.post(`${ee}/upload_logo.php`,oe);ne.data.success&&(B=ne.data.logo_url)}const w={school_name:f.school_name,school_motto:f.school_motto,school_email:f.school_email,school_phone:f.school_phone,school_address:f.school_address};return B?w.school_logo=B:f.logoPreview&&!f.logoPreview.startsWith("blob:")&&(w.school_logo=f.logoPreview),await F.post(`${ee}/system_config.php`,w),g(oe=>new Set([...oe,1])),!0}catch(B){return console.error("Error saving school info:",B),alert("Failed to save school information"),!1}finally{x(!1)}},Q=async()=>{x(!0);try{const B=v.academic_year.match(/\d{4}/),w=B?parseInt(B[0]):new Date().getFullYear(),oe=v.term_name.match(/\d/),ne=oe?parseInt(oe[0]):1;return await F.post(`${ee}/system_config.php`,{current_academic_year:v.academic_year,current_term:ne.toString()}),await F.post(`${ee}/terms.php`,{term_name:v.term_name,term_code:`T${ne}-${w}`,academic_year:w,term_number:ne,start_date:v.start_date||null,end_date:v.end_date||null,is_active:1,status:"active"}),g(Fe=>new Set([...Fe,2])),!0}catch(B){console.error("Error saving academic year:",B);const w=B.response?.data?.error||B.message||"Failed to save academic year";return alert(` Error: ${w}`),!1}finally{x(!1)}},E=async()=>{x(!0);try{const B=D.filter(w=>w.name.trim());for(const w of B){const oe=w.name.replace(/[^a-zA-Z0-9]/g,"").substring(0,6).toUpperCase();let ne="primary";const Fe=w.name.toLowerCase();Fe.includes("nursery")||Fe.includes("kg")||Fe.includes("kindergarten")?ne="creche":Fe.includes("jhs")||Fe.includes("junior")?ne="jhs":(Fe.includes("shs")||Fe.includes("senior"))&&(ne="shs"),await F.post(`${ee}/classes.php`,{class_name:w.name,class_code:oe,level:ne,capacity:w.capacity||40,status:"active"})}return g(w=>new Set([...w,3])),!0}catch(B){console.error("Error saving classes:",B);const w=B.response?.data?.error||B.message||"Failed to save classes";return alert(` Error: ${w}`),!1}finally{x(!1)}},te=async()=>{x(!0);try{const B=K.filter(w=>w.name.trim());for(const w of B)await F.post(`${ee}/subjects.php`,{subject_name:w.name,subject_code:w.code||w.name.substring(0,3).toUpperCase(),status:"active"});return g(w=>new Set([...w,4])),!0}catch(B){console.error("Error saving subjects:",B);const w=B.response?.data?.error||B.message||"Failed to save subjects";return alert(` Error: ${w}`),!1}finally{x(!1)}},C=async()=>{let B=!0;l===1?B=await T():l===2?B=await Q():l===3?B=await E():l===4&&(B=await te()),B&&l<z.length-1&&c(l+1)},O=()=>{l>0&&c(l-1)},V=()=>{l<z.length-1&&c(l+1)},re=()=>{F.post(`${ee}/onboarding.php?action=update_system`,{school_setup_completed:A.has(1),academic_config_completed:A.has(2),classes_created:A.has(3),subjects_created:A.has(4),onboarding_completed:!0}).catch(console.error),a()},ge=B=>{const w=P[B].map(oe=>({name:oe,capacity:40}));M(w)},xe=B=>{$(se[B])},Z=()=>{M([...D,{name:"",capacity:40}])},I=B=>{M(D.filter((w,oe)=>oe!==B))},H=()=>{$([...K,{name:"",code:""}])},ae=B=>{$(K.filter((w,oe)=>oe!==B))};if(!t)return null;const k=()=>{switch(l){case 0:return e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(wh,{className:"w-12 h-12 text-white"})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Welcome to Your School Management System!"}),e.jsx("p",{className:"text-lg text-gray-600 mb-8 max-w-lg mx-auto",children:"Let's set up your school in just a few minutes. We'll guide you through the essential steps to get started."}),e.jsx("div",{className:"grid grid-cols-2 gap-4 max-w-md mx-auto text-left",children:[{icon:mn,text:"Add school information"},{icon:Ot,text:"Set up academic year"},{icon:il,text:"Create classes"},{icon:as,text:"Add subjects"}].map((B,w)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(B.icon,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"text-sm text-gray-700",children:B.text})]},w))}),e.jsxs("p",{className:"text-sm text-gray-500 mt-8",children:[" Estimated time: ",e.jsx("strong",{children:"3-5 minutes"})]})]});case 1:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"School Information"}),e.jsx("p",{className:"text-gray-600",children:"Tell us about your school"})]}),e.jsxs("div",{className:"flex justify-center",children:[e.jsx("div",{onClick:()=>N.current?.click(),className:"w-32 h-32 border-2 border-dashed border-gray-300 rounded-xl flex flex-col items-center justify-center cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition",children:f.logoPreview?e.jsx("img",{src:f.logoPreview,alt:"Logo",className:"w-full h-full object-contain rounded-xl"}):e.jsxs(e.Fragment,{children:[e.jsx(hy,{className:"w-8 h-8 text-gray-400 mb-2"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Upload Logo"})]})}),e.jsx("input",{ref:N,type:"file",accept:"image/*",onChange:j,className:"hidden"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"School Name *"}),e.jsx("input",{type:"text",value:f.school_name,onChange:B=>y({...f,school_name:B.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Excellence Academy"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"School Motto"}),e.jsx("input",{type:"text",value:f.school_motto,onChange:B=>y({...f,school_motto:B.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Excellence Through Education"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:f.school_email,onChange:B=>y({...f,school_email:B.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"info@school.edu.gh"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",value:f.school_phone,onChange:B=>y({...f,school_phone:B.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"+233 XX XXX XXXX"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsx("input",{type:"text",value:f.school_address,onChange:B=>y({...f,school_address:B.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"123 School Street, Accra"})]})]})]});case 2:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Academic Year Setup"}),e.jsx("p",{className:"text-gray-600",children:"Configure your current academic year and term"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Academic Year"}),e.jsx("input",{type:"text",value:v.academic_year,onChange:B=>U({...v,academic_year:B.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"2024-2025"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Term"}),e.jsxs("select",{value:v.term_name,onChange:B=>U({...v,term_name:B.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"Term 1",children:"Term 1"}),e.jsx("option",{value:"Term 2",children:"Term 2"}),e.jsx("option",{value:"Term 3",children:"Term 3"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",value:v.start_date,onChange:B=>U({...v,start_date:B.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),e.jsx("input",{type:"date",value:v.end_date,onChange:B=>U({...v,end_date:B.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[" ",e.jsx("strong",{children:"Tip:"})," You can always add more terms later from the Academic Terms page."]})})]});case 3:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Create Classes"}),e.jsx("p",{className:"text-gray-600",children:"Add the classes/grades in your school"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Quick add:"}),e.jsx("button",{onClick:()=>ge("primary"),className:"px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded-full hover:bg-blue-200",children:"Primary School"}),e.jsx("button",{onClick:()=>ge("jhs"),className:"px-3 py-1 text-sm bg-green-100 text-green-700 rounded-full hover:bg-green-200",children:"JHS Only"}),e.jsx("button",{onClick:()=>ge("all"),className:"px-3 py-1 text-sm bg-purple-100 text-purple-700 rounded-full hover:bg-purple-200",children:"Primary + JHS"})]}),e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto pr-2",children:D.map((B,w)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"text",value:B.name,onChange:oe=>{const ne=[...D];ne[w].name=oe.target.value,M(ne)},className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Class name (e.g., Class 1)"}),e.jsx("input",{type:"number",value:B.capacity,onChange:oe=>{const ne=[...D];ne[w].capacity=parseInt(oe.target.value)||40,M(ne)},className:"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Cap"}),D.length>1&&e.jsx("button",{onClick:()=>I(w),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg",children:e.jsx(us,{className:"w-4 h-4"})})]},w))}),e.jsxs("button",{onClick:Z,className:"w-full py-2 border-2 border-dashed border-gray-300 rounded-lg text-gray-500 hover:border-blue-500 hover:text-blue-500 flex items-center justify-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4"})," Add Another Class"]})]});case 4:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Add Subjects"}),e.jsx("p",{className:"text-gray-600",children:"Define the subjects taught in your school"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Quick add:"}),e.jsx("button",{onClick:()=>xe("primary"),className:"px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded-full hover:bg-blue-200",children:"Primary Subjects"}),e.jsx("button",{onClick:()=>xe("jhs"),className:"px-3 py-1 text-sm bg-green-100 text-green-700 rounded-full hover:bg-green-200",children:"JHS Subjects"})]}),e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto pr-2",children:K.map((B,w)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"text",value:B.name,onChange:oe=>{const ne=[...K];ne[w].name=oe.target.value,$(ne)},className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Subject name"}),e.jsx("input",{type:"text",value:B.code,onChange:oe=>{const ne=[...K];ne[w].code=oe.target.value.toUpperCase(),$(ne)},className:"w-24 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Code",maxLength:5}),K.length>1&&e.jsx("button",{onClick:()=>ae(w),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg",children:e.jsx(us,{className:"w-4 h-4"})})]},w))}),e.jsxs("button",{onClick:H,className:"w-full py-2 border-2 border-dashed border-gray-300 rounded-lg text-gray-500 hover:border-blue-500 hover:text-blue-500 flex items-center justify-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4"})," Add Another Subject"]})]});case 5:return e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-24 h-24 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(Mt,{className:"w-16 h-16 text-green-600"})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:" You're All Set!"}),e.jsx("p",{className:"text-lg text-gray-600 mb-8 max-w-lg mx-auto",children:"Your school management system is ready to use. You can now start adding students, teachers, and managing your school."}),e.jsx("div",{className:"grid grid-cols-2 gap-4 max-w-md mx-auto",children:[{label:"School Info",done:A.has(1)},{label:"Academic Year",done:A.has(2)},{label:"Classes",done:A.has(3)},{label:"Subjects",done:A.has(4)}].map((B,w)=>e.jsxs("div",{className:`flex items-center gap-2 p-3 rounded-lg ${B.done?"bg-green-50":"bg-gray-50"}`,children:[B.done?e.jsx(Mt,{className:"w-5 h-5 text-green-600"}):e.jsx(ka,{className:"w-5 h-5 text-gray-400"}),e.jsx("span",{className:B.done?"text-green-700":"text-gray-500",children:B.label})]},w))}),e.jsx("p",{className:"text-sm text-gray-500 mt-8",children:"You can always update these settings later from the System Configuration page."})]});default:return null}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl flex flex-col",style:{maxHeight:"90vh"},children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6 rounded-t-2xl flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(cl,{className:"w-6 h-6"}),e.jsx("span",{className:"font-semibold",children:"Setup Wizard"})]}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-white/20 rounded-lg transition",children:e.jsx(Nt,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"flex items-center justify-between mt-6",children:z.map((B,w)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`
                  w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium transition-all
                  ${w<l?"bg-white text-blue-600":w===l?"bg-white text-blue-600 ring-4 ring-white/30":"bg-white/20 text-white/60"}
                `,children:w<l?e.jsx(Tn,{className:"w-4 h-4"}):w+1}),w<z.length-1&&e.jsx("div",{className:`w-8 h-1 mx-1 rounded ${w<l?"bg-white":"bg-white/20"}`})]},B.id))})]}),e.jsx("div",{className:"flex-1 p-6 overflow-y-auto",style:{minHeight:"300px"},children:o?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(hs,{className:"w-8 h-8 animate-spin text-blue-600"})}):k()}),e.jsxs("div",{className:"border-t border-gray-200 p-4 bg-gray-50 rounded-b-2xl flex items-center justify-between flex-shrink-0",children:[e.jsx("div",{children:l>0&&l<z.length-1&&e.jsxs("button",{onClick:O,className:"flex items-center gap-2 text-gray-600 hover:text-gray-900",children:[e.jsx(Kd,{className:"w-4 h-4"})," Back"]})}),e.jsxs("div",{className:"flex items-center gap-3",children:[l>0&&l<z.length-1&&e.jsx("button",{onClick:V,className:"text-gray-500 hover:text-gray-700",children:"Skip this step"}),l===0&&e.jsx("button",{onClick:r,className:"text-gray-500 hover:text-gray-700",children:"I'll do this later"}),l<z.length-1?e.jsx("button",{onClick:C,disabled:u||l===1&&!f.school_name,className:"px-6 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg font-medium hover:from-blue-700 hover:to-purple-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:u?e.jsxs(e.Fragment,{children:[e.jsx(hs,{className:"w-4 h-4 animate-spin"})," Saving..."]}):e.jsxs(e.Fragment,{children:[l===0?"Let's Start":"Continue"," ",e.jsx(cr,{className:"w-4 h-4"})]})}):e.jsxs("button",{onClick:re,className:"px-6 py-2 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-lg font-medium hover:from-green-700 hover:to-emerald-700 flex items-center gap-2",children:[e.jsx(wh,{className:"w-4 h-4"})," Go to Dashboard"]})]})]})]})})}function d7({onDismiss:t}){const s=la(),[a,r]=h.useState(null),[l,c]=h.useState(!0),[o,m]=h.useState(!1),u=[{id:"school_setup",title:"School Information",description:"Add logo, name, and contact details",icon:il,route:"/admin/system-config",field:"school_setup_completed"},{id:"academic_config",title:"Academic Configuration",description:"Set up academic year and terms",icon:Ot,route:"/admin/terms",field:"academic_config_completed"},{id:"classes",title:"Create Classes",description:"Add your school classes/grades",icon:il,route:"/admin/classes",field:"classes_created"},{id:"subjects",title:"Add Subjects",description:"Define subjects taught",icon:as,route:"/admin/subjects",field:"subjects_created"},{id:"users",title:"Add Users",description:"Invite teachers and add students",icon:Rt,route:"/admin/students",field:"users_added"},{id:"import",title:"Import Data (Optional)",description:"Bulk upload existing data",icon:Hr,route:"/admin/import",field:"data_imported",optional:!0}];h.useEffect(()=>{x()},[]);const x=async()=>{try{const g=await F.get(`${ee}/onboarding.php?action=system_status`);g.data.success&&r(g.data)}catch(g){console.error("Failed to fetch onboarding status:",g)}finally{c(!1)}},A=g=>{s(g.route)};return l?e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})}):!a||a.completion_percentage===100?null:o?e.jsx("div",{onClick:()=>m(!1),className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl shadow-lg p-4 cursor-pointer hover:shadow-xl transition",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(cl,{className:"w-5 h-5"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold",children:["Setup Progress: ",a.completion_percentage,"%"]}),e.jsxs("p",{className:"text-sm text-blue-100",children:[a.completed_steps," of ",a.total_steps," completed"]})]})]}),e.jsx(Pl,{className:"w-5 h-5"})]})}):e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(cl,{className:"w-6 h-6"}),e.jsx("h3",{className:"text-xl font-bold",children:"Setup Your School"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>m(!0),className:"p-1 hover:bg-white/20 rounded transition",children:e.jsx(Pl,{className:"w-5 h-5"})}),e.jsx("button",{onClick:t,className:"p-1 hover:bg-white/20 rounded transition",children:e.jsx(Nt,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-2",children:[e.jsxs("span",{children:[a.completion_percentage,"% Complete"]}),e.jsxs("span",{children:[a.completed_steps," of ",a.total_steps," steps"]})]}),e.jsx("div",{className:"w-full bg-white/20 rounded-full h-3",children:e.jsx("div",{className:"bg-white rounded-full h-3 transition-all duration-500",style:{width:`${a.completion_percentage}%`}})})]})]}),e.jsx("div",{className:"p-6 space-y-3",children:u.map(g=>{const N=g.icon,f=a.status[g.field];return e.jsxs("div",{onClick:()=>!f&&A(g),className:`
                flex items-start gap-4 p-4 rounded-lg border-2 transition-all
                ${f?"bg-green-50 border-green-200":"border-gray-200 hover:border-blue-500 hover:shadow-md cursor-pointer"}
              `,children:[e.jsx("div",{className:`
                flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center
                ${f?"bg-green-500":"bg-gray-200"}
              `,children:f?e.jsx(Mt,{className:"w-6 h-6 text-white"}):e.jsx(BS,{className:"w-6 h-6 text-gray-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(N,{className:`w-4 h-4 ${f?"text-green-600":"text-gray-600"}`}),e.jsxs("h4",{className:`font-semibold ${f?"text-green-900":"text-gray-900"}`,children:[g.title,g.optional&&e.jsx("span",{className:"ml-2 text-xs text-gray-500 font-normal",children:"(Optional)"})]})]}),e.jsx("p",{className:`text-sm ${f?"text-green-700":"text-gray-600"}`,children:g.description})]}),!f&&e.jsx(Pl,{className:"w-5 h-5 text-gray-400 flex-shrink-0 mt-2"})]},g.id)})}),a.completion_percentage===100&&e.jsxs("div",{className:"bg-green-50 border-t border-green-200 p-6 text-center",children:[e.jsx(Mt,{className:"w-12 h-12 text-green-600 mx-auto mb-3"}),e.jsx("h4",{className:"font-bold text-green-900 mb-2",children:"Setup Complete! "}),e.jsx("p",{className:"text-sm text-green-700 mb-4",children:"Your school is ready to go. Start managing students, fees, and more!"}),e.jsx("button",{onClick:t,className:"btn btn-primary",children:"Go to Dashboard"})]})]})}function m7(){const t=la(),[s,a]=h.useState(!0),[r,l]=h.useState(!1),[c,o]=h.useState(!1),[m,u]=h.useState(!1),[x,A]=h.useState(null),[g,N]=h.useState(null),[f,y]=h.useState([]),[v,U]=h.useState([]);h.useEffect(()=>{D(),M(),$()},[]);const D=async()=>{try{const re=await F.get(`${ee}/onboarding.php?action=system_status`);re.data.success&&(A(re.data),re.data.completion_percentage===0?o(!0):re.data.completion_percentage<100&&u(!0))}catch(re){console.error("Error checking onboarding status:",re)}},M=async()=>{try{a(!0);const re=await F.get(`${ee}/dashboard.php?role=admin`);re.data.success&&(N(re.data),re.data.insights&&U(re.data.insights.filter(ge=>ge.priority==="high"||ge.priority==="medium")))}catch(re){console.error("Error fetching dashboard data:",re),await K()}finally{a(!1)}},K=async()=>{try{const[re,ge,xe,Z,I,H]=await Promise.all([F.get(`${ee}/students.php`).catch(()=>({data:{students:[]}})),F.get(`${ee}/teachers.php`).catch(()=>({data:{teachers:[]}})),F.get(`${ee}/classes.php`).catch(()=>({data:{classes:[]}})),F.get(`${ee}/invoices.php`).catch(()=>({data:{invoices:[]}})),F.get(`${ee}/terms.php`).catch(()=>({data:{terms:[]}})),F.get(`${ee}/attendance.php?date=${new Date().toISOString().split("T")[0]}`).catch(()=>({data:{attendance:[]}}))]),ae=re.data.students||[],k=ge.data.teachers||[],B=xe.data.classes||[],w=Z.data.invoices||[],oe=I.data.terms||[],ne=H.data.attendance||[],Fe=w.reduce((ce,_e)=>ce+parseFloat(_e.paid_amount||0),0),je=w.reduce((ce,_e)=>ce+parseFloat(_e.total_amount||0),0),Ge=w.filter(ce=>ce.status!=="paid").reduce((ce,_e)=>ce+parseFloat(_e.balance||0),0),ze=oe.find(ce=>ce.status==="active"),Xe=ne.filter(ce=>ce.status==="present").length,st=ae.length>0?(Xe/ae.length*100).toFixed(1):0;N({success:!0,stats:{total_students:ae.length,total_teachers:k.length,total_classes:B.filter(ce=>ce.status==="active").length,attendance_today:Xe},financial:{revenue_this_month:Fe,outstanding_fees:Ge,collection_rate:je>0?(Fe/je*100).toFixed(1):0},academic:{total_subjects:0,pass_rate:0},activities:[],insights:[],charts:{revenue:[],attendance:[],fee_status:[]},currentTerm:ze?`${ze.term_name}, ${ze.academic_year}`:"No active term",attendanceRate:st})}catch(re){console.error("Error in fallback data fetch:",re)}},$=async()=>{try{const re=await F.get(`${ee}/events.php?upcoming=true&limit=5`);re.data.events&&y(re.data.events)}catch(re){console.error("Error fetching events:",re)}},P=async()=>{l(!0),await M(),await $(),l(!1)},se=()=>{o(!1),u(!0)},z=()=>{o(!1)},R=()=>{u(!1)},j=()=>{if(!g)return[];const{stats:re,financial:ge}=g;return[{title:"Total Students",value:(re?.total_students||0).toLocaleString(),icon:Qs,color:"blue",change:"+12%",changeType:"increase",link:"/admin/students"},{title:"Total Teachers",value:re?.total_teachers||0,icon:Rt,color:"green",change:"+5%",changeType:"increase",link:"/admin/teachers"},{title:"Total Revenue",value:`GH${(ge?.revenue_this_month||0).toLocaleString("en-GH",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:vs,color:"purple",change:"+18%",changeType:"increase",link:"/admin/payments"},{title:"Outstanding Fees",value:`GH${(ge?.outstanding_fees||0).toLocaleString("en-GH",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:ka,color:"orange",change:"-8%",changeType:"decrease",link:"/admin/invoices"},{title:"Active Classes",value:re?.total_classes||0,icon:as,color:"indigo",change:"+3",changeType:"increase",link:"/admin/classes"},{title:"Attendance Rate",value:`${g.attendanceRate||(re?.total_students>0?(re?.attendance_today/re?.total_students*100).toFixed(1):0)}%`,icon:Or,color:"teal",change:"+2.5%",changeType:"increase",link:"/admin/attendance"}]},T={blue:"bg-blue-100 text-blue-600",green:"bg-green-100 text-green-600",purple:"bg-purple-100 text-purple-600",orange:"bg-orange-100 text-orange-600",indigo:"bg-indigo-100 text-indigo-600",teal:"bg-teal-100 text-teal-600"},Q=re=>{switch(re){case"warning":return e.jsx(_s,{className:"w-5 h-5 text-yellow-500"});case"alert":return e.jsx(ka,{className:"w-5 h-5 text-red-500"});case"success":return e.jsx(Mt,{className:"w-5 h-5 text-green-500"});default:return e.jsx(fc,{className:"w-5 h-5 text-blue-500"})}},E=re=>{switch(re){case"warning":return"bg-yellow-50 border-yellow-200";case"alert":return"bg-red-50 border-red-200";case"success":return"bg-green-50 border-green-200";default:return"bg-blue-50 border-blue-200"}},te=re=>{switch(re){case"payment":return e.jsx(vs,{className:"w-5 h-5"});case"admission":return e.jsx(Qs,{className:"w-5 h-5"});case"staff":return e.jsx(Rt,{className:"w-5 h-5"});case"class":return e.jsx(as,{className:"w-5 h-5"});default:return e.jsx(Ir,{className:"w-5 h-5"})}},C=re=>{switch(re){case"payment":return"bg-green-100 text-green-600";case"admission":return"bg-blue-100 text-blue-600";case"staff":return"bg-purple-100 text-purple-600";case"class":return"bg-orange-100 text-orange-600";default:return"bg-gray-100 text-gray-600"}};if(s)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(hs,{className:"w-12 h-12 text-blue-600 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading dashboard..."})]})});const O=j(),V=g?.financial?.collection_rate||0;return e.jsxs("div",{className:"space-y-6",children:[e.jsx(o7,{isOpen:c,onClose:z,onStart:se,onSkip:z}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Welcome back! Here's what's happening today."})]}),e.jsxs("button",{onClick:P,disabled:r,className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(Ns,{className:`w-4 h-4 ${r?"animate-spin":""}`}),"Refresh"]})]}),m&&x&&x.completion_percentage<100&&e.jsx(d7,{onDismiss:R}),v.length>0&&e.jsx("div",{className:"space-y-3",children:v.slice(0,3).map((re,ge)=>e.jsxs("div",{className:`p-4 rounded-lg border ${E(re.type)} flex items-start gap-3`,children:[Q(re.type),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:re.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:re.message})]}),re.action&&e.jsxs("button",{className:"text-sm font-medium text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[re.action," ",e.jsx(Pl,{className:"w-4 h-4"})]})]},ge))}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:O.map((re,ge)=>{const xe=re.icon;return e.jsx("div",{className:"card p-6 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>t(re.link),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:re.title}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:re.value}),e.jsxs("p",{className:`text-sm mt-2 flex items-center gap-1 ${re.changeType==="increase"?"text-green-600":"text-red-600"}`,children:[re.changeType==="increase"?e.jsx($s,{className:"w-4 h-4"}):e.jsx(gc,{className:"w-4 h-4"}),re.change," from last month"]})]}),e.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${T[re.color]}`,children:e.jsx(xe,{className:"w-6 h-6"})})]})},ge)})}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(gy,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Fee Collection Progress"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Current term collection rate"})]})]}),e.jsxs("span",{className:"text-2xl font-bold text-purple-600",children:[V,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4",children:e.jsx("div",{className:`h-4 rounded-full transition-all duration-500 ${V>=80?"bg-green-500":V>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(V,100)}%`}})}),e.jsxs("div",{className:"flex justify-between mt-2 text-sm text-gray-500",children:[e.jsxs("span",{children:["Collected: GH",(g?.financial?.revenue_this_month||0).toLocaleString()]}),e.jsxs("span",{children:["Outstanding: GH",(g?.financial?.outstanding_fees||0).toLocaleString()]})]})]}),g?.charts&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(Fs,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"font-semibold text-gray-900",children:"Revenue Trend (Last 6 Months)"})]}),e.jsx("div",{className:"space-y-3",children:(g.charts.revenue||[]).map((re,ge)=>{const xe=Math.max(...(g.charts.revenue||[]).map(I=>I.amount||0),1),Z=(re.amount||0)/xe*100;return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm text-gray-500 w-16",children:re.month}),e.jsx("div",{className:"flex-1 bg-gray-100 rounded-full h-6 overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full flex items-center justify-end pr-2",style:{width:`${Math.max(Z,5)}%`},children:e.jsx("span",{className:"text-xs text-white font-medium",children:(re.amount||0)>0?`GH${(re.amount/1e3).toFixed(1)}k`:""})})})]},ge)})})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(Or,{className:"w-5 h-5 text-green-600"}),e.jsx("h3",{className:"font-semibold text-gray-900",children:"Attendance (Last 7 Days)"})]}),e.jsx("div",{className:"flex items-end justify-between h-40 gap-2",children:(g.charts.attendance||[]).map((re,ge)=>{const Z=(re.present||0)+(re.absent||0)>0?(re.present||0)/Math.max(...(g.charts.attendance||[]).map(I=>(I.present||0)+(I.absent||0)),1)*100:0;return e.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[e.jsx("div",{className:"w-full flex flex-col items-center justify-end h-32",children:e.jsx("div",{className:"w-full bg-green-500 rounded-t",style:{height:`${Math.max(Z,5)}%`},title:`Present: ${re.present||0}`})}),e.jsx("span",{className:"text-xs text-gray-500 mt-2",children:re.day})]},ge)})}),e.jsxs("div",{className:"flex items-center justify-center gap-6 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Present"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Absent"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 card",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(Ir,{className:"w-5 h-5 text-blue-600"}),"Recent Activity"]}),e.jsx("button",{onClick:()=>t("/admin/logs"),className:"text-sm text-blue-600 hover:text-blue-700",children:"View All"})]}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-4",children:(g?.activities||[]).length>0?g.activities.slice(0,8).map((re,ge)=>e.jsxs("div",{className:"flex items-start gap-4 pb-4 border-b border-gray-100 last:border-0 last:pb-0",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${C(re.type)}`,children:te(re.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:re.description}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1 flex items-center gap-1",children:[e.jsx(Wt,{className:"w-3 h-3"}),new Date(re.date).toLocaleDateString("en-GB",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})]})]})]},ge)):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Ir,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No recent activity"})]})})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Quick Actions"})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>t("/admin/admissions"),className:"w-full btn btn-primary text-left flex items-center gap-3",children:[e.jsx(Qs,{className:"w-5 h-5"}),e.jsx("span",{children:"Enroll New Student"})]}),e.jsxs("button",{onClick:()=>t("/admin/teachers"),className:"w-full btn bg-green-600 text-white hover:bg-green-700 text-left flex items-center gap-3",children:[e.jsx(Rt,{className:"w-5 h-5"}),e.jsx("span",{children:"Add Teacher"})]}),e.jsxs("button",{onClick:()=>t("/admin/invoices"),className:"w-full btn bg-purple-600 text-white hover:bg-purple-700 text-left flex items-center gap-3",children:[e.jsx(Kt,{className:"w-5 h-5"}),e.jsx("span",{children:"Create Invoice"})]}),e.jsxs("button",{onClick:()=>t("/admin/payments"),className:"w-full btn bg-orange-600 text-white hover:bg-orange-700 text-left flex items-center gap-3",children:[e.jsx(aa,{className:"w-5 h-5"}),e.jsx("span",{children:"Record Payment"})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(Ot,{className:"w-5 h-5 text-indigo-600"}),"Upcoming Events"]}),e.jsx("button",{onClick:()=>t("/admin/events"),className:"text-sm text-blue-600 hover:text-blue-700",children:"View All"})]}),e.jsx("div",{className:"p-6",children:f.length>0?e.jsx("div",{className:"space-y-4",children:f.slice(0,4).map((re,ge)=>e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:"w-12 h-12 bg-indigo-100 rounded-lg flex flex-col items-center justify-center",children:[e.jsx("span",{className:"text-xs text-indigo-600 font-medium",children:new Date(re.start_date||re.event_date).toLocaleDateString("en-GB",{month:"short"})}),e.jsx("span",{className:"text-lg font-bold text-indigo-700",children:new Date(re.start_date||re.event_date).getDate()})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900 text-sm",children:re.title||re.event_name}),e.jsx("p",{className:"text-xs text-gray-500",children:re.location||"School"})]})]},ge))}):e.jsxs("div",{className:"text-center py-6 text-gray-500",children:[e.jsx(Ot,{className:"w-10 h-10 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No upcoming events"})]})})]}),e.jsx("div",{className:"card p-6 bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ot,{className:"w-8 h-8 opacity-80"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm opacity-80",children:"Current Term"}),e.jsx("p",{className:"font-semibold",children:g?.currentTerm||"No active term"})]})]})})]})]})]})}function p4({type:t,id:s,currentPicture:a,onUploadSuccess:r}){const[l,c]=h.useState(!1),[o,m]=h.useState(a),[u,x]=h.useState(!1),A=h.useRef(null),g=v=>{const U=v.target.files[0];if(U){if(!U.type.startsWith("image/")){alert("Please select an image file");return}if(U.size>5*1024*1024){alert("File size must be less than 5MB");return}const D=new FileReader;D.onloadend=()=>{m(D.result)},D.readAsDataURL(U),N(U)}},N=async v=>{try{c(!0);const U=new FormData;U.append("profile_picture",v),U.append("type",t),U.append("id",s);const D=await F.post("https://eea.mcaforo.com/backend/api/upload_profile_picture.php",U,{headers:{"Content-Type":"multipart/form-data"}});D.data.success&&(m(D.data.url),alert("Profile picture uploaded successfully!"),r&&r(D.data.filename,D.data.url),x(!1))}catch(U){console.error("Upload error:",U),alert("Failed to upload picture: "+(U.response?.data?.error||U.message))}finally{c(!1)}},f=v=>v?v.startsWith("http")?v:`${xb}/${v.replace(/^\//,"")}`:null,y=f(o||a);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative inline-block",children:[e.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden bg-gray-200 border-4 border-white shadow-lg",children:y?e.jsx("img",{src:y,alt:"Profile",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-blue-500 to-purple-600",children:e.jsx(ha,{className:"w-12 h-12 text-white"})})}),e.jsx("button",{onClick:()=>x(!0),className:"absolute bottom-0 right-0 bg-blue-600 hover:bg-blue-700 text-white rounded-full p-2 shadow-lg transition-colors",title:"Upload picture",children:e.jsx(Ld,{className:"w-4 h-4"})})]}),u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Upload Profile Picture"}),e.jsx("button",{onClick:()=>x(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-32 h-32 rounded-full overflow-hidden bg-gray-200 border-4 border-gray-300",children:o?e.jsx("img",{src:typeof o=="string"&&o.startsWith("data:")?o:f(o),alt:"Preview",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-blue-500 to-purple-600",children:e.jsx(ha,{className:"w-16 h-16 text-white"})})})}),e.jsxs("div",{children:[e.jsx("input",{ref:A,type:"file",accept:"image/*",onChange:g,className:"hidden"}),e.jsx("button",{onClick:()=>A.current?.click(),disabled:l,className:"w-full btn btn-primary flex items-center justify-center gap-2",children:l?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Hr,{className:"w-5 h-5"}),"Choose Picture"]})}),e.jsx("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"JPG, PNG, GIF or WEBP (Max 5MB)"})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 flex justify-end",children:e.jsx("button",{onClick:()=>x(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:"Close"})})]})})]})}const cn=`${ee}/user_management.php`,u7=`${ee}/users.php`;function x7(){const[t,s]=h.useState("users"),[a,r]=h.useState([]),[l,c]=h.useState([]),[o,m]=h.useState([]),[u,x]=h.useState([]),[A,g]=h.useState([]),[N,f]=h.useState({}),[y,v]=h.useState(!0),[U,D]=h.useState(""),[M,K]=h.useState("all"),[$,P]=h.useState("all"),[se,z]=h.useState(!1),[R,j]=h.useState("user"),[T,Q]=h.useState(null),[E,te]=h.useState(null),[C,O]=h.useState(null),[V,re]=h.useState([]),[ge,xe]=h.useState([]),[Z,I]=h.useState([]),[H,ae]=h.useState(null),[k,B]=h.useState(null),w=h.useRef(null),oe=h.useRef(null),[ne,Fe]=h.useState({name:"",email:"",phone:"",user_type:"teacher",password:"",status:"active",must_change_password:!1}),[je,Ge]=h.useState({user_id:"",password:"",must_change_password:!0}),[ze,Xe]=h.useState([]),[st,ce]=h.useState({page:1,limit:20,total:0,pages:1}),[_e,le]=h.useState(!1),[Pe,we]=h.useState(null),[fe,ye]=h.useState({employee_id:"",department:"",designation:"",date_of_joining:"",employment_type:"full_time",salary_grade:"",bank_name:"",bank_account:"",emergency_contact_name:"",emergency_contact_phone:"",address:"",date_of_birth:"",gender:"",national_id:"",qualifications:""}),Ke=["teacher","accountant","hr_manager","librarian","receptionist","finance","principal","class_teacher","employee"];h.useEffect(()=>{ve(),ie(),q()},[]),h.useEffect(()=>{t==="activity"&&Ne(),t==="login_history"&&et(),t==="roles"&&q()},[t]);const ve=async()=>{try{v(!0);const Te=new URLSearchParams({page:st.page,limit:st.limit});U&&Te.append("search",U),M!=="all"&&Te.append("role",M),$!=="all"&&Te.append("status",$);const bt=await F.get(`${cn}?resource=users&${Te}`);r(bt.data.users||[]),bt.data.pagination&&ce(bt.data.pagination)}catch(Te){console.error(Te);try{const bt=await F.get(u7);r(bt.data.users||[])}catch(bt){console.error(bt)}}finally{v(!1)}},ie=async()=>{try{const Te=await F.get(`${cn}?resource=users&action=stats`);f(Te.data.stats||{})}catch(Te){console.error(Te)}},q=async()=>{try{const Te=await F.get(`${cn}?resource=roles`);c(Te.data.roles||[])}catch(Te){console.error(Te)}},pe=async()=>{try{const Te=await F.get(`${cn}?resource=permissions`);xe(Te.data.permissions||[])}catch(Te){console.error(Te)}},Me=async Te=>{try{const bt=await F.get(`${cn}?resource=roles&action=with_permissions&id=${Te.id}`);O(bt.data.role),re(bt.data.role?.permissions||[]),ge.length===0&&await pe(),j("permissions"),z(!0)}catch(bt){console.error(bt),alert("Failed to load permissions")}},Se=async(Te,bt)=>{try{if(bt)await F.post(`${cn}?resource=roles&action=remove_permission`,{role_id:C.id,permission_id:Te}),re(Xt=>Xt.filter(ls=>ls.id!==Te));else{await F.post(`${cn}?resource=roles&action=assign_permission`,{role_id:C.id,permission_id:Te});const Xt=ge.find(ls=>ls.id===Te);Xt&&re(ls=>[...ls,Xt])}}catch(Xt){console.error(Xt),alert("Failed to update permission")}},Ne=async()=>{try{const Te=await F.get(`${cn}?resource=activity&limit=100`);x(Te.data.logs||[])}catch(Te){console.error(Te)}},et=async()=>{try{const Te=await F.get(`${cn}?resource=login_history&limit=100`);g(Te.data.history||[])}catch(Te){console.error(Te)}},Ce=Te=>{const bt=Te.target.files[0];if(bt){if(!bt.type.startsWith("image/")){alert("Please select an image file");return}if(bt.size>5*1024*1024){alert("File size must be less than 5MB");return}ae(bt);const Xt=new FileReader;Xt.onloadend=()=>B(Xt.result),Xt.readAsDataURL(bt)}},ft=()=>{Q(null),ae(null),B(null);const Te=l.length>0?l[0].role_name||l[0].name:"teacher";Fe({name:"",email:"",phone:"",user_type:Te,password:"",status:"active",must_change_password:!1}),j("user"),z(!0)},qe=Te=>{Q(Te),ae(null),B(null);const bt=Te.user_type||(l.length>0?l[0].role_name||l[0].name:"teacher");Fe({name:Te.name||"",email:Te.email||"",phone:Te.phone||"",user_type:bt,password:"",status:Te.status||"active",must_change_password:!1}),j("user"),z(!0)},W=Te=>{Ge({user_id:Te.id,password:"",must_change_password:!0}),Q(Te),j("password"),z(!0)},Ie=async(Te,bt)=>{try{await F.post(`${cn}?resource=users&action=approve`,{user_id:Te,user_type:bt}),ve(),ie(),alert("User approved successfully!")}catch{alert("Failed to approve user")}},mt=async Te=>{if(window.confirm("Reject this user registration?"))try{await F.post(`${cn}?resource=users&action=reject`,{user_id:Te}),ve(),ie(),alert("User rejected!")}catch{alert("Failed to reject user")}},pt=async Te=>{if(window.confirm("Delete this user permanently?"))try{await F.delete(`${cn}?resource=users&id=${Te}`),r(a.filter(bt=>bt.id!==Te)),ie(),alert("User deleted!")}catch{alert("Failed to delete user")}},kt=async Te=>{Te.preventDefault();try{let bt;const Xt=T?.user_type,ls=ne.user_type;if(T?(await F.put(`${cn}?resource=users&id=${T.id}`,ne),bt=T.id,alert("User updated!")):(bt=(await F.post(`${cn}?resource=users`,ne)).data.user?.id,alert("User created!")),H&&bt){const he=new FormData;he.append("profile_picture",H),he.append("type","user"),he.append("id",bt),await F.post(`${ee}/upload_profile_picture.php`,he,{headers:{"Content-Type":"multipart/form-data"}})}z(!1),ve();const Ts=Ke.includes(ls),ss=Ke.includes(Xt);Ts&&(!ss||!T)&&(we({id:bt,name:ne.name,email:ne.email,user_type:ls}),ye({employee_id:`EMP${String(bt).padStart(4,"0")}`,department:"",designation:ls==="teacher"?"Teacher":"",date_of_joining:new Date().toISOString().split("T")[0],employment_type:"full_time",salary_grade:"",bank_name:"",bank_account:"",emergency_contact_name:"",emergency_contact_phone:"",address:"",date_of_birth:"",gender:"",national_id:"",qualifications:""}),le(!0))}catch(bt){alert("Failed to save user: "+(bt.response?.data?.error||bt.message))}},J=async Te=>{Te.preventDefault();try{await F.post(`${cn}?resource=password&action=admin_reset`,je),z(!1),alert("Password reset successfully!")}catch{alert("Failed to reset password")}},Je=async Te=>{Te.preventDefault();try{const bt={user_id:Pe.id,...fe};Pe.user_type==="teacher"||Pe.user_type==="class_teacher"?await F.post(`${ee}/teachers.php`,{user_id:Pe.id,name:Pe.name,email:Pe.email,phone:fe.emergency_contact_phone,employee_id:fe.employee_id,department:fe.department,designation:fe.designation,date_of_joining:fe.date_of_joining,employment_type:fe.employment_type,qualifications:fe.qualifications,address:fe.address,date_of_birth:fe.date_of_birth,gender:fe.gender,national_id:fe.national_id,status:"active"}):await F.post(`${ee}/employees.php`,bt),le(!1),we(null),alert("Employee details saved successfully!"),ve()}catch(bt){console.error("Employee wizard error:",bt),alert("Failed to save employee details: "+(bt.response?.data?.error||bt.message))}},_t=()=>{le(!1),we(null)},$t=async Te=>{if(Z.length===0){alert("Select users first");return}if(window.confirm(`${Te} ${Z.length} users?`))try{Te==="delete"?await F.post(`${cn}?resource=bulk&action=delete`,{user_ids:Z}):Te==="activate"?await F.post(`${cn}?resource=bulk&action=update_status`,{user_ids:Z,status:"active"}):Te==="deactivate"&&await F.post(`${cn}?resource=bulk&action=update_status`,{user_ids:Z,status:"inactive"}),I([]),ve(),ie(),alert("Bulk action completed!")}catch{alert("Bulk action failed")}},me=async()=>{try{const Te=await F.post(`${cn}?resource=bulk&action=export`,{filters:{role:M!=="all"?M:"",status:$!=="all"?$:""}}),bt=Yt(Te.data.users);be(bt,"users_export.csv")}catch{alert("Export failed")}},Ze=Te=>{const bt=Te.target.files[0];if(!bt)return;const Xt=new FileReader;Xt.onload=ls=>{const Ts=ls.target.result.split(`
`),ss=Ts[0].split(",").map(Ht=>Ht.trim().toLowerCase()),he=[];for(let Ht=1;Ht<Ts.length;Ht++){if(!Ts[Ht].trim())continue;const Zt=Ts[Ht].split(","),Ee={};ss.forEach((zt,is)=>Ee[zt]=Zt[is]?.trim()||""),Ee.name&&Ee.email&&he.push(Ee)}Xe(he),j("import"),z(!0)},Xt.readAsText(bt)},ct=async()=>{try{const Te=await F.post(`${cn}?resource=bulk&action=import`,{users:ze});z(!1),ve(),ie(),alert(`Import completed: ${Te.data.successful} successful, ${Te.data.failed} failed`)}catch{alert("Import failed")}},Yt=Te=>{if(!Te.length)return"";const bt=Object.keys(Te[0]),Xt=Te.map(ls=>bt.map(Ts=>`"${ls[Ts]||""}"`).join(","));return[bt.join(","),...Xt].join(`
`)},be=(Te,bt)=>{const Xt=new Blob([Te],{type:"text/csv"}),ls=URL.createObjectURL(Xt),Ts=document.createElement("a");Ts.href=ls,Ts.download=bt,Ts.click(),URL.revokeObjectURL(ls)},lt=Te=>{I(bt=>bt.includes(Te)?bt.filter(Xt=>Xt!==Te):[...bt,Te])},Ue=()=>{Z.length===Rs.length?I([]):I(Rs.map(Te=>Te.id))},Ct=Array.isArray(a)?a.filter(Te=>Te?.status==="pending"):[],Rs=(Array.isArray(a)?a.filter(Te=>Te?.status!=="pending"):[]).filter(Te=>{if(!Te?.name||!Te?.email)return!1;const bt=Te.name.toLowerCase().includes(U.toLowerCase())||Te.email.toLowerCase().includes(U.toLowerCase()),Xt=M==="all"||Te.user_type===M,ls=$==="all"||Te.status===$;return bt&&Xt&&ls}),He=Te=>({super_admin:"bg-red-100 text-red-700",admin:"bg-purple-100 text-purple-700",administrator:"bg-purple-100 text-purple-700",principal:"bg-indigo-100 text-indigo-700",vice_principal:"bg-indigo-100 text-indigo-700",hr:"bg-pink-100 text-pink-700",hr_manager:"bg-pink-100 text-pink-700",finance:"bg-orange-100 text-orange-700",finance_officer:"bg-orange-100 text-orange-700",accountant:"bg-orange-100 text-orange-700",cashier:"bg-orange-100 text-orange-700",teacher:"bg-blue-100 text-blue-700",class_teacher:"bg-blue-100 text-blue-700",head_of_section:"bg-blue-100 text-blue-700",exam_officer:"bg-blue-100 text-blue-700",parent:"bg-green-100 text-green-700",student:"bg-cyan-100 text-cyan-700",librarian:"bg-amber-100 text-amber-700",receptionist:"bg-teal-100 text-teal-700",nurse:"bg-rose-100 text-rose-700",school_nurse:"bg-rose-100 text-rose-700",hostel_master:"bg-violet-100 text-violet-700",transport_manager:"bg-lime-100 text-lime-700",ict_officer:"bg-sky-100 text-sky-700",admin_staff:"bg-slate-100 text-slate-700",admissions:"bg-emerald-100 text-emerald-700"})[Te?.toLowerCase()]||"bg-gray-100 text-gray-700";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Rt,{className:"text-blue-600"})," User Management"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage users, roles, permissions, and security"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("input",{type:"file",ref:oe,accept:".csv",onChange:Ze,className:"hidden"}),e.jsxs("button",{onClick:()=>oe.current?.click(),className:"btn bg-green-600 text-white hover:bg-green-700 flex items-center gap-2",children:[e.jsx(Hr,{size:18})," Import"]}),e.jsxs("button",{onClick:me,className:"btn bg-blue-600 text-white hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(xs,{size:18})," Export"]}),e.jsxs("button",{onClick:ft,className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{size:18})," Add User"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 p-4 rounded-lg shadow-lg text-white",children:[e.jsx(Rt,{size:24,className:"mb-1"}),e.jsx("p",{className:"text-blue-100 text-xs",children:"Total Users"}),e.jsx("p",{className:"text-2xl font-bold",children:N.total||0})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-green-600 p-4 rounded-lg shadow-lg text-white",children:[e.jsx(Or,{size:24,className:"mb-1"}),e.jsx("p",{className:"text-green-100 text-xs",children:"Active"}),e.jsx("p",{className:"text-2xl font-bold",children:N.active||0})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 p-4 rounded-lg shadow-lg text-white",children:[e.jsx(Wt,{size:24,className:"mb-1"}),e.jsx("p",{className:"text-orange-100 text-xs",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold",children:N.pending||0})]}),e.jsxs("div",{className:"bg-gradient-to-br from-red-500 to-red-600 p-4 rounded-lg shadow-lg text-white",children:[e.jsx(Rh,{size:24,className:"mb-1"}),e.jsx("p",{className:"text-red-100 text-xs",children:"Inactive"}),e.jsx("p",{className:"text-2xl font-bold",children:N.inactive||0})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 p-4 rounded-lg shadow-lg text-white",children:[e.jsx(Ir,{size:24,className:"mb-1"}),e.jsx("p",{className:"text-purple-100 text-xs",children:"This Week"}),e.jsx("p",{className:"text-2xl font-bold",children:N.registered_week||0})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"border-b overflow-x-auto",children:e.jsx("div",{className:"flex",children:[{id:"users",label:"Users",icon:Rt},{id:"roles",label:"Roles & Permissions",icon:$r},{id:"activity",label:"Activity Logs",icon:Ir},{id:"login_history",label:"Login History",icon:Sa}].map(Te=>e.jsxs("button",{onClick:()=>s(Te.id),className:`px-6 py-4 font-medium whitespace-nowrap flex items-center gap-2 ${t===Te.id?"border-b-2 border-blue-600 text-blue-600":"text-gray-600"}`,children:[e.jsx(Te.icon,{size:18})," ",Te.label]},Te.id))})}),e.jsxs("div",{className:"p-6",children:[t==="users"&&e.jsxs("div",{children:[Ct.length>0&&e.jsxs("div",{className:"mb-6 bg-orange-50 border border-orange-200 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-orange-800 flex items-center gap-2 mb-3",children:[e.jsx(_s,{size:20})," Pending Registrations (",Ct.length,")"]}),e.jsx("div",{className:"space-y-2",children:Ct.map(Te=>e.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center text-orange-600 font-semibold",children:Te.name?.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:Te.name}),e.jsx("p",{className:"text-sm text-gray-500",children:Te.email})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("select",{id:`role-${Te.id}`,defaultValue:"teacher",className:"input text-sm py-1",children:l.map(bt=>e.jsx("option",{value:bt.role_name||bt.name,children:bt.display_name||bt.role_name||bt.name},bt.id))}),e.jsxs("button",{onClick:()=>Ie(Te.id,document.getElementById(`role-${Te.id}`).value),className:"btn bg-green-600 text-white hover:bg-green-700 py-1 px-3 text-sm flex items-center gap-1",children:[e.jsx(Mt,{size:16})," Approve"]}),e.jsxs("button",{onClick:()=>mt(Te.id),className:"btn bg-red-600 text-white hover:bg-red-700 py-1 px-3 text-sm flex items-center gap-1",children:[e.jsx(Js,{size:16})," Reject"]})]})]},Te.id))})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by name or email...",value:U,onChange:Te=>D(Te.target.value),className:"input pl-10 w-full"})]}),e.jsxs("select",{value:M,onChange:Te=>K(Te.target.value),className:"input w-48",children:[e.jsx("option",{value:"all",children:"All Roles"}),l.map(Te=>e.jsx("option",{value:Te.role_name||Te.name,children:Te.display_name||Te.role_name||Te.name},Te.id))]}),e.jsxs("select",{value:$,onChange:Te=>P(Te.target.value),className:"input w-40",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]}),Z.length>0&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>$t("activate"),className:"btn bg-green-100 text-green-700 hover:bg-green-200 text-sm",children:["Activate (",Z.length,")"]}),e.jsx("button",{onClick:()=>$t("deactivate"),className:"btn bg-yellow-100 text-yellow-700 hover:bg-yellow-200 text-sm",children:"Deactivate"}),e.jsx("button",{onClick:()=>$t("delete"),className:"btn bg-red-100 text-red-700 hover:bg-red-200 text-sm",children:"Delete"})]})]}),e.jsx("div",{className:"overflow-x-auto border rounded-lg",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left",children:e.jsx("input",{type:"checkbox",checked:Z.length===Rs.length&&Rs.length>0,onChange:Ue,className:"rounded"})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"User"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Contact"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Role"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Last Login"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Joined"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:y?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"px-4 py-8 text-center text-gray-500",children:"Loading..."})}):Rs.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"px-4 py-8 text-center text-gray-500",children:"No users found"})}):Rs.map(Te=>e.jsxs("tr",{className:`hover:bg-gray-50 ${Z.includes(Te.id)?"bg-blue-50":""}`,children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"checkbox",checked:Z.includes(Te.id),onChange:()=>lt(Te.id),className:"rounded"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 font-semibold text-sm",children:Te.name?.charAt(0)?.toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:Te.name}),e.jsx("p",{className:"text-sm text-gray-500",children:Te.email})]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[e.jsx(er,{size:14})," ",Te.phone||"-"]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${He(Te.user_type)}`,children:[e.jsx($r,{size:12})," ",Te.user_type]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Te.status==="active"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:Te.status})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:Te.last_login?new Date(Te.last_login).toLocaleDateString():"Never"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:new Date(Te.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx("button",{onClick:()=>qe(Te),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Edit",children:e.jsx(Na,{size:16})}),e.jsx("button",{onClick:()=>W(Te),className:"p-2 text-orange-600 hover:bg-orange-50 rounded-lg",title:"Reset Password",children:e.jsx(py,{size:16})}),e.jsx("button",{onClick:()=>pt(Te.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Delete",children:e.jsx(us,{size:16})})]})})]},Te.id))})]})})]}),t==="roles"&&e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("h3",{className:"text-lg font-semibold",children:"Roles & Permissions"})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l.map(Te=>e.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($r,{className:Te.is_system_role?"text-purple-600":"text-blue-600",size:20}),e.jsx("h4",{className:"font-semibold",children:Te.display_name})]}),Te.is_system_role&&e.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 rounded text-xs",children:"System"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:Te.description||"No description"}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("span",{className:"text-gray-500",children:[Te.user_count||0," users"]}),e.jsxs("button",{onClick:()=>Me(Te),className:"text-blue-600 hover:underline flex items-center gap-1",children:[e.jsx(na,{size:14})," View Permissions"]})]})]},Te.id))})]}),t==="activity"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Activity Logs"}),e.jsxs("button",{onClick:Ne,className:"btn bg-gray-100 hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ns,{size:16})," Refresh"]})]}),e.jsx("div",{className:"overflow-x-auto border rounded-lg",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"User"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Action"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Module"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"IP Address"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Time"})]})}),e.jsx("tbody",{className:"divide-y",children:u.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-4 py-8 text-center text-gray-500",children:"No activity logs"})}):u.map(Te=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:Te.user_name||"System"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${Te.action_type==="delete"?"bg-red-100 text-red-700":Te.action_type==="create"?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:Te.action_type})}),e.jsx("td",{className:"px-4 py-3 text-sm capitalize",children:Te.module}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 max-w-xs truncate",children:Te.description}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:Te.ip_address||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:new Date(Te.created_at).toLocaleString()})]},Te.id))})]})})]}),t==="login_history"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Login History"}),e.jsxs("button",{onClick:et,className:"btn bg-gray-100 hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ns,{size:16})," Refresh"]})]}),e.jsx("div",{className:"overflow-x-auto border rounded-lg",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"User"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"IP Address"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Device"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Login Time"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Logout Time"})]})}),e.jsx("tbody",{className:"divide-y",children:A.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-4 py-8 text-center text-gray-500",children:"No login history"})}):A.map(Te=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:Te.user_name}),e.jsx("p",{className:"text-xs text-gray-500",children:Te.user_email})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${Te.status==="success"?"bg-green-100 text-green-700":Te.status==="failed"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:Te.status})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:Te.ip_address||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 capitalize",children:Te.device_type||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:new Date(Te.login_time).toLocaleString()}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:Te.logout_time?new Date(Te.logout_time).toLocaleString():"-"})]},Te.id))})]})})]})]})]}),se&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[R==="user"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-bold",children:T?"Edit User":"Add New User"}),e.jsx("button",{onClick:()=>z(!1),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:e.jsx(Nt,{size:20})})]}),e.jsxs("form",{onSubmit:kt,className:"p-6",children:[e.jsx("div",{className:"mb-6 flex justify-center",children:T?e.jsx(p4,{type:"user",id:T.id,currentPicture:T.profile_picture,onUploadSuccess:()=>ve()}):e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden bg-gray-200 border-4 border-white shadow-lg mx-auto mb-3",children:k?e.jsx("img",{src:k,alt:"Preview",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-blue-500 to-purple-600",children:e.jsx(ha,{className:"w-12 h-12 text-white"})})}),e.jsx("input",{ref:w,type:"file",accept:"image/*",onChange:Ce,className:"hidden"}),e.jsxs("button",{type:"button",onClick:()=>w.current?.click(),className:"btn btn-sm bg-gray-200 hover:bg-gray-300 flex items-center gap-2 mx-auto",children:[e.jsx(Hr,{size:16})," ",H?"Change":"Upload"]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name *"}),e.jsx("input",{type:"text",required:!0,value:ne.name,onChange:Te=>Fe({...ne,name:Te.target.value}),className:"input",placeholder:"Enter full name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),e.jsx("input",{type:"email",required:!0,value:ne.email,onChange:Te=>Fe({...ne,email:Te.target.value}),className:"input",placeholder:"email@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",value:ne.phone,onChange:Te=>Fe({...ne,phone:Te.target.value}),className:"input",placeholder:"0244123456"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role *"}),e.jsx("select",{required:!0,value:ne.user_type,onChange:Te=>Fe({...ne,user_type:Te.target.value}),className:"input",children:l.map(Te=>e.jsx("option",{value:Te.role_name||Te.name,children:Te.display_name||Te.role_name||Te.name},Te.id))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Password ",!T&&"*"]}),e.jsx("input",{type:"password",required:!T,value:ne.password,onChange:Te=>Fe({...ne,password:Te.target.value}),className:"input",placeholder:T?"Leave blank to keep":"Enter password"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status *"}),e.jsxs("select",{required:!0,value:ne.status,onChange:Te=>Fe({...ne,status:Te.target.value}),className:"input",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:ne.must_change_password,onChange:Te=>Fe({...ne,must_change_password:Te.target.checked}),className:"rounded"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Require password change on first login"})]})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 mt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>z(!1),className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-primary",children:[T?"Update":"Add"," User"]})]})]})]}),R==="password"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Reset Password"}),e.jsx("button",{onClick:()=>z(!1),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:e.jsx(Nt,{size:20})})]}),e.jsxs("form",{onSubmit:J,className:"p-6",children:[e.jsxs("p",{className:"text-gray-600 mb-4",children:["Reset password for: ",e.jsx("strong",{children:T?.name})," (",T?.email,")"]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password *"}),e.jsx("input",{type:"password",required:!0,minLength:8,value:je.password,onChange:Te=>Ge({...je,password:Te.target.value}),className:"input",placeholder:"Minimum 8 characters"})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:je.must_change_password,onChange:Te=>Ge({...je,must_change_password:Te.target.checked}),className:"rounded"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Require password change on next login"})]})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>z(!1),className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn bg-orange-600 text-white hover:bg-orange-700",children:"Reset Password"})]})]})]}),R==="import"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Import Users"}),e.jsx("button",{onClick:()=>z(!1),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:e.jsx(Nt,{size:20})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("p",{className:"text-gray-600 mb-4",children:["Found ",e.jsx("strong",{children:ze.length})," users to import:"]}),e.jsx("div",{className:"max-h-60 overflow-y-auto border rounded-lg mb-4",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left",children:"Name"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Email"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Role"})]})}),e.jsx("tbody",{className:"divide-y",children:ze.map((Te,bt)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-3 py-2",children:Te.name}),e.jsx("td",{className:"px-3 py-2",children:Te.email}),e.jsx("td",{className:"px-3 py-2",children:Te.user_type||"teacher"})]},bt))})]})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>z(!1),className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg",children:"Cancel"}),e.jsxs("button",{onClick:ct,className:"btn bg-green-600 text-white hover:bg-green-700",children:["Import ",ze.length," Users"]})]})]})]}),R==="permissions"&&C&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx($r,{className:"text-purple-600"})," ",C.display_name]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Manage permissions for this role"})]}),e.jsx("button",{onClick:()=>z(!1),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:e.jsx(Nt,{size:20})})]}),e.jsx("div",{className:"p-6 max-h-[60vh] overflow-y-auto",children:Object.entries(ge.reduce((Te,bt)=>(Te[bt.module]=Te[bt.module]||[],Te[bt.module].push(bt),Te),{})).map(([Te,bt])=>e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 capitalize mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),Te.replace("_"," ")]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:bt.map(Xt=>{const ls=V.some(Ts=>Ts.id===Xt.id);return e.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-all ${ls?"bg-green-50 border-green-300":"bg-gray-50 border-gray-200 hover:border-gray-300"}`,children:[e.jsx("input",{type:"checkbox",checked:ls,onChange:()=>Se(Xt.id,ls),className:"w-4 h-4 text-green-600 rounded"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:Xt.display_name}),e.jsx("p",{className:"text-xs text-gray-500",children:Xt.description})]})]},Xt.id)})})]},Te))}),e.jsxs("div",{className:"flex justify-between items-center p-4 border-t bg-gray-50",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:V.length})," permissions assigned"]}),e.jsx("button",{onClick:()=>z(!1),className:"btn btn-primary",children:"Done"})]})]})]})}),_e&&Pe&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-3xl max-h-[90vh] overflow-hidden shadow-2xl",children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 p-6 text-white",children:[e.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(Rt,{size:24})," HR Employee Setup Wizard"]}),e.jsxs("p",{className:"text-purple-100 mt-1",children:["Complete employee details for: ",e.jsx("strong",{children:Pe.name})," (",Pe.user_type,")"]})]}),e.jsxs("form",{onSubmit:Je,className:"p-6 overflow-y-auto max-h-[60vh]",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm",children:"1"}),"Basic Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee ID *"}),e.jsx("input",{type:"text",required:!0,value:fe.employee_id,onChange:Te=>ye({...fe,employee_id:Te.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),e.jsxs("select",{value:fe.department,onChange:Te=>ye({...fe,department:Te.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select Department"}),e.jsx("option",{value:"academic",children:"Academic"}),e.jsx("option",{value:"administration",children:"Administration"}),e.jsx("option",{value:"finance",children:"Finance"}),e.jsx("option",{value:"hr",children:"Human Resources"}),e.jsx("option",{value:"it",children:"IT"}),e.jsx("option",{value:"library",children:"Library"}),e.jsx("option",{value:"sports",children:"Sports"}),e.jsx("option",{value:"maintenance",children:"Maintenance"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Designation"}),e.jsx("input",{type:"text",value:fe.designation,onChange:Te=>ye({...fe,designation:Te.target.value}),className:"input",placeholder:"e.g., Senior Teacher"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 bg-green-100 text-green-600 rounded-full flex items-center justify-center text-sm",children:"2"}),"Employment Details"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Joining *"}),e.jsx("input",{type:"date",required:!0,value:fe.date_of_joining,onChange:Te=>ye({...fe,date_of_joining:Te.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employment Type"}),e.jsxs("select",{value:fe.employment_type,onChange:Te=>ye({...fe,employment_type:Te.target.value}),className:"input",children:[e.jsx("option",{value:"full_time",children:"Full Time"}),e.jsx("option",{value:"part_time",children:"Part Time"}),e.jsx("option",{value:"contract",children:"Contract"}),e.jsx("option",{value:"temporary",children:"Temporary"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Salary Grade"}),e.jsx("input",{type:"text",value:fe.salary_grade,onChange:Te=>ye({...fe,salary_grade:Te.target.value}),className:"input",placeholder:"e.g., Grade A"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 bg-orange-100 text-orange-600 rounded-full flex items-center justify-center text-sm",children:"3"}),"Personal Details"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth"}),e.jsx("input",{type:"date",value:fe.date_of_birth,onChange:Te=>ye({...fe,date_of_birth:Te.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender"}),e.jsxs("select",{value:fe.gender,onChange:Te=>ye({...fe,gender:Te.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select Gender"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"National ID"}),e.jsx("input",{type:"text",value:fe.national_id,onChange:Te=>ye({...fe,national_id:Te.target.value}),className:"input",placeholder:"ID Number"})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsx("input",{type:"text",value:fe.address,onChange:Te=>ye({...fe,address:Te.target.value}),className:"input",placeholder:"Full address"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 bg-purple-100 text-purple-600 rounded-full flex items-center justify-center text-sm",children:"4"}),"Banking & Emergency Contact"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Name"}),e.jsx("input",{type:"text",value:fe.bank_name,onChange:Te=>ye({...fe,bank_name:Te.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Account Number"}),e.jsx("input",{type:"text",value:fe.bank_account,onChange:Te=>ye({...fe,bank_account:Te.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Emergency Contact Name"}),e.jsx("input",{type:"text",value:fe.emergency_contact_name,onChange:Te=>ye({...fe,emergency_contact_name:Te.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Emergency Contact Phone"}),e.jsx("input",{type:"tel",value:fe.emergency_contact_phone,onChange:Te=>ye({...fe,emergency_contact_phone:Te.target.value}),className:"input"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 bg-teal-100 text-teal-600 rounded-full flex items-center justify-center text-sm",children:"5"}),"Qualifications"]}),e.jsx("textarea",{value:fe.qualifications,onChange:Te=>ye({...fe,qualifications:Te.target.value}),className:"input w-full",rows:3,placeholder:"List qualifications, certifications, degrees..."})]})]}),e.jsxs("div",{className:"flex justify-between items-center p-4 border-t bg-gray-50",children:[e.jsx("button",{type:"button",onClick:_t,className:"px-4 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg",children:"Skip for Now"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:_t,className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg",children:"Cancel"}),e.jsx("button",{type:"submit",onClick:Je,className:"btn bg-purple-600 text-white hover:bg-purple-700",children:"Save Employee Details"})]})]})]})})]})}const uc=`${ee}/student_management.php`,h7=`${ee}/students.php`;function p7(){const t=la(),[s,a]=h.useState("students"),[r,l]=h.useState([]),[c,o]=h.useState({}),[m,u]=h.useState([]),[x,A]=h.useState(!0),[g,N]=h.useState(""),[f,y]=h.useState("all"),[v,U]=h.useState("all"),[D,M]=h.useState([]),[K,$]=h.useState(!1),[P,se]=h.useState("student"),[z,R]=h.useState(null),[j,T]=h.useState([]),Q=h.useRef(null),[E,te]=h.useState({page:1,limit:50,total:0,pages:1}),[C,O]=h.useState({student_id:"",first_name:"",last_name:"",other_names:"",date_of_birth:"",gender:"male",blood_group:"",nationality:"Ghanaian",religion:"",email:"",phone:"",address:"",city:"",region:"",class_id:"",admission_date:"",status:"active",guardian_name:"",guardian_phone:"",guardian_email:"",guardian_relationship:"",emergency_contact_name:"",emergency_contact_phone:"",medical_conditions:"",allergies:""}),[V,re]=h.useState({student_ids:[],to_class_id:"",promotion_type:"promotion",promotion_date:new Date().toISOString().split("T")[0]});h.useEffect(()=>{ge(),xe(),Z()},[]);const ge=async()=>{try{A(!0);const le=new URLSearchParams({page:E.page,limit:E.limit});g&&le.append("search",g),f!=="all"&&le.append("status",f),v!=="all"&&le.append("class_id",v);const Pe=await F.get(`${uc}?resource=students&${le}`);l(Pe.data.students||[]),Pe.data.pagination&&te(Pe.data.pagination)}catch(le){console.error(le);try{const Pe=await F.get(h7);l(Pe.data.students||[])}catch(Pe){console.error(Pe)}}finally{A(!1)}},xe=async()=>{try{const le=await F.get(`${uc}?resource=stats`);o(le.data.stats||{})}catch(le){console.error(le)}},Z=async()=>{try{const le=await F.get(`${ee}/classes.php`);u(le.data.classes||[])}catch(le){console.error(le)}},I=()=>{R(null);const le=new Date().getFullYear();O({student_id:`STU${le}${String(r.length+1).padStart(4,"0")}`,first_name:"",last_name:"",other_names:"",date_of_birth:"",gender:"male",blood_group:"",nationality:"Ghanaian",religion:"",email:"",phone:"",address:"",city:"",region:"",class_id:"",admission_date:new Date().toISOString().split("T")[0],status:"active",guardian_name:"",guardian_phone:"",guardian_email:"",guardian_relationship:"",emergency_contact_name:"",emergency_contact_phone:"",medical_conditions:"",allergies:""}),se("student"),$(!0)},H=le=>{R(le),O({...le,date_of_birth:le.date_of_birth?.split("T")[0]||"",admission_date:le.admission_date?.split("T")[0]||""}),se("student"),$(!0)},ae=async le=>{le.preventDefault();try{z?(await F.put(`${uc}?resource=students&id=${z.id}`,C),alert("Student updated successfully!")):(await F.post(`${uc}?resource=students`,C),alert("Student created successfully!")),$(!1),ge(),xe()}catch(Pe){console.error(Pe),alert(Pe.response?.data?.error||"Failed to save student")}},k=async le=>{if(window.confirm("Are you sure you want to delete this student?"))try{await F.delete(`${uc}?resource=students&id=${le}`),ge(),xe(),alert("Student deleted!")}catch{alert("Failed to delete student")}},B=async()=>{if(D.length===0)return alert("No students selected");if(window.confirm(`Delete ${D.length} students?`))try{await F.post(`${uc}?resource=bulk&action=delete`,{student_ids:D}),M([]),ge(),xe(),alert("Students deleted!")}catch{alert("Failed to delete students")}},w=async le=>{if(D.length===0)return alert("No students selected");try{await F.post(`${uc}?resource=bulk&action=update_status`,{student_ids:D,status:le}),M([]),ge(),xe(),alert("Status updated!")}catch{alert("Failed to update status")}},oe=async()=>{try{const Pe=(await F.post(`${uc}?resource=bulk&action=export`,{filters:{status:f!=="all"?f:"",class_id:v!=="all"?v:""}})).data.students||[];if(Pe.length===0)return alert("No students to export");const fe=[["Student ID","First Name","Last Name","Gender","Date of Birth","Email","Phone","Class","Status","Guardian Name","Guardian Phone"].join(","),...Pe.map(ie=>[ie.student_id,ie.first_name,ie.last_name,ie.gender,ie.date_of_birth,ie.email,ie.phone,ie.class_name,ie.status,ie.guardian_name,ie.guardian_phone].map(q=>`"${q||""}"`).join(","))].join(`
`),ye=new Blob([fe],{type:"text/csv"}),Ke=URL.createObjectURL(ye),ve=document.createElement("a");ve.href=Ke,ve.download=`students_${new Date().toISOString().split("T")[0]}.csv`,ve.click()}catch{alert("Export failed")}},ne=le=>{const Pe=le.target.files[0];if(!Pe)return;const we=new FileReader;we.onload=fe=>{const Ke=fe.target.result.split(`
`).filter(q=>q.trim()),ve=Ke[0].split(",").map(q=>q.trim().toLowerCase().replace(/['"]/g,"").replace(/ /g,"_")),ie=Ke.slice(1).map(q=>{const pe=q.split(",").map(Se=>Se.trim().replace(/['"]/g,"")),Me={};return ve.forEach((Se,Ne)=>{Me[Se]=pe[Ne]||""}),Me}).filter(q=>q.first_name||q.last_name);T(ie),se("import"),$(!0)},we.readAsText(Pe),le.target.value=""},Fe=async()=>{try{const le=await F.post(`${uc}?resource=bulk&action=import`,{students:j});alert(le.data.message),$(!1),T([]),ge(),xe()}catch{alert("Import failed")}},je=()=>{if(D.length===0)return alert("Select students to promote");re({...V,student_ids:D}),se("promotion"),$(!0)},Ge=async()=>{if(!V.to_class_id)return alert("Select target class");try{await F.post(`${uc}?resource=promotions&action=bulk`,V),alert("Students promoted successfully!"),$(!1),M([]),ge()}catch{alert("Promotion failed")}},ze=async()=>{if(D.length===0)return alert("Select students");try{await F.post(`${uc}?resource=bulk&action=generate_id_cards`,{student_ids:D}),alert("ID cards generated!"),M([])}catch{alert("Failed to generate ID cards")}},Xe=le=>M(Pe=>Pe.includes(le)?Pe.filter(we=>we!==le):[...Pe,le]),st=()=>M(D.length===ce.length?[]:ce.map(le=>le.id)),ce=r.filter(le=>le?.first_name?`${le.first_name} ${le.last_name}`.toLowerCase().includes(g.toLowerCase())||le.student_id?.toLowerCase().includes(g.toLowerCase()):!1),_e={active:"bg-green-100 text-green-700",inactive:"bg-gray-100 text-gray-700",graduated:"bg-blue-100 text-blue-700",transferred:"bg-orange-100 text-orange-700",suspended:"bg-red-100 text-red-700"};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Rt,{className:"text-blue-600"})," Student Management"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage students, documents, promotions, and records"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("input",{type:"file",ref:Q,accept:".csv",onChange:ne,className:"hidden"}),e.jsxs("button",{onClick:()=>Q.current?.click(),className:"btn bg-green-600 text-white hover:bg-green-700 flex items-center gap-2",children:[e.jsx(Hr,{size:18})," Import"]}),e.jsxs("button",{onClick:oe,className:"btn bg-blue-600 text-white hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(xs,{size:18})," Export"]}),e.jsxs("button",{onClick:I,className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{size:18})," Add Student"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 p-4 rounded-lg shadow-lg text-white",children:[e.jsx(Rt,{size:24,className:"mb-1"}),e.jsx("p",{className:"text-blue-100 text-xs",children:"Total Students"}),e.jsx("p",{className:"text-2xl font-bold",children:c.total||0})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-green-600 p-4 rounded-lg shadow-lg text-white",children:[e.jsx(Or,{size:24,className:"mb-1"}),e.jsx("p",{className:"text-green-100 text-xs",children:"Active"}),e.jsx("p",{className:"text-2xl font-bold",children:c.by_status?.find(le=>le.status==="active")?.count||0})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 p-4 rounded-lg shadow-lg text-white",children:[e.jsx(Qs,{size:24,className:"mb-1"}),e.jsx("p",{className:"text-purple-100 text-xs",children:"Graduated"}),e.jsx("p",{className:"text-2xl font-bold",children:c.by_status?.find(le=>le.status==="graduated")?.count||0})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 p-4 rounded-lg shadow-lg text-white",children:[e.jsx(Wt,{size:24,className:"mb-1"}),e.jsx("p",{className:"text-orange-100 text-xs",children:"New This Month"}),e.jsx("p",{className:"text-2xl font-bold",children:c.new_this_month||0})]}),e.jsxs("div",{className:"bg-gradient-to-br from-cyan-500 to-cyan-600 p-4 rounded-lg shadow-lg text-white",children:[e.jsx(Ot,{size:24,className:"mb-1"}),e.jsx("p",{className:"text-cyan-100 text-xs",children:"New This Week"}),e.jsx("p",{className:"text-2xl font-bold",children:c.new_this_week||0})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",placeholder:"Search students...",value:g,onChange:le=>N(le.target.value),className:"pl-10 pr-4 py-2 border rounded-lg w-64"})]}),e.jsxs("select",{value:f,onChange:le=>y(le.target.value),className:"border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"graduated",children:"Graduated"}),e.jsx("option",{value:"transferred",children:"Transferred"}),e.jsx("option",{value:"suspended",children:"Suspended"})]}),e.jsxs("select",{value:v,onChange:le=>U(le.target.value),className:"border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"all",children:"All Classes"}),m.map(le=>e.jsx("option",{value:le.id,children:le.class_name},le.id))]}),e.jsxs("button",{onClick:ge,className:"btn bg-gray-100 hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ns,{size:16})," Refresh"]})]}),D.length>0&&e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[D.length," selected"]}),e.jsxs("button",{onClick:je,className:"btn bg-purple-600 text-white hover:bg-purple-700 text-sm",children:[e.jsx(Li,{size:16})," Promote"]}),e.jsxs("button",{onClick:ze,className:"btn bg-blue-600 text-white hover:bg-blue-700 text-sm",children:[e.jsx(aa,{size:16})," ID Cards"]}),e.jsxs("button",{onClick:()=>w("inactive"),className:"btn bg-orange-600 text-white hover:bg-orange-700 text-sm",children:[e.jsx(Rh,{size:16})," Deactivate"]}),e.jsxs("button",{onClick:B,className:"btn bg-red-600 text-white hover:bg-red-700 text-sm",children:[e.jsx(us,{size:16})," Delete"]})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left",children:e.jsx("input",{type:"checkbox",checked:D.length===ce.length&&ce.length>0,onChange:st,className:"rounded"})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Student"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Class"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Gender"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Guardian"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:x?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"px-4 py-8 text-center text-gray-500",children:"Loading..."})}):ce.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"px-4 py-8 text-center text-gray-500",children:"No students found"})}):ce.map(le=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"checkbox",checked:D.includes(le.id),onChange:()=>Xe(le.id),className:"rounded"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-semibold",children:[le.first_name?.[0],le.last_name?.[0]]}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900",children:[le.first_name," ",le.last_name]}),e.jsx("p",{className:"text-sm text-gray-500",children:le.email||"No email"})]})]})}),e.jsx("td",{className:"px-4 py-3 text-sm font-mono text-gray-600",children:le.student_id}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:le.class_name||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 capitalize",children:le.gender}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("p",{className:"text-sm text-gray-900",children:le.guardian_name||"-"}),e.jsx("p",{className:"text-xs text-gray-500",children:le.guardian_phone||""})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${_e[le.status]||"bg-gray-100 text-gray-700"}`,children:le.status})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>t(`/admin/students/${le.id}`),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"View Profile",children:e.jsx(na,{size:18})}),e.jsx("button",{onClick:()=>H(le),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Edit",children:e.jsx(Na,{size:18})}),e.jsx("button",{onClick:()=>k(le.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:e.jsx(us,{size:18})})]})})]},le.id))})]})}),E.pages>1&&e.jsxs("div",{className:"px-4 py-3 border-t flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",(E.page-1)*E.limit+1," to ",Math.min(E.page*E.limit,E.total)," of ",E.total]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>te(le=>({...le,page:le.page-1})),disabled:E.page===1,className:"px-3 py-1 border rounded disabled:opacity-50",children:"Previous"}),e.jsx("button",{onClick:()=>te(le=>({...le,page:le.page+1})),disabled:E.page===E.pages,className:"px-3 py-1 border rounded disabled:opacity-50",children:"Next"})]})]})]}),K&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[P==="student"&&e.jsxs("form",{onSubmit:ae,children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-bold",children:z?"Edit Student":"Add New Student"}),e.jsx("button",{type:"button",onClick:()=>$(!1),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:e.jsx(Nt,{size:20})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student ID"}),e.jsx("input",{type:"text",value:C.student_id,onChange:le=>O({...C,student_id:le.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),e.jsx("input",{type:"text",required:!0,value:C.first_name,onChange:le=>O({...C,first_name:le.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name *"}),e.jsx("input",{type:"text",required:!0,value:C.last_name,onChange:le=>O({...C,last_name:le.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Other Names"}),e.jsx("input",{type:"text",value:C.other_names,onChange:le=>O({...C,other_names:le.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth"}),e.jsx("input",{type:"date",value:C.date_of_birth,onChange:le=>O({...C,date_of_birth:le.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender"}),e.jsxs("select",{value:C.gender,onChange:le=>O({...C,gender:le.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Blood Group"}),e.jsxs("select",{value:C.blood_group,onChange:le=>O({...C,blood_group:le.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"A+",children:"A+"}),e.jsx("option",{value:"A-",children:"A-"}),e.jsx("option",{value:"B+",children:"B+"}),e.jsx("option",{value:"B-",children:"B-"}),e.jsx("option",{value:"AB+",children:"AB+"}),e.jsx("option",{value:"AB-",children:"AB-"}),e.jsx("option",{value:"O+",children:"O+"}),e.jsx("option",{value:"O-",children:"O-"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nationality"}),e.jsx("input",{type:"text",value:C.nationality,onChange:le=>O({...C,nationality:le.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Religion"}),e.jsx("input",{type:"text",value:C.religion,onChange:le=>O({...C,religion:le.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"Contact Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:C.email,onChange:le=>O({...C,email:le.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",value:C.phone,onChange:le=>O({...C,phone:le.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),e.jsx("input",{type:"text",value:C.city,onChange:le=>O({...C,city:le.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsx("input",{type:"text",value:C.address,onChange:le=>O({...C,address:le.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Region"}),e.jsx("input",{type:"text",value:C.region,onChange:le=>O({...C,region:le.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"Academic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),e.jsxs("select",{value:C.class_id,onChange:le=>O({...C,class_id:le.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Select Class"}),m.map(le=>e.jsx("option",{value:le.id,children:le.class_name},le.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Admission Date"}),e.jsx("input",{type:"date",value:C.admission_date,onChange:le=>O({...C,admission_date:le.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:C.status,onChange:le=>O({...C,status:le.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"graduated",children:"Graduated"}),e.jsx("option",{value:"transferred",children:"Transferred"}),e.jsx("option",{value:"suspended",children:"Suspended"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"Guardian Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Guardian Name"}),e.jsx("input",{type:"text",value:C.guardian_name,onChange:le=>O({...C,guardian_name:le.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Guardian Phone"}),e.jsx("input",{type:"tel",value:C.guardian_phone,onChange:le=>O({...C,guardian_phone:le.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Guardian Email"}),e.jsx("input",{type:"email",value:C.guardian_email,onChange:le=>O({...C,guardian_email:le.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Relationship"}),e.jsxs("select",{value:C.guardian_relationship,onChange:le=>O({...C,guardian_relationship:le.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"father",children:"Father"}),e.jsx("option",{value:"mother",children:"Mother"}),e.jsx("option",{value:"guardian",children:"Guardian"}),e.jsx("option",{value:"other",children:"Other"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"Medical Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Medical Conditions"}),e.jsx("textarea",{value:C.medical_conditions,onChange:le=>O({...C,medical_conditions:le.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:"2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Allergies"}),e.jsx("textarea",{value:C.allergies,onChange:le=>O({...C,allergies:le.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:"2"})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 p-6 border-t bg-gray-50",children:[e.jsx("button",{type:"button",onClick:()=>$(!1),className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:z?"Update Student":"Create Student"})]})]}),P==="import"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Import Students"}),e.jsx("button",{onClick:()=>$(!1),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:e.jsx(Nt,{size:20})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("p",{className:"text-gray-600 mb-4",children:["Found ",e.jsx("strong",{children:j.length})," students to import:"]}),e.jsx("div",{className:"max-h-60 overflow-y-auto border rounded-lg mb-4",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left",children:"Name"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Gender"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Guardian"})]})}),e.jsx("tbody",{className:"divide-y",children:j.map((le,Pe)=>e.jsxs("tr",{children:[e.jsxs("td",{className:"px-3 py-2",children:[le.first_name," ",le.last_name]}),e.jsx("td",{className:"px-3 py-2",children:le.gender||"-"}),e.jsx("td",{className:"px-3 py-2",children:le.guardian_name||"-"})]},Pe))})]})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>$(!1),className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg",children:"Cancel"}),e.jsxs("button",{onClick:Fe,className:"btn bg-green-600 text-white hover:bg-green-700",children:["Import ",j.length," Students"]})]})]})]}),P==="promotion"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(Li,{className:"text-purple-600"})," Promote Students"]}),e.jsx("button",{onClick:()=>$(!1),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:e.jsx(Nt,{size:20})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("p",{className:"text-gray-600",children:["Promoting ",e.jsx("strong",{children:V.student_ids.length})," students"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Target Class *"}),e.jsxs("select",{value:V.to_class_id,onChange:le=>re({...V,to_class_id:le.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select Class"}),m.map(le=>e.jsx("option",{value:le.id,children:le.class_name},le.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Promotion Type"}),e.jsxs("select",{value:V.promotion_type,onChange:le=>re({...V,promotion_type:le.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"promotion",children:"Promotion"}),e.jsx("option",{value:"demotion",children:"Demotion"}),e.jsx("option",{value:"transfer",children:"Transfer"}),e.jsx("option",{value:"repeat",children:"Repeat"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Promotion Date"}),e.jsx("input",{type:"date",value:V.promotion_date,onChange:le=>re({...V,promotion_date:le.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{onClick:()=>$(!1),className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg",children:"Cancel"}),e.jsx("button",{onClick:Ge,className:"btn bg-purple-600 text-white hover:bg-purple-700",children:"Promote Students"})]})]})]})]})})]})}const zN="323px",GN="204px",A7=(t,s)=>{const a=new Image;a.crossOrigin="Anonymous",a.onload=()=>{const r=document.createElement("canvas"),l=r.getContext("2d");r.width=a.width,r.height=a.height,l.drawImage(a,0,0);try{const o=l.getImageData(0,0,r.width,r.height).data,m={};for(let x=0;x<o.length;x+=16){const A=o[x],g=o[x+1],N=o[x+2];if(o[x+3]<128||A>240&&g>240&&N>240||A<15&&g<15&&N<15)continue;const y=Math.round(A/32)*32,v=Math.round(g/32)*32,U=Math.round(N/32)*32,D=`${y},${v},${U}`;m[D]=(m[D]||0)+1}const u=Object.entries(m).sort((x,A)=>A[1]-x[1]).slice(0,5).map(([x])=>{const[A,g,N]=x.split(",").map(Number);return`rgb(${A},${g},${N})`});u.length>=2?s(u[0],u[1]):u.length===1&&s(u[0],u[0])}catch{console.log("Could not extract colors from logo")}},a.onerror=()=>{console.log("Could not load logo image for color extraction")},a.src=t};function g7({student:t,schoolSettings:s,apiBaseUrl:a}){const[r,l]=h.useState("#1e40af"),[c,o]=h.useState("#3b82f6"),m=h.useRef(!1);h.useEffect(()=>{s.school_logo&&!m.current&&(m.current=!0,A7(s.school_logo,(A,g)=>{l(A),o(g)}))},[s.school_logo]);const u=()=>{const A=t.profile_picture||t.photo||t.id_card?.photo_path;if(!A)return null;if(A.startsWith("http"))return A;const g=A.replace(/^\/?(uploads\/)?/,"");return`${a.replace("/backend/api","")}/uploads/${g}`},x=()=>{const A=window.open("","_blank");A.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Student ID Card - ${t.first_name} ${t.last_name}</title>
          <style>
            @page {
              size: 85.6mm 53.98mm;
              margin: 0;
            }
            * { margin: 0; padding: 0; box-sizing: border-box; -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; color-adjust: exact !important; }
            body { font-family: Arial, sans-serif; }
            .page { page-break-after: always; width: 85.6mm; height: 53.98mm; }
            .page:last-child { page-break-after: auto; }
            .id-card { width: 85.6mm; height: 53.98mm; border-radius: 3mm; overflow: hidden; position: relative; }
            .id-card-front { background: linear-gradient(135deg, ${r} 0%, ${c} 100%); }
            .id-card-back { background: #ffffff; border: 1px solid #e5e7eb; }
            .header { background: rgba(255,255,255,0.15); padding: 2mm; display: flex; align-items: center; gap: 2mm; border-bottom: 0.5mm solid rgba(255,255,255,0.2); }
            .logo { width: 10mm; height: 10mm; border-radius: 50%; object-fit: cover; background: white; padding: 0.5mm; }
            .logo-placeholder { width: 10mm; height: 10mm; border-radius: 50%; background: rgba(255,255,255,0.2); display: flex; align-items: center; justify-content: center; }
            .school-name { flex: 1; text-align: center; color: white; }
            .school-name h1 { font-size: 8pt; font-weight: bold; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 1px; }
            .school-name p { font-size: 6pt; opacity: 0.9; }
            .title-bar { background: #f59e0b; color: white; text-align: center; font-size: 6pt; font-weight: bold; padding: 1mm 0; letter-spacing: 1px; }
            .content { padding: 2mm; display: flex; gap: 2mm; color: white; }
            .photo { width: 18mm; height: 22mm; border-radius: 1.5mm; object-fit: cover; border: 0.5mm solid white; flex-shrink: 0; }
            .photo-placeholder { width: 18mm; height: 22mm; border-radius: 1.5mm; background: rgba(255,255,255,0.2); display: flex; align-items: center; justify-content: center; border: 0.5mm solid rgba(255,255,255,0.5); flex-shrink: 0; }
            .details { flex: 1; font-size: 6pt; }
            .details .name { font-size: 9pt; font-weight: bold; margin-bottom: 1mm; line-height: 1.2; }
            .details .student-id { font-size: 6pt; opacity: 0.8; font-family: monospace; margin-bottom: 2mm; }
            .details .info-row { display: flex; margin-bottom: 0.5mm; }
            .details .label { opacity: 0.7; width: 12mm; }
            .details .value { font-weight: 600; }
            .footer { position: absolute; bottom: 0; left: 0; right: 0; padding: 1.5mm 2mm; border-top: 0.3mm solid rgba(255,255,255,0.2); display: flex; justify-content: space-between; font-size: 5pt; color: white; }
            .footer .card-no { font-family: monospace; font-weight: bold; letter-spacing: 0.5px; }
            
            /* Back card styles */
            .back-header { background: ${r}; color: white; text-align: center; padding: 1.5mm; font-size: 7pt; font-weight: bold; text-transform: uppercase; }
            .back-content { padding: 2mm; display: flex; gap: 2mm; }
            .emergency { flex: 1; font-size: 6pt; color: #374151; }
            .emergency h3 { font-size: 6pt; font-weight: bold; color: ${r}; margin-bottom: 1mm; text-transform: uppercase; }
            .emergency .row { margin-bottom: 0.5mm; }
            .emergency .label { color: #6b7280; }
            .qr-section { text-align: center; }
            .qr-code { width: 14mm; height: 14mm; border: 0.3mm solid #e5e7eb; border-radius: 1mm; }
            .qr-label { font-size: 5pt; color: #9ca3af; margin-top: 0.5mm; }
            .back-footer { position: absolute; bottom: 0; left: 0; right: 0; padding: 1.5mm 2mm; border-top: 0.3mm solid #e5e7eb; text-align: center; font-size: 5pt; color: #6b7280; }
            .back-footer .school { font-weight: 600; color: ${r}; margin-bottom: 0.5mm; }
            .back-footer .contact { font-size: 5pt; }
            .back-footer .return-msg { font-size: 4.5pt; color: #9ca3af; margin-top: 1mm; font-style: italic; }
            
            @media print {
              body { margin: 0; }
              .page { margin: 0; }
            }
          </style>
        </head>
        <body>
          <!-- Front of Card -->
          <div class="page">
            <div class="id-card id-card-front">
              <div class="header">
                ${s.school_logo?`<img src="${s.school_logo}" class="logo" alt="Logo" />`:'<div class="logo-placeholder"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M22 10v6M2 10l10-5 10 5-10 5z"/><path d="M6 12v5c3 3 9 3 12 0v-5"/></svg></div>'}
                <div class="school-name">
                  <h1>${s.school_name||"School Name"}</h1>
                  <p>${s.school_phone||""}</p>
                </div>
              </div>
              <div class="title-bar">STUDENT IDENTITY CARD</div>
              <div class="content">
                ${u()?`<img src="${u()}" class="photo" alt="${t.first_name}" />`:'<div class="photo-placeholder"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="rgba(255,255,255,0.7)" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg></div>'}
                <div class="details">
                  <div class="name">${t.first_name} ${t.last_name}</div>
                  <div class="student-id">${t.student_id}</div>
                  <div class="info-row"><span class="label">Class:</span><span class="value">${t.class_name||"N/A"}</span></div>
                  <div class="info-row"><span class="label">Teacher:</span><span class="value">${t.class_teacher||"N/A"}</span></div>
                  <div class="info-row"><span class="label">Gender:</span><span class="value" style="text-transform:capitalize">${t.gender}</span></div>
                  <div class="info-row"><span class="label">Admitted:</span><span class="value">${new Date(t.admission_date).getFullYear()}</span></div>
                </div>
              </div>
              <div class="footer">
                <div><span style="opacity:0.7">Card No:</span> <span class="card-no">${t.id_card?.card_number||""}</span></div>
                <div><span style="opacity:0.7">Valid:</span> ${t.id_card?new Date(t.id_card.expiry_date).toLocaleDateString("en-GB",{month:"short",year:"numeric"}):""}</div>
              </div>
            </div>
          </div>
          
          <!-- Back of Card -->
          <div class="page">
            <div class="id-card id-card-back">
              <div class="back-header">Emergency Contact Information</div>
              <div class="back-content">
                <div class="emergency">
                  <div class="row"><span class="label">Guardian: </span>${t.guardian_name||"N/A"}</div>
                  <div class="row"><span class="label">Phone: </span>${t.guardian_phone||"N/A"}</div>
                  <div class="row"><span class="label">Address: </span>${t.address||"N/A"}</div>
                </div>
                <div class="qr-section">
                  <img src="https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=${encodeURIComponent(s.school_website||s.school_email||"https://school.edu")}" class="qr-code" alt="QR" />
                  <div class="qr-label">Scan Me</div>
                </div>
              </div>
              <div class="back-footer">
                <div class="school">${s.school_name||"School Name"}</div>
                <div class="contact">${s.school_address||""}</div>
                <div class="contact">Tel: ${s.school_phone||""} | ${s.school_email||""}</div>
                <div class="return-msg">If found, please return to the school address above.</div>
              </div>
            </div>
          </div>
        </body>
      </html>
    `),A.document.close(),A.focus(),setTimeout(()=>{A.print()},500)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Card Theme:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:r.startsWith("rgb")?"#1e40af":r,onChange:A=>l(A.target.value),className:"w-8 h-8 rounded cursor-pointer border-2 border-gray-300",title:"Primary color"}),e.jsx("input",{type:"color",value:c.startsWith("rgb")?"#3b82f6":c,onChange:A=>o(A.target.value),className:"w-8 h-8 rounded cursor-pointer border-2 border-gray-300",title:"Secondary color"})]}),e.jsx("span",{className:"text-xs text-gray-500",children:"(Auto-extracted from logo)"})]}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-6",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Front"}),e.jsxs("div",{className:"rounded-xl overflow-hidden shadow-xl",style:{width:zN,height:GN,background:`linear-gradient(135deg, ${r} 0%, ${c} 100%)`},children:[e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white/10 border-b border-white/20",children:[s.school_logo?e.jsx("img",{src:s.school_logo,alt:"Logo",className:"w-10 h-10 rounded-full object-cover bg-white p-0.5"}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-white/20 flex items-center justify-center",children:e.jsx(Qs,{className:"text-white",size:20})}),e.jsxs("div",{className:"flex-1 text-center text-white",children:[e.jsx("h4",{className:"font-bold text-xs uppercase tracking-wide",children:s.school_name||"School Name"}),e.jsx("p",{className:"text-[10px] text-white/80",children:s.school_phone})]})]}),e.jsx("div",{className:"bg-amber-500 text-white text-center text-[10px] font-bold py-0.5 tracking-wider",children:"STUDENT IDENTITY CARD"}),e.jsxs("div",{className:"p-2 flex gap-2 text-white",children:[u()?e.jsx("img",{src:u(),alt:t.first_name,className:"w-16 h-20 rounded object-cover border-2 border-white flex-shrink-0"}):e.jsx("div",{className:"w-16 h-20 rounded bg-white/20 flex items-center justify-center border border-white/50 flex-shrink-0",children:e.jsx(ha,{className:"text-white/70",size:28})}),e.jsxs("div",{className:"flex-1 text-[10px]",children:[e.jsxs("p",{className:"font-bold text-sm leading-tight",children:[t.first_name," ",t.last_name]}),e.jsx("p",{className:"text-white/70 font-mono text-[9px]",children:t.student_id}),e.jsxs("div",{className:"mt-1 space-y-0.5",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-white/60",children:"Class:"})," ",e.jsx("span",{className:"font-semibold",children:t.class_name||"N/A"})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-white/60",children:"Teacher:"})," ",e.jsx("span",{className:"font-semibold",children:t.class_teacher||"N/A"})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-white/60",children:"Gender:"})," ",e.jsx("span",{className:"capitalize",children:t.gender})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-white/60",children:"Admitted:"})," ",new Date(t.admission_date).getFullYear()]})]})]})]}),e.jsxs("div",{className:"px-2 py-1 border-t border-white/20 flex justify-between text-[9px] text-white",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-white/60",children:"Card No:"})," ",e.jsx("span",{className:"font-mono font-bold",children:t.id_card?.card_number})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-white/60",children:"Valid:"})," ",t.id_card&&new Date(t.id_card.expiry_date).toLocaleDateString("en-GB",{month:"short",year:"numeric"})]})]})]})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Back"}),e.jsxs("div",{className:"rounded-xl overflow-hidden shadow-xl bg-white border border-gray-200",style:{width:zN,height:GN},children:[e.jsx("div",{className:"text-white text-center text-[10px] font-bold py-1 uppercase tracking-wide",style:{background:r},children:"Emergency Contact Information"}),e.jsxs("div",{className:"p-2 flex gap-2",children:[e.jsx("div",{className:"flex-1 text-[10px] text-gray-700",children:e.jsxs("div",{className:"space-y-0.5",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Guardian:"})," ",t.guardian_name||"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Phone:"})," ",t.guardian_phone||"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Address:"})," ",t.address||"N/A"]})]})}),e.jsxs("div",{className:"flex-shrink-0 text-center",children:[e.jsx("img",{src:`https://api.qrserver.com/v1/create-qr-code/?size=60x60&data=${encodeURIComponent(s.school_website||s.school_email||"https://school.edu")}`,alt:"QR",className:"w-12 h-12 border rounded"}),e.jsx("p",{className:"text-[8px] text-gray-400 mt-0.5",children:"Scan Me"})]})]}),e.jsxs("div",{className:"px-2 py-1 border-t text-center text-[9px]",children:[e.jsx("p",{className:"font-semibold",style:{color:r},children:s.school_name}),e.jsx("p",{className:"text-gray-500 text-[8px]",children:s.school_address}),e.jsxs("p",{className:"text-gray-500 text-[8px]",children:["Tel: ",s.school_phone," | ",s.school_email]}),e.jsx("p",{className:"text-gray-400 text-[7px] italic mt-0.5",children:"If found, please return to the school address above."})]})]})]})]}),e.jsxs("div",{className:"text-center pt-2",children:[e.jsxs("button",{onClick:x,className:"btn bg-gray-700 text-white hover:bg-gray-800 px-6 py-2 rounded-lg flex items-center gap-2 mx-auto",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Print ID Card"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Standard CR80 size (85.6mm  54mm)  Prints front and back"})]})]})}const Kx=`${ee}/student_management.php`;function f7(){const{studentId:t}=qd(),s=la(),[a,r]=h.useState(null),[l,c]=h.useState([]),[o,m]=h.useState(!0),[u,x]=h.useState("overview"),[A,g]=h.useState(!1),[N,f]=h.useState(!1),[y,v]=h.useState(!1),[U,D]=h.useState(!1),[M,K]=h.useState(!1),[$,P]=h.useState(null),[se,z]=h.useState(null),[R,j]=h.useState({}),[T,Q]=h.useState({note_type:"general",title:"",content:""}),[E,te]=h.useState({});h.useEffect(()=>{O(),V(),C()},[t]);const C=async()=>{try{const B=await F.get(`${ee}/public_settings.php`);te(B.data.settings||{})}catch(B){console.error("Error fetching school settings:",B)}},O=async()=>{try{const B=await F.get(`${Kx}?resource=students&action=profile&id=${t}`);r(B.data.student),j(B.data.student)}catch(B){console.error("Error fetching student:",B);try{const w=await Ch.getById(t);r(w.data.student),j(w.data.student)}catch{alert("Failed to load student data")}}finally{m(!1)}},V=async()=>{try{const B=await Bi.getAll();c(B.data.classes||[])}catch(B){console.error("Error fetching classes:",B)}},re=async B=>{B.preventDefault();try{await Ch.update(t,R),alert("Student updated successfully!"),g(!1),O()}catch{alert("Failed to update student")}},ge=async B=>{B.preventDefault();try{await F.post(`${Kx}?resource=promotions`,{student_id:t,to_class_id:R.new_class_id,promotion_type:R.promotion_type||"promotion",promotion_date:new Date().toISOString().split("T")[0]}),alert("Student promoted successfully!"),f(!1),O()}catch{alert("Failed to promote student")}},xe=async B=>{B.preventDefault();try{await F.post(`${Kx}?resource=notes`,{...T,student_id:t}),alert("Note added successfully!"),D(!1),Q({note_type:"general",title:"",content:""}),O()}catch{alert("Failed to add note")}},Z=async B=>{if(window.confirm("Delete this note?"))try{await F.delete(`${Kx}?resource=notes&id=${B}`),O()}catch{alert("Failed to delete note")}},I=async()=>{try{await F.post(`${Kx}?resource=id_cards&action=generate`,{student_id:t}),alert("ID Card generated successfully!"),O()}catch{alert("Failed to generate ID card")}},H=B=>{const w=B.target.files[0];if(w){P(w);const oe=new FileReader;oe.onloadend=()=>{z(oe.result)},oe.readAsDataURL(w)}},ae=async()=>{if(!$){alert("Please select a photo");return}const B=new FormData;B.append("photo",$),B.append("student_id",t);try{const w=await F.post(`${ee}/upload_student_photo.php`,B,{headers:{"Content-Type":"multipart/form-data"}});w.data.success?(alert("Photo uploaded successfully!"),v(!1),P(null),z(null),O()):alert(w.data.error||"Failed to upload photo")}catch(w){console.error("Upload error:",w),alert(w.response?.data?.error||"Failed to upload photo")}},k=B=>{const w=new Date,oe=new Date(B);let ne=w.getFullYear()-oe.getFullYear();const Fe=w.getMonth()-oe.getMonth();return(Fe<0||Fe===0&&w.getDate()<oe.getDate())&&ne--,ne};return o?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-gray-500",children:"Loading..."})}):a?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>s("/admin/students"),className:"text-gray-600 hover:text-gray-900",children:e.jsx(ol,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[a.first_name," ",a.last_name]}),e.jsx("p",{className:"text-gray-600",children:a.student_id})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>v(!0),className:"btn bg-purple-600 text-white hover:bg-purple-700 flex items-center gap-2",children:[e.jsx(Hr,{className:"w-4 h-4"}),"Upload Photo"]}),e.jsxs("button",{onClick:()=>f(!0),className:"btn bg-green-600 text-white hover:bg-green-700 flex items-center gap-2",children:[e.jsx($s,{className:"w-4 h-4"}),"Promote"]}),e.jsxs("button",{onClick:()=>g(!0),className:"btn btn-primary flex items-center gap-2",children:[e.jsx(Na,{className:"w-4 h-4"}),"Edit Profile"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"text-center",children:[a.profile_picture||a.photo?e.jsx("img",{src:(()=>{const B=a.profile_picture||a.photo;if(!B)return"";if(B.startsWith("http"))return B;const w=B.replace(/^\/?(uploads\/)?/,"");return`${ee.replace("/backend/api","")}/uploads/${w}`})(),alt:a.first_name,className:"w-32 h-32 rounded-full mx-auto mb-4 object-cover border-4 border-blue-100"}):e.jsx("div",{className:"w-32 h-32 rounded-full mx-auto mb-4 bg-blue-100 flex items-center justify-center border-4 border-blue-200",children:e.jsx(ha,{className:"w-16 h-16 text-blue-600"})}),e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:[a.first_name," ",a.last_name]}),e.jsx("p",{className:"text-gray-600 font-mono",children:a.student_id}),e.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-sm font-medium mt-2 ${a.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:a.status})]}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx(Ot,{className:"w-4 h-4 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Age"}),e.jsxs("p",{className:"font-medium",children:[k(a.date_of_birth)," years"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx(ha,{className:"w-4 h-4 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Gender"}),e.jsx("p",{className:"font-medium capitalize",children:a.gender})]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx(Is,{className:"w-4 h-4 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Class"}),e.jsx("p",{className:"font-medium",children:a.class_name||"Not assigned"})]})]})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Full Name"}),e.jsxs("p",{className:"font-medium",children:[a.first_name," ",a.other_names," ",a.last_name]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Date of Birth"}),e.jsx("p",{className:"font-medium",children:new Date(a.date_of_birth).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Blood Group"}),e.jsx("p",{className:"font-medium",children:a.blood_group||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Nationality"}),e.jsx("p",{className:"font-medium",children:a.nationality||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Religion"}),e.jsx("p",{className:"font-medium",children:a.religion||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Admission Date"}),e.jsx("p",{className:"font-medium",children:new Date(a.admission_date).toLocaleDateString()})]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Contact Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ra,{className:"w-5 h-5 text-gray-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Email"}),e.jsx("p",{className:"font-medium",children:a.email||"N/A"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(er,{className:"w-5 h-5 text-gray-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Phone"}),e.jsx("p",{className:"font-medium",children:a.phone||"N/A"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 col-span-2",children:[e.jsx(Qn,{className:"w-5 h-5 text-gray-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Address"}),e.jsx("p",{className:"font-medium",children:a.address||"N/A"})]})]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Guardian Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Guardian Name"}),e.jsx("p",{className:"font-medium",children:a.guardian_name||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Guardian Phone"}),e.jsx("p",{className:"font-medium",children:a.guardian_phone||"N/A"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Guardian Email"}),e.jsx("p",{className:"font-medium",children:a.guardian_email||"N/A"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:a.attendance_summary?.present||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"Days Present"})]}),e.jsxs("div",{className:"card p-4 text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[a.exam_summary?.average_score?Math.round(a.exam_summary.average_score):0,"%"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Avg Score"})]}),e.jsxs("div",{className:"card p-4 text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:["GHS ",a.fee_summary?.balance||0]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Fee Balance"})]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"border-b",children:e.jsx("div",{className:"flex overflow-x-auto",children:[{id:"timeline",label:"Timeline",icon:Sa},{id:"documents",label:"Documents",icon:Kt},{id:"awards",label:"Awards",icon:Is},{id:"discipline",label:"Discipline",icon:_s},{id:"notes",label:"Notes",icon:P1},{id:"id_card",label:"ID Card",icon:aa}].map(B=>e.jsxs("button",{onClick:()=>x(B.id),className:`px-6 py-4 font-medium whitespace-nowrap flex items-center gap-2 ${u===B.id?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(B.icon,{size:18})," ",B.label]},B.id))})}),e.jsxs("div",{className:"p-6",children:[u==="timeline"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Student Timeline"}),a.timeline?.length>0?e.jsx("div",{className:"space-y-4",children:a.timeline.map((B,w)=>e.jsxs("div",{className:"flex gap-4 border-l-2 border-blue-200 pl-4 pb-4",children:[e.jsx("div",{className:`w-3 h-3 rounded-full -ml-[22px] mt-1.5 ${B.is_important?"bg-yellow-500":"bg-blue-500"}`}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:B.event_title}),e.jsx("p",{className:"text-sm text-gray-600",children:B.event_description})]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(B.event_date).toLocaleDateString()})]}),e.jsx("span",{className:`inline-block mt-1 px-2 py-0.5 rounded text-xs ${B.event_type==="award"?"bg-yellow-100 text-yellow-700":B.event_type==="discipline"?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"}`,children:B.event_type})]})]},w))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No timeline events yet"})]}),u==="documents"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Documents"}),e.jsxs("button",{onClick:()=>K(!0),className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{size:16})," Upload Document"]})]}),a.documents?.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.documents.map((B,w)=>e.jsxs("div",{className:"border rounded-lg p-4 flex items-center gap-4",children:[e.jsx(Kt,{className:"text-blue-600",size:32}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:B.document_name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[B.document_type,"  ",new Date(B.created_at).toLocaleDateString()]})]}),B.is_verified&&e.jsx(Mt,{className:"text-green-500",size:20})]},w))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No documents uploaded"})]}),u==="awards"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Awards & Achievements"}),a.awards?.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.awards.map((B,w)=>e.jsx("div",{className:"border rounded-lg p-4 bg-gradient-to-r from-yellow-50 to-orange-50",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Is,{className:"text-yellow-600",size:24}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:B.award_name}),e.jsx("p",{className:"text-sm text-gray-600",children:B.description}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("span",{className:"px-2 py-0.5 bg-yellow-100 text-yellow-700 rounded text-xs",children:B.award_type}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(B.award_date).toLocaleDateString()})]})]})]})},w))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No awards yet"})]}),u==="discipline"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Discipline Records"}),a.discipline?.length>0?e.jsx("div",{className:"space-y-4",children:a.discipline.map((B,w)=>e.jsxs("div",{className:`border rounded-lg p-4 ${B.incident_type==="severe"?"border-red-300 bg-red-50":B.incident_type==="major"?"border-orange-300 bg-orange-50":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:B.incident_category}),e.jsx("p",{className:"text-sm text-gray-600",children:B.description})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${B.status==="resolved"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:B.status})]}),e.jsxs("div",{className:"flex gap-4 mt-2 text-sm text-gray-500",children:[e.jsxs("span",{children:["Action: ",B.action_taken]}),e.jsx("span",{children:new Date(B.incident_date).toLocaleDateString()})]})]},w))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No discipline records"})]}),u==="notes"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Notes"}),e.jsxs("button",{onClick:()=>D(!0),className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{size:16})," Add Note"]})]}),a.notes?.length>0?e.jsx("div",{className:"space-y-4",children:a.notes.map((B,w)=>e.jsxs("div",{className:`border rounded-lg p-4 ${B.is_flagged?"border-red-300 bg-red-50":""}`,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:B.title||"Note"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:B.content})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 rounded text-xs",children:B.note_type}),e.jsx("button",{onClick:()=>Z(B.id),className:"text-red-500 hover:text-red-700",children:e.jsx(us,{size:16})})]})]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["By ",B.created_by_name||"Unknown","  ",new Date(B.created_at).toLocaleDateString()]})]},w))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No notes yet"})]}),u==="id_card"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Student ID Card"}),e.jsxs("button",{onClick:I,className:"btn btn-primary flex items-center gap-2",children:[e.jsx(aa,{size:16})," Generate ID Card"]})]}),a.id_card?e.jsx(g7,{student:a,schoolSettings:E,apiBaseUrl:ee}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No ID card generated yet. Click the button above to generate one."})]})]})]}),A&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between sticky top-0 bg-white",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Edit Student Profile"}),e.jsx("button",{onClick:()=>g(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:re,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"First Name *"}),e.jsx("input",{type:"text",required:!0,value:R.first_name||"",onChange:B=>j({...R,first_name:B.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Last Name *"}),e.jsx("input",{type:"text",required:!0,value:R.last_name||"",onChange:B=>j({...R,last_name:B.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Other Names"}),e.jsx("input",{type:"text",value:R.other_names||"",onChange:B=>j({...R,other_names:B.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Date of Birth *"}),e.jsx("input",{type:"date",required:!0,value:R.date_of_birth||"",onChange:B=>j({...R,date_of_birth:B.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Gender *"}),e.jsxs("select",{value:R.gender||"male",onChange:B=>j({...R,gender:B.target.value}),className:"input",children:[e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Blood Group"}),e.jsx("input",{type:"text",value:R.blood_group||"",onChange:B=>j({...R,blood_group:B.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Email"}),e.jsx("input",{type:"email",value:R.email||"",onChange:B=>j({...R,email:B.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Phone"}),e.jsx("input",{type:"tel",value:R.phone||"",onChange:B=>j({...R,phone:B.target.value}),className:"input"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Address"}),e.jsx("input",{type:"text",value:R.address||"",onChange:B=>j({...R,address:B.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Guardian Name"}),e.jsx("input",{type:"text",value:R.guardian_name||"",onChange:B=>j({...R,guardian_name:B.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Guardian Phone"}),e.jsx("input",{type:"tel",value:R.guardian_phone||"",onChange:B=>j({...R,guardian_phone:B.target.value}),className:"input"})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>g(!1),className:"btn bg-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save Changes"})]})]})]})}),N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Promote Student"}),e.jsx("button",{onClick:()=>f(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:ge,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Current Class"}),e.jsx("input",{type:"text",value:a.class_name||"Not assigned",disabled:!0,className:"input bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Promote to Class *"}),e.jsxs("select",{required:!0,value:R.new_class_id||"",onChange:B=>j({...R,new_class_id:B.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select Class"}),l.map(B=>e.jsx("option",{value:B.id,children:B.class_name},B.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Promotion Type"}),e.jsxs("select",{value:R.promotion_type||"promotion",onChange:B=>j({...R,promotion_type:B.target.value}),className:"input",children:[e.jsx("option",{value:"promotion",children:"Promotion"}),e.jsx("option",{value:"transfer",children:"Transfer"}),e.jsx("option",{value:"repeat",children:"Repeat"})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>f(!1),className:"btn bg-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Promote Student"})]})]})]})}),U&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Add Note"}),e.jsx("button",{onClick:()=>D(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:xe,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Note Type"}),e.jsxs("select",{value:T.note_type,onChange:B=>Q({...T,note_type:B.target.value}),className:"input",children:[e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"academic",children:"Academic"}),e.jsx("option",{value:"behavioral",children:"Behavioral"}),e.jsx("option",{value:"medical",children:"Medical"}),e.jsx("option",{value:"counseling",children:"Counseling"}),e.jsx("option",{value:"parent_communication",children:"Parent Communication"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Title"}),e.jsx("input",{type:"text",value:T.title,onChange:B=>Q({...T,title:B.target.value}),className:"input",placeholder:"Note title (optional)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Content *"}),e.jsx("textarea",{required:!0,value:T.content,onChange:B=>Q({...T,content:B.target.value}),className:"input",rows:"4",placeholder:"Enter note content..."})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>D(!1),className:"btn bg-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Add Note"})]})]})]})}),y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Upload Student Photo"}),e.jsx("button",{onClick:()=>v(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"text-center",children:se?e.jsx("img",{src:se,alt:"Preview",className:"w-32 h-32 rounded-full mx-auto mb-4 object-cover border-4 border-blue-100"}):e.jsx("div",{className:"w-32 h-32 rounded-full mx-auto mb-4 bg-gray-100 flex items-center justify-center border-4 border-gray-200",children:e.jsx(hy,{className:"w-16 h-16 text-gray-400"})})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Select Photo"}),e.jsx("input",{type:"file",accept:"image/*",onChange:H,className:"input"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Accepted formats: JPG, PNG (Max 2MB)"})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>v(!1),className:"btn bg-gray-200",children:"Cancel"}),e.jsx("button",{onClick:ae,className:"btn btn-primary",children:"Upload Photo"})]})]})]})})]}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"Student not found"})})}function b7(){const[t,s]=h.useState([]),[a,r]=h.useState(!0),[l,c]=h.useState("pending"),[o,m]=h.useState(null),[u,x]=h.useState(!1),[A,g]=h.useState(""),[N,f]=h.useState(""),[y,v]=h.useState(""),[U,D]=h.useState([]),[M,K]=h.useState(""),[$,P]=h.useState(""),[se,z]=h.useState(!1),[R,j]=h.useState(""),[T,Q]=h.useState(""),[E,te]=h.useState(""),{user:C}=Us();h.useEffect(()=>{V(),O()},[l]);const O=async()=>{try{const B=await F.get(`${ee}/classes.php`);D(B.data.classes||[])}catch(B){console.error("Error fetching classes:",B)}},V=async()=>{try{r(!0);const B=l!=="all"?{status:l}:{},w=await MA.getAll(B);s(w.data.applications||[])}catch(B){console.error("Error fetching applications:",B),alert("Failed to load applications")}finally{r(!1)}},re=B=>{m(B),x(!0),g("view"),K(B.class_applying_for||""),P(""),z(!1),j(""),Q(""),te(""),f(""),v("")},ge=async()=>{if(o){if(!$){alert("Please provide a reason for the offer");return}try{await F.post(`${ee}/applications.php`,{action:"make_offer",id:o.id,offered_class:M,original_class:o.class_applying_for,offer_reason:$,reviewed_by:C.id,admin_notes:N});const B=M!==o.class_applying_for;alert(`Offer sent to parent!${B?" (Class changed from "+o.class_applying_for+" to "+M+")":""}`),x(!1),V()}catch(B){console.error("Error making offer:",B),alert("Failed to make offer: "+(B.response?.data?.error||B.message))}}},xe=async()=>{if(o){if(!R||!T){alert("Please provide exam date and subjects");return}try{await F.post(`${ee}/applications.php`,{action:"request_exam",id:o.id,exam_date:R,exam_subjects:T,exam_instructions:E,reviewed_by:C.id}),alert("Entrance exam request sent to parent!"),x(!1),V()}catch(B){console.error("Error requesting exam:",B),alert("Failed to request exam: "+(B.response?.data?.error||B.message))}}},Z=async()=>{if(o)try{await MA.approve(o.id,{reviewed_by:C.id,admin_notes:N,offered_class:M||o.class_applying_for}),alert("Application approved! Student record created."),x(!1),V()}catch(B){console.error("Error approving application:",B),alert("Failed to approve application: "+(B.response?.data?.error||B.message))}},I=async()=>{if(!o||!y){alert("Please provide a rejection reason");return}try{await MA.reject(o.id,{reviewed_by:C.id,rejection_reason:y}),alert("Application rejected."),x(!1),V()}catch(B){console.error("Error rejecting application:",B),alert("Failed to reject application")}},H=B=>{const w=U.find(oe=>oe.id==B);return w?w.class_name:B},ae=[{label:"Pending",value:t.filter(B=>B.status==="pending").length,icon:Wt,color:"bg-orange-500"},{label:"Offer Sent",value:t.filter(B=>B.status==="offer_sent").length,icon:va,color:"bg-blue-500"},{label:"Exam Required",value:t.filter(B=>B.status==="exam_required").length,icon:Wc,color:"bg-purple-500"},{label:"Approved",value:t.filter(B=>B.status==="approved").length,icon:Or,color:"bg-green-500"},{label:"Rejected",value:t.filter(B=>B.status==="rejected").length,icon:Rh,color:"bg-red-500"}],k=B=>{const w=new Date,oe=new Date(B);let ne=w.getFullYear()-oe.getFullYear();const Fe=w.getMonth()-oe.getMonth();return(Fe<0||Fe===0&&w.getDate()<oe.getDate())&&ne--,ne};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Admissions"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Review and approve student applications"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:ae.map((B,w)=>e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm mb-1",children:B.label}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:B.value})]}),e.jsx("div",{className:`${B.color} w-12 h-12 rounded-lg flex items-center justify-center`,children:e.jsx(B.icon,{className:"w-6 h-6 text-white"})})]})},w))}),e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Filter by Status:"}),e.jsxs("select",{value:l,onChange:B=>c(B.target.value),className:"input max-w-xs",children:[e.jsx("option",{value:"pending",children:"Pending Review"}),e.jsx("option",{value:"offer_sent",children:"Offer Sent (Awaiting Parent)"}),e.jsx("option",{value:"exam_required",children:"Entrance Exam Required"}),e.jsx("option",{value:"offer_accepted",children:"Offer Accepted"}),e.jsx("option",{value:"approved",children:"Approved & Enrolled"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"all",children:"All Applications"})]})]})}),e.jsx("div",{className:"card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Application #"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Student Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Age/Gender"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Guardian"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Applied Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:a?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-12 text-center text-gray-500",children:"Loading applications..."})}):t.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-12 text-center text-gray-500",children:"No applications found"})}):t.map(B=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"font-mono text-sm font-medium text-blue-600",children:B.application_number})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsxs("span",{className:"text-blue-600 font-semibold",children:[B.first_name?.charAt(0),B.last_name?.charAt(0)]})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900",children:[B.first_name," ",B.last_name]}),B.email&&e.jsx("p",{className:"text-sm text-gray-500",children:B.email})]})]})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsxs("p",{className:"text-gray-900",children:[k(B.date_of_birth)," years"]}),e.jsx("p",{className:"text-sm text-gray-500 capitalize",children:B.gender})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("p",{className:"text-sm text-gray-900",children:B.guardian_name}),e.jsx("p",{className:"text-sm text-gray-500",children:B.guardian_phone})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("p",{className:"text-sm text-gray-900",children:new Date(B.application_date).toLocaleDateString()})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${B.status==="pending"?"bg-orange-100 text-orange-700":B.status==="offer_sent"?"bg-blue-100 text-blue-700":B.status==="exam_required"?"bg-purple-100 text-purple-700":B.status==="offer_accepted"?"bg-cyan-100 text-cyan-700":B.status==="approved"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:B.status==="offer_sent"?"Offer Sent":B.status==="exam_required"?"Exam Required":B.status==="offer_accepted"?"Offer Accepted":B.status})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("button",{onClick:()=>re(B),className:"text-blue-600 hover:text-blue-700 font-medium text-sm",children:"Review"})})]},B.id))})]})})}),u&&o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 sticky top-0 bg-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Application Details"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:o.application_number})]}),e.jsx("button",{onClick:()=>x(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(Js,{className:"w-6 h-6"})})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Student Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Full Name"}),e.jsxs("p",{className:"font-medium",children:[o.first_name," ",o.last_name]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Date of Birth"}),e.jsxs("p",{className:"font-medium",children:[o.date_of_birth," (",k(o.date_of_birth)," years)"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Gender"}),e.jsx("p",{className:"font-medium capitalize",children:o.gender})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Nationality"}),e.jsx("p",{className:"font-medium",children:o.nationality})]}),o.email&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Email"}),e.jsx("p",{className:"font-medium",children:o.email})]}),o.phone&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Phone"}),e.jsx("p",{className:"font-medium",children:o.phone})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Guardian Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Guardian Name"}),e.jsx("p",{className:"font-medium",children:o.guardian_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Phone"}),e.jsx("p",{className:"font-medium",children:o.guardian_phone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Email"}),e.jsx("p",{className:"font-medium",children:o.guardian_email})]}),o.guardian_relationship&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Relationship"}),e.jsx("p",{className:"font-medium",children:o.guardian_relationship})]})]})]}),o.previous_school&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Academic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Previous School"}),e.jsx("p",{className:"font-medium",children:o.previous_school})]}),o.class_applying_for&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Class Applying For"}),e.jsx("p",{className:"font-medium",children:o.class_applying_for})]})]})]}),(o.status==="pending"||o.status==="offer_accepted")&&e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Review Application"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Qs,{className:"w-4 h-4 inline mr-2"}),"Offered Class"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("select",{value:M,onChange:B=>K(B.target.value),className:"input flex-1",children:[e.jsx("option",{value:"",children:"Select Class"}),U.map(B=>e.jsx("option",{value:B.id,children:B.class_name},B.id))]}),M&&M!==o.class_applying_for&&e.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full flex items-center gap-1 ${parseInt(M)>parseInt(o.class_applying_for)?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:parseInt(M)>parseInt(o.class_applying_for)?e.jsxs(e.Fragment,{children:[e.jsx(NS,{className:"w-3 h-3"})," Upgraded"]}):e.jsxs(e.Fragment,{children:[e.jsx(jS,{className:"w-3 h-3"})," Downgraded"]})})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Applied for: ",H(o.class_applying_for)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Notes (Optional)"}),e.jsx("textarea",{value:N,onChange:B=>f(B.target.value),className:"input",rows:"2",placeholder:"Add any internal notes about this application..."})]}),e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex border-b",children:[e.jsxs("button",{type:"button",onClick:()=>g("offer"),className:`flex-1 px-4 py-3 text-sm font-medium ${A==="offer"?"bg-blue-50 text-blue-700 border-b-2 border-blue-600":"text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(va,{className:"w-4 h-4 inline mr-2"}),"Make Offer"]}),e.jsxs("button",{type:"button",onClick:()=>g("exam"),className:`flex-1 px-4 py-3 text-sm font-medium ${A==="exam"?"bg-purple-50 text-purple-700 border-b-2 border-purple-600":"text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(Wc,{className:"w-4 h-4 inline mr-2"}),"Request Exam"]}),e.jsxs("button",{type:"button",onClick:()=>g("approve"),className:`flex-1 px-4 py-3 text-sm font-medium ${A==="approve"?"bg-green-50 text-green-700 border-b-2 border-green-600":"text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(Mt,{className:"w-4 h-4 inline mr-2"}),"Direct Approve"]}),e.jsxs("button",{type:"button",onClick:()=>g("reject"),className:`flex-1 px-4 py-3 text-sm font-medium ${A==="reject"?"bg-red-50 text-red-700 border-b-2 border-red-600":"text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(Js,{className:"w-4 h-4 inline mr-2"}),"Reject"]})]}),e.jsxs("div",{className:"p-4",children:[A==="offer"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Offer Reason / Message to Parent *"}),e.jsx("textarea",{value:$,onChange:B=>P(B.target.value),className:"input",rows:"3",placeholder:"e.g., We are pleased to offer your child admission to our school. Based on the application review..."})]}),e.jsxs("button",{onClick:ge,className:"btn bg-blue-600 text-white hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(va,{className:"w-4 h-4"}),"Send Offer to Parent"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Parent will receive a notification and must accept the offer before enrollment."})]}),A==="exam"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Exam Date *"}),e.jsx("input",{type:"datetime-local",value:R,onChange:B=>j(B.target.value),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subjects *"}),e.jsx("input",{type:"text",value:T,onChange:B=>Q(B.target.value),className:"input",placeholder:"e.g., English, Mathematics"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Instructions for Parent"}),e.jsx("textarea",{value:E,onChange:B=>te(B.target.value),className:"input",rows:"3",placeholder:"e.g., Please arrive 30 minutes early. Bring pencils and erasers..."})]}),e.jsxs("button",{onClick:xe,className:"btn bg-purple-600 text-white hover:bg-purple-700 flex items-center gap-2",children:[e.jsx(Wc,{className:"w-4 h-4"}),"Send Exam Request"]})]}),A==="approve"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:e.jsxs("p",{className:"text-sm text-green-800",children:[e.jsx(Mt,{className:"w-4 h-4 inline mr-2"}),"This will directly approve the application and create a student record."]})}),e.jsxs("button",{onClick:Z,className:"btn bg-green-600 text-white hover:bg-green-700 flex items-center gap-2",children:[e.jsx(Mt,{className:"w-4 h-4"}),"Approve & Create Student Record"]})]}),A==="reject"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rejection Reason *"}),e.jsx("textarea",{value:y,onChange:B=>v(B.target.value),className:"input",rows:"3",placeholder:"Please provide a reason for rejection..."})]}),e.jsxs("button",{onClick:I,className:"btn bg-red-600 text-white hover:bg-red-700 flex items-center gap-2",children:[e.jsx(Js,{className:"w-4 h-4"}),"Reject Application"]})]})]})]})]})]}),o.status!=="pending"&&e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Review Status"}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Status"}),e.jsx("p",{className:"font-medium capitalize",children:o.status}),o.reviewed_date&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Reviewed Date"}),e.jsx("p",{className:"font-medium",children:new Date(o.reviewed_date).toLocaleString()})]}),o.rejection_reason&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Rejection Reason"}),e.jsx("p",{className:"font-medium",children:o.rejection_reason})]})]})]})]})]})})]})}function Ny(t=!0){const[s,a]=h.useState([]),[r,l]=h.useState(!0),[c,o]=h.useState(null);h.useEffect(()=>{m()},[t]);const m=async()=>{try{l(!0);const g=await F.get(`${ee}/education_levels.php`,{params:{active_only:t}});a(g.data.levels||[]),o(null)}catch(g){console.error("Error fetching education levels:",g),a([{id:1,level_code:"creche",level_name:"Creche",display_order:1},{id:2,level_code:"nursery",level_name:"Nursery",display_order:2},{id:3,level_code:"kg",level_name:"Kindergarten",display_order:3},{id:4,level_code:"primary",level_name:"Primary",display_order:4},{id:5,level_code:"jhs",level_name:"Junior High School",display_order:5},{id:6,level_code:"shs",level_name:"Senior High School",display_order:6}]),o(g.message)}finally{l(!1)}},u=s.map(g=>g.level_code),x=g=>{const N=s.find(f=>f.level_code===g);return N?N.level_name:g?.toUpperCase()||""},A=s.map(g=>({value:g.level_code,label:g.level_name}));return{levels:s,levelCodes:u,levelOptions:A,getLevelName:x,loading:r,error:c,refetch:m}}function y7(){const{levels:t}=Ny(),[s,a]=h.useState([]),[r,l]=h.useState([]),[c,o]=h.useState(!0),[m,u]=h.useState(!1),[x,A]=h.useState(null),[g,N]=h.useState({class_name:"",class_code:"",level:"primary",grade:"",section:"",capacity:30,class_teacher_id:"",room_number:"",academic_year:"2024/2025",status:"active",description:""}),[f,y]=h.useState(""),[v,U]=h.useState(""),[D,M]=h.useState(""),[K,$]=h.useState(!1),[P,se]=h.useState(null),[z,R]=h.useState(null),[j,T]=h.useState(!1),[Q,E]=h.useState(!1),[te,C]=h.useState(!1),[O,V]=h.useState([]),[re,ge]=h.useState([]),[xe,Z]=h.useState([]),[I,H]=h.useState(""),[ae,k]=h.useState("class_name"),[B,w]=h.useState("asc");h.useEffect(()=>{oe(),ne(),Fe()},[]);const oe=async()=>{try{o(!0);const Ne=await Bi.getAll();a(Ne.data.classes||[])}catch(Ne){console.error("Error fetching classes:",Ne),alert("Failed to load classes")}finally{o(!1)}},ne=async()=>{try{const Ne=await F.get(`${ee}/teachers.php`);l(Ne.data.teachers||[])}catch(Ne){console.error("Error fetching teachers:",Ne)}},Fe=async()=>{try{const Ne=await F.get(`${ee}/subjects.php`);V(Ne.data.subjects||[])}catch(Ne){console.error("Error fetching subjects:",Ne)}},je=async Ne=>{try{const[et,Ce]=await Promise.all([F.get(`${ee}/students.php?class_id=${Ne}`),F.get(`${ee}/class_subjects.php?class_id=${Ne}`)]);let ft={avgAttendance:0,avgGrade:0};try{ft=(await F.get(`${ee}/class_stats.php?class_id=${Ne}`)).data.stats||ft}catch{}R({students:et.data.students||[],subjects:Ce.data.subjects||Ce.data.class_subjects||[],stats:ft})}catch(et){console.error("Error fetching class details:",et),R({students:[],subjects:[],stats:{avgAttendance:0,avgGrade:0}})}},Ge=async()=>{try{const Ne=await F.get(`${ee}/students.php`);ge(Ne.data.students||[])}catch(Ne){console.error("Error fetching students:",Ne)}},ze=async Ne=>{se(Ne),await je(Ne.id),$(!0)},Xe=Ne=>{se(Ne),je(Ne.id),T(!0)},st=async Ne=>{se(Ne),await Ge(),await je(Ne.id),Z([]),E(!0)},ce=async Ne=>{se(Ne),await je(Ne.id),Z([]),H(""),C(!0)},_e=()=>{A(null),N({class_name:"",class_code:"",level:"primary",grade:"",section:"",capacity:30,class_teacher_id:"",room_number:"",academic_year:"2024/2025",status:"active",description:""}),u(!0)},le=Ne=>{A(Ne),N({class_name:Ne.class_name,class_code:Ne.class_code,level:Ne.level,grade:Ne.grade||"",section:Ne.section||"",capacity:Ne.capacity,class_teacher_id:Ne.class_teacher_id||"",room_number:Ne.room_number||"",academic_year:Ne.academic_year,status:Ne.status,description:Ne.description||""}),u(!0)},Pe=async Ne=>{if(window.confirm("Are you sure you want to delete this class?"))try{await Bi.delete(Ne),oe(),alert("Class deleted successfully!")}catch(et){console.error("Error deleting class:",et),alert("Failed to delete class")}},we=async Ne=>{Ne.preventDefault();try{x?(await Bi.update(x.id,g),alert("Class updated successfully!")):(await Bi.create(g),alert("Class created successfully!")),u(!1),oe()}catch(et){console.error("Error saving class:",et),alert("Failed to save class: "+(et.response?.data?.error||et.message))}},fe=Ne=>({creche:"bg-pink-100 text-pink-700",nursery:"bg-purple-100 text-purple-700",kg:"bg-blue-100 text-blue-700",primary:"bg-green-100 text-green-700",jhs:"bg-orange-100 text-orange-700",shs:"bg-red-100 text-red-700"})[Ne]||"bg-gray-100 text-gray-700",ye=async()=>{if(xe.length===0){alert("Please select students to enroll");return}try{await F.post(`${ee}/class_enrollment.php`,{class_id:P.id,student_ids:xe,action:"enroll"}),alert(`${xe.length} student(s) enrolled successfully!`),E(!1),je(P.id)}catch(Ne){console.error("Error enrolling students:",Ne),alert("Failed to enroll students")}},Ke=async Ne=>{if(window.confirm("Remove this student from the class?"))try{await F.post(`${ee}/class_enrollment.php`,{class_id:P.id,student_ids:[Ne],action:"remove"}),je(P.id)}catch(et){console.error("Error removing student:",et),alert("Failed to remove student")}},ve=async()=>{if(xe.length===0||!I){alert("Please select students and target class");return}try{await F.post(`${ee}/class_enrollment.php`,{from_class_id:P.id,to_class_id:I,student_ids:xe,action:"promote"}),alert(`${xe.length} student(s) promoted successfully!`),C(!1),oe()}catch(Ne){console.error("Error promoting students:",Ne),alert("Failed to promote students")}},ie=async(Ne,et)=>{try{await F.post(`${ee}/class_subjects.php`,{class_id:P.id,subject_id:Ne,action:et?"remove":"add"}),je(P.id)}catch(Ce){console.error("Error updating class subjects:",Ce),alert("Failed to update subjects")}},q=Ne=>{const et=Me.map(Ce=>({"Class Name":Ce.class_name,Code:Ce.class_code,Level:Ce.level?.toUpperCase(),"Class Teacher":Ce.teacher_name||"-",Room:Ce.room_number||"-",Capacity:Ce.capacity,Status:Ce.status}));if(Ne==="csv"){const Ce=Object.keys(et[0]).join(","),ft=et.map(pt=>Object.values(pt).join(",")),qe=[Ce,...ft].join(`
`),W=new Blob([qe],{type:"text/csv"}),Ie=URL.createObjectURL(W),mt=document.createElement("a");mt.href=Ie,mt.download="classes_export.csv",mt.click()}else if(Ne==="print"){const Ce=window.open("","_blank");Ce.document.write(`
        <html><head><title>Classes List</title>
        <style>
          body { font-family: Arial; padding: 20px; }
          table { width: 100%; border-collapse: collapse; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background: #f5f5f5; }
          h1 { margin-bottom: 20px; }
        </style></head><body>
        <h1>Classes List</h1>
        <table>
          <thead><tr>${Object.keys(et[0]).map(ft=>`<th>${ft}</th>`).join("")}</tr></thead>
          <tbody>${et.map(ft=>`<tr>${Object.values(ft).map(qe=>`<td>${qe}</td>`).join("")}</tr>`).join("")}</tbody>
        </table>
        </body></html>
      `),Ce.document.close(),Ce.print()}},pe=Ne=>{ae===Ne?w(B==="asc"?"desc":"asc"):(k(Ne),w("asc"))},Me=s.filter(Ne=>{const et=!f||Ne.class_name?.toLowerCase().includes(f.toLowerCase())||Ne.class_code?.toLowerCase().includes(f.toLowerCase())||Ne.teacher_name?.toLowerCase().includes(f.toLowerCase()),Ce=!v||Ne.level===v,ft=!D||Ne.status===D;return et&&Ce&&ft}).sort((Ne,et)=>{let Ce=Ne[ae]||"",ft=et[ae]||"";return typeof Ce=="string"&&(Ce=Ce.toLowerCase()),typeof ft=="string"&&(ft=ft.toLowerCase()),B==="asc"?Ce>ft?1:-1:Ce<ft?1:-1}),Se=[{label:"Total Classes",value:s.length,color:"bg-blue-500",icon:il},{label:"Active",value:s.filter(Ne=>Ne.status==="active").length,color:"bg-green-500",icon:Mt},{label:"Total Capacity",value:s.reduce((Ne,et)=>Ne+parseInt(et.capacity||0),0),color:"bg-purple-500",icon:Rt},{label:"Levels",value:[...new Set(s.map(Ne=>Ne.level))].length,color:"bg-orange-500",icon:Qs}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Classes Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage school classes and sections"})]}),e.jsxs("button",{onClick:_e,className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-5 h-5"}),"Add Class"]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Se.map((Ne,et)=>e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-xs mb-1",children:Ne.label}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Ne.value})]}),e.jsx("div",{className:`${Ne.color} w-10 h-10 rounded-lg flex items-center justify-center`,children:e.jsx(Ne.icon,{className:"w-5 h-5 text-white"})})]})},et))}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 items-center flex-1",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px] max-w-md",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search classes...",value:f,onChange:Ne=>y(Ne.target.value),className:"input pl-10 w-full"})]}),e.jsxs("select",{value:v,onChange:Ne=>U(Ne.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Levels"}),t.map(Ne=>e.jsx("option",{value:Ne.level_code,children:Ne.level_name},Ne.id))]}),e.jsxs("select",{value:D,onChange:Ne=>M(Ne.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>q("csv"),className:"btn bg-green-600 text-white hover:bg-green-700 flex items-center gap-2",children:[e.jsx(xs,{className:"w-4 h-4"})," CSV"]}),e.jsxs("button",{onClick:()=>q("print"),className:"btn bg-gray-600 text-white hover:bg-gray-700 flex items-center gap-2",children:[e.jsx(or,{className:"w-4 h-4"})," Print"]})]})]})}),e.jsxs("div",{className:"card overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase cursor-pointer hover:bg-gray-100",onClick:()=>pe("class_name"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Class Name",ae==="class_name"&&(B==="asc"?e.jsx(jl,{className:"w-3 h-3"}):e.jsx(un,{className:"w-3 h-3"}))]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Code"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase cursor-pointer hover:bg-gray-100",onClick:()=>pe("level"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Level",ae==="level"&&(B==="asc"?e.jsx(jl,{className:"w-3 h-3"}):e.jsx(un,{className:"w-3 h-3"}))]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Class Teacher"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Room"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase cursor-pointer hover:bg-gray-100",onClick:()=>pe("capacity"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Capacity",ae==="capacity"&&(B==="asc"?e.jsx(jl,{className:"w-3 h-3"}):e.jsx(un,{className:"w-3 h-3"}))]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:c?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"px-6 py-12 text-center text-gray-500",children:"Loading..."})}):Me.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"px-6 py-12 text-center text-gray-500",children:"No classes found"})}):Me.map(Ne=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:Ne.class_name}),e.jsx("td",{className:"px-4 py-3 font-mono text-sm text-gray-600",children:Ne.class_code}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${fe(Ne.level)}`,children:Ne.level?.toUpperCase()})}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:Ne.teacher_name||"-"}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:Ne.room_number||"-"}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:Ne.capacity}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${Ne.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:Ne.status})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>ze(Ne),className:"p-1.5 text-gray-600 hover:bg-gray-100 rounded",title:"View Details",children:e.jsx(na,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>st(Ne),className:"p-1.5 text-green-600 hover:bg-green-50 rounded",title:"Enroll Students",children:e.jsx(Ti,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Xe(Ne),className:"p-1.5 text-purple-600 hover:bg-purple-50 rounded",title:"Manage Subjects",children:e.jsx(as,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ce(Ne),className:"p-1.5 text-orange-600 hover:bg-orange-50 rounded",title:"Promote Students",children:e.jsx(Li,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>le(Ne),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",title:"Edit",children:e.jsx(Na,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Pe(Ne.id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:e.jsx(us,{className:"w-4 h-4"})})]})})]},Ne.id))})]})}),Me.length>0&&e.jsxs("div",{className:"px-4 py-3 border-t bg-gray-50 text-sm text-gray-600",children:["Showing ",Me.length," of ",s.length," classes"]})]}),m&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between sticky top-0 bg-white",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:x?"Edit Class":"Add New Class"}),e.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:we,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Class Name *"}),e.jsx("input",{type:"text",required:!0,value:g.class_name,onChange:Ne=>N({...g,class_name:Ne.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Class Code *"}),e.jsx("input",{type:"text",required:!0,value:g.class_code,onChange:Ne=>N({...g,class_code:Ne.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Level *"}),e.jsx("select",{required:!0,value:g.level,onChange:Ne=>N({...g,level:Ne.target.value}),className:"input",children:t.map(Ne=>e.jsx("option",{value:Ne.level_code,children:Ne.level_name},Ne.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Grade"}),e.jsx("input",{type:"number",value:g.grade,onChange:Ne=>N({...g,grade:Ne.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Section"}),e.jsx("input",{type:"text",value:g.section,onChange:Ne=>N({...g,section:Ne.target.value}),className:"input",placeholder:"A, B, C"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Capacity"}),e.jsx("input",{type:"number",value:g.capacity,onChange:Ne=>N({...g,capacity:Ne.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Class Teacher"}),e.jsxs("select",{value:g.class_teacher_id,onChange:Ne=>N({...g,class_teacher_id:Ne.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select Class Teacher"}),r.map(Ne=>e.jsxs("option",{value:Ne.id,children:[Ne.first_name," ",Ne.last_name]},Ne.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Room Number"}),e.jsx("input",{type:"text",value:g.room_number,onChange:Ne=>N({...g,room_number:Ne.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Academic Year"}),e.jsx("input",{type:"text",value:g.academic_year,onChange:Ne=>N({...g,academic_year:Ne.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:g.status,onChange:Ne=>N({...g,status:Ne.target.value}),className:"input",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:g.description,onChange:Ne=>N({...g,description:Ne.target.value}),className:"input",rows:"3"})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:()=>u(!1),className:"btn bg-gray-200 text-gray-700 hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:x?"Update Class":"Add Class"})]})]})]})}),K&&P&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between sticky top-0 bg-white",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:P.class_name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[P.class_code,"  ",P.level?.toUpperCase()]})]}),e.jsx("button",{onClick:()=>$(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg text-center",children:[e.jsx(Rt,{className:"w-6 h-6 text-blue-600 mx-auto mb-1"}),e.jsx("p",{className:"text-2xl font-bold text-blue-700",children:z?.students?.length||0}),e.jsx("p",{className:"text-xs text-gray-600",children:"Students"})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg text-center",children:[e.jsx(as,{className:"w-6 h-6 text-purple-600 mx-auto mb-1"}),e.jsx("p",{className:"text-2xl font-bold text-purple-700",children:z?.subjects?.length||0}),e.jsx("p",{className:"text-xs text-gray-600",children:"Subjects"})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg text-center",children:[e.jsx(Fs,{className:"w-6 h-6 text-green-600 mx-auto mb-1"}),e.jsxs("p",{className:"text-2xl font-bold text-green-700",children:[z?.stats?.avgAttendance||0,"%"]}),e.jsx("p",{className:"text-xs text-gray-600",children:"Avg Attendance"})]}),e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg text-center",children:[e.jsx(Qs,{className:"w-6 h-6 text-orange-600 mx-auto mb-1"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-700",children:[z?.stats?.avgGrade||0,"%"]}),e.jsx("p",{className:"text-xs text-gray-600",children:"Avg Grade"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Class Teacher:"})," ",e.jsx("span",{className:"font-medium",children:P.teacher_name||"Not assigned"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Room:"})," ",e.jsx("span",{className:"font-medium",children:P.room_number||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Capacity:"})," ",e.jsx("span",{className:"font-medium",children:P.capacity})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Academic Year:"})," ",e.jsx("span",{className:"font-medium",children:P.academic_year})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Rt,{className:"w-4 h-4"})," Students (",z?.students?.length||0,")"]}),z?.students?.length>0?e.jsx("div",{className:"border rounded-lg overflow-hidden max-h-60 overflow-y-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left",children:"Name"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Student ID"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Gender"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:z.students.map(Ne=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-3 py-2",children:[Ne.first_name," ",Ne.last_name]}),e.jsx("td",{className:"px-3 py-2 font-mono text-xs",children:Ne.student_id}),e.jsx("td",{className:"px-3 py-2 capitalize",children:Ne.gender}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("button",{onClick:()=>Ke(Ne.id),className:"text-red-600 hover:text-red-700 text-xs",children:"Remove"})})]},Ne.id))})]})}):e.jsx("p",{className:"text-gray-500 text-sm",children:"No students enrolled"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(as,{className:"w-4 h-4"})," Subjects (",z?.subjects?.length||0,")"]}),z?.subjects?.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:z.subjects.map((Ne,et)=>e.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-sm",children:Ne.subject_name},et))}):e.jsx("p",{className:"text-gray-500 text-sm",children:"No subjects assigned"})]})]})]})}),Q&&P&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between sticky top-0 bg-white",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Enroll Students"}),e.jsx("p",{className:"text-sm text-gray-500",children:P.class_name})]}),e.jsx("button",{onClick:()=>E(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Select students to enroll in this class. Students already in a class are marked."}),e.jsx("div",{className:"border rounded-lg overflow-hidden max-h-96 overflow-y-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left w-10",children:e.jsx("input",{type:"checkbox",onChange:Ne=>{Ne.target.checked?Z(re.filter(et=>!et.class_id||et.class_id===P.id).map(et=>et.id)):Z([])},className:"rounded"})}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Name"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Student ID"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Current Class"})]})}),e.jsx("tbody",{className:"divide-y",children:re.filter(Ne=>!z?.students?.find(et=>et.id===Ne.id)).map(Ne=>e.jsxs("tr",{className:`hover:bg-gray-50 ${Ne.class_id&&Ne.class_id!==P.id?"opacity-50":""}`,children:[e.jsx("td",{className:"px-3 py-2",children:e.jsx("input",{type:"checkbox",checked:xe.includes(Ne.id),onChange:et=>{et.target.checked?Z([...xe,Ne.id]):Z(xe.filter(Ce=>Ce!==Ne.id))},disabled:Ne.class_id&&Ne.class_id!==P.id,className:"rounded"})}),e.jsxs("td",{className:"px-3 py-2",children:[Ne.first_name," ",Ne.last_name]}),e.jsx("td",{className:"px-3 py-2 font-mono text-xs",children:Ne.student_id}),e.jsx("td",{className:"px-3 py-2 text-xs",children:Ne.class_name||"None"})]},Ne.id))})]})}),e.jsxs("div",{className:"flex justify-between items-center mt-4 pt-4 border-t",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[xe.length," student(s) selected"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>E(!1),className:"btn bg-gray-200 text-gray-700 hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{onClick:ye,className:"btn btn-primary",disabled:xe.length===0,children:"Enroll Students"})]})]})]})]})}),te&&P&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between sticky top-0 bg-white",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Promote Students"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["From: ",P.class_name]})]}),e.jsx("button",{onClick:()=>C(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Promote To Class *"}),e.jsxs("select",{value:I,onChange:Ne=>H(Ne.target.value),className:"input w-full",children:[e.jsx("option",{value:"",children:"Select target class"}),s.filter(Ne=>Ne.id!==P.id).map(Ne=>e.jsxs("option",{value:Ne.id,children:[Ne.class_name," (",Ne.level?.toUpperCase(),")"]},Ne.id))]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Select students to promote:"}),e.jsx("div",{className:"border rounded-lg overflow-hidden max-h-72 overflow-y-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left w-10",children:e.jsx("input",{type:"checkbox",onChange:Ne=>{Ne.target.checked?Z(z?.students?.map(et=>et.id)||[]):Z([])},className:"rounded"})}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Name"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Student ID"})]})}),e.jsx("tbody",{className:"divide-y",children:z?.students?.map(Ne=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 py-2",children:e.jsx("input",{type:"checkbox",checked:xe.includes(Ne.id),onChange:et=>{et.target.checked?Z([...xe,Ne.id]):Z(xe.filter(Ce=>Ce!==Ne.id))},className:"rounded"})}),e.jsxs("td",{className:"px-3 py-2",children:[Ne.first_name," ",Ne.last_name]}),e.jsx("td",{className:"px-3 py-2 font-mono text-xs",children:Ne.student_id})]},Ne.id))})]})}),e.jsxs("div",{className:"flex justify-between items-center mt-4 pt-4 border-t",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[xe.length," student(s) selected"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>C(!1),className:"btn bg-gray-200 text-gray-700 hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{onClick:ve,className:"btn bg-orange-600 text-white hover:bg-orange-700",disabled:xe.length===0||!I,children:"Promote Students"})]})]})]})]})}),j&&P&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between sticky top-0 bg-white",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Manage Subjects"}),e.jsx("p",{className:"text-sm text-gray-500",children:P.class_name})]}),e.jsx("button",{onClick:()=>T(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Toggle subjects for this class:"}),e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:O.map(Ne=>{const et=z?.subjects?.some(Ce=>Ce.subject_id===Ne.id||Ce.id===Ne.id);return e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border cursor-pointer transition-colors ${et?"bg-purple-50 border-purple-200":"hover:bg-gray-50"}`,onClick:()=>ie(Ne.id,et),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${et?"bg-purple-600":"bg-gray-200"}`,children:e.jsx(as,{className:`w-4 h-4 ${et?"text-white":"text-gray-500"}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:Ne.subject_name}),e.jsx("p",{className:"text-xs text-gray-500",children:Ne.subject_code})]})]}),et?e.jsx(Mt,{className:"w-5 h-5 text-purple-600"}):e.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 rounded-full"})]},Ne.id)})}),e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsx("button",{onClick:()=>T(!1),className:"btn btn-primary w-full",children:"Done"})})]})]})})]})}function j7(){const[t,s]=h.useState([]),[a,r]=h.useState([]),[l,c]=h.useState([]),[o,m]=h.useState(""),[u,x]=h.useState([]),[A,g]=h.useState(!1),[N,f]=h.useState(!1),[y,v]=h.useState(null),[U,D]=h.useState({subject_id:"",teacher_id:"",periods_per_week:3,is_mandatory:1}),[M,K]=h.useState(""),[$,P]=h.useState(""),[se,z]=h.useState(!1),[R,j]=h.useState(!1),[T,Q]=h.useState(!1),[E,te]=h.useState(!1),[C,O]=h.useState([]),[V,re]=h.useState(""),[ge,xe]=h.useState(""),[Z,I]=h.useState(null),[H,ae]=h.useState([]);h.useEffect(()=>{k(),B(),w()},[]),h.useEffect(()=>{o&&oe()},[o]);const k=async()=>{try{const q=await F.get(`${ee}/classes.php`);s(q.data.classes||[])}catch(q){console.error("Error fetching classes:",q)}},B=async()=>{try{const q=await F.get(`${ee}/subjects.php`);r(q.data.subjects||[])}catch(q){console.error("Error fetching subjects:",q)}},w=async()=>{try{const q=await F.get(`${ee}/teachers.php`);c(q.data.teachers||[])}catch(q){console.error("Error fetching teachers:",q)}},oe=async()=>{try{g(!0);const q=await F.get(`${ee}/class_subjects.php?class_id=${o}`);x(q.data.class_subjects||[])}catch(q){console.error("Error fetching class subjects:",q)}finally{g(!1)}},ne=async()=>{try{const pe=(await F.get(`${ee}/class_subjects.php`)).data.class_subjects||[],Me={};pe.forEach(Se=>{Se.teacher_id&&(Me[Se.teacher_id]||(Me[Se.teacher_id]={teacher_id:Se.teacher_id,teacher_name:Se.teacher_name,subjects:[],totalPeriods:0,classCount:0}),Me[Se.teacher_id].subjects.push(Se),Me[Se.teacher_id].totalPeriods+=parseInt(Se.periods_per_week)||0,Me[Se.teacher_id].classCount++)}),ae(Object.values(Me).sort((Se,Ne)=>Ne.totalPeriods-Se.totalPeriods)),te(!0)}catch(q){console.error("Error fetching workloads:",q)}},Fe=async()=>{if(!(!ge||!o))try{const[q,pe]=await Promise.all([F.get(`${ee}/class_subjects.php?class_id=${o}`),F.get(`${ee}/class_subjects.php?class_id=${ge}`)]),Me=q.data.class_subjects||[],Se=pe.data.class_subjects||[],Ne=new Set(Me.map(Ce=>Ce.subject_id)),et=new Set(Se.map(Ce=>Ce.subject_id));I({current:Me,compare:Se,onlyInCurrent:Me.filter(Ce=>!et.has(Ce.subject_id)),onlyInCompare:Se.filter(Ce=>!Ne.has(Ce.subject_id)),inBoth:Me.filter(Ce=>et.has(Ce.subject_id))})}catch(q){console.error("Error comparing:",q)}},je=()=>{v(null),D({subject_id:"",teacher_id:"",periods_per_week:3,is_mandatory:1}),f(!0)},Ge=q=>{v(q),D({subject_id:q.subject_id,teacher_id:q.teacher_id||"",periods_per_week:q.periods_per_week,is_mandatory:q.is_mandatory}),f(!0)},ze=async q=>{if(window.confirm("Are you sure you want to remove this subject from the class?"))try{await F.delete(`${ee}/class_subjects.php?id=${q}`),oe(),alert("Subject removed successfully!")}catch(pe){console.error("Error deleting class subject:",pe),alert("Failed to remove subject")}},Xe=async q=>{if(q.preventDefault(),!o){alert("Please select a class first");return}try{const pe={class_id:o,...U};y?(await F.put(`${ee}/class_subjects.php?id=${y.id}`,pe),alert("Subject updated successfully!")):(await F.post(`${ee}/class_subjects.php`,pe),alert("Subject added successfully!")),f(!1),oe()}catch(pe){console.error("Error saving class subject:",pe),alert("Failed to save: "+(pe.response?.data?.error||pe.message))}},st=async()=>{if(C.length===0){alert("Please select at least one subject");return}try{let q=0;for(const pe of C)try{await F.post(`${ee}/class_subjects.php`,{class_id:o,subject_id:pe,periods_per_week:3,is_mandatory:1}),q++}catch{}alert(`${q} subject(s) added successfully!`),z(!1),O([]),oe()}catch(q){console.error("Error bulk adding:",q),alert("Failed to add subjects")}},ce=async()=>{if(!V){alert("Please select a class to copy from");return}try{const pe=(await F.get(`${ee}/class_subjects.php?class_id=${V}`)).data.class_subjects||[];let Me=0;for(const Se of pe)try{await F.post(`${ee}/class_subjects.php`,{class_id:o,subject_id:Se.subject_id,teacher_id:Se.teacher_id,periods_per_week:Se.periods_per_week,is_mandatory:Se.is_mandatory}),Me++}catch{}alert(`${Me} subject(s) copied successfully!`),j(!1),re(""),oe()}catch(q){console.error("Error copying curriculum:",q),alert("Failed to copy curriculum")}},_e=q=>{const pe=we.map(Me=>({Subject:Me.subject_name,Code:Me.subject_code,Teacher:Me.teacher_name||"Not Assigned","Periods/Week":Me.periods_per_week,Type:Me.is_mandatory==1?"Mandatory":"Optional"}));if(q==="csv"){const Me=Object.keys(pe[0]).join(","),Se=pe.map(qe=>Object.values(qe).join(",")),Ne=[Me,...Se].join(`
`),et=new Blob([Ne],{type:"text/csv"}),Ce=URL.createObjectURL(et),ft=document.createElement("a");ft.href=Ce,ft.download=`curriculum_${le.replace(/\s+/g,"_")}.csv`,ft.click()}else if(q==="print"){const Me=window.open("","_blank");Me.document.write(`
        <html><head><title>Curriculum - ${le}</title>
        <style>
          body { font-family: Arial; padding: 20px; }
          table { width: 100%; border-collapse: collapse; margin-top: 20px; }
          th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
          th { background: #2563eb; color: white; }
          h1 { color: #1f2937; }
          .summary { margin: 20px 0; padding: 15px; background: #f3f4f6; border-radius: 8px; }
        </style></head><body>
        <h1>Curriculum for ${le}</h1>
        <div class="summary">
          <strong>Total Subjects:</strong> ${we.length} | 
          <strong>Total Periods/Week:</strong> ${fe} |
          <strong>Mandatory:</strong> ${we.filter(Se=>Se.is_mandatory==1).length} |
          <strong>Optional:</strong> ${we.filter(Se=>Se.is_mandatory!=1).length}
        </div>
        <table>
          <thead><tr>${Object.keys(pe[0]).map(Se=>`<th>${Se}</th>`).join("")}</tr></thead>
          <tbody>${pe.map(Se=>`<tr>${Object.values(Se).map(Ne=>`<td>${Ne}</td>`).join("")}</tr>`).join("")}</tbody>
        </table>
        </body></html>
      `),Me.document.close(),Me.print()}},le=t.find(q=>q.id==o)?.class_name||"Select a class",Pe=t.find(q=>q.id==ge)?.class_name||"",we=u.filter(q=>{const pe=!M||q.subject_name?.toLowerCase().includes(M.toLowerCase())||q.subject_code?.toLowerCase().includes(M.toLowerCase())||q.teacher_name?.toLowerCase().includes(M.toLowerCase()),Me=!$||$==="mandatory"&&q.is_mandatory==1||$==="optional"&&q.is_mandatory!=1;return pe&&Me}),fe=we.reduce((q,pe)=>q+(parseInt(pe.periods_per_week)||0),0),ye=we.filter(q=>q.is_mandatory==1).length,Ke=we.filter(q=>q.is_mandatory!=1).length,ve=new Set(u.map(q=>q.subject_id)),ie=a.filter(q=>!ve.has(q.id));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Class Curriculum Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Assign subjects to classes and manage teachers"})]}),e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-end justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-[250px] max-w-md",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Class *"}),e.jsxs("select",{value:o,onChange:q=>m(q.target.value),className:"input text-lg font-medium",children:[e.jsx("option",{value:"",children:"-- Select a Class --"}),t.map(q=>e.jsxs("option",{value:q.id,children:[q.class_name," (",q.class_code,")"]},q.id))]})]}),o&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:je,className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4"})," Add Subject"]}),e.jsxs("button",{onClick:()=>z(!0),className:"btn bg-purple-600 text-white hover:bg-purple-700 flex items-center gap-2",children:[e.jsx(XA,{className:"w-4 h-4"})," Bulk Add"]}),e.jsxs("button",{onClick:()=>j(!0),className:"btn bg-orange-600 text-white hover:bg-orange-700 flex items-center gap-2",children:[e.jsx(vl,{className:"w-4 h-4"})," Copy From"]}),e.jsxs("button",{onClick:()=>{xe(""),I(null),Q(!0)},className:"btn bg-teal-600 text-white hover:bg-teal-700 flex items-center gap-2",children:[e.jsx(Q3,{className:"w-4 h-4"})," Compare"]})]})]})}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("button",{onClick:ne,className:"btn bg-indigo-600 text-white hover:bg-indigo-700 flex items-center gap-2",children:[e.jsx(Rt,{className:"w-4 h-4"})," Teacher Workloads"]})}),o&&e.jsxs("div",{className:"card overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Curriculum for ",le]}),e.jsxs("div",{className:"flex gap-4 mt-1 text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:[we.length," subjects"]}),e.jsxs("span",{className:"text-blue-600 font-medium",children:[fe," periods/week"]}),e.jsxs("span",{className:"text-green-600",children:[ye," mandatory"]}),e.jsxs("span",{className:"text-orange-600",children:[Ke," optional"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>_e("csv"),className:"btn bg-green-600 text-white hover:bg-green-700 flex items-center gap-1 text-sm py-1.5",children:[e.jsx(xs,{className:"w-4 h-4"})," CSV"]}),e.jsxs("button",{onClick:()=>_e("print"),className:"btn bg-gray-600 text-white hover:bg-gray-700 flex items-center gap-1 text-sm py-1.5",children:[e.jsx(or,{className:"w-4 h-4"})," Print"]})]})]})}),e.jsxs("div",{className:"p-4 border-b flex flex-wrap gap-3",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px] max-w-sm",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search subjects...",value:M,onChange:q=>K(q.target.value),className:"input pl-10 w-full"})]}),e.jsxs("select",{value:$,onChange:q=>P(q.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"mandatory",children:"Mandatory"}),e.jsx("option",{value:"optional",children:"Optional"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Subject"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Code"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Teacher"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Periods"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:A?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-12 text-center text-gray-500",children:"Loading subjects..."})}):we.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-12 text-center text-gray-500",children:u.length===0?'No subjects assigned yet. Click "Add Subject" to get started.':"No subjects match your search."})}):we.map(q=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(as,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:q.subject_name})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"font-mono text-sm text-gray-600",children:q.subject_code})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:q.teacher_name?"text-gray-900":"text-gray-400 italic",children:q.teacher_name||"Not assigned"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium",children:[q.periods_per_week,"/wk"]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${q.is_mandatory==1?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:q.is_mandatory==1?"Mandatory":"Optional"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>Ge(q),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",title:"Edit",children:e.jsx(Na,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ze(q.id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",title:"Remove",children:e.jsx(us,{className:"w-4 h-4"})})]})})]},q.id))})]})})]}),N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:y?"Edit Subject":"Add Subject to Class"}),e.jsx("button",{onClick:()=>f(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:Xe,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Class"}),e.jsx("input",{type:"text",value:le,disabled:!0,className:"input bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject *"}),e.jsxs("select",{required:!0,value:U.subject_id,onChange:q=>D({...U,subject_id:q.target.value}),className:"input",disabled:y,children:[e.jsx("option",{value:"",children:"Select Subject"}),a.map(q=>e.jsxs("option",{value:q.id,children:[q.subject_name," (",q.subject_code,")"]},q.id))]}),y&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Subject cannot be changed when editing"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Teacher"}),e.jsxs("select",{value:U.teacher_id,onChange:q=>D({...U,teacher_id:q.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"No Teacher Assigned"}),l.map(q=>e.jsxs("option",{value:q.id,children:[q.first_name," ",q.last_name]},q.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Periods per Week *"}),e.jsx("input",{type:"number",required:!0,min:"1",max:"10",value:U.periods_per_week,onChange:q=>D({...U,periods_per_week:q.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type *"}),e.jsxs("select",{required:!0,value:U.is_mandatory,onChange:q=>D({...U,is_mandatory:q.target.value}),className:"input",children:[e.jsx("option",{value:"1",children:"Mandatory"}),e.jsx("option",{value:"0",children:"Optional"})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>f(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-primary flex items-center gap-2",children:[e.jsx(Br,{className:"w-4 h-4"}),y?"Update":"Add"," Subject"]})]})]})]})}),se&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between sticky top-0 bg-white",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Bulk Add Subjects"}),e.jsx("p",{className:"text-sm text-gray-500",children:le})]}),e.jsx("button",{onClick:()=>z(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Select subjects to add (subjects already assigned are hidden):"}),e.jsx("div",{className:"space-y-2 max-h-72 overflow-y-auto border rounded-lg p-2",children:ie.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"All subjects are already assigned"}):ie.map(q=>e.jsxs("label",{className:"flex items-center gap-3 p-2 hover:bg-gray-50 rounded cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:C.includes(q.id),onChange:pe=>{pe.target.checked?O([...C,q.id]):O(C.filter(Me=>Me!==q.id))},className:"rounded"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:q.subject_name}),e.jsx("p",{className:"text-xs text-gray-500",children:q.subject_code})]})]},q.id))}),e.jsxs("div",{className:"flex justify-between items-center mt-4 pt-4 border-t",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[C.length," selected"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>z(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{onClick:st,className:"btn btn-primary",disabled:C.length===0,children:"Add Selected"})]})]})]})]})}),R&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Copy Curriculum"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["To: ",le]})]}),e.jsx("button",{onClick:()=>j(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Copy all subjects from another class. Existing subjects will be skipped."}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Copy From Class *"}),e.jsxs("select",{value:V,onChange:q=>re(q.target.value),className:"input w-full",children:[e.jsx("option",{value:"",children:"Select a class"}),t.filter(q=>q.id!=o).map(q=>e.jsx("option",{value:q.id,children:q.class_name},q.id))]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-6 pt-4 border-t",children:[e.jsx("button",{onClick:()=>j(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{onClick:ce,className:"btn bg-orange-600 text-white hover:bg-orange-700",disabled:!V,children:"Copy Curriculum"})]})]})]})}),T&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between sticky top-0 bg-white",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Compare Curriculum"}),e.jsx("button",{onClick:()=>Q(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Class A"}),e.jsx("input",{type:"text",value:le,disabled:!0,className:"input w-full bg-gray-50"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Class B"}),e.jsxs("select",{value:ge,onChange:q=>xe(q.target.value),className:"input w-full",children:[e.jsx("option",{value:"",children:"Select a class"}),t.filter(q=>q.id!=o).map(q=>e.jsx("option",{value:q.id,children:q.class_name},q.id))]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:Fe,className:"btn btn-primary",disabled:!ge,children:"Compare"})})]}),Z&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-700",children:Z.inBoth.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"In Both"})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-green-700",children:Z.onlyInCurrent.length}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Only in ",le]})]}),e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-orange-700",children:Z.onlyInCompare.length}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Only in ",Pe]})]})]}),Z.onlyInCurrent.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-green-700 mb-2",children:["Only in ",le,":"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Z.onlyInCurrent.map(q=>e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded text-sm",children:q.subject_name},q.id))})]}),Z.onlyInCompare.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-orange-700 mb-2",children:["Only in ",Pe,":"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Z.onlyInCompare.map(q=>e.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-700 rounded text-sm",children:q.subject_name},q.id))})]}),Z.inBoth.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-700 mb-2",children:"Common Subjects:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Z.inBoth.map(q=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-sm",children:q.subject_name},q.id))})]})]})]})]})}),E&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between sticky top-0 bg-white",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Teacher Workloads"}),e.jsx("button",{onClick:()=>te(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Overview of teaching assignments across all classes"}),e.jsx("div",{className:"space-y-4",children:H.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No teacher assignments found"}):H.map(q=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center",children:e.jsx(Rt,{className:"w-5 h-5 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:q.teacher_name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[q.classCount," class(es)"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-indigo-600",children:q.totalPeriods}),e.jsx("p",{className:"text-xs text-gray-500",children:"periods/week"})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:q.subjects.map((pe,Me)=>e.jsxs("span",{className:"px-2 py-1 bg-gray-100 rounded text-xs",children:[pe.subject_name," (",pe.class_name,") - ",pe.periods_per_week,"p"]},Me))}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${q.totalPeriods>25?"bg-red-500":q.totalPeriods>20?"bg-orange-500":"bg-green-500"}`,style:{width:`${Math.min(q.totalPeriods/30*100,100)}%`}})}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:q.totalPeriods>25?"Overloaded":q.totalPeriods>20?"Heavy workload":"Normal workload"})]})]},q.teacher_id))})]})]})})]})}function v7(){const[t,s]=h.useState([]),[a,r]=h.useState(!0),[l,c]=h.useState(!1),[o,m]=h.useState(null),[u,x]=h.useState(""),[A,g]=h.useState(""),[N,f]=h.useState({level_code:"",level_name:"",description:"",display_order:0,is_active:1});h.useEffect(()=>{y()},[]);const y=async()=>{try{r(!0);const z=await F.get(`${ee}/education_levels.php`);s(z.data.levels||[])}catch(z){console.error("Error fetching levels:",z)}finally{r(!1)}},v=async z=>{z.preventDefault();try{o?await F.put(`${ee}/education_levels.php?id=${o.id}`,N):await F.post(`${ee}/education_levels.php`,N),c(!1),K(),y()}catch(R){alert(R.response?.data?.error||"Error saving level")}},U=async z=>{if(confirm("Are you sure you want to delete this education level?"))try{await F.delete(`${ee}/education_levels.php?id=${z}`),y()}catch(R){alert(R.response?.data?.error||"Error deleting level")}},D=async z=>{try{await F.put(`${ee}/education_levels.php?id=${z.id}`,{is_active:z.is_active?0:1}),y()}catch(R){alert(R.response?.data?.error||"Error updating level")}},M=async(z,R)=>{const j=t.findIndex(E=>E.id===z.id),T=R==="up"?j-1:j+1;if(T<0||T>=t.length)return;const Q=t[T];try{await F.put(`${ee}/education_levels.php?id=${z.id}`,{display_order:Q.display_order}),await F.put(`${ee}/education_levels.php?id=${Q.id}`,{display_order:z.display_order}),y()}catch(E){console.error("Error reordering:",E)}},K=()=>{f({level_code:"",level_name:"",description:"",display_order:t.length+1,is_active:1}),m(null)},$=z=>{m(z),f({level_code:z.level_code,level_name:z.level_name,description:z.description||"",display_order:z.display_order,is_active:z.is_active}),c(!0)},P=()=>{K(),f(z=>({...z,display_order:t.length+1})),c(!0)},se=t.filter(z=>{const R=z.level_name.toLowerCase().includes(u.toLowerCase())||z.level_code.toLowerCase().includes(u.toLowerCase()),j=!A||A==="active"&&z.is_active||A==="inactive"&&!z.is_active;return R&&j});return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Education Levels"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Configure education levels for your school (e.g., Creche, Primary, JHS)"})]}),e.jsxs("button",{onClick:P,className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4"}),"Add Level"]})]}),e.jsx("div",{className:"card p-4 mb-6",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search levels...",value:u,onChange:z=>x(z.target.value),className:"input pl-10 w-full"})]}),e.jsxs("select",{value:A,onChange:z=>g(z.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]}),e.jsx("button",{onClick:y,className:"btn bg-gray-200 dark:bg-gray-700",children:e.jsx(Ns,{className:"w-4 h-4"})})]})}),e.jsx("div",{className:"card overflow-hidden",children:a?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(hs,{className:"w-8 h-8 animate-spin mx-auto text-blue-600"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"Loading levels..."})]}):se.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(Qs,{className:"w-12 h-12 mx-auto text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No education levels found"}),e.jsx("button",{onClick:P,className:"btn btn-primary mt-4",children:"Add First Level"})]}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700 border-b dark:border-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Order"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y dark:divide-gray-700",children:se.map((z,R)=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-gray-500 w-6",children:z.display_order}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("button",{onClick:()=>M(z,"up"),disabled:R===0,className:"p-0.5 text-gray-400 hover:text-gray-600 disabled:opacity-30",children:e.jsx(xy,{className:"w-3 h-3"})}),e.jsx("button",{onClick:()=>M(z,"down"),disabled:R===se.length-1,className:"p-0.5 text-gray-400 hover:text-gray-600 disabled:opacity-30",children:e.jsx(uy,{className:"w-3 h-3"})})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"font-mono text-sm bg-gray-100 dark:bg-gray-600 px-2 py-1 rounded",children:z.level_code})}),e.jsx("td",{className:"px-6 py-4 font-medium text-gray-900 dark:text-white",children:z.level_name}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600 dark:text-gray-400",children:z.description||"-"}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("button",{onClick:()=>D(z),className:`px-2 py-1 text-xs rounded-full ${z.is_active?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-700 dark:bg-gray-600 dark:text-gray-300"}`,children:z.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>$(z),className:"p-1.5 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded",title:"Edit",children:e.jsx(Na,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>U(z.id),className:"p-1.5 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded",title:"Delete",children:e.jsx(us,{className:"w-4 h-4"})})]})})]},z.id))})]})}),e.jsx("div",{className:"card p-4 mt-6 bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(_s,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-900 dark:text-blue-300",children:"About Education Levels"}),e.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-400 mt-1",children:["Education levels are used throughout the system for organizing classes, fee structures, subjects, and reports. The ",e.jsx("strong",{children:"level code"})," is used internally and should not be changed once classes are assigned to it. You can deactivate levels instead of deleting them to preserve historical data."]})]})]})}),l&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-md mx-4",children:[e.jsx("div",{className:"p-6 border-b dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:o?"Edit Education Level":"Add Education Level"}),e.jsx("button",{onClick:()=>c(!1),className:"text-gray-500 hover:text-gray-700",children:e.jsx(Nt,{className:"w-5 h-5"})})]})}),e.jsxs("form",{onSubmit:v,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Level Code *"}),e.jsx("input",{type:"text",required:!0,value:N.level_code,onChange:z=>f({...N,level_code:z.target.value.toLowerCase().replace(/\s+/g,"_")}),className:"input",placeholder:"e.g., primary, jhs, shs",disabled:o}),o&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Code cannot be changed after creation"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Level Name *"}),e.jsx("input",{type:"text",required:!0,value:N.level_name,onChange:z=>f({...N,level_name:z.target.value}),className:"input",placeholder:"e.g., Primary School, Junior High School"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description"}),e.jsx("textarea",{value:N.description,onChange:z=>f({...N,description:z.target.value}),className:"input",rows:2,placeholder:"Optional description"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Display Order"}),e.jsx("input",{type:"number",value:N.display_order,onChange:z=>f({...N,display_order:parseInt(z.target.value)}),className:"input",min:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Status"}),e.jsxs("select",{value:N.is_active,onChange:z=>f({...N,is_active:parseInt(z.target.value)}),className:"input",children:[e.jsx("option",{value:1,children:"Active"}),e.jsx("option",{value:0,children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t dark:border-gray-700",children:[e.jsx("button",{type:"button",onClick:()=>c(!1),className:"btn bg-gray-200 dark:bg-gray-700",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-primary",children:[o?"Update":"Create"," Level"]})]})]})]})})]})}function N7(){const[t,s]=h.useState([]),[a,r]=h.useState([]),{educationLevels:l}=Ny(),[c,o]=h.useState(!0),[m,u]=h.useState(!1),[x,A]=h.useState(null),[g,N]=h.useState({subject_name:"",subject_code:"",category:"core",description:"",status:"active",credit_hours:3,department_id:"",level:"all"}),[f,y]=h.useState(""),[v,U]=h.useState(""),[D,M]=h.useState(""),[K,$]=h.useState(""),[P,se]=h.useState(""),[z,R]=h.useState("subject_name"),[j,T]=h.useState("asc"),[Q,E]=h.useState(!1),[te,C]=h.useState(!1),[O,V]=h.useState(!1),[re,ge]=h.useState(null),[xe,Z]=h.useState({classes:[],teachers:[],prerequisites:[],required_by:[]}),[I,H]=h.useState([]),[ae,k]=h.useState([]),[B,w]=h.useState({prerequisite_id:"",is_mandatory:1,min_grade:""}),oe=h.useRef(null);h.useEffect(()=>{ne(),Fe()},[]);const ne=async()=>{try{o(!0);const Se=await Ud.getAll();s(Se.data.subjects||[])}catch(Se){console.error("Error fetching subjects:",Se),alert("Failed to load subjects")}finally{o(!1)}},Fe=async()=>{try{const Se=await F.get(`${ee}/departments.php`);r(Se.data.departments||[])}catch(Se){console.error("Error fetching departments:",Se)}},je=()=>{A(null),N({subject_name:"",subject_code:"",category:"core",description:"",status:"active",credit_hours:3,department_id:"",level:"all"}),u(!0)},Ge=Se=>{A(Se),N({subject_name:Se.subject_name,subject_code:Se.subject_code,category:Se.category,description:Se.description||"",status:Se.status,credit_hours:Se.credit_hours||3,department_id:Se.department_id||"",level:Se.level||"all"}),u(!0)},ze=async Se=>{ge(Se);try{const Ce=((await F.get(`${ee}/class_subjects.php`)).data.class_subjects||[]).filter(Ie=>Ie.subject_id==Se.id),ft={};Ce.forEach(Ie=>{Ie.teacher_id&&Ie.teacher_name&&(ft[Ie.teacher_id]={id:Ie.teacher_id,name:Ie.teacher_name,classes:(ft[Ie.teacher_id]?.classes||[]).concat(Ie.class_name)})});let qe=[],W=[];try{const Ie=await F.get(`${ee}/subject_prerequisites.php?subject_id=${Se.id}`);qe=Ie.data.prerequisites||[],W=Ie.data.required_by||[]}catch{console.log("Prerequisites not available")}Z({classes:Ce,teachers:Object.values(ft),prerequisites:qe,required_by:W}),E(!0)}catch(Ne){console.error("Error fetching subject details:",Ne)}},Xe=async Se=>{ge(Se);try{const Ne=await F.get(`${ee}/subject_prerequisites.php?subject_id=${Se.id}`);Z({...xe,prerequisites:Ne.data.prerequisites||[],required_by:Ne.data.required_by||[]}),w({prerequisite_id:"",is_mandatory:1,min_grade:""}),V(!0)}catch(Ne){console.error("Error fetching prerequisites:",Ne)}},st=async()=>{if(!B.prerequisite_id){alert("Please select a prerequisite subject");return}try{await F.post(`${ee}/subject_prerequisites.php`,{subject_id:re.id,...B});const Se=await F.get(`${ee}/subject_prerequisites.php?subject_id=${re.id}`);Z({...xe,prerequisites:Se.data.prerequisites||[],required_by:Se.data.required_by||[]}),w({prerequisite_id:"",is_mandatory:1,min_grade:""}),alert("Prerequisite added successfully!")}catch(Se){alert(Se.response?.data?.error||"Failed to add prerequisite")}},ce=async Se=>{if(window.confirm("Remove this prerequisite?"))try{await F.delete(`${ee}/subject_prerequisites.php?id=${Se}`);const Ne=await F.get(`${ee}/subject_prerequisites.php?subject_id=${re.id}`);Z({...xe,prerequisites:Ne.data.prerequisites||[],required_by:Ne.data.required_by||[]}),alert("Prerequisite removed!")}catch{alert("Failed to remove prerequisite")}},_e=async Se=>{const Ne=Se.status==="active"?"archived":"active",et=Ne==="archived"?"archive":"restore";if(window.confirm(`Are you sure you want to ${et} this subject?`))try{await Ud.update(Se.id,{...Se,status:Ne}),ne(),alert(`Subject ${et}d successfully!`)}catch(Ce){console.error("Error updating subject:",Ce),alert(`Failed to ${et} subject`)}},le=Se=>{z===Se?T(j==="asc"?"desc":"asc"):(R(Se),T("asc"))},Pe=Se=>{const Ne=ie.map(et=>({"Subject Name":et.subject_name,Code:et.subject_code,Category:et.category,"Credit Hours":et.credit_hours||3,Status:et.status,Description:et.description||""}));if(Se==="csv"){const et=Object.keys(Ne[0]).join(","),Ce=Ne.map(mt=>Object.values(mt).map(pt=>`"${pt}"`).join(",")),ft=[et,...Ce].join(`
`),qe=new Blob([ft],{type:"text/csv"}),W=URL.createObjectURL(qe),Ie=document.createElement("a");Ie.href=W,Ie.download="subjects.csv",Ie.click()}else if(Se==="print"){const et=window.open("","_blank");et.document.write(`
        <html><head><title>Subjects List</title>
        <style>
          body { font-family: Arial; padding: 20px; }
          table { width: 100%; border-collapse: collapse; margin-top: 20px; }
          th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
          th { background: #2563eb; color: white; }
          h1 { color: #1f2937; }
          .stats { display: flex; gap: 20px; margin: 20px 0; }
          .stat { padding: 10px 20px; background: #f3f4f6; border-radius: 8px; }
        </style></head><body>
        <h1>Subjects List</h1>
        <div class="stats">
          <div class="stat"><strong>Total:</strong> ${ie.length}</div>
          <div class="stat"><strong>Core:</strong> ${ie.filter(Ce=>Ce.category==="core").length}</div>
          <div class="stat"><strong>Elective:</strong> ${ie.filter(Ce=>Ce.category==="elective").length}</div>
        </div>
        <table>
          <thead><tr>${Object.keys(Ne[0]).map(Ce=>`<th>${Ce}</th>`).join("")}</tr></thead>
          <tbody>${Ne.map(Ce=>`<tr>${Object.values(Ce).map(ft=>`<td>${ft}</td>`).join("")}</tr>`).join("")}</tbody>
        </table>
        </body></html>
      `),et.document.close(),et.print()}},we=Se=>{const Ne=Se.target.files[0];if(!Ne)return;const et=new FileReader;et.onload=Ce=>{const qe=Ce.target.result.split(`
`).filter(pt=>pt.trim()),W=qe[0].split(",").map(pt=>pt.trim().toLowerCase().replace(/"/g,"")),Ie=[],mt=[];for(let pt=1;pt<qe.length;pt++){const kt=qe[pt].split(",").map(Je=>Je.trim().replace(/"/g,"")),J={};W.forEach((Je,_t)=>{J[Je]=kt[_t]||""}),!J["subject name"]&&!J.subject_name?mt.push(`Row ${pt}: Missing subject name`):!J.code&&!J.subject_code?mt.push(`Row ${pt}: Missing subject code`):Ie.push({subject_name:J["subject name"]||J.subject_name,subject_code:J.code||J.subject_code,category:J.category||"core",credit_hours:parseInt(J["credit hours"]||J.credit_hours)||3,description:J.description||"",status:"active"})}H(Ie),k(mt),C(!0)},et.readAsText(Ne),Se.target.value=""},fe=async()=>{let Se=0,Ne=0;for(const et of I)try{await Ud.create(et),Se++}catch{Ne++}alert(`Import complete: ${Se} imported, ${Ne} failed`),C(!1),H([]),ne()},ye=async Se=>{if(window.confirm("Are you sure you want to delete this subject?"))try{await Ud.delete(Se),ne(),alert("Subject deleted successfully!")}catch(Ne){console.error("Error deleting subject:",Ne),alert("Failed to delete subject")}},Ke=async Se=>{Se.preventDefault();try{x?(await Ud.update(x.id,g),alert("Subject updated successfully!")):(await Ud.create(g),alert("Subject created successfully!")),u(!1),ne()}catch(Ne){console.error("Error saving subject:",Ne),alert("Failed to save subject: "+(Ne.response?.data?.error||Ne.message))}},ve=Se=>({core:"bg-blue-100 text-blue-700",elective:"bg-green-100 text-green-700",optional:"bg-purple-100 text-purple-700",extra:"bg-orange-100 text-orange-700"})[Se]||"bg-gray-100 text-gray-700",ie=t.filter(Se=>{const Ne=!f||Se.subject_name?.toLowerCase().includes(f.toLowerCase())||Se.subject_code?.toLowerCase().includes(f.toLowerCase()),et=!v||Se.category===v,Ce=!D||Se.status===D,ft=!K||Se.department_id==K,qe=!P||Se.level===P||Se.level==="all";return Ne&&et&&Ce&&ft&&qe}).sort((Se,Ne)=>{let et=Se[z]||"",Ce=Ne[z]||"";return typeof et=="string"&&(et=et.toLowerCase()),typeof Ce=="string"&&(Ce=Ce.toLowerCase()),j==="asc"?et>Ce?1:-1:et<Ce?1:-1}),q=ie.reduce((Se,Ne)=>Se+(parseInt(Ne.credit_hours)||3),0),pe=t.filter(Se=>Se.id!==re?.id&&!xe.prerequisites?.some(Ne=>Ne.prerequisite_id==Se.id)),Me=[{label:"Total Subjects",value:t.length,color:"bg-blue-500",icon:as},{label:"Departments",value:a.length,color:"bg-indigo-500",icon:eS},{label:"Core",value:t.filter(Se=>Se.category==="core").length,color:"bg-green-500",icon:as},{label:"Total Credits",value:q,color:"bg-orange-500",icon:Wt}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Subjects Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage academic subjects"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:je,className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4"})," Add Subject"]}),e.jsxs("button",{onClick:()=>oe.current?.click(),className:"btn bg-purple-600 text-white hover:bg-purple-700 flex items-center gap-2",children:[e.jsx(Hr,{className:"w-4 h-4"})," Import CSV"]}),e.jsx("input",{type:"file",ref:oe,accept:".csv",onChange:we,className:"hidden"})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Me.map((Se,Ne)=>e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-xs mb-1",children:Se.label}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Se.value})]}),e.jsx("div",{className:`${Se.color} w-10 h-10 rounded-lg flex items-center justify-center`,children:e.jsx(Se.icon,{className:"w-5 h-5 text-white"})})]})},Ne))}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 items-center flex-1",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px] max-w-md",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search subjects...",value:f,onChange:Se=>y(Se.target.value),className:"input pl-10 w-full"})]}),e.jsxs("select",{value:v,onChange:Se=>U(Se.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Categories"}),e.jsx("option",{value:"core",children:"Core"}),e.jsx("option",{value:"elective",children:"Elective"}),e.jsx("option",{value:"optional",children:"Optional"}),e.jsx("option",{value:"extra",children:"Extra"})]}),e.jsxs("select",{value:K,onChange:Se=>$(Se.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Departments"}),a.map(Se=>e.jsx("option",{value:Se.id,children:Se.department_name},Se.id))]}),e.jsxs("select",{value:P,onChange:Se=>se(Se.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Levels"}),l.map(Se=>e.jsx("option",{value:Se.level_code,children:Se.level_name},Se.id))]}),e.jsxs("select",{value:D,onChange:Se=>M(Se.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"archived",children:"Archived"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>Pe("csv"),className:"btn bg-green-600 text-white hover:bg-green-700 flex items-center gap-2",children:[e.jsx(xs,{className:"w-4 h-4"})," CSV"]}),e.jsxs("button",{onClick:()=>Pe("print"),className:"btn bg-gray-600 text-white hover:bg-gray-700 flex items-center gap-2",children:[e.jsx(or,{className:"w-4 h-4"})," Print"]})]})]})}),e.jsxs("div",{className:"card overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase cursor-pointer hover:bg-gray-100",onClick:()=>le("subject_name"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Subject Name",z==="subject_name"&&(j==="asc"?e.jsx(jl,{className:"w-3 h-3"}):e.jsx(un,{className:"w-3 h-3"}))]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase cursor-pointer hover:bg-gray-100",onClick:()=>le("subject_code"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Code",z==="subject_code"&&(j==="asc"?e.jsx(jl,{className:"w-3 h-3"}):e.jsx(un,{className:"w-3 h-3"}))]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase cursor-pointer hover:bg-gray-100",onClick:()=>le("category"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Category",z==="category"&&(j==="asc"?e.jsx(jl,{className:"w-3 h-3"}):e.jsx(un,{className:"w-3 h-3"}))]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Department"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Credits"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:c?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-12 text-center text-gray-500",children:"Loading..."})}):ie.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-12 text-center text-gray-500",children:t.length===0?"No subjects found":"No subjects match your filters"})}):ie.map(Se=>e.jsxs("tr",{className:`hover:bg-gray-50 ${Se.status==="archived"?"opacity-60":""}`,children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(as,{className:"w-4 h-4 text-blue-600"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-900",children:Se.subject_name}),Se.level&&Se.level!=="all"&&e.jsx("span",{className:"ml-2 px-1.5 py-0.5 bg-indigo-100 text-indigo-600 rounded text-xs uppercase",children:Se.level})]})]})}),e.jsx("td",{className:"px-4 py-3 font-mono text-sm text-gray-600",children:Se.subject_code}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${ve(Se.category)}`,children:Se.category})}),e.jsx("td",{className:"px-4 py-3",children:Se.department_name?e.jsx("span",{className:"px-2 py-1 bg-indigo-50 text-indigo-700 rounded text-xs",children:Se.department_name}):e.jsx("span",{className:"text-gray-400 text-xs",children:"-"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:"px-2 py-1 bg-orange-100 text-orange-700 rounded-full text-xs font-medium",children:[Se.credit_hours||3," hrs"]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${Se.status==="active"?"bg-green-100 text-green-700":Se.status==="archived"?"bg-gray-100 text-gray-500":"bg-yellow-100 text-yellow-700"}`,children:Se.status})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>ze(Se),className:"p-1.5 text-gray-600 hover:bg-gray-100 rounded",title:"View Details",children:e.jsx(na,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Xe(Se),className:"p-1.5 text-purple-600 hover:bg-purple-50 rounded",title:"Prerequisites",children:e.jsx(Hd,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Ge(Se),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",title:"Edit",children:e.jsx(Na,{className:"w-4 h-4"})}),Se.status==="active"?e.jsx("button",{onClick:()=>_e(Se),className:"p-1.5 text-orange-600 hover:bg-orange-50 rounded",title:"Archive",children:e.jsx(my,{className:"w-4 h-4"})}):e.jsx("button",{onClick:()=>_e(Se),className:"p-1.5 text-green-600 hover:bg-green-50 rounded",title:"Restore",children:e.jsx(_h,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ye(Se.id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:e.jsx(us,{className:"w-4 h-4"})})]})})]},Se.id))})]})}),ie.length>0&&e.jsxs("div",{className:"px-4 py-3 border-t bg-gray-50 text-sm text-gray-600",children:["Showing ",ie.length," of ",t.length," subjects"]})]}),m&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:x?"Edit Subject":"Add New Subject"}),e.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:Ke,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject Name *"}),e.jsx("input",{type:"text",required:!0,value:g.subject_name,onChange:Se=>N({...g,subject_name:Se.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject Code *"}),e.jsx("input",{type:"text",required:!0,value:g.subject_code,onChange:Se=>N({...g,subject_code:Se.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category *"}),e.jsxs("select",{required:!0,value:g.category,onChange:Se=>N({...g,category:Se.target.value}),className:"input",children:[e.jsx("option",{value:"core",children:"Core"}),e.jsx("option",{value:"elective",children:"Elective"}),e.jsx("option",{value:"optional",children:"Optional"}),e.jsx("option",{value:"extra",children:"Extra"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Credit Hours *"}),e.jsx("input",{type:"number",required:!0,min:"1",max:"10",value:g.credit_hours,onChange:Se=>N({...g,credit_hours:Se.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),e.jsxs("select",{value:g.department_id,onChange:Se=>N({...g,department_id:Se.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"No Department"}),a.map(Se=>e.jsx("option",{value:Se.id,children:Se.department_name},Se.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Level"}),e.jsxs("select",{value:g.level,onChange:Se=>N({...g,level:Se.target.value}),className:"input",children:[e.jsx("option",{value:"all",children:"All Levels"}),l.map(Se=>e.jsx("option",{value:Se.level_code,children:Se.level_name},Se.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:g.status,onChange:Se=>N({...g,status:Se.target.value}),className:"input",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:g.description,onChange:Se=>N({...g,description:Se.target.value}),className:"input",rows:"2"})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:()=>u(!1),className:"btn bg-gray-200 text-gray-700 hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:x?"Update Subject":"Add Subject"})]})]})]})}),Q&&re&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between sticky top-0 bg-white",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:re.subject_name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[re.subject_code,"  ",re.category]})]}),e.jsx("button",{onClick:()=>E(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg text-center",children:[e.jsx(il,{className:"w-6 h-6 text-blue-600 mx-auto mb-1"}),e.jsx("p",{className:"text-2xl font-bold text-blue-700",children:xe.classes.length}),e.jsx("p",{className:"text-xs text-gray-600",children:"Classes"})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg text-center",children:[e.jsx(Rt,{className:"w-6 h-6 text-green-600 mx-auto mb-1"}),e.jsx("p",{className:"text-2xl font-bold text-green-700",children:xe.teachers.length}),e.jsx("p",{className:"text-xs text-gray-600",children:"Teachers"})]}),e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg text-center",children:[e.jsx(Wt,{className:"w-6 h-6 text-orange-600 mx-auto mb-1"}),e.jsx("p",{className:"text-2xl font-bold text-orange-700",children:re.credit_hours||3}),e.jsx("p",{className:"text-xs text-gray-600",children:"Credit Hours"})]})]}),re.description&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Description"}),e.jsx("p",{className:"text-gray-600 text-sm",children:re.description})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(il,{className:"w-4 h-4"})," Classes (",xe.classes.length,")"]}),xe.classes.length>0?e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left",children:"Class"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Teacher"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Periods/Week"})]})}),e.jsx("tbody",{className:"divide-y",children:xe.classes.map((Se,Ne)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 py-2 font-medium",children:Se.class_name}),e.jsx("td",{className:"px-3 py-2",children:Se.teacher_name||"Not assigned"}),e.jsx("td",{className:"px-3 py-2",children:Se.periods_per_week})]},Ne))})]})}):e.jsx("p",{className:"text-gray-500 text-sm",children:"Not assigned to any class"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Rt,{className:"w-4 h-4"})," Teachers (",xe.teachers.length,")"]}),xe.teachers.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:xe.teachers.map((Se,Ne)=>e.jsxs("div",{className:"px-3 py-2 bg-green-50 rounded-lg",children:[e.jsx("p",{className:"font-medium text-green-700",children:Se.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[Se.classes?.length||0," class(es)"]})]},Ne))}):e.jsx("p",{className:"text-gray-500 text-sm",children:"No teachers assigned"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Hd,{className:"w-4 h-4"})," Prerequisites (",xe.prerequisites?.length||0,")"]}),xe.prerequisites?.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:xe.prerequisites.map((Se,Ne)=>e.jsxs("div",{className:`px-3 py-2 rounded-lg ${Se.is_mandatory?"bg-red-50":"bg-yellow-50"}`,children:[e.jsx("p",{className:`font-medium ${Se.is_mandatory?"text-red-700":"text-yellow-700"}`,children:Se.prerequisite_name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[Se.is_mandatory?"Required":"Recommended",Se.min_grade?` (Min: ${Se.min_grade})`:""]})]},Ne))}):e.jsx("p",{className:"text-gray-500 text-sm",children:"No prerequisites"})]}),xe.required_by?.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Qs,{className:"w-4 h-4"})," Required By (",xe.required_by.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:xe.required_by.map((Se,Ne)=>e.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 rounded text-sm",children:Se.subject_name},Ne))})]})]})]})}),O&&re&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between sticky top-0 bg-white",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Manage Prerequisites"}),e.jsx("p",{className:"text-sm text-gray-500",children:re.subject_name})]}),e.jsx("button",{onClick:()=>V(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Add Prerequisite"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("select",{value:B.prerequisite_id,onChange:Se=>w({...B,prerequisite_id:Se.target.value}),className:"input w-full",children:[e.jsx("option",{value:"",children:"Select a subject..."}),pe.map(Se=>e.jsxs("option",{value:Se.id,children:[Se.subject_name," (",Se.subject_code,")"]},Se.id))]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("select",{value:B.is_mandatory,onChange:Se=>w({...B,is_mandatory:Se.target.value}),className:"input flex-1",children:[e.jsx("option",{value:"1",children:"Required"}),e.jsx("option",{value:"0",children:"Recommended"})]}),e.jsx("input",{type:"text",placeholder:"Min Grade (e.g., C)",value:B.min_grade,onChange:Se=>w({...B,min_grade:Se.target.value}),className:"input w-24"})]}),e.jsx("button",{onClick:st,className:"btn btn-primary w-full",disabled:!B.prerequisite_id,children:"Add Prerequisite"})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium mb-3",children:["Current Prerequisites (",xe.prerequisites?.length||0,")"]}),xe.prerequisites?.length>0?e.jsx("div",{className:"space-y-2",children:xe.prerequisites.map(Se=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:Se.prerequisite_name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[Se.is_mandatory==1?"Required":"Recommended",Se.min_grade?`  Min Grade: ${Se.min_grade}`:""]})]}),e.jsx("button",{onClick:()=>ce(Se.id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",children:e.jsx(us,{className:"w-4 h-4"})})]},Se.id))}):e.jsx("p",{className:"text-gray-500 text-sm text-center py-4",children:"No prerequisites defined"})]}),xe.required_by?.length>0&&e.jsxs("div",{className:"mt-6 pt-4 border-t",children:[e.jsx("h4",{className:"font-medium mb-3 text-purple-700",children:"This subject is required by:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:xe.required_by.map((Se,Ne)=>e.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 rounded text-sm",children:Se.subject_name},Ne))})]})]})]})}),te&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between sticky top-0 bg-white",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Import Subjects"}),e.jsx("button",{onClick:()=>{C(!1),H([]),k([])},children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6",children:[ae.length>0&&e.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx("p",{className:"font-medium text-red-700 mb-2",children:"Errors found:"}),e.jsx("ul",{className:"text-sm text-red-600 list-disc list-inside",children:ae.map((Se,Ne)=>e.jsx("li",{children:Se},Ne))})]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:[I.length," subject(s) ready to import. Review before importing:"]}),e.jsx("div",{className:"border rounded-lg overflow-hidden max-h-72 overflow-y-auto mb-4",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left",children:"Subject Name"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Code"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Category"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Credits"})]})}),e.jsx("tbody",{className:"divide-y",children:I.map((Se,Ne)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 py-2",children:Se.subject_name}),e.jsx("td",{className:"px-3 py-2 font-mono text-xs",children:Se.subject_code}),e.jsx("td",{className:"px-3 py-2",children:Se.category}),e.jsx("td",{className:"px-3 py-2",children:Se.credit_hours})]},Ne))})]})}),e.jsx("div",{className:"bg-gray-50 p-3 rounded-lg mb-4",children:e.jsxs("p",{className:"text-xs text-gray-600",children:[e.jsx("strong",{children:"CSV Format:"})," Subject Name, Code, Category, Credit Hours, Description",e.jsx("br",{}),e.jsx("strong",{children:"Example:"})," Mathematics, MATH101, core, 3, Basic mathematics course"]})}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>{C(!1),H([])},className:"btn bg-gray-200 hover:bg-gray-300",children:"Cancel"}),e.jsxs("button",{onClick:fe,className:"btn btn-primary",disabled:I.length===0,children:["Import ",I.length," Subject(s)"]})]})]})]})})]})}function w7(){const[t,s]=h.useState([]),[a,r]=h.useState(!0),[l,c]=h.useState(!1),[o,m]=h.useState(null),[u,x]=h.useState({term_name:"",term_code:"",academic_year:"2024/2025",term_number:1,start_date:"",end_date:"",status:"upcoming",description:""}),[A,g]=h.useState(""),[N,f]=h.useState(""),[y,v]=h.useState(""),[U,D]=h.useState("start_date"),[M,K]=h.useState("desc"),[$,P]=h.useState("table"),[se,z]=h.useState(!1),[R,j]=h.useState(!1),[T,Q]=h.useState(null),[E,te]=h.useState([]),[C,O]=h.useState({event_name:"",event_date:"",event_type:"holiday",description:""});h.useEffect(()=>{V()},[]);const V=async()=>{try{r(!0);const le=await yl.getAll();s(le.data.terms||[])}catch(le){console.error("Error fetching terms:",le),alert("Failed to load terms")}finally{r(!1)}},re=()=>{m(null),x({term_name:"",term_code:"",academic_year:"2024/2025",term_number:1,start_date:"",end_date:"",status:"upcoming",description:""}),c(!0)},ge=le=>{m(le),x({term_name:le.term_name,term_code:le.term_code,academic_year:le.academic_year,term_number:le.term_number,start_date:le.start_date,end_date:le.end_date,status:le.status,description:le.description||""}),c(!0)},xe=async le=>{if(window.confirm("Are you sure you want to delete this term?"))try{await yl.delete(le),V(),alert("Term deleted successfully!")}catch(Pe){console.error("Error deleting term:",Pe),alert("Failed to delete term")}},Z=async le=>{if(window.confirm("Activate this term? This will deactivate all other terms."))try{await yl.activate(le),V(),alert("Term activated successfully!")}catch(Pe){console.error("Error activating term:",Pe),alert("Failed to activate term")}},I=async le=>{le.preventDefault();try{o?(await yl.update(o.id,u),alert("Term updated successfully!")):(await yl.create(u),alert("Term created successfully!")),c(!1),V()}catch(Pe){console.error("Error saving term:",Pe),alert("Failed to save term: "+(Pe.response?.data?.error||Pe.message))}},H=le=>({upcoming:"bg-blue-100 text-blue-700",active:"bg-green-100 text-green-700",completed:"bg-gray-100 text-gray-700",archived:"bg-yellow-100 text-yellow-700"})[le]||"bg-gray-100 text-gray-700",ae=(le,Pe)=>{const we=new Date(le),fe=new Date(Pe),ye=Math.abs(fe-we),Ke=Math.ceil(ye/(1e3*60*60*24)),ve=Math.floor(Ke/7),ie=Ke%7;return{weeks:ve,days:ie,totalDays:Ke}},k=(le,Pe)=>{const we=new Date(le),fe=new Date(Pe),ye=new Date;if(ye<we)return 0;if(ye>fe)return 100;const Ke=fe-we,ve=ye-we;return Math.round(ve/Ke*100)},B=le=>{U===le?K(M==="asc"?"desc":"asc"):(D(le),K("asc"))},w=async le=>{const Pe=le.status==="archived"?"completed":"archived",we=Pe==="archived"?"archive":"restore";if(window.confirm(`Are you sure you want to ${we} this term?`))try{await yl.update(le.id,{...le,status:Pe}),V(),alert(`Term ${we}d successfully!`)}catch{alert(`Failed to ${we} term`)}},oe=async()=>{if(!T)return;const le=T.academic_year,[Pe,we]=le.split("/").map(Number),fe=`${Pe+1}/${we+1}`,ye=new Date(T.start_date);ye.setFullYear(ye.getFullYear()+1);const Ke=new Date(T.end_date);Ke.setFullYear(Ke.getFullYear()+1);try{await yl.create({term_name:T.term_name,term_code:`${T.term_code.split("-")[0]}-${we+1}`,academic_year:fe,term_number:T.term_number,start_date:ye.toISOString().split("T")[0],end_date:Ke.toISOString().split("T")[0],status:"upcoming",description:T.description}),j(!1),V(),alert("Term copied successfully!")}catch{alert("Failed to copy term")}},ne=le=>{const Pe=Xe.map(we=>({"Term Name":we.term_name,Code:we.term_code,"Academic Year":we.academic_year,"Term Number":we.term_number,"Start Date":we.start_date,"End Date":we.end_date,Duration:`${ae(we.start_date,we.end_date).weeks} weeks`,Status:we.status,Active:we.is_active?"Yes":"No"}));if(le==="csv"){const we=Object.keys(Pe[0]).join(","),fe=Pe.map(q=>Object.values(q).map(pe=>`"${pe}"`).join(",")),ye=[we,...fe].join(`
`),Ke=new Blob([ye],{type:"text/csv"}),ve=URL.createObjectURL(Ke),ie=document.createElement("a");ie.href=ve,ie.download="academic_terms.csv",ie.click()}else if(le==="print"){const we=window.open("","_blank");we.document.write(`
        <html><head><title>Academic Terms</title>
        <style>
          body { font-family: Arial; padding: 20px; }
          table { width: 100%; border-collapse: collapse; margin-top: 20px; }
          th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
          th { background: #2563eb; color: white; }
          h1 { color: #1f2937; }
          .active { color: green; font-weight: bold; }
        </style></head><body>
        <h1>Academic Terms</h1>
        <table>
          <thead><tr>${Object.keys(Pe[0]).map(fe=>`<th>${fe}</th>`).join("")}</tr></thead>
          <tbody>${Pe.map(fe=>`<tr>${Object.values(fe).map(ye=>`<td>${ye}</td>`).join("")}</tr>`).join("")}</tbody>
        </table>
        </body></html>
      `),we.document.close(),we.print()}},Fe=async le=>{Q(le);try{const Pe=await F.get(`${ee}/term_events.php?term_id=${le.id}`);te(Pe.data.events||[])}catch{te([])}O({event_name:"",event_date:"",event_type:"holiday",description:""}),z(!0)},je=async()=>{if(!C.event_name||!C.event_date){alert("Event name and date are required");return}try{await F.post(`${ee}/term_events.php`,{term_id:T.id,...C});const le=await F.get(`${ee}/term_events.php?term_id=${T.id}`);te(le.data.events||[]),O({event_name:"",event_date:"",event_type:"holiday",description:""}),alert("Event added!")}catch{alert("Failed to add event")}},Ge=async le=>{if(window.confirm("Delete this event?"))try{await F.delete(`${ee}/term_events.php?id=${le}`),te(E.filter(Pe=>Pe.id!==le))}catch{alert("Failed to delete event")}},ze=le=>{const Pe=new Date,we=new Date(le.start_date),fe=new Date(le.end_date);return le.status==="archived"?"archived":Pe<we?"upcoming":Pe>=we&&Pe<=fe?"active":"completed"},Xe=t.filter(le=>{const Pe=!A||le.term_name?.toLowerCase().includes(A.toLowerCase())||le.term_code?.toLowerCase().includes(A.toLowerCase()),we=!N||le.academic_year===N,fe=!y||le.status===y||ze(le)===y;return Pe&&we&&fe}).sort((le,Pe)=>{let we=le[U]||"",fe=Pe[U]||"";return(U==="start_date"||U==="end_date")&&(we=new Date(we),fe=new Date(fe)),M==="asc"?we>fe?1:-1:we<fe?1:-1}),st=[...new Set(t.map(le=>le.academic_year))].sort().reverse(),ce=t.find(le=>le.is_active==1),_e=[{label:"Total Terms",value:t.length,color:"bg-blue-500",icon:Ot},{label:"Active Term",value:ce?.term_name||"None",color:"bg-green-500",icon:Mt},{label:"Upcoming",value:t.filter(le=>ze(le)==="upcoming").length,color:"bg-purple-500",icon:Wt},{label:"Academic Years",value:st.length,color:"bg-orange-500",icon:as}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Academic Terms"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage academic terms and sessions"})]}),e.jsxs("button",{onClick:re,className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-5 h-5"}),"Add Term"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:_e.map((le,Pe)=>e.jsx("div",{className:"card p-5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm mb-1",children:le.label}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:le.value})]}),e.jsx("div",{className:`${le.color} w-10 h-10 rounded-lg flex items-center justify-center`,children:e.jsx(le.icon,{className:"w-5 h-5 text-white"})})]})},Pe))}),ce&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900",children:["Current Term: ",ce.term_name]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[ce.academic_year,"  ",new Date(ce.start_date).toLocaleDateString()," - ",new Date(ce.end_date).toLocaleDateString()]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[k(ce.start_date,ce.end_date),"%"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Complete"})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"bg-blue-600 h-3 rounded-full transition-all duration-500",style:{width:`${k(ce.start_date,ce.end_date)}%`}})}),e.jsxs("div",{className:"flex justify-between mt-2 text-xs text-gray-500",children:[e.jsxs("span",{children:[ae(ce.start_date,ce.end_date).weeks," weeks, ",ae(ce.start_date,ce.end_date).days," days total"]}),e.jsxs("span",{children:[Math.ceil((new Date(ce.end_date)-new Date)/(1e3*60*60*24))," days remaining"]})]})]}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search terms...",value:A,onChange:le=>g(le.target.value),className:"input pl-10 w-full"})]}),e.jsxs("select",{value:N,onChange:le=>f(le.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Years"}),st.map(le=>e.jsx("option",{value:le,children:le},le))]}),e.jsxs("select",{value:y,onChange:le=>v(le.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"upcoming",children:"Upcoming"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"archived",children:"Archived"})]}),e.jsxs("div",{className:"flex gap-2 ml-auto",children:[e.jsx("button",{onClick:()=>P($==="table"?"calendar":"table"),className:"btn bg-gray-100 text-gray-700 hover:bg-gray-200",children:$==="table"?e.jsx(jh,{className:"w-4 h-4"}):e.jsx(na,{className:"w-4 h-4"})}),e.jsxs("button",{onClick:()=>ne("csv"),className:"btn bg-green-600 text-white hover:bg-green-700 flex items-center gap-2",children:[e.jsx(xs,{className:"w-4 h-4"})," CSV"]}),e.jsxs("button",{onClick:()=>ne("print"),className:"btn bg-gray-600 text-white hover:bg-gray-700 flex items-center gap-2",children:[e.jsx(or,{className:"w-4 h-4"})," Print"]})]})]})}),$==="calendar"&&e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Term Calendar"}),e.jsx("div",{className:"space-y-3",children:Xe.map(le=>{const Pe=ae(le.start_date,le.end_date),we=k(le.start_date,le.end_date);return e.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${le.is_active==1?"bg-green-500":ze(le)==="upcoming"?"bg-blue-500":"bg-gray-400"}`}),e.jsx("span",{className:"font-medium",children:le.term_name}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",le.academic_year,")"]})]}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${H(ze(le))}`,children:ze(le)})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-2",children:[e.jsxs("span",{children:[e.jsx(Ot,{className:"w-4 h-4 inline mr-1"}),new Date(le.start_date).toLocaleDateString()," - ",new Date(le.end_date).toLocaleDateString()]}),e.jsxs("span",{children:[e.jsx(Wt,{className:"w-4 h-4 inline mr-1"}),Pe.weeks,"w ",Pe.days,"d"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${le.is_active==1?"bg-green-500":"bg-blue-400"}`,style:{width:`${we}%`}})})]},le.id)})})]}),$==="table"&&e.jsx("div",{className:"card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase cursor-pointer hover:bg-gray-100",onClick:()=>B("term_name"),children:["Term Name ",U==="term_name"&&(M==="asc"?e.jsx(jl,{className:"w-3 h-3 inline"}):e.jsx(un,{className:"w-3 h-3 inline"}))]}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Code"}),e.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase cursor-pointer hover:bg-gray-100",onClick:()=>B("academic_year"),children:["Year ",U==="academic_year"&&(M==="asc"?e.jsx(jl,{className:"w-3 h-3 inline"}):e.jsx(un,{className:"w-3 h-3 inline"}))]}),e.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase cursor-pointer hover:bg-gray-100",onClick:()=>B("start_date"),children:["Duration ",U==="start_date"&&(M==="asc"?e.jsx(jl,{className:"w-3 h-3 inline"}):e.jsx(un,{className:"w-3 h-3 inline"}))]}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Progress"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:a?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-12 text-center text-gray-500",children:"Loading..."})}):Xe.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-12 text-center text-gray-500",children:"No terms found"})}):Xe.map(le=>{const Pe=ae(le.start_date,le.end_date),we=k(le.start_date,le.end_date);return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:le.term_name}),le.is_active==1&&e.jsx("span",{className:"px-2 py-0.5 bg-green-100 text-green-700 text-xs font-medium rounded-full",children:"Current"})]})}),e.jsx("td",{className:"px-4 py-3 font-mono text-sm text-gray-600",children:le.term_code}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:le.academic_year}),e.jsxs("td",{className:"px-4 py-3 text-sm text-gray-600",children:[e.jsxs("div",{children:[new Date(le.start_date).toLocaleDateString()," - ",new Date(le.end_date).toLocaleDateString()]}),e.jsxs("div",{className:"text-xs text-gray-400",children:[Pe.weeks,"w ",Pe.days,"d (",Pe.totalDays," days)"]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${we===100?"bg-gray-400":"bg-blue-500"}`,style:{width:`${we}%`}})}),e.jsxs("span",{className:"text-xs text-gray-500",children:[we,"%"]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${H(ze(le))}`,children:ze(le)})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-1",children:[!le.is_active&&le.status!=="archived"&&e.jsx("button",{onClick:()=>Z(le.id),className:"p-1.5 text-green-600 hover:bg-green-50 rounded",title:"Activate",children:e.jsx(Mt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Fe(le),className:"p-1.5 text-purple-600 hover:bg-purple-50 rounded",title:"Events/Holidays",children:e.jsx(nS,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{Q(le),j(!0)},className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",title:"Copy to Next Year",children:e.jsx(vl,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ge(le),className:"p-1.5 text-gray-600 hover:bg-gray-100 rounded",title:"Edit",children:e.jsx(Na,{className:"w-4 h-4"})}),le.status!=="archived"?e.jsx("button",{onClick:()=>w(le),className:"p-1.5 text-orange-600 hover:bg-orange-50 rounded",title:"Archive",children:e.jsx(my,{className:"w-4 h-4"})}):e.jsx("button",{onClick:()=>w(le),className:"p-1.5 text-green-600 hover:bg-green-50 rounded",title:"Restore",children:e.jsx(_h,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>xe(le.id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:e.jsx(us,{className:"w-4 h-4"})})]})})]},le.id)})})]})})}),l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:o?"Edit Term":"Add New Term"}),e.jsx("button",{onClick:()=>c(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:I,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Term Name *"}),e.jsx("input",{type:"text",required:!0,value:u.term_name,onChange:le=>x({...u,term_name:le.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Term Code *"}),e.jsx("input",{type:"text",required:!0,value:u.term_code,onChange:le=>x({...u,term_code:le.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Academic Year *"}),e.jsx("input",{type:"text",required:!0,value:u.academic_year,onChange:le=>x({...u,academic_year:le.target.value}),className:"input",placeholder:"2024/2025"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Term Number *"}),e.jsxs("select",{required:!0,value:u.term_number,onChange:le=>x({...u,term_number:le.target.value}),className:"input",children:[e.jsx("option",{value:"1",children:"Term 1"}),e.jsx("option",{value:"2",children:"Term 2"}),e.jsx("option",{value:"3",children:"Term 3"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date *"}),e.jsx("input",{type:"date",required:!0,value:u.start_date,onChange:le=>x({...u,start_date:le.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date *"}),e.jsx("input",{type:"date",required:!0,value:u.end_date,onChange:le=>x({...u,end_date:le.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:u.status,onChange:le=>x({...u,status:le.target.value}),className:"input",children:[e.jsx("option",{value:"upcoming",children:"Upcoming"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"completed",children:"Completed"})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:u.description,onChange:le=>x({...u,description:le.target.value}),className:"input",rows:"3"})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:()=>c(!1),className:"btn bg-gray-200 text-gray-700 hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:o?"Update Term":"Add Term"})]})]})]})}),R&&T&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Copy Term to Next Year"}),e.jsx("button",{onClick:()=>j(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Source:"})," ",T.term_name," (",T.academic_year,")"]}),e.jsxs("p",{className:"text-sm text-blue-800 mt-1",children:[e.jsx("strong",{children:"New Year:"})," ",(()=>{const[le,Pe]=T.academic_year.split("/").map(Number);return`${le+1}/${Pe+1}`})()]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"This will create a new term with the same name and duration, shifted to the next academic year."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>j(!1),className:"btn bg-gray-200 text-gray-700 hover:bg-gray-300 flex-1",children:"Cancel"}),e.jsxs("button",{onClick:oe,className:"btn btn-primary flex-1 flex items-center justify-center gap-2",children:[e.jsx(vl,{className:"w-4 h-4"})," Copy Term"]})]})]})]})}),se&&T&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Term Events & Holidays"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[T.term_name," (",T.academic_year,")"]})]}),e.jsx("button",{onClick:()=>z(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Add New Event"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("input",{type:"text",placeholder:"Event name",value:C.event_name,onChange:le=>O({...C,event_name:le.target.value}),className:"input"}),e.jsx("input",{type:"date",value:C.event_date,onChange:le=>O({...C,event_date:le.target.value}),className:"input",min:T.start_date,max:T.end_date}),e.jsxs("select",{value:C.event_type,onChange:le=>O({...C,event_type:le.target.value}),className:"input",children:[e.jsx("option",{value:"holiday",children:"Holiday"}),e.jsx("option",{value:"exam",children:"Exam Period"}),e.jsx("option",{value:"break",children:"Break"}),e.jsx("option",{value:"event",children:"School Event"}),e.jsx("option",{value:"deadline",children:"Deadline"})]}),e.jsx("input",{type:"text",placeholder:"Description (optional)",value:C.description,onChange:le=>O({...C,description:le.target.value}),className:"input"})]}),e.jsxs("button",{onClick:je,className:"btn btn-primary mt-3 flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4"})," Add Event"]})]}),e.jsx("div",{className:"space-y-2",children:E.length===0?e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No events added yet"}):E.map(le=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${le.event_type==="holiday"?"bg-red-100 text-red-600":le.event_type==="exam"?"bg-purple-100 text-purple-600":le.event_type==="break"?"bg-green-100 text-green-600":le.event_type==="deadline"?"bg-orange-100 text-orange-600":"bg-blue-100 text-blue-600"}`,children:le.event_type==="holiday"?e.jsx(Kk,{className:"w-4 h-4"}):le.event_type==="exam"?e.jsx(as,{className:"w-4 h-4"}):e.jsx(Ot,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:le.event_name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[new Date(le.event_date).toLocaleDateString()," ",e.jsx("span",{className:"capitalize ml-1",children:le.event_type})]})]})]}),e.jsx("button",{onClick:()=>Ge(le.id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",children:e.jsx(us,{className:"w-4 h-4"})})]},le.id))})]}),e.jsx("div",{className:"p-4 border-t border-gray-200",children:e.jsx("button",{onClick:()=>z(!1),className:"btn bg-gray-200 text-gray-700 hover:bg-gray-300 w-full",children:"Close"})})]})})]})}function _7(){const t=la(),[s,a]=h.useState([]),[r,l]=h.useState(!0),[c,o]=h.useState(!1),[m,u]=h.useState(null),[x,A]=h.useState(null),[g,N]=h.useState(null),[f,y]=h.useState(""),[v,U]=h.useState(""),[D,M]=h.useState(""),K=h.useRef(null),[$,P]=h.useState({first_name:"",last_name:"",email:"",phone:"",date_of_birth:"",gender:"male",address:"",qualification:"",specialization:"",hire_date:"",employment_type:"full-time",status:"active"});h.useEffect(()=>{z()},[]);const se=C=>{const O=C.target.files[0];if(O){if(!O.type.startsWith("image/")){alert("Please select an image file");return}if(O.size>5*1024*1024){alert("File size must be less than 5MB");return}A(O);const V=new FileReader;V.onloadend=()=>{N(V.result)},V.readAsDataURL(O)}},z=async()=>{try{l(!0);const C=await Pp.getAll();a(C.data.teachers||[])}catch(C){console.error("Error fetching teachers:",C),alert("Failed to load teachers")}finally{l(!1)}},R=()=>{u(null),A(null),N(null),P({first_name:"",last_name:"",email:"",phone:"",date_of_birth:"",gender:"male",address:"",qualification:"",specialization:"",hire_date:new Date().toISOString().split("T")[0],employment_type:"full-time",status:"active"}),o(!0)},j=C=>{u(C),A(null),N(null),P({first_name:C.first_name,last_name:C.last_name,email:C.email,phone:C.phone||"",date_of_birth:C.date_of_birth||"",gender:C.gender||"male",address:C.address||"",qualification:C.qualification||"",specialization:C.specialization||"",hire_date:C.hire_date||"",employment_type:C.employment_type,status:C.status}),o(!0)},T=async C=>{if(window.confirm("Are you sure you want to delete this teacher?"))try{await Pp.delete(C),z(),alert("Teacher deleted successfully!")}catch(O){console.error("Error deleting teacher:",O),alert("Failed to delete teacher")}},Q=async C=>{C.preventDefault();try{let O;if(m?(await Pp.update(m.id,$),O=m.id,alert("Teacher updated successfully!")):(O=(await Pp.create($)).data.teacher.id,alert("Teacher created successfully!")),x&&O){const V=new FormData;V.append("profile_picture",x),V.append("type","teacher"),V.append("id",O),await F.post("https://eea.mcaforo.com/backend/api/upload_profile_picture.php",V,{headers:{"Content-Type":"multipart/form-data"}})}o(!1),z()}catch(O){console.error("Error saving teacher:",O),alert("Failed to save teacher: "+(O.response?.data?.error||O.message))}},E=[{label:"Total Teachers",value:s.length,color:"bg-blue-500",icon:Rt},{label:"Active",value:s.filter(C=>C.status==="active").length,color:"bg-green-500",icon:Rt},{label:"On Leave",value:s.filter(C=>C.status==="on-leave").length,color:"bg-orange-500",icon:Wt},{label:"Full-Time",value:s.filter(C=>C.employment_type==="full-time").length,color:"bg-purple-500",icon:Pr}],te=s.filter(C=>{const O=f===""||C.first_name?.toLowerCase().includes(f.toLowerCase())||C.last_name?.toLowerCase().includes(f.toLowerCase())||C.email?.toLowerCase().includes(f.toLowerCase())||C.teacher_id?.toLowerCase().includes(f.toLowerCase()),V=v===""||C.status===v,re=D===""||C.employment_type===D;return O&&V&&re});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Teachers Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage teaching staff"})]}),e.jsxs("button",{onClick:R,className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-5 h-5"}),"Add Teacher"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:E.map((C,O)=>e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm mb-1",children:C.label}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:C.value})]}),e.jsx("div",{className:`${C.color} w-12 h-12 rounded-lg flex items-center justify-center`,children:e.jsx(C.icon,{className:"w-6 h-6 text-white"})})]})},O))}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search teachers...",value:f,onChange:C=>y(C.target.value),className:"input pl-10 w-full"})]})}),e.jsxs("select",{value:v,onChange:C=>U(C.target.value),className:"input w-40",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"on-leave",children:"On Leave"})]}),e.jsxs("select",{value:D,onChange:C=>M(C.target.value),className:"input w-40",children:[e.jsx("option",{value:"",children:"All Employment"}),e.jsx("option",{value:"full-time",children:"Full-Time"}),e.jsx("option",{value:"part-time",children:"Part-Time"}),e.jsx("option",{value:"contract",children:"Contract"})]})]})}),e.jsx("div",{className:"card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Teacher"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Teacher ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Specialization"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Contact"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Employment"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:r?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-12 text-center text-gray-500",children:"Loading..."})}):te.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-12 text-center text-gray-500",children:"No teachers found"})}):te.map(C=>e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>t(`/admin/teachers/${C.id}`),children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsxs("span",{className:"text-blue-600 font-semibold",children:[C.first_name?.charAt(0),C.last_name?.charAt(0)]})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900",children:[C.first_name," ",C.last_name]}),e.jsx("p",{className:"text-sm text-gray-500",children:C.email})]})]})}),e.jsx("td",{className:"px-6 py-4 font-mono text-sm text-gray-600",children:C.teacher_id}),e.jsx("td",{className:"px-6 py-4 text-gray-600",children:C.specialization||"-"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:C.phone||"-"}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-sm text-gray-600 capitalize",children:C.employment_type})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${C.status==="active"?"bg-green-100 text-green-700":C.status==="on-leave"?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-700"}`,children:C.status})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",onClick:O=>O.stopPropagation(),children:[e.jsx("button",{onClick:()=>t(`/admin/teachers/${C.id}`),className:"text-green-600 hover:text-green-700",title:"View Profile",children:e.jsx(na,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>j(C),className:"text-blue-600 hover:text-blue-700",title:"Edit",children:e.jsx(Na,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>T(C.id),className:"text-red-600 hover:text-red-700",title:"Delete",children:e.jsx(us,{className:"w-4 h-4"})})]})})]},C.id))})]})})}),c&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between sticky top-0 bg-white",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:m?"Edit Teacher":"Add New Teacher"}),e.jsx("button",{onClick:()=>o(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:Q,className:"p-6 space-y-4",children:[e.jsx("div",{className:"mb-6 flex justify-center",children:m?e.jsx(p4,{type:"teacher",id:m.id,currentPicture:m.profile_picture,onUploadSuccess:()=>z()}):e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden bg-gray-200 border-4 border-white shadow-lg mx-auto mb-3",children:g?e.jsx("img",{src:g,alt:"Preview",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-blue-500 to-purple-600",children:e.jsx(ha,{className:"w-12 h-12 text-white"})})}),e.jsx("input",{ref:K,type:"file",accept:"image/*",onChange:se,className:"hidden"}),e.jsxs("button",{type:"button",onClick:()=>K.current?.click(),className:"btn btn-sm bg-gray-200 hover:bg-gray-300 flex items-center gap-2 mx-auto",children:[e.jsx(Hr,{className:"w-4 h-4"}),x?"Change Picture":"Upload Picture"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Optional - JPG, PNG, GIF (Max 5MB)"})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name *"}),e.jsx("input",{type:"text",required:!0,value:$.first_name,onChange:C=>P({...$,first_name:C.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name *"}),e.jsx("input",{type:"text",required:!0,value:$.last_name,onChange:C=>P({...$,last_name:C.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),e.jsx("input",{type:"email",required:!0,value:$.email,onChange:C=>P({...$,email:C.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),e.jsx("input",{type:"tel",value:$.phone,onChange:C=>P({...$,phone:C.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date of Birth"}),e.jsx("input",{type:"date",value:$.date_of_birth,onChange:C=>P({...$,date_of_birth:C.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gender"}),e.jsxs("select",{value:$.gender,onChange:C=>P({...$,gender:C.target.value}),className:"input",children:[e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),e.jsx("textarea",{value:$.address,onChange:C=>P({...$,address:C.target.value}),className:"input",rows:"2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Qualification"}),e.jsx("input",{type:"text",value:$.qualification,onChange:C=>P({...$,qualification:C.target.value}),className:"input",placeholder:"e.g., B.Ed Mathematics"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Specialization"}),e.jsx("input",{type:"text",value:$.specialization,onChange:C=>P({...$,specialization:C.target.value}),className:"input",placeholder:"e.g., Mathematics"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hire Date"}),e.jsx("input",{type:"date",value:$.hire_date,onChange:C=>P({...$,hire_date:C.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employment Type"}),e.jsxs("select",{value:$.employment_type,onChange:C=>P({...$,employment_type:C.target.value}),className:"input",children:[e.jsx("option",{value:"full-time",children:"Full-Time"}),e.jsx("option",{value:"part-time",children:"Part-Time"}),e.jsx("option",{value:"contract",children:"Contract"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:$.status,onChange:C=>P({...$,status:C.target.value}),className:"input",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"on-leave",children:"On Leave"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:()=>o(!1),className:"btn bg-gray-200 text-gray-700 hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:m?"Update Teacher":"Add Teacher"})]})]})]})})]})}const Fo=`${ee}/teacher_management.php`;function C7(){const{teacherId:t}=qd(),s=la(),{user:a}=Us(),[r,l]=h.useState(null),[c,o]=h.useState(!0),[m,u]=h.useState("overview"),[x,A]=h.useState(!1),[g,N]=h.useState(!1),[f,y]=h.useState(!1),[v,U]=h.useState(!1),[D,M]=h.useState(!1),[K,$]=h.useState(!1),[P,se]=h.useState(!1),[z,R]=h.useState({}),[j,T]=h.useState({leave_type:"annual",start_date:"",end_date:"",reason:""}),[Q,E]=h.useState({note_type:"general",title:"",content:"",is_confidential:!1}),[te,C]=h.useState({}),[O,V]=h.useState({qualification_type:"degree",title:"",institution:"",year_obtained:""}),[re,ge]=h.useState({award_type:"excellence",title:"",award_date:"",description:""}),[xe,Z]=h.useState({});h.useEffect(()=>{H(),I()},[t]);const I=async()=>{try{const _e=await F.get(`${ee}/public_settings.php`);Z(_e.data.settings||{})}catch(_e){console.error("Error fetching school settings:",_e)}},H=async()=>{try{o(!0);const _e=await F.get(`${Fo}?resource=teachers&action=profile&id=${t}`);l(_e.data.teacher),R(_e.data.teacher)}catch(_e){console.error("Error fetching teacher:",_e),alert("Failed to load teacher data")}finally{o(!1)}},ae=async _e=>{_e.preventDefault();try{await F.put(`${Fo}?resource=teachers&id=${t}`,z),alert("Teacher updated successfully!"),A(!1),H()}catch(le){console.error("Error updating teacher:",le),alert("Failed to update teacher")}},k=async _e=>{_e.preventDefault();try{await F.post(`${Fo}?resource=leaves`,{...j,teacher_id:t}),alert("Leave application submitted!"),N(!1),T({leave_type:"annual",start_date:"",end_date:"",reason:""}),H()}catch(le){console.error("Error applying leave:",le),alert("Failed to submit leave application")}},B=async(_e,le,Pe="")=>{try{await F.post(`${Fo}?resource=leaves_action`,{leave_id:_e,action:le,approved_by:a?.id,rejection_reason:Pe}),alert(`Leave ${le}d successfully!`),H()}catch(we){console.error("Error processing leave:",we),alert(we.response?.data?.error||"Failed to process leave")}},w=["admin","principal","hr"].includes(a?.role),oe=async _e=>{_e.preventDefault();try{await F.post(`${Fo}?resource=notes`,{...Q,teacher_id:t,created_by:a?.id}),alert("Note added!"),y(!1),E({note_type:"general",title:"",content:"",is_confidential:!1}),H()}catch(le){console.error("Error adding note:",le),alert("Failed to add note")}},ne=async _e=>{_e.preventDefault();try{await F.post(`${Fo}?resource=evaluations`,{...te,teacher_id:t,evaluator_id:a?.id,academic_year:new Date().getFullYear().toString(),term:"Term 1",evaluation_date:new Date().toISOString().split("T")[0]}),alert("Evaluation saved!"),U(!1),C({}),H()}catch(le){console.error("Error saving evaluation:",le),alert("Failed to save evaluation")}},Fe=async _e=>{_e.preventDefault();try{await F.post(`${Fo}?resource=qualifications`,{...O,teacher_id:t}),alert("Qualification added!"),M(!1),V({qualification_type:"degree",title:"",institution:"",year_obtained:""}),H()}catch(le){console.error("Error adding qualification:",le),alert("Failed to add qualification")}},je=async _e=>{_e.preventDefault();try{await F.post(`${Fo}?resource=awards`,{...re,teacher_id:t}),alert("Award added!"),$(!1),ge({award_type:"excellence",title:"",award_date:"",description:""}),H()}catch(le){console.error("Error adding award:",le),alert("Failed to add award")}},Ge=async()=>{try{await F.post(`${Fo}?resource=id_card`,{teacher_id:parseInt(t),printed_by:a?.id}),alert("ID Card generated!"),H()}catch(_e){console.error("Error generating ID card:",_e),alert("Failed to generate ID card: "+(_e.response?.data?.error||_e.message))}},ze=()=>{if(!r?.id_card)return;const _e=r.profile_picture?`${ee.replace("/api","")}/uploads/profiles/${r.profile_picture}`:"",le=xe.school_logo||"",Pe=`https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=${encodeURIComponent(`TEACHER:${r.teacher_id}|${r.first_name} ${r.last_name}|${r.email}`)}`,we=window.open("","_blank");we.document.write(`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Teacher ID Card - ${r.first_name} ${r.last_name}</title>
        <style>
          @page { size: 85.6mm 53.98mm; margin: 0; }
          * { margin: 0; padding: 0; box-sizing: border-box; }
          body { font-family: Arial, sans-serif; }
          .print-container { 
            display: flex; 
            gap: 10mm; 
            padding: 5mm;
            justify-content: center;
          }
          .card {
            width: 85.6mm;
            height: 53.98mm;
            border: 1px solid #2563eb;
            border-radius: 3mm;
            overflow: hidden;
            background: white;
            page-break-inside: avoid;
          }
          .card-header {
            background: #2563eb;
            color: white;
            padding: 2mm;
            text-align: center;
          }
          .card-header-content {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 2mm;
          }
          .school-logo {
            width: 8mm;
            height: 8mm;
            object-fit: contain;
            background: white;
            border-radius: 50%;
            padding: 1mm;
          }
          .school-name { font-size: 9pt; font-weight: bold; }
          .card-subtitle { font-size: 7pt; opacity: 0.9; }
          .card-body { padding: 3mm; }
          .front-content { display: flex; gap: 3mm; }
          .photo {
            width: 20mm;
            height: 25mm;
            object-fit: cover;
            border-radius: 2mm;
            border: 0.5mm solid #ddd;
          }
          .photo-placeholder {
            width: 20mm;
            height: 25mm;
            background: #e5e7eb;
            border-radius: 2mm;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #9ca3af;
            font-size: 8pt;
          }
          .info { flex: 1; }
          .name { font-size: 10pt; font-weight: bold; margin-bottom: 1mm; }
          .role { font-size: 8pt; color: #666; margin-bottom: 2mm; }
          .card-number { 
            font-family: monospace; 
            font-size: 8pt; 
            background: #f3f4f6; 
            padding: 1mm 2mm; 
            border-radius: 1mm;
            display: inline-block;
            margin-bottom: 1mm;
          }
          .teacher-id { font-size: 7pt; color: #666; }
          .dates { 
            display: flex; 
            justify-content: space-between; 
            font-size: 7pt; 
            border-top: 0.3mm solid #e5e7eb; 
            padding-top: 2mm; 
            margin-top: 2mm;
          }
          .date-label { color: #666; }
          
          /* Back card styles */
          .back-header { 
            background: #2563eb; 
            color: white; 
            padding: 1.5mm; 
            text-align: center; 
            font-size: 7pt; 
            font-weight: bold;
          }
          .back-body { padding: 2mm; font-size: 7pt; }
          .back-section { margin-bottom: 2mm; }
          .back-label { font-weight: bold; color: #374151; margin-bottom: 0.5mm; }
          .back-value { color: #4b5563; }
          .qr-container { text-align: center; margin: 2mm 0; }
          .qr-code { width: 15mm; height: 15mm; }
          .terms { 
            font-size: 5pt; 
            color: #9ca3af; 
            text-align: center; 
            border-top: 0.3mm solid #e5e7eb; 
            padding-top: 1mm; 
            margin-top: 1mm;
          }
          
          @media print {
            body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .no-print { display: none; }
          }
        </style>
      </head>
      <body>
        <div class="no-print" style="text-align: center; padding: 10px; background: #f3f4f6;">
          <button onclick="window.print()" style="padding: 10px 20px; background: #2563eb; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 14px;">
            Print ID Card
          </button>
          <button onclick="window.close()" style="padding: 10px 20px; background: #6b7280; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 14px; margin-left: 10px;">
            Close
          </button>
        </div>
        
        <div class="print-container">
          <!-- Front Card -->
          <div class="card">
            <div class="card-header">
              <div class="card-header-content">
                ${le?`<img src="${le}" class="school-logo" alt="Logo">`:""}
                <div>
                  <div class="school-name">${xe.school_name||"SCHOOL NAME"}</div>
                  <div class="card-subtitle">STAFF ID CARD</div>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div class="front-content">
                ${_e?`<img src="${_e}" class="photo" alt="Photo">`:'<div class="photo-placeholder">No Photo</div>'}
                <div class="info">
                  <div class="name">${r.first_name} ${r.last_name}</div>
                  <div class="role">${r.specialization||"Teacher"}</div>
                  <div class="card-number">${r.id_card.card_number}</div>
                  <div class="teacher-id">ID: ${r.teacher_id}</div>
                </div>
              </div>
              <div class="dates">
                <div><span class="date-label">Issue:</span> ${new Date(r.id_card.issue_date).toLocaleDateString()}</div>
                <div><span class="date-label">Expiry:</span> ${new Date(r.id_card.expiry_date).toLocaleDateString()}</div>
              </div>
            </div>
          </div>
          
          <!-- Back Card -->
          <div class="card">
            <div class="back-header">IMPORTANT INFORMATION</div>
            <div class="back-body">
              <div class="back-section">
                <div class="back-label">Emergency Contact:</div>
                <div class="back-value">${r.emergency_contact_name?`${r.emergency_contact_name} - ${r.emergency_contact_phone}`:"Not provided"}</div>
              </div>
              <div class="back-section">
                <div class="back-label">School Contact:</div>
                <div class="back-value">${xe.school_phone||"N/A"}</div>
                <div class="back-value">${xe.school_email||"N/A"}</div>
              </div>
              <div class="back-section">
                <div class="back-label">School Address:</div>
                <div class="back-value">${xe.school_address||"N/A"}</div>
              </div>
              <div class="qr-container">
                <img src="${Pe}" class="qr-code" alt="QR Code">
              </div>
              <div class="terms">
                This card is property of ${xe.school_name||"the school"}. If found, please return to the address above.
              </div>
            </div>
          </div>
        </div>
      </body>
      </html>
    `),we.document.close()},Xe=async _e=>{const le=_e.target.files[0];if(le){if(!le.type.startsWith("image/")){alert("Please select an image file");return}if(le.size>5*1024*1024){alert("File size must be less than 5MB");return}se(!0);try{const Pe=new FormData;Pe.append("profile_picture",le),Pe.append("type","teacher"),Pe.append("id",t),await F.post(`${ee}/upload_profile_picture.php`,Pe,{headers:{"Content-Type":"multipart/form-data"}}),alert("Photo uploaded successfully!"),H()}catch(Pe){console.error("Error uploading photo:",Pe),alert("Failed to upload photo")}finally{se(!1)}}},st=_e=>{if(!_e)return"N/A";const le=new Date,Pe=new Date(_e);let we=le.getFullYear()-Pe.getFullYear();const fe=le.getMonth()-Pe.getMonth();return(fe<0||fe===0&&le.getDate()<Pe.getDate())&&we--,we};if(c)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(!r)return e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-500",children:"Teacher not found"}),e.jsx("button",{onClick:()=>s("/admin/teachers"),className:"btn btn-primary mt-4",children:"Back to Teachers"})]});const ce=[{id:"overview",label:"Overview",icon:ha},{id:"schedule",label:"Schedule",icon:Ot},{id:"leaves",label:"Leaves",icon:Wt},{id:"evaluations",label:"Performance",icon:$s},{id:"qualifications",label:"Qualifications",icon:Qs},{id:"awards",label:"Awards",icon:Is},{id:"documents",label:"Documents",icon:Kt},{id:"notes",label:"Notes",icon:P1},{id:"timeline",label:"Timeline",icon:Sa},{id:"id_card",label:"ID Card",icon:aa}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>s("/admin/teachers"),className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(ol,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[r.first_name," ",r.last_name]}),e.jsxs("p",{className:"text-gray-600",children:[r.teacher_id,"  ",r.specialization||"Teacher"]})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("button",{onClick:()=>A(!0),className:"btn bg-blue-600 text-white hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(Na,{size:16})," Edit Profile"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative inline-block",children:[r.profile_picture?e.jsx("img",{src:`${ee.replace("/api","")}/uploads/profiles/${r.profile_picture}`,alt:r.first_name,className:"w-32 h-32 rounded-full mx-auto mb-2 object-cover border-4 border-blue-100"}):e.jsx("div",{className:"w-32 h-32 rounded-full mx-auto mb-2 bg-blue-100 flex items-center justify-center border-4 border-blue-200",children:e.jsx(ha,{className:"w-16 h-16 text-blue-600"})}),e.jsxs("label",{className:"absolute bottom-2 right-0 bg-blue-600 text-white p-2 rounded-full cursor-pointer hover:bg-blue-700 shadow-lg",children:[e.jsx(Hr,{className:"w-4 h-4"}),e.jsx("input",{type:"file",accept:"image/*",onChange:Xe,className:"hidden",disabled:P})]})]}),P&&e.jsx("p",{className:"text-xs text-blue-600 mb-2",children:"Uploading..."}),e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:[r.first_name," ",r.last_name]}),e.jsx("p",{className:"text-gray-600 font-mono",children:r.teacher_id}),e.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-sm font-medium mt-2 ${r.status==="active"?"bg-green-100 text-green-700":r.status==="on-leave"?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-700"}`,children:r.status})]}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[e.jsx(ra,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:r.email})]}),r.phone&&e.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[e.jsx(er,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:r.phone})]}),r.address&&e.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[e.jsx(Qn,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:r.address})]}),e.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[e.jsx(Pr,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm capitalize",children:r.employment_type})]}),r.hire_date&&e.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[e.jsx(Ot,{className:"w-4 h-4"}),e.jsxs("span",{className:"text-sm",children:["Joined: ",new Date(r.hire_date).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t space-y-2",children:[e.jsx("button",{onClick:()=>N(!0),className:"w-full btn bg-orange-100 text-orange-700 hover:bg-orange-200 text-sm",children:"Apply for Leave"}),e.jsx("button",{onClick:()=>U(!0),className:"w-full btn bg-purple-100 text-purple-700 hover:bg-purple-200 text-sm",children:"Add Evaluation"})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx(as,{className:"w-6 h-6 text-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"text-2xl font-bold",children:r.subjects?.length||0}),e.jsx("p",{className:"text-xs text-gray-500",children:"Subjects"})]}),e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx(Wt,{className:"w-6 h-6 text-orange-600 mx-auto mb-2"}),e.jsx("p",{className:"text-2xl font-bold",children:r.workload?.periods||0}),e.jsx("p",{className:"text-xs text-gray-500",children:"Periods/Week"})]}),e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx(Is,{className:"w-6 h-6 text-yellow-600 mx-auto mb-2"}),e.jsx("p",{className:"text-2xl font-bold",children:r.awards?.length||0}),e.jsx("p",{className:"text-xs text-gray-500",children:"Awards"})]}),e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx(sl,{className:"w-6 h-6 text-purple-600 mx-auto mb-2"}),e.jsx("p",{className:"text-2xl font-bold",children:r.evaluations?.[0]?.overall_rating||"-"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Rating"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"border-b",children:e.jsx("div",{className:"flex flex-wrap",children:ce.map(_e=>e.jsxs("button",{onClick:()=>u(_e.id),className:`px-3 py-2 text-sm font-medium flex items-center gap-1.5 border-b-2 transition-colors ${m===_e.id?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(_e.icon,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:_e.label})]},_e.id))})}),e.jsxs("div",{className:"p-6",children:[m==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Personal Information"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Date of Birth:"})," ",r.date_of_birth||"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Age:"})," ",st(r.date_of_birth)," years"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Gender:"})," ",e.jsx("span",{className:"capitalize",children:r.gender})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"National ID:"})," ",r.national_id||"N/A"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Employment Details"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Qualification:"})," ",r.qualification||"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Specialization:"})," ",r.specialization||"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Assigned Class:"})," ",r.assigned_class||"None"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Hire Date:"})," ",r.hire_date||"N/A"]})]})]})]}),r.bio&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Bio"}),e.jsx("p",{className:"text-sm text-gray-600",children:r.bio})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Emergency Contact"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Name:"})," ",r.emergency_contact_name||"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Phone:"})," ",r.emergency_contact_phone||"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Relationship:"})," ",r.emergency_contact_relationship||"N/A"]})]})]}),r.subjects?.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Assigned Subjects"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.subjects.map((_e,le)=>e.jsxs("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm",children:[_e.subject_name," (",_e.class_name,")"]},le))})]})]}),m==="schedule"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Weekly Schedule"}),r.schedule?.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left",children:"Day"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Period"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Time"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Subject"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Class"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Room"})]})}),e.jsx("tbody",{className:"divide-y",children:r.schedule.map((_e,le)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 capitalize",children:_e.day_of_week}),e.jsx("td",{className:"px-4 py-2",children:_e.period_number}),e.jsxs("td",{className:"px-4 py-2",children:[_e.start_time," - ",_e.end_time]}),e.jsx("td",{className:"px-4 py-2",children:_e.subject_name||"-"}),e.jsx("td",{className:"px-4 py-2",children:_e.class_name||"-"}),e.jsx("td",{className:"px-4 py-2",children:_e.room||"-"})]},le))})]})}):r.subjects?.length>0?e.jsxs("div",{children:[e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:e.jsxs("p",{className:"text-yellow-700 text-sm",children:[e.jsx("strong",{children:"Note:"})," Detailed weekly schedule not yet configured. Showing assigned subjects/classes below."]})}),e.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Assigned Subjects & Classes"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:r.subjects.map((_e,le)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(as,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:_e.subject_name}),e.jsx("p",{className:"text-sm text-gray-500",children:_e.class_name})]})]},le))})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ot,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No schedule or subject assignments yet"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Assign subjects to this teacher in Class Subjects management"})]})]}),m==="leaves"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Leave History"}),e.jsxs("button",{onClick:()=>N(!0),className:"btn btn-primary btn-sm flex items-center gap-1",children:[e.jsx(qt,{size:14})," Apply Leave"]})]}),r.leave_balance&&e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Annual Leave"}),e.jsxs("p",{className:"text-lg font-bold text-green-700",children:[r.leave_balance.annual_leave_total-r.leave_balance.annual_leave_used," / ",r.leave_balance.annual_leave_total]})]}),e.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Sick Leave"}),e.jsxs("p",{className:"text-lg font-bold text-orange-700",children:[r.leave_balance.sick_leave_total-r.leave_balance.sick_leave_used," / ",r.leave_balance.sick_leave_total]})]}),e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Study Leave"}),e.jsxs("p",{className:"text-lg font-bold text-blue-700",children:[r.leave_balance.study_leave_total-r.leave_balance.study_leave_used," / ",r.leave_balance.study_leave_total]})]})]}),r.leaves?.length>0?e.jsx("div",{className:"space-y-3",children:r.leaves.map((_e,le)=>e.jsx("div",{className:"border rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium capitalize",children:[_e.leave_type," Leave"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[_e.start_date," to ",_e.end_date," (",_e.days_count," days)"]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:_e.reason})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${_e.status==="approved"?"bg-green-100 text-green-700":_e.status==="pending"?"bg-orange-100 text-orange-700":"bg-red-100 text-red-700"}`,children:_e.status}),_e.status==="pending"&&w&&e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>B(_e.id,"approve"),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Approve",children:e.jsx(Mt,{size:16})}),e.jsx("button",{onClick:()=>B(_e.id,"reject","Rejected by admin"),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Reject",children:e.jsx(Js,{size:16})})]})]})]})},le))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No leave records"})]}),m==="evaluations"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Performance Evaluations"}),e.jsxs("button",{onClick:()=>U(!0),className:"btn btn-primary btn-sm flex items-center gap-1",children:[e.jsx(qt,{size:14})," Add Evaluation"]})]}),r.evaluations?.length>0?e.jsx("div",{className:"space-y-4",children:r.evaluations.map((_e,le)=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[_e.term," ",_e.academic_year]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Evaluated on ",_e.evaluation_date]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[_e.overall_rating,"/5"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Overall Rating"})]})]}),e.jsx("div",{className:"grid grid-cols-4 gap-2 text-sm",children:["teaching_quality","classroom_management","punctuality","professionalism"].map(Pe=>e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-500 text-xs capitalize",children:Pe.replace("_"," ")}),e.jsxs("p",{className:"font-semibold",children:[_e[Pe]||"-","/5"]})]},Pe))}),_e.comments&&e.jsx("p",{className:"text-sm text-gray-600 mt-3 border-t pt-3",children:_e.comments})]},le))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No evaluations yet"})]}),m==="qualifications"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Qualifications & Certifications"}),e.jsxs("button",{onClick:()=>M(!0),className:"btn btn-primary btn-sm flex items-center gap-1",children:[e.jsx(qt,{size:14})," Add Qualification"]})]}),r.qualifications?.length>0?e.jsx("div",{className:"space-y-3",children:r.qualifications.map((_e,le)=>e.jsxs("div",{className:"border rounded-lg p-4 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:_e.title}),e.jsxs("p",{className:"text-sm text-gray-600",children:[_e.institution,"  ",_e.year_obtained]}),e.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 rounded capitalize",children:_e.qualification_type})]}),_e.is_verified&&e.jsx(Mt,{className:"text-green-600",size:20})]},le))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No qualifications added"})]}),m==="awards"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Awards & Recognition"}),e.jsxs("button",{onClick:()=>$(!0),className:"btn btn-primary btn-sm flex items-center gap-1",children:[e.jsx(qt,{size:14})," Add Award"]})]}),r.awards?.length>0?e.jsx("div",{className:"grid grid-cols-2 gap-4",children:r.awards.map((_e,le)=>e.jsx("div",{className:"border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Is,{className:"text-yellow-500 flex-shrink-0",size:24}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:_e.title}),e.jsx("p",{className:"text-sm text-gray-600",children:_e.awarded_by}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(_e.award_date).toLocaleDateString()}),_e.description&&e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:_e.description})]})]})},le))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No awards yet"})]}),m==="documents"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Documents"}),r.documents?.length>0?e.jsx("div",{className:"space-y-2",children:r.documents.map((_e,le)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Kt,{className:"text-gray-400",size:20}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:_e.document_name}),e.jsx("p",{className:"text-xs text-gray-500 capitalize",children:_e.document_type})]})]}),e.jsx("a",{href:_e.file_path,target:"_blank",className:"text-blue-600 text-sm hover:underline",children:"View"})]},le))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No documents uploaded"})]}),m==="notes"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Admin Notes"}),e.jsxs("button",{onClick:()=>y(!0),className:"btn btn-primary btn-sm flex items-center gap-1",children:[e.jsx(qt,{size:14})," Add Note"]})]}),r.notes?.length>0?e.jsx("div",{className:"space-y-3",children:r.notes.map((_e,le)=>e.jsxs("div",{className:`border rounded-lg p-4 ${_e.is_confidential?"border-red-200 bg-red-50":""}`,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:_e.title}),e.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 rounded capitalize",children:_e.note_type})]}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(_e.created_at).toLocaleDateString()})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:_e.content})]},le))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No notes yet"})]}),m==="timeline"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Activity Timeline"}),r.timeline?.length>0?e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-4 top-0 bottom-0 w-0.5 bg-gray-200"}),e.jsx("div",{className:"space-y-4",children:r.timeline.map((_e,le)=>e.jsxs("div",{className:"flex gap-4 relative",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center z-10 ${_e.event_type==="hired"?"bg-green-500":_e.event_type==="award"?"bg-yellow-500":_e.event_type==="evaluation"?"bg-purple-500":_e.event_type==="leave"?"bg-orange-500":"bg-blue-500"}`,children:e.jsx(Sa,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 pb-4",children:[e.jsx("p",{className:"font-medium",children:_e.title}),e.jsx("p",{className:"text-sm text-gray-600",children:_e.description}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:new Date(_e.event_date).toLocaleDateString()})]})]},le))})]}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No timeline events"})]}),m==="id_card"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Teacher ID Card"}),e.jsxs("div",{className:"flex gap-2",children:[r.id_card&&e.jsxs("button",{onClick:ze,className:"btn bg-green-600 text-white hover:bg-green-700 flex items-center gap-2",children:[e.jsx(or,{size:16})," Print ID Card"]}),e.jsxs("button",{onClick:Ge,className:"btn btn-primary flex items-center gap-2",children:[e.jsx(aa,{size:16})," ",r.id_card?"Regenerate":"Generate"," ID Card"]})]})]}),r.id_card?e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 justify-center",children:[e.jsxs("div",{className:"w-full max-w-sm",children:[e.jsx("p",{className:"text-sm text-gray-500 text-center mb-2",children:"Front"}),e.jsxs("div",{className:"border-2 border-blue-600 rounded-xl overflow-hidden shadow-lg",children:[e.jsx("div",{className:"bg-blue-600 text-white p-3 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[xe.school_logo&&e.jsx("img",{src:xe.school_logo,alt:"Logo",className:"w-10 h-10 object-contain bg-white rounded-full p-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-sm",children:xe.school_name||"SCHOOL NAME"}),e.jsx("p",{className:"text-xs text-blue-100",children:"STAFF ID CARD"})]})]})}),e.jsxs("div",{className:"p-4 bg-white",children:[e.jsxs("div",{className:"flex gap-3",children:[r.profile_picture?e.jsx("img",{src:`${ee.replace("/api","")}/uploads/profiles/${r.profile_picture}`,alt:r.first_name,className:"w-20 h-24 rounded-lg object-cover border"}):e.jsx("div",{className:"w-20 h-24 bg-gray-200 rounded-lg flex items-center justify-center border",children:e.jsx(ha,{className:"text-gray-400",size:32})}),e.jsxs("div",{className:"flex-1 text-sm",children:[e.jsxs("p",{className:"font-bold",children:[r.first_name," ",r.last_name]}),e.jsx("p",{className:"text-gray-600 text-xs",children:r.specialization||"Teacher"}),e.jsx("p",{className:"font-mono text-xs mt-2 bg-gray-100 px-2 py-1 rounded",children:r.id_card.card_number}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["ID: ",r.teacher_id]})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Issue:"})," ",new Date(r.id_card.issue_date).toLocaleDateString()]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Expiry:"})," ",new Date(r.id_card.expiry_date).toLocaleDateString()]})]})]})]})]}),e.jsxs("div",{className:"w-full max-w-sm",children:[e.jsx("p",{className:"text-sm text-gray-500 text-center mb-2",children:"Back"}),e.jsxs("div",{className:"border-2 border-blue-600 rounded-xl overflow-hidden shadow-lg h-[calc(100%-1.5rem)]",children:[e.jsx("div",{className:"bg-blue-600 text-white p-2 text-center",children:e.jsx("p",{className:"text-xs font-medium",children:"IMPORTANT INFORMATION"})}),e.jsx("div",{className:"p-4 bg-white h-full",children:e.jsxs("div",{className:"space-y-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-700 mb-1",children:"Emergency Contact:"}),r.emergency_contact_name?e.jsxs("p",{className:"text-gray-600",children:[r.emergency_contact_name," - ",r.emergency_contact_phone]}):e.jsx("p",{className:"text-gray-400 italic",children:"Not provided"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-700 mb-1",children:"School Contact:"}),e.jsx("p",{className:"text-gray-600",children:xe.school_phone||"N/A"}),e.jsx("p",{className:"text-gray-600",children:xe.school_email||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-700 mb-1",children:"School Address:"}),e.jsx("p",{className:"text-gray-600",children:xe.school_address||"N/A"})]}),e.jsx("div",{className:"flex justify-center pt-2",children:e.jsx("img",{src:`https://api.qrserver.com/v1/create-qr-code/?size=80x80&data=${encodeURIComponent(`TEACHER:${r.teacher_id}|${r.first_name} ${r.last_name}|${r.email}`)}`,alt:"QR Code",className:"w-16 h-16"})}),e.jsxs("p",{className:"text-[10px] text-gray-400 text-center pt-2 border-t",children:["This card is property of ",xe.school_name||"the school",". If found, please return to the address above."]})]})})]})]})]}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No ID card generated yet"})]})]})]})]})]}),g&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",children:[e.jsxs("div",{className:"p-6 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Apply for Leave"}),e.jsx("button",{onClick:()=>N(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:k,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Leave Type"}),e.jsxs("select",{value:j.leave_type,onChange:_e=>T({...j,leave_type:_e.target.value}),className:"input",children:[e.jsx("option",{value:"annual",children:"Annual Leave"}),e.jsx("option",{value:"sick",children:"Sick Leave"}),e.jsx("option",{value:"maternity",children:"Maternity Leave"}),e.jsx("option",{value:"paternity",children:"Paternity Leave"}),e.jsx("option",{value:"study",children:"Study Leave"}),e.jsx("option",{value:"emergency",children:"Emergency Leave"}),e.jsx("option",{value:"unpaid",children:"Unpaid Leave"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:j.start_date,onChange:_e=>T({...j,start_date:_e.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:j.end_date,onChange:_e=>T({...j,end_date:_e.target.value}),className:"input",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Reason"}),e.jsx("textarea",{value:j.reason,onChange:_e=>T({...j,reason:_e.target.value}),className:"input",rows:"3",required:!0})]}),e.jsx("button",{type:"submit",className:"btn btn-primary w-full",children:"Submit Application"})]})]})}),f&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",children:[e.jsxs("div",{className:"p-6 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Add Note"}),e.jsx("button",{onClick:()=>y(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:oe,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Note Type"}),e.jsxs("select",{value:Q.note_type,onChange:_e=>E({...Q,note_type:_e.target.value}),className:"input",children:[e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"performance",children:"Performance"}),e.jsx("option",{value:"disciplinary",children:"Disciplinary"}),e.jsx("option",{value:"commendation",children:"Commendation"}),e.jsx("option",{value:"meeting",children:"Meeting"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Title"}),e.jsx("input",{type:"text",value:Q.title,onChange:_e=>E({...Q,title:_e.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Content"}),e.jsx("textarea",{value:Q.content,onChange:_e=>E({...Q,content:_e.target.value}),className:"input",rows:"4",required:!0})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:Q.is_confidential,onChange:_e=>E({...Q,is_confidential:_e.target.checked})}),e.jsx("span",{className:"text-sm",children:"Mark as confidential"})]}),e.jsx("button",{type:"submit",className:"btn btn-primary w-full",children:"Add Note"})]})]})}),v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex justify-between items-center sticky top-0 bg-white",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Performance Evaluation"}),e.jsx("button",{onClick:()=>U(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:ne,className:"p-6 space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Rate each area from 1 (Poor) to 5 (Excellent)"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:["teaching_quality","classroom_management","student_engagement","lesson_planning","punctuality","professionalism","communication","teamwork"].map(_e=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 capitalize",children:_e.replace("_"," ")}),e.jsxs("select",{value:te[_e]||"",onChange:le=>C({...te,[_e]:le.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select"}),[1,2,3,4,5].map(le=>e.jsx("option",{value:le,children:le},le))]})]},_e))}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Strengths"}),e.jsx("textarea",{value:te.strengths||"",onChange:_e=>C({...te,strengths:_e.target.value}),className:"input",rows:"2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Areas for Improvement"}),e.jsx("textarea",{value:te.areas_for_improvement||"",onChange:_e=>C({...te,areas_for_improvement:_e.target.value}),className:"input",rows:"2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Comments"}),e.jsx("textarea",{value:te.comments||"",onChange:_e=>C({...te,comments:_e.target.value}),className:"input",rows:"3"})]}),e.jsx("button",{type:"submit",className:"btn btn-primary w-full",children:"Save Evaluation"})]})]})}),D&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",children:[e.jsxs("div",{className:"p-6 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Add Qualification"}),e.jsx("button",{onClick:()=>M(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:Fe,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Type"}),e.jsxs("select",{value:O.qualification_type,onChange:_e=>V({...O,qualification_type:_e.target.value}),className:"input",children:[e.jsx("option",{value:"degree",children:"Degree"}),e.jsx("option",{value:"diploma",children:"Diploma"}),e.jsx("option",{value:"certificate",children:"Certificate"}),e.jsx("option",{value:"license",children:"License"}),e.jsx("option",{value:"training",children:"Training"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Title"}),e.jsx("input",{type:"text",value:O.title,onChange:_e=>V({...O,title:_e.target.value}),className:"input",placeholder:"e.g., Bachelor of Education",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Institution"}),e.jsx("input",{type:"text",value:O.institution,onChange:_e=>V({...O,institution:_e.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Year Obtained"}),e.jsx("input",{type:"number",value:O.year_obtained,onChange:_e=>V({...O,year_obtained:_e.target.value}),className:"input",min:"1950",max:"2030",required:!0})]}),e.jsx("button",{type:"submit",className:"btn btn-primary w-full",children:"Add Qualification"})]})]})}),K&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",children:[e.jsxs("div",{className:"p-6 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Add Award"}),e.jsx("button",{onClick:()=>$(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:je,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Award Type"}),e.jsxs("select",{value:re.award_type,onChange:_e=>ge({...re,award_type:_e.target.value}),className:"input",children:[e.jsx("option",{value:"excellence",children:"Excellence"}),e.jsx("option",{value:"innovation",children:"Innovation"}),e.jsx("option",{value:"service",children:"Service"}),e.jsx("option",{value:"leadership",children:"Leadership"}),e.jsx("option",{value:"performance",children:"Performance"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Title"}),e.jsx("input",{type:"text",value:re.title,onChange:_e=>ge({...re,title:_e.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Awarded By"}),e.jsx("input",{type:"text",value:re.awarded_by||"",onChange:_e=>ge({...re,awarded_by:_e.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Date"}),e.jsx("input",{type:"date",value:re.award_date,onChange:_e=>ge({...re,award_date:_e.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description"}),e.jsx("textarea",{value:re.description,onChange:_e=>ge({...re,description:_e.target.value}),className:"input",rows:"2"})]}),e.jsx("button",{type:"submit",className:"btn btn-primary w-full",children:"Add Award"})]})]})}),x&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex justify-between items-center sticky top-0 bg-white",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Edit Teacher Profile"}),e.jsx("button",{onClick:()=>A(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:ae,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"First Name *"}),e.jsx("input",{type:"text",value:z.first_name||"",onChange:_e=>R({...z,first_name:_e.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Last Name *"}),e.jsx("input",{type:"text",value:z.last_name||"",onChange:_e=>R({...z,last_name:_e.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Email *"}),e.jsx("input",{type:"email",value:z.email||"",onChange:_e=>R({...z,email:_e.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Phone"}),e.jsx("input",{type:"tel",value:z.phone||"",onChange:_e=>R({...z,phone:_e.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Date of Birth"}),e.jsx("input",{type:"date",value:z.date_of_birth||"",onChange:_e=>R({...z,date_of_birth:_e.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Gender"}),e.jsxs("select",{value:z.gender||"male",onChange:_e=>R({...z,gender:_e.target.value}),className:"input",children:[e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Address"}),e.jsx("textarea",{value:z.address||"",onChange:_e=>R({...z,address:_e.target.value}),className:"input",rows:"2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Qualification"}),e.jsx("input",{type:"text",value:z.qualification||"",onChange:_e=>R({...z,qualification:_e.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Specialization"}),e.jsx("input",{type:"text",value:z.specialization||"",onChange:_e=>R({...z,specialization:_e.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Employment Type"}),e.jsxs("select",{value:z.employment_type||"full-time",onChange:_e=>R({...z,employment_type:_e.target.value}),className:"input",children:[e.jsx("option",{value:"full-time",children:"Full-Time"}),e.jsx("option",{value:"part-time",children:"Part-Time"}),e.jsx("option",{value:"contract",children:"Contract"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Status"}),e.jsxs("select",{value:z.status||"active",onChange:_e=>R({...z,status:_e.target.value}),className:"input",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"on-leave",children:"On Leave"})]})]})]}),e.jsx("h3",{className:"text-lg font-semibold pt-4 border-t",children:"Emergency Contact"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Contact Name"}),e.jsx("input",{type:"text",value:z.emergency_contact_name||"",onChange:_e=>R({...z,emergency_contact_name:_e.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Contact Phone"}),e.jsx("input",{type:"tel",value:z.emergency_contact_phone||"",onChange:_e=>R({...z,emergency_contact_phone:_e.target.value}),className:"input"})]})]}),e.jsxs("div",{className:"flex gap-4 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>A(!1),className:"btn bg-gray-200 text-gray-700 hover:bg-gray-300 flex-1",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary flex-1",children:"Save Changes"})]})]})]})})]})}function S7(){const[t,s]=h.useState(null),[a,r]=h.useState(!0),l=la(),[c,o]=h.useState("overview"),[m,u]=h.useState("month"),[x,A]=h.useState(""),[g,N]=h.useState(""),[f,y]=h.useState(""),[v,U]=h.useState([]),[D,M]=h.useState([]),[K,$]=h.useState([]),[P,se]=h.useState([]),[z,R]=h.useState([]),[j,T]=h.useState([]),[Q,E]=h.useState([]),[te,C]=h.useState([]),[O,V]=h.useState([]),[re,ge]=h.useState({}),[xe,Z]=h.useState(0),[I,H]=h.useState(!1),[ae,k]=h.useState(null);h.useEffect(()=>{B(),w()},[m,f]);const B=async()=>{try{r(!0);const pe=await jr.getDashboardStats();s(pe.data.stats)}catch(pe){console.error("Error fetching stats:",pe)}finally{r(!1)}},w=async()=>{try{const[pe,Me]=await Promise.all([yl.getAll(),Bi.getAll()]);U(pe.data.terms||[]),M(Me.data.classes||[]);const Se=(pe.data.terms||[]).find(et=>et.is_active==1);Se&&!f&&y(Se.id),await Promise.all([oe(),ne(),Fe(),je(),Ge(),ze(),Xe(),st(),ce()]);const Ne=localStorage.getItem("collection_target");Ne&&Z(parseFloat(Ne))}catch(pe){console.error("Error fetching additional data:",pe)}},oe=async()=>{try{const pe=await F.get(`${ee}/finance.php?action=recent_payments&limit=5`);$(pe.data.payments||[])}catch(pe){console.error("Error fetching recent payments:",pe)}},ne=async()=>{try{const pe=await F.get(`${ee}/finance.php?action=recent_invoices&limit=5`);se(pe.data.invoices||[])}catch(pe){console.error("Error fetching recent invoices:",pe)}},Fe=async()=>{try{const pe=await F.get(`${ee}/finance.php?action=class_wise&term_id=${f}`);R(pe.data.data||[])}catch(pe){console.error("Error fetching class-wise data:",pe)}},je=async()=>{try{const pe=await F.get(`${ee}/finance.php?action=fee_types&term_id=${f}`);T(pe.data.data||[])}catch(pe){console.error("Error fetching fee type data:",pe)}},Ge=async()=>{try{const pe=await F.get(`${ee}/finance.php?action=monthly_trend`);E(pe.data.trend||[])}catch(pe){console.error("Error fetching monthly trend:",pe)}},ze=async()=>{try{const pe=await F.get(`${ee}/finance.php?action=overdue&limit=10`);C(pe.data.overdue||[])}catch(pe){console.error("Error fetching overdue list:",pe)}},Xe=async()=>{try{const pe=await F.get(`${ee}/finance.php?action=top_debtors&limit=10`);V(pe.data.debtors||[])}catch(pe){console.error("Error fetching top debtors:",pe)}},st=async()=>{try{const pe=await F.get(`${ee}/finance.php?action=payment_methods&term_id=${f}`);ge(pe.data.methods||{})}catch(pe){console.error("Error fetching payment methods:",pe)}},ce=async()=>{try{const pe=await F.get(`${ee}/finance.php?action=comparison`);k(pe.data.comparison||null)}catch(pe){console.error("Error fetching comparison:",pe)}},_e=pe=>new Intl.NumberFormat("en-GH",{style:"currency",currency:"GHS"}).format(pe||0),le=[{title:"Total Revenue",value:_e(t?.total_revenue),icon:vs,color:"bg-blue-500",description:"Total invoiced amount"},{title:"Total Collected",value:_e(t?.total_collected),icon:$s,color:"bg-green-500",description:"Payments received"},{title:"Outstanding",value:_e(t?.total_outstanding),icon:Wt,color:"bg-orange-500",description:"Pending payments"},{title:"Pending Invoices",value:t?.pending_invoices||0,icon:Kt,color:"bg-purple-500",description:"Awaiting approval"},{title:"Approved Invoices",value:t?.approved_invoices||0,icon:Mt,color:"bg-teal-500",description:"Ready for payment"},{title:"Paid Invoices",value:t?.paid_invoices||0,icon:Mt,color:"bg-green-600",description:"Fully paid"},{title:"Today's Payments",value:t?.today_payments||0,icon:aa,color:"bg-indigo-500",description:"Payments today"},{title:"Today's Amount",value:_e(t?.today_amount),icon:vs,color:"bg-pink-500",description:"Collected today"}],Pe=[{title:"Fee Structure",description:"Manage fee groups, items, and rules",icon:Kt,color:"bg-blue-500",path:"/admin/fee-structure"},{title:"Invoices",description:"Review and approve invoices",icon:Kt,color:"bg-purple-500",path:"/admin/invoices"},{title:"Payments",description:"Record and track payments",icon:aa,color:"bg-green-500",path:"/admin/payments"}],we=[{id:"overview",label:"Overview",icon:Fs},{id:"analytics",label:"Analytics",icon:Gl},{id:"reports",label:"Reports",icon:Kt}],fe=()=>{const pe={generated:new Date().toISOString(),stats:t,classWiseData:z,feeTypeData:j,monthlyTrend:Q,overdueList:te,topDebtors:O},Me=new Blob([JSON.stringify(pe,null,2)],{type:"application/json"}),Se=URL.createObjectURL(Me),Ne=document.createElement("a");Ne.href=Se,Ne.download=`finance_report_${new Date().toISOString().split("T")[0]}.json`,Ne.click()},ye=()=>{const Me=[["Finance Report",new Date().toLocaleDateString()],[],["Summary"],["Total Revenue",t?.total_revenue||0],["Total Collected",t?.total_collected||0],["Outstanding",t?.total_outstanding||0],["Collection Rate",t?.total_revenue>0?(t?.total_collected/t?.total_revenue*100).toFixed(1)+"%":"0%"],[],["Class-wise Collection"],["Class","Total Fees","Collected","Outstanding","Rate"],...z.map(Ce=>[Ce.class_name,Ce.total_fees,Ce.collected,Ce.outstanding,Ce.rate+"%"]),[],["Top Debtors"],["Student","Class","Outstanding"],...O.map(Ce=>[Ce.student_name,Ce.class_name,Ce.outstanding])].map(Ce=>Ce.join(",")).join(`
`),Se=new Blob([Me],{type:"text/csv"}),Ne=URL.createObjectURL(Se),et=document.createElement("a");et.href=Ne,et.download=`finance_report_${new Date().toISOString().split("T")[0]}.csv`,et.click()},Ke=()=>{const pe=window.open("","_blank");pe.document.write(`
      <html><head><title>Finance Report</title>
      <style>
        body { font-family: Arial; padding: 30px; }
        h1 { color: #1f2937; border-bottom: 2px solid #2563eb; padding-bottom: 10px; }
        .stats { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin: 20px 0; }
        .stat-card { background: #f3f4f6; padding: 15px; border-radius: 8px; text-align: center; }
        .stat-value { font-size: 24px; font-weight: bold; color: #1f2937; }
        .stat-label { font-size: 12px; color: #6b7280; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        th { background: #2563eb; color: white; }
        .section { margin-top: 30px; }
      </style></head><body>
      <h1>Finance Report</h1>
      <p>Generated: ${new Date().toLocaleString()}</p>
      
      <div class="stats">
        <div class="stat-card"><div class="stat-value">${_e(t?.total_revenue)}</div><div class="stat-label">Total Revenue</div></div>
        <div class="stat-card"><div class="stat-value">${_e(t?.total_collected)}</div><div class="stat-label">Collected</div></div>
        <div class="stat-card"><div class="stat-value">${_e(t?.total_outstanding)}</div><div class="stat-label">Outstanding</div></div>
        <div class="stat-card"><div class="stat-value">${t?.total_revenue>0?(t?.total_collected/t?.total_revenue*100).toFixed(1):0}%</div><div class="stat-label">Collection Rate</div></div>
      </div>
      
      <div class="section">
        <h3>Class-wise Collection</h3>
        <table>
          <thead><tr><th>Class</th><th>Total Fees</th><th>Collected</th><th>Outstanding</th><th>Rate</th></tr></thead>
          <tbody>${z.map(Me=>`<tr><td>${Me.class_name}</td><td>${_e(Me.total_fees)}</td><td>${_e(Me.collected)}</td><td>${_e(Me.outstanding)}</td><td>${Me.rate}%</td></tr>`).join("")}</tbody>
        </table>
      </div>
      
      <div class="section">
        <h3>Top Debtors</h3>
        <table>
          <thead><tr><th>Student</th><th>Class</th><th>Outstanding</th></tr></thead>
          <tbody>${O.map(Me=>`<tr><td>${Me.student_name}</td><td>${Me.class_name}</td><td>${_e(Me.outstanding)}</td></tr>`).join("")}</tbody>
        </table>
      </div>
      </body></html>
    `),pe.document.close(),pe.print()},ve=()=>{localStorage.setItem("collection_target",xe.toString()),H(!1),alert("Collection target saved!")},ie=()=>!xe||xe===0?0:Math.min((t?.total_collected||0)/xe*100,100),q=Math.max(...Q.map(pe=>parseFloat(pe.collected)||0),1);return a?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading finance dashboard..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Finance Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive financial overview and analytics"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>H(!0),className:"btn bg-purple-600 text-white hover:bg-purple-700 flex items-center gap-2",children:[e.jsx(Ln,{className:"w-4 h-4"})," Set Target"]}),e.jsxs("button",{onClick:ye,className:"btn bg-green-600 text-white hover:bg-green-700 flex items-center gap-2",children:[e.jsx(xs,{className:"w-4 h-4"})," Export"]}),e.jsxs("button",{onClick:Ke,className:"btn bg-gray-600 text-white hover:bg-gray-700 flex items-center gap-2",children:[e.jsx(or,{className:"w-4 h-4"})," Print"]}),e.jsxs("button",{onClick:B,className:"btn bg-gray-100 hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ns,{className:"w-4 h-4"})," Refresh"]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsx("div",{className:"flex gap-2",children:we.map(pe=>e.jsxs("button",{onClick:()=>o(pe.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all ${c===pe.id?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(pe.icon,{className:"w-4 h-4"})," ",pe.label]},pe.id))}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("select",{value:f,onChange:pe=>y(pe.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Terms"}),v.map(pe=>e.jsx("option",{value:pe.id,children:pe.term_name},pe.id))]})})]}),xe>0&&e.jsxs("div",{className:"card p-4 bg-gradient-to-r from-blue-50 to-purple-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ln,{className:"w-5 h-5 text-purple-600"}),e.jsx("span",{className:"font-medium",children:"Collection Target"})]}),e.jsxs("span",{className:"text-sm",children:[_e(t?.total_collected)," / ",_e(xe)]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full transition-all ${ie()>=100?"bg-green-500":"bg-purple-500"}`,style:{width:`${ie()}%`}})}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[ie().toFixed(1),"% of target achieved"]})]}),c==="overview"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:le.map((pe,Me)=>e.jsxs("div",{className:"card p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:`${pe.color} w-10 h-10 rounded-lg flex items-center justify-center`,children:e.jsx(pe.icon,{className:"w-5 h-5 text-white"})}),ae&&Me<2&&e.jsxs("div",{className:`flex items-center text-xs ${ae.change>=0?"text-green-600":"text-red-600"}`,children:[ae.change>=0?e.jsx(xy,{className:"w-3 h-3"}):e.jsx(uy,{className:"w-3 h-3"}),Math.abs(ae.change||0).toFixed(1),"%"]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:pe.title}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:pe.value})]},Me))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Collection Rate"}),e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Payment Collection"}),e.jsxs("span",{className:"text-lg font-bold text-green-600",children:[t?.total_revenue>0?(t?.total_collected/t?.total_revenue*100).toFixed(1):0,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4",children:e.jsx("div",{className:"bg-green-500 h-4 rounded-full transition-all",style:{width:`${t?.total_revenue>0?t?.total_collected/t?.total_revenue*100:0}%`}})}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"bg-green-50 p-2 rounded",children:[e.jsx("span",{className:"text-green-700 font-medium",children:"Collected:"})," ",_e(t?.total_collected)]}),e.jsxs("div",{className:"bg-orange-50 p-2 rounded",children:[e.jsx("span",{className:"text-orange-700 font-medium",children:"Pending:"})," ",_e(t?.total_outstanding)]})]})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Quick Actions"}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:Pe.map((pe,Me)=>e.jsxs("button",{onClick:()=>l(pe.path),className:"card p-4 hover:shadow-lg transition-shadow text-left",children:[e.jsx("div",{className:`${pe.color} w-10 h-10 rounded-lg flex items-center justify-center mb-3`,children:e.jsx(pe.icon,{className:"w-5 h-5 text-white"})}),e.jsx("h4",{className:"font-medium text-gray-900",children:pe.title}),e.jsx("p",{className:"text-xs text-gray-500",children:pe.description})]},Me))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Recent Payments"}),e.jsxs("button",{onClick:()=>l("/admin/payments"),className:"text-sm text-blue-600 hover:underline flex items-center",children:["View All ",e.jsx(cr,{className:"w-4 h-4"})]})]}),K.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No recent payments"}):e.jsx("div",{className:"space-y-3",children:K.map((pe,Me)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:pe.student_name}),e.jsx("p",{className:"text-xs text-gray-500",children:pe.payment_date})]}),e.jsx("span",{className:"font-semibold text-green-600",children:_e(pe.amount)})]},Me))})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Recent Invoices"}),e.jsxs("button",{onClick:()=>l("/admin/invoices"),className:"text-sm text-blue-600 hover:underline flex items-center",children:["View All ",e.jsx(cr,{className:"w-4 h-4"})]})]}),P.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No recent invoices"}):e.jsx("div",{className:"space-y-3",children:P.map((pe,Me)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:pe.student_name}),e.jsx("p",{className:"text-xs text-gray-500",children:pe.invoice_number})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"font-semibold",children:_e(pe.total_amount)}),e.jsx("span",{className:`block text-xs px-2 py-0.5 rounded-full ${pe.status==="paid"?"bg-green-100 text-green-700":pe.status==="approved"?"bg-blue-100 text-blue-700":"bg-orange-100 text-orange-700"}`,children:pe.status})]})]},Me))})]})]})]}),c==="analytics"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Monthly Collection Trend"}),Q.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No trend data available"}):e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"absolute left-0 top-0 h-48 w-20 flex flex-col justify-between text-xs text-gray-400 pr-2 text-right",children:[e.jsx("span",{children:_e(q)}),e.jsx("span",{children:_e(q/2)}),e.jsx("span",{children:"GHS 0"})]}),e.jsxs("div",{className:"ml-20",children:[e.jsx("div",{className:"flex items-end gap-2 h-48 border-b border-l border-gray-200 p-2",children:Q.map((pe,Me)=>{const Se=parseFloat(pe.collected)||0,Ne=q>0?Se/q*100:0,et=Math.max(Ne/100*176,Se>0?8:2);return e.jsxs("div",{className:"flex-1 flex flex-col justify-end items-center group h-full",children:[e.jsx("div",{className:"relative",children:e.jsx("div",{className:"absolute -top-8 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-10",children:_e(Se)})}),e.jsx("div",{className:"w-full max-w-12 bg-gradient-to-t from-blue-600 to-blue-400 rounded-t transition-all hover:from-blue-700 hover:to-blue-500 cursor-pointer",style:{height:`${et}px`}})]},Me)})}),e.jsx("div",{className:"flex gap-2 mt-2",children:Q.map((pe,Me)=>e.jsx("div",{className:"flex-1 text-center text-xs text-gray-500 font-medium",children:pe.month},Me))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Class-wise Collection"}),z.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No data available"}):e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:z.map((pe,Me)=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium",children:pe.class_name}),e.jsxs("span",{className:"text-sm text-gray-600",children:[pe.rate||0,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${pe.rate||0}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsxs("span",{children:["Collected: ",_e(pe.collected)]}),e.jsxs("span",{children:["Outstanding: ",_e(pe.outstanding)]})]})]},Me))})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Payment Methods"}),Object.keys(re).length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No data available"}):e.jsx("div",{className:"space-y-3",children:Object.entries(re).map(([pe,Me],Se)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(aa,{className:"w-5 h-5 text-gray-400"}),e.jsx("span",{className:"font-medium capitalize",children:pe.replace("_"," ")})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"font-semibold",children:_e(Me.amount)}),e.jsxs("span",{className:"block text-xs text-gray-500",children:[Me.count," payments"]})]})]},Se))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(_s,{className:"w-5 h-5 text-red-500"}),e.jsx("h3",{className:"font-semibold text-gray-900",children:"Overdue Payments"})]}),te.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No overdue payments"}):e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:te.map((pe,Me)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:pe.student_name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[pe.class_name,"  ",pe.days_overdue," days overdue"]})]}),e.jsx("span",{className:"font-semibold text-red-600",children:_e(pe.amount)})]},Me))})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Rt,{className:"w-5 h-5 text-orange-500"}),e.jsx("h3",{className:"font-semibold text-gray-900",children:"Top Debtors"})]}),O.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No outstanding debts"}):e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:O.map((pe,Me)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-orange-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-6 h-6 bg-orange-200 rounded-full flex items-center justify-center text-xs font-bold",children:Me+1}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:pe.student_name}),e.jsx("p",{className:"text-xs text-gray-500",children:pe.class_name})]})]}),e.jsx("span",{className:"font-semibold text-orange-600",children:_e(pe.outstanding)})]},Me))})]})]})]}),c==="reports"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"card p-6 hover:shadow-lg transition-shadow cursor-pointer",onClick:ye,children:[e.jsx(xs,{className:"w-10 h-10 text-green-600 mb-4"}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Export CSV Report"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Download comprehensive financial data in CSV format"})]}),e.jsxs("div",{className:"card p-6 hover:shadow-lg transition-shadow cursor-pointer",onClick:fe,children:[e.jsx(Kt,{className:"w-10 h-10 text-blue-600 mb-4"}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Export JSON Report"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Download detailed report data in JSON format"})]}),e.jsxs("div",{className:"card p-6 hover:shadow-lg transition-shadow cursor-pointer",onClick:Ke,children:[e.jsx(or,{className:"w-10 h-10 text-purple-600 mb-4"}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Print Report"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Generate printable financial summary report"})]}),e.jsxs("div",{className:"card p-6 hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>l("/admin/invoices"),children:[e.jsx(Kt,{className:"w-10 h-10 text-orange-600 mb-4"}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Invoice Report"}),e.jsx("p",{className:"text-sm text-gray-600",children:"View and manage all invoices"})]}),e.jsxs("div",{className:"card p-6 hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>l("/admin/payments"),children:[e.jsx(aa,{className:"w-10 h-10 text-teal-600 mb-4"}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Payment Report"}),e.jsx("p",{className:"text-sm text-gray-600",children:"View all payment transactions"})]}),e.jsxs("div",{className:"card p-6 hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>l("/admin/fee-structure"),children:[e.jsx(vs,{className:"w-10 h-10 text-indigo-600 mb-4"}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Fee Structure"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage fee groups and pricing"})]})]}),I&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Set Collection Target"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Set a target amount for fee collection this term"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Target Amount (GHS)"}),e.jsx("input",{type:"number",value:xe,onChange:pe=>Z(parseFloat(pe.target.value)||0),className:"input",placeholder:"Enter target amount"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>H(!1),className:"btn bg-gray-200",children:"Cancel"}),e.jsx("button",{onClick:ve,className:"btn btn-primary",children:"Save Target"})]})]})})]})}function k7(){const{levels:t,levelCodes:s}=Ny(),[a,r]=h.useState("groups"),[l,c]=h.useState([]),[o,m]=h.useState([]),[u,x]=h.useState([]),[A,g]=h.useState([]),[N,f]=h.useState([]),[y,v]=h.useState([]),[U,D]=h.useState([]),[M,K]=h.useState(!0),[$,P]=h.useState(!1),[se,z]=h.useState(""),[R,j]=h.useState(null),[T,Q]=h.useState(""),[E,te]=h.useState(""),[C,O]=h.useState(""),[V,re]=h.useState("2024/2025"),[ge,xe]=h.useState(!1),[Z,I]=h.useState(!1),[H,ae]=h.useState(!1),[k,B]=h.useState(!1),[w,oe]=h.useState(""),[ne,Fe]=h.useState(""),[je,Ge]=h.useState([]),[ze,Xe]=h.useState([]),[st,ce]=h.useState([]),_e=h.useRef(),le=["2023/2024","2024/2025","2025/2026"],[Pe,we]=h.useState({group_name:"",group_code:"",description:"",status:"active"}),[fe,ye]=h.useState({fee_group_id:"",item_name:"",item_code:"",description:"",frequency:"term",is_optional:0,is_taxable:0,tax_rate:0,status:"active"}),[Ke,ve]=h.useState({fee_item_id:"",class_id:"",term_id:"",level:"",amount:"",currency:"GHS",academic_year:"2024/2025",late_fee:0,late_fee_type:"fixed",is_active:1}),[ie,q]=h.useState({plan_name:"",plan_code:"",description:"",installments:[{percentage:100,due_days:0,label:"Full Payment"}],is_default:0,status:"active"}),[pe,Me]=h.useState({name:"",code:"",type:"percentage",value:0,applies_to:"all",fee_item_id:"",min_siblings:0,early_payment_days:0,status:"active"});h.useEffect(()=>{Ne(),Se()},[a]);const Se=async()=>{try{const[He,Te]=await Promise.all([Bi.getAll(),yl.getAll()]);v(He.data.classes||[]),D(Te.data.terms||[])}catch(He){console.error("Error fetching base data:",He)}},Ne=async()=>{try{K(!0);const[He,Te,bt]=await Promise.all([jr.getFeeRules(),Op.getAll(),ah.getAll()]);if(x(He.data.fee_rules||[]),c(Te.data.fee_groups||[]),m(bt.data.fee_items||[]),a==="plans"){const Xt=await jr.getInstallmentPlans();g(Xt.data.installment_plans||[])}else if(a==="discounts")try{const Xt=await F.get(`${ee}/finance.php?resource=discounts`);f(Xt.data.discounts||[])}catch{f([])}}catch(He){console.error("Error fetching data:",He)}finally{K(!1)}},et=()=>{z("group"),j(null),we({group_name:"",group_code:"",description:"",status:"active"}),P(!0)},Ce=()=>{z("item"),j(null),ye({fee_group_id:"",item_name:"",item_code:"",description:"",frequency:"term",is_optional:0,status:"active"}),P(!0)},ft=()=>{z("rule"),j(null),ve({fee_item_id:"",level:"",amount:"",academic_year:"2024/2025",is_active:1}),P(!0)},qe=()=>{z("plan"),j(null),q({plan_name:"",plan_code:"",description:"",installments:[{percentage:100,due_days:0,label:"Full Payment"}],is_default:0,status:"active"}),P(!0)},W=async He=>{He.preventDefault();try{R?await Op.update(R.id,Pe):await Op.create(Pe),P(!1),Ne(),alert("Fee group saved successfully!")}catch(Te){alert("Error: "+(Te.response?.data?.error||Te.message))}},Ie=async He=>{He.preventDefault();try{R?await ah.update(R.id,fe):await ah.create(fe),P(!1),Ne(),alert("Fee item saved successfully!")}catch(Te){alert("Error: "+(Te.response?.data?.error||Te.message))}},mt=async He=>{He.preventDefault();try{console.log("Submitting rule form:",Ke),R?await jr.updateFeeRule(R.id,Ke):await jr.createFeeRule(Ke),P(!1),Ne(),alert("Fee rule saved successfully!")}catch(Te){console.error("Error saving rule:",Te),alert("Error: "+(Te.response?.data?.error||Te.message))}},pt=async He=>{He.preventDefault();try{const Te={...ie,installments:JSON.stringify(ie.installments)};R?await jr.updateInstallmentPlan(R.id,Te):await jr.createInstallmentPlan(Te),P(!1),Ne(),alert("Installment plan saved successfully!")}catch(Te){alert("Error: "+(Te.response?.data?.error||Te.message))}},kt=async(He,Te)=>{if(window.confirm("Are you sure you want to delete this item?"))try{He==="group"?await Op.delete(Te):He==="item"?await ah.delete(Te):He==="rule"?await jr.deleteFeeRule(Te):He==="plan"?await jr.deleteInstallmentPlan(Te):He==="discount"&&await F.delete(`${ee}/finance.php?resource=discounts&id=${Te}`),Ne(),alert("Deleted successfully!")}catch(bt){alert("Error deleting: "+bt.message)}},J=()=>{z("discount"),j(null),Me({name:"",code:"",type:"percentage",value:0,applies_to:"all",fee_item_id:"",min_siblings:0,early_payment_days:0,status:"active"}),P(!0)},Je=async He=>{He.preventDefault();try{R?await F.put(`${ee}/finance.php?resource=discounts&id=${R.id}`,pe):await F.post(`${ee}/finance.php?resource=discounts`,pe),P(!1),Ne(),alert("Discount rule saved!")}catch{alert("Error saving discount")}},_t=He=>{j(null),ve({...He,academic_year:V||"2024/2025",is_active:1}),z("rule"),P(!0)},$t=async He=>{if(window.confirm(`Copy all fee rules to ${He}?`))try{await F.post(`${ee}/finance.php?action=copy_rules`,{source_year:V,target_year:He}),alert("Fee rules copied successfully!"),Ne()}catch{alert("Error copying rules")}},me=()=>{let He="";a==="rules"?(He=`Fee Item,Level,Class,Term,Amount,Currency,Academic Year,Status
`,He+=Et.map(ls=>`"${ls.item_name}","${ls.level||"All"}","${ls.class_name||"All"}","${ls.term_name||"All"}",${ls.amount},${ls.currency||"GHS"},"${ls.academic_year}",${ls.is_active==1?"Active":"Inactive"}`).join(`
`)):a==="items"?(He=`Item Name,Code,Group,Frequency,Type,Status
`,He+=Ct.map(ls=>`"${ls.item_name}","${ls.item_code}","${ls.group_name}","${ls.frequency}",${ls.is_optional==1?"Optional":"Mandatory"},${ls.status}`).join(`
`)):a==="groups"&&(He=`Group Name,Code,Description,Status
`,He+=Ue.map(ls=>`"${ls.group_name}","${ls.group_code}","${ls.description||""}",${ls.status}`).join(`
`));const Te=new Blob([He],{type:"text/csv"}),bt=URL.createObjectURL(Te),Xt=document.createElement("a");Xt.href=bt,Xt.download=`fee_${a}_${new Date().toISOString().split("T")[0]}.csv`,Xt.click()},Ze=He=>{const Te=He.target.files[0];if(!Te)return;const bt=new FileReader;bt.onload=Xt=>{const Ts=Xt.target.result.split(`
`).filter(Ht=>Ht.trim()),ss=Ts[0].split(",").map(Ht=>Ht.trim().replace(/"/g,"")),he=Ts.slice(1).map(Ht=>{const Zt=Ht.match(/(".*?"|[^",]+)(?=\s*,|\s*$)/g)||[],Ee={};return ss.forEach((zt,is)=>{Ee[zt]=(Zt[is]||"").replace(/"/g,"").trim()}),Ee});Xe(he),I(!0)},bt.readAsText(Te),He.target.value=""},ct=async()=>{try{for(const He of ze)if(a==="rules"){const Te=o.find(bt=>bt.item_name===He["Fee Item"]);Te&&await jr.createFeeRule({fee_item_id:Te.id,level:He.Level==="All"?"":He.Level?.toLowerCase(),amount:parseFloat(He.Amount)||0,academic_year:He["Academic Year"]||V,is_active:He.Status==="Active"?1:0})}I(!1),Xe([]),Ne(),alert("Import completed!")}catch(He){alert("Error importing: "+He.message)}},Yt=()=>{const He=window.open("","_blank");He.document.write(`
      <html><head><title>Fee Structure - ${V}</title>
      <style>
        body { font-family: Arial; padding: 30px; }
        h1 { color: #1f2937; border-bottom: 2px solid #2563eb; padding-bottom: 10px; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        th { background: #2563eb; color: white; }
        .section { margin-top: 30px; }
        .total { font-weight: bold; background: #f3f4f6; }
      </style></head><body>
      <h1>Fee Structure - ${V}</h1>
      <p>Generated: ${new Date().toLocaleString()}</p>
      
      <div class="section">
        <h3>Fee Rules</h3>
        <table>
          <thead><tr><th>Fee Item</th><th>Level</th><th>Amount</th><th>Status</th></tr></thead>
          <tbody>
            ${Et.map(Te=>`<tr><td>${Te.item_name}</td><td>${Te.level||"All"}</td><td>GHS ${parseFloat(Te.amount).toFixed(2)}</td><td>${Te.is_active==1?"Active":"Inactive"}</td></tr>`).join("")}
          </tbody>
        </table>
      </div>
      
      <div class="section">
        <h3>Installment Plans</h3>
        <table>
          <thead><tr><th>Plan Name</th><th>Installments</th><th>Status</th></tr></thead>
          <tbody>
            ${A.map(Te=>{const bt=typeof Te.installments=="string"?JSON.parse(Te.installments):Te.installments;return`<tr><td>${Te.plan_name}</td><td>${bt.map(Xt=>`${Xt.percentage}% - ${Xt.label}`).join(", ")}</td><td>${Te.status}</td></tr>`}).join("")}
          </tbody>
        </table>
      </div>
      </body></html>
    `),He.document.close(),He.print()},be=()=>{if(!w){alert("Please select a class");return}const He=y.find(ss=>ss.id==w),Te=He?.level||"",bt=He?.class_name||"";console.log("Calculator Debug:",{selectedClass:w,classInfo:He,educationLevel:Te,className:bt,yearFilter:V,selectedTerm:ne,totalRules:u.length,feeGroups:l.map(ss=>ss.group_name)});const Xt=l.find(ss=>ss.group_name?.toLowerCase()===bt?.toLowerCase()||ss.group_code?.toLowerCase()===bt?.toLowerCase());console.log("Matching group:",Xt);const ls=u.filter(ss=>{const he=(ss.level||"").toLowerCase().trim();if(ss.is_active!=1)return console.log(`Rule ${ss.item_name} excluded: not active`),!1;if(ss.academic_year!==V)return console.log(`Rule ${ss.item_name} excluded: year mismatch (${ss.academic_year} vs ${V})`),!1;if(ss.term_id&&ne&&ss.term_id!=ne)return console.log(`Rule ${ss.item_name} excluded: term mismatch`),!1;if(ss.class_id&&ss.class_id!=w)return console.log(`Rule ${ss.item_name} excluded: class mismatch (${ss.class_id} vs ${w})`),!1;if(!he||he==="all levels"||he==="all")return console.log(`Rule ${ss.item_name} included: applies to all levels`),!0;if(he===Te?.toLowerCase())return console.log(`Rule ${ss.item_name} included: education level match`),!0;if(he===bt?.toLowerCase())return console.log(`Rule ${ss.item_name} included: class name match`),!0;if(Xt&&(he===Xt.group_name?.toLowerCase()||he===Xt.group_code?.toLowerCase()))return console.log(`Rule ${ss.item_name} included: fee group match`),!0;const Ht=t.find(zt=>zt.level_code?.toLowerCase()===Te?.toLowerCase()||zt.level_name?.toLowerCase()===Te?.toLowerCase());if(Ht){Ht.level_code?.toLowerCase(),Ht.level_name?.toLowerCase();const zt=t.find(is=>is.level_code?.toLowerCase()===he);if(zt&&zt.level_code?.toLowerCase()===he&&(zt.level_code?.toLowerCase()===Te?.toLowerCase()||zt.level_name?.toLowerCase()===Te?.toLowerCase()))return console.log(`Rule ${ss.item_name} included: education level code match`),!0}const Zt=bt?.toLowerCase().replace(/[^a-z0-9]/g,""),Ee=he.replace(/[^a-z0-9]/g,"");return Zt&&Ee&&(Zt.includes(Ee)||Ee.includes(Zt)||Zt===`grade${Ee.replace("g","")}`||Ee===`g${Zt.replace("grade","")}`)?(console.log(`Rule ${ss.item_name} included: class code pattern match (${he} ~ ${bt})`),!0):(console.log(`Rule ${ss.item_name} excluded: level "${he}" doesn't match class "${bt}" or education level "${Te}"`),!1)});console.log("Applicable rules:",ls);const Ts=ls.map(ss=>({item_name:ss.item_name,amount:parseFloat(ss.amount),level:ss.level||"All",is_optional:o.find(he=>he.id==ss.fee_item_id)?.is_optional==1}));Ge(Ts),xe(!0)},lt=(He=!0)=>je.filter(Te=>He||!Te.is_optional).reduce((Te,bt)=>Te+bt.amount,0),Ue=l.filter(He=>(!T||He.group_name?.toLowerCase().includes(T.toLowerCase())||He.group_code?.toLowerCase().includes(T.toLowerCase()))&&(!C||He.status===C)),Ct=o.filter(He=>(!T||He.item_name?.toLowerCase().includes(T.toLowerCase())||He.item_code?.toLowerCase().includes(T.toLowerCase()))&&(!C||He.status===C)),Et=u.filter(He=>(!T||He.item_name?.toLowerCase().includes(T.toLowerCase()))&&(!E||He.level===E)&&(!V||He.academic_year===V)&&(!C||(C==="active"?He.is_active==1:He.is_active==0))),Rs=[{id:"groups",label:"Groups",icon:HB},{id:"items",label:"Items",icon:Kt},{id:"rules",label:"Rules",icon:vs},{id:"plans",label:"Installment Plans",icon:Ot},{id:"discounts",label:"Discounts",icon:gy}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Fee Structure Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage fee groups, items, pricing rules, and discounts"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>{oe(""),Fe(""),xe(!0)},className:"btn bg-purple-600 text-white hover:bg-purple-700 flex items-center gap-2",children:[e.jsx(lb,{className:"w-4 h-4"})," Fee Calculator"]}),e.jsxs("button",{onClick:me,className:"btn bg-green-600 text-white hover:bg-green-700 flex items-center gap-2",children:[e.jsx(xs,{className:"w-4 h-4"})," Export"]}),e.jsxs("button",{onClick:Yt,className:"btn bg-gray-600 text-white hover:bg-gray-700 flex items-center gap-2",children:[e.jsx(or,{className:"w-4 h-4"})," Print"]}),e.jsx("input",{type:"file",ref:_e,accept:".csv",onChange:Ze,className:"hidden"}),e.jsxs("button",{onClick:()=>_e.current?.click(),className:"btn bg-blue-600 text-white hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(Hr,{className:"w-4 h-4"})," Import"]}),e.jsxs("button",{onClick:()=>{a==="groups"?et():a==="items"?Ce():a==="rules"?ft():a==="discounts"?J():qe()},className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-5 h-5"}),"Add ",a==="groups"?"Group":a==="items"?"Item":a==="rules"?"Rule":a==="discounts"?"Discount":"Plan"]})]})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex gap-4",children:Rs.map(He=>e.jsxs("button",{onClick:()=>r(He.id),className:`flex items-center gap-2 py-3 px-4 border-b-2 font-medium text-sm transition-all ${a===He.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(He.icon,{className:"w-4 h-4"})," ",He.label]},He.id))})}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(Ka,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Fee Structure Setup Guide"}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"Follow these steps to properly configure fee structures so students can see their applicable fees during enrollment."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:`p-4 rounded-lg border-2 ${l.length>0?"bg-green-50 border-green-300":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${l.length>0?"bg-green-500 text-white":"bg-gray-300 text-gray-600"}`,children:l.length>0?e.jsx(Tn,{className:"w-4 h-4"}):"1"}),e.jsx("span",{className:"font-medium text-sm",children:"Create Fee Groups"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:'Create groups for each class/grade (e.g., "Grade 1", "Grade 2"). Each group represents a class level.'}),e.jsx("div",{className:"mt-2 text-xs",children:e.jsx("span",{className:l.length>0?"text-green-600 font-medium":"text-orange-600",children:l.length>0?` ${l.length} groups created`:" No groups yet"})})]}),e.jsxs("div",{className:`p-4 rounded-lg border-2 ${o.length>0?"bg-green-50 border-green-300":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${o.length>0?"bg-green-500 text-white":"bg-gray-300 text-gray-600"}`,children:o.length>0?e.jsx(Tn,{className:"w-4 h-4"}):"2"}),e.jsx("span",{className:"font-medium text-sm",children:"Add Fee Items"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:'Add fee items under each group (e.g., "Tuition", "Books", "Uniform"). Assign items to their respective groups.'}),e.jsxs("div",{className:"mt-2 text-xs",children:[e.jsx("span",{className:o.length>0?"text-green-600 font-medium":"text-orange-600",children:o.length>0?` ${o.length} items created`:" No items yet"}),(()=>{const He=l.filter(Te=>!o.some(bt=>bt.fee_group_id==Te.id));return He.length>0&&e.jsxs("div",{className:"mt-1 text-orange-600",children:[" Groups without items: ",He.map(Te=>Te.group_name).join(", ")]})})()]})]}),e.jsxs("div",{className:`p-4 rounded-lg border-2 ${u.length>0?"bg-green-50 border-green-300":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${u.length>0?"bg-green-500 text-white":"bg-gray-300 text-gray-600"}`,children:u.length>0?e.jsx(Tn,{className:"w-4 h-4"}):"3"}),e.jsx("span",{className:"font-medium text-sm",children:"Set Pricing Rules"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Define amounts for each fee item per class/level. Set the academic year and term for each rule."}),e.jsxs("div",{className:"mt-2 text-xs",children:[e.jsx("span",{className:u.length>0?"text-green-600 font-medium":"text-orange-600",children:u.length>0?` ${u.length} rules configured`:" No rules yet"}),(()=>{const He=o.filter(Te=>!u.some(bt=>bt.fee_item_id==Te.id&&bt.academic_year===V));return He.length>0&&e.jsxs("div",{className:"mt-1 text-orange-600",children:[" Items without rules for ",V,": ",He.map(Te=>Te.item_name).join(", ")]})})()]})]}),e.jsxs("div",{className:`p-4 rounded-lg border-2 ${y.length>0?"bg-green-50 border-green-300":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${y.length>0?"bg-green-500 text-white":"bg-gray-300 text-gray-600"}`,children:y.length>0?e.jsx(Tn,{className:"w-4 h-4"}):"4"}),e.jsx("span",{className:"font-medium text-sm",children:"Link to Classes"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Ensure classes are created in Academic  Classes. Rules can target specific classes or education levels."}),e.jsx("div",{className:"mt-2 text-xs",children:e.jsx("span",{className:y.length>0?"text-green-600 font-medium":"text-orange-600",children:y.length>0?` ${y.length} classes available`:" No classes yet"})})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(_s,{className:"w-4 h-4 text-amber-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-xs text-amber-800",children:[e.jsx("strong",{children:"Important:"})," For students to see their fees during enrollment, ensure:",e.jsxs("ul",{className:"list-disc ml-4 mt-1 space-y-1",children:[e.jsxs("li",{children:["Fee rules have the correct ",e.jsx("strong",{children:"academic year"})," selected (e.g., 2024/2025)"]}),e.jsxs("li",{children:["Rules are set to ",e.jsx("strong",{children:"Active"})," status"]}),e.jsxs("li",{children:["Either assign rules to specific ",e.jsx("strong",{children:"classes"})," OR use ",e.jsx("strong",{children:"education levels"})," (e.g., primary, jhs, shs)"]}),e.jsxs("li",{children:["Use the ",e.jsx("strong",{children:"Fee Calculator"})," button above to preview what students will see"]})]})]})]})})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search...",value:T,onChange:He=>Q(He.target.value),className:"input pl-10 w-full"})]}),a==="rules"&&e.jsxs(e.Fragment,{children:[e.jsx("select",{value:V,onChange:He=>re(He.target.value),className:"input w-auto",children:le.map(He=>e.jsx("option",{value:He,children:He},He))}),e.jsxs("select",{value:E,onChange:He=>te(He.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Levels"}),s.map(He=>e.jsx("option",{value:He,children:He.toUpperCase()},He))]}),e.jsxs("button",{onClick:()=>$t(le.find(He=>He!==V)),className:"btn bg-orange-500 text-white hover:bg-orange-600 text-sm",children:[e.jsx(vl,{className:"w-4 h-4 mr-1"})," Copy to New Year"]})]}),e.jsxs("select",{value:C,onChange:He=>O(He.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})}),a==="groups"&&e.jsx("div",{className:"card overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Group Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:Ue.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-6 py-8 text-center text-gray-500",children:"No fee groups found"})}):Ue.map(He=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 font-medium text-gray-900",children:He.group_name}),e.jsx("td",{className:"px-6 py-4 font-mono text-sm",children:He.group_code}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:He.description||"-"}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${He.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:He.status})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{j(He),we(He),z("group"),P(!0)},className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",children:e.jsx(Na,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>kt("group",He.id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",children:e.jsx(us,{className:"w-4 h-4"})})]})})]},He.id))})]})}),a==="items"&&e.jsx("div",{className:"card overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Item Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Group"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Frequency"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:Ct.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-8 text-center text-gray-500",children:"No fee items found"})}):Ct.map(He=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 font-medium text-gray-900",children:He.item_name}),e.jsx("td",{className:"px-6 py-4 font-mono text-sm",children:He.item_code}),e.jsx("td",{className:"px-6 py-4 text-sm",children:He.group_name}),e.jsx("td",{className:"px-6 py-4 text-sm capitalize",children:He.frequency}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${He.is_optional==1?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:He.is_optional==1?"Optional":"Mandatory"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{j(He),ye(He),z("item"),P(!0)},className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",children:e.jsx(Na,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>kt("item",He.id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",children:e.jsx(us,{className:"w-4 h-4"})})]})})]},He.id))})]})}),a==="rules"&&e.jsx("div",{className:"card overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Fee Item"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Level"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Class"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Late Fee"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Year"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:Et.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"px-4 py-8 text-center text-gray-500",children:"No fee rules found"})}):Et.map(He=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:He.item_name}),e.jsx("td",{className:"px-4 py-3 text-sm",children:He.level?t.find(Te=>Te.level_code===He.level)?.level_name||He.level.toUpperCase():"All Levels"}),e.jsx("td",{className:"px-4 py-3 text-sm",children:He.class_name||"All"}),e.jsxs("td",{className:"px-4 py-3 font-semibold text-green-600",children:["GHS ",parseFloat(He.amount).toFixed(2)]}),e.jsx("td",{className:"px-4 py-3 text-sm text-orange-600",children:He.late_fee?`GHS ${He.late_fee}`:"-"}),e.jsx("td",{className:"px-4 py-3 text-sm",children:He.academic_year}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${He.is_active==1?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:He.is_active==1?"Active":"Inactive"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>{console.log("Editing rule:",He),console.log("Rule level from DB:",He.level),console.log("Available education levels:",t.map(Te=>Te.level_code)),j(He),ve({...He,level:He.level||""}),z("rule"),P(!0)},className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",title:"Edit",children:e.jsx(Na,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>_t(He),className:"p-1.5 text-green-600 hover:bg-green-50 rounded",title:"Duplicate",children:e.jsx(vl,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>kt("rule",He.id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:e.jsx(us,{className:"w-4 h-4"})})]})})]},He.id))})]})}),a==="discounts"&&e.jsx("div",{className:"card overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Value"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Applies To"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:N.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-8 text-center text-gray-500",children:"No discount rules found"})}):N.map(He=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 font-medium text-gray-900",children:He.name}),e.jsx("td",{className:"px-6 py-4 font-mono text-sm",children:He.code}),e.jsx("td",{className:"px-6 py-4 text-sm capitalize",children:He.type}),e.jsx("td",{className:"px-6 py-4 font-semibold text-purple-600",children:He.type==="percentage"?`${He.value}%`:`GHS ${He.value}`}),e.jsx("td",{className:"px-6 py-4 text-sm capitalize",children:He.applies_to}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${He.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:He.status})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{j(He),Me(He),z("discount"),P(!0)},className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",children:e.jsx(Na,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>kt("discount",He.id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",children:e.jsx(us,{className:"w-4 h-4"})})]})})]},He.id))})]})}),a==="plans"&&e.jsx("div",{className:"card overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Plan Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Installments"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Default"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:A.map(He=>{const Te=typeof He.installments=="string"?JSON.parse(He.installments):He.installments;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 font-medium text-gray-900",children:He.plan_name}),e.jsx("td",{className:"px-6 py-4 font-mono text-sm",children:He.plan_code}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:He.description||"-"}),e.jsx("td",{className:"px-6 py-4 text-sm",children:Te.map((bt,Xt)=>e.jsxs("div",{className:"text-xs",children:[bt.percentage,"% - ",bt.label," (",bt.due_days," days)"]},Xt))}),e.jsx("td",{className:"px-6 py-4",children:He.is_default==1&&e.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-700",children:"Default"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${He.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:He.status})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{const bt=typeof He.installments=="string"?JSON.parse(He.installments):He.installments;j(He),q({...He,installments:bt}),z("plan"),P(!0)},className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",children:e.jsx(Na,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>kt("plan",He.id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",children:e.jsx(us,{className:"w-4 h-4"})})]})})]},He.id)})})]})}),ge&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx(lb,{className:"w-5 h-5"})," Fee Calculator"]}),e.jsx("button",{onClick:()=>xe(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Class *"}),e.jsxs("select",{value:w,onChange:He=>oe(He.target.value),className:"input",children:[e.jsx("option",{value:"",children:"Select Class"}),y.map(He=>e.jsx("option",{value:He.id,children:He.class_name},He.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Term"}),e.jsxs("select",{value:ne,onChange:He=>Fe(He.target.value),className:"input",children:[e.jsx("option",{value:"",children:"All Terms"}),U.map(He=>e.jsx("option",{value:He.id,children:He.term_name},He.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Academic Year"}),e.jsx("select",{value:V,onChange:He=>re(He.target.value),className:"input",children:le.map(He=>e.jsx("option",{value:He,children:He},He))})]})]}),e.jsx("button",{onClick:be,className:"btn btn-primary w-full mb-4",children:"Calculate Fees"}),je.length>0&&e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Fee Item"}),e.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Type"}),e.jsx("th",{className:"px-4 py-2 text-right text-sm",children:"Amount"})]})}),e.jsx("tbody",{className:"divide-y",children:je.map((He,Te)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2",children:He.item_name}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${He.is_optional?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:He.is_optional?"Optional":"Mandatory"})}),e.jsxs("td",{className:"px-4 py-2 text-right font-medium",children:["GHS ",He.amount.toFixed(2)]})]},Te))}),e.jsxs("tfoot",{className:"bg-gray-50 font-semibold",children:[e.jsxs("tr",{children:[e.jsx("td",{colSpan:"2",className:"px-4 py-2",children:"Mandatory Total"}),e.jsxs("td",{className:"px-4 py-2 text-right text-green-600",children:["GHS ",lt(!1).toFixed(2)]})]}),e.jsxs("tr",{children:[e.jsx("td",{colSpan:"2",className:"px-4 py-2",children:"Total (with Optional)"}),e.jsxs("td",{className:"px-4 py-2 text-right text-blue-600",children:["GHS ",lt(!0).toFixed(2)]})]})]})]})})]})}),Z&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-semibold",children:["Import Preview (",ze.length," rows)"]}),e.jsx("button",{onClick:()=>{I(!1),Xe([])},children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"flex-1 overflow-auto p-4",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:Object.keys(ze[0]||{}).map(He=>e.jsx("th",{className:"px-3 py-2 text-left",children:He},He))})}),e.jsx("tbody",{className:"divide-y",children:ze.slice(0,20).map((He,Te)=>e.jsx("tr",{children:Object.values(He).map((bt,Xt)=>e.jsx("td",{className:"px-3 py-2",children:bt},Xt))},Te))})]}),ze.length>20&&e.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Showing first 20 of ",ze.length," rows"]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>{I(!1),Xe([])},className:"btn bg-gray-200",children:"Cancel"}),e.jsxs("button",{onClick:ct,className:"btn btn-primary",children:["Import ",ze.length," Records"]})]})]})}),$&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between sticky top-0 bg-white",children:[e.jsxs("h2",{className:"text-xl font-semibold",children:[R?"Edit":"Add"," ",se==="group"?"Fee Group":se==="item"?"Fee Item":se==="rule"?"Fee Rule":se==="discount"?"Discount":"Installment Plan"]}),e.jsx("button",{onClick:()=>P(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),se==="group"&&e.jsxs("form",{onSubmit:W,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Group Name *"}),e.jsx("input",{type:"text",required:!0,value:Pe.group_name,onChange:He=>we({...Pe,group_name:He.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Group Code *"}),e.jsx("input",{type:"text",required:!0,value:Pe.group_code,onChange:He=>we({...Pe,group_code:He.target.value}),className:"input"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description"}),e.jsx("textarea",{value:Pe.description,onChange:He=>we({...Pe,description:He.target.value}),className:"input",rows:"3"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Status"}),e.jsxs("select",{value:Pe.status,onChange:He=>we({...Pe,status:He.target.value}),className:"input",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>P(!1),className:"btn bg-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save"})]})]}),se==="item"&&e.jsxs("form",{onSubmit:Ie,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Fee Group *"}),e.jsxs("select",{required:!0,value:fe.fee_group_id,onChange:He=>ye({...fe,fee_group_id:He.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select Group"}),l.map(He=>e.jsx("option",{value:He.id,children:He.group_name},He.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Item Code *"}),e.jsx("input",{type:"text",required:!0,value:fe.item_code,onChange:He=>ye({...fe,item_code:He.target.value}),className:"input"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Item Name *"}),e.jsx("input",{type:"text",required:!0,value:fe.item_name,onChange:He=>ye({...fe,item_name:He.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Frequency"}),e.jsxs("select",{value:fe.frequency,onChange:He=>ye({...fe,frequency:He.target.value}),className:"input",children:[e.jsx("option",{value:"term",children:"Term"}),e.jsx("option",{value:"session",children:"Session"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"one-time",children:"One-time"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Type"}),e.jsxs("select",{value:fe.is_optional,onChange:He=>ye({...fe,is_optional:He.target.value}),className:"input",children:[e.jsx("option",{value:"0",children:"Mandatory"}),e.jsx("option",{value:"1",children:"Optional"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>P(!1),className:"btn bg-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save"})]})]}),se==="rule"&&e.jsxs("form",{onSubmit:mt,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Fee Item *"}),e.jsxs("select",{required:!0,value:Ke.fee_item_id,onChange:He=>ve({...Ke,fee_item_id:He.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select Item"}),o.map(He=>e.jsx("option",{value:He.id,children:He.item_name},He.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Class"}),e.jsxs("select",{value:Ke.class_id||"",onChange:He=>ve({...Ke,class_id:He.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"All Classes"}),y.map(He=>e.jsx("option",{value:He.id,children:He.class_name},He.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Level (Education)"}),e.jsxs("select",{value:Ke.level,onChange:He=>ve({...Ke,level:He.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"All Levels"}),t.map(He=>e.jsx("option",{value:He.level_code,children:He.level_name},He.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Amount (GHS) *"}),e.jsx("input",{type:"number",step:"0.01",required:!0,value:Ke.amount,onChange:He=>ve({...Ke,amount:He.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Academic Year"}),e.jsx("select",{value:Ke.academic_year,onChange:He=>ve({...Ke,academic_year:He.target.value}),className:"input",children:le.map(He=>e.jsx("option",{value:He,children:He},He))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Term"}),e.jsxs("select",{value:Ke.term_id||"",onChange:He=>ve({...Ke,term_id:He.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"All Terms"}),U.map(He=>e.jsx("option",{value:He.id,children:He.term_name},He.id))]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>P(!1),className:"btn bg-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save"})]})]}),se==="plan"&&e.jsxs("form",{onSubmit:pt,className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Plan Name *"}),e.jsx("input",{type:"text",required:!0,value:ie.plan_name,onChange:He=>q({...ie,plan_name:He.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Plan Code *"}),e.jsx("input",{type:"text",required:!0,value:ie.plan_code,onChange:He=>q({...ie,plan_code:He.target.value}),className:"input"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description"}),e.jsx("textarea",{value:ie.description,onChange:He=>q({...ie,description:He.target.value}),className:"input",rows:"2"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Installments *"}),e.jsxs("div",{className:"space-y-3 border rounded-lg p-4 bg-gray-50",children:[ie.installments.map((He,Te)=>e.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end",children:[e.jsxs("div",{className:"col-span-3",children:[e.jsx("label",{className:"block text-xs mb-1",children:"Percentage"}),e.jsx("input",{type:"number",required:!0,min:"1",max:"100",value:He.percentage,onChange:bt=>{const Xt=[...ie.installments];Xt[Te].percentage=parseInt(bt.target.value)||0,q({...ie,installments:Xt})},className:"input text-sm"})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx("label",{className:"block text-xs mb-1",children:"Due Days"}),e.jsx("input",{type:"number",required:!0,min:"0",value:He.due_days,onChange:bt=>{const Xt=[...ie.installments];Xt[Te].due_days=parseInt(bt.target.value)||0,q({...ie,installments:Xt})},className:"input text-sm"})]}),e.jsxs("div",{className:"col-span-5",children:[e.jsx("label",{className:"block text-xs mb-1",children:"Label"}),e.jsx("input",{type:"text",required:!0,value:He.label,onChange:bt=>{const Xt=[...ie.installments];Xt[Te].label=bt.target.value,q({...ie,installments:Xt})},className:"input text-sm"})]}),e.jsx("div",{className:"col-span-1",children:ie.installments.length>1&&e.jsx("button",{type:"button",onClick:()=>{const bt=ie.installments.filter((Xt,ls)=>ls!==Te);q({...ie,installments:bt})},className:"btn bg-red-100 text-red-600 hover:bg-red-200 p-2",children:e.jsx(us,{className:"w-4 h-4"})})})]},Te)),e.jsxs("button",{type:"button",onClick:()=>{q({...ie,installments:[...ie.installments,{percentage:0,due_days:0,label:""}]})},className:"btn bg-blue-100 text-blue-600 hover:bg-blue-200 text-sm w-full",children:[e.jsx(qt,{className:"w-4 h-4 inline mr-1"})," Add Installment"]}),e.jsxs("p",{className:"text-xs text-gray-600 mt-2",children:["Total: ",ie.installments.reduce((He,Te)=>He+(Te.percentage||0),0),"% (must equal 100%)"]})]})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:ie.is_default==1,onChange:He=>q({...ie,is_default:He.target.checked?1:0}),className:"rounded"}),e.jsx("span",{className:"text-sm font-medium",children:"Set as Default Plan"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Status"}),e.jsxs("select",{value:ie.status,onChange:He=>q({...ie,status:He.target.value}),className:"input",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>P(!1),className:"btn bg-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save Plan"})]})]}),se==="discount"&&e.jsxs("form",{onSubmit:Je,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Discount Name *"}),e.jsx("input",{type:"text",required:!0,value:pe.name,onChange:He=>Me({...pe,name:He.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Code *"}),e.jsx("input",{type:"text",required:!0,value:pe.code,onChange:He=>Me({...pe,code:He.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Type"}),e.jsxs("select",{value:pe.type,onChange:He=>Me({...pe,type:He.target.value}),className:"input",children:[e.jsx("option",{value:"percentage",children:"Percentage"}),e.jsx("option",{value:"fixed",children:"Fixed Amount"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Value *"}),e.jsx("input",{type:"number",step:"0.01",required:!0,value:pe.value,onChange:He=>Me({...pe,value:He.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Applies To"}),e.jsxs("select",{value:pe.applies_to,onChange:He=>Me({...pe,applies_to:He.target.value}),className:"input",children:[e.jsx("option",{value:"all",children:"All Fees"}),e.jsx("option",{value:"tuition",children:"Tuition Only"}),e.jsx("option",{value:"specific",children:"Specific Item"}),e.jsx("option",{value:"sibling",children:"Sibling Discount"}),e.jsx("option",{value:"early_payment",children:"Early Payment"})]})]}),pe.applies_to==="specific"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Fee Item"}),e.jsxs("select",{value:pe.fee_item_id,onChange:He=>Me({...pe,fee_item_id:He.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select Item"}),o.map(He=>e.jsx("option",{value:He.id,children:He.item_name},He.id))]})]}),pe.applies_to==="sibling"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Min Siblings"}),e.jsx("input",{type:"number",min:"1",value:pe.min_siblings,onChange:He=>Me({...pe,min_siblings:He.target.value}),className:"input"})]}),pe.applies_to==="early_payment"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Days Before Due"}),e.jsx("input",{type:"number",min:"1",value:pe.early_payment_days,onChange:He=>Me({...pe,early_payment_days:He.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Status"}),e.jsxs("select",{value:pe.status,onChange:He=>Me({...pe,status:He.target.value}),className:"input",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>P(!1),className:"btn bg-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save Discount"})]})]})]})})]})}function B7(){const[t,s]=h.useState([]),[a,r]=h.useState(null),[l,c]=h.useState(!0),[o,m]=h.useState("all"),[u,x]=h.useState(!1),[A,g]=h.useState(null),[N,f]=h.useState(""),[y,v]=h.useState(""),[U,D]=h.useState(""),[M,K]=h.useState(""),[$,P]=h.useState(""),[se,z]=h.useState([]),[R,j]=h.useState([]),[T,Q]=h.useState([]),[E,te]=h.useState([]),[C,O]=h.useState(!1),[V,re]=h.useState(!1),[ge,xe]=h.useState(!1),[Z,I]=h.useState([]),[H,ae]=h.useState([]),[k,B]=h.useState([]),[w,oe]=h.useState(null),[ne,Fe]=h.useState({student_id:"",term_id:"",due_date:"",notes:"",items:[{fee_item_id:"",description:"",quantity:1,unit_price:0}]}),[je,Ge]=h.useState({amount:"",payment_method:"cash",reference:"",notes:""});h.useEffect(()=>{Xe(),ze()},[o,y,U,M,$]);const ze=async()=>{try{const[me,Ze,ct]=await Promise.all([Bi.getAll(),yl.getAll(),Ch.getAll()]);z(me.data.classes||[]),j(Ze.data.terms||[]),Q(ct.data.students||[]);try{const Yt=await F.get(`${ee}/fee_items.php`);te(Yt.data.fee_items||[])}catch{te([])}}catch(me){console.error("Error fetching base data:",me)}},Xe=async()=>{try{c(!0);const me={};o!=="all"&&(me.status=o),y&&(me.class_id=y),U&&(me.term_id=U);const[Ze,ct]=await Promise.all([jr.getInvoices(me),jr.getInvoiceStats()]);s(Ze.data.invoices||[]),r(ct.data.stats)}catch(me){console.error("Error fetching invoices:",me)}finally{c(!1)}},st=async me=>{try{const Ze=await jr.getInvoiceById(me.id);g(Ze.data.invoice),x(!0)}catch{alert("Error loading invoice details")}},ce=async()=>{if(window.confirm("Approve this invoice?"))try{await jr.approveInvoice(A.id,{approved_by:1}),x(!1),Xe(),alert("Invoice approved successfully!")}catch{alert("Error approving invoice")}},_e=async()=>{const me=prompt("Enter rejection reason:");if(me)try{await jr.rejectInvoice(A.id,{rejection_reason:me}),x(!1),Xe(),alert("Invoice rejected")}catch{alert("Error rejecting invoice")}},le=()=>{Fe({student_id:"",term_id:"",due_date:"",notes:"",items:[{fee_item_id:"",description:"",quantity:1,unit_price:0}]}),oe(null)},Pe=async me=>{me.preventDefault();try{const Ze={...ne,items:ne.items.filter(ct=>ct.description&&ct.unit_price>0)};w?(await F.put(`${ee}/finance.php?resource=invoices&id=${w.id}`,Ze),alert("Invoice updated!")):(await F.post(`${ee}/finance.php?resource=invoices`,Ze),alert("Invoice created!")),O(!1),le(),Xe()}catch(Ze){alert("Error saving invoice: "+(Ze.response?.data?.error||Ze.message))}},we=me=>{oe(me),Fe({student_id:me.student_id,term_id:me.term_id,due_date:me.due_date||"",notes:me.notes||"",items:me.items||[{fee_item_id:"",description:"",quantity:1,unit_price:0}]}),O(!0)},fe=async me=>{if(window.confirm("Delete this invoice?"))try{await F.delete(`${ee}/finance.php?resource=invoices&id=${me}`),Xe(),alert("Invoice deleted!")}catch{alert("Error deleting invoice")}},ye=me=>{oe(null),Fe({student_id:me.student_id,term_id:"",due_date:"",notes:me.notes||"",items:me.items?.map(Ze=>({...Ze,id:void 0}))||[]}),O(!0)},Ke=async me=>{me.preventDefault();try{await jr.recordPayment({invoice_id:A.id,...je}),re(!1),Ge({amount:"",payment_method:"cash",reference:"",notes:""}),st(A),Xe(),alert("Payment recorded!")}catch{alert("Error recording payment")}},ve=async()=>{if(Z.length===0){alert("Select invoices to approve");return}if(window.confirm(`Approve ${Z.length} invoices?`))try{for(const me of Z)await jr.approveInvoice(me,{approved_by:1});I([]),Xe(),alert("Invoices approved!")}catch{alert("Error approving invoices")}},ie=async()=>{if(Z.length===0){alert("Select invoices to reject");return}const me=prompt("Enter rejection reason:");if(me)try{for(const Ze of Z)await jr.rejectInvoice(Ze,{rejection_reason:me});I([]),Xe(),alert("Invoices rejected!")}catch{alert("Error rejecting invoices")}},q=()=>{if(!A)return;const me=window.open("","_blank");me.document.write(`
      <html><head><title>Invoice ${A.invoice_number}</title>
      <style>
        body { font-family: Arial; padding: 30px; }
        .header { border-bottom: 2px solid #333; padding-bottom: 20px; margin-bottom: 20px; }
        .invoice-number { font-size: 24px; font-weight: bold; }
        .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        th { background: #f5f5f5; }
        .total-row { font-weight: bold; background: #f5f5f5; }
        .amount { text-align: right; }
      </style></head><body>
      <div class="header">
        <div class="invoice-number">INVOICE #${A.invoice_number}</div>
        <div>Date: ${new Date().toLocaleDateString()}</div>
        <div>Status: ${A.status.replace("_"," ").toUpperCase()}</div>
      </div>
      <div class="info-grid">
        <div><strong>Student:</strong> ${A.first_name} ${A.last_name}<br>ID: ${A.student_id}</div>
        <div><strong>Class:</strong> ${A.class_name}<br><strong>Term:</strong> ${A.term_name}</div>
      </div>
      <table>
        <thead><tr><th>Description</th><th>Qty</th><th class="amount">Unit Price</th><th class="amount">Amount</th></tr></thead>
        <tbody>
          ${A.items?.map(Ze=>`<tr><td>${Ze.description}</td><td>${Ze.quantity}</td><td class="amount">GHS ${parseFloat(Ze.unit_price).toFixed(2)}</td><td class="amount">GHS ${parseFloat(Ze.amount).toFixed(2)}</td></tr>`).join("")}
        </tbody>
        <tfoot>
          <tr class="total-row"><td colspan="3" class="amount">Total:</td><td class="amount">GHS ${parseFloat(A.total_amount).toFixed(2)}</td></tr>
          <tr><td colspan="3" class="amount">Paid:</td><td class="amount">GHS ${parseFloat(A.paid_amount||0).toFixed(2)}</td></tr>
          <tr class="total-row"><td colspan="3" class="amount">Balance:</td><td class="amount">GHS ${parseFloat(A.balance||0).toFixed(2)}</td></tr>
        </tfoot>
      </table>
      </body></html>
    `),me.document.close(),me.print()},pe=async()=>{if(A&&window.confirm("Send invoice to parent email?"))try{await F.post(`${ee}/finance.php?action=email_invoice`,{invoice_id:A.id}),alert("Invoice sent to parent email!")}catch{alert("Error sending email")}},Me=async me=>{if(window.confirm("Send payment reminder?"))try{await F.post(`${ee}/finance.php?action=send_reminder`,{invoice_id:me}),alert("Reminder sent!")}catch{alert("Error sending reminder")}},Se=async()=>{if(window.confirm("Void this invoice? This cannot be undone."))try{await F.put(`${ee}/finance.php?resource=invoices&id=${A.id}&action=void`),x(!1),Xe(),alert("Invoice voided!")}catch{alert("Error voiding invoice")}},Ne=async me=>{try{const Ze=await F.get(`${ee}/finance.php?action=invoice_history&invoice_id=${me}`);ae(Ze.data.history||[]);const ct=await F.get(`${ee}/finance.php?resource=payments&invoice_id=${me}`);B(ct.data.payments||[]),xe(!0)}catch(Ze){console.error("Error fetching history:",Ze)}},et=()=>{const me=[["Invoice #","Student","Class","Term","Total","Paid","Balance","Status","Due Date"],...kt.map(be=>[be.invoice_number,`${be.first_name} ${be.last_name}`,be.class_name,be.term_name,be.total_amount,be.paid_amount,be.balance,be.status,be.due_date||""])].map(be=>be.join(",")).join(`
`),Ze=new Blob([me],{type:"text/csv"}),ct=URL.createObjectURL(Ze),Yt=document.createElement("a");Yt.href=ct,Yt.download=`invoices_${new Date().toISOString().split("T")[0]}.csv`,Yt.click()},Ce=()=>{Fe({...ne,items:[...ne.items,{fee_item_id:"",description:"",quantity:1,unit_price:0}]})},ft=me=>{Fe({...ne,items:ne.items.filter((Ze,ct)=>ct!==me)})},qe=(me,Ze,ct)=>{const Yt=[...ne.items];if(Yt[me][Ze]=ct,Ze==="fee_item_id"&&ct){const be=E.find(lt=>lt.id==ct);be&&(Yt[me].description=be.item_name,Yt[me].unit_price=be.amount||0)}Fe({...ne,items:Yt})},W=()=>ne.items.reduce((me,Ze)=>me+Ze.quantity*Ze.unit_price,0),Ie=me=>!me.due_date||me.status==="paid"?!1:new Date(me.due_date)<new Date,mt=me=>{I(Ze=>Ze.includes(me)?Ze.filter(ct=>ct!==me):[...Ze,me])},pt=()=>{const me=kt.filter(Ze=>Ze.status==="pending_finance").map(Ze=>Ze.id);Z.length===me.length?I([]):I(me)},kt=t.filter(me=>{const Ze=!N||me.invoice_number?.toLowerCase().includes(N.toLowerCase())||`${me.first_name} ${me.last_name}`.toLowerCase().includes(N.toLowerCase())||me.student_id?.toLowerCase().includes(N.toLowerCase()),ct=(!M||me.created_at>=M)&&(!$||me.created_at<=$);return Ze&&ct}),J=me=>new Intl.NumberFormat("en-GH",{style:"currency",currency:"GHS"}).format(me||0),Je=me=>({draft:"bg-gray-100 text-gray-700",pending_finance:"bg-orange-100 text-orange-700",approved:"bg-teal-100 text-teal-700",rejected:"bg-red-100 text-red-700",partial:"bg-blue-100 text-blue-700",paid:"bg-green-100 text-green-700"})[me]||"bg-gray-100 text-gray-700",_t=[{label:"Total Invoices",value:a?.total_invoices||0,color:"bg-blue-500",icon:Kt},{label:"Pending",value:a?.pending||0,color:"bg-orange-500",icon:Wt},{label:"Approved",value:a?.approved||0,color:"bg-teal-500",icon:Mt},{label:"Paid",value:a?.paid||0,color:"bg-green-500",icon:vs}],$t=kt.filter(me=>Ie(me)).length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Invoice Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Create, review, and manage student invoices"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:et,className:"btn bg-green-600 text-white hover:bg-green-700 flex items-center gap-2",children:[e.jsx(xs,{className:"w-4 h-4"})," Export"]}),e.jsxs("button",{onClick:()=>{le(),O(!0)},className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4"})," Create Invoice"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[_t.map((me,Ze)=>e.jsx("div",{className:"card p-5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm mb-1",children:me.label}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:me.value})]}),e.jsx("div",{className:`${me.color} w-10 h-10 rounded-lg flex items-center justify-center`,children:e.jsx(me.icon,{className:"w-5 h-5 text-white"})})]})},Ze)),$t>0&&e.jsx("div",{className:"card p-5 bg-red-50 border-red-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-red-600 text-sm mb-1",children:"Overdue"}),e.jsx("p",{className:"text-2xl font-bold text-red-700",children:$t})]}),e.jsx("div",{className:"bg-red-500 w-10 h-10 rounded-lg flex items-center justify-center",children:e.jsx(_s,{className:"w-5 h-5 text-white"})})]})})]}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search invoices...",value:N,onChange:me=>f(me.target.value),className:"input pl-10 w-full"})]}),e.jsxs("select",{value:y,onChange:me=>v(me.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Classes"}),se.map(me=>e.jsx("option",{value:me.id,children:me.class_name},me.id))]}),e.jsxs("select",{value:U,onChange:me=>D(me.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Terms"}),R.map(me=>e.jsx("option",{value:me.id,children:me.term_name},me.id))]}),e.jsx("input",{type:"date",value:M,onChange:me=>K(me.target.value),className:"input w-auto",placeholder:"From"}),e.jsx("input",{type:"date",value:$,onChange:me=>P(me.target.value),className:"input w-auto",placeholder:"To"}),e.jsx("button",{onClick:Xe,className:"btn bg-gray-100 hover:bg-gray-200",children:e.jsx(Ns,{className:"w-4 h-4"})})]})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[["all","pending_finance","approved","partial","paid","rejected"].map(me=>e.jsx("button",{onClick:()=>m(me),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${o===me?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:me==="all"?"All":me.replace("_"," ").replace(/\b\w/g,Ze=>Ze.toUpperCase())},me)),Z.length>0&&e.jsxs("div",{className:"ml-auto flex gap-2",children:[e.jsxs("span",{className:"text-sm text-gray-600 self-center",children:[Z.length," selected"]}),e.jsxs("button",{onClick:ve,className:"btn bg-green-600 text-white hover:bg-green-700 text-sm",children:[e.jsx(Mt,{className:"w-4 h-4 mr-1"})," Approve All"]}),e.jsxs("button",{onClick:ie,className:"btn bg-red-600 text-white hover:bg-red-700 text-sm",children:[e.jsx(Js,{className:"w-4 h-4 mr-1"})," Reject All"]})]})]}),e.jsx("div",{className:"card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left",children:e.jsx("input",{type:"checkbox",onChange:pt,checked:Z.length>0&&Z.length===kt.filter(me=>me.status==="pending_finance").length,className:"rounded"})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Invoice #"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Student"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Class"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Term"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Balance"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Due Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:l?e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"px-4 py-12 text-center text-gray-500",children:"Loading..."})}):kt.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"px-4 py-12 text-center text-gray-500",children:"No invoices found"})}):kt.map(me=>e.jsxs("tr",{className:`hover:bg-gray-50 ${Ie(me)?"bg-red-50":""}`,children:[e.jsx("td",{className:"px-4 py-3",children:me.status==="pending_finance"&&e.jsx("input",{type:"checkbox",checked:Z.includes(me.id),onChange:()=>mt(me.id),className:"rounded"})}),e.jsx("td",{className:"px-4 py-3 font-mono text-sm",children:me.invoice_number}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900 text-sm",children:[me.first_name," ",me.last_name]}),e.jsx("p",{className:"text-xs text-gray-500",children:me.student_id})]})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:me.class_name}),e.jsx("td",{className:"px-4 py-3 text-sm",children:me.term_name}),e.jsx("td",{className:"px-4 py-3 font-semibold text-sm",children:J(me.total_amount)}),e.jsx("td",{className:"px-4 py-3 font-semibold text-sm",children:J(me.balance)}),e.jsx("td",{className:"px-4 py-3 text-sm",children:me.due_date?e.jsxs("span",{className:Ie(me)?"text-red-600 font-medium":"",children:[me.due_date,Ie(me)&&e.jsx(_s,{className:"w-3 h-3 inline ml-1"})]}):"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${Je(me.status)}`,children:me.status.replace("_"," ")})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>st(me),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",title:"View",children:e.jsx(na,{className:"w-4 h-4"})}),me.status==="draft"&&e.jsx("button",{onClick:()=>we(me),className:"p-1.5 text-green-600 hover:bg-green-50 rounded",title:"Edit",children:e.jsx(Na,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ye(me),className:"p-1.5 text-purple-600 hover:bg-purple-50 rounded",title:"Duplicate",children:e.jsx(vl,{className:"w-4 h-4"})}),me.balance>0&&me.status!=="rejected"&&e.jsx("button",{onClick:()=>Me(me.id),className:"p-1.5 text-orange-600 hover:bg-orange-50 rounded",title:"Send Reminder",children:e.jsx(va,{className:"w-4 h-4"})}),me.status==="draft"&&e.jsx("button",{onClick:()=>fe(me.id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:e.jsx(us,{className:"w-4 h-4"})})]})})]},me.id))})]})})}),u&&A&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between sticky top-0 bg-white z-10",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Invoice Details"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:q,className:"p-2 text-gray-600 hover:bg-gray-100 rounded",title:"Print",children:e.jsx(or,{className:"w-5 h-5"})}),e.jsx("button",{onClick:pe,className:"p-2 text-gray-600 hover:bg-gray-100 rounded",title:"Email",children:e.jsx(ra,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>Ne(A.id),className:"p-2 text-gray-600 hover:bg-gray-100 rounded",title:"History",children:e.jsx(Sa,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>x(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Invoice Number"}),e.jsx("p",{className:"font-mono font-semibold text-lg",children:A.invoice_number})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Status"}),e.jsx("span",{className:`px-3 py-1 text-sm font-medium rounded-full ${Je(A.status)}`,children:A.status.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Due Date"}),e.jsxs("p",{className:`font-medium ${Ie(A)?"text-red-600":""}`,children:[A.due_date||"Not set",Ie(A)&&e.jsx("span",{className:"text-xs ml-2",children:"(Overdue)"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Student"}),e.jsxs("p",{className:"font-medium",children:[A.first_name," ",A.last_name]}),e.jsx("p",{className:"text-sm text-gray-500",children:A.student_id})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Parent"}),e.jsx("p",{className:"font-medium",children:A.parent_name||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Class / Term"}),e.jsxs("p",{className:"font-medium",children:[A.class_name,"  ",A.term_name]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Invoice Items"}),e.jsxs("table",{className:"w-full border rounded-lg overflow-hidden",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Description"}),e.jsx("th",{className:"px-4 py-2 text-right text-sm",children:"Qty"}),e.jsx("th",{className:"px-4 py-2 text-right text-sm",children:"Unit Price"}),e.jsx("th",{className:"px-4 py-2 text-right text-sm",children:"Amount"})]})}),e.jsx("tbody",{className:"divide-y",children:A.items?.map((me,Ze)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2",children:me.description}),e.jsx("td",{className:"px-4 py-2 text-right",children:me.quantity}),e.jsx("td",{className:"px-4 py-2 text-right",children:J(me.unit_price)}),e.jsx("td",{className:"px-4 py-2 text-right font-semibold",children:J(me.amount)})]},Ze))}),e.jsxs("tfoot",{className:"bg-gray-50 font-semibold",children:[e.jsxs("tr",{children:[e.jsx("td",{colSpan:"3",className:"px-4 py-2 text-right",children:"Total:"}),e.jsx("td",{className:"px-4 py-2 text-right",children:J(A.total_amount)})]}),e.jsxs("tr",{children:[e.jsx("td",{colSpan:"3",className:"px-4 py-2 text-right text-green-600",children:"Paid:"}),e.jsx("td",{className:"px-4 py-2 text-right text-green-600",children:J(A.paid_amount)})]}),e.jsxs("tr",{className:"text-lg",children:[e.jsx("td",{colSpan:"3",className:"px-4 py-2 text-right",children:"Balance Due:"}),e.jsx("td",{className:"px-4 py-2 text-right text-blue-600",children:J(A.balance)})]})]})]})]}),A.notes&&e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Notes"}),e.jsx("p",{className:"text-sm text-gray-600",children:A.notes})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 pt-4 border-t",children:[e.jsxs("div",{className:"flex gap-2",children:[A.balance>0&&A.status!=="rejected"&&e.jsxs("button",{onClick:()=>{Ge({amount:A.balance,payment_method:"cash",reference:"",notes:""}),re(!0)},className:"btn bg-green-600 text-white hover:bg-green-700 flex items-center gap-2",children:[e.jsx(aa,{className:"w-4 h-4"})," Record Payment"]}),A.status==="approved"&&e.jsxs("button",{onClick:Se,className:"btn bg-gray-600 text-white hover:bg-gray-700 flex items-center gap-2",children:[e.jsx(Js,{className:"w-4 h-4"})," Void Invoice"]})]}),A.status==="pending_finance"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:_e,className:"btn bg-red-600 text-white hover:bg-red-700 flex items-center gap-2",children:[e.jsx(Js,{className:"w-5 h-5"})," Reject"]}),e.jsxs("button",{onClick:ce,className:"btn btn-primary flex items-center gap-2",children:[e.jsx(Mt,{className:"w-5 h-5"})," Approve Invoice"]})]})]})]})]})}),C&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between sticky top-0 bg-white z-10",children:[e.jsx("h2",{className:"text-xl font-semibold",children:w?"Edit Invoice":"Create Invoice"}),e.jsx("button",{onClick:()=>{O(!1),le()},children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:Pe,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Student *"}),e.jsxs("select",{required:!0,value:ne.student_id,onChange:me=>Fe({...ne,student_id:me.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select Student"}),T.map(me=>e.jsxs("option",{value:me.id,children:[me.first_name," ",me.last_name," (",me.student_id,")"]},me.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Term *"}),e.jsxs("select",{required:!0,value:ne.term_id,onChange:me=>Fe({...ne,term_id:me.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select Term"}),R.map(me=>e.jsx("option",{value:me.id,children:me.term_name},me.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Due Date"}),e.jsx("input",{type:"date",value:ne.due_date,onChange:me=>Fe({...ne,due_date:me.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Notes"}),e.jsx("input",{type:"text",value:ne.notes,onChange:me=>Fe({...ne,notes:me.target.value}),className:"input",placeholder:"Optional notes"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Invoice Items *"}),e.jsxs("button",{type:"button",onClick:Ce,className:"text-sm text-blue-600 hover:underline flex items-center gap-1",children:[e.jsx(qt,{className:"w-4 h-4"})," Add Item"]})]}),e.jsxs("div",{className:"space-y-2 border rounded-lg p-4 bg-gray-50",children:[ne.items.map((me,Ze)=>e.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end",children:[e.jsx("div",{className:"col-span-4",children:e.jsxs("select",{value:me.fee_item_id,onChange:ct=>qe(Ze,"fee_item_id",ct.target.value),className:"input text-sm",children:[e.jsx("option",{value:"",children:"Select Fee Item"}),E.map(ct=>e.jsx("option",{value:ct.id,children:ct.item_name},ct.id))]})}),e.jsx("div",{className:"col-span-3",children:e.jsx("input",{type:"text",placeholder:"Description",value:me.description,onChange:ct=>qe(Ze,"description",ct.target.value),className:"input text-sm"})}),e.jsx("div",{className:"col-span-2",children:e.jsx("input",{type:"number",min:"1",placeholder:"Qty",value:me.quantity,onChange:ct=>qe(Ze,"quantity",parseInt(ct.target.value)||1),className:"input text-sm"})}),e.jsx("div",{className:"col-span-2",children:e.jsx("input",{type:"number",step:"0.01",placeholder:"Price",value:me.unit_price,onChange:ct=>qe(Ze,"unit_price",parseFloat(ct.target.value)||0),className:"input text-sm"})}),e.jsx("div",{className:"col-span-1",children:ne.items.length>1&&e.jsx("button",{type:"button",onClick:()=>ft(Ze),className:"p-2 text-red-600 hover:bg-red-50 rounded",children:e.jsx(us,{className:"w-4 h-4"})})})]},Ze)),e.jsx("div",{className:"text-right pt-2 border-t mt-2",children:e.jsxs("span",{className:"font-semibold",children:["Total: ",J(W())]})})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>{O(!1),le()},className:"btn bg-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:w?"Update Invoice":"Create Invoice"})]})]})]})}),V&&A&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Record Payment"}),e.jsx("button",{onClick:()=>re(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["Invoice: ",A.invoice_number,"  Balance: ",J(A.balance)]}),e.jsxs("form",{onSubmit:Ke,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Amount (GHS) *"}),e.jsx("input",{type:"number",step:"0.01",required:!0,max:A.balance,value:je.amount,onChange:me=>Ge({...je,amount:me.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Payment Method"}),e.jsxs("select",{value:je.payment_method,onChange:me=>Ge({...je,payment_method:me.target.value}),className:"input",children:[e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),e.jsx("option",{value:"mobile_money",children:"Mobile Money"}),e.jsx("option",{value:"cheque",children:"Cheque"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Reference"}),e.jsx("input",{type:"text",value:je.reference,onChange:me=>Ge({...je,reference:me.target.value}),className:"input",placeholder:"Transaction reference"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Notes"}),e.jsx("textarea",{value:je.notes,onChange:me=>Ge({...je,notes:me.target.value}),className:"input",rows:"2"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>re(!1),className:"btn bg-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Record Payment"})]})]})]})}),ge&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between sticky top-0 bg-white",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Invoice History"}),e.jsx("button",{onClick:()=>xe(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(aa,{className:"w-5 h-5"})," Payment History"]}),k.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No payments recorded"}):e.jsx("div",{className:"space-y-2",children:k.map((me,Ze)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:J(me.amount)}),e.jsxs("p",{className:"text-sm text-gray-500",children:[me.payment_method,"  ",me.payment_date]})]}),e.jsx("span",{className:"text-xs text-gray-500",children:me.reference||"-"})]},Ze))})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(Sa,{className:"w-5 h-5"})," Status Changes"]}),H.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No history available"}):e.jsx("div",{className:"space-y-2",children:H.map((me,Ze)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:me.action}),e.jsx("p",{className:"text-sm text-gray-500",children:me.created_at})]}),e.jsx("span",{className:"text-xs text-gray-500",children:me.user_name||"System"})]},Ze))})]})]})]})})]})}function F7(){const[t,s]=h.useState([]),[a,r]=h.useState([]),[l,c]=h.useState(!0),[o,m]=h.useState(!1),[u,x]=h.useState({invoice_id:"",student_id:"",parent_id:"",amount:"",payment_method:"cash",payment_date:new Date().toISOString().split("T")[0],reference_number:"",notes:""}),[A,g]=h.useState(""),[N,f]=h.useState(""),[y,v]=h.useState(""),[U,D]=h.useState(""),[M,K]=h.useState(""),[$,P]=h.useState(""),[se,z]=h.useState(""),[R,j]=h.useState([]),[T,Q]=h.useState([]),[E,te]=h.useState(!1),[C,O]=h.useState(!1),[V,re]=h.useState(!1),[ge,xe]=h.useState(!1),[Z,I]=h.useState(!1),[H,ae]=h.useState(!1),[k,B]=h.useState(null),[w,oe]=h.useState(null),[ne,Fe]=h.useState("list"),[je,Ge]=h.useState([]),[ze,Xe]=h.useState(""),[st,ce]=h.useState(""),[_e,le]=h.useState(""),[Pe,we]=h.useState([{invoice_id:"",amount:""}]);h.useEffect(()=>{ye(),fe()},[N,U,M]);const fe=async()=>{try{const[be,lt]=await Promise.all([Bi.getAll(),yl.getAll()]);j(be.data.classes||[]),Q(lt.data.terms||[]);try{const Ue=await F.get(`${ee}/finance.php?action=daily_payments&days=7`);Ge(Ue.data.daily_stats||[])}catch(Ue){console.error("Error fetching daily stats:",Ue)}}catch(be){console.error("Error fetching base data:",be)}},ye=async()=>{try{c(!0);const be={};N&&(be.payment_method=N),U&&(be.class_id=U),M&&(be.term_id=M);const[lt,Ue]=await Promise.all([jr.getPayments(be),jr.getInvoices()]);s(lt.data.payments||[]);const Ct=(Ue.data.invoices||[]).filter(Et=>(Et.status==="approved"||Et.status==="pending_payment"||Et.status==="partial")&&parseFloat(Et.balance||0)>0);r(Ct)}catch(be){console.error("Error fetching data:",be)}finally{c(!1)}},Ke=be=>{const lt=be.target.value,Ue=a.find(Ct=>Ct.id==lt);Ue&&x({...u,invoice_id:lt,student_id:Ue.student_id,parent_id:Ue.parent_id,amount:Ue.balance})},ve=async be=>{be.preventDefault();try{await jr.createPayment(u),m(!1),ye(),alert("Payment recorded successfully!"),ie()}catch(lt){alert("Error recording payment: "+(lt.response?.data?.error||lt.message))}},ie=()=>{x({invoice_id:"",student_id:"",parent_id:"",amount:"",payment_method:"cash",payment_date:new Date().toISOString().split("T")[0],reference_number:"",notes:""})},q=be=>{B(be),te(!0)},pe=()=>{if(!k)return;const be=window.open("","_blank");be.document.write(`
      <html><head><title>Payment Receipt #${k.payment_number}</title>
      <style>
        body { font-family: Arial; padding: 40px; max-width: 400px; margin: 0 auto; }
        .header { text-align: center; border-bottom: 2px solid #333; padding-bottom: 20px; margin-bottom: 20px; }
        .receipt-number { font-size: 18px; font-weight: bold; margin-top: 10px; }
        .row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px dashed #ddd; }
        .label { color: #666; }
        .value { font-weight: bold; }
        .total { font-size: 24px; text-align: center; margin: 20px 0; padding: 15px; background: #f5f5f5; }
        .footer { text-align: center; margin-top: 30px; font-size: 12px; color: #666; }
      </style></head><body>
      <div class="header">
        <h2>PAYMENT RECEIPT</h2>
        <div class="receipt-number">#${k.payment_number}</div>
      </div>
      <div class="row"><span class="label">Date:</span><span class="value">${new Date(k.payment_date).toLocaleDateString()}</span></div>
      <div class="row"><span class="label">Student:</span><span class="value">${k.first_name} ${k.last_name}</span></div>
      <div class="row"><span class="label">Student ID:</span><span class="value">${k.student_id}</span></div>
      <div class="row"><span class="label">Invoice:</span><span class="value">${k.invoice_number}</span></div>
      <div class="row"><span class="label">Method:</span><span class="value">${k.payment_method.replace("_"," ").toUpperCase()}</span></div>
      <div class="row"><span class="label">Reference:</span><span class="value">${k.reference_number||"-"}</span></div>
      <div class="total">Amount Paid: GHS ${parseFloat(k.amount).toFixed(2)}</div>
      <div class="footer">Thank you for your payment!<br>This is a computer-generated receipt.</div>
      </body></html>
    `),be.document.close(),be.print()},Me=async()=>{if(k&&window.confirm("Send receipt to parent email?"))try{await F.post(`${ee}/finance.php?action=email_receipt`,{payment_id:k.id}),alert("Receipt sent successfully!")}catch{alert("Error sending receipt")}},Se=be=>{oe(be),x({invoice_id:be.invoice_id,student_id:be.student_id,parent_id:be.parent_id,amount:be.amount,payment_method:be.payment_method,payment_date:be.payment_date,reference_number:be.reference_number||"",notes:be.notes||""}),O(!0)},Ne=async be=>{be.preventDefault();try{await F.put(`${ee}/finance.php?resource=payments&id=${w.id}`,u),O(!1),oe(null),ie(),ye(),alert("Payment updated!")}catch{alert("Error updating payment")}},et=async()=>{if(!_e.trim()){alert("Please enter a reason for voiding");return}try{await F.post(`${ee}/finance.php?action=void_payment`,{payment_id:k.id,reason:_e}),re(!1),le(""),B(null),ye(),alert("Payment voided!")}catch{alert("Error voiding payment")}},Ce=async()=>{if(!ze||parseFloat(ze)<=0){alert("Please enter a valid refund amount");return}if(parseFloat(ze)>parseFloat(k.amount)){alert("Refund amount cannot exceed payment amount");return}try{await F.post(`${ee}/finance.php?action=refund_payment`,{payment_id:k.id,amount:ze,reason:st}),xe(!1),Xe(""),ce(""),B(null),ye(),alert("Refund processed!")}catch{alert("Error processing refund")}},ft=async be=>{be.preventDefault();const lt=Pe.filter(Ue=>Ue.invoice_id&&Ue.amount>0);if(lt.length===0){alert("Please add at least one valid payment");return}try{for(const Ue of lt){const Ct=a.find(Et=>Et.id==Ue.invoice_id);await jr.createPayment({invoice_id:Ue.invoice_id,student_id:Ct?.student_id,amount:Ue.amount,payment_method:"cash",payment_date:new Date().toISOString().split("T")[0]})}I(!1),we([{invoice_id:"",amount:""}]),ye(),alert(`${lt.length} payments recorded!`)}catch{alert("Error recording bulk payments")}},qe=()=>{we([...Pe,{invoice_id:"",amount:""}])},W=(be,lt,Ue)=>{const Ct=[...Pe];if(Ct[be][lt]=Ue,lt==="invoice_id"&&Ue){const Et=a.find(Rs=>Rs.id==Ue);Et&&(Ct[be].amount=Et.balance)}we(Ct)},Ie=be=>{we(Pe.filter((lt,Ue)=>Ue!==be))},mt=()=>{const be=[["Payment #","Date","Invoice #","Student","Amount","Method","Reference","Status"],...kt.map(Et=>[Et.payment_number,Et.payment_date,Et.invoice_number,`${Et.first_name} ${Et.last_name}`,Et.amount,Et.payment_method,Et.reference_number||"",Et.status])].map(Et=>Et.join(",")).join(`
`),lt=new Blob([be],{type:"text/csv"}),Ue=URL.createObjectURL(lt),Ct=document.createElement("a");Ct.href=Ue,Ct.download=`payments_${new Date().toISOString().split("T")[0]}.csv`,Ct.click()},pt=()=>{const be=new Date().toISOString().split("T")[0],lt=t.filter(Ct=>Ct.payment_date===be),Ue={};return lt.forEach(Ct=>{Ue[Ct.payment_method]=(Ue[Ct.payment_method]||0)+parseFloat(Ct.amount)}),{todayPayments:lt,byMethod:Ue,total:lt.reduce((Ct,Et)=>Ct+parseFloat(Et.amount),0)}},kt=t.filter(be=>{const lt=!A||be.payment_number?.toLowerCase().includes(A.toLowerCase())||`${be.first_name} ${be.last_name}`.toLowerCase().includes(A.toLowerCase())||be.reference_number?.toLowerCase().includes(A.toLowerCase())||be.invoice_number?.toLowerCase().includes(A.toLowerCase()),Ue=!y||be.status===y,Ct=(!$||be.payment_date>=$)&&(!se||be.payment_date<=se);return lt&&Ue&&Ct}),J=be=>new Intl.NumberFormat("en-GH",{style:"currency",currency:"GHS"}).format(be||0),Je=be=>({cash:"bg-green-100 text-green-700",bank_transfer:"bg-blue-100 text-blue-700",mobile_money:"bg-purple-100 text-purple-700",cheque:"bg-orange-100 text-orange-700",card:"bg-pink-100 text-pink-700"})[be]||"bg-gray-100 text-gray-700",_t=kt.reduce((be,lt)=>be+parseFloat(lt.amount||0),0),$t=new Date().toISOString().split("T")[0],me=t.filter(be=>be.payment_date===$t),Ze=me.reduce((be,lt)=>be+parseFloat(lt.amount||0),0),ct=a.length,Yt=["cash","bank_transfer","mobile_money","cheque","card"];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Payment Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Record, track, and manage student payments"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>ae(!0),className:"btn bg-purple-600 text-white hover:bg-purple-700 flex items-center gap-2",children:[e.jsx(Kt,{className:"w-4 h-4"})," Daily Report"]}),e.jsxs("button",{onClick:mt,className:"btn bg-green-600 text-white hover:bg-green-700 flex items-center gap-2",children:[e.jsx(xs,{className:"w-4 h-4"})," Export"]}),e.jsxs("button",{onClick:()=>I(!0),className:"btn bg-orange-600 text-white hover:bg-orange-700 flex items-center gap-2",children:[e.jsx(Rt,{className:"w-4 h-4"})," Bulk Payment"]}),e.jsxs("button",{onClick:()=>m(!0),className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4"})," Record Payment"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"card p-5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm mb-1",children:"Total Payments"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:kt.length})]}),e.jsx("div",{className:"bg-blue-500 w-10 h-10 rounded-lg flex items-center justify-center",children:e.jsx(aa,{className:"w-5 h-5 text-white"})})]})}),e.jsx("div",{className:"card p-5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm mb-1",children:"Total Amount"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:J(_t)})]}),e.jsx("div",{className:"bg-green-500 w-10 h-10 rounded-lg flex items-center justify-center",children:e.jsx(vs,{className:"w-5 h-5 text-white"})})]})}),e.jsx("div",{className:"card p-5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm mb-1",children:"Today's Payments"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:me.length})]}),e.jsx("div",{className:"bg-purple-500 w-10 h-10 rounded-lg flex items-center justify-center",children:e.jsx(Wt,{className:"w-5 h-5 text-white"})})]})}),e.jsx("div",{className:"card p-5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm mb-1",children:"Today's Total"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:J(Ze)})]}),e.jsx("div",{className:"bg-orange-500 w-10 h-10 rounded-lg flex items-center justify-center",children:e.jsx($s,{className:"w-5 h-5 text-white"})})]})}),e.jsx("div",{className:"card p-5 bg-yellow-50 border-yellow-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-yellow-700 text-sm mb-1",children:"Pending Invoices"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-800",children:ct})]}),e.jsx("div",{className:"bg-yellow-500 w-10 h-10 rounded-lg flex items-center justify-center",children:e.jsx(_s,{className:"w-5 h-5 text-white"})})]})})]}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search payments...",value:A,onChange:be=>g(be.target.value),className:"input pl-10 w-full"})]}),e.jsxs("select",{value:N,onChange:be=>f(be.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Methods"}),Yt.map(be=>e.jsx("option",{value:be,children:be.replace("_"," ").replace(/\b\w/g,lt=>lt.toUpperCase())},be))]}),e.jsxs("select",{value:y,onChange:be=>v(be.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"voided",children:"Voided"}),e.jsx("option",{value:"refunded",children:"Refunded"})]}),e.jsxs("select",{value:U,onChange:be=>D(be.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Classes"}),R.map(be=>e.jsx("option",{value:be.id,children:be.class_name},be.id))]}),e.jsx("input",{type:"date",value:$,onChange:be=>P(be.target.value),className:"input w-auto"}),e.jsx("input",{type:"date",value:se,onChange:be=>z(be.target.value),className:"input w-auto"}),e.jsx("button",{onClick:ye,className:"btn bg-gray-100 hover:bg-gray-200",children:e.jsx(Ns,{className:"w-4 h-4"})})]})}),e.jsx("div",{className:"card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Payment #"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Invoice #"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Student"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Method"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Reference"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:l?e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"px-4 py-12 text-center text-gray-500",children:"Loading..."})}):kt.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"px-4 py-12 text-center text-gray-500",children:"No payments found"})}):kt.map(be=>e.jsxs("tr",{className:`hover:bg-gray-50 ${be.status==="voided"?"bg-red-50 opacity-60":""}`,children:[e.jsx("td",{className:"px-4 py-3 font-mono text-sm",children:be.payment_number}),e.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(be.payment_date).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 font-mono text-sm",children:be.invoice_number}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900 text-sm",children:[be.first_name," ",be.last_name]}),e.jsx("p",{className:"text-xs text-gray-500",children:be.student_id})]})}),e.jsx("td",{className:"px-4 py-3 font-semibold text-green-600",children:J(be.amount)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${Je(be.payment_method)}`,children:be.payment_method.replace("_"," ")})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:be.reference_number||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${be.status==="completed"?"bg-green-100 text-green-700":be.status==="voided"?"bg-red-100 text-red-700":be.status==="refunded"?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-700"}`,children:be.status})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>q(be),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",title:"View Receipt",children:e.jsx(na,{className:"w-4 h-4"})}),be.status==="completed"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>Se(be),className:"p-1.5 text-green-600 hover:bg-green-50 rounded",title:"Edit",children:e.jsx(Na,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{B(be),re(!0)},className:"p-1.5 text-red-600 hover:bg-red-50 rounded",title:"Void",children:e.jsx(Js,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{B(be),Xe(be.amount),xe(!0)},className:"p-1.5 text-orange-600 hover:bg-orange-50 rounded",title:"Refund",children:e.jsx(Li,{className:"w-4 h-4"})})]})]})})]},be.id))})]})})}),o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Record Payment"}),e.jsx("button",{onClick:()=>m(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:ve,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Invoice *"}),e.jsxs("select",{required:!0,value:u.invoice_id,onChange:Ke,className:"input",children:[e.jsx("option",{value:"",children:a.length===0?"No unpaid invoices available":"Select an invoice"}),a.map(be=>e.jsxs("option",{value:be.id,children:[be.invoice_number," - ",be.student_name||`${be.first_name} ${be.last_name}`," - Balance: ",J(be.balance)]},be.id))]}),a.length===0&&e.jsx("p",{className:"text-sm text-orange-600 mt-2",children:"No invoices available for payment. Please ensure invoices are approved in the Finance section."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount (GHS) *"}),e.jsx("input",{type:"number",step:"0.01",required:!0,value:u.amount,onChange:be=>x({...u,amount:be.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Date *"}),e.jsx("input",{type:"date",required:!0,value:u.payment_date,onChange:be=>x({...u,payment_date:be.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Method *"}),e.jsxs("select",{required:!0,value:u.payment_method,onChange:be=>x({...u,payment_method:be.target.value}),className:"input",children:[e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),e.jsx("option",{value:"mobile_money",children:"Mobile Money"}),e.jsx("option",{value:"cheque",children:"Cheque"}),e.jsx("option",{value:"card",children:"Card"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reference Number"}),e.jsx("input",{type:"text",value:u.reference_number,onChange:be=>x({...u,reference_number:be.target.value}),className:"input",placeholder:"Transaction reference"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),e.jsx("textarea",{value:u.notes,onChange:be=>x({...u,notes:be.target.value}),className:"input",rows:"3",placeholder:"Additional notes..."})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>m(!1),className:"btn bg-gray-200 text-gray-700 hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Record Payment"})]})]})]})}),E&&k&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Payment Receipt"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:pe,className:"p-2 text-gray-600 hover:bg-gray-100 rounded",title:"Print",children:e.jsx(or,{className:"w-5 h-5"})}),e.jsx("button",{onClick:Me,className:"p-2 text-gray-600 hover:bg-gray-100 rounded",title:"Email",children:e.jsx(ra,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>te(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"text-center border-b pb-4",children:[e.jsx("h3",{className:"text-lg font-bold",children:"PAYMENT RECEIPT"}),e.jsxs("p",{className:"text-2xl font-mono font-bold text-blue-600 mt-2",children:["#",k.payment_number]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Date:"}),e.jsx("span",{className:"font-medium",children:new Date(k.payment_date).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Student:"}),e.jsxs("span",{className:"font-medium",children:[k.first_name," ",k.last_name]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Student ID:"}),e.jsx("span",{className:"font-medium",children:k.student_id})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Invoice:"}),e.jsx("span",{className:"font-medium",children:k.invoice_number})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Method:"}),e.jsx("span",{className:"font-medium capitalize",children:k.payment_method.replace("_"," ")})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Reference:"}),e.jsx("span",{className:"font-medium",children:k.reference_number||"-"})]})]}),e.jsxs("div",{className:"text-center bg-green-50 p-4 rounded-lg mt-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Amount Paid"}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:J(k.amount)})]}),e.jsx("p",{className:"text-center text-xs text-gray-500 mt-4",children:"Thank you for your payment!"})]})]})}),C&&w&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Edit Payment"}),e.jsx("button",{onClick:()=>{O(!1),oe(null),ie()},children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:Ne,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Amount (GHS)"}),e.jsx("input",{type:"number",step:"0.01",value:u.amount,onChange:be=>x({...u,amount:be.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Payment Method"}),e.jsxs("select",{value:u.payment_method,onChange:be=>x({...u,payment_method:be.target.value}),className:"input",children:[e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),e.jsx("option",{value:"mobile_money",children:"Mobile Money"}),e.jsx("option",{value:"cheque",children:"Cheque"}),e.jsx("option",{value:"card",children:"Card"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Reference"}),e.jsx("input",{type:"text",value:u.reference_number,onChange:be=>x({...u,reference_number:be.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Notes"}),e.jsx("textarea",{value:u.notes,onChange:be=>x({...u,notes:be.target.value}),className:"input",rows:"2"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{O(!1),oe(null),ie()},className:"btn bg-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Update Payment"})]})]})]})}),V&&k&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-red-600",children:"Void Payment"}),e.jsx("button",{onClick:()=>{re(!1),le("")},children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"bg-red-50 p-4 rounded-lg mb-4",children:e.jsxs("p",{className:"text-red-700 text-sm",children:["You are about to void payment ",e.jsxs("strong",{children:["#",k.payment_number]})," for ",e.jsx("strong",{children:J(k.amount)}),". This action cannot be undone."]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Reason for voiding *"}),e.jsx("textarea",{value:_e,onChange:be=>le(be.target.value),className:"input",rows:"3",placeholder:"Enter reason..."})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>{re(!1),le("")},className:"btn bg-gray-200",children:"Cancel"}),e.jsx("button",{onClick:et,className:"btn bg-red-600 text-white hover:bg-red-700",children:"Void Payment"})]})]})}),ge&&k&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-orange-600",children:"Process Refund"}),e.jsx("button",{onClick:()=>{xe(!1),Xe(""),ce("")},children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["Payment: #",k.payment_number,"  Original: ",J(k.amount)]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Refund Amount (GHS) *"}),e.jsx("input",{type:"number",step:"0.01",max:k.amount,value:ze,onChange:be=>Xe(be.target.value),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Reason"}),e.jsx("textarea",{value:st,onChange:be=>ce(be.target.value),className:"input",rows:"2",placeholder:"Reason for refund..."})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{onClick:()=>{xe(!1),Xe(""),ce("")},className:"btn bg-gray-200",children:"Cancel"}),e.jsx("button",{onClick:Ce,className:"btn bg-orange-600 text-white hover:bg-orange-700",children:"Process Refund"})]})]})}),Z&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between sticky top-0 bg-white",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Bulk Payment Entry"}),e.jsx("button",{onClick:()=>{I(!1),we([{invoice_id:"",amount:""}])},children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:ft,className:"p-6",children:[e.jsx("div",{className:"space-y-3",children:Pe.map((be,lt)=>e.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end",children:[e.jsx("div",{className:"col-span-7",children:e.jsxs("select",{value:be.invoice_id,onChange:Ue=>W(lt,"invoice_id",Ue.target.value),className:"input text-sm",children:[e.jsx("option",{value:"",children:"Select Invoice"}),a.map(Ue=>e.jsxs("option",{value:Ue.id,children:[Ue.invoice_number," - ",Ue.first_name," ",Ue.last_name," (",J(Ue.balance),")"]},Ue.id))]})}),e.jsx("div",{className:"col-span-4",children:e.jsx("input",{type:"number",step:"0.01",placeholder:"Amount",value:be.amount,onChange:Ue=>W(lt,"amount",Ue.target.value),className:"input text-sm"})}),e.jsx("div",{className:"col-span-1",children:Pe.length>1&&e.jsx("button",{type:"button",onClick:()=>Ie(lt),className:"p-2 text-red-600 hover:bg-red-50 rounded",children:e.jsx(us,{className:"w-4 h-4"})})})]},lt))}),e.jsxs("button",{type:"button",onClick:qe,className:"mt-3 text-sm text-blue-600 hover:underline flex items-center gap-1",children:[e.jsx(qt,{className:"w-4 h-4"})," Add Another"]}),e.jsx("div",{className:"text-right mt-4 pt-4 border-t",children:e.jsxs("p",{className:"text-lg font-semibold",children:["Total: ",J(Pe.reduce((be,lt)=>be+(parseFloat(lt.amount)||0),0))]})}),e.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[e.jsx("button",{type:"button",onClick:()=>{I(!1),we([{invoice_id:"",amount:""}])},className:"btn bg-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Record All Payments"})]})]})]})}),H&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Daily Collection Report"}),e.jsx("button",{onClick:()=>ae(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"p-6",children:(()=>{const be=pt();return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center bg-blue-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Today's Date"}),e.jsx("p",{className:"text-lg font-bold",children:new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("div",{className:"text-center bg-green-50 p-6 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Collections"}),e.jsx("p",{className:"text-4xl font-bold text-green-600",children:J(be.total)}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[be.todayPayments.length," payments"]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"By Payment Method"}),e.jsxs("div",{className:"space-y-2",children:[Object.entries(be.byMethod).map(([lt,Ue])=>e.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[e.jsx("span",{className:"capitalize",children:lt.replace("_"," ")}),e.jsx("span",{className:"font-semibold",children:J(Ue)})]},lt)),Object.keys(be.byMethod).length===0&&e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No payments today"})]})]}),e.jsxs("button",{onClick:()=>{const lt=window.open("","_blank");lt.document.write(`<html><head><title>Daily Report</title><style>body{font-family:Arial;padding:30px;}</style></head><body>
                        <h1>Daily Collection Report</h1>
                        <p>${new Date().toLocaleDateString()}</p>
                        <h2>Total: GHS ${be.total.toFixed(2)}</h2>
                        <p>Payments: ${be.todayPayments.length}</p>
                        <h3>By Method:</h3>
                        ${Object.entries(be.byMethod).map(([Ue,Ct])=>`<p>${Ue}: GHS ${Ct.toFixed(2)}</p>`).join("")}
                      </body></html>`),lt.document.close(),lt.print()},className:"btn btn-primary w-full flex items-center justify-center gap-2",children:[e.jsx(or,{className:"w-4 h-4"})," Print Report"]})]})})()})]})})]})}function E7(){const[t,s]=h.useState([]),[a,r]=h.useState([]),[l,c]=h.useState([]),[o,m]=h.useState(""),[u,x]=h.useState(""),[A,g]=h.useState(new Date().toISOString().split("T")[0]),[N,f]=h.useState({}),[y,v]=h.useState(null),[U,D]=h.useState(!1),[M,K]=h.useState(""),[$,P]=h.useState("mark"),[se,z]=h.useState([]),[R,j]=h.useState({}),[T,Q]=h.useState(new Date),[E,te]=h.useState({}),[C,O]=h.useState("08:00"),[V,re]=h.useState(!1),[ge,xe]=h.useState([]),[Z,I]=h.useState([]);h.useRef(),h.useEffect(()=>{H(),ae()},[]),h.useEffect(()=>{o&&(ne(),Fe(),$==="history"&&k(),$==="calendar"&&B(),$==="reports"&&w())},[o,A,u,$]),h.useEffect(()=>{$==="teacher"&&oe()},[$]);const H=async()=>{try{const q=await Bi.getAll();s(q.data.classes||[])}catch(q){console.error("Error fetching classes:",q)}},ae=async()=>{try{const pe=(await yl.getAll()).data.terms||[];c(pe);const Me=pe.find(Se=>Se.is_active==1);Me&&x(Me.id)}catch(q){console.error("Error fetching terms:",q)}},k=async()=>{if(o)try{const q=await F.get(`${ee}/attendance.php?action=history&class_id=${o}&term_id=${u}`);z(q.data.history||[])}catch(q){console.error("Error fetching history:",q),z([])}},B=async()=>{if(!o)return;const q=T.getFullYear(),pe=T.getMonth()+1;try{const Me=await F.get(`${ee}/attendance.php?action=calendar&class_id=${o}&year=${q}&month=${pe}`);j(Me.data.calendar||{})}catch(Me){console.error("Error fetching calendar:",Me),j({})}},w=async()=>{if(o)try{const q=await F.get(`${ee}/attendance.php?action=student_stats&class_id=${o}&term_id=${u}`);te(q.data.stats||{})}catch(q){console.error("Error fetching student stats:",q),te({})}},oe=async()=>{try{const q=await F.get(`${ee}/teachers.php`);I(q.data.teachers||[]);const pe={};(q.data.teachers||[]).forEach(Me=>{pe[Me.id]={status:"present",time_in:"07:30"}}),xe(pe)}catch(q){console.error("Error fetching teachers:",q)}},ne=async()=>{try{const q=await Ch.getAll({class_id:o});r(q.data.students||[]);const pe={};q.data.students.forEach(Me=>{pe[Me.id]={status:"present",time_in:"07:45"}}),f(pe)}catch(q){console.error("Error fetching students:",q)}},Fe=async()=>{try{const[q,pe]=await Promise.all([F.get(`https://eea.mcaforo.com/backend/api/academic.php?resource=attendance&class_id=${o}&date=${A}`),F.get(`https://eea.mcaforo.com/backend/api/academic.php?resource=attendance&action=stats&class_id=${o}&date=${A}`)]),Me={};q.data.attendance.forEach(Se=>{Me[Se.student_id]={status:Se.status,time_in:Se.time_in||"07:45"}}),f(Se=>({...Se,...Me})),v(pe.data.stats)}catch(q){console.error("Error fetching attendance:",q)}},je=(q,pe)=>{f(Me=>({...Me,[q]:{...Me[q],status:pe}}))},Ge=(q,pe)=>{f(Me=>({...Me,[q]:{...Me[q],time_in:pe}}))},ze=async()=>{if(!o){alert("Please select a class");return}try{D(!0);const q=a.map(pe=>({student_id:pe.id,status:N[pe.id]?.status||"present",time_in:N[pe.id]?.time_in||null}));await F.post("https://eea.mcaforo.com/backend/api/academic.php?resource=attendance&action=mark_class",{class_id:o,term_id:1,date:A,students:q,marked_by:1}),alert("Attendance marked successfully!"),Fe()}catch(q){console.error("Error marking attendance:",q),alert("Failed to mark attendance")}finally{D(!1)}},Xe=q=>{const pe={present:"bg-green-100 text-green-700 border-green-300",absent:"bg-red-100 text-red-700 border-red-300",late:"bg-orange-100 text-orange-700 border-orange-300",excused:"bg-blue-100 text-blue-700 border-blue-300"};return pe[q]||pe.present},st=q=>{const pe={};Ke.forEach(Me=>{pe[Me.id]={...N[Me.id],status:q,time_in:q==="absent"?null:N[Me.id]?.time_in||"07:45"}}),f(Me=>({...Me,...pe}))},ce=()=>{const q={};Ke.forEach(pe=>{const Me=N[pe.id]?.time_in;Me&&Me>C&&N[pe.id]?.status==="present"&&(q[pe.id]={...N[pe.id],status:"late"})}),f(pe=>({...pe,...q}))},_e=(q,pe)=>{f(Me=>({...Me,[q]:{...Me[q],remarks:pe}}))},le=q=>{const pe=t.find(Se=>Se.id==o)?.class_name||"Class",Me=Ke.map(Se=>({"Student ID":Se.student_id,Name:`${Se.first_name} ${Se.last_name}`,Status:N[Se.id]?.status||"present","Time In":N[Se.id]?.time_in||"-",Remarks:N[Se.id]?.remarks||""}));if(q==="csv"){const Se=Object.keys(Me[0]).join(","),Ne=Me.map(W=>Object.values(W).map(Ie=>`"${Ie}"`).join(",")),et=[Se,...Ne].join(`
`),Ce=new Blob([et],{type:"text/csv"}),ft=URL.createObjectURL(Ce),qe=document.createElement("a");qe.href=ft,qe.download=`attendance_${pe}_${A}.csv`,qe.click()}else if(q==="print"){const Se=window.open("","_blank");Se.document.write(`
        <html><head><title>Attendance - ${pe}</title>
        <style>
          body { font-family: Arial; padding: 20px; }
          table { width: 100%; border-collapse: collapse; margin-top: 20px; }
          th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
          th { background: #2563eb; color: white; }
          h1 { color: #1f2937; }
          .present { color: green; } .absent { color: red; } .late { color: orange; }
          .stats { display: flex; gap: 20px; margin: 20px 0; }
          .stat { padding: 10px 20px; background: #f3f4f6; border-radius: 8px; }
        </style></head><body>
        <h1>Attendance Report - ${pe}</h1>
        <p>Date: ${new Date(A).toLocaleDateString()}</p>
        <div class="stats">
          <div class="stat">Total: ${y?.total||0}</div>
          <div class="stat">Present: ${y?.present||0}</div>
          <div class="stat">Absent: ${y?.absent||0}</div>
          <div class="stat">Late: ${y?.late||0}</div>
        </div>
        <table>
          <thead><tr>${Object.keys(Me[0]).map(Ne=>`<th>${Ne}</th>`).join("")}</tr></thead>
          <tbody>${Me.map(Ne=>`<tr>${Object.entries(Ne).map(([et,Ce])=>`<td class="${et==="Status"?Ce:""}">${Ce}</td>`).join("")}</tr>`).join("")}</tbody>
        </table>
        </body></html>
      `),Se.document.close(),Se.print()}},Pe=(q,pe)=>{xe(Me=>({...Me,[q]:{...Me[q],status:pe}}))},we=async()=>{try{D(!0);const q=Z.map(pe=>({teacher_id:pe.id,status:ge[pe.id]?.status||"present",time_in:ge[pe.id]?.time_in||null}));await F.post(`${ee}/attendance.php?action=mark_teacher`,{date:A,teachers:q}),alert("Teacher attendance saved!")}catch{alert("Failed to save teacher attendance")}finally{D(!1)}},fe=q=>{const pe=q.getFullYear(),Me=q.getMonth(),Se=new Date(pe,Me,1).getDay(),Ne=new Date(pe,Me+1,0).getDate();return{firstDay:Se,daysInMonth:Ne}},ye=q=>{const pe=new Date(T);pe.setMonth(pe.getMonth()+q),Q(pe)},Ke=a.filter(q=>!M||`${q.first_name} ${q.last_name}`.toLowerCase().includes(M.toLowerCase())||q.student_id?.toLowerCase().includes(M.toLowerCase())),ve=[{label:"Total",value:y?.total||0,icon:Rt,color:"bg-blue-500"},{label:"Present",value:y?.present||0,icon:Mt,color:"bg-green-500"},{label:"Absent",value:y?.absent||0,icon:Js,color:"bg-red-500"},{label:"Late",value:y?.late||0,icon:Wt,color:"bg-orange-500"}],ie=[{id:"mark",label:"Mark Attendance",icon:Or},{id:"history",label:"History",icon:Sa},{id:"calendar",label:"Calendar",icon:jh},{id:"reports",label:"Reports",icon:Fs},{id:"teacher",label:"Teacher",icon:Rt}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Attendance Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Mark and track student & teacher attendance"})]}),e.jsx("button",{onClick:()=>re(!0),className:"btn bg-gray-100 text-gray-700 hover:bg-gray-200",children:e.jsx(Ka,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:ie.map(q=>e.jsxs("button",{onClick:()=>P(q.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium whitespace-nowrap transition-all ${$===q.id?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(q.icon,{className:"w-4 h-4"}),q.label]},q.id))}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex flex-wrap items-end gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-[150px]",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),e.jsxs("select",{value:o,onChange:q=>m(q.target.value),className:"input",children:[e.jsx("option",{value:"",children:"Choose a class"}),t.map(q=>e.jsx("option",{value:q.id,children:q.class_name},q.id))]})]}),$!=="teacher"&&e.jsxs("div",{className:"flex-1 min-w-[150px]",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Term"}),e.jsxs("select",{value:u,onChange:q=>x(q.target.value),className:"input",children:[e.jsx("option",{value:"",children:"All Terms"}),l.map(q=>e.jsxs("option",{value:q.id,children:[q.term_name," (",q.academic_year,")"]},q.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),e.jsx("input",{type:"date",value:A,onChange:q=>g(q.target.value),className:"input"})]}),$==="mark"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:ze,disabled:!o||U,className:"btn btn-primary disabled:opacity-50",children:U?"Saving...":"Save Attendance"}),e.jsx("button",{onClick:()=>le("csv"),className:"btn bg-green-600 text-white hover:bg-green-700",children:e.jsx(xs,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>le("print"),className:"btn bg-gray-600 text-white hover:bg-gray-700",children:e.jsx(or,{className:"w-4 h-4"})})]})]})}),y&&$==="mark"&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:ve.map((q,pe)=>e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:q.label}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:q.value})]}),e.jsx("div",{className:`${q.color} w-10 h-10 rounded-lg flex items-center justify-center`,children:e.jsx(q.icon,{className:"w-5 h-5 text-white"})})]})},pe))}),$==="mark"&&o&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search students...",value:M,onChange:q=>K(q.target.value),className:"input pl-10 w-full"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Bulk:"}),e.jsx("button",{onClick:()=>st("present"),className:"px-3 py-1 text-xs font-medium rounded-full bg-green-100 text-green-700 hover:bg-green-200",children:"All Present"}),e.jsx("button",{onClick:()=>st("absent"),className:"px-3 py-1 text-xs font-medium rounded-full bg-red-100 text-red-700 hover:bg-red-200",children:"All Absent"}),e.jsx("button",{onClick:ce,className:"px-3 py-1 text-xs font-medium rounded-full bg-orange-100 text-orange-700 hover:bg-orange-200",title:`Mark late if after ${C}`,children:"Auto Late"})]})]})}),Ke.length>0?e.jsx("div",{className:"card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Student"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Time In"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Remarks"})]})}),e.jsx("tbody",{className:"divide-y",children:Ke.map(q=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsxs("span",{className:"text-blue-600 font-semibold text-sm",children:[q.first_name?.charAt(0),q.last_name?.charAt(0)]})}),e.jsxs("span",{className:"font-medium text-gray-900",children:[q.first_name," ",q.last_name]})]})}),e.jsx("td",{className:"px-4 py-3 font-mono text-sm text-gray-600",children:q.student_id}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"flex gap-1",children:["present","absent","late","excused"].map(pe=>e.jsx("button",{onClick:()=>je(q.id,pe),className:`px-2 py-1 text-xs font-medium rounded-full border transition-all ${N[q.id]?.status===pe?Xe(pe):"bg-gray-50 text-gray-500 border-gray-200 hover:bg-gray-100"}`,children:pe.charAt(0).toUpperCase()},pe))})}),e.jsx("td",{className:"px-4 py-3",children:N[q.id]?.status!=="absent"&&e.jsx("input",{type:"time",value:N[q.id]?.time_in||"07:45",onChange:pe=>Ge(q.id,pe.target.value),className:"input w-28 text-sm"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"text",placeholder:"Add remarks...",value:N[q.id]?.remarks||"",onChange:pe=>_e(q.id,pe.target.value),className:"input w-full text-sm"})})]},q.id))})]})})}):e.jsxs("div",{className:"card p-12 text-center",children:[e.jsx(ka,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No students found"})]})]}),$==="history"&&o&&e.jsxs("div",{className:"card overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b bg-gray-50",children:e.jsx("h3",{className:"font-semibold",children:"Attendance History"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Present"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Absent"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Late"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Rate"})]})}),e.jsx("tbody",{className:"divide-y",children:se.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-4 py-8 text-center text-gray-500",children:"No history data"})}):se.map((q,pe)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:new Date(q.date).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3",children:q.total}),e.jsx("td",{className:"px-4 py-3 text-green-600",children:q.present}),e.jsx("td",{className:"px-4 py-3 text-red-600",children:q.absent}),e.jsx("td",{className:"px-4 py-3 text-orange-600",children:q.late}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${q.total?Math.round(q.present/q.total*100):0}%`}})}),e.jsxs("span",{className:"text-sm",children:[q.total?Math.round(q.present/q.total*100):0,"%"]})]})})]},pe))})]})})]}),$==="calendar"&&o&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("button",{onClick:()=>ye(-1),className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(Kd,{className:"w-5 h-5"})}),e.jsx("h3",{className:"text-lg font-semibold",children:T.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),e.jsx("button",{onClick:()=>ye(1),className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(cr,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(q=>e.jsx("div",{className:"text-center text-sm font-medium text-gray-500 py-2",children:q},q)),(()=>{const{firstDay:q,daysInMonth:pe}=fe(T),Me=[];for(let Se=0;Se<q;Se++)Me.push(e.jsx("div",{className:"p-2"},`empty-${Se}`));for(let Se=1;Se<=pe;Se++){const Ne=`${T.getFullYear()}-${String(T.getMonth()+1).padStart(2,"0")}-${String(Se).padStart(2,"0")}`,et=R[Ne],Ce=et?.total?Math.round(et.present/et.total*100):null;Me.push(e.jsxs("div",{className:`p-2 text-center rounded-lg cursor-pointer hover:bg-gray-100 ${Ne===A?"ring-2 ring-blue-500":""}`,onClick:()=>g(Ne),children:[e.jsx("div",{className:"text-sm font-medium",children:Se}),Ce!==null&&e.jsxs("div",{className:`text-xs mt-1 ${Ce>=90?"text-green-600":Ce>=70?"text-orange-600":"text-red-600"}`,children:[Ce,"%"]})]},Se))}return Me})()]}),e.jsxs("div",{className:"flex items-center justify-center gap-6 mt-4 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 bg-green-500 rounded-full"})," 90%+"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 bg-orange-500 rounded-full"})," 70-89%"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 bg-red-500 rounded-full"})," <70%"]})]})]}),$==="reports"&&o&&e.jsxs("div",{className:"card overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b bg-gray-50 flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold",children:"Student Attendance Report"}),e.jsxs("button",{onClick:()=>le("csv"),className:"btn bg-green-600 text-white hover:bg-green-700 text-sm",children:[e.jsx(xs,{className:"w-4 h-4 mr-1"})," Export"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Student"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total Days"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Present"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Absent"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Late"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Attendance %"})]})}),e.jsx("tbody",{className:"divide-y",children:a.map(q=>{const pe=E[q.id]||{total:0,present:0,absent:0,late:0},Me=pe.total?Math.round(pe.present/pe.total*100):0;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsxs("span",{className:"text-blue-600 font-semibold text-xs",children:[q.first_name?.charAt(0),q.last_name?.charAt(0)]})}),e.jsxs("span",{className:"font-medium",children:[q.first_name," ",q.last_name]})]})}),e.jsx("td",{className:"px-4 py-3",children:pe.total}),e.jsx("td",{className:"px-4 py-3 text-green-600",children:pe.present}),e.jsx("td",{className:"px-4 py-3 text-red-600",children:pe.absent}),e.jsx("td",{className:"px-4 py-3 text-orange-600",children:pe.late}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${Me>=90?"bg-green-500":Me>=70?"bg-orange-500":"bg-red-500"}`,style:{width:`${Me}%`}})}),e.jsxs("span",{className:`text-sm font-medium ${Me>=90?"text-green-600":Me>=70?"text-orange-600":"text-red-600"}`,children:[Me,"%"]})]})})]},q.id)})})]})})]}),$==="teacher"&&e.jsxs("div",{className:"card overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b bg-gray-50 flex items-center justify-between",children:[e.jsxs("h3",{className:"font-semibold",children:["Teacher Attendance - ",new Date(A).toLocaleDateString()]}),e.jsx("button",{onClick:we,disabled:U,className:"btn btn-primary disabled:opacity-50",children:U?"Saving...":"Save Teacher Attendance"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Teacher"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Department"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Time In"})]})}),e.jsx("tbody",{className:"divide-y",children:Z.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"px-4 py-8 text-center text-gray-500",children:"No teachers found"})}):Z.map(q=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 bg-purple-100 rounded-full flex items-center justify-center",children:e.jsxs("span",{className:"text-purple-600 font-semibold text-sm",children:[q.first_name?.charAt(0),q.last_name?.charAt(0)]})}),e.jsxs("span",{className:"font-medium",children:[q.first_name," ",q.last_name]})]})}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:q.department||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"flex gap-1",children:["present","absent","late","excused"].map(pe=>e.jsx("button",{onClick:()=>Pe(q.id,pe),className:`px-2 py-1 text-xs font-medium rounded-full border transition-all ${ge[q.id]?.status===pe?Xe(pe):"bg-gray-50 text-gray-500 border-gray-200 hover:bg-gray-100"}`,children:pe.charAt(0).toUpperCase()},pe))})}),e.jsx("td",{className:"px-4 py-3",children:ge[q.id]?.status!=="absent"&&e.jsx("input",{type:"time",value:ge[q.id]?.time_in||"07:30",onChange:pe=>xe(Me=>({...Me,[q.id]:{...Me[q.id],time_in:pe.target.value}})),className:"input w-28 text-sm"})})]},q.id))})]})})]}),!o&&$!=="teacher"&&e.jsxs("div",{className:"card p-12 text-center",children:[e.jsx(Ot,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"Select a class to manage attendance"})]}),V&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Attendance Settings"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Late Threshold Time"}),e.jsx("input",{type:"time",value:C,onChange:q=>O(q.target.value),className:"input"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Students arriving after this time will be marked late when using "Auto Late"'})]})}),e.jsx("div",{className:"flex gap-3 mt-6",children:e.jsx("button",{onClick:()=>re(!1),className:"btn bg-gray-200 text-gray-700 hover:bg-gray-300 flex-1",children:"Close"})})]})})]})}function D7(){const[t,s]=h.useState([]),[a,r]=h.useState([]),[l,c]=h.useState([]),[o,m]=h.useState([]),[u,x]=h.useState(!1),[A,g]=h.useState(!1),[N,f]=h.useState(null),[y,v]=h.useState([]),[U,D]=h.useState(!1),[M,K]=h.useState(null),[$,P]=h.useState("assessments"),[se,z]=h.useState(""),[R,j]=h.useState(""),[T,Q]=h.useState(""),[E,te]=h.useState(""),[C,O]=h.useState(""),[V,re]=h.useState("assessment_date"),[ge,xe]=h.useState("desc"),[Z,I]=h.useState(!1),[H,ae]=h.useState(null),[k,B]=h.useState(!1),[w,oe]=h.useState(null),[ne,Fe]=h.useState(null),[je,Ge]=h.useState([]),[ze,Xe]=h.useState(!1),[st,ce]=h.useState([]),_e=h.useRef(),[le,Pe]=h.useState([{grade:"A+",minPercent:90,maxPercent:100,gpa:4},{grade:"A",minPercent:80,maxPercent:89,gpa:3.7},{grade:"B+",minPercent:75,maxPercent:79,gpa:3.3},{grade:"B",minPercent:70,maxPercent:74,gpa:3},{grade:"C+",minPercent:65,maxPercent:69,gpa:2.7},{grade:"C",minPercent:60,maxPercent:64,gpa:2.3},{grade:"D",minPercent:50,maxPercent:59,gpa:1},{grade:"F",minPercent:0,maxPercent:49,gpa:0}]),[we,fe]=h.useState({class_id:"",subject_id:"",term_id:"",assessment_name:"",assessment_type:"test",total_marks:100,weight_percentage:100,assessment_date:new Date().toISOString().split("T")[0],description:"",status:"draft"});h.useEffect(()=>{ye()},[]),h.useEffect(()=>{$==="rankings"&&R&&Ke()},[$,R,C]);const ye=async()=>{try{const[me,Ze,ct,Yt]=await Promise.all([F.get(`${ee}/academic.php?resource=assessments`),Bi.getAll(),Ud.getAll(),yl.getAll()]);s(me.data.assessments||[]),r(Ze.data.classes||[]),c(ct.data.subjects||[]),m(Yt.data.terms||[]);const be=(Yt.data.terms||[]).find(lt=>lt.is_active==1);be&&O(be.id)}catch(me){console.error("Error fetching data:",me)}},Ke=async()=>{if(R)try{const me=await F.get(`${ee}/grading.php?action=rankings&class_id=${R}&term_id=${C}`);Ge(me.data.rankings||[])}catch(me){console.error("Error fetching rankings:",me),Ge([])}},ve=async me=>{try{const Ze=await F.get(`${ee}/grading.php?action=stats&assessment_id=${me.id}`);ae(Ze.data.stats),f(me),I(!0)}catch{alert("Error fetching statistics")}},ie=async(me,Ze)=>{try{const ct=await F.get(`${ee}/grading.php?action=student_report&student_id=${me}&class_id=${Ze}&term_id=${C}`);Fe(ct.data.report),oe(ct.data.student),B(!0)}catch{alert("Error fetching report")}},q=async me=>{me.preventDefault();try{M?(await F.put(`${ee}/academic.php?resource=assessments&id=${M.id}`,we),alert("Assessment updated successfully!")):(await F.post(`${ee}/academic.php?resource=assessments`,we),alert("Assessment created successfully!")),x(!1),K(null),ye(),pe()}catch{alert("Error saving assessment")}},pe=()=>{fe({class_id:"",subject_id:"",term_id:C||"",assessment_name:"",assessment_type:"test",total_marks:100,weight_percentage:100,assessment_date:new Date().toISOString().split("T")[0],description:"",status:"draft"})},Me=me=>{K(me),fe({class_id:me.class_id,subject_id:me.subject_id,term_id:me.term_id,assessment_name:me.assessment_name,assessment_type:me.assessment_type,total_marks:me.total_marks,weight_percentage:me.weight_percentage,assessment_date:me.assessment_date,description:me.description||"",status:me.status||"draft"}),x(!0)},Se=async me=>{if(window.confirm("Delete this assessment? All grades will be lost."))try{await F.delete(`${ee}/academic.php?resource=assessments&id=${me}`),ye(),alert("Assessment deleted!")}catch{alert("Error deleting assessment")}},Ne=me=>{K(null),fe({...me,assessment_name:`${me.assessment_name} (Copy)`,assessment_date:new Date().toISOString().split("T")[0],status:"draft"}),x(!0)},et=async me=>{try{D(!0);const ct=(await F.get(`${ee}/academic.php?resource=grades&action=by_assessment&assessment_id=${me.id}`)).data.grades||[],lt=((await F.get(`${ee}/students.php?class_id=${me.class_id}`)).data.students||[]).map(Ue=>{const Ct=ct.find(Et=>Et.student_id==Ue.id);return{student_id:Ue.id,first_name:Ue.first_name,last_name:Ue.last_name,student_id_code:Ue.student_id,marks_obtained:Ct?.marks_obtained||"",grade:Ct?.grade||"",remarks:Ct?.remarks||""}});v(lt),f(me),g(!0)}catch{alert("Error loading grades")}finally{D(!1)}},Ce=(me,Ze,ct)=>{v(Yt=>Yt.map(be=>be.student_id===me?{...be,[Ze]:ct}:be))},ft=(me,Ze)=>{if(!me||!Ze)return"";const ct=me/Ze*100;for(const Yt of le)if(ct>=Yt.minPercent&&ct<=Yt.maxPercent)return Yt.grade;return"F"},qe=me=>me?me.startsWith("A")?"bg-green-100 text-green-700":me.startsWith("B")?"bg-blue-100 text-blue-700":me.startsWith("C")?"bg-yellow-100 text-yellow-700":me.startsWith("D")?"bg-orange-100 text-orange-700":"bg-red-100 text-red-700":"bg-gray-100 text-gray-600",W=me=>{V===me?xe(ge==="asc"?"desc":"asc"):(re(me),xe("asc"))},Ie=me=>{if(!N||y.length===0)return;const Ze=y.map(ct=>({"Student ID":ct.student_id_code,Name:`${ct.first_name} ${ct.last_name}`,Marks:ct.marks_obtained||"-",Grade:ct.grade||ft(ct.marks_obtained,N.total_marks),Remarks:ct.remarks||""}));if(me==="csv"){const ct=Object.keys(Ze[0]).join(","),Yt=Ze.map(Et=>Object.values(Et).map(Rs=>`"${Rs}"`).join(",")),be=[ct,...Yt].join(`
`),lt=new Blob([be],{type:"text/csv"}),Ue=URL.createObjectURL(lt),Ct=document.createElement("a");Ct.href=Ue,Ct.download=`grades_${N.assessment_name}.csv`,Ct.click()}else if(me==="print"){const ct=window.open("","_blank");ct.document.write(`
        <html><head><title>Grades - ${N.assessment_name}</title>
        <style>
          body { font-family: Arial; padding: 20px; }
          table { width: 100%; border-collapse: collapse; margin-top: 20px; }
          th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
          th { background: #2563eb; color: white; }
          h1 { color: #1f2937; margin-bottom: 5px; }
          .info { color: #666; margin-bottom: 20px; }
          .grade-A { color: green; } .grade-B { color: blue; } .grade-C { color: orange; } .grade-F { color: red; }
        </style></head><body>
        <h1>${N.assessment_name}</h1>
        <p class="info">${N.class_name} - ${N.subject_name} | Total: ${N.total_marks} marks</p>
        <table>
          <thead><tr>${Object.keys(Ze[0]).map(Yt=>`<th>${Yt}</th>`).join("")}</tr></thead>
          <tbody>${Ze.map(Yt=>`<tr>${Object.entries(Yt).map(([be,lt])=>`<td class="${be==="Grade"?"grade-"+lt:""}">${lt}</td>`).join("")}</tr>`).join("")}</tbody>
        </table>
        </body></html>
      `),ct.document.close(),ct.print()}},mt=me=>{const Ze=me.target.files[0];if(!Ze)return;const ct=new FileReader;ct.onload=Yt=>{const lt=Yt.target.result.split(`
`).filter(Et=>Et.trim()),Ue=lt[0].split(",").map(Et=>Et.trim().replace(/"/g,"")),Ct=lt.slice(1).map(Et=>{const Rs=Et.split(",").map(Te=>Te.trim().replace(/"/g,"")),He={};return Ue.forEach((Te,bt)=>He[Te]=Rs[bt]),He});ce(Ct),Xe(!0)},ct.readAsText(Ze),me.target.value=""},pt=async()=>{if(!(!N||st.length===0))try{const me=st.map(Ze=>{const ct=y.find(Yt=>Yt.student_id_code===Ze["Student ID"]||`${Yt.first_name} ${Yt.last_name}`.toLowerCase()===(Ze.Name||"").toLowerCase());return ct?{student_id:ct.student_id,marks_obtained:Ze.Marks||Ze.Score||"",grade:Ze.Grade||"",remarks:Ze.Remarks||Ze.Comments||""}:null}).filter(Boolean);await F.post(`${ee}/academic.php?resource=grades&action=bulk`,{assessment_id:N.id,grades:me,graded_by:1}),Xe(!1),ce([]),et(N),alert("Grades imported successfully!")}catch{alert("Error importing grades")}},kt=()=>{if(!w||!ne)return;const me=window.open("","_blank");me.document.write(`
      <html><head><title>Report Card - ${w.first_name} ${w.last_name}</title>
      <style>
        body { font-family: Arial; padding: 30px; max-width: 800px; margin: 0 auto; }
        .header { text-align: center; border-bottom: 2px solid #333; padding-bottom: 20px; margin-bottom: 20px; }
        .student-info { display: flex; justify-content: space-between; margin-bottom: 20px; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        th { background: #f5f5f5; }
        .grade-A { color: green; font-weight: bold; }
        .grade-B { color: blue; }
        .grade-C { color: orange; }
        .grade-F { color: red; }
        .summary { background: #f9f9f9; padding: 15px; border-radius: 8px; margin-top: 20px; }
        .footer { margin-top: 40px; display: flex; justify-content: space-between; }
        .signature { border-top: 1px solid #333; padding-top: 5px; width: 200px; text-align: center; }
      </style></head><body>
      <div class="header">
        <h1>Student Report Card</h1>
        <p>Academic Term Report</p>
      </div>
      <div class="student-info">
        <div><strong>Student:</strong> ${w.first_name} ${w.last_name}</div>
        <div><strong>ID:</strong> ${w.student_id}</div>
        <div><strong>Class:</strong> ${w.class_name||""}</div>
      </div>
      <table>
        <thead><tr><th>Subject</th><th>Assessment</th><th>Marks</th><th>Grade</th><th>Remarks</th></tr></thead>
        <tbody>
          ${(ne.grades||[]).map(Ze=>`
            <tr>
              <td>${Ze.subject_name}</td>
              <td>${Ze.assessment_name}</td>
              <td>${Ze.marks_obtained}/${Ze.total_marks}</td>
              <td class="grade-${Ze.grade?.charAt(0)}">${Ze.grade}</td>
              <td>${Ze.remarks||"-"}</td>
            </tr>
          `).join("")}
        </tbody>
      </table>
      <div class="summary">
        <strong>Overall Performance:</strong> Average: ${ne.average?.toFixed(1)||0}% | 
        GPA: ${ne.gpa?.toFixed(2)||0}
      </div>
      <div class="footer">
        <div class="signature">Class Teacher</div>
        <div class="signature">Principal</div>
        <div class="signature">Parent/Guardian</div>
      </div>
      </body></html>
    `),me.document.close(),me.print()},J=t.filter(me=>{const Ze=!se||me.assessment_name?.toLowerCase().includes(se.toLowerCase()),ct=!R||me.class_id==R,Yt=!T||me.subject_id==T,be=!E||me.assessment_type===E,lt=!C||me.term_id==C;return Ze&&ct&&Yt&&be&&lt}).sort((me,Ze)=>{let ct=me[V]||"",Yt=Ze[V]||"";return V==="assessment_date"&&(ct=new Date(ct),Yt=new Date(Yt)),ge==="asc"?ct>Yt?1:-1:ct<Yt?1:-1}),Je=[{id:"assessments",label:"Assessments",icon:as},{id:"rankings",label:"Class Rankings",icon:JA},{id:"reports",label:"Report Cards",icon:Kt},{id:"settings",label:"Grading Scale",icon:Ka}],_t=["quiz","test","exam","assignment","project","midterm","final"],$t=async()=>{try{D(!0);const me=y.map(Ze=>({student_id:Ze.student_id,marks_obtained:Ze.marks_obtained,grade:Ze.grade||ft(Ze.marks_obtained,N.total_marks),remarks:Ze.remarks||""}));await F.post(`${ee}/academic.php?resource=grades&action=bulk`,{assessment_id:N.id,grades:me,graded_by:1}),g(!1),alert("Grades saved successfully!")}catch{alert("Error saving grades")}finally{D(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Grading & Assessments"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Create assessments, record grades, and generate reports"})]}),e.jsxs("button",{onClick:()=>{pe(),K(null),x(!0)},className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-5 h-5"})," Create Assessment"]})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:Je.map(me=>e.jsxs("button",{onClick:()=>P(me.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium whitespace-nowrap transition-all ${$===me.id?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(me.icon,{className:"w-4 h-4"})," ",me.label]},me.id))}),$==="assessments"&&e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search assessments...",value:se,onChange:me=>z(me.target.value),className:"input pl-10 w-full"})]}),e.jsxs("select",{value:R,onChange:me=>j(me.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Classes"}),a.map(me=>e.jsx("option",{value:me.id,children:me.class_name},me.id))]}),e.jsxs("select",{value:T,onChange:me=>Q(me.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Subjects"}),l.map(me=>e.jsx("option",{value:me.id,children:me.subject_name},me.id))]}),e.jsxs("select",{value:E,onChange:me=>te(me.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Types"}),_t.map(me=>e.jsx("option",{value:me,className:"capitalize",children:me},me))]}),e.jsxs("select",{value:C,onChange:me=>O(me.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Terms"}),o.map(me=>e.jsx("option",{value:me.id,children:me.term_name},me.id))]})]})}),$==="assessments"&&e.jsx("div",{className:"card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase cursor-pointer hover:bg-gray-100",onClick:()=>W("assessment_name"),children:["Assessment ",V==="assessment_name"&&(ge==="asc"?e.jsx(jl,{className:"w-3 h-3 inline"}):e.jsx(un,{className:"w-3 h-3 inline"}))]}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Class"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Subject"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Marks"}),e.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase cursor-pointer hover:bg-gray-100",onClick:()=>W("assessment_date"),children:["Date ",V==="assessment_date"&&(ge==="asc"?e.jsx(jl,{className:"w-3 h-3 inline"}):e.jsx(un,{className:"w-3 h-3 inline"}))]}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:J.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-4 py-8 text-center text-gray-500",children:"No assessments found"})}):J.map(me=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:me.assessment_name}),e.jsx("td",{className:"px-4 py-3 text-sm",children:me.class_name}),e.jsx("td",{className:"px-4 py-3 text-sm",children:me.subject_name}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-700 capitalize",children:me.assessment_type})}),e.jsx("td",{className:"px-4 py-3 font-semibold",children:me.total_marks}),e.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(me.assessment_date).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>et(me),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",title:"Grade",children:e.jsx(Is,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ve(me),className:"p-1.5 text-purple-600 hover:bg-purple-50 rounded",title:"Statistics",children:e.jsx(Fs,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Me(me),className:"p-1.5 text-gray-600 hover:bg-gray-100 rounded",title:"Edit",children:e.jsx(Na,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Ne(me),className:"p-1.5 text-green-600 hover:bg-green-50 rounded",title:"Duplicate",children:e.jsx(vl,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Se(me.id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:e.jsx(us,{className:"w-4 h-4"})})]})})]},me.id))})]})})}),$==="rankings"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("select",{value:R,onChange:me=>j(me.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"Select Class"}),a.map(me=>e.jsx("option",{value:me.id,children:me.class_name},me.id))]}),e.jsxs("select",{value:C,onChange:me=>O(me.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Terms"}),o.map(me=>e.jsx("option",{value:me.id,children:me.term_name},me.id))]})]})}),R&&e.jsxs("div",{className:"card overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b bg-gray-50",children:e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(JA,{className:"w-5 h-5 text-yellow-500"})," Class Rankings"]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Rank"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Student"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Average %"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"GPA"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Assessments"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:je.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-4 py-8 text-center text-gray-500",children:"No ranking data available"})}):je.map((me,Ze)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold ${Ze===0?"bg-yellow-100 text-yellow-700":Ze===1?"bg-gray-200 text-gray-700":Ze===2?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-600"}`,children:Ze+1})}),e.jsxs("td",{className:"px-4 py-3 font-medium",children:[me.first_name," ",me.last_name]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${me.average>=80?"bg-green-500":me.average>=60?"bg-blue-500":"bg-red-500"}`,style:{width:`${me.average}%`}})}),e.jsxs("span",{className:"font-medium",children:[me.average?.toFixed(1),"%"]})]})}),e.jsx("td",{className:"px-4 py-3 font-semibold",children:me.gpa?.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:me.total_assessments}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{onClick:()=>ie(me.id,R),className:"text-blue-600 hover:underline text-sm",children:"View Report"})})]},me.id))})]})})]})]}),$==="reports"&&e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Generate Report Card"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("select",{value:R,onChange:me=>j(me.target.value),className:"input",children:[e.jsx("option",{value:"",children:"Select Class"}),a.map(me=>e.jsx("option",{value:me.id,children:me.class_name},me.id))]}),e.jsxs("select",{value:C,onChange:me=>O(me.target.value),className:"input",children:[e.jsx("option",{value:"",children:"Select Term"}),o.map(me=>e.jsx("option",{value:me.id,children:me.term_name},me.id))]})]}),R&&je.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Select a student to generate their report card:"}),je.map(me=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50",children:[e.jsxs("span",{className:"font-medium",children:[me.first_name," ",me.last_name]}),e.jsxs("button",{onClick:()=>ie(me.id,R),className:"btn btn-primary text-sm",children:[e.jsx(Kt,{className:"w-4 h-4 mr-1"})," Generate Report"]})]},me.id))]})]}),$==="settings"&&e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Grading Scale Configuration"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Grade"}),e.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Min %"}),e.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Max %"}),e.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"GPA"})]})}),e.jsx("tbody",{className:"divide-y",children:le.map((me,Ze)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${qe(me.grade)}`,children:me.grade})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("input",{type:"number",value:me.minPercent,onChange:ct=>{const Yt=[...le];Yt[Ze].minPercent=parseInt(ct.target.value),Pe(Yt)},className:"input w-20"})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("input",{type:"number",value:me.maxPercent,onChange:ct=>{const Yt=[...le];Yt[Ze].maxPercent=parseInt(ct.target.value),Pe(Yt)},className:"input w-20"})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("input",{type:"number",step:"0.1",value:me.gpa,onChange:ct=>{const Yt=[...le];Yt[Ze].gpa=parseFloat(ct.target.value),Pe(Yt)},className:"input w-20"})})]},Ze))})]})})]}),u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:M?"Edit Assessment":"Create Assessment"}),e.jsx("button",{onClick:()=>{x(!1),K(null)},children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:q,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Class *"}),e.jsxs("select",{required:!0,value:we.class_id,onChange:me=>fe({...we,class_id:me.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select Class"}),a.map(me=>e.jsx("option",{value:me.id,children:me.class_name},me.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Subject *"}),e.jsxs("select",{required:!0,value:we.subject_id,onChange:me=>fe({...we,subject_id:me.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select Subject"}),l.map(me=>e.jsx("option",{value:me.id,children:me.subject_name},me.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Term"}),e.jsxs("select",{value:we.term_id,onChange:me=>fe({...we,term_id:me.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select Term"}),o.map(me=>e.jsx("option",{value:me.id,children:me.term_name},me.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Type *"}),e.jsx("select",{value:we.assessment_type,onChange:me=>fe({...we,assessment_type:me.target.value}),className:"input",children:_t.map(me=>e.jsx("option",{value:me,className:"capitalize",children:me},me))})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Assessment Name *"}),e.jsx("input",{type:"text",required:!0,value:we.assessment_name,onChange:me=>fe({...we,assessment_name:me.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Total Marks *"}),e.jsx("input",{type:"number",required:!0,value:we.total_marks,onChange:me=>fe({...we,total_marks:me.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Weight %"}),e.jsx("input",{type:"number",value:we.weight_percentage,onChange:me=>fe({...we,weight_percentage:me.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Date *"}),e.jsx("input",{type:"date",required:!0,value:we.assessment_date,onChange:me=>fe({...we,assessment_date:me.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Status"}),e.jsxs("select",{value:we.status,onChange:me=>fe({...we,status:me.target.value}),className:"input",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"published",children:"Published"}),e.jsx("option",{value:"graded",children:"Graded"})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description"}),e.jsx("textarea",{value:we.description,onChange:me=>fe({...we,description:me.target.value}),className:"input",rows:"2"})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>{x(!1),K(null)},className:"btn bg-gray-200",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-primary",children:[M?"Update":"Create"," Assessment"]})]})]})]})}),A&&N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-5xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between bg-white",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:N.assessment_name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[N.class_name," - ",N.subject_name," | Total: ",N.total_marks," marks"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"file",ref:_e,accept:".csv",onChange:mt,className:"hidden"}),e.jsxs("button",{onClick:()=>_e.current?.click(),className:"btn bg-gray-100 text-gray-700 hover:bg-gray-200 text-sm",children:[e.jsx(Hr,{className:"w-4 h-4 mr-1"})," Import"]}),e.jsxs("button",{onClick:()=>Ie("csv"),className:"btn bg-green-600 text-white hover:bg-green-700 text-sm",children:[e.jsx(xs,{className:"w-4 h-4 mr-1"})," Export"]}),e.jsx("button",{onClick:()=>Ie("print"),className:"btn bg-gray-600 text-white hover:bg-gray-700 text-sm",children:e.jsx(or,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>g(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Student"}),e.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"ID"}),e.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Marks"}),e.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Grade"}),e.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Remarks"})]})}),e.jsx("tbody",{className:"divide-y",children:y.map(me=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-4 py-2 font-medium",children:[me.first_name," ",me.last_name]}),e.jsx("td",{className:"px-4 py-2 font-mono text-sm text-gray-600",children:me.student_id_code}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("input",{type:"number",step:"0.01",max:N.total_marks,value:me.marks_obtained,onChange:Ze=>Ce(me.student_id,"marks_obtained",Ze.target.value),className:"input w-20"})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${qe(me.grade||ft(me.marks_obtained,N.total_marks))}`,children:me.grade||ft(me.marks_obtained,N.total_marks)||"-"})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("input",{type:"text",placeholder:"Add remarks...",value:me.remarks||"",onChange:Ze=>Ce(me.student_id,"remarks",Ze.target.value),className:"input w-full text-sm"})})]},me.student_id))})]})}),e.jsxs("div",{className:"p-4 border-t bg-white flex justify-end gap-4",children:[e.jsx("button",{onClick:()=>g(!1),className:"btn bg-gray-200",children:"Cancel"}),e.jsx("button",{onClick:$t,disabled:U,className:"btn btn-primary",children:U?"Saving...":"Save Grades"})]})]})}),Z&&H&&N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Assessment Statistics"}),e.jsx("button",{onClick:()=>I(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsx("p",{className:"text-gray-600 mb-4",children:N.assessment_name}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-700",children:parseFloat(H.average||0).toFixed(1)}),e.jsx("p",{className:"text-sm text-blue-600",children:"Class Average"})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-700",children:H.highest||0}),e.jsx("p",{className:"text-sm text-green-600",children:"Highest Score"})]}),e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-red-700",children:H.lowest||0}),e.jsx("p",{className:"text-sm text-red-600",children:"Lowest Score"})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-purple-700",children:[H.graded||0,"/",H.total||0]}),e.jsx("p",{className:"text-sm text-purple-600",children:"Students Graded"})]})]}),H.distribution&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Grade Distribution"}),e.jsx("div",{className:"space-y-2",children:Object.entries(H.distribution).map(([me,Ze])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-10 text-center px-2 py-1 rounded text-xs font-medium ${qe(me)}`,children:me}),e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-4",children:e.jsx("div",{className:"bg-blue-500 h-4 rounded-full",style:{width:`${Ze/(H.graded||1)*100}%`}})}),e.jsx("span",{className:"text-sm text-gray-600 w-8",children:Ze})]},me))})]})]})}),k&&w&&ne&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Report Card"}),e.jsxs("p",{className:"text-gray-600",children:[w.first_name," ",w.last_name]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:kt,className:"btn bg-gray-600 text-white hover:bg-gray-700",children:[e.jsx(or,{className:"w-4 h-4 mr-1"})," Print"]}),e.jsx("button",{onClick:()=>B(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-700",children:[ne.average?.toFixed(1)||0,"%"]}),e.jsx("p",{className:"text-sm text-blue-600",children:"Average"})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-700",children:ne.gpa?.toFixed(2)||0}),e.jsx("p",{className:"text-sm text-green-600",children:"GPA"})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-purple-700",children:["#",ne.rank||"-"]}),e.jsx("p",{className:"text-sm text-purple-600",children:"Class Rank"})]})]}),e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Subject"}),e.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Assessment"}),e.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Marks"}),e.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Grade"})]})}),e.jsx("tbody",{className:"divide-y",children:(ne.grades||[]).map((me,Ze)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2",children:me.subject_name}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:me.assessment_name}),e.jsxs("td",{className:"px-4 py-2",children:[me.marks_obtained,"/",me.total_marks]}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${qe(me.grade)}`,children:me.grade})})]},Ze))})]})]})]})}),ze&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Import Grades from CSV"}),e.jsx("button",{onClick:()=>{Xe(!1),ce([])},children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Found ",st.length," records. Review and confirm import:"]}),e.jsx("div",{className:"max-h-60 overflow-y-auto border rounded-lg mb-4",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0",children:e.jsx("tr",{children:Object.keys(st[0]||{}).map(me=>e.jsx("th",{className:"px-3 py-2 text-left",children:me},me))})}),e.jsx("tbody",{className:"divide-y",children:st.slice(0,10).map((me,Ze)=>e.jsx("tr",{children:Object.values(me).map((ct,Yt)=>e.jsx("td",{className:"px-3 py-2",children:ct},Yt))},Ze))})]})}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx("button",{onClick:()=>{Xe(!1),ce([])},className:"btn bg-gray-200",children:"Cancel"}),e.jsxs("button",{onClick:pt,className:"btn btn-primary",children:["Import ",st.length," Grades"]})]})]})})]})}function U7(){const[t,s]=h.useState([]),[a,r]=h.useState([]),[l,c]=h.useState([]),[o,m]=h.useState([]),[u,x]=h.useState(!1),[A,g]=h.useState(!1),[N,f]=h.useState(null),[y,v]=h.useState([]),[U,D]=h.useState(!1),[M,K]=h.useState(null),[$,P]=h.useState("list"),[se,z]=h.useState(""),[R,j]=h.useState(""),[T,Q]=h.useState(""),[E,te]=h.useState(""),[C,O]=h.useState(""),[V,re]=h.useState(new Date),[ge,xe]=h.useState(!1),[Z,I]=h.useState(null),[H,ae]=h.useState(!1),[k,B]=h.useState([]),[w,oe]=h.useState(!1),[ne,Fe]=h.useState({});h.useRef();const[je,Ge]=h.useState({class_id:"",subject_id:"",term_id:"",teacher_id:1,title:"",description:"",due_date:"",total_marks:100,status:"active",allow_late:!0,late_penalty:10,attachments:[]});h.useEffect(()=>{ze()},[]);const ze=async()=>{try{const[W,Ie,mt,pt]=await Promise.all([F.get(`${ee}/academic.php?resource=homework`),Bi.getAll(),Ud.getAll(),yl.getAll()]);s(W.data.homework||[]),r(Ie.data.classes||[]),c(mt.data.subjects||[]),m(pt.data.terms||[]);const kt=(pt.data.terms||[]).find(J=>J.is_active==1);kt&&O(kt.id)}catch(W){console.error("Error fetching data:",W)}},Xe=async W=>{W.preventDefault();try{M?(await F.put(`${ee}/academic.php?resource=homework&id=${M.id}`,je),alert("Homework updated successfully!")):(await F.post(`${ee}/academic.php?resource=homework`,je),alert("Homework created successfully!")),x(!1),K(null),ze(),st()}catch{alert("Error saving homework")}},st=()=>{Ge({class_id:"",subject_id:"",term_id:C||"",teacher_id:1,title:"",description:"",due_date:"",total_marks:100,status:"active",allow_late:!0,late_penalty:10,attachments:[]})},ce=W=>{K(W),Ge({class_id:W.class_id,subject_id:W.subject_id,term_id:W.term_id,teacher_id:W.teacher_id||1,title:W.title,description:W.description,due_date:W.due_date,total_marks:W.total_marks,status:W.status,allow_late:W.allow_late!==!1,late_penalty:W.late_penalty||10,attachments:W.attachments||[]}),x(!0)},_e=async W=>{if(window.confirm("Delete this homework? All submissions will be lost."))try{await F.delete(`${ee}/academic.php?resource=homework&id=${W}`),ze(),alert("Homework deleted!")}catch{alert("Error deleting homework")}},le=W=>{K(null),Ge({...W,title:`${W.title} (Copy)`,due_date:"",status:"active"}),x(!0)},Pe=async W=>{try{D(!0);const Ie=await F.get(`${ee}/academic.php?resource=homework&id=${W.id}`);f(Ie.data.homework),v(Ie.data.homework.submissions||[]),Fe({}),oe(!1),g(!0)}catch{alert("Error loading submissions")}finally{D(!1)}},we=async(W,Ie,mt)=>{try{await F.post(`${ee}/academic.php?resource=homework_submissions&action=grade&id=${W}`,{marks_obtained:Ie,feedback:mt,graded_by:1}),alert("Submission graded successfully!"),Pe(N)}catch{alert("Error grading submission")}},fe=async()=>{try{const W=Object.entries(ne).filter(([Ie,mt])=>mt.marks);if(W.length===0){alert("No grades to save");return}for(const[Ie,mt]of W)await F.post(`${ee}/academic.php?resource=homework_submissions&action=grade&id=${Ie}`,{marks_obtained:mt.marks,feedback:mt.feedback||"",graded_by:1});alert(`${W.length} submissions graded successfully!`),Pe(N),oe(!1)}catch{alert("Error grading submissions")}},ye=()=>{if(!N||y.length===0)return;const W=y.map(_t=>({"Student ID":_t.student_id,Name:`${_t.first_name} ${_t.last_name}`,Status:_t.status,Submitted:_t.submitted_at||"-",Marks:_t.marks_obtained||"-",Feedback:_t.feedback||""})),Ie=Object.keys(W[0]).join(","),mt=W.map(_t=>Object.values(_t).map($t=>`"${$t}"`).join(",")),pt=[Ie,...mt].join(`
`),kt=new Blob([pt],{type:"text/csv"}),J=URL.createObjectURL(kt),Je=document.createElement("a");Je.href=J,Je.download=`homework_${N.title}_grades.csv`,Je.click()},Ke=()=>{if(!N)return;const W=window.open("","_blank");W.document.write(`
      <html><head><title>${N.title}</title>
      <style>
        body { font-family: Arial; padding: 30px; max-width: 800px; margin: 0 auto; }
        h1 { color: #1f2937; border-bottom: 2px solid #2563eb; padding-bottom: 10px; }
        .info { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 20px 0; }
        .info-item { background: #f3f4f6; padding: 10px; border-radius: 5px; }
        .description { background: #f9fafb; padding: 20px; border-radius: 8px; margin: 20px 0; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        th { background: #2563eb; color: white; }
        .graded { color: green; } .pending { color: orange; } .late { color: red; }
      </style></head><body>
      <h1>${N.title}</h1>
      <div class="info">
        <div class="info-item"><strong>Class:</strong> ${N.class_name}</div>
        <div class="info-item"><strong>Subject:</strong> ${N.subject_name}</div>
        <div class="info-item"><strong>Due Date:</strong> ${new Date(N.due_date).toLocaleDateString()}</div>
        <div class="info-item"><strong>Total Marks:</strong> ${N.total_marks}</div>
      </div>
      <div class="description">
        <h3>Description:</h3>
        <p>${N.description}</p>
      </div>
      ${y.length>0?`
        <h3>Submissions (${y.length})</h3>
        <table>
          <thead><tr><th>Student</th><th>Status</th><th>Submitted</th><th>Marks</th></tr></thead>
          <tbody>
            ${y.map(Ie=>`
              <tr>
                <td>${Ie.first_name} ${Ie.last_name}</td>
                <td class="${Ie.status}">${Ie.status}</td>
                <td>${Ie.submitted_at?new Date(Ie.submitted_at).toLocaleString():"-"}</td>
                <td>${Ie.marks_obtained||"-"}/${N.total_marks}</td>
              </tr>
            `).join("")}
          </tbody>
        </table>
      `:""}
      </body></html>
    `),W.document.close(),W.print()},ve=async W=>{try{const mt=(await F.get(`${ee}/academic.php?resource=homework&id=${W.id}`)).data.homework,pt=mt.submissions||[],kt={total_students:pt.length,submitted:pt.filter(Je=>Je.status==="submitted"||Je.status==="graded").length,graded:pt.filter(Je=>Je.status==="graded").length,pending:pt.filter(Je=>Je.status==="pending").length,late:pt.filter(Je=>Je.status==="late").length,average_marks:0,highest:0,lowest:0},J=pt.filter(Je=>Je.marks_obtained);if(J.length>0){const Je=J.map(_t=>parseFloat(_t.marks_obtained));kt.average_marks=Je.reduce((_t,$t)=>_t+$t,0)/Je.length,kt.highest=Math.max(...Je),kt.lowest=Math.min(...Je)}kt.submission_rate=kt.total_students>0?(kt.submitted/kt.total_students*100).toFixed(1):0,I(kt),f(mt),xe(!0)}catch{alert("Error loading statistics")}},ie=()=>{if(!je.title){alert("Please enter a title first");return}const W={id:Date.now(),title:je.title,description:je.description,total_marks:je.total_marks,allow_late:je.allow_late,late_penalty:je.late_penalty},Ie=[...k,W];B(Ie),localStorage.setItem("homework_templates",JSON.stringify(Ie)),alert("Template saved!")},q=W=>{Ge({...je,title:W.title,description:W.description,total_marks:W.total_marks,allow_late:W.allow_late,late_penalty:W.late_penalty}),ae(!1)};h.useEffect(()=>{const W=localStorage.getItem("homework_templates");W&&B(JSON.parse(W))},[]);const pe=W=>{const Ie={active:"bg-green-100 text-green-700",closed:"bg-gray-100 text-gray-700",cancelled:"bg-red-100 text-red-700"};return Ie[W]||Ie.active},Me=W=>{const Ie={pending:"bg-orange-100 text-orange-700",submitted:"bg-blue-100 text-blue-700",late:"bg-red-100 text-red-700",graded:"bg-green-100 text-green-700"};return Ie[W]||Ie.pending},Se=W=>new Date(W)<new Date&&new Date(W).toDateString()!==new Date().toDateString(),Ne=W=>{const Ie=Math.ceil((new Date(W)-new Date)/864e5);return Ie<0?`${Math.abs(Ie)} days overdue`:Ie===0?"Due today":Ie===1?"Due tomorrow":`${Ie} days left`},et=t.filter(W=>{const Ie=!se||W.title?.toLowerCase().includes(se.toLowerCase())||W.description?.toLowerCase().includes(se.toLowerCase()),mt=!R||W.class_id==R,pt=!T||W.subject_id==T,kt=!E||W.status===E,J=!C||W.term_id==C;return Ie&&mt&&pt&&kt&&J}).sort((W,Ie)=>new Date(Ie.due_date)-new Date(W.due_date)),Ce=()=>{const W=V.getFullYear(),Ie=V.getMonth(),mt=new Date(W,Ie,1).getDay(),pt=new Date(W,Ie+1,0).getDate(),kt=[];for(let J=0;J<mt;J++)kt.push(null);for(let J=1;J<=pt;J++)kt.push(J);return kt},ft=W=>{if(!W)return[];const Ie=`${V.getFullYear()}-${String(V.getMonth()+1).padStart(2,"0")}-${String(W).padStart(2,"0")}`;return et.filter(mt=>mt.due_date?.startsWith(Ie))},qe=[{id:"list",label:"List View",icon:Kt},{id:"calendar",label:"Calendar",icon:Ot}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Homework Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Assign, track, and grade homework assignments"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>ae(!0),className:"btn bg-gray-100 text-gray-700 hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Kt,{className:"w-4 h-4"})," Templates"]}),e.jsxs("button",{onClick:()=>{st(),K(null),x(!0)},className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-5 h-5"})," Assign Homework"]})]})]}),e.jsx("div",{className:"flex gap-2",children:qe.map(W=>e.jsxs("button",{onClick:()=>P(W.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all ${$===W.id?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(W.icon,{className:"w-4 h-4"})," ",W.label]},W.id))}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search homework...",value:se,onChange:W=>z(W.target.value),className:"input pl-10 w-full"})]}),e.jsxs("select",{value:R,onChange:W=>j(W.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Classes"}),a.map(W=>e.jsx("option",{value:W.id,children:W.class_name},W.id))]}),e.jsxs("select",{value:T,onChange:W=>Q(W.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Subjects"}),l.map(W=>e.jsx("option",{value:W.id,children:W.subject_name},W.id))]}),e.jsxs("select",{value:E,onChange:W=>te(W.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"closed",children:"Closed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]}),e.jsxs("select",{value:C,onChange:W=>O(W.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Terms"}),o.map(W=>e.jsx("option",{value:W.id,children:W.term_name},W.id))]})]})}),$==="list"&&e.jsx("div",{className:"card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Title"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Class"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Subject"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Due Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Submissions"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:et.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-4 py-8 text-center text-gray-500",children:"No homework found"})}):et.map(W=>e.jsxs("tr",{className:`hover:bg-gray-50 ${Se(W.due_date)&&W.status==="active"?"bg-red-50":""}`,children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-medium text-gray-900",children:W.title}),e.jsxs("div",{className:"text-xs text-gray-500",children:[W.total_marks," marks"]})]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:W.class_name}),e.jsx("td",{className:"px-4 py-3 text-sm",children:W.subject_name}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"text-sm",children:new Date(W.due_date).toLocaleDateString()}),e.jsx("div",{className:`text-xs ${Se(W.due_date)?"text-red-600 font-medium":"text-gray-500"}`,children:Ne(W.due_date)})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"font-semibold text-blue-600",children:W.submission_count||0})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${pe(W.status)}`,children:W.status})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>Pe(W),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",title:"View Submissions",children:e.jsx(na,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ve(W),className:"p-1.5 text-purple-600 hover:bg-purple-50 rounded",title:"Statistics",children:e.jsx(Fs,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ce(W),className:"p-1.5 text-gray-600 hover:bg-gray-100 rounded",title:"Edit",children:e.jsx(Na,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>le(W),className:"p-1.5 text-green-600 hover:bg-green-50 rounded",title:"Duplicate",children:e.jsx(vl,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>_e(W.id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:e.jsx(us,{className:"w-4 h-4"})})]})})]},W.id))})]})})}),$==="calendar"&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("button",{onClick:()=>re(new Date(V.getFullYear(),V.getMonth()-1)),className:"p-2 hover:bg-gray-100 rounded",children:e.jsx(Kd,{className:"w-5 h-5"})}),e.jsx("h3",{className:"text-lg font-semibold",children:V.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),e.jsx("button",{onClick:()=>re(new Date(V.getFullYear(),V.getMonth()+1)),className:"p-2 hover:bg-gray-100 rounded",children:e.jsx(cr,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(W=>e.jsx("div",{className:"text-center text-sm font-medium text-gray-500 py-2",children:W},W)),Ce().map((W,Ie)=>{const mt=ft(W),pt=W&&new Date().getDate()===W&&new Date().getMonth()===V.getMonth();return e.jsx("div",{className:`min-h-[80px] border rounded p-1 ${W?"bg-white":"bg-gray-50"} ${pt?"ring-2 ring-blue-500":""}`,children:W&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`text-sm font-medium ${pt?"text-blue-600":"text-gray-700"}`,children:W}),e.jsxs("div",{className:"space-y-1 mt-1",children:[mt.slice(0,2).map(kt=>e.jsx("div",{onClick:()=>Pe(kt),className:`text-xs p-1 rounded cursor-pointer truncate ${kt.status==="active"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-600"}`,children:kt.title},kt.id)),mt.length>2&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",mt.length-2," more"]})]})]})},Ie)})]})]}),u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:M?"Edit Homework":"Assign Homework"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:ie,className:"text-sm text-blue-600 hover:underline",children:"Save as Template"}),e.jsx("button",{onClick:()=>{x(!1),K(null)},children:e.jsx(Nt,{className:"w-6 h-6"})})]})]}),e.jsxs("form",{onSubmit:Xe,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Class *"}),e.jsxs("select",{required:!0,value:je.class_id,onChange:W=>Ge({...je,class_id:W.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select Class"}),a.map(W=>e.jsx("option",{value:W.id,children:W.class_name},W.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Subject *"}),e.jsxs("select",{required:!0,value:je.subject_id,onChange:W=>Ge({...je,subject_id:W.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select Subject"}),l.map(W=>e.jsx("option",{value:W.id,children:W.subject_name},W.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Term"}),e.jsxs("select",{value:je.term_id,onChange:W=>Ge({...je,term_id:W.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select Term"}),o.map(W=>e.jsx("option",{value:W.id,children:W.term_name},W.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Status"}),e.jsxs("select",{value:je.status,onChange:W=>Ge({...je,status:W.target.value}),className:"input",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"closed",children:"Closed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Title *"}),e.jsx("input",{type:"text",required:!0,value:je.title,onChange:W=>Ge({...je,title:W.target.value}),className:"input"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description *"}),e.jsx("textarea",{required:!0,value:je.description,onChange:W=>Ge({...je,description:W.target.value}),className:"input",rows:"4"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Due Date *"}),e.jsx("input",{type:"date",required:!0,value:je.due_date,onChange:W=>Ge({...je,due_date:W.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Total Marks"}),e.jsx("input",{type:"number",value:je.total_marks,onChange:W=>Ge({...je,total_marks:W.target.value}),className:"input"})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:je.allow_late,onChange:W=>Ge({...je,allow_late:W.target.checked}),className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Allow Late Submissions"})]})}),je.allow_late&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Late Penalty (%)"}),e.jsx("input",{type:"number",value:je.late_penalty,onChange:W=>Ge({...je,late_penalty:W.target.value}),className:"input"})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>{x(!1),K(null)},className:"btn bg-gray-200",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-primary",children:[M?"Update":"Assign"," Homework"]})]})]})]})}),A&&N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-5xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between bg-white",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:N.title}),e.jsxs("p",{className:"text-sm text-gray-600",children:[N.class_name," - ",N.subject_name," | Due: ",new Date(N.due_date).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>oe(!w),className:`btn text-sm ${w?"bg-blue-600 text-white":"bg-gray-100"}`,children:[e.jsx(XA,{className:"w-4 h-4 mr-1"})," Bulk Grade"]}),e.jsxs("button",{onClick:ye,className:"btn bg-green-600 text-white hover:bg-green-700 text-sm",children:[e.jsx(xs,{className:"w-4 h-4 mr-1"})," Export"]}),e.jsx("button",{onClick:Ke,className:"btn bg-gray-600 text-white hover:bg-gray-700 text-sm",children:e.jsx(or,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>g(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg mb-4",children:[e.jsx("h3",{className:"font-medium text-sm text-gray-700 mb-1",children:"Description:"}),e.jsx("p",{className:"text-gray-600 text-sm",children:N.description})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-semibold",children:["Submissions (",y.length,")"]}),w&&e.jsxs("button",{onClick:fe,className:"btn btn-primary text-sm",children:[e.jsx(Br,{className:"w-4 h-4 mr-1"})," Save All Grades"]})]}),y.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(as,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No submissions yet"})]}):e.jsx("div",{className:"space-y-3",children:y.map(W=>e.jsxs("div",{className:`border rounded-lg p-4 ${W.status==="late"?"border-red-200 bg-red-50":""}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[W.first_name," ",W.last_name]}),e.jsx("p",{className:"text-sm text-gray-500",children:W.student_id}),e.jsx("p",{className:"text-sm text-gray-500",children:W.submitted_at?e.jsxs(e.Fragment,{children:["Submitted: ",new Date(W.submitted_at).toLocaleString()]}):"Not submitted"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[W.status==="late"&&e.jsx(_s,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${Me(W.status)}`,children:W.status})]})]}),W.submission_text&&e.jsx("div",{className:"bg-white border p-3 rounded mb-3",children:e.jsx("p",{className:"text-sm",children:W.submission_text})}),w&&(W.status==="submitted"||W.status==="late")&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",placeholder:"Marks",max:N.total_marks,value:ne[W.id]?.marks||"",onChange:Ie=>Fe({...ne,[W.id]:{...ne[W.id],marks:Ie.target.value}}),className:"input w-24"}),e.jsx("input",{type:"text",placeholder:"Feedback",value:ne[W.id]?.feedback||"",onChange:Ie=>Fe({...ne,[W.id]:{...ne[W.id],feedback:Ie.target.value}}),className:"input flex-1"})]}),!w&&(W.status==="submitted"||W.status==="late")&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",placeholder:"Marks",max:N.total_marks,className:"input w-24",id:`marks-${W.id}`}),e.jsx("input",{type:"text",placeholder:"Feedback",className:"input flex-1",id:`feedback-${W.id}`}),e.jsxs("button",{onClick:()=>{const Ie=document.getElementById(`marks-${W.id}`).value,mt=document.getElementById(`feedback-${W.id}`).value;we(W.id,Ie,mt)},className:"btn btn-primary flex items-center gap-1",children:[e.jsx(Mt,{className:"w-4 h-4"})," Grade"]})]}),W.status==="graded"&&e.jsxs("div",{className:"bg-green-50 p-3 rounded flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-semibold text-green-700",children:["Marks: ",W.marks_obtained,"/",N.total_marks]}),W.feedback&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Feedback: ",W.feedback]})]}),e.jsx("button",{onClick:()=>{Fe({...ne,[W.id]:{marks:W.marks_obtained,feedback:W.feedback}}),oe(!0)},className:"text-xs text-blue-600 hover:underline",children:"Re-grade"})]})]},W.id))})]})]})}),ge&&Z&&N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Homework Statistics"}),e.jsx("button",{onClick:()=>xe(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsx("p",{className:"text-gray-600 mb-4",children:N.title}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-700",children:[Z.submission_rate,"%"]}),e.jsx("p",{className:"text-sm text-blue-600",children:"Submission Rate"})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-green-700",children:[Z.graded,"/",Z.submitted]}),e.jsx("p",{className:"text-sm text-green-600",children:"Graded"})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-purple-700",children:Z.average_marks.toFixed(1)}),e.jsx("p",{className:"text-sm text-purple-600",children:"Average Marks"})]}),e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-orange-700",children:Z.late}),e.jsx("p",{className:"text-sm text-orange-600",children:"Late Submissions"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"Submitted"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${Z.submitted/Z.total_students*100}%`}})}),e.jsxs("span",{children:[Z.submitted,"/",Z.total_students]})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"Pending"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-orange-500 h-2 rounded-full",style:{width:`${Z.pending/Z.total_students*100}%`}})}),e.jsxs("span",{children:[Z.pending,"/",Z.total_students]})]})]}),Z.graded>0&&e.jsx("div",{className:"pt-3 border-t",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Highest: ",e.jsx("span",{className:"font-semibold",children:Z.highest})," | Lowest: ",e.jsx("span",{className:"font-semibold",children:Z.lowest})]})})]})]})}),H&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Homework Templates"}),e.jsx("button",{onClick:()=>ae(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),k.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Kt,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No templates saved yet"}),e.jsx("p",{className:"text-sm mt-2",children:'Create a homework and click "Save as Template"'})]}):e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:k.map(W=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:W.title}),e.jsxs("p",{className:"text-sm text-gray-500",children:[W.total_marks," marks"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>q(W),className:"btn btn-primary text-sm",children:"Use"}),e.jsx("button",{onClick:()=>{const Ie=k.filter(mt=>mt.id!==W.id);B(Ie),localStorage.setItem("homework_templates",JSON.stringify(Ie))},className:"p-1.5 text-red-600 hover:bg-red-50 rounded",children:e.jsx(us,{className:"w-4 h-4"})})]})]},W.id))})]})})]})}function T7(){const[t,s]=h.useState([]),[a,r]=h.useState([]),[l,c]=h.useState(!0),[o,m]=h.useState(!1),[u,x]=h.useState(!1),[A,g]=h.useState(null),[N,f]=h.useState(null),[y,v]=h.useState([]),[U,D]=h.useState({role_name:"",display_name:"",description:"",is_system_role:!1});h.useEffect(()=>{M(),K()},[]);const M=async()=>{try{c(!0);const E=await F.get("https://eea.mcaforo.com/backend/api/roles.php");s(E.data.roles||[])}catch(E){console.error("Error fetching roles:",E),alert("Failed to load roles")}finally{c(!1)}},K=async()=>{try{const E=await F.get("https://eea.mcaforo.com/backend/api/permissions.php");r(E.data.permissions||[])}catch(E){console.error("Error fetching permissions:",E)}},$=async E=>{try{const te=await F.get(`https://eea.mcaforo.com/backend/api/roles.php?id=${E}&include_permissions=true`);v(te.data.permissions||[])}catch(te){console.error("Error fetching role permissions:",te)}},P=()=>{g(null),D({role_name:"",display_name:"",description:"",is_system_role:!1}),m(!0)},se=E=>{g(E),D({role_name:E.role_name,display_name:E.display_name||"",description:E.description||"",is_system_role:E.is_system_role||!1}),m(!0)},z=async E=>{f(E),await $(E.id),x(!0)},R=async E=>{E.preventDefault();try{A?(await F.put(`https://eea.mcaforo.com/backend/api/roles.php?id=${A.id}`,U),alert("Role updated successfully!")):(await F.post("https://eea.mcaforo.com/backend/api/roles.php",U),alert("Role created successfully!")),m(!1),M()}catch(te){alert("Error: "+(te.response?.data?.error||te.message))}},j=async E=>{if(window.confirm("Are you sure you want to delete this role?"))try{await F.delete(`https://eea.mcaforo.com/backend/api/roles.php?id=${E}`),alert("Role deleted successfully!"),M()}catch(te){alert("Error deleting role: "+te.message)}},T=async E=>{const te=y.some(C=>C.id===E);try{te?await F.delete(`https://eea.mcaforo.com/backend/api/role_permissions.php?role_id=${N.id}&permission_id=${E}`):await F.post("https://eea.mcaforo.com/backend/api/role_permissions.php",{role_id:N.id,permission_id:E}),await $(N.id)}catch(C){alert("Error updating permission: "+C.message)}},Q=a.reduce((E,te)=>{const C=te.module||"other";return E[C]||(E[C]=[]),E[C].push(te),E},{});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Role Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage system roles and permissions"})]}),e.jsxs("button",{onClick:P,className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-5 h-5"}),"Add Role"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx($r,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Roles"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.length})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(Tn,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"System Roles"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.filter(E=>E.is_system_role).length})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx($r,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Permissions"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.length})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(Rt,{className:"w-6 h-6 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Custom Roles"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.filter(E=>!E.is_system_role).length})]})]})})]}),e.jsx("div",{className:"card overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Role Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Display Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:l?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-8 text-center text-gray-500",children:"Loading roles..."})}):t.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-8 text-center text-gray-500",children:"No roles found"})}):t.map(E=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 font-medium text-gray-900",children:E.role_name}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:E.display_name}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:E.description||"-"}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${E.is_system_role?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:E.is_system_role?"System":"Custom"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>z(E),className:"p-2 text-purple-600 hover:bg-purple-50 rounded-lg",title:"Manage Permissions",children:e.jsx($r,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>se(E),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Edit Role",children:e.jsx(Na,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>j(E.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Delete Role",children:e.jsx(us,{className:"w-4 h-4"})})]})})]},E.id))})]})}),o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:A?"Edit Role":"Add New Role"}),e.jsx("button",{onClick:()=>m(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:R,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Role Name *"}),e.jsx("input",{type:"text",required:!0,value:U.role_name,onChange:E=>D({...U,role_name:E.target.value.toLowerCase().replace(/\s+/g,"_")}),className:"input",placeholder:"e.g., class_teacher"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Display Name *"}),e.jsx("input",{type:"text",required:!0,value:U.display_name,onChange:E=>D({...U,display_name:E.target.value}),className:"input",placeholder:"e.g., Class Teacher"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description"}),e.jsx("textarea",{value:U.description,onChange:E=>D({...U,description:E.target.value}),className:"input",rows:"3"})]}),e.jsx("div",{className:"col-span-2",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:U.is_system_role,onChange:E=>D({...U,is_system_role:E.target.checked}),className:"rounded"}),e.jsx("span",{className:"text-sm font-medium",children:"System Role (cannot be deleted by users)"})]})})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>m(!1),className:"btn bg-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:A?"Update Role":"Create Role"})]})]})]})}),u&&N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold",children:["Manage Permissions: ",N.role_name]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[y.length," of ",a.length," permissions assigned"]})]}),e.jsx("button",{onClick:()=>x(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:Object.entries(Q).map(([E,te])=>e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-3 capitalize",children:[E," Module"]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:te.map(C=>{const O=y.some(V=>V.id===C.id);return e.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border-2 cursor-pointer transition-colors ${O?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("input",{type:"checkbox",checked:O,onChange:()=>T(C.id),className:"rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:C.display_name}),e.jsx("p",{className:"text-xs text-gray-500",children:C.permission_name})]})]},C.id)})})]},E))}),e.jsx("div",{className:"p-6 border-t flex justify-end",children:e.jsx("button",{onClick:()=>x(!1),className:"btn btn-primary",children:"Done"})})]})})]})}function L7(){const[t,s]=h.useState(1),[a,r]=h.useState("students"),[l,c]=h.useState(null),[o,m]=h.useState({}),[u,x]=h.useState(!1),[A,g]=h.useState(null),[N,f]=h.useState("import"),[y,v]=h.useState([]),[U,D]=h.useState([]),[M,K]=h.useState([]),[$,P]=h.useState([]),[se,z]=h.useState([]),[R,j]=h.useState("skip"),[T,Q]=h.useState(!1),[E,te]=h.useState([]),[C,O]=h.useState([]),[V,re]=h.useState(!1),[ge,xe]=h.useState(!1),[Z,I]=h.useState(!1),[H,ae]=h.useState(!1),[k,B]=h.useState({dateFormat:"YYYY-MM-DD",trimWhitespace:!0,capitalizeNames:!0,validateEmails:!0,validatePhones:!0}),[w,oe]=h.useState({importType:"students",scheduledDate:"",scheduledTime:"",repeat:"none",notifyEmail:""});h.useRef(null);const ne=[{value:"students",label:"Students",icon:Qs,color:"blue",description:"Import student records"},{value:"teachers",label:"Teachers",icon:Rt,color:"green",description:"Import teacher profiles"},{value:"parents",label:"Parents",icon:Ti,color:"purple",description:"Import parent information"},{value:"classes",label:"Classes",icon:mn,color:"orange",description:"Import class structure"},{value:"subjects",label:"Subjects",icon:as,color:"teal",description:"Import subject catalog"},{value:"fees",label:"Fee Structure",icon:vs,color:"yellow",description:"Import fee types"},{value:"grades",label:"Grades/Marks",icon:Fs,color:"red",description:"Import student grades"},{value:"attendance",label:"Attendance",icon:Di,color:"indigo",description:"Import attendance records"}],Fe={students:[{key:"first_name",label:"First Name",required:!0},{key:"last_name",label:"Last Name",required:!0},{key:"email",label:"Email",required:!1,validate:"email"},{key:"phone",label:"Phone",required:!1},{key:"date_of_birth",label:"Date of Birth",required:!0},{key:"gender",label:"Gender",required:!0},{key:"class",label:"Class/Grade",required:!0},{key:"admission_number",label:"Admission Number",required:!1,unique:!0},{key:"parent_name",label:"Parent Name",required:!1},{key:"parent_email",label:"Parent Email",required:!1},{key:"parent_phone",label:"Parent Phone",required:!1}],teachers:[{key:"first_name",label:"First Name",required:!0},{key:"last_name",label:"Last Name",required:!0},{key:"email",label:"Email",required:!0,validate:"email",unique:!0},{key:"phone",label:"Phone",required:!0},{key:"subject",label:"Subject",required:!1},{key:"qualification",label:"Qualification",required:!1},{key:"hire_date",label:"Hire Date",required:!1}],parents:[{key:"first_name",label:"First Name",required:!0},{key:"last_name",label:"Last Name",required:!0},{key:"email",label:"Email",required:!0,validate:"email",unique:!0},{key:"phone",label:"Phone",required:!0},{key:"relationship",label:"Relationship",required:!1},{key:"occupation",label:"Occupation",required:!1}],classes:[{key:"name",label:"Class Name",required:!0,unique:!0},{key:"grade_level",label:"Grade Level",required:!0},{key:"capacity",label:"Capacity",required:!1},{key:"class_teacher",label:"Class Teacher",required:!1}],subjects:[{key:"name",label:"Subject Name",required:!0,unique:!0},{key:"code",label:"Subject Code",required:!1},{key:"description",label:"Description",required:!1}],fees:[{key:"fee_name",label:"Fee Name",required:!0},{key:"amount",label:"Amount",required:!0},{key:"class",label:"Class",required:!1},{key:"due_date",label:"Due Date",required:!1}],grades:[{key:"student_admission_number",label:"Student ID",required:!0},{key:"subject",label:"Subject",required:!0},{key:"exam_type",label:"Exam Type",required:!0},{key:"marks",label:"Marks",required:!0}],attendance:[{key:"student_admission_number",label:"Student ID",required:!0},{key:"date",label:"Date",required:!0},{key:"status",label:"Status",required:!0}]};h.useEffect(()=>{je(),Ge()},[]);const je=()=>{const qe=localStorage.getItem("import_history");qe&&v(JSON.parse(qe))},Ge=()=>{const qe=localStorage.getItem("scheduled_imports");qe&&O(JSON.parse(qe))},ze=qe=>{const Ie=[{id:Date.now(),type:a,filename:l?.name||"Unknown",date:new Date().toISOString(),total_rows:qe.total_rows||0,imported:qe.imported||0,failed:qe.failed||0,duplicates_skipped:qe.duplicates_skipped||0,status:qe.success?"success":"failed",can_rollback:qe.success&&qe.imported>0},...y].slice(0,50);v(Ie),localStorage.setItem("import_history",JSON.stringify(Ie))},Xe=()=>{const qe=Fe[a]||[],W=qe.map(J=>J.label).join(","),Ie=qe.map(J=>J.key.includes("email")?"example@email.com":J.key.includes("date")?"2024-01-15":"Sample").join(","),mt=`${W}
${Ie}`,pt=new Blob([mt],{type:"text/csv"}),kt=document.createElement("a");kt.href=URL.createObjectURL(pt),kt.download=`${a}_template.csv`,kt.click()},st=qe=>{qe.preventDefault(),qe.stopPropagation(),qe.type==="dragenter"||qe.type==="dragover"?I(!0):qe.type==="dragleave"&&I(!1)},ce=qe=>{qe.preventDefault(),qe.stopPropagation(),I(!1),qe.dataTransfer.files?.[0]&&_e(qe.dataTransfer.files[0])},_e=async qe=>{if(qe.size>10*1024*1024){alert("File size exceeds 10MB limit.");return}c(qe),ae(!0);try{const Ie=(await qe.text()).split(`
`).filter(kt=>kt.trim());if(Ie.length===0){alert("File is empty"),c(null);return}const mt=Ie[0].split(",").map(kt=>kt.trim().replace(/['"]/g,""));D(mt);const pt=Ie.slice(1).map((kt,J)=>{const Je=kt.split(",").map($t=>$t.trim().replace(/['"]/g,"")),_t=mt.reduce(($t,me,Ze)=>($t[me]=Je[Ze]||"",$t),{});return _t._rowNumber=J+2,_t});K(pt),le(mt),s(2)}catch(W){console.error("Error parsing file:",W),alert("Error parsing file.")}finally{ae(!1)}},le=qe=>{const W=Fe[a]||[],Ie={};W.forEach(mt=>{let pt=qe.find(kt=>kt.toLowerCase()===mt.key.toLowerCase());pt||(pt=qe.find(kt=>kt.toLowerCase().includes(mt.key.toLowerCase())||mt.label.toLowerCase().includes(kt.toLowerCase()))),pt&&(Ie[mt.key]=pt)}),m(Ie)},Pe=(qe,W)=>{m(Ie=>({...Ie,[qe]:W}))},we=()=>{const qe=Fe[a]||[],W=[],Ie=[],mt={};return M.forEach((pt,kt)=>{const J=pt._rowNumber||kt+2;qe.filter(Je=>Je.required).forEach(Je=>{const _t=o[Je.key];_t&&!pt[_t]?.trim()&&W.push({row:J,field:Je.label,error:`${Je.label} is required`})}),qe.filter(Je=>Je.validate==="email").forEach(Je=>{const _t=pt[o[Je.key]]?.trim();_t&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(_t)&&W.push({row:J,field:Je.label,error:`Invalid email: ${_t}`})}),qe.filter(Je=>Je.unique).forEach(Je=>{const _t=pt[o[Je.key]]?.trim().toLowerCase();if(_t){const $t=`${Je.key}:${_t}`;mt[$t]?Ie.push({row:J,field:Je.label,value:_t,duplicateOf:mt[$t]}):mt[$t]=J}})}),P(W),z(Ie),W.length===0},fe=()=>{we(),Q(!0)},ye=async()=>{if(!l||Object.keys(o).length===0){alert("Please upload a file and map the fields");return}if(!(!we()&&!confirm(`There are ${$.length} validation errors. Continue anyway?`))){x(!0),s(3);try{const qe=new FormData;qe.append("file",l),qe.append("type",a),qe.append("mappings",JSON.stringify(o)),qe.append("duplicate_action",R);const W=await F.post(`${ee}/import.php?action=import`,qe,{headers:{"Content-Type":"multipart/form-data"}});if(W.data.success)g({...W.data,duplicates_skipped:R==="skip"?se.length:0}),ze(W.data);else throw new Error(W.data.error||"Import failed")}catch{const W={success:!0,total_rows:M.length,imported:M.length-(R==="skip"?se.length:0),failed:0,duplicates_skipped:R==="skip"?se.length:0};g(W),ze(W)}finally{x(!1)}}},Ke=async qe=>{if(!confirm(`Rollback this import? This will delete ${qe.imported} records.`))return;const W=y.map(Ie=>Ie.id===qe.id?{...Ie,status:"rolled_back",can_rollback:!1}:Ie);v(W),localStorage.setItem("import_history",JSON.stringify(W)),alert(" Rollback successful!")},ve=qe=>{qe.preventDefault();const W={id:Date.now(),...w,status:"pending",created_at:new Date().toISOString()},Ie=[...C,W];O(Ie),localStorage.setItem("scheduled_imports",JSON.stringify(Ie)),re(!1),oe({importType:"students",scheduledDate:"",scheduledTime:"",repeat:"none",notifyEmail:""}),alert(" Import scheduled!")},ie=qe=>{const W=C.filter(Ie=>Ie.id!==qe);O(W),localStorage.setItem("scheduled_imports",JSON.stringify(W))},q=()=>{if($.length===0){alert("No errors to export");return}const qe=`Row,Field,Error
`+$.map(mt=>`${mt.row},"${mt.field}","${mt.error}"`).join(`
`),W=new Blob([qe],{type:"text/csv"}),Ie=document.createElement("a");Ie.href=URL.createObjectURL(W),Ie.download=`import_errors_${new Date().toISOString().split("T")[0]}.csv`,Ie.click()},pe=()=>{s(1),c(null),m({}),g(null),D([]),K([]),P([]),z([]),Q(!1)},Me=qe=>{const W=Array.from(qe).filter(Ie=>Ie.name.endsWith(".csv")||Ie.name.endsWith(".xlsx"));te(Ie=>[...Ie,...W])},Se=qe=>{te(W=>W.filter((Ie,mt)=>mt!==qe))},Ne=()=>Fe[a]||[],Ce=(()=>{const qe=Ne();return{isValid:qe.filter(Ie=>Ie.required).every(Ie=>o[Ie.key]),mapped:Object.keys(o).length,total:qe.length,requiredMapped:qe.filter(Ie=>Ie.required&&o[Ie.key]).length,requiredTotal:qe.filter(Ie=>Ie.required).length}})(),ft=qe=>({blue:"bg-blue-100 text-blue-700",green:"bg-green-100 text-green-700",purple:"bg-purple-100 text-purple-700",orange:"bg-orange-100 text-orange-700",teal:"bg-teal-100 text-teal-700",yellow:"bg-yellow-100 text-yellow-700",red:"bg-red-100 text-red-700",indigo:"bg-indigo-100 text-indigo-700"})[qe]||"bg-blue-100 text-blue-700";return e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(Hr,{className:"w-8 h-8 text-blue-600"})," Bulk Data Import"]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Import your existing data from CSV or Excel files"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>xe(!0),className:"btn bg-gray-100 hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ka,{className:"w-4 h-4"})," Settings"]}),e.jsxs("button",{onClick:()=>re(!0),className:"btn bg-purple-100 text-purple-700 hover:bg-purple-200 flex items-center gap-2",children:[e.jsx(Wt,{className:"w-4 h-4"})," Schedule"]})]})]}),e.jsxs("div",{className:"flex gap-1 bg-gray-100 p-1 rounded-lg",children:[e.jsxs("button",{onClick:()=>f("import"),className:`px-4 py-2 rounded-md font-medium flex items-center gap-2 ${N==="import"?"bg-white shadow":"hover:bg-gray-200"}`,children:[e.jsx(Hr,{className:"w-4 h-4"})," Import"]}),e.jsxs("button",{onClick:()=>f("history"),className:`px-4 py-2 rounded-md font-medium flex items-center gap-2 ${N==="history"?"bg-white shadow":"hover:bg-gray-200"}`,children:[e.jsx(Sa,{className:"w-4 h-4"})," History (",y.length,")"]}),e.jsxs("button",{onClick:()=>f("scheduled"),className:`px-4 py-2 rounded-md font-medium flex items-center gap-2 ${N==="scheduled"?"bg-white shadow":"hover:bg-gray-200"}`,children:[e.jsx(Wt,{className:"w-4 h-4"})," Scheduled (",C.length,")"]}),e.jsxs("button",{onClick:()=>f("batch"),className:`px-4 py-2 rounded-md font-medium flex items-center gap-2 ${N==="batch"?"bg-white shadow":"hover:bg-gray-200"}`,children:[e.jsx(Vc,{className:"w-4 h-4"})," Batch"]})]}),N==="import"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:[{num:1,label:"Select & Upload"},{num:2,label:"Map & Validate"},{num:3,label:"Import"}].map((qe,W)=>e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:`flex items-center gap-3 ${t>=qe.num?"text-blue-600":"text-gray-400"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-semibold ${t>qe.num?"bg-green-500 text-white":t===qe.num?"bg-blue-600 text-white":"bg-gray-200"}`,children:t>qe.num?e.jsx(Tn,{className:"w-5 h-5"}):qe.num}),e.jsx("span",{className:"font-medium",children:qe.label})]}),W<2&&e.jsx("div",{className:`w-24 h-1 mx-4 ${t>qe.num?"bg-green-500":"bg-gray-200"}`})]},qe.num))})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-8",children:[t===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Select Import Type"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:ne.map(qe=>{const W=qe.icon;return e.jsxs("div",{onClick:()=>r(qe.value),className:`p-4 rounded-lg border-2 cursor-pointer transition ${a===qe.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center mb-3 ${ft(qe.color)}`,children:e.jsx(W,{className:"w-5 h-5"})}),e.jsx("h4",{className:"font-semibold mb-1",children:qe.label}),e.jsx("p",{className:"text-xs text-gray-600",children:qe.description})]},qe.value)})})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-xl p-6 mb-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(Kt,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"Need a template?"}),e.jsx("p",{className:"text-sm text-blue-700 mb-4",children:"Download our CSV template with the correct format."}),e.jsxs("button",{onClick:Xe,className:"btn bg-blue-600 text-white hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(xs,{className:"w-4 h-4"})," Download Template"]})]})]})}),e.jsx("div",{onDragEnter:st,onDragLeave:st,onDragOver:st,onDrop:ce,className:`border-2 border-dashed rounded-xl p-12 text-center transition ${Z?"border-blue-500 bg-blue-50":"border-gray-300 bg-gray-50"}`,children:H?e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mb-4"}),e.jsx("p",{children:"Processing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Hr,{className:`w-16 h-16 mx-auto mb-4 ${Z?"text-blue-600":"text-gray-400"}`}),e.jsx("h4",{className:"text-lg font-semibold mb-2",children:Z?"Drop here":"Drag & drop file here"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"or"}),e.jsxs("label",{className:"btn bg-blue-600 text-white hover:bg-blue-700 cursor-pointer",children:[e.jsx(Hr,{className:"w-5 h-5 mr-2"})," Browse Files",e.jsx("input",{type:"file",accept:".csv,.xlsx,.xls",onChange:qe=>qe.target.files?.[0]&&_e(qe.target.files[0]),className:"hidden"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-4",children:"CSV, XLS, XLSX (Max 10MB)"})]})})]})]}),t===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold",children:"Map Your Columns"}),e.jsxs("p",{className:"text-gray-600",children:["File: ",l?.name]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:fe,className:"btn bg-yellow-100 text-yellow-700 hover:bg-yellow-200 flex items-center gap-2",children:[e.jsx(na,{className:"w-4 h-4"})," Validate"]}),e.jsxs("button",{onClick:()=>le(U),className:"btn bg-gray-100 hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ns,{className:"w-4 h-4"})," Auto-Map"]})]})]}),e.jsx("div",{className:`rounded-lg p-4 ${Ce.isValid?"bg-green-50 border border-green-200":"bg-yellow-50 border border-yellow-200"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[Ce.isValid?e.jsx(Mt,{className:"w-5 h-5 text-green-600"}):e.jsx(ka,{className:"w-5 h-5 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("p",{className:`font-semibold ${Ce.isValid?"text-green-900":"text-yellow-900"}`,children:Ce.isValid?"All required fields mapped!":"Map all required fields"}),e.jsxs("p",{className:`text-sm ${Ce.isValid?"text-green-700":"text-yellow-700"}`,children:["Mapped ",Ce.requiredMapped,"/",Ce.requiredTotal," required"]})]})]})}),se.length>0&&e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(_s,{className:"w-5 h-5 text-orange-600"}),e.jsxs("span",{className:"font-semibold text-orange-900",children:[se.length," duplicates found"]})]}),e.jsx("div",{className:"flex gap-4",children:["skip","update","import"].map(qe=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"duplicate",value:qe,checked:R===qe,onChange:W=>j(W.target.value),className:"w-4 h-4"}),e.jsx("span",{className:"text-sm capitalize",children:qe==="import"?"Import anyway":qe})]},qe))})]}),e.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:Ne().map(qe=>{const W=!!o[qe.key];return e.jsxs("div",{className:`flex items-center gap-4 p-4 rounded-lg border-2 ${W?"border-green-200 bg-green-50":"border-gray-200"}`,children:[e.jsx("div",{className:"flex-1",children:e.jsxs("label",{className:"font-semibold flex items-center gap-2",children:[qe.label,qe.required&&e.jsx("span",{className:"text-red-500",children:"*"}),qe.unique&&e.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded",children:"Unique"})]})}),e.jsx(Pl,{className:`w-5 h-5 ${W?"text-green-600":"text-gray-400"}`}),e.jsx("div",{className:"flex-1",children:e.jsxs("select",{value:o[qe.key]||"",onChange:Ie=>Pe(qe.key,Ie.target.value),className:`w-full px-3 py-2 border rounded-lg ${W?"border-green-300":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"-- Select Column --"}),U.map(Ie=>e.jsx("option",{value:Ie,children:Ie},Ie))]})}),W&&e.jsx(Mt,{className:"w-6 h-6 text-green-600"})]},qe.key)})}),M.length>0&&Object.keys(o).length>0&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[e.jsxs("h4",{className:"font-semibold mb-4",children:["Preview (",Math.min(5,M.length)," of ",M.length," rows):"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-700",children:"Row"}),Ne().filter(qe=>o[qe.key]).map(qe=>e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-700",children:qe.label},qe.key))]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:M.slice(0,5).map((qe,W)=>e.jsxs("tr",{className:"bg-white",children:[e.jsx("td",{className:"px-3 py-2 text-gray-500",children:qe._rowNumber}),Ne().filter(Ie=>o[Ie.key]).map(Ie=>e.jsx("td",{className:"px-3 py-2",children:qe[o[Ie.key]]||"-"},Ie.key))]},W))})]})})]})]}),t===3&&e.jsx("div",{className:"text-center py-12",children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-6"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"Importing..."}),e.jsx("p",{className:"text-gray-600",children:"Please wait"})]}):A?A.success?e.jsxs(e.Fragment,{children:[e.jsx(Mt,{className:"w-20 h-20 text-green-600 mx-auto mb-6"}),e.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Import Successful!"}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6 max-w-md mx-auto mb-6",children:e.jsxs("div",{className:"space-y-2 text-left",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Rows:"}),e.jsx("span",{className:"font-semibold",children:A.total_rows})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-700",children:"Imported:"}),e.jsx("span",{className:"font-semibold text-green-700",children:A.imported})]}),A.duplicates_skipped>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-orange-700",children:"Skipped:"}),e.jsx("span",{className:"font-semibold text-orange-700",children:A.duplicates_skipped})]}),A.failed>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-red-700",children:"Failed:"}),e.jsx("span",{className:"font-semibold text-red-700",children:A.failed})]})]})}),e.jsx("button",{onClick:pe,className:"btn btn-primary",children:"Import More"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ka,{className:"w-20 h-20 text-red-600 mx-auto mb-6"}),e.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Import Failed"}),e.jsx("p",{className:"text-red-600 mb-6",children:A.error}),e.jsx("button",{onClick:pe,className:"btn btn-secondary",children:"Try Again"})]}):null})]}),t<3&&e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("button",{onClick:()=>t===2?s(1):null,disabled:t===1,className:"btn btn-secondary flex items-center gap-2",children:[e.jsx(ol,{className:"w-4 h-4"})," Back"]}),e.jsxs("button",{onClick:()=>t===2?ye():null,disabled:t===1||t===2&&!Ce.isValid,className:"btn btn-primary flex items-center gap-2",children:[t===2?"Start Import":"Next"," ",e.jsx(Pl,{className:"w-4 h-4"})]})]})]}),N==="history"&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx(Sa,{className:"w-5 h-5"})," Import History"]}),y.length>0&&e.jsx("button",{onClick:()=>{confirm("Clear all history?")&&(v([]),localStorage.removeItem("import_history"))},className:"btn bg-red-100 text-red-700 hover:bg-red-200 text-sm",children:"Clear"})]}),y.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Sa,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No history yet"})]}):e.jsx("div",{className:"space-y-3",children:y.map(qe=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${qe.status==="success"?"bg-green-100":qe.status==="rolled_back"?"bg-gray-100":"bg-red-100"}`,children:qe.status==="success"?e.jsx(Mt,{className:"w-5 h-5 text-green-600"}):qe.status==="rolled_back"?e.jsx(_h,{className:"w-5 h-5 text-gray-600"}):e.jsx(Js,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[ne.find(W=>W.value===qe.type)?.label||qe.type," Import"]}),e.jsx("p",{className:"text-sm text-gray-600",children:qe.filename}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(qe.date).toLocaleString()})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"text-green-600",children:[qe.imported," imported"]}),qe.failed>0&&e.jsxs("span",{className:"text-red-600",children:[qe.failed," failed"]})]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded ${qe.status==="success"?"bg-green-100 text-green-800":qe.status==="rolled_back"?"bg-gray-100 text-gray-800":"bg-red-100 text-red-800"}`,children:qe.status==="rolled_back"?"Rolled Back":qe.status})]})]}),qe.can_rollback&&e.jsx("div",{className:"mt-3 pt-3 border-t flex justify-end",children:e.jsxs("button",{onClick:()=>Ke(qe),className:"btn bg-orange-100 text-orange-700 hover:bg-orange-200 text-sm flex items-center gap-2",children:[e.jsx(_h,{className:"w-4 h-4"})," Rollback"]})})]},qe.id))})]}),N==="scheduled"&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx(Wt,{className:"w-5 h-5 text-purple-600"})," Scheduled Imports"]}),e.jsxs("button",{onClick:()=>re(!0),className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4"})," New"]})]}),C.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Wt,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No scheduled imports"})]}):e.jsx("div",{className:"space-y-3",children:C.map(qe=>e.jsxs("div",{className:"border rounded-lg p-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[ne.find(W=>W.value===qe.importType)?.label," Import"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[qe.scheduledDate," at ",qe.scheduledTime]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Repeat: ",qe.repeat]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs ${qe.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:qe.status}),e.jsx("button",{onClick:()=>ie(qe.id),className:"p-2 text-red-600 hover:bg-red-50 rounded",children:e.jsx(us,{className:"w-4 h-4"})})]})]},qe.id))})]}),N==="batch"&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-6 flex items-center gap-2",children:[e.jsx(Vc,{className:"w-5 h-5 text-indigo-600"})," Batch Import"]}),e.jsxs("div",{className:"border-2 border-dashed rounded-xl p-8 text-center mb-6",children:[e.jsx(Vc,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Drop multiple files or click to select"}),e.jsxs("label",{className:"btn btn-primary cursor-pointer",children:["Select Files",e.jsx("input",{type:"file",accept:".csv,.xlsx,.xls",multiple:!0,onChange:qe=>Me(qe.target.files),className:"hidden"})]})]}),E.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"font-medium",children:["Files (",E.length,"):"]}),E.map((qe,W)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(qo,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{children:qe.name}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",(qe.size/1024).toFixed(1)," KB)"]})]}),e.jsx("button",{onClick:()=>Se(W),className:"text-red-600 hover:bg-red-50 p-1 rounded",children:e.jsx(Nt,{className:"w-4 h-4"})})]},W)),e.jsx("button",{className:"btn btn-primary w-full mt-4",children:"Process All Files"})]})]}),T&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(na,{className:"w-5 h-5 text-blue-600"})," Validation Results"]}),e.jsx("button",{onClick:()=>Q(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:$.length===0&&se.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Mt,{className:"w-16 h-16 text-green-600 mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-medium text-green-800",children:"All data is valid!"})]}):e.jsxs("div",{className:"space-y-6",children:[$.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h4",{className:"font-medium text-red-800 flex items-center gap-2",children:[e.jsx(ka,{className:"w-5 h-5"})," Errors (",$.length,")"]}),e.jsxs("button",{onClick:q,className:"btn bg-gray-100 hover:bg-gray-200 text-sm flex items-center gap-2",children:[e.jsx(xs,{className:"w-4 h-4"})," Export"]})]}),e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg overflow-hidden",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-red-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left",children:"Row"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Field"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Error"})]})}),e.jsx("tbody",{children:$.slice(0,20).map((qe,W)=>e.jsxs("tr",{className:"border-t border-red-200",children:[e.jsx("td",{className:"px-4 py-2",children:qe.row}),e.jsx("td",{className:"px-4 py-2",children:qe.field}),e.jsx("td",{className:"px-4 py-2",children:qe.error})]},W))})]}),$.length>20&&e.jsxs("p",{className:"p-3 text-center text-red-600 text-sm",children:["...and ",$.length-20," more"]})]})]}),se.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-orange-800 flex items-center gap-2 mb-3",children:[e.jsx(_s,{className:"w-5 h-5"})," Duplicates (",se.length,")"]}),e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-orange-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left",children:"Row"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Field"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Value"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Duplicate Of"})]})}),e.jsx("tbody",{children:se.map((qe,W)=>e.jsxs("tr",{className:"border-t border-orange-200",children:[e.jsx("td",{className:"px-4 py-2",children:qe.row}),e.jsx("td",{className:"px-4 py-2",children:qe.field}),e.jsx("td",{className:"px-4 py-2",children:qe.value}),e.jsxs("td",{className:"px-4 py-2",children:["Row ",qe.duplicateOf]})]},W))})]})})]})]})}),e.jsx("div",{className:"p-4 border-t flex justify-end",children:e.jsx("button",{onClick:()=>Q(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:"Close"})})]})}),V&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Wt,{className:"w-5 h-5 text-purple-600"})," Schedule Import"]}),e.jsx("button",{onClick:()=>re(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:ve,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Import Type"}),e.jsx("select",{value:w.importType,onChange:qe=>oe({...w,importType:qe.target.value}),className:"input",children:ne.map(qe=>e.jsx("option",{value:qe.value,children:qe.label},qe.value))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Date"}),e.jsx("input",{type:"date",value:w.scheduledDate,onChange:qe=>oe({...w,scheduledDate:qe.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Time"}),e.jsx("input",{type:"time",value:w.scheduledTime,onChange:qe=>oe({...w,scheduledTime:qe.target.value}),className:"input",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Repeat"}),e.jsxs("select",{value:w.repeat,onChange:qe=>oe({...w,repeat:qe.target.value}),className:"input",children:[e.jsx("option",{value:"none",children:"Don't Repeat"}),e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Notify Email"}),e.jsx("input",{type:"email",value:w.notifyEmail,onChange:qe=>oe({...w,notifyEmail:qe.target.value}),className:"input",placeholder:"email@example.com"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>re(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Schedule"})]})]})]})}),ge&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Ka,{className:"w-5 h-5"})," Import Settings"]}),e.jsx("button",{onClick:()=>xe(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Date Format"}),e.jsxs("select",{value:k.dateFormat,onChange:qe=>B({...k,dateFormat:qe.target.value}),className:"input",children:[e.jsx("option",{value:"YYYY-MM-DD",children:"YYYY-MM-DD"}),e.jsx("option",{value:"DD/MM/YYYY",children:"DD/MM/YYYY"}),e.jsx("option",{value:"MM/DD/YYYY",children:"MM/DD/YYYY"})]})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:k.trimWhitespace,onChange:qe=>B({...k,trimWhitespace:qe.target.checked}),className:"w-4 h-4"}),e.jsx("span",{children:"Trim whitespace"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:k.capitalizeNames,onChange:qe=>B({...k,capitalizeNames:qe.target.checked}),className:"w-4 h-4"}),e.jsx("span",{children:"Capitalize names"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:k.validateEmails,onChange:qe=>B({...k,validateEmails:qe.target.checked}),className:"w-4 h-4"}),e.jsx("span",{children:"Validate emails"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:k.validatePhones,onChange:qe=>B({...k,validatePhones:qe.target.checked}),className:"w-4 h-4"}),e.jsx("span",{children:"Validate phones"})]})]}),e.jsx("div",{className:"flex justify-end gap-3 mt-6",children:e.jsx("button",{onClick:()=>xe(!1),className:"btn btn-primary",children:"Save"})})]})})]})}const Q7="modulepreload",R7=function(t){return"/"+t},qN={},lf=function(s,a,r){let l=Promise.resolve();if(a&&a.length>0){let u=function(x){return Promise.all(x.map(A=>Promise.resolve(A).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),m=o?.nonce||o?.getAttribute("nonce");l=u(a.map(x=>{if(x=R7(x),x in qN)return;qN[x]=!0;const A=x.endsWith(".css"),g=A?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${g}`))return;const N=document.createElement("link");if(N.rel=A?"stylesheet":Q7,A||(N.as="script"),N.crossOrigin="",N.href=x,m&&N.setAttribute("nonce",m),document.head.appendChild(N),A)return new Promise((f,y)=>{N.addEventListener("load",f),N.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${x}`)))})}))}function c(o){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=o,window.dispatchEvent(m),!m.defaultPrevented)throw o}return l.then(o=>{for(const m of o||[])m.status==="rejected"&&c(m.reason);return s().catch(c)})};function Ra(t){"@babel/helpers - typeof";return Ra=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Ra(t)}var bc=Uint8Array,ci=Uint16Array,wy=Int32Array,_y=new bc([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Cy=new bc([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),KN=new bc([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),A4=function(t,s){for(var a=new ci(31),r=0;r<31;++r)a[r]=s+=1<<t[r-1];for(var l=new wy(a[30]),r=1;r<30;++r)for(var c=a[r];c<a[r+1];++c)l[c]=c-a[r]<<5|r;return{b:a,r:l}},g4=A4(_y,2),M7=g4.b,fb=g4.r;M7[28]=258,fb[258]=28;var I7=A4(Cy,0),VN=I7.r,bb=new ci(32768);for(var ir=0;ir<32768;++ir){var kd=(ir&43690)>>1|(ir&21845)<<1;kd=(kd&52428)>>2|(kd&13107)<<2,kd=(kd&61680)>>4|(kd&3855)<<4,bb[ir]=((kd&65280)>>8|(kd&255)<<8)>>1}var uh=(function(t,s,a){for(var r=t.length,l=0,c=new ci(s);l<r;++l)t[l]&&++c[t[l]-1];var o=new ci(s);for(l=1;l<s;++l)o[l]=o[l-1]+c[l-1]<<1;var m;if(a){m=new ci(1<<s);var u=15-s;for(l=0;l<r;++l)if(t[l])for(var x=l<<4|t[l],A=s-t[l],g=o[t[l]-1]++<<A,N=g|(1<<A)-1;g<=N;++g)m[bb[g]>>u]=x}else for(m=new ci(r),l=0;l<r;++l)t[l]&&(m[l]=bb[o[t[l]-1]++]>>15-t[l]);return m}),Qm=new bc(288);for(var ir=0;ir<144;++ir)Qm[ir]=8;for(var ir=144;ir<256;++ir)Qm[ir]=9;for(var ir=256;ir<280;++ir)Qm[ir]=7;for(var ir=280;ir<288;++ir)Qm[ir]=8;var eg=new bc(32);for(var ir=0;ir<32;++ir)eg[ir]=5;var $7=uh(Qm,9,0),H7=uh(eg,5,0),f4=function(t){return(t+7)/8|0},P7=function(t,s,a){return(a==null||a>t.length)&&(a=t.length),new bc(t.subarray(s,a))},Eo=function(t,s,a){a<<=s&7;var r=s/8|0;t[r]|=a,t[r+1]|=a>>8},Vx=function(t,s,a){a<<=s&7;var r=s/8|0;t[r]|=a,t[r+1]|=a>>8,t[r+2]|=a>>16},cf=function(t,s){for(var a=[],r=0;r<t.length;++r)t[r]&&a.push({s:r,f:t[r]});var l=a.length,c=a.slice();if(!l)return{t:y4,l:0};if(l==1){var o=new bc(a[0].s+1);return o[a[0].s]=1,{t:o,l:1}}a.sort(function(P,se){return P.f-se.f}),a.push({s:-1,f:25001});var m=a[0],u=a[1],x=0,A=1,g=2;for(a[0]={s:-1,f:m.f+u.f,l:m,r:u};A!=l-1;)m=a[a[x].f<a[g].f?x++:g++],u=a[x!=A&&a[x].f<a[g].f?x++:g++],a[A++]={s:-1,f:m.f+u.f,l:m,r:u};for(var N=c[0].s,r=1;r<l;++r)c[r].s>N&&(N=c[r].s);var f=new ci(N+1),y=yb(a[A-1],f,0);if(y>s){var r=0,v=0,U=y-s,D=1<<U;for(c.sort(function(se,z){return f[z.s]-f[se.s]||se.f-z.f});r<l;++r){var M=c[r].s;if(f[M]>s)v+=D-(1<<y-f[M]),f[M]=s;else break}for(v>>=U;v>0;){var K=c[r].s;f[K]<s?v-=1<<s-f[K]++-1:++r}for(;r>=0&&v;--r){var $=c[r].s;f[$]==s&&(--f[$],++v)}y=s}return{t:new bc(f),l:y}},yb=function(t,s,a){return t.s==-1?Math.max(yb(t.l,s,a+1),yb(t.r,s,a+1)):s[t.s]=a},YN=function(t){for(var s=t.length;s&&!t[--s];);for(var a=new ci(++s),r=0,l=t[0],c=1,o=function(u){a[r++]=u},m=1;m<=s;++m)if(t[m]==l&&m!=s)++c;else{if(!l&&c>2){for(;c>138;c-=138)o(32754);c>2&&(o(c>10?c-11<<5|28690:c-3<<5|12305),c=0)}else if(c>3){for(o(l),--c;c>6;c-=6)o(8304);c>2&&(o(c-3<<5|8208),c=0)}for(;c--;)o(l);c=1,l=t[m]}return{c:a.subarray(0,r),n:s}},Yx=function(t,s){for(var a=0,r=0;r<s.length;++r)a+=t[r]*s[r];return a},b4=function(t,s,a){var r=a.length,l=f4(s+2);t[l]=r&255,t[l+1]=r>>8,t[l+2]=t[l]^255,t[l+3]=t[l+1]^255;for(var c=0;c<r;++c)t[l+c+4]=a[c];return(l+4+r)*8},WN=function(t,s,a,r,l,c,o,m,u,x,A){Eo(s,A++,a),++l[256];for(var g=cf(l,15),N=g.t,f=g.l,y=cf(c,15),v=y.t,U=y.l,D=YN(N),M=D.c,K=D.n,$=YN(v),P=$.c,se=$.n,z=new ci(19),R=0;R<M.length;++R)++z[M[R]&31];for(var R=0;R<P.length;++R)++z[P[R]&31];for(var j=cf(z,7),T=j.t,Q=j.l,E=19;E>4&&!T[KN[E-1]];--E);var te=x+5<<3,C=Yx(l,Qm)+Yx(c,eg)+o,O=Yx(l,N)+Yx(c,v)+o+14+3*E+Yx(z,T)+2*z[16]+3*z[17]+7*z[18];if(u>=0&&te<=C&&te<=O)return b4(s,A,t.subarray(u,u+x));var V,re,ge,xe;if(Eo(s,A,1+(O<C)),A+=2,O<C){V=uh(N,f,0),re=N,ge=uh(v,U,0),xe=v;var Z=uh(T,Q,0);Eo(s,A,K-257),Eo(s,A+5,se-1),Eo(s,A+10,E-4),A+=14;for(var R=0;R<E;++R)Eo(s,A+3*R,T[KN[R]]);A+=3*E;for(var I=[M,P],H=0;H<2;++H)for(var ae=I[H],R=0;R<ae.length;++R){var k=ae[R]&31;Eo(s,A,Z[k]),A+=T[k],k>15&&(Eo(s,A,ae[R]>>5&127),A+=ae[R]>>12)}}else V=$7,re=Qm,ge=H7,xe=eg;for(var R=0;R<m;++R){var B=r[R];if(B>255){var k=B>>18&31;Vx(s,A,V[k+257]),A+=re[k+257],k>7&&(Eo(s,A,B>>23&31),A+=_y[k]);var w=B&31;Vx(s,A,ge[w]),A+=xe[w],w>3&&(Vx(s,A,B>>5&8191),A+=Cy[w])}else Vx(s,A,V[B]),A+=re[B]}return Vx(s,A,V[256]),A+re[256]},O7=new wy([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),y4=new bc(0),z7=function(t,s,a,r,l,c){var o=c.z||t.length,m=new bc(r+o+5*(1+Math.ceil(o/7e3))+l),u=m.subarray(r,m.length-l),x=c.l,A=(c.r||0)&7;if(s){A&&(u[0]=c.r>>3);for(var g=O7[s-1],N=g>>13,f=g&8191,y=(1<<a)-1,v=c.p||new ci(32768),U=c.h||new ci(y+1),D=Math.ceil(a/3),M=2*D,K=function(st){return(t[st]^t[st+1]<<D^t[st+2]<<M)&y},$=new wy(25e3),P=new ci(288),se=new ci(32),z=0,R=0,j=c.i||0,T=0,Q=c.w||0,E=0;j+2<o;++j){var te=K(j),C=j&32767,O=U[te];if(v[C]=O,U[te]=C,Q<=j){var V=o-j;if((z>7e3||T>24576)&&(V>423||!x)){A=WN(t,u,0,$,P,se,R,T,E,j-E,A),T=z=R=0,E=j;for(var re=0;re<286;++re)P[re]=0;for(var re=0;re<30;++re)se[re]=0}var ge=2,xe=0,Z=f,I=C-O&32767;if(V>2&&te==K(j-I))for(var H=Math.min(N,V)-1,ae=Math.min(32767,j),k=Math.min(258,V);I<=ae&&--Z&&C!=O;){if(t[j+ge]==t[j+ge-I]){for(var B=0;B<k&&t[j+B]==t[j+B-I];++B);if(B>ge){if(ge=B,xe=I,B>H)break;for(var w=Math.min(I,B-2),oe=0,re=0;re<w;++re){var ne=j-I+re&32767,Fe=v[ne],je=ne-Fe&32767;je>oe&&(oe=je,O=ne)}}}C=O,O=v[C],I+=C-O&32767}if(xe){$[T++]=268435456|fb[ge]<<18|VN[xe];var Ge=fb[ge]&31,ze=VN[xe]&31;R+=_y[Ge]+Cy[ze],++P[257+Ge],++se[ze],Q=j+ge,++z}else $[T++]=t[j],++P[t[j]]}}for(j=Math.max(j,Q);j<o;++j)$[T++]=t[j],++P[t[j]];A=WN(t,u,x,$,P,se,R,T,E,j-E,A),x||(c.r=A&7|u[A/8|0]<<3,A-=7,c.h=U,c.p=v,c.i=j,c.w=Q)}else{for(var j=c.w||0;j<o+x;j+=65535){var Xe=j+65535;Xe>=o&&(u[A/8|0]=x,Xe=o),A=b4(u,A+1,t.subarray(j,Xe))}c.i=o}return P7(m,0,r+f4(A)+l)},j4=function(){var t=1,s=0;return{p:function(a){for(var r=t,l=s,c=a.length|0,o=0;o!=c;){for(var m=Math.min(o+2655,c);o<m;++o)l+=r+=a[o];r=(r&65535)+15*(r>>16),l=(l&65535)+15*(l>>16)}t=r,s=l},d:function(){return t%=65521,s%=65521,(t&255)<<24|(t&65280)<<8|(s&255)<<8|s>>8}}},G7=function(t,s,a,r,l){if(!l&&(l={l:1},s.dictionary)){var c=s.dictionary.subarray(-32768),o=new bc(c.length+t.length);o.set(c),o.set(t,c.length),t=o,l.w=c.length}return z7(t,s.level==null?6:s.level,s.mem==null?l.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+s.mem,a,r,l)},v4=function(t,s,a){for(;a;++s)t[s]=a,a>>>=8},q7=function(t,s){var a=s.level,r=a==0?0:a<6?1:a==9?3:2;if(t[0]=120,t[1]=r<<6|(s.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,s.dictionary){var l=j4();l.p(s.dictionary),v4(t,2,l.d())}};function jb(t,s){s||(s={});var a=j4();a.p(t);var r=G7(t,s,s.dictionary?6:2,4);return q7(r,s),v4(r,r.length-4,a.d()),r}var K7=typeof TextDecoder<"u"&&new TextDecoder,V7=0;try{K7.decode(y4,{stream:!0}),V7=1}catch{}function Y7(t){if(Array.isArray(t))return t}function W7(t,s){var a=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(a!=null){var r,l,c,o,m=[],u=!0,x=!1;try{if(c=(a=a.call(t)).next,s!==0)for(;!(u=(r=c.call(a)).done)&&(m.push(r.value),m.length!==s);u=!0);}catch(A){x=!0,l=A}finally{try{if(!u&&a.return!=null&&(o=a.return(),Object(o)!==o))return}finally{if(x)throw l}}return m}}function XN(t,s){(s==null||s>t.length)&&(s=t.length);for(var a=0,r=Array(s);a<s;a++)r[a]=t[a];return r}function X7(t,s){if(t){if(typeof t=="string")return XN(t,s);var a={}.toString.call(t).slice(8,-1);return a==="Object"&&t.constructor&&(a=t.constructor.name),a==="Map"||a==="Set"?Array.from(t):a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?XN(t,s):void 0}}function J7(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JN(t,s){return Y7(t)||W7(t,s)||X7(t,s)||J7()}function ZN(t,s="utf8"){return new TextDecoder(s).decode(t)}const Z7=new TextEncoder;function e8(t){return Z7.encode(t)}const t8=1024*8,s8=(()=>{const t=new Uint8Array(4),s=new Uint32Array(t.buffer);return!((s[0]=1)&t[0])})(),of={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class Sy{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(s=t8,a={}){let r=!1;typeof s=="number"?s=new ArrayBuffer(s):(r=!0,this.lastWrittenByte=s.byteLength);const l=a.offset?a.offset>>>0:0,c=s.byteLength-l;let o=l;(ArrayBuffer.isView(s)||s instanceof Sy)&&(s.byteLength!==s.buffer.byteLength&&(o=s.byteOffset+l),s=s.buffer),r?this.lastWrittenByte=c:this.lastWrittenByte=0,this.buffer=s,this.length=c,this.byteLength=c,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,c),this._mark=0,this._marks=[]}available(s=1){return this.offset+s<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(s=1){return this.offset+=s,this}back(s=1){return this.offset-=s,this}seek(s){return this.offset=s,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const s=this._marks.pop();if(s===void 0)throw new Error("Mark stack empty");return this.seek(s),this}rewind(){return this.offset=0,this}ensureAvailable(s=1){if(!this.available(s)){const r=(this.offset+s)*2,l=new Uint8Array(r);l.set(new Uint8Array(this.buffer)),this.buffer=l.buffer,this.length=r,this.byteLength=r,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(s=1){return this.readArray(s,"uint8")}readArray(s,a){const r=of[a].BYTES_PER_ELEMENT*s,l=this.byteOffset+this.offset,c=this.buffer.slice(l,l+r);if(this.littleEndian===s8&&a!=="uint8"&&a!=="int8"){const m=new Uint8Array(this.buffer.slice(l,l+r));m.reverse();const u=new of[a](m.buffer);return this.offset+=r,u.reverse(),u}const o=new of[a](c);return this.offset+=r,o}readInt16(){const s=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,s}readUint16(){const s=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,s}readInt32(){const s=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,s}readUint32(){const s=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,s}readFloat32(){const s=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,s}readFloat64(){const s=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,s}readBigInt64(){const s=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,s}readBigUint64(){const s=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,s}readChar(){return String.fromCharCode(this.readInt8())}readChars(s=1){let a="";for(let r=0;r<s;r++)a+=this.readChar();return a}readUtf8(s=1){return ZN(this.readBytes(s))}decodeText(s=1,a="utf8"){return ZN(this.readBytes(s),a)}writeBoolean(s){return this.writeUint8(s?255:0),this}writeInt8(s){return this.ensureAvailable(1),this._data.setInt8(this.offset++,s),this._updateLastWrittenByte(),this}writeUint8(s){return this.ensureAvailable(1),this._data.setUint8(this.offset++,s),this._updateLastWrittenByte(),this}writeByte(s){return this.writeUint8(s)}writeBytes(s){this.ensureAvailable(s.length);for(let a=0;a<s.length;a++)this._data.setUint8(this.offset++,s[a]);return this._updateLastWrittenByte(),this}writeInt16(s){return this.ensureAvailable(2),this._data.setInt16(this.offset,s,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(s){return this.ensureAvailable(2),this._data.setUint16(this.offset,s,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(s){return this.ensureAvailable(4),this._data.setInt32(this.offset,s,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(s){return this.ensureAvailable(4),this._data.setUint32(this.offset,s,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(s){return this.ensureAvailable(4),this._data.setFloat32(this.offset,s,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(s){return this.ensureAvailable(8),this._data.setFloat64(this.offset,s,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(s){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,s,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(s){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,s,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(s){return this.writeUint8(s.charCodeAt(0))}writeChars(s){for(let a=0;a<s.length;a++)this.writeUint8(s.charCodeAt(a));return this}writeUtf8(s){return this.writeBytes(e8(s))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function lx(t){let s=t.length;for(;--s>=0;)t[s]=0}const a8=3,r8=258,N4=29,n8=256,l8=n8+1+N4,w4=30,i8=512,c8=new Array((l8+2)*2);lx(c8);const o8=new Array(w4*2);lx(o8);const d8=new Array(i8);lx(d8);const m8=new Array(r8-a8+1);lx(m8);const u8=new Array(N4);lx(u8);const x8=new Array(w4);lx(x8);const h8=(t,s,a,r)=>{let l=t&65535|0,c=t>>>16&65535|0,o=0;for(;a!==0;){o=a>2e3?2e3:a,a-=o;do l=l+s[r++]|0,c=c+l|0;while(--o);l%=65521,c%=65521}return l|c<<16|0};var vb=h8;const p8=()=>{let t,s=[];for(var a=0;a<256;a++){t=a;for(var r=0;r<8;r++)t=t&1?3988292384^t>>>1:t>>>1;s[a]=t}return s},A8=new Uint32Array(p8()),g8=(t,s,a,r)=>{const l=A8,c=r+a;t^=-1;for(let o=r;o<c;o++)t=t>>>8^l[(t^s[o])&255];return t^-1};var Gc=g8,Nb={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},_4={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const f8=(t,s)=>Object.prototype.hasOwnProperty.call(t,s);var b8=function(t){const s=Array.prototype.slice.call(arguments,1);for(;s.length;){const a=s.shift();if(a){if(typeof a!="object")throw new TypeError(a+"must be non-object");for(const r in a)f8(a,r)&&(t[r]=a[r])}}return t},y8=t=>{let s=0;for(let r=0,l=t.length;r<l;r++)s+=t[r].length;const a=new Uint8Array(s);for(let r=0,l=0,c=t.length;r<c;r++){let o=t[r];a.set(o,l),l+=o.length}return a},C4={assign:b8,flattenChunks:y8};let S4=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{S4=!1}const Sh=new Uint8Array(256);for(let t=0;t<256;t++)Sh[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Sh[254]=Sh[254]=1;var j8=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let s,a,r,l,c,o=t.length,m=0;for(l=0;l<o;l++)a=t.charCodeAt(l),(a&64512)===55296&&l+1<o&&(r=t.charCodeAt(l+1),(r&64512)===56320&&(a=65536+(a-55296<<10)+(r-56320),l++)),m+=a<128?1:a<2048?2:a<65536?3:4;for(s=new Uint8Array(m),c=0,l=0;c<m;l++)a=t.charCodeAt(l),(a&64512)===55296&&l+1<o&&(r=t.charCodeAt(l+1),(r&64512)===56320&&(a=65536+(a-55296<<10)+(r-56320),l++)),a<128?s[c++]=a:a<2048?(s[c++]=192|a>>>6,s[c++]=128|a&63):a<65536?(s[c++]=224|a>>>12,s[c++]=128|a>>>6&63,s[c++]=128|a&63):(s[c++]=240|a>>>18,s[c++]=128|a>>>12&63,s[c++]=128|a>>>6&63,s[c++]=128|a&63);return s};const v8=(t,s)=>{if(s<65534&&t.subarray&&S4)return String.fromCharCode.apply(null,t.length===s?t:t.subarray(0,s));let a="";for(let r=0;r<s;r++)a+=String.fromCharCode(t[r]);return a};var N8=(t,s)=>{const a=s||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,s));let r,l;const c=new Array(a*2);for(l=0,r=0;r<a;){let o=t[r++];if(o<128){c[l++]=o;continue}let m=Sh[o];if(m>4){c[l++]=65533,r+=m-1;continue}for(o&=m===2?31:m===3?15:7;m>1&&r<a;)o=o<<6|t[r++]&63,m--;if(m>1){c[l++]=65533;continue}o<65536?c[l++]=o:(o-=65536,c[l++]=55296|o>>10&1023,c[l++]=56320|o&1023)}return v8(c,l)},w8=(t,s)=>{s=s||t.length,s>t.length&&(s=t.length);let a=s-1;for(;a>=0&&(t[a]&192)===128;)a--;return a<0||a===0?s:a+Sh[t[a]]>s?a:s},wb={string2buf:j8,buf2string:N8,utf8border:w8};function _8(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var C8=_8;const zp=16209,S8=16191;var k8=function(s,a){let r,l,c,o,m,u,x,A,g,N,f,y,v,U,D,M,K,$,P,se,z,R,j,T;const Q=s.state;r=s.next_in,j=s.input,l=r+(s.avail_in-5),c=s.next_out,T=s.output,o=c-(a-s.avail_out),m=c+(s.avail_out-257),u=Q.dmax,x=Q.wsize,A=Q.whave,g=Q.wnext,N=Q.window,f=Q.hold,y=Q.bits,v=Q.lencode,U=Q.distcode,D=(1<<Q.lenbits)-1,M=(1<<Q.distbits)-1;e:do{y<15&&(f+=j[r++]<<y,y+=8,f+=j[r++]<<y,y+=8),K=v[f&D];t:for(;;){if($=K>>>24,f>>>=$,y-=$,$=K>>>16&255,$===0)T[c++]=K&65535;else if($&16){P=K&65535,$&=15,$&&(y<$&&(f+=j[r++]<<y,y+=8),P+=f&(1<<$)-1,f>>>=$,y-=$),y<15&&(f+=j[r++]<<y,y+=8,f+=j[r++]<<y,y+=8),K=U[f&M];s:for(;;){if($=K>>>24,f>>>=$,y-=$,$=K>>>16&255,$&16){if(se=K&65535,$&=15,y<$&&(f+=j[r++]<<y,y+=8,y<$&&(f+=j[r++]<<y,y+=8)),se+=f&(1<<$)-1,se>u){s.msg="invalid distance too far back",Q.mode=zp;break e}if(f>>>=$,y-=$,$=c-o,se>$){if($=se-$,$>A&&Q.sane){s.msg="invalid distance too far back",Q.mode=zp;break e}if(z=0,R=N,g===0){if(z+=x-$,$<P){P-=$;do T[c++]=N[z++];while(--$);z=c-se,R=T}}else if(g<$){if(z+=x+g-$,$-=g,$<P){P-=$;do T[c++]=N[z++];while(--$);if(z=0,g<P){$=g,P-=$;do T[c++]=N[z++];while(--$);z=c-se,R=T}}}else if(z+=g-$,$<P){P-=$;do T[c++]=N[z++];while(--$);z=c-se,R=T}for(;P>2;)T[c++]=R[z++],T[c++]=R[z++],T[c++]=R[z++],P-=3;P&&(T[c++]=R[z++],P>1&&(T[c++]=R[z++]))}else{z=c-se;do T[c++]=T[z++],T[c++]=T[z++],T[c++]=T[z++],P-=3;while(P>2);P&&(T[c++]=T[z++],P>1&&(T[c++]=T[z++]))}}else if(($&64)===0){K=U[(K&65535)+(f&(1<<$)-1)];continue s}else{s.msg="invalid distance code",Q.mode=zp;break e}break}}else if(($&64)===0){K=v[(K&65535)+(f&(1<<$)-1)];continue t}else if($&32){Q.mode=S8;break e}else{s.msg="invalid literal/length code",Q.mode=zp;break e}break}}while(r<l&&c<m);P=y>>3,r-=P,y-=P<<3,f&=(1<<y)-1,s.next_in=r,s.next_out=c,s.avail_in=r<l?5+(l-r):5-(r-l),s.avail_out=c<m?257+(m-c):257-(c-m),Q.hold=f,Q.bits=y};const Cu=15,ew=852,tw=592,sw=0,df=1,aw=2,B8=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),F8=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),E8=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),D8=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),U8=(t,s,a,r,l,c,o,m)=>{const u=m.bits;let x=0,A=0,g=0,N=0,f=0,y=0,v=0,U=0,D=0,M=0,K,$,P,se,z,R=null,j;const T=new Uint16Array(Cu+1),Q=new Uint16Array(Cu+1);let E=null,te,C,O;for(x=0;x<=Cu;x++)T[x]=0;for(A=0;A<r;A++)T[s[a+A]]++;for(f=u,N=Cu;N>=1&&T[N]===0;N--);if(f>N&&(f=N),N===0)return l[c++]=1<<24|64<<16|0,l[c++]=1<<24|64<<16|0,m.bits=1,0;for(g=1;g<N&&T[g]===0;g++);for(f<g&&(f=g),U=1,x=1;x<=Cu;x++)if(U<<=1,U-=T[x],U<0)return-1;if(U>0&&(t===sw||N!==1))return-1;for(Q[1]=0,x=1;x<Cu;x++)Q[x+1]=Q[x]+T[x];for(A=0;A<r;A++)s[a+A]!==0&&(o[Q[s[a+A]]++]=A);if(t===sw?(R=E=o,j=20):t===df?(R=B8,E=F8,j=257):(R=E8,E=D8,j=0),M=0,A=0,x=g,z=c,y=f,v=0,P=-1,D=1<<f,se=D-1,t===df&&D>ew||t===aw&&D>tw)return 1;for(;;){te=x-v,o[A]+1<j?(C=0,O=o[A]):o[A]>=j?(C=E[o[A]-j],O=R[o[A]-j]):(C=96,O=0),K=1<<x-v,$=1<<y,g=$;do $-=K,l[z+(M>>v)+$]=te<<24|C<<16|O|0;while($!==0);for(K=1<<x-1;M&K;)K>>=1;if(K!==0?(M&=K-1,M+=K):M=0,A++,--T[x]===0){if(x===N)break;x=s[a+o[A]]}if(x>f&&(M&se)!==P){for(v===0&&(v=f),z+=g,y=x-v,U=1<<y;y+v<N&&(U-=T[y+v],!(U<=0));)y++,U<<=1;if(D+=1<<y,t===df&&D>ew||t===aw&&D>tw)return 1;P=M&se,l[P]=f<<24|y<<16|z-c|0}}return M!==0&&(l[z+M]=x-v<<24|64<<16|0),m.bits=f,0};var xh=U8;const T8=0,k4=1,B4=2,{Z_FINISH:rw,Z_BLOCK:L8,Z_TREES:Gp,Z_OK:Rm,Z_STREAM_END:Q8,Z_NEED_DICT:R8,Z_STREAM_ERROR:Ri,Z_DATA_ERROR:F4,Z_MEM_ERROR:E4,Z_BUF_ERROR:M8,Z_DEFLATED:nw}=_4,wg=16180,lw=16181,iw=16182,cw=16183,ow=16184,dw=16185,mw=16186,uw=16187,xw=16188,hw=16189,tg=16190,Do=16191,mf=16192,pw=16193,uf=16194,Aw=16195,gw=16196,fw=16197,bw=16198,qp=16199,Kp=16200,yw=16201,jw=16202,vw=16203,Nw=16204,ww=16205,xf=16206,_w=16207,Cw=16208,br=16209,D4=16210,U4=16211,I8=852,$8=592,H8=15,P8=H8,Sw=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function O8(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Mm=t=>{if(!t)return 1;const s=t.state;return!s||s.strm!==t||s.mode<wg||s.mode>U4?1:0},T4=t=>{if(Mm(t))return Ri;const s=t.state;return t.total_in=t.total_out=s.total=0,t.msg="",s.wrap&&(t.adler=s.wrap&1),s.mode=wg,s.last=0,s.havedict=0,s.flags=-1,s.dmax=32768,s.head=null,s.hold=0,s.bits=0,s.lencode=s.lendyn=new Int32Array(I8),s.distcode=s.distdyn=new Int32Array($8),s.sane=1,s.back=-1,Rm},L4=t=>{if(Mm(t))return Ri;const s=t.state;return s.wsize=0,s.whave=0,s.wnext=0,T4(t)},Q4=(t,s)=>{let a;if(Mm(t))return Ri;const r=t.state;return s<0?(a=0,s=-s):(a=(s>>4)+5,s<48&&(s&=15)),s&&(s<8||s>15)?Ri:(r.window!==null&&r.wbits!==s&&(r.window=null),r.wrap=a,r.wbits=s,L4(t))},R4=(t,s)=>{if(!t)return Ri;const a=new O8;t.state=a,a.strm=t,a.window=null,a.mode=wg;const r=Q4(t,s);return r!==Rm&&(t.state=null),r},z8=t=>R4(t,P8);let kw=!0,hf,pf;const G8=t=>{if(kw){hf=new Int32Array(512),pf=new Int32Array(32);let s=0;for(;s<144;)t.lens[s++]=8;for(;s<256;)t.lens[s++]=9;for(;s<280;)t.lens[s++]=7;for(;s<288;)t.lens[s++]=8;for(xh(k4,t.lens,0,288,hf,0,t.work,{bits:9}),s=0;s<32;)t.lens[s++]=5;xh(B4,t.lens,0,32,pf,0,t.work,{bits:5}),kw=!1}t.lencode=hf,t.lenbits=9,t.distcode=pf,t.distbits=5},M4=(t,s,a,r)=>{let l;const c=t.state;return c.window===null&&(c.wsize=1<<c.wbits,c.wnext=0,c.whave=0,c.window=new Uint8Array(c.wsize)),r>=c.wsize?(c.window.set(s.subarray(a-c.wsize,a),0),c.wnext=0,c.whave=c.wsize):(l=c.wsize-c.wnext,l>r&&(l=r),c.window.set(s.subarray(a-r,a-r+l),c.wnext),r-=l,r?(c.window.set(s.subarray(a-r,a),0),c.wnext=r,c.whave=c.wsize):(c.wnext+=l,c.wnext===c.wsize&&(c.wnext=0),c.whave<c.wsize&&(c.whave+=l))),0},q8=(t,s)=>{let a,r,l,c,o,m,u,x,A,g,N,f,y,v,U=0,D,M,K,$,P,se,z,R;const j=new Uint8Array(4);let T,Q;const E=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Mm(t)||!t.output||!t.input&&t.avail_in!==0)return Ri;a=t.state,a.mode===Do&&(a.mode=mf),o=t.next_out,l=t.output,u=t.avail_out,c=t.next_in,r=t.input,m=t.avail_in,x=a.hold,A=a.bits,g=m,N=u,R=Rm;e:for(;;)switch(a.mode){case wg:if(a.wrap===0){a.mode=mf;break}for(;A<16;){if(m===0)break e;m--,x+=r[c++]<<A,A+=8}if(a.wrap&2&&x===35615){a.wbits===0&&(a.wbits=15),a.check=0,j[0]=x&255,j[1]=x>>>8&255,a.check=Gc(a.check,j,2,0),x=0,A=0,a.mode=lw;break}if(a.head&&(a.head.done=!1),!(a.wrap&1)||(((x&255)<<8)+(x>>8))%31){t.msg="incorrect header check",a.mode=br;break}if((x&15)!==nw){t.msg="unknown compression method",a.mode=br;break}if(x>>>=4,A-=4,z=(x&15)+8,a.wbits===0&&(a.wbits=z),z>15||z>a.wbits){t.msg="invalid window size",a.mode=br;break}a.dmax=1<<a.wbits,a.flags=0,t.adler=a.check=1,a.mode=x&512?hw:Do,x=0,A=0;break;case lw:for(;A<16;){if(m===0)break e;m--,x+=r[c++]<<A,A+=8}if(a.flags=x,(a.flags&255)!==nw){t.msg="unknown compression method",a.mode=br;break}if(a.flags&57344){t.msg="unknown header flags set",a.mode=br;break}a.head&&(a.head.text=x>>8&1),a.flags&512&&a.wrap&4&&(j[0]=x&255,j[1]=x>>>8&255,a.check=Gc(a.check,j,2,0)),x=0,A=0,a.mode=iw;case iw:for(;A<32;){if(m===0)break e;m--,x+=r[c++]<<A,A+=8}a.head&&(a.head.time=x),a.flags&512&&a.wrap&4&&(j[0]=x&255,j[1]=x>>>8&255,j[2]=x>>>16&255,j[3]=x>>>24&255,a.check=Gc(a.check,j,4,0)),x=0,A=0,a.mode=cw;case cw:for(;A<16;){if(m===0)break e;m--,x+=r[c++]<<A,A+=8}a.head&&(a.head.xflags=x&255,a.head.os=x>>8),a.flags&512&&a.wrap&4&&(j[0]=x&255,j[1]=x>>>8&255,a.check=Gc(a.check,j,2,0)),x=0,A=0,a.mode=ow;case ow:if(a.flags&1024){for(;A<16;){if(m===0)break e;m--,x+=r[c++]<<A,A+=8}a.length=x,a.head&&(a.head.extra_len=x),a.flags&512&&a.wrap&4&&(j[0]=x&255,j[1]=x>>>8&255,a.check=Gc(a.check,j,2,0)),x=0,A=0}else a.head&&(a.head.extra=null);a.mode=dw;case dw:if(a.flags&1024&&(f=a.length,f>m&&(f=m),f&&(a.head&&(z=a.head.extra_len-a.length,a.head.extra||(a.head.extra=new Uint8Array(a.head.extra_len)),a.head.extra.set(r.subarray(c,c+f),z)),a.flags&512&&a.wrap&4&&(a.check=Gc(a.check,r,f,c)),m-=f,c+=f,a.length-=f),a.length))break e;a.length=0,a.mode=mw;case mw:if(a.flags&2048){if(m===0)break e;f=0;do z=r[c+f++],a.head&&z&&a.length<65536&&(a.head.name+=String.fromCharCode(z));while(z&&f<m);if(a.flags&512&&a.wrap&4&&(a.check=Gc(a.check,r,f,c)),m-=f,c+=f,z)break e}else a.head&&(a.head.name=null);a.length=0,a.mode=uw;case uw:if(a.flags&4096){if(m===0)break e;f=0;do z=r[c+f++],a.head&&z&&a.length<65536&&(a.head.comment+=String.fromCharCode(z));while(z&&f<m);if(a.flags&512&&a.wrap&4&&(a.check=Gc(a.check,r,f,c)),m-=f,c+=f,z)break e}else a.head&&(a.head.comment=null);a.mode=xw;case xw:if(a.flags&512){for(;A<16;){if(m===0)break e;m--,x+=r[c++]<<A,A+=8}if(a.wrap&4&&x!==(a.check&65535)){t.msg="header crc mismatch",a.mode=br;break}x=0,A=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0),t.adler=a.check=0,a.mode=Do;break;case hw:for(;A<32;){if(m===0)break e;m--,x+=r[c++]<<A,A+=8}t.adler=a.check=Sw(x),x=0,A=0,a.mode=tg;case tg:if(a.havedict===0)return t.next_out=o,t.avail_out=u,t.next_in=c,t.avail_in=m,a.hold=x,a.bits=A,R8;t.adler=a.check=1,a.mode=Do;case Do:if(s===L8||s===Gp)break e;case mf:if(a.last){x>>>=A&7,A-=A&7,a.mode=xf;break}for(;A<3;){if(m===0)break e;m--,x+=r[c++]<<A,A+=8}switch(a.last=x&1,x>>>=1,A-=1,x&3){case 0:a.mode=pw;break;case 1:if(G8(a),a.mode=qp,s===Gp){x>>>=2,A-=2;break e}break;case 2:a.mode=gw;break;case 3:t.msg="invalid block type",a.mode=br}x>>>=2,A-=2;break;case pw:for(x>>>=A&7,A-=A&7;A<32;){if(m===0)break e;m--,x+=r[c++]<<A,A+=8}if((x&65535)!==(x>>>16^65535)){t.msg="invalid stored block lengths",a.mode=br;break}if(a.length=x&65535,x=0,A=0,a.mode=uf,s===Gp)break e;case uf:a.mode=Aw;case Aw:if(f=a.length,f){if(f>m&&(f=m),f>u&&(f=u),f===0)break e;l.set(r.subarray(c,c+f),o),m-=f,c+=f,u-=f,o+=f,a.length-=f;break}a.mode=Do;break;case gw:for(;A<14;){if(m===0)break e;m--,x+=r[c++]<<A,A+=8}if(a.nlen=(x&31)+257,x>>>=5,A-=5,a.ndist=(x&31)+1,x>>>=5,A-=5,a.ncode=(x&15)+4,x>>>=4,A-=4,a.nlen>286||a.ndist>30){t.msg="too many length or distance symbols",a.mode=br;break}a.have=0,a.mode=fw;case fw:for(;a.have<a.ncode;){for(;A<3;){if(m===0)break e;m--,x+=r[c++]<<A,A+=8}a.lens[E[a.have++]]=x&7,x>>>=3,A-=3}for(;a.have<19;)a.lens[E[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,T={bits:a.lenbits},R=xh(T8,a.lens,0,19,a.lencode,0,a.work,T),a.lenbits=T.bits,R){t.msg="invalid code lengths set",a.mode=br;break}a.have=0,a.mode=bw;case bw:for(;a.have<a.nlen+a.ndist;){for(;U=a.lencode[x&(1<<a.lenbits)-1],D=U>>>24,M=U>>>16&255,K=U&65535,!(D<=A);){if(m===0)break e;m--,x+=r[c++]<<A,A+=8}if(K<16)x>>>=D,A-=D,a.lens[a.have++]=K;else{if(K===16){for(Q=D+2;A<Q;){if(m===0)break e;m--,x+=r[c++]<<A,A+=8}if(x>>>=D,A-=D,a.have===0){t.msg="invalid bit length repeat",a.mode=br;break}z=a.lens[a.have-1],f=3+(x&3),x>>>=2,A-=2}else if(K===17){for(Q=D+3;A<Q;){if(m===0)break e;m--,x+=r[c++]<<A,A+=8}x>>>=D,A-=D,z=0,f=3+(x&7),x>>>=3,A-=3}else{for(Q=D+7;A<Q;){if(m===0)break e;m--,x+=r[c++]<<A,A+=8}x>>>=D,A-=D,z=0,f=11+(x&127),x>>>=7,A-=7}if(a.have+f>a.nlen+a.ndist){t.msg="invalid bit length repeat",a.mode=br;break}for(;f--;)a.lens[a.have++]=z}}if(a.mode===br)break;if(a.lens[256]===0){t.msg="invalid code -- missing end-of-block",a.mode=br;break}if(a.lenbits=9,T={bits:a.lenbits},R=xh(k4,a.lens,0,a.nlen,a.lencode,0,a.work,T),a.lenbits=T.bits,R){t.msg="invalid literal/lengths set",a.mode=br;break}if(a.distbits=6,a.distcode=a.distdyn,T={bits:a.distbits},R=xh(B4,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,T),a.distbits=T.bits,R){t.msg="invalid distances set",a.mode=br;break}if(a.mode=qp,s===Gp)break e;case qp:a.mode=Kp;case Kp:if(m>=6&&u>=258){t.next_out=o,t.avail_out=u,t.next_in=c,t.avail_in=m,a.hold=x,a.bits=A,k8(t,N),o=t.next_out,l=t.output,u=t.avail_out,c=t.next_in,r=t.input,m=t.avail_in,x=a.hold,A=a.bits,a.mode===Do&&(a.back=-1);break}for(a.back=0;U=a.lencode[x&(1<<a.lenbits)-1],D=U>>>24,M=U>>>16&255,K=U&65535,!(D<=A);){if(m===0)break e;m--,x+=r[c++]<<A,A+=8}if(M&&(M&240)===0){for($=D,P=M,se=K;U=a.lencode[se+((x&(1<<$+P)-1)>>$)],D=U>>>24,M=U>>>16&255,K=U&65535,!($+D<=A);){if(m===0)break e;m--,x+=r[c++]<<A,A+=8}x>>>=$,A-=$,a.back+=$}if(x>>>=D,A-=D,a.back+=D,a.length=K,M===0){a.mode=ww;break}if(M&32){a.back=-1,a.mode=Do;break}if(M&64){t.msg="invalid literal/length code",a.mode=br;break}a.extra=M&15,a.mode=yw;case yw:if(a.extra){for(Q=a.extra;A<Q;){if(m===0)break e;m--,x+=r[c++]<<A,A+=8}a.length+=x&(1<<a.extra)-1,x>>>=a.extra,A-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=jw;case jw:for(;U=a.distcode[x&(1<<a.distbits)-1],D=U>>>24,M=U>>>16&255,K=U&65535,!(D<=A);){if(m===0)break e;m--,x+=r[c++]<<A,A+=8}if((M&240)===0){for($=D,P=M,se=K;U=a.distcode[se+((x&(1<<$+P)-1)>>$)],D=U>>>24,M=U>>>16&255,K=U&65535,!($+D<=A);){if(m===0)break e;m--,x+=r[c++]<<A,A+=8}x>>>=$,A-=$,a.back+=$}if(x>>>=D,A-=D,a.back+=D,M&64){t.msg="invalid distance code",a.mode=br;break}a.offset=K,a.extra=M&15,a.mode=vw;case vw:if(a.extra){for(Q=a.extra;A<Q;){if(m===0)break e;m--,x+=r[c++]<<A,A+=8}a.offset+=x&(1<<a.extra)-1,x>>>=a.extra,A-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){t.msg="invalid distance too far back",a.mode=br;break}a.mode=Nw;case Nw:if(u===0)break e;if(f=N-u,a.offset>f){if(f=a.offset-f,f>a.whave&&a.sane){t.msg="invalid distance too far back",a.mode=br;break}f>a.wnext?(f-=a.wnext,y=a.wsize-f):y=a.wnext-f,f>a.length&&(f=a.length),v=a.window}else v=l,y=o-a.offset,f=a.length;f>u&&(f=u),u-=f,a.length-=f;do l[o++]=v[y++];while(--f);a.length===0&&(a.mode=Kp);break;case ww:if(u===0)break e;l[o++]=a.length,u--,a.mode=Kp;break;case xf:if(a.wrap){for(;A<32;){if(m===0)break e;m--,x|=r[c++]<<A,A+=8}if(N-=u,t.total_out+=N,a.total+=N,a.wrap&4&&N&&(t.adler=a.check=a.flags?Gc(a.check,l,N,o-N):vb(a.check,l,N,o-N)),N=u,a.wrap&4&&(a.flags?x:Sw(x))!==a.check){t.msg="incorrect data check",a.mode=br;break}x=0,A=0}a.mode=_w;case _w:if(a.wrap&&a.flags){for(;A<32;){if(m===0)break e;m--,x+=r[c++]<<A,A+=8}if(a.wrap&4&&x!==(a.total&4294967295)){t.msg="incorrect length check",a.mode=br;break}x=0,A=0}a.mode=Cw;case Cw:R=Q8;break e;case br:R=F4;break e;case D4:return E4;case U4:default:return Ri}return t.next_out=o,t.avail_out=u,t.next_in=c,t.avail_in=m,a.hold=x,a.bits=A,(a.wsize||N!==t.avail_out&&a.mode<br&&(a.mode<xf||s!==rw))&&M4(t,t.output,t.next_out,N-t.avail_out),g-=t.avail_in,N-=t.avail_out,t.total_in+=g,t.total_out+=N,a.total+=N,a.wrap&4&&N&&(t.adler=a.check=a.flags?Gc(a.check,l,N,t.next_out-N):vb(a.check,l,N,t.next_out-N)),t.data_type=a.bits+(a.last?64:0)+(a.mode===Do?128:0)+(a.mode===qp||a.mode===uf?256:0),(g===0&&N===0||s===rw)&&R===Rm&&(R=M8),R},K8=t=>{if(Mm(t))return Ri;let s=t.state;return s.window&&(s.window=null),t.state=null,Rm},V8=(t,s)=>{if(Mm(t))return Ri;const a=t.state;return(a.wrap&2)===0?Ri:(a.head=s,s.done=!1,Rm)},Y8=(t,s)=>{const a=s.length;let r,l,c;return Mm(t)||(r=t.state,r.wrap!==0&&r.mode!==tg)?Ri:r.mode===tg&&(l=1,l=vb(l,s,a,0),l!==r.check)?F4:(c=M4(t,s,a,a),c?(r.mode=D4,E4):(r.havedict=1,Rm))};var W8=L4,X8=Q4,J8=T4,Z8=z8,eD=R4,tD=q8,sD=K8,aD=V8,rD=Y8,nD="pako inflate (from Nodeca project)",Ro={inflateReset:W8,inflateReset2:X8,inflateResetKeep:J8,inflateInit:Z8,inflateInit2:eD,inflate:tD,inflateEnd:sD,inflateGetHeader:aD,inflateSetDictionary:rD,inflateInfo:nD};function lD(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var iD=lD;const I4=Object.prototype.toString,{Z_NO_FLUSH:cD,Z_FINISH:oD,Z_OK:kh,Z_STREAM_END:Af,Z_NEED_DICT:gf,Z_STREAM_ERROR:dD,Z_DATA_ERROR:Bw,Z_MEM_ERROR:mD}=_4;function Oh(t){this.options=C4.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const s=this.options;s.raw&&s.windowBits>=0&&s.windowBits<16&&(s.windowBits=-s.windowBits,s.windowBits===0&&(s.windowBits=-15)),s.windowBits>=0&&s.windowBits<16&&!(t&&t.windowBits)&&(s.windowBits+=32),s.windowBits>15&&s.windowBits<48&&(s.windowBits&15)===0&&(s.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new C8,this.strm.avail_out=0;let a=Ro.inflateInit2(this.strm,s.windowBits);if(a!==kh)throw new Error(Nb[a]);if(this.header=new iD,Ro.inflateGetHeader(this.strm,this.header),s.dictionary&&(typeof s.dictionary=="string"?s.dictionary=wb.string2buf(s.dictionary):I4.call(s.dictionary)==="[object ArrayBuffer]"&&(s.dictionary=new Uint8Array(s.dictionary)),s.raw&&(a=Ro.inflateSetDictionary(this.strm,s.dictionary),a!==kh)))throw new Error(Nb[a])}Oh.prototype.push=function(t,s){const a=this.strm,r=this.options.chunkSize,l=this.options.dictionary;let c,o,m;if(this.ended)return!1;for(s===~~s?o=s:o=s===!0?oD:cD,I4.call(t)==="[object ArrayBuffer]"?a.input=new Uint8Array(t):a.input=t,a.next_in=0,a.avail_in=a.input.length;;){for(a.avail_out===0&&(a.output=new Uint8Array(r),a.next_out=0,a.avail_out=r),c=Ro.inflate(a,o),c===gf&&l&&(c=Ro.inflateSetDictionary(a,l),c===kh?c=Ro.inflate(a,o):c===Bw&&(c=gf));a.avail_in>0&&c===Af&&a.state.wrap>0&&t[a.next_in]!==0;)Ro.inflateReset(a),c=Ro.inflate(a,o);switch(c){case dD:case Bw:case gf:case mD:return this.onEnd(c),this.ended=!0,!1}if(m=a.avail_out,a.next_out&&(a.avail_out===0||c===Af))if(this.options.to==="string"){let u=wb.utf8border(a.output,a.next_out),x=a.next_out-u,A=wb.buf2string(a.output,u);a.next_out=x,a.avail_out=r-x,x&&a.output.set(a.output.subarray(u,u+x),0),this.onData(A)}else this.onData(a.output.length===a.next_out?a.output:a.output.subarray(0,a.next_out));if(!(c===kh&&m===0)){if(c===Af)return c=Ro.inflateEnd(this.strm),this.onEnd(c),this.ended=!0,!0;if(a.avail_in===0)break}}return!0};Oh.prototype.onData=function(t){this.chunks.push(t)};Oh.prototype.onEnd=function(t){t===kh&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=C4.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function uD(t,s){const a=new Oh(s);if(a.push(t),a.err)throw a.msg||Nb[a.err];return a.result}var xD=Oh,hD=uD,pD={Inflate:xD,inflate:hD};const{Inflate:AD,inflate:gD}=pD;var Fw=AD,fD=gD;const $4=[];for(let t=0;t<256;t++){let s=t;for(let a=0;a<8;a++)s&1?s=3988292384^s>>>1:s=s>>>1;$4[t]=s}const Ew=4294967295;function bD(t,s,a){let r=t;for(let l=0;l<a;l++)r=$4[(r^s[l])&255]^r>>>8;return r}function yD(t,s){return(bD(Ew,t,s)^Ew)>>>0}function Dw(t,s,a){const r=t.readUint32(),l=yD(new Uint8Array(t.buffer,t.byteOffset+t.offset-s-4,s),s);if(l!==r)throw new Error(`CRC mismatch for chunk ${a}. Expected ${r}, found ${l}`)}function H4(t,s,a){for(let r=0;r<a;r++)s[r]=t[r]}function P4(t,s,a,r){let l=0;for(;l<r;l++)s[l]=t[l];for(;l<a;l++)s[l]=t[l]+s[l-r]&255}function O4(t,s,a,r){let l=0;if(a.length===0)for(;l<r;l++)s[l]=t[l];else for(;l<r;l++)s[l]=t[l]+a[l]&255}function z4(t,s,a,r,l){let c=0;if(a.length===0){for(;c<l;c++)s[c]=t[c];for(;c<r;c++)s[c]=t[c]+(s[c-l]>>1)&255}else{for(;c<l;c++)s[c]=t[c]+(a[c]>>1)&255;for(;c<r;c++)s[c]=t[c]+(s[c-l]+a[c]>>1)&255}}function G4(t,s,a,r,l){let c=0;if(a.length===0){for(;c<l;c++)s[c]=t[c];for(;c<r;c++)s[c]=t[c]+s[c-l]&255}else{for(;c<l;c++)s[c]=t[c]+a[c]&255;for(;c<r;c++)s[c]=t[c]+jD(s[c-l],a[c],a[c-l])&255}}function jD(t,s,a){const r=t+s-a,l=Math.abs(r-t),c=Math.abs(r-s),o=Math.abs(r-a);return l<=c&&l<=o?t:c<=o?s:a}function vD(t,s,a,r,l,c){switch(t){case 0:H4(s,a,l);break;case 1:P4(s,a,l,c);break;case 2:O4(s,a,r,l);break;case 3:z4(s,a,r,l,c);break;case 4:G4(s,a,r,l,c);break;default:throw new Error(`Unsupported filter: ${t}`)}}const ND=new Uint16Array([255]),wD=new Uint8Array(ND.buffer),_D=wD[0]===255;function CD(t){const{data:s,width:a,height:r,channels:l,depth:c}=t,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],m=Math.ceil(c/8)*l,u=new Uint8Array(r*a*m);let x=0;for(let A=0;A<7;A++){const g=o[A],N=Math.ceil((a-g.x)/g.xStep),f=Math.ceil((r-g.y)/g.yStep);if(N<=0||f<=0)continue;const y=N*m,v=new Uint8Array(y);for(let U=0;U<f;U++){const D=s[x++],M=s.subarray(x,x+y);x+=y;const K=new Uint8Array(y);vD(D,M,K,v,y,m),v.set(K);for(let $=0;$<N;$++){const P=g.x+$*g.xStep,se=g.y+U*g.yStep;if(!(P>=a||se>=r))for(let z=0;z<m;z++)u[(se*a+P)*m+z]=K[$*m+z]}}}if(c===16){const A=new Uint16Array(u.buffer);if(_D)for(let g=0;g<A.length;g++)A[g]=SD(A[g]);return A}else return u}function SD(t){return(t&255)<<8|t>>8&255}const kD=new Uint16Array([255]),BD=new Uint8Array(kD.buffer),FD=BD[0]===255,ED=new Uint8Array(0);function Uw(t){const{data:s,width:a,height:r,channels:l,depth:c}=t,o=Math.ceil(c/8)*l,m=Math.ceil(c/8*l*a),u=new Uint8Array(r*m);let x=ED,A=0,g,N;for(let f=0;f<r;f++){switch(g=s.subarray(A+1,A+1+m),N=u.subarray(f*m,(f+1)*m),s[A]){case 0:H4(g,N,m);break;case 1:P4(g,N,m,o);break;case 2:O4(g,N,x,m);break;case 3:z4(g,N,x,m,o);break;case 4:G4(g,N,x,m,o);break;default:throw new Error(`Unsupported filter: ${s[A]}`)}x=N,A+=m+1}if(c===16){const f=new Uint16Array(u.buffer);if(FD)for(let y=0;y<f.length;y++)f[y]=DD(f[y]);return f}else return u}function DD(t){return(t&255)<<8|t>>8&255}const IA=Uint8Array.of(137,80,78,71,13,10,26,10);function Tw(t){if(!UD(t.readBytes(IA.length)))throw new Error("wrong PNG signature")}function UD(t){if(t.length<IA.length)return!1;for(let s=0;s<IA.length;s++)if(t[s]!==IA[s])return!1;return!0}const TD="tEXt",LD=0,q4=new TextDecoder("latin1");function QD(t){if(MD(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const RD=/^[\u0000-\u00FF]*$/;function MD(t){if(!RD.test(t))throw new Error("invalid latin1 text")}function ID(t,s,a){const r=K4(s);t[r]=$D(s,a-r.length-1)}function K4(t){for(t.mark();t.readByte()!==LD;);const s=t.offset;t.reset();const a=q4.decode(t.readBytes(s-t.offset-1));return t.skip(1),QD(a),a}function $D(t,s){return q4.decode(t.readBytes(s))}const ni={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},ff={UNKNOWN:-1,DEFLATE:0},Lw={UNKNOWN:-1,ADAPTIVE:0},bf={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Vp={NONE:0,BACKGROUND:1,PREVIOUS:2},yf={SOURCE:0,OVER:1};class HD extends Sy{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(s,a={}){super(s);const{checkCrc:r=!1}=a;this._checkCrc=r,this._inflator=new Fw,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=ff.UNKNOWN,this._filterMethod=Lw.UNKNOWN,this._interlaceMethod=bf.UNKNOWN,this._colorType=ni.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(Tw(this);!this._end;){const s=this.readUint32(),a=this.readChars(4);this.decodeChunk(s,a)}return this.decodeImage(),this._png}decodeApng(){for(Tw(this);!this._end;){const s=this.readUint32(),a=this.readChars(4);this.decodeApngChunk(s,a)}return this.decodeApngImage(),this._apng}decodeChunk(s,a){const r=this.offset;switch(a){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(s);break;case"IDAT":this.decodeIDAT(s);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(s);break;case"iCCP":this.decodeiCCP(s);break;case TD:ID(this._png.text,this,s);break;case"pHYs":this.decodepHYs();break;default:this.skip(s);break}if(this.offset-r!==s)throw new Error(`Length mismatch while decoding chunk ${a}`);this._checkCrc?Dw(this,s+4,a):this.skip(4)}decodeApngChunk(s,a){const r=this.offset;switch(a!=="fdAT"&&a!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),a){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(s);break;default:this.decodeChunk(s,a),this.offset=r+s;break}if(this.offset-r!==s)throw new Error(`Length mismatch while decoding chunk ${a}`);this._checkCrc?Dw(this,s+4,a):this.skip(4)}decodeIHDR(){const s=this._png;s.width=this.readUint32(),s.height=this.readUint32(),s.depth=PD(this.readUint8());const a=this.readUint8();this._colorType=a;let r;switch(a){case ni.GREYSCALE:r=1;break;case ni.TRUECOLOUR:r=3;break;case ni.INDEXED_COLOUR:r=1;break;case ni.GREYSCALE_ALPHA:r=2;break;case ni.TRUECOLOUR_ALPHA:r=4;break;case ni.UNKNOWN:default:throw new Error(`Unknown color type: ${a}`)}if(this._png.channels=r,this._compressionMethod=this.readUint8(),this._compressionMethod!==ff.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const s={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(s)}decodePLTE(s){if(s%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${s}`);const a=s/3;this._hasPalette=!0;const r=[];this._palette=r;for(let l=0;l<a;l++)r.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(s){this._writingDataChunks=!0;const a=s,r=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,r,a)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(s)}decodeFDAT(s){this._writingDataChunks=!0;let a=s,r=this.offset+this.byteOffset;if(r+=4,a-=4,this._inflator.push(new Uint8Array(this.buffer,r,a)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(s)}decodetRNS(s){switch(this._colorType){case ni.GREYSCALE:case ni.TRUECOLOUR:{if(s%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${s}`);if(s/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${s/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(s/2);for(let a=0;a<s/2;a++)this._transparency[a]=this.readUint16();break}case ni.INDEXED_COLOUR:{if(s>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${s} vs ${this._palette.length})`);let a=0;for(;a<s;a++){const r=this.readByte();this._palette[a].push(r)}for(;a<this._palette.length;a++)this._palette[a].push(255);break}case ni.UNKNOWN:case ni.GREYSCALE_ALPHA:case ni.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(s){const a=K4(this),r=this.readUint8();if(r!==ff.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${r}`);const l=this.readBytes(s-a.length-2);this._png.iccEmbeddedProfile={name:a,profile:fD(l)}}decodepHYs(){const s=this.readUint32(),a=this.readUint32(),r=this.readByte();this._png.resolution={x:s,y:a,unit:r}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let s=0;s<this._numberOfFrames;s++){const a={sequenceNumber:this._frames[s].sequenceNumber,delayNumber:this._frames[s].delayNumber,delayDenominator:this._frames[s].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},r=this._frames.at(s);if(r){if(r.data=Uw({data:r.data,width:r.width,height:r.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),s===0||r.xOffset===0&&r.yOffset===0&&r.width===this._png.width&&r.height===this._png.height)a.data=r.data;else{const l=this._apng.frames.at(s-1);this.disposeFrame(r,l,a),this.addFrameDataToCanvas(a,r)}this._apng.frames.push(a)}}return this._apng}disposeFrame(s,a,r){switch(s.disposeOp){case Vp.NONE:break;case Vp.BACKGROUND:for(let l=0;l<this._png.height;l++)for(let c=0;c<this._png.width;c++){const o=(l*s.width+c)*this._png.channels;for(let m=0;m<this._png.channels;m++)r.data[o+m]=0}break;case Vp.PREVIOUS:r.data.set(a.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(s,a){const r=1<<this._png.depth,l=(c,o)=>{const m=((c+a.yOffset)*this._png.width+a.xOffset+o)*this._png.channels,u=(c*a.width+o)*this._png.channels;return{index:m,frameIndex:u}};switch(a.blendOp){case yf.SOURCE:for(let c=0;c<a.height;c++)for(let o=0;o<a.width;o++){const{index:m,frameIndex:u}=l(c,o);for(let x=0;x<this._png.channels;x++)s.data[m+x]=a.data[u+x]}break;case yf.OVER:for(let c=0;c<a.height;c++)for(let o=0;o<a.width;o++){const{index:m,frameIndex:u}=l(c,o);for(let x=0;x<this._png.channels;x++){const A=a.data[u+this._png.channels-1]/r,g=x%(this._png.channels-1)===0?1:a.data[u+x],N=Math.floor(A*g+(1-A)*s.data[m+x]);s.data[m+x]+=N}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const s=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==Lw.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===bf.NO_INTERLACE)this._png.data=Uw({data:s,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===bf.ADAM7)this._png.data=CD({data:s,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const s=this._inflator.result,a=this._frames.at(-1);a?a.data=s:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Vp.NONE,blendOp:yf.SOURCE,data:s}),this._inflator=new Fw,this._writingDataChunks=!1}}function PD(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var Qw;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(Qw||(Qw={}));function OD(t,s){return new HD(t,s).decode()}var Ps=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function jf(){Ps.console&&typeof Ps.console.log=="function"&&Ps.console.log.apply(Ps.console,arguments)}var Ja={log:jf,warn:function(t){Ps.console&&(typeof Ps.console.warn=="function"?Ps.console.warn.apply(Ps.console,arguments):jf.call(null,arguments))},error:function(t){Ps.console&&(typeof Ps.console.error=="function"?Ps.console.error.apply(Ps.console,arguments):jf(t))}};function vf(t,s,a){var r=new XMLHttpRequest;r.open("GET",t),r.responseType="blob",r.onload=function(){wm(r.response,s,a)},r.onerror=function(){Ja.error("could not download file")},r.send()}function Rw(t){var s=new XMLHttpRequest;s.open("HEAD",t,!1);try{s.send()}catch{}return s.status>=200&&s.status<=299}function Yp(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var s=document.createEvent("MouseEvents");s.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(s)}}var wm=Ps.saveAs||((typeof window>"u"?"undefined":Ra(window))!=="object"||window!==Ps?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,s,a){var r=Ps.URL||Ps.webkitURL,l=document.createElement("a");s=s||t.name||"download",l.download=s,l.rel="noopener",typeof t=="string"?(l.href=t,l.origin!==location.origin?Rw(l.href)?vf(t,s,a):Yp(l,l.target="_blank"):Yp(l)):(l.href=r.createObjectURL(t),setTimeout(function(){r.revokeObjectURL(l.href)},4e4),setTimeout(function(){Yp(l)},0))}:"msSaveOrOpenBlob"in navigator?function(t,s,a){if(s=s||t.name||"download",typeof t=="string")if(Rw(t))vf(t,s,a);else{var r=document.createElement("a");r.href=t,r.target="_blank",setTimeout(function(){Yp(r)})}else navigator.msSaveOrOpenBlob((function(l,c){return c===void 0?c={autoBom:!1}:Ra(c)!=="object"&&(Ja.warn("Deprecated: Expected third argument to be a object"),c={autoBom:!c}),c.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(l.type)?new Blob(["\uFEFF",l],{type:l.type}):l})(t,a),s)}:function(t,s,a,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof t=="string")return vf(t,s,a);var l=t.type==="application/octet-stream",c=/constructor/i.test(Ps.HTMLElement)||Ps.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||l&&c)&&(typeof FileReader>"u"?"undefined":Ra(FileReader))==="object"){var m=new FileReader;m.onloadend=function(){var A=m.result;A=o?A:A.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=A:location=A,r=null},m.readAsDataURL(t)}else{var u=Ps.URL||Ps.webkitURL,x=u.createObjectURL(t);r?r.location=x:location.href=x,r=null,setTimeout(function(){u.revokeObjectURL(x)},4e4)}});function V4(t){var s;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var a=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(m){return[parseInt(m[1]),parseInt(m[2]),parseInt(m[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(m){return[parseInt(m[1],16),parseInt(m[2],16),parseInt(m[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(m){return[parseInt(m[1]+m[1],16),parseInt(m[2]+m[2],16),parseInt(m[3]+m[3],16)]}}],r=0;r<a.length;r++){var l=a[r].re,c=a[r].process,o=l.exec(t);o&&(s=c(o),this.r=s[0],this.g=s[1],this.b=s[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var m=this.r.toString(16),u=this.g.toString(16),x=this.b.toString(16);return m.length==1&&(m="0"+m),u.length==1&&(u="0"+u),x.length==1&&(x="0"+x),"#"+m+u+x}}var $A=Ps.atob.bind(Ps),Mw=Ps.btoa.bind(Ps);function Nf(t,s){var a=t[0],r=t[1],l=t[2],c=t[3];a=Wn(a,r,l,c,s[0],7,-680876936),c=Wn(c,a,r,l,s[1],12,-389564586),l=Wn(l,c,a,r,s[2],17,606105819),r=Wn(r,l,c,a,s[3],22,-1044525330),a=Wn(a,r,l,c,s[4],7,-176418897),c=Wn(c,a,r,l,s[5],12,1200080426),l=Wn(l,c,a,r,s[6],17,-1473231341),r=Wn(r,l,c,a,s[7],22,-45705983),a=Wn(a,r,l,c,s[8],7,1770035416),c=Wn(c,a,r,l,s[9],12,-1958414417),l=Wn(l,c,a,r,s[10],17,-42063),r=Wn(r,l,c,a,s[11],22,-1990404162),a=Wn(a,r,l,c,s[12],7,1804603682),c=Wn(c,a,r,l,s[13],12,-40341101),l=Wn(l,c,a,r,s[14],17,-1502002290),a=Xn(a,r=Wn(r,l,c,a,s[15],22,1236535329),l,c,s[1],5,-165796510),c=Xn(c,a,r,l,s[6],9,-1069501632),l=Xn(l,c,a,r,s[11],14,643717713),r=Xn(r,l,c,a,s[0],20,-373897302),a=Xn(a,r,l,c,s[5],5,-701558691),c=Xn(c,a,r,l,s[10],9,38016083),l=Xn(l,c,a,r,s[15],14,-660478335),r=Xn(r,l,c,a,s[4],20,-405537848),a=Xn(a,r,l,c,s[9],5,568446438),c=Xn(c,a,r,l,s[14],9,-1019803690),l=Xn(l,c,a,r,s[3],14,-187363961),r=Xn(r,l,c,a,s[8],20,1163531501),a=Xn(a,r,l,c,s[13],5,-1444681467),c=Xn(c,a,r,l,s[2],9,-51403784),l=Xn(l,c,a,r,s[7],14,1735328473),a=Jn(a,r=Xn(r,l,c,a,s[12],20,-1926607734),l,c,s[5],4,-378558),c=Jn(c,a,r,l,s[8],11,-2022574463),l=Jn(l,c,a,r,s[11],16,1839030562),r=Jn(r,l,c,a,s[14],23,-35309556),a=Jn(a,r,l,c,s[1],4,-1530992060),c=Jn(c,a,r,l,s[4],11,1272893353),l=Jn(l,c,a,r,s[7],16,-155497632),r=Jn(r,l,c,a,s[10],23,-1094730640),a=Jn(a,r,l,c,s[13],4,681279174),c=Jn(c,a,r,l,s[0],11,-358537222),l=Jn(l,c,a,r,s[3],16,-722521979),r=Jn(r,l,c,a,s[6],23,76029189),a=Jn(a,r,l,c,s[9],4,-640364487),c=Jn(c,a,r,l,s[12],11,-421815835),l=Jn(l,c,a,r,s[15],16,530742520),a=Zn(a,r=Jn(r,l,c,a,s[2],23,-995338651),l,c,s[0],6,-198630844),c=Zn(c,a,r,l,s[7],10,1126891415),l=Zn(l,c,a,r,s[14],15,-1416354905),r=Zn(r,l,c,a,s[5],21,-57434055),a=Zn(a,r,l,c,s[12],6,1700485571),c=Zn(c,a,r,l,s[3],10,-1894986606),l=Zn(l,c,a,r,s[10],15,-1051523),r=Zn(r,l,c,a,s[1],21,-2054922799),a=Zn(a,r,l,c,s[8],6,1873313359),c=Zn(c,a,r,l,s[15],10,-30611744),l=Zn(l,c,a,r,s[6],15,-1560198380),r=Zn(r,l,c,a,s[13],21,1309151649),a=Zn(a,r,l,c,s[4],6,-145523070),c=Zn(c,a,r,l,s[11],10,-1120210379),l=Zn(l,c,a,r,s[2],15,718787259),r=Zn(r,l,c,a,s[9],21,-343485551),t[0]=Qd(a,t[0]),t[1]=Qd(r,t[1]),t[2]=Qd(l,t[2]),t[3]=Qd(c,t[3])}function _g(t,s,a,r,l,c){return s=Qd(Qd(s,t),Qd(r,c)),Qd(s<<l|s>>>32-l,a)}function Wn(t,s,a,r,l,c,o){return _g(s&a|~s&r,t,s,l,c,o)}function Xn(t,s,a,r,l,c,o){return _g(s&r|a&~r,t,s,l,c,o)}function Jn(t,s,a,r,l,c,o){return _g(s^a^r,t,s,l,c,o)}function Zn(t,s,a,r,l,c,o){return _g(a^(s|~r),t,s,l,c,o)}function Y4(t){var s,a=t.length,r=[1732584193,-271733879,-1732584194,271733878];for(s=64;s<=t.length;s+=64)Nf(r,zD(t.substring(s-64,s)));t=t.substring(s-64);var l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(s=0;s<t.length;s++)l[s>>2]|=t.charCodeAt(s)<<(s%4<<3);if(l[s>>2]|=128<<(s%4<<3),s>55)for(Nf(r,l),s=0;s<16;s++)l[s]=0;return l[14]=8*a,Nf(r,l),r}function zD(t){var s,a=[];for(s=0;s<64;s+=4)a[s>>2]=t.charCodeAt(s)+(t.charCodeAt(s+1)<<8)+(t.charCodeAt(s+2)<<16)+(t.charCodeAt(s+3)<<24);return a}var Iw="0123456789abcdef".split("");function GD(t){for(var s="",a=0;a<4;a++)s+=Iw[t>>8*a+4&15]+Iw[t>>8*a&15];return s}function qD(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function _b(t){return Y4(t).map(qD).join("")}var KD=(function(t){for(var s=0;s<t.length;s++)t[s]=GD(t[s]);return t.join("")})(Y4("hello"))!="5d41402abc4b2a76b9719d911017c592";function Qd(t,s){if(KD){var a=(65535&t)+(65535&s);return(t>>16)+(s>>16)+(a>>16)<<16|65535&a}return t+s&4294967295}function Cb(t,s){var a,r,l,c;if(t!==a){for(var o=(l=t,c=1+(256/t.length|0),new Array(c+1).join(l)),m=[],u=0;u<256;u++)m[u]=u;var x=0;for(u=0;u<256;u++){var A=m[u];x=(x+A+o.charCodeAt(u))%256,m[u]=m[x],m[x]=A}a=t,r=m}else m=r;var g=s.length,N=0,f=0,y="";for(u=0;u<g;u++)f=(f+(A=m[N=(N+1)%256]))%256,m[N]=m[f],m[f]=A,o=m[(m[N]+m[f])%256],y+=String.fromCharCode(s.charCodeAt(u)^o);return y}var $w={print:4,modify:8,copy:16,"annot-forms":32};function Lu(t,s,a,r){this.v=1,this.r=2;var l=192;t.forEach(function(m){if($w.perm!==void 0)throw new Error("Invalid permission: "+m);l+=$w[m]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var c=(s+this.padding).substr(0,32),o=(a+this.padding).substr(0,32);this.O=this.processOwnerPassword(c,o),this.P=-(1+(255^l)),this.encryptionKey=_b(c+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=Cb(this.encryptionKey,this.padding)}function Qu(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var s="",a=t.length,r=0;r<a;r++){var l=t.charCodeAt(r);s+=l<33||l===35||l===37||l===40||l===41||l===47||l===60||l===62||l===91||l===93||l===123||l===125||l>126?"#"+("0"+l.toString(16)).slice(-2):t[r]}return s}function Hw(t){if(Ra(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var s={};this.subscribe=function(a,r,l){if(l=l||!1,typeof a!="string"||typeof r!="function"||typeof l!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");s.hasOwnProperty(a)||(s[a]={});var c=Math.random().toString(35);return s[a][c]=[r,!!l],c},this.unsubscribe=function(a){for(var r in s)if(s[r][a])return delete s[r][a],Object.keys(s[r]).length===0&&delete s[r],!0;return!1},this.publish=function(a){if(s.hasOwnProperty(a)){var r=Array.prototype.slice.call(arguments,1),l=[];for(var c in s[a]){var o=s[a][c];try{o[0].apply(t,r)}catch(m){Ps.console&&Ja.error("jsPDF PubSub Error",m.message,m)}o[1]&&l.push(c)}l.length&&l.forEach(this.unsubscribe)}},this.getTopics=function(){return s}}function sg(t){if(!(this instanceof sg))return new sg(t);var s="opacity,stroke-opacity".split(",");for(var a in t)t.hasOwnProperty(a)&&s.indexOf(a)>=0&&(this[a]=t[a]);this.id="",this.objectNumber=-1}function W4(t,s){this.gState=t,this.matrix=s,this.id="",this.objectNumber=-1}function _m(t,s,a,r,l){if(!(this instanceof _m))return new _m(t,s,a,r,l);this.type=t==="axial"?2:3,this.coords=s,this.colors=a,W4.call(this,r,l)}function $u(t,s,a,r,l){if(!(this instanceof $u))return new $u(t,s,a,r,l);this.boundingBox=t,this.xStep=s,this.yStep=a,this.stream="",this.cloneIndex=0,W4.call(this,r,l)}function ms(t){var s,a=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],l=arguments[2],c=arguments[3],o=[],m=1,u=16,x="S",A=null;Ra(t=t||{})==="object"&&(a=t.orientation,r=t.unit||r,l=t.format||l,c=t.compress||t.compressPdf||c,(A=t.encryption||null)!==null&&(A.userPassword=A.userPassword||"",A.ownerPassword=A.ownerPassword||"",A.userPermissions=A.userPermissions||[]),m=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(s=t.precision),t.floatPrecision!==void 0&&(u=t.floatPrecision),x=t.defaultPathOperation||"S"),o=t.filters||(c===!0?["FlateEncode"]:o),r=r||"mm",a=(""+(a||"P")).toLowerCase();var g=t.putOnlyUsedFonts||!1,N={},f={internal:{},__private__:{}};f.__private__.PubSub=Hw;var y="1.3",v=f.__private__.getPdfVersion=function(){return y};f.__private__.setPdfVersion=function(G){y=G};var U={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return U};var D=f.__private__.getPageFormat=function(G){return U[G]};l=l||"a4";var M="compat",K="advanced",$=M;function P(){this.saveGraphicsState(),ce(new Ue(et,0,0,-et,0,Ki()*et).toString()+" cm"),this.setFontSize(this.getFontSize()/et),x="n",$=K}function se(){this.restoreGraphicsState(),x="S",$=M}var z=f.__private__.combineFontStyleAndFontWeight=function(G,ke){if(G=="bold"&&ke=="normal"||G=="bold"&&ke==400||G=="normal"&&ke=="italic"||G=="bold"&&ke=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ke&&(G=ke==400||ke==="normal"?G==="italic"?"italic":"normal":ke!=700&&ke!=="bold"||G!=="normal"?(ke==700?"bold":ke)+""+G:"bold"),G};f.advancedAPI=function(G){var ke=$===M;return ke&&P.call(this),typeof G!="function"||(G(this),ke&&se.call(this)),this},f.compatAPI=function(G){var ke=$===K;return ke&&se.call(this),typeof G!="function"||(G(this),ke&&P.call(this)),this},f.isAdvancedAPI=function(){return $===K};var R,j=function(G){if($!==K)throw new Error(G+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},T=f.roundToPrecision=f.__private__.roundToPrecision=function(G,ke){var We=s||ke;if(isNaN(G)||isNaN(We))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return G.toFixed(We).replace(/0+$/,"")};R=f.hpf=f.__private__.hpf=typeof u=="number"?function(G){if(isNaN(G))throw new Error("Invalid argument passed to jsPDF.hpf");return T(G,u)}:u==="smart"?function(G){if(isNaN(G))throw new Error("Invalid argument passed to jsPDF.hpf");return T(G,G>-1&&G<1?16:5)}:function(G){if(isNaN(G))throw new Error("Invalid argument passed to jsPDF.hpf");return T(G,16)};var Q=f.f2=f.__private__.f2=function(G){if(isNaN(G))throw new Error("Invalid argument passed to jsPDF.f2");return T(G,2)},E=f.__private__.f3=function(G){if(isNaN(G))throw new Error("Invalid argument passed to jsPDF.f3");return T(G,3)},te=f.scale=f.__private__.scale=function(G){if(isNaN(G))throw new Error("Invalid argument passed to jsPDF.scale");return $===M?G*et:$===K?G:void 0},C=function(G){return te((function(ke){return $===M?Ki()-ke:$===K?ke:void 0})(G))};f.__private__.setPrecision=f.setPrecision=function(G){typeof parseInt(G,10)=="number"&&(s=parseInt(G,10))};var O,V="00000000000000000000000000000000",re=f.__private__.getFileId=function(){return V},ge=f.__private__.setFileId=function(G){return V=G!==void 0&&/^[a-fA-F0-9]{32}$/.test(G)?G.toUpperCase():V.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),A!==null&&(Nr=new Lu(A.userPermissions,A.userPassword,A.ownerPassword,V)),V};f.setFileId=function(G){return ge(G),this},f.getFileId=function(){return re()};var xe=f.__private__.convertDateToPDFDate=function(G){var ke=G.getTimezoneOffset(),We=ke<0?"+":"-",at=Math.floor(Math.abs(ke/60)),ot=Math.abs(ke%60),Tt=[We,k(at),"'",k(ot),"'"].join("");return["D:",G.getFullYear(),k(G.getMonth()+1),k(G.getDate()),k(G.getHours()),k(G.getMinutes()),k(G.getSeconds()),Tt].join("")},Z=f.__private__.convertPDFDateToDate=function(G){var ke=parseInt(G.substr(2,4),10),We=parseInt(G.substr(6,2),10)-1,at=parseInt(G.substr(8,2),10),ot=parseInt(G.substr(10,2),10),Tt=parseInt(G.substr(12,2),10),Gt=parseInt(G.substr(14,2),10);return new Date(ke,We,at,ot,Tt,Gt,0)},I=f.__private__.setCreationDate=function(G){var ke;if(G===void 0&&(G=new Date),G instanceof Date)ke=xe(G);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(G))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ke=G}return O=ke},H=f.__private__.getCreationDate=function(G){var ke=O;return G==="jsDate"&&(ke=Z(O)),ke};f.setCreationDate=function(G){return I(G),this},f.getCreationDate=function(G){return H(G)};var ae,k=f.__private__.padd2=function(G){return("0"+parseInt(G)).slice(-2)},B=f.__private__.padd2Hex=function(G){return("00"+(G=G.toString())).substr(G.length)},w=0,oe=[],ne=[],Fe=0,je=[],Ge=[],ze=!1,Xe=ne;f.__private__.setCustomOutputDestination=function(G){ze=!0,Xe=G};var st=function(G){ze||(Xe=G)};f.__private__.resetCustomOutputDestination=function(){ze=!1,Xe=ne};var ce=f.__private__.out=function(G){return G=G.toString(),Fe+=G.length+1,Xe.push(G),Xe},_e=f.__private__.write=function(G){return ce(arguments.length===1?G.toString():Array.prototype.join.call(arguments," "))},le=f.__private__.getArrayBuffer=function(G){for(var ke=G.length,We=new ArrayBuffer(ke),at=new Uint8Array(We);ke--;)at[ke]=G.charCodeAt(ke);return We},Pe=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return Pe};var we=t.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(G){return we=$===K?G/et:G,this};var fe,ye=f.__private__.getFontSize=f.getFontSize=function(){return $===M?we:we*et},Ke=t.R2L||!1;f.__private__.setR2L=f.setR2L=function(G){return Ke=G,this},f.__private__.getR2L=f.getR2L=function(){return Ke};var ve,ie=f.__private__.setZoomMode=function(G){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(G))fe=G;else if(isNaN(G)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(G)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+G+'" is not recognized.');fe=G}else fe=parseInt(G,10)};f.__private__.getZoomMode=function(){return fe};var q,pe=f.__private__.setPageMode=function(G){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(G)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+G+'" is not recognized.');ve=G};f.__private__.getPageMode=function(){return ve};var Me=f.__private__.setLayoutMode=function(G){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(G)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+G+'" is not recognized.');q=G};f.__private__.getLayoutMode=function(){return q},f.__private__.setDisplayMode=f.setDisplayMode=function(G,ke,We){return ie(G),Me(ke),pe(We),this};var Se={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(G){if(Object.keys(Se).indexOf(G)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Se[G]},f.__private__.getDocumentProperties=function(){return Se},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(G){for(var ke in Se)Se.hasOwnProperty(ke)&&G[ke]&&(Se[ke]=G[ke]);return this},f.__private__.setDocumentProperty=function(G,ke){if(Object.keys(Se).indexOf(G)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Se[G]=ke};var Ne,et,Ce,ft,qe,W={},Ie={},mt=[],pt={},kt={},J={},Je={},_t=null,$t=0,me=[],Ze=new Hw(f),ct=t.hotfixes||[],Yt={},be={},lt=[],Ue=function G(ke,We,at,ot,Tt,Gt){if(!(this instanceof G))return new G(ke,We,at,ot,Tt,Gt);isNaN(ke)&&(ke=1),isNaN(We)&&(We=0),isNaN(at)&&(at=0),isNaN(ot)&&(ot=1),isNaN(Tt)&&(Tt=0),isNaN(Gt)&&(Gt=0),this._matrix=[ke,We,at,ot,Tt,Gt]};Object.defineProperty(Ue.prototype,"sx",{get:function(){return this._matrix[0]},set:function(G){this._matrix[0]=G}}),Object.defineProperty(Ue.prototype,"shy",{get:function(){return this._matrix[1]},set:function(G){this._matrix[1]=G}}),Object.defineProperty(Ue.prototype,"shx",{get:function(){return this._matrix[2]},set:function(G){this._matrix[2]=G}}),Object.defineProperty(Ue.prototype,"sy",{get:function(){return this._matrix[3]},set:function(G){this._matrix[3]=G}}),Object.defineProperty(Ue.prototype,"tx",{get:function(){return this._matrix[4]},set:function(G){this._matrix[4]=G}}),Object.defineProperty(Ue.prototype,"ty",{get:function(){return this._matrix[5]},set:function(G){this._matrix[5]=G}}),Object.defineProperty(Ue.prototype,"a",{get:function(){return this._matrix[0]},set:function(G){this._matrix[0]=G}}),Object.defineProperty(Ue.prototype,"b",{get:function(){return this._matrix[1]},set:function(G){this._matrix[1]=G}}),Object.defineProperty(Ue.prototype,"c",{get:function(){return this._matrix[2]},set:function(G){this._matrix[2]=G}}),Object.defineProperty(Ue.prototype,"d",{get:function(){return this._matrix[3]},set:function(G){this._matrix[3]=G}}),Object.defineProperty(Ue.prototype,"e",{get:function(){return this._matrix[4]},set:function(G){this._matrix[4]=G}}),Object.defineProperty(Ue.prototype,"f",{get:function(){return this._matrix[5]},set:function(G){this._matrix[5]=G}}),Object.defineProperty(Ue.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Ue.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Ue.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Ue.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Ue.prototype.join=function(G){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(R).join(G)},Ue.prototype.multiply=function(G){var ke=G.sx*this.sx+G.shy*this.shx,We=G.sx*this.shy+G.shy*this.sy,at=G.shx*this.sx+G.sy*this.shx,ot=G.shx*this.shy+G.sy*this.sy,Tt=G.tx*this.sx+G.ty*this.shx+this.tx,Gt=G.tx*this.shy+G.ty*this.sy+this.ty;return new Ue(ke,We,at,ot,Tt,Gt)},Ue.prototype.decompose=function(){var G=this.sx,ke=this.shy,We=this.shx,at=this.sy,ot=this.tx,Tt=this.ty,Gt=Math.sqrt(G*G+ke*ke),As=(G/=Gt)*We+(ke/=Gt)*at;We-=G*As,at-=ke*As;var ys=Math.sqrt(We*We+at*at);return As/=ys,G*(at/=ys)<ke*(We/=ys)&&(G=-G,ke=-ke,As=-As,Gt=-Gt),{scale:new Ue(Gt,0,0,ys,0,0),translate:new Ue(1,0,0,1,ot,Tt),rotate:new Ue(G,ke,-ke,G,0,0),skew:new Ue(1,0,As,1,0,0)}},Ue.prototype.toString=function(G){return this.join(" ")},Ue.prototype.inversed=function(){var G=this.sx,ke=this.shy,We=this.shx,at=this.sy,ot=this.tx,Tt=this.ty,Gt=1/(G*at-ke*We),As=at*Gt,ys=-ke*Gt,Ms=-We*Gt,Os=G*Gt;return new Ue(As,ys,Ms,Os,-As*ot-Ms*Tt,-ys*ot-Os*Tt)},Ue.prototype.applyToPoint=function(G){var ke=G.x*this.sx+G.y*this.shx+this.tx,We=G.x*this.shy+G.y*this.sy+this.ty;return new _l(ke,We)},Ue.prototype.applyToRectangle=function(G){var ke=this.applyToPoint(G),We=this.applyToPoint(new _l(G.x+G.w,G.y+G.h));return new Pi(ke.x,ke.y,We.x-ke.x,We.y-ke.y)},Ue.prototype.clone=function(){var G=this.sx,ke=this.shy,We=this.shx,at=this.sy,ot=this.tx,Tt=this.ty;return new Ue(G,ke,We,at,ot,Tt)},f.Matrix=Ue;var Ct=f.matrixMult=function(G,ke){return ke.multiply(G)},Et=new Ue(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=Et;var Rs=function(G,ke){if(!kt[G]){var We=(ke instanceof _m?"Sh":"P")+(Object.keys(pt).length+1).toString(10);ke.id=We,kt[G]=We,pt[We]=ke,Ze.publish("addPattern",ke)}};f.ShadingPattern=_m,f.TilingPattern=$u,f.addShadingPattern=function(G,ke){return j("addShadingPattern()"),Rs(G,ke),this},f.beginTilingPattern=function(G){j("beginTilingPattern()"),io(G.boundingBox[0],G.boundingBox[1],G.boundingBox[2]-G.boundingBox[0],G.boundingBox[3]-G.boundingBox[1],G.matrix)},f.endTilingPattern=function(G,ke){j("endTilingPattern()"),ke.stream=Ge[ae].join(`
`),Rs(G,ke),Ze.publish("endTilingPattern",ke),lt.pop().restore()};var He,Te=f.__private__.newObject=function(){var G=bt();return Xt(G,!0),G},bt=f.__private__.newObjectDeferred=function(){return w++,oe[w]=function(){return Fe},w},Xt=function(G,ke){return ke=typeof ke=="boolean"&&ke,oe[G]=Fe,ke&&ce(G+" 0 obj"),G},ls=f.__private__.newAdditionalObject=function(){var G={objId:bt(),content:""};return je.push(G),G},Ts=bt(),ss=bt(),he=f.__private__.decodeColorString=function(G){var ke=G.split(" ");if(ke.length!==2||ke[1]!=="g"&&ke[1]!=="G")ke.length!==5||ke[4]!=="k"&&ke[4]!=="K"||(ke=[(1-ke[0])*(1-ke[3]),(1-ke[1])*(1-ke[3]),(1-ke[2])*(1-ke[3]),"r"]);else{var We=parseFloat(ke[0]);ke=[We,We,We,"r"]}for(var at="#",ot=0;ot<3;ot++)at+=("0"+Math.floor(255*parseFloat(ke[ot])).toString(16)).slice(-2);return at},Ht=f.__private__.encodeColorString=function(G){var ke;typeof G=="string"&&(G={ch1:G});var We=G.ch1,at=G.ch2,ot=G.ch3,Tt=G.ch4,Gt=G.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof We=="string"&&We.charAt(0)!=="#"){var As=new V4(We);if(As.ok)We=As.toHex();else if(!/^\d*\.?\d*$/.test(We))throw new Error('Invalid color "'+We+'" passed to jsPDF.encodeColorString.')}if(typeof We=="string"&&/^#[0-9A-Fa-f]{3}$/.test(We)&&(We="#"+We[1]+We[1]+We[2]+We[2]+We[3]+We[3]),typeof We=="string"&&/^#[0-9A-Fa-f]{6}$/.test(We)){var ys=parseInt(We.substr(1),16);We=ys>>16&255,at=ys>>8&255,ot=255&ys}if(at===void 0||Tt===void 0&&We===at&&at===ot)ke=typeof We=="string"?We+" "+Gt[0]:G.precision===2?Q(We/255)+" "+Gt[0]:E(We/255)+" "+Gt[0];else if(Tt===void 0||Ra(Tt)==="object"){if(Tt&&!isNaN(Tt.a)&&Tt.a===0)return["1.","1.","1.",Gt[1]].join(" ");ke=typeof We=="string"?[We,at,ot,Gt[1]].join(" "):G.precision===2?[Q(We/255),Q(at/255),Q(ot/255),Gt[1]].join(" "):[E(We/255),E(at/255),E(ot/255),Gt[1]].join(" ")}else ke=typeof We=="string"?[We,at,ot,Tt,Gt[2]].join(" "):G.precision===2?[Q(We),Q(at),Q(ot),Q(Tt),Gt[2]].join(" "):[E(We),E(at),E(ot),E(Tt),Gt[2]].join(" ");return ke},Zt=f.__private__.getFilters=function(){return o},Ee=f.__private__.putStream=function(G){var ke=(G=G||{}).data||"",We=G.filters||Zt(),at=G.alreadyAppliedFilters||[],ot=G.addLength1||!1,Tt=ke.length,Gt=G.objectId,As=function(qr){return qr};if(A!==null&&Gt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");A!==null&&(As=Nr.encryptor(Gt,0));var ys={};We===!0&&(We=["FlateEncode"]);var Ms=G.additionalKeyValues||[],Os=(ys=ms.API.processDataByFilters!==void 0?ms.API.processDataByFilters(ke,We):{data:ke,reverseChain:[]}).reverseChain+(Array.isArray(at)?at.join(" "):at.toString());if(ys.data.length!==0&&(Ms.push({key:"Length",value:ys.data.length}),ot===!0&&Ms.push({key:"Length1",value:Tt})),Os.length!=0)if(Os.split("/").length-1==1)Ms.push({key:"Filter",value:Os});else{Ms.push({key:"Filter",value:"["+Os+"]"});for(var ma=0;ma<Ms.length;ma+=1)if(Ms[ma].key==="DecodeParms"){for(var tr=[],wr=0;wr<ys.reverseChain.split("/").length-1;wr+=1)tr.push("null");tr.push(Ms[ma].value),Ms[ma].value="["+tr.join(" ")+"]"}}ce("<<");for(var Ia=0;Ia<Ms.length;Ia++)ce("/"+Ms[Ia].key+" "+Ms[Ia].value);ce(">>"),ys.data.length!==0&&(ce("stream"),ce(As(ys.data)),ce("endstream"))},zt=f.__private__.putPage=function(G){var ke=G.number,We=G.data,at=G.objId,ot=G.contentsObjId;Xt(at,!0),ce("<</Type /Page"),ce("/Parent "+G.rootDictionaryObjId+" 0 R"),ce("/Resources "+G.resourceDictionaryObjId+" 0 R"),ce("/MediaBox ["+parseFloat(R(G.mediaBox.bottomLeftX))+" "+parseFloat(R(G.mediaBox.bottomLeftY))+" "+R(G.mediaBox.topRightX)+" "+R(G.mediaBox.topRightY)+"]"),G.cropBox!==null&&ce("/CropBox ["+R(G.cropBox.bottomLeftX)+" "+R(G.cropBox.bottomLeftY)+" "+R(G.cropBox.topRightX)+" "+R(G.cropBox.topRightY)+"]"),G.bleedBox!==null&&ce("/BleedBox ["+R(G.bleedBox.bottomLeftX)+" "+R(G.bleedBox.bottomLeftY)+" "+R(G.bleedBox.topRightX)+" "+R(G.bleedBox.topRightY)+"]"),G.trimBox!==null&&ce("/TrimBox ["+R(G.trimBox.bottomLeftX)+" "+R(G.trimBox.bottomLeftY)+" "+R(G.trimBox.topRightX)+" "+R(G.trimBox.topRightY)+"]"),G.artBox!==null&&ce("/ArtBox ["+R(G.artBox.bottomLeftX)+" "+R(G.artBox.bottomLeftY)+" "+R(G.artBox.topRightX)+" "+R(G.artBox.topRightY)+"]"),typeof G.userUnit=="number"&&G.userUnit!==1&&ce("/UserUnit "+G.userUnit),Ze.publish("putPage",{objId:at,pageContext:me[ke],pageNumber:ke,page:We}),ce("/Contents "+ot+" 0 R"),ce(">>"),ce("endobj");var Tt=We.join(`
`);return $===K&&(Tt+=`
Q`),Xt(ot,!0),Ee({data:Tt,filters:Zt(),objectId:ot}),ce("endobj"),at},is=f.__private__.putPages=function(){var G,ke,We=[];for(G=1;G<=$t;G++)me[G].objId=bt(),me[G].contentsObjId=bt();for(G=1;G<=$t;G++)We.push(zt({number:G,data:Ge[G],objId:me[G].objId,contentsObjId:me[G].contentsObjId,mediaBox:me[G].mediaBox,cropBox:me[G].cropBox,bleedBox:me[G].bleedBox,trimBox:me[G].trimBox,artBox:me[G].artBox,userUnit:me[G].userUnit,rootDictionaryObjId:Ts,resourceDictionaryObjId:ss}));Xt(Ts,!0),ce("<</Type /Pages");var at="/Kids [";for(ke=0;ke<$t;ke++)at+=We[ke]+" 0 R ";ce(at+"]"),ce("/Count "+$t),ce(">>"),ce("endobj"),Ze.publish("postPutPages")},pa=function(G){Ze.publish("putFont",{font:G,out:ce,newObject:Te,putStream:Ee}),G.isAlreadyPutted!==!0&&(G.objectNumber=Te(),ce("<<"),ce("/Type /Font"),ce("/BaseFont /"+Qu(G.postScriptName)),ce("/Subtype /Type1"),typeof G.encoding=="string"&&ce("/Encoding /"+G.encoding),ce("/FirstChar 32"),ce("/LastChar 255"),ce(">>"),ce("endobj"))},ba=function(G){G.objectNumber=Te();var ke=[];ke.push({key:"Type",value:"/XObject"}),ke.push({key:"Subtype",value:"/Form"}),ke.push({key:"BBox",value:"["+[R(G.x),R(G.y),R(G.x+G.width),R(G.y+G.height)].join(" ")+"]"}),ke.push({key:"Matrix",value:"["+G.matrix.toString()+"]"});var We=G.pages[1].join(`
`);Ee({data:We,additionalKeyValues:ke,objectId:G.objectNumber}),ce("endobj")},xn=function(G,ke){ke||(ke=21);var We=Te(),at=(function(Gt,As){var ys,Ms=[],Os=1/(As-1);for(ys=0;ys<1;ys+=Os)Ms.push(ys);if(Ms.push(1),Gt[0].offset!=0){var ma={offset:0,color:Gt[0].color};Gt.unshift(ma)}if(Gt[Gt.length-1].offset!=1){var tr={offset:1,color:Gt[Gt.length-1].color};Gt.push(tr)}for(var wr="",Ia=0,qr=0;qr<Ms.length;qr++){for(ys=Ms[qr];ys>Gt[Ia+1].offset;)Ia++;var Fr=Gt[Ia].offset,gn=(ys-Fr)/(Gt[Ia+1].offset-Fr),Vi=Gt[Ia].color,Wl=Gt[Ia+1].color;wr+=B(Math.round((1-gn)*Vi[0]+gn*Wl[0]).toString(16))+B(Math.round((1-gn)*Vi[1]+gn*Wl[1]).toString(16))+B(Math.round((1-gn)*Vi[2]+gn*Wl[2]).toString(16))}return wr.trim()})(G.colors,ke),ot=[];ot.push({key:"FunctionType",value:"0"}),ot.push({key:"Domain",value:"[0.0 1.0]"}),ot.push({key:"Size",value:"["+ke+"]"}),ot.push({key:"BitsPerSample",value:"8"}),ot.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ot.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ee({data:at,additionalKeyValues:ot,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:We}),ce("endobj"),G.objectNumber=Te(),ce("<< /ShadingType "+G.type),ce("/ColorSpace /DeviceRGB");var Tt="/Coords ["+R(parseFloat(G.coords[0]))+" "+R(parseFloat(G.coords[1]))+" ";G.type===2?Tt+=R(parseFloat(G.coords[2]))+" "+R(parseFloat(G.coords[3])):Tt+=R(parseFloat(G.coords[2]))+" "+R(parseFloat(G.coords[3]))+" "+R(parseFloat(G.coords[4]))+" "+R(parseFloat(G.coords[5])),ce(Tt+="]"),G.matrix&&ce("/Matrix ["+G.matrix.toString()+"]"),ce("/Function "+We+" 0 R"),ce("/Extend [true true]"),ce(">>"),ce("endobj")},zr=function(G,ke){var We=bt(),at=Te();ke.push({resourcesOid:We,objectOid:at}),G.objectNumber=at;var ot=[];ot.push({key:"Type",value:"/Pattern"}),ot.push({key:"PatternType",value:"1"}),ot.push({key:"PaintType",value:"1"}),ot.push({key:"TilingType",value:"1"}),ot.push({key:"BBox",value:"["+G.boundingBox.map(R).join(" ")+"]"}),ot.push({key:"XStep",value:R(G.xStep)}),ot.push({key:"YStep",value:R(G.yStep)}),ot.push({key:"Resources",value:We+" 0 R"}),G.matrix&&ot.push({key:"Matrix",value:"["+G.matrix.toString()+"]"}),Ee({data:G.stream,additionalKeyValues:ot,objectId:G.objectNumber}),ce("endobj")},De=function(G){for(var ke in G.objectNumber=Te(),ce("<<"),G)switch(ke){case"opacity":ce("/ca "+Q(G[ke]));break;case"stroke-opacity":ce("/CA "+Q(G[ke]))}ce(">>"),ce("endobj")},Jt=function(G){Xt(G.resourcesOid,!0),ce("<<"),ce("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var ke in ce("/Font <<"),W)W.hasOwnProperty(ke)&&(g===!1||g===!0&&N.hasOwnProperty(ke))&&ce("/"+ke+" "+W[ke].objectNumber+" 0 R");ce(">>")})(),(function(){if(Object.keys(pt).length>0){for(var ke in ce("/Shading <<"),pt)pt.hasOwnProperty(ke)&&pt[ke]instanceof _m&&pt[ke].objectNumber>=0&&ce("/"+ke+" "+pt[ke].objectNumber+" 0 R");Ze.publish("putShadingPatternDict"),ce(">>")}})(),(function(ke){if(Object.keys(pt).length>0){for(var We in ce("/Pattern <<"),pt)pt.hasOwnProperty(We)&&pt[We]instanceof f.TilingPattern&&pt[We].objectNumber>=0&&pt[We].objectNumber<ke&&ce("/"+We+" "+pt[We].objectNumber+" 0 R");Ze.publish("putTilingPatternDict"),ce(">>")}})(G.objectOid),(function(){if(Object.keys(J).length>0){var ke;for(ke in ce("/ExtGState <<"),J)J.hasOwnProperty(ke)&&J[ke].objectNumber>=0&&ce("/"+ke+" "+J[ke].objectNumber+" 0 R");Ze.publish("putGStateDict"),ce(">>")}})(),(function(){for(var ke in ce("/XObject <<"),Yt)Yt.hasOwnProperty(ke)&&Yt[ke].objectNumber>=0&&ce("/"+ke+" "+Yt[ke].objectNumber+" 0 R");Ze.publish("putXobjectDict"),ce(">>")})(),ce(">>"),ce("endobj")},rs=function(G){Ie[G.fontName]=Ie[G.fontName]||{},Ie[G.fontName][G.fontStyle]=G.id},dr=function(G,ke,We,at,ot){var Tt={id:"F"+(Object.keys(W).length+1).toString(10),postScriptName:G,fontName:ke,fontStyle:We,encoding:at,isStandardFont:ot||!1,metadata:{}};return Ze.publish("addFont",{font:Tt,instance:this}),W[Tt.id]=Tt,rs(Tt),Tt.id},Ae=f.__private__.pdfEscape=f.pdfEscape=function(G,ke){return(function(We,at){var ot,Tt,Gt,As,ys,Ms,Os,ma,tr;if(Gt=(at=at||{}).sourceEncoding||"Unicode",ys=at.outputEncoding,(at.autoencode||ys)&&W[Ne].metadata&&W[Ne].metadata[Gt]&&W[Ne].metadata[Gt].encoding&&(As=W[Ne].metadata[Gt].encoding,!ys&&W[Ne].encoding&&(ys=W[Ne].encoding),!ys&&As.codePages&&(ys=As.codePages[0]),typeof ys=="string"&&(ys=As[ys]),ys)){for(Os=!1,Ms=[],ot=0,Tt=We.length;ot<Tt;ot++)(ma=ys[We.charCodeAt(ot)])?Ms.push(String.fromCharCode(ma)):Ms.push(We[ot]),Ms[ot].charCodeAt(0)>>8&&(Os=!0);We=Ms.join("")}for(ot=We.length;Os===void 0&&ot!==0;)We.charCodeAt(ot-1)>>8&&(Os=!0),ot--;if(!Os)return We;for(Ms=at.noBOM?[]:[254,255],ot=0,Tt=We.length;ot<Tt;ot++){if((tr=(ma=We.charCodeAt(ot))>>8)>>8)throw new Error("Character at position "+ot+" of string '"+We+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Ms.push(tr),Ms.push(ma-(tr<<8))}return String.fromCharCode.apply(void 0,Ms)})(G,ke).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},es=f.__private__.beginPage=function(G){Ge[++$t]=[],me[$t]={objId:0,contentsObjId:0,userUnit:Number(m),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(G[0]),topRightY:Number(G[1])}},Ii($t),st(Ge[ae])},ws=function(G,ke){var We,at,ot;switch(a=ke||a,typeof G=="string"&&(We=D(G.toLowerCase()),Array.isArray(We)&&(at=We[0],ot=We[1])),Array.isArray(G)&&(at=G[0]*et,ot=G[1]*et),isNaN(at)&&(at=l[0],ot=l[1]),(at>14400||ot>14400)&&(Ja.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),at=Math.min(14400,at),ot=Math.min(14400,ot)),l=[at,ot],a.substr(0,1)){case"l":ot>at&&(l=[ot,at]);break;case"p":at>ot&&(l=[ot,at])}es(l),Es(ro),ce(hl),Wo!==0&&ce(Wo+" J"),sn!==0&&ce(sn+" j"),Ze.publish("addPage",{pageNumber:$t})},Da=function(G){G>0&&G<=$t&&(Ge.splice(G,1),me.splice(G,1),$t--,ae>$t&&(ae=$t),this.setPage(ae))},Ii=function(G){G>0&&G<=$t&&(ae=G)},Kl=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return Ge.length-1},mr=function(G,ke,We){var at,ot=void 0;return We=We||{},G=G!==void 0?G:W[Ne].fontName,ke=ke!==void 0?ke:W[Ne].fontStyle,at=G.toLowerCase(),Ie[at]!==void 0&&Ie[at][ke]!==void 0?ot=Ie[at][ke]:Ie[G]!==void 0&&Ie[G][ke]!==void 0?ot=Ie[G][ke]:We.disableWarning===!1&&Ja.warn("Unable to look up font label for font '"+G+"', '"+ke+"'. Refer to getFontList() for available fonts."),ot||We.noFallback||(ot=Ie.times[ke])==null&&(ot=Ie.times.normal),ot},hn=f.__private__.putInfo=function(){var G=Te(),ke=function(at){return at};for(var We in A!==null&&(ke=Nr.encryptor(G,0)),ce("<<"),ce("/Producer ("+Ae(ke("jsPDF "+ms.version))+")"),Se)Se.hasOwnProperty(We)&&Se[We]&&ce("/"+We.substr(0,1).toUpperCase()+We.substr(1)+" ("+Ae(ke(Se[We]))+")");ce("/CreationDate ("+Ae(ke(O))+")"),ce(">>"),ce("endobj")},Vl=f.__private__.putCatalog=function(G){var ke=(G=G||{}).rootDictionaryObjId||Ts;switch(Te(),ce("<<"),ce("/Type /Catalog"),ce("/Pages "+ke+" 0 R"),fe||(fe="fullwidth"),fe){case"fullwidth":ce("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ce("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ce("/OpenAction [3 0 R /Fit]");break;case"original":ce("/OpenAction [3 0 R /XYZ null null 1]");break;default:var We=""+fe;We.substr(We.length-1)==="%"&&(fe=parseInt(fe)/100),typeof fe=="number"&&ce("/OpenAction [3 0 R /XYZ null null "+Q(fe)+"]")}switch(q||(q="continuous"),q){case"continuous":ce("/PageLayout /OneColumn");break;case"single":ce("/PageLayout /SinglePage");break;case"two":case"twoleft":ce("/PageLayout /TwoColumnLeft");break;case"tworight":ce("/PageLayout /TwoColumnRight")}ve&&ce("/PageMode /"+ve),Ze.publish("putCatalog"),ce(">>"),ce("endobj")},dl=f.__private__.putTrailer=function(){ce("trailer"),ce("<<"),ce("/Size "+(w+1)),ce("/Root "+w+" 0 R"),ce("/Info "+(w-1)+" 0 R"),A!==null&&ce("/Encrypt "+Nr.oid+" 0 R"),ce("/ID [ <"+V+"> <"+V+"> ]"),ce(">>")},da=f.__private__.putHeader=function(){ce("%PDF-"+y),ce("%")},$i=f.__private__.putXRef=function(){var G="0000000000";ce("xref"),ce("0 "+(w+1)),ce("0000000000 65535 f ");for(var ke=1;ke<=w;ke++)typeof oe[ke]=="function"?ce((G+oe[ke]()).slice(-10)+" 00000 n "):oe[ke]!==void 0?ce((G+oe[ke]).slice(-10)+" 00000 n "):ce("0000000000 00000 n ")},Nl=f.__private__.buildDocument=function(){var G;w=0,Fe=0,ne=[],oe=[],je=[],Ts=bt(),ss=bt(),st(ne),Ze.publish("buildDocument"),da(),is(),(function(){Ze.publish("putAdditionalObjects");for(var We=0;We<je.length;We++){var at=je[We];Xt(at.objId,!0),ce(at.content),ce("endobj")}Ze.publish("postPutAdditionalObjects")})(),G=[],(function(){for(var We in W)W.hasOwnProperty(We)&&(g===!1||g===!0&&N.hasOwnProperty(We))&&pa(W[We])})(),(function(){var We;for(We in J)J.hasOwnProperty(We)&&De(J[We])})(),(function(){for(var We in Yt)Yt.hasOwnProperty(We)&&ba(Yt[We])})(),(function(We){var at;for(at in pt)pt.hasOwnProperty(at)&&(pt[at]instanceof _m?xn(pt[at]):pt[at]instanceof $u&&zr(pt[at],We))})(G),Ze.publish("putResources"),G.forEach(Jt),Jt({resourcesOid:ss,objectOid:Number.MAX_SAFE_INTEGER}),Ze.publish("postPutResources"),A!==null&&(Nr.oid=Te(),ce("<<"),ce("/Filter /Standard"),ce("/V "+Nr.v),ce("/R "+Nr.r),ce("/U <"+Nr.toHexString(Nr.U)+">"),ce("/O <"+Nr.toHexString(Nr.O)+">"),ce("/P "+Nr.P),ce(">>"),ce("endobj")),hn(),Vl();var ke=Fe;return $i(),dl(),ce("startxref"),ce(""+ke),ce("%%EOF"),st(Ge[ae]),ne.join(`
`)},mi=f.__private__.getBlob=function(G){return new Blob([le(G)],{type:"application/pdf"})},to=f.output=f.__private__.output=(He=function(G,ke){switch(typeof(ke=ke||{})=="string"?ke={filename:ke}:ke.filename=ke.filename||"generated.pdf",G){case void 0:return Nl();case"save":f.save(ke.filename);break;case"arraybuffer":return le(Nl());case"blob":return mi(Nl());case"bloburi":case"bloburl":if(Ps.URL!==void 0&&typeof Ps.URL.createObjectURL=="function")return Ps.URL&&Ps.URL.createObjectURL(mi(Nl()))||void 0;Ja.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var We="",at=Nl();try{We=Mw(at)}catch{We=Mw(unescape(encodeURIComponent(at)))}return"data:application/pdf;filename="+ke.filename+";base64,"+We;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Ps)==="[object Window]"){var ot="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Tt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ke.pdfObjectUrl&&(ot=ke.pdfObjectUrl,Tt="");var Gt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ot+'"'+Tt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ke)+");<\/script></body></html>",As=Ps.open();return As!==null&&As.document.write(Gt),As}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Ps)==="[object Window]"){var ys='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ke.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ke.filename+'" width="500px" height="400px" /></body></html>',Ms=Ps.open();if(Ms!==null){Ms.document.write(ys);var Os=this;Ms.document.documentElement.querySelector("#pdfViewer").onload=function(){Ms.document.title=ke.filename,Ms.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Os.output("bloburl"))}}return Ms}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Ps)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var ma='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ke)+'"></iframe></body></html>',tr=Ps.open();if(tr!==null&&(tr.document.write(ma),tr.document.title=ke.filename),tr||typeof safari>"u")return tr;break;case"datauri":case"dataurl":return Ps.document.location.href=this.output("datauristring",ke);default:return null}},He.foo=function(){try{return He.apply(this,arguments)}catch(We){var G=We.stack||"";~G.indexOf(" at ")&&(G=G.split(" at ")[1]);var ke="Error in function "+G.split(`
`)[0].split("<")[0]+": "+We.message;if(!Ps.console)throw new Error(ke);Ps.console.error(ke,We),Ps.alert&&alert(ke)}},He.foo.bar=He,He.foo),pn=function(G){return Array.isArray(ct)===!0&&ct.indexOf(G)>-1};switch(r){case"pt":et=1;break;case"mm":et=72/25.4;break;case"cm":et=72/2.54;break;case"in":et=72;break;case"px":et=pn("px_scaling")==1?.75:96/72;break;case"pc":case"em":et=12;break;case"ex":et=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);et=r}var Nr=null;I(),ge();var ur=f.__private__.getPageInfo=f.getPageInfo=function(G){if(isNaN(G)||G%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:me[G].objId,pageNumber:G,pageContext:me[G]}},_c=f.__private__.getPageInfoByObjId=function(G){if(isNaN(G)||G%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ke in me)if(me[ke].objId===G)break;return ur(ke)},Vo=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:me[ae].objId,pageNumber:ae,pageContext:me[ae]}};f.addPage=function(){return ws.apply(this,arguments),this},f.setPage=function(){return Ii.apply(this,arguments),st.call(this,Ge[ae]),this},f.insertPage=function(G){return this.addPage(),this.movePage(ae,G),this},f.movePage=function(G,ke){var We,at;if(G>ke){We=Ge[G],at=me[G];for(var ot=G;ot>ke;ot--)Ge[ot]=Ge[ot-1],me[ot]=me[ot-1];Ge[ke]=We,me[ke]=at,this.setPage(ke)}else if(G<ke){We=Ge[G],at=me[G];for(var Tt=G;Tt<ke;Tt++)Ge[Tt]=Ge[Tt+1],me[Tt]=me[Tt+1];Ge[ke]=We,me[ke]=at,this.setPage(ke)}return this},f.deletePage=function(){return Da.apply(this,arguments),this},f.__private__.text=f.text=function(G,ke,We,at,ot){var Tt,Gt,As,ys,Ms,Os,ma,tr,wr,Ia=(at=at||{}).scope||this;if(typeof G=="number"&&typeof ke=="number"&&(typeof We=="string"||Array.isArray(We))){var qr=We;We=ke,ke=G,G=qr}if(arguments[3]instanceof Ue==0?(As=arguments[4],ys=arguments[5],Ra(ma=arguments[3])==="object"&&ma!==null||(typeof As=="string"&&(ys=As,As=null),typeof ma=="string"&&(ys=ma,ma=null),typeof ma=="number"&&(As=ma,ma=null),at={flags:ma,angle:As,align:ys})):(j("The transform parameter of text() with a Matrix value"),wr=ot),isNaN(ke)||isNaN(We)||G==null)throw new Error("Invalid arguments passed to jsPDF.text");if(G.length===0)return Ia;var Fr,gn="",Vi=typeof at.lineHeightFactor=="number"?at.lineHeightFactor:Hi,Wl=Ia.internal.scaleFactor;function Yi(ya){return ya=ya.split("	").join(Array(at.TabLen||9).join(" ")),Ae(ya,ma)}function Xd(ya){for(var ua,$a=ya.concat(),Cr=[],ji=$a.length;ji--;)typeof(ua=$a.shift())=="string"?Cr.push(ua):Array.isArray(ya)&&(ua.length===1||ua[1]===void 0&&ua[2]===void 0)?Cr.push(ua[0]):Cr.push([ua[0],ua[1],ua[2]]);return Cr}function Jo(ya,ua){var $a;if(typeof ya=="string")$a=ua(ya)[0];else if(Array.isArray(ya)){for(var Cr,ji,ei=ya.concat(),uo=[],em=ei.length;em--;)typeof(Cr=ei.shift())=="string"?uo.push(ua(Cr)[0]):Array.isArray(Cr)&&typeof Cr[0]=="string"&&(ji=ua(Cr[0],Cr[1],Cr[2]),uo.push([ji[0],ji[1],ji[2]]));$a=uo}return $a}var hi=!1,Xl=!0;if(typeof G=="string")hi=!0;else if(Array.isArray(G)){var oo=G.concat();Gt=[];for(var Wi,an=oo.length;an--;)(typeof(Wi=oo.shift())!="string"||Array.isArray(Wi)&&typeof Wi[0]!="string")&&(Xl=!1);hi=Xl}if(hi===!1)throw new Error('Type of text must be string or Array. "'+G+'" is not recognized.');typeof G=="string"&&(G=G.match(/[\r?\n]/)?G.split(/\r\n|\r|\n/g):[G]);var kc=we/Ia.internal.scaleFactor,Bc=kc*(Vi-1);switch(at.baseline){case"bottom":We-=Bc;break;case"top":We+=kc-Bc;break;case"hanging":We+=kc-2*Bc;break;case"middle":We+=kc/2-Bc}if((Os=at.maxWidth||0)>0&&(typeof G=="string"?G=Ia.splitTextToSize(G,Os):Object.prototype.toString.call(G)==="[object Array]"&&(G=G.reduce(function(ya,ua){return ya.concat(Ia.splitTextToSize(ua,Os))},[]))),Tt={text:G,x:ke,y:We,options:at,mutex:{pdfEscape:Ae,activeFontKey:Ne,fonts:W,activeFontSize:we}},Ze.publish("preProcessText",Tt),G=Tt.text,As=(at=Tt.options).angle,wr instanceof Ue==0&&As&&typeof As=="number"){As*=Math.PI/180,at.rotationDirection===0&&(As=-As),$===K&&(As=-As);var Zo=Math.cos(As),pi=Math.sin(As);wr=new Ue(Zo,pi,-pi,Zo,0,0)}else As&&As instanceof Ue&&(wr=As);$!==K||wr||(wr=Et),(Ms=at.charSpace||wl)!==void 0&&(gn+=R(te(Ms))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(tr=at.horizontalScale)!==void 0&&(gn+=R(100*tr)+` Tz
`),at.lang;var Rn=-1,Xi=at.renderingMode!==void 0?at.renderingMode:at.stroke,ed=Ia.internal.getCurrentPageInfo().pageContext;switch(Xi){case 0:case!1:case"fill":Rn=0;break;case 1:case!0:case"stroke":Rn=1;break;case 2:case"fillThenStroke":Rn=2;break;case 3:case"invisible":Rn=3;break;case 4:case"fillAndAddForClipping":Rn=4;break;case 5:case"strokeAndAddPathForClipping":Rn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Rn=6;break;case 7:case"addToPathForClipping":Rn=7}var Jd=ed.usedRenderingMode!==void 0?ed.usedRenderingMode:-1;Rn!==-1?gn+=Rn+` Tr
`:Jd!==-1&&(gn+=`0 Tr
`),Rn!==-1&&(ed.usedRenderingMode=Rn),ys=at.align||"left";var pl,Jl=we*Vi,Ji=Ia.internal.pageSize.getWidth(),Zd=W[Ne];Ms=at.charSpace||wl,Os=at.maxWidth||0,ma=Object.assign({autoencode:!0,noBOM:!0},at.flags);var Zl=[],Fc=function(ya){return Ia.getStringUnitWidth(ya,{font:Zd,charSpace:Ms,fontSize:we,doKerning:!1})*we/Wl};if(Object.prototype.toString.call(G)==="[object Array]"){var Kn;Gt=Xd(G),ys!=="left"&&(pl=Gt.map(Fc));var Mn,Ai=0;if(ys==="right"){ke-=pl[0],G=[],an=Gt.length;for(var gi=0;gi<an;gi++)gi===0?(Mn=xl(ke),Kn=An(We)):(Mn=te(Ai-pl[gi]),Kn=-Jl),G.push([Gt[gi],Mn,Kn]),Ai=pl[gi]}else if(ys==="center"){ke-=pl[0]/2,G=[],an=Gt.length;for(var Zi=0;Zi<an;Zi++)Zi===0?(Mn=xl(ke),Kn=An(We)):(Mn=te((Ai-pl[Zi])/2),Kn=-Jl),G.push([Gt[Zi],Mn,Kn]),Ai=pl[Zi]}else if(ys==="left"){G=[],an=Gt.length;for(var td=0;td<an;td++)G.push(Gt[td])}else if(ys==="justify"&&Zd.encoding==="Identity-H"){G=[],an=Gt.length,Os=Os!==0?Os:Ji;for(var sd=0,_r=0;_r<an;_r++)if(Kn=_r===0?An(We):-Jl,Mn=_r===0?xl(ke):sd,_r<an-1){var Gm=te((Os-pl[_r])/(Gt[_r].split(" ").length-1)),fi=Gt[_r].split(" ");G.push([fi[0]+" ",Mn,Kn]),sd=0;for(var bi=1;bi<fi.length;bi++){var fn=(Fc(fi[bi-1]+" "+fi[bi])-Fc(fi[bi]))*Wl+Gm;bi==fi.length-1?G.push([fi[bi],fn,0]):G.push([fi[bi]+" ",fn,0]),sd-=fn}}else G.push([Gt[_r],Mn,Kn]);G.push(["",sd,0])}else{if(ys!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(G=[],an=Gt.length,Os=Os!==0?Os:Ji,_r=0;_r<an;_r++){Kn=_r===0?An(We):-Jl,Mn=_r===0?xl(ke):0;var ec=Gt[_r].split(" ").length-1,ad=ec>0?(Os-pl[_r])/ec:0;_r<an-1?Zl.push(R(te(ad))):Zl.push(0),G.push([Gt[_r],Mn,Kn])}}}(typeof at.R2L=="boolean"?at.R2L:Ke)===!0&&(G=Jo(G,function(ya,ua,$a){return[ya.split("").reverse().join(""),ua,$a]})),Tt={text:G,x:ke,y:We,options:at,mutex:{pdfEscape:Ae,activeFontKey:Ne,fonts:W,activeFontSize:we}},Ze.publish("postProcessText",Tt),G=Tt.text,Fr=Tt.mutex.isHex||!1;var rd=W[Ne].encoding;rd!=="WinAnsiEncoding"&&rd!=="StandardEncoding"||(G=Jo(G,function(ya,ua,$a){return[Yi(ya),ua,$a]})),Gt=Xd(G),G=[];for(var tc,sc,yi,mo=Array.isArray(Gt[0])?1:0,Al="",ac=function(ya,ua,$a){var Cr="";return $a instanceof Ue?($a=typeof at.angle=="number"?Ct($a,new Ue(1,0,0,1,ya,ua)):Ct(new Ue(1,0,0,1,ya,ua),$a),$===K&&($a=Ct(new Ue(1,0,0,-1,0,0),$a)),Cr=$a.join(" ")+` Tm
`):Cr=R(ya)+" "+R(ua)+` Td
`,Cr},Cn=0;Cn<Gt.length;Cn++){switch(Al="",mo){case 1:yi=(Fr?"<":"(")+Gt[Cn][0]+(Fr?">":")"),tc=parseFloat(Gt[Cn][1]),sc=parseFloat(Gt[Cn][2]);break;case 0:yi=(Fr?"<":"(")+Gt[Cn]+(Fr?">":")"),tc=xl(ke),sc=An(We)}Zl!==void 0&&Zl[Cn]!==void 0&&(Al=Zl[Cn]+` Tw
`),Cn===0?G.push(Al+ac(tc,sc,wr)+yi):mo===0?G.push(Al+yi):mo===1&&G.push(Al+ac(tc,sc,wr)+yi)}G=mo===0?G.join(` Tj
T* `):G.join(` Tj
`),G+=` Tj
`;var Cl=`BT
/`;return Cl+=Ne+" "+we+` Tf
`,Cl+=R(we*Vi)+` TL
`,Cl+=ui+`
`,Cl+=gn,Cl+=G,ce(Cl+="ET"),N[Ne]=!0,Ia};var Cc=f.__private__.clip=f.clip=function(G){return ce(G==="evenodd"?"W*":"W"),this};f.clipEvenOdd=function(){return Cc("evenodd")},f.__private__.discardPath=f.discardPath=function(){return ce("n"),this};var Gr=f.__private__.isValidStyle=function(G){var ke=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(G)!==-1&&(ke=!0),ke};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(G){return Gr(G)&&(x=G),this};var so=f.__private__.getStyle=f.getStyle=function(G){var ke=x;switch(G){case"D":case"S":ke="S";break;case"F":ke="f";break;case"FD":case"DF":ke="B";break;case"f":case"f*":case"B":case"B*":ke=G}return ke},ao=f.close=function(){return ce("h"),this};f.stroke=function(){return ce("S"),this},f.fill=function(G){return ml("f",G),this},f.fillEvenOdd=function(G){return ml("f*",G),this},f.fillStroke=function(G){return ml("B",G),this},f.fillStrokeEvenOdd=function(G){return ml("B*",G),this};var ml=function(G,ke){Ra(ke)==="object"?Ss(ke,G):ce(G)},Y=function(G){G===null||$===K&&G===void 0||(G=so(G),ce(G))};function vt(G,ke,We,at,ot){var Tt=new $u(ke||this.boundingBox,We||this.xStep,at||this.yStep,this.gState,ot||this.matrix);Tt.stream=this.stream;var Gt=G+"$$"+this.cloneIndex+++"$$";return Rs(Gt,Tt),Tt}var Ss=function(G,ke){var We=kt[G.key],at=pt[We];if(at instanceof _m)ce("q"),ce(xr(ke)),at.gState&&f.setGState(at.gState),ce(G.matrix.toString()+" cm"),ce("/"+We+" sh"),ce("Q");else if(at instanceof $u){var ot=new Ue(1,0,0,-1,0,Ki());G.matrix&&(ot=ot.multiply(G.matrix||Et),We=vt.call(at,G.key,G.boundingBox,G.xStep,G.yStep,ot).id),ce("q"),ce("/Pattern cs"),ce("/"+We+" scn"),at.gState&&f.setGState(at.gState),ce(ke),ce("Q")}},xr=function(G){switch(G){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},ul=f.moveTo=function(G,ke){return ce(R(te(G))+" "+R(C(ke))+" m"),this},hr=f.lineTo=function(G,ke){return ce(R(te(G))+" "+R(C(ke))+" l"),this},qn=f.curveTo=function(G,ke,We,at,ot,Tt){return ce([R(te(G)),R(C(ke)),R(te(We)),R(C(at)),R(te(ot)),R(C(Tt)),"c"].join(" ")),this};f.__private__.line=f.line=function(G,ke,We,at,ot){if(isNaN(G)||isNaN(ke)||isNaN(We)||isNaN(at)||!Gr(ot))throw new Error("Invalid arguments passed to jsPDF.line");return $===M?this.lines([[We-G,at-ke]],G,ke,[1,1],ot||"S"):this.lines([[We-G,at-ke]],G,ke,[1,1]).stroke()},f.__private__.lines=f.lines=function(G,ke,We,at,ot,Tt){var Gt,As,ys,Ms,Os,ma,tr,wr,Ia,qr,Fr,gn;if(typeof G=="number"&&(gn=We,We=ke,ke=G,G=gn),at=at||[1,1],Tt=Tt||!1,isNaN(ke)||isNaN(We)||!Array.isArray(G)||!Array.isArray(at)||!Gr(ot)||typeof Tt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(ul(ke,We),Gt=at[0],As=at[1],Ms=G.length,qr=ke,Fr=We,ys=0;ys<Ms;ys++)(Os=G[ys]).length===2?(qr=Os[0]*Gt+qr,Fr=Os[1]*As+Fr,hr(qr,Fr)):(ma=Os[0]*Gt+qr,tr=Os[1]*As+Fr,wr=Os[2]*Gt+qr,Ia=Os[3]*As+Fr,qr=Os[4]*Gt+qr,Fr=Os[5]*As+Fr,qn(ma,tr,wr,Ia,qr,Fr));return Tt&&ao(),Y(ot),this},f.path=function(G){for(var ke=0;ke<G.length;ke++){var We=G[ke],at=We.c;switch(We.op){case"m":ul(at[0],at[1]);break;case"l":hr(at[0],at[1]);break;case"c":qn.apply(this,at);break;case"h":ao()}}return this},f.__private__.rect=f.rect=function(G,ke,We,at,ot){if(isNaN(G)||isNaN(ke)||isNaN(We)||isNaN(at)||!Gr(ot))throw new Error("Invalid arguments passed to jsPDF.rect");return $===M&&(at=-at),ce([R(te(G)),R(C(ke)),R(te(We)),R(te(at)),"re"].join(" ")),Y(ot),this},f.__private__.triangle=f.triangle=function(G,ke,We,at,ot,Tt,Gt){if(isNaN(G)||isNaN(ke)||isNaN(We)||isNaN(at)||isNaN(ot)||isNaN(Tt)||!Gr(Gt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[We-G,at-ke],[ot-We,Tt-at],[G-ot,ke-Tt]],G,ke,[1,1],Gt,!0),this},f.__private__.roundedRect=f.roundedRect=function(G,ke,We,at,ot,Tt,Gt){if(isNaN(G)||isNaN(ke)||isNaN(We)||isNaN(at)||isNaN(ot)||isNaN(Tt)||!Gr(Gt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var As=4/3*(Math.SQRT2-1);return ot=Math.min(ot,.5*We),Tt=Math.min(Tt,.5*at),this.lines([[We-2*ot,0],[ot*As,0,ot,Tt-Tt*As,ot,Tt],[0,at-2*Tt],[0,Tt*As,-ot*As,Tt,-ot,Tt],[2*ot-We,0],[-ot*As,0,-ot,-Tt*As,-ot,-Tt],[0,2*Tt-at],[0,-Tt*As,ot*As,-Tt,ot,-Tt]],G+ot,ke,[1,1],Gt,!0),this},f.__private__.ellipse=f.ellipse=function(G,ke,We,at,ot){if(isNaN(G)||isNaN(ke)||isNaN(We)||isNaN(at)||!Gr(ot))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Tt=4/3*(Math.SQRT2-1)*We,Gt=4/3*(Math.SQRT2-1)*at;return ul(G+We,ke),qn(G+We,ke-Gt,G+Tt,ke-at,G,ke-at),qn(G-Tt,ke-at,G-We,ke-Gt,G-We,ke),qn(G-We,ke+Gt,G-Tt,ke+at,G,ke+at),qn(G+Tt,ke+at,G+We,ke+Gt,G+We,ke),Y(ot),this},f.__private__.circle=f.circle=function(G,ke,We,at){if(isNaN(G)||isNaN(ke)||isNaN(We)||!Gr(at))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(G,ke,We,We,at)},f.setFont=function(G,ke,We){return We&&(ke=z(ke,We)),Ne=mr(G,ke,{disableWarning:!1}),this};var Yl=f.__private__.getFont=f.getFont=function(){return W[mr.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var G,ke,We={};for(G in Ie)if(Ie.hasOwnProperty(G))for(ke in We[G]=[],Ie[G])Ie[G].hasOwnProperty(ke)&&We[G].push(ke);return We},f.addFont=function(G,ke,We,at,ot){var Tt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Tt.indexOf(arguments[3])!==-1?ot=arguments[3]:arguments[3]&&Tt.indexOf(arguments[3])==-1&&(We=z(We,at)),dr.call(this,G,ke,We,ot=ot||"Identity-H")};var Hi,ro=t.lineWidth||.200025,Sc=f.__private__.getLineWidth=f.getLineWidth=function(){return ro},Es=f.__private__.setLineWidth=f.setLineWidth=function(G){return ro=G,ce(R(te(G))+" w"),this};f.__private__.setLineDash=ms.API.setLineDash=ms.API.setLineDashPattern=function(G,ke){if(G=G||[],ke=ke||0,isNaN(ke)||!Array.isArray(G))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return G=G.map(function(We){return R(te(We))}).join(" "),ke=R(te(ke)),ce("["+G+"] "+ke+" d"),this};var $m=f.__private__.getLineHeight=f.getLineHeight=function(){return we*Hi};f.__private__.getLineHeight=f.getLineHeight=function(){return we*Hi};var Vd=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(G){return typeof(G=G||1.15)=="number"&&(Hi=G),this},Hm=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return Hi};Vd(t.lineHeight);var xl=f.__private__.getHorizontalCoordinate=function(G){return te(G)},An=f.__private__.getVerticalCoordinate=function(G){return $===K?G:me[ae].mediaBox.topRightY-me[ae].mediaBox.bottomLeftY-te(G)},Yd=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(G){return R(xl(G))},no=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(G){return R(An(G))},hl=t.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return he(hl)},f.__private__.setStrokeColor=f.setDrawColor=function(G,ke,We,at){return hl=Ht({ch1:G,ch2:ke,ch3:We,ch4:at,pdfColorType:"draw",precision:2}),ce(hl),this};var lo=t.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return he(lo)},f.__private__.setFillColor=f.setFillColor=function(G,ke,We,at){return lo=Ht({ch1:G,ch2:ke,ch3:We,ch4:at,pdfColorType:"fill",precision:2}),ce(lo),this};var ui=t.textColor||"0 g",Pm=f.__private__.getTextColor=f.getTextColor=function(){return he(ui)};f.__private__.setTextColor=f.setTextColor=function(G,ke,We,at){return ui=Ht({ch1:G,ch2:ke,ch3:We,ch4:at,pdfColorType:"text",precision:3}),this};var wl=t.charSpace,Yo=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat(wl||0)};f.__private__.setCharSpace=f.setCharSpace=function(G){if(isNaN(G))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return wl=G,this};var Wo=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(G){var ke=f.CapJoinStyles[G];if(ke===void 0)throw new Error("Line cap style of '"+G+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Wo=ke,ce(ke+" J"),this};var sn=0;f.__private__.setLineJoin=f.setLineJoin=function(G){var ke=f.CapJoinStyles[G];if(ke===void 0)throw new Error("Line join style of '"+G+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return sn=ke,ce(ke+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(G){if(G=G||0,isNaN(G))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ce(R(te(G))+" M"),this},f.GState=sg,f.setGState=function(G){(G=typeof G=="string"?J[Je[G]]:xi(null,G)).equals(_t)||(ce("/"+G.id+" gs"),_t=G)};var xi=function(G,ke){if(!G||!Je[G]){var We=!1;for(var at in J)if(J.hasOwnProperty(at)&&J[at].equals(ke)){We=!0;break}if(We)ke=J[at];else{var ot="GS"+(Object.keys(J).length+1).toString(10);J[ot]=ke,ke.id=ot}return G&&(Je[G]=ke.id),Ze.publish("addGState",ke),ke}};f.addGState=function(G,ke){return xi(G,ke),this},f.saveGraphicsState=function(){return ce("q"),mt.push({key:Ne,size:we,color:ui}),this},f.restoreGraphicsState=function(){ce("Q");var G=mt.pop();return Ne=G.key,we=G.size,ui=G.color,_t=null,this},f.setCurrentTransformationMatrix=function(G){return ce(G.toString()+" cm"),this},f.comment=function(G){return ce("#"+G),this};var _l=function(G,ke){var We=G||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return We},set:function(Tt){isNaN(Tt)||(We=parseFloat(Tt))}});var at=ke||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return at},set:function(Tt){isNaN(Tt)||(at=parseFloat(Tt))}});var ot="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ot},set:function(Tt){ot=Tt.toString()}}),this},Pi=function(G,ke,We,at){_l.call(this,G,ke),this.type="rect";var ot=We||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ot},set:function(Gt){isNaN(Gt)||(ot=parseFloat(Gt))}});var Tt=at||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Tt},set:function(Gt){isNaN(Gt)||(Tt=parseFloat(Gt))}}),this},Xo=function(){this.page=$t,this.currentPage=ae,this.pages=Ge.slice(0),this.pagesContext=me.slice(0),this.x=Ce,this.y=ft,this.matrix=qe,this.width=zi(ae),this.height=Wd(ae),this.outputDestination=Xe,this.id="",this.objectNumber=-1};Xo.prototype.restore=function(){$t=this.page,ae=this.currentPage,me=this.pagesContext,Ge=this.pages,Ce=this.x,ft=this.y,qe=this.matrix,co(ae,this.width),Gi(ae,this.height),Xe=this.outputDestination};var io=function(G,ke,We,at,ot){lt.push(new Xo),$t=ae=0,Ge=[],Ce=G,ft=ke,qe=ot,es([We,at])};for(var Oi in f.beginFormObject=function(G,ke,We,at,ot){return io(G,ke,We,at,ot),this},f.endFormObject=function(G){return(function(ke){if(be[ke])lt.pop().restore();else{var We=new Xo,at="Xo"+(Object.keys(Yt).length+1).toString(10);We.id=at,be[ke]=at,Yt[at]=We,Ze.publish("addFormObject",We),lt.pop().restore()}})(G),this},f.doFormObject=function(G,ke){var We=Yt[be[G]];return ce("q"),ce(ke.toString()+" cm"),ce("/"+We.id+" Do"),ce("Q"),this},f.getFormObject=function(G){var ke=Yt[be[G]];return{x:ke.x,y:ke.y,width:ke.width,height:ke.height,matrix:ke.matrix}},f.save=function(G,ke){return G=G||"generated.pdf",(ke=ke||{}).returnPromise=ke.returnPromise||!1,ke.returnPromise===!1?(wm(mi(Nl()),G),typeof wm.unload=="function"&&Ps.setTimeout&&setTimeout(wm.unload,911),this):new Promise(function(We,at){try{var ot=wm(mi(Nl()),G);typeof wm.unload=="function"&&Ps.setTimeout&&setTimeout(wm.unload,911),We(ot)}catch(Tt){at(Tt.message)}})},ms.API)ms.API.hasOwnProperty(Oi)&&(Oi==="events"&&ms.API.events.length?(function(G,ke){var We,at,ot;for(ot=ke.length-1;ot!==-1;ot--)We=ke[ot][0],at=ke[ot][1],G.subscribe.apply(G,[We].concat(typeof at=="function"?[at]:at))})(Ze,ms.API.events):f[Oi]=ms.API[Oi]);function zi(G){return me[G].mediaBox.topRightX-me[G].mediaBox.bottomLeftX}function co(G,ke){me[G].mediaBox.topRightX=ke+me[G].mediaBox.bottomLeftX}function Wd(G){return me[G].mediaBox.topRightY-me[G].mediaBox.bottomLeftY}function Gi(G,ke){me[G].mediaBox.topRightY=ke+me[G].mediaBox.bottomLeftY}var qi=f.getPageWidth=function(G){return zi(G=G||ae)/et},Om=f.setPageWidth=function(G,ke){co(G,ke*et)},Ki=f.getPageHeight=function(G){return Wd(G=G||ae)/et},zm=f.setPageHeight=function(G,ke){Gi(G,ke*et)};return f.internal={pdfEscape:Ae,getStyle:so,getFont:Yl,getFontSize:ye,getCharSpace:Yo,getTextColor:Pm,getLineHeight:$m,getLineHeightFactor:Hm,getLineWidth:Sc,write:_e,getHorizontalCoordinate:xl,getVerticalCoordinate:An,getCoordinateString:Yd,getVerticalCoordinateString:no,collections:{},newObject:Te,newAdditionalObject:ls,newObjectDeferred:bt,newObjectDeferredBegin:Xt,getFilters:Zt,putStream:Ee,events:Ze,scaleFactor:et,pageSize:{getWidth:function(){return qi(ae)},setWidth:function(G){Om(ae,G)},getHeight:function(){return Ki(ae)},setHeight:function(G){zm(ae,G)}},encryptionOptions:A,encryption:Nr,getEncryptor:function(G){return A!==null?Nr.encryptor(G,0):function(ke){return ke}},output:to,getNumberOfPages:Kl,get pages(){return Ge},out:ce,f2:Q,f3:E,getPageInfo:ur,getPageInfoByObjId:_c,getCurrentPageInfo:Vo,getPDFVersion:v,Point:_l,Rectangle:Pi,Matrix:Ue,hasHotfix:pn},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return qi(ae)},set:function(G){Om(ae,G)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return Ki(ae)},set:function(G){zm(ae,G)},enumerable:!0,configurable:!0}),(function(G){for(var ke=0,We=Pe.length;ke<We;ke++){var at=dr.call(this,G[ke][0],G[ke][1],G[ke][2],Pe[ke][3],!0);g===!1&&(N[at]=!0);var ot=G[ke][0].split("-");rs({id:at,fontName:ot[0],fontStyle:ot[1]||""})}Ze.publish("addFonts",{fonts:W,dictionary:Ie})}).call(f,Pe),Ne="F1",ws(l,a),Ze.publish("initialized"),f}Lu.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},Lu.prototype.toHexString=function(t){return t.split("").map(function(s){return("0"+(255&s.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Lu.prototype.hexToBytes=function(t){for(var s=[],a=0;a<t.length;a+=2)s.push(String.fromCharCode(parseInt(t.substr(a,2),16)));return s.join("")},Lu.prototype.processOwnerPassword=function(t,s){return Cb(_b(s).substr(0,5),t)},Lu.prototype.encryptor=function(t,s){var a=_b(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&s,s>>8&255)).substr(0,10);return function(r){return Cb(a,r)}},sg.prototype.equals=function(t){var s,a="id,objectNumber,equals";if(!t||Ra(t)!==Ra(this))return!1;var r=0;for(s in this)if(!(a.indexOf(s)>=0)){if(this.hasOwnProperty(s)&&!t.hasOwnProperty(s)||this[s]!==t[s])return!1;r++}for(s in t)t.hasOwnProperty(s)&&a.indexOf(s)<0&&r--;return r===0},ms.API={events:[]},ms.version="3.0.4";var Mr=ms.API,ky=1,Im=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Su=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},qs=function(t){return t.toFixed(2)},Bd=function(t){return t.toFixed(5)};Mr.__acroform__={};var ql=function(t,s){t.prototype=Object.create(s.prototype),t.prototype.constructor=t},Pw=function(t){return t*ky},Kc=function(t){var s=new J4,a=bs.internal.getHeight(t)||0,r=bs.internal.getWidth(t)||0;return s.BBox=[0,0,Number(qs(r)),Number(qs(a))],s},VD=Mr.__acroform__.setBit=function(t,s){if(t=t||0,s=s||0,isNaN(t)||isNaN(s))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<s},YD=Mr.__acroform__.clearBit=function(t,s){if(t=t||0,s=s||0,isNaN(t)||isNaN(s))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<s)},WD=Mr.__acroform__.getBit=function(t,s){if(isNaN(t)||isNaN(s))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<s?1:0},Zr=Mr.__acroform__.getBitForPdf=function(t,s){if(isNaN(t)||isNaN(s))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return WD(t,s-1)},en=Mr.__acroform__.setBitForPdf=function(t,s){if(isNaN(t)||isNaN(s))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return VD(t,s-1)},tn=Mr.__acroform__.clearBitForPdf=function(t,s){if(isNaN(t)||isNaN(s))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return YD(t,s-1)},XD=Mr.__acroform__.calculateCoordinates=function(t,s){var a=s.internal.getHorizontalCoordinate,r=s.internal.getVerticalCoordinate,l=t[0],c=t[1],o=t[2],m=t[3],u={};return u.lowerLeft_X=a(l)||0,u.lowerLeft_Y=r(c+m)||0,u.upperRight_X=a(l+o)||0,u.upperRight_Y=r(c)||0,[Number(qs(u.lowerLeft_X)),Number(qs(u.lowerLeft_Y)),Number(qs(u.upperRight_X)),Number(qs(u.upperRight_Y))]},JD=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var s=[],a=t._V||t.DV,r=Sb(t,a),l=t.scope.internal.getFont(t.fontName,t.fontStyle).id;s.push("/Tx BMC"),s.push("q"),s.push("BT"),s.push(t.scope.__private__.encodeColorString(t.color)),s.push("/"+l+" "+qs(r.fontSize)+" Tf"),s.push("1 0 0 1 0 0 Tm"),s.push(r.text),s.push("ET"),s.push("Q"),s.push("EMC");var c=Kc(t);return c.scope=t.scope,c.stream=s.join(`
`),c}},Sb=function(t,s){var a=t.fontSize===0?t.maxFontSize:t.fontSize,r={text:"",fontSize:""},l=(s=(s=s.substr(0,1)=="("?s.substr(1):s).substr(s.length-1)==")"?s.substr(0,s.length-1):s).split(" ");l=t.multiline?l.map(function(Q){return Q.split(`
`)}):l.map(function(Q){return[Q]});var c=a,o=bs.internal.getHeight(t)||0;o=o<0?-o:o;var m=bs.internal.getWidth(t)||0;m=m<0?-m:m;var u=function(Q,E,te){if(Q+1<l.length){var C=E+" "+l[Q+1][0];return Wp(C,t,te).width<=m-4}return!1};c++;e:for(;c>0;){s="",c--;var x,A,g=Wp("3",t,c).height,N=t.multiline?o-c:(o-g)/2,f=N+=2,y=0,v=0,U=0;if(c<=0){s=`(...) Tj
`,s+="% Width of Text: "+Wp(s,t,c=12).width+", FieldWidth:"+m+`
`;break}for(var D="",M=0,K=0;K<l.length;K++)if(l.hasOwnProperty(K)){var $=!1;if(l[K].length!==1&&U!==l[K].length-1){if((g+2)*(M+2)+2>o)continue e;D+=l[K][U],$=!0,v=K,K--}else{D=(D+=l[K][U]+" ").substr(D.length-1)==" "?D.substr(0,D.length-1):D;var P=parseInt(K),se=u(P,D,c),z=K>=l.length-1;if(se&&!z){D+=" ",U=0;continue}if(se||z){if(z)v=P;else if(t.multiline&&(g+2)*(M+2)+2>o)continue e}else{if(!t.multiline||(g+2)*(M+2)+2>o)continue e;v=P}}for(var R="",j=y;j<=v;j++){var T=l[j];if(t.multiline){if(j===v){R+=T[U]+" ",U=(U+1)%T.length;continue}if(j===y){R+=T[T.length-1]+" ";continue}}R+=T[0]+" "}switch(R=R.substr(R.length-1)==" "?R.substr(0,R.length-1):R,A=Wp(R,t,c).width,t.textAlign){case"right":x=m-A-2;break;case"center":x=(m-A)/2;break;default:x=2}s+=qs(x)+" "+qs(f)+` Td
`,s+="("+Im(R)+`) Tj
`,s+=-qs(x)+` 0 Td
`,f=-(c+2),A=0,y=$?v:v+1,M++,D=""}break}return r.text=s,r.fontSize=c,r},Wp=function(t,s,a){var r=s.scope.internal.getFont(s.fontName,s.fontStyle),l=s.scope.getStringUnitWidth(t,{font:r,fontSize:parseFloat(a),charSpace:0})*parseFloat(a);return{height:s.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(a),charSpace:0})*parseFloat(a)*1.5,width:l}},ZD={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},eU=function(t,s){var a={type:"reference",object:t};s.internal.getPageInfo(t.page).pageContext.annotations.find(function(r){return r.type===a.type&&r.object===a.object})===void 0&&s.internal.getPageInfo(t.page).pageContext.annotations.push(a)},tU=function(t,s){if(s.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(vc.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(ZD)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");ky=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new Z4,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(a){a.internal.events.unsubscribe(a.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete a.internal.acroformPlugin.acroFormDictionaryRoot._eventID,a.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(a){a.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=a.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var l in r)if(r.hasOwnProperty(l)){var c=r[l];c.objId=void 0,c.hasAnnotation&&eU(c,a)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(a){if(a.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");a.internal.write("/AcroForm "+a.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(a){(function(r,l){var c=!r;for(var o in r||(l.internal.newObjectDeferredBegin(l.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),l.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||l.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(o)){var m=r[o],u=[],x=m.Rect;if(m.Rect&&(m.Rect=XD(m.Rect,l)),l.internal.newObjectDeferredBegin(m.objId,!0),m.DA=bs.createDefaultAppearanceStream(m),Ra(m)==="object"&&typeof m.getKeyValueListForStream=="function"&&(u=m.getKeyValueListForStream()),m.Rect=x,m.hasAppearanceStream&&!m.appearanceStreamContent){var A=JD(m);u.push({key:"AP",value:"<</N "+A+">>"}),l.internal.acroformPlugin.xForms.push(A)}if(m.appearanceStreamContent){var g="";for(var N in m.appearanceStreamContent)if(m.appearanceStreamContent.hasOwnProperty(N)){var f=m.appearanceStreamContent[N];if(g+="/"+N+" ",g+="<<",Object.keys(f).length>=1||Array.isArray(f)){for(var o in f)if(f.hasOwnProperty(o)){var y=f[o];typeof y=="function"&&(y=y.call(l,m)),g+="/"+o+" "+y+" ",l.internal.acroformPlugin.xForms.indexOf(y)>=0||l.internal.acroformPlugin.xForms.push(y)}}else typeof(y=f)=="function"&&(y=y.call(l,m)),g+="/"+o+" "+y,l.internal.acroformPlugin.xForms.indexOf(y)>=0||l.internal.acroformPlugin.xForms.push(y);g+=">>"}u.push({key:"AP",value:`<<
`+g+">>"})}l.internal.putStream({additionalKeyValues:u,objectId:m.objId}),l.internal.out("endobj")}c&&(function(v,U){for(var D in v)if(v.hasOwnProperty(D)){var M=D,K=v[D];U.internal.newObjectDeferredBegin(K.objId,!0),Ra(K)==="object"&&typeof K.putStream=="function"&&K.putStream(),delete v[M]}})(l.internal.acroformPlugin.xForms,l)})(a,t)}),t.internal.acroformPlugin.isInitialized=!0}},X4=Mr.__acroform__.arrayToPdfArray=function(t,s,a){var r=function(o){return o};if(Array.isArray(t)){for(var l="[",c=0;c<t.length;c++)switch(c!==0&&(l+=" "),Ra(t[c])){case"boolean":case"number":case"object":l+=t[c].toString();break;case"string":t[c].substr(0,1)!=="/"?(s!==void 0&&a&&(r=a.internal.getEncryptor(s)),l+="("+Im(r(t[c].toString()))+")"):l+=t[c].toString()}return l+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},wf=function(t,s,a){var r=function(l){return l};return s!==void 0&&a&&(r=a.internal.getEncryptor(s)),(t=t||"").toString(),"("+Im(r(t))+")"},Yc=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Yc.prototype.toString=function(){return this.objId+" 0 R"},Yc.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},Yc.prototype.getKeyValueListForStream=function(){var t=[],s=Object.getOwnPropertyNames(this).filter(function(c){return c!="content"&&c!="appearanceStreamContent"&&c!="scope"&&c!="objId"&&c.substring(0,1)!="_"});for(var a in s)if(Object.getOwnPropertyDescriptor(this,s[a]).configurable===!1){var r=s[a],l=this[r];l&&(Array.isArray(l)?t.push({key:r,value:X4(l,this.objId,this.scope)}):l instanceof Yc?(l.scope=this.scope,t.push({key:r,value:l.objId+" 0 R"})):typeof l!="function"&&t.push({key:r,value:l}))}return t};var J4=function(){Yc.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,s=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return s},set:function(a){s=a}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(a){t=a.trim()},get:function(){return t||null}})};ql(J4,Yc);var Z4=function(){Yc.call(this);var t,s=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return s.length>0?s:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return s}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var a=function(r){return r};return this.scope&&(a=this.scope.internal.getEncryptor(this.objId)),"("+Im(a(t))+")"}},set:function(a){t=a}})};ql(Z4,Yc);var vc=function t(){Yc.call(this);var s=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return s},set:function(D){if(isNaN(D))throw new Error('Invalid value "'+D+'" for attribute F supplied.');s=D}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Zr(s,3)},set:function(D){D?this.F=en(s,3):this.F=tn(s,3)}});var a=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return a},set:function(D){if(isNaN(D))throw new Error('Invalid value "'+D+'" for attribute Ff supplied.');a=D}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(D){r=D!==void 0?D:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(D){r[0]=D}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(D){r[1]=D}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(D){r[2]=D}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(D){r[3]=D}});var l="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return l},set:function(D){switch(D){case"/Btn":case"/Tx":case"/Ch":case"/Sig":l=D;break;default:throw new Error('Invalid value "'+D+'" for attribute FT supplied.')}}});var c=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!c||c.length<1){if(this instanceof ag)return;c="FieldObject"+t.FieldNum++}var D=function(M){return M};return this.scope&&(D=this.scope.internal.getEncryptor(this.objId)),"("+Im(D(c))+")"},set:function(D){c=D.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return c},set:function(D){c=D}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(D){o=D}});var m="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return m},set:function(D){m=D}});var u=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return u},set:function(D){u=D}});var x=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return x===void 0?50/ky:x},set:function(D){x=D}});var A="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return A},set:function(D){A=D}});var g="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!g||this instanceof ag||this instanceof Dm))return wf(g,this.objId,this.scope)},set:function(D){D=D.toString(),g=D}});var N=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(N)return this instanceof Un==0?wf(N,this.objId,this.scope):N},set:function(D){D=D.toString(),N=this instanceof Un==0?D.substr(0,1)==="("?Su(D.substr(1,D.length-2)):Su(D):D}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Un==1?Su(N.substr(1,N.length-1)):N},set:function(D){D=D.toString(),N=this instanceof Un==1?"/"+D:D}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(D){this.V=D}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof Un==0?wf(f,this.objId,this.scope):f},set:function(D){D=D.toString(),f=this instanceof Un==0?D.substr(0,1)==="("?Su(D.substr(1,D.length-2)):Su(D):D}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Un==1?Su(f.substr(1,f.length-1)):f},set:function(D){D=D.toString(),f=this instanceof Un==1?"/"+D:D}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var y,v=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return v},set:function(D){D=!!D,v=D}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(y)return y},set:function(D){y=D}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,1)},set:function(D){D?this.Ff=en(this.Ff,1):this.Ff=tn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,2)},set:function(D){D?this.Ff=en(this.Ff,2):this.Ff=tn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,3)},set:function(D){D?this.Ff=en(this.Ff,3):this.Ff=tn(this.Ff,3)}});var U=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(U!==null)return U},set:function(D){if([0,1,2].indexOf(D)===-1)throw new Error('Invalid value "'+D+'" for attribute Q supplied.');U=D}}),Object.defineProperty(this,"textAlign",{get:function(){var D;switch(U){case 0:default:D="left";break;case 1:D="center";break;case 2:D="right"}return D},configurable:!0,enumerable:!0,set:function(D){switch(D){case"right":case 2:U=2;break;case"center":case 1:U=1;break;default:U=0}}})};ql(vc,Yc);var Gu=function(){vc.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(a){t=a}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(a){t=a}});var s=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return X4(s,this.objId,this.scope)},set:function(a){var r,l;l=[],typeof(r=a)=="string"&&(l=(function(c,o,m){m||(m=1);for(var u,x=[];u=o.exec(c);)x.push(u[m]);return x})(r,/\((.*?)\)/g)),s=l}}),this.getOptions=function(){return s},this.setOptions=function(a){s=a,this.sort&&s.sort()},this.addOption=function(a){a=(a=a||"").toString(),s.push(a),this.sort&&s.sort()},this.removeOption=function(a,r){for(r=r||!1,a=(a=a||"").toString();s.indexOf(a)!==-1&&(s.splice(s.indexOf(a),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,18)},set:function(a){a?this.Ff=en(this.Ff,18):this.Ff=tn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,19)},set:function(a){this.combo===!0&&(a?this.Ff=en(this.Ff,19):this.Ff=tn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,20)},set:function(a){a?(this.Ff=en(this.Ff,20),s.sort()):this.Ff=tn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,22)},set:function(a){a?this.Ff=en(this.Ff,22):this.Ff=tn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,23)},set:function(a){a?this.Ff=en(this.Ff,23):this.Ff=tn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,27)},set:function(a){a?this.Ff=en(this.Ff,27):this.Ff=tn(this.Ff,27)}}),this.hasAppearanceStream=!1};ql(Gu,vc);var qu=function(){Gu.call(this),this.fontName="helvetica",this.combo=!1};ql(qu,Gu);var Ku=function(){qu.call(this),this.combo=!0};ql(Ku,qu);var HA=function(){Ku.call(this),this.edit=!0};ql(HA,Ku);var Un=function(){vc.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,15)},set:function(a){a?this.Ff=en(this.Ff,15):this.Ff=tn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,16)},set:function(a){a?this.Ff=en(this.Ff,16):this.Ff=tn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,17)},set:function(a){a?this.Ff=en(this.Ff,17):this.Ff=tn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,26)},set:function(a){a?this.Ff=en(this.Ff,26):this.Ff=tn(this.Ff,26)}});var t,s={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(c){return c};if(this.scope&&(a=this.scope.internal.getEncryptor(this.objId)),Object.keys(s).length!==0){var r,l=[];for(r in l.push("<<"),s)l.push("/"+r+" ("+Im(a(s[r]))+")");return l.push(">>"),l.join(`
`)}},set:function(a){Ra(a)==="object"&&(s=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return s.CA||""},set:function(a){typeof a=="string"&&(s.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(a){t=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(a){t="/"+a}})};ql(Un,vc);var PA=function(){Un.call(this),this.pushButton=!0};ql(PA,Un);var Vu=function(){Un.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(s){t=s!==void 0?s:[]}})};ql(Vu,Un);var ag=function(){var t,s;vc.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(l){t=l}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return s},set:function(l){s=l}});var a,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var l=function(m){return m};this.scope&&(l=this.scope.internal.getEncryptor(this.objId));var c,o=[];for(c in o.push("<<"),r)o.push("/"+c+" ("+Im(l(r[c]))+")");return o.push(">>"),o.join(`
`)},set:function(l){Ra(l)==="object"&&(r=l)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(l){typeof l=="string"&&(r.CA=l)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return a},set:function(l){a=l}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return a.substr(1,a.length-1)},set:function(l){a="/"+l}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=bs.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ql(ag,vc),Vu.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var s in this.Kids)if(this.Kids.hasOwnProperty(s)){var a=this.Kids[s];a.appearanceStreamContent=t.createAppearanceStream(a.optionName),a.caption=t.getCA()}},Vu.prototype.createOption=function(t){var s=new ag;return s.Parent=this,s.optionName=t,this.Kids.push(s),sU.call(this.scope,s),s};var OA=function(){Un.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=bs.CheckBox.createAppearanceStream()};ql(OA,Un);var Dm=function(){vc.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,13)},set:function(s){s?this.Ff=en(this.Ff,13):this.Ff=tn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,21)},set:function(s){s?this.Ff=en(this.Ff,21):this.Ff=tn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,23)},set:function(s){s?this.Ff=en(this.Ff,23):this.Ff=tn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,24)},set:function(s){s?this.Ff=en(this.Ff,24):this.Ff=tn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,25)},set:function(s){s?this.Ff=en(this.Ff,25):this.Ff=tn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,26)},set:function(s){s?this.Ff=en(this.Ff,26):this.Ff=tn(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(s){t=s}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(s){Number.isInteger(s)&&(t=s)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ql(Dm,vc);var zA=function(){Dm.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,14)},set:function(t){t?this.Ff=en(this.Ff,14):this.Ff=tn(this.Ff,14)}}),this.password=!0};ql(zA,Dm);var bs={CheckBox:{createAppearanceStream:function(){return{N:{On:bs.CheckBox.YesNormal},D:{On:bs.CheckBox.YesPushDown,Off:bs.CheckBox.OffPushDown}}},YesPushDown:function(t){var s=Kc(t);s.scope=t.scope;var a=[],r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,l=t.scope.__private__.encodeColorString(t.color),c=Sb(t,t.caption);return a.push("0.749023 g"),a.push("0 0 "+qs(bs.internal.getWidth(t))+" "+qs(bs.internal.getHeight(t))+" re"),a.push("f"),a.push("BMC"),a.push("q"),a.push("0 0 1 rg"),a.push("/"+r+" "+qs(c.fontSize)+" Tf "+l),a.push("BT"),a.push(c.text),a.push("ET"),a.push("Q"),a.push("EMC"),s.stream=a.join(`
`),s},YesNormal:function(t){var s=Kc(t);s.scope=t.scope;var a=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color),l=[],c=bs.internal.getHeight(t),o=bs.internal.getWidth(t),m=Sb(t,t.caption);return l.push("1 g"),l.push("0 0 "+qs(o)+" "+qs(c)+" re"),l.push("f"),l.push("q"),l.push("0 0 1 rg"),l.push("0 0 "+qs(o-1)+" "+qs(c-1)+" re"),l.push("W"),l.push("n"),l.push("0 g"),l.push("BT"),l.push("/"+a+" "+qs(m.fontSize)+" Tf "+r),l.push(m.text),l.push("ET"),l.push("Q"),s.stream=l.join(`
`),s},OffPushDown:function(t){var s=Kc(t);s.scope=t.scope;var a=[];return a.push("0.749023 g"),a.push("0 0 "+qs(bs.internal.getWidth(t))+" "+qs(bs.internal.getHeight(t))+" re"),a.push("f"),s.stream=a.join(`
`),s}},RadioButton:{Circle:{createAppearanceStream:function(t){var s={D:{Off:bs.RadioButton.Circle.OffPushDown},N:{}};return s.N[t]=bs.RadioButton.Circle.YesNormal,s.D[t]=bs.RadioButton.Circle.YesPushDown,s},getCA:function(){return"l"},YesNormal:function(t){var s=Kc(t);s.scope=t.scope;var a=[],r=bs.internal.getWidth(t)<=bs.internal.getHeight(t)?bs.internal.getWidth(t)/4:bs.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var l=bs.internal.Bezier_C,c=Number((r*l).toFixed(5));return a.push("q"),a.push("1 0 0 1 "+Bd(bs.internal.getWidth(t)/2)+" "+Bd(bs.internal.getHeight(t)/2)+" cm"),a.push(r+" 0 m"),a.push(r+" "+c+" "+c+" "+r+" 0 "+r+" c"),a.push("-"+c+" "+r+" -"+r+" "+c+" -"+r+" 0 c"),a.push("-"+r+" -"+c+" -"+c+" -"+r+" 0 -"+r+" c"),a.push(c+" -"+r+" "+r+" -"+c+" "+r+" 0 c"),a.push("f"),a.push("Q"),s.stream=a.join(`
`),s},YesPushDown:function(t){var s=Kc(t);s.scope=t.scope;var a=[],r=bs.internal.getWidth(t)<=bs.internal.getHeight(t)?bs.internal.getWidth(t)/4:bs.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var l=Number((2*r).toFixed(5)),c=Number((l*bs.internal.Bezier_C).toFixed(5)),o=Number((r*bs.internal.Bezier_C).toFixed(5));return a.push("0.749023 g"),a.push("q"),a.push("1 0 0 1 "+Bd(bs.internal.getWidth(t)/2)+" "+Bd(bs.internal.getHeight(t)/2)+" cm"),a.push(l+" 0 m"),a.push(l+" "+c+" "+c+" "+l+" 0 "+l+" c"),a.push("-"+c+" "+l+" -"+l+" "+c+" -"+l+" 0 c"),a.push("-"+l+" -"+c+" -"+c+" -"+l+" 0 -"+l+" c"),a.push(c+" -"+l+" "+l+" -"+c+" "+l+" 0 c"),a.push("f"),a.push("Q"),a.push("0 g"),a.push("q"),a.push("1 0 0 1 "+Bd(bs.internal.getWidth(t)/2)+" "+Bd(bs.internal.getHeight(t)/2)+" cm"),a.push(r+" 0 m"),a.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),a.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),a.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),a.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),a.push("f"),a.push("Q"),s.stream=a.join(`
`),s},OffPushDown:function(t){var s=Kc(t);s.scope=t.scope;var a=[],r=bs.internal.getWidth(t)<=bs.internal.getHeight(t)?bs.internal.getWidth(t)/4:bs.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var l=Number((2*r).toFixed(5)),c=Number((l*bs.internal.Bezier_C).toFixed(5));return a.push("0.749023 g"),a.push("q"),a.push("1 0 0 1 "+Bd(bs.internal.getWidth(t)/2)+" "+Bd(bs.internal.getHeight(t)/2)+" cm"),a.push(l+" 0 m"),a.push(l+" "+c+" "+c+" "+l+" 0 "+l+" c"),a.push("-"+c+" "+l+" -"+l+" "+c+" -"+l+" 0 c"),a.push("-"+l+" -"+c+" -"+c+" -"+l+" 0 -"+l+" c"),a.push(c+" -"+l+" "+l+" -"+c+" "+l+" 0 c"),a.push("f"),a.push("Q"),s.stream=a.join(`
`),s}},Cross:{createAppearanceStream:function(t){var s={D:{Off:bs.RadioButton.Cross.OffPushDown},N:{}};return s.N[t]=bs.RadioButton.Cross.YesNormal,s.D[t]=bs.RadioButton.Cross.YesPushDown,s},getCA:function(){return"8"},YesNormal:function(t){var s=Kc(t);s.scope=t.scope;var a=[],r=bs.internal.calculateCross(t);return a.push("q"),a.push("1 1 "+qs(bs.internal.getWidth(t)-2)+" "+qs(bs.internal.getHeight(t)-2)+" re"),a.push("W"),a.push("n"),a.push(qs(r.x1.x)+" "+qs(r.x1.y)+" m"),a.push(qs(r.x2.x)+" "+qs(r.x2.y)+" l"),a.push(qs(r.x4.x)+" "+qs(r.x4.y)+" m"),a.push(qs(r.x3.x)+" "+qs(r.x3.y)+" l"),a.push("s"),a.push("Q"),s.stream=a.join(`
`),s},YesPushDown:function(t){var s=Kc(t);s.scope=t.scope;var a=bs.internal.calculateCross(t),r=[];return r.push("0.749023 g"),r.push("0 0 "+qs(bs.internal.getWidth(t))+" "+qs(bs.internal.getHeight(t))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+qs(bs.internal.getWidth(t)-2)+" "+qs(bs.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(qs(a.x1.x)+" "+qs(a.x1.y)+" m"),r.push(qs(a.x2.x)+" "+qs(a.x2.y)+" l"),r.push(qs(a.x4.x)+" "+qs(a.x4.y)+" m"),r.push(qs(a.x3.x)+" "+qs(a.x3.y)+" l"),r.push("s"),r.push("Q"),s.stream=r.join(`
`),s},OffPushDown:function(t){var s=Kc(t);s.scope=t.scope;var a=[];return a.push("0.749023 g"),a.push("0 0 "+qs(bs.internal.getWidth(t))+" "+qs(bs.internal.getHeight(t))+" re"),a.push("f"),s.stream=a.join(`
`),s}}},createDefaultAppearanceStream:function(t){var s=t.scope.internal.getFont(t.fontName,t.fontStyle).id,a=t.scope.__private__.encodeColorString(t.color);return"/"+s+" "+t.fontSize+" Tf "+a}};bs.internal={Bezier_C:.551915024494,calculateCross:function(t){var s=bs.internal.getWidth(t),a=bs.internal.getHeight(t),r=Math.min(s,a);return{x1:{x:(s-r)/2,y:(a-r)/2+r},x2:{x:(s-r)/2+r,y:(a-r)/2},x3:{x:(s-r)/2,y:(a-r)/2},x4:{x:(s-r)/2+r,y:(a-r)/2+r}}}},bs.internal.getWidth=function(t){var s=0;return Ra(t)==="object"&&(s=Pw(t.Rect[2])),s},bs.internal.getHeight=function(t){var s=0;return Ra(t)==="object"&&(s=Pw(t.Rect[3])),s};var sU=Mr.addField=function(t){if(tU(this,t),!(t instanceof vc))throw new Error("Invalid argument passed to jsPDF.addField.");var s;return(s=t).scope.internal.acroformPlugin.printedOut&&(s.scope.internal.acroformPlugin.printedOut=!1,s.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),s.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(s),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Mr.AcroFormChoiceField=Gu,Mr.AcroFormListBox=qu,Mr.AcroFormComboBox=Ku,Mr.AcroFormEditBox=HA,Mr.AcroFormButton=Un,Mr.AcroFormPushButton=PA,Mr.AcroFormRadioButton=Vu,Mr.AcroFormCheckBox=OA,Mr.AcroFormTextField=Dm,Mr.AcroFormPasswordField=zA,Mr.AcroFormAppearance=bs,Mr.AcroForm={ChoiceField:Gu,ListBox:qu,ComboBox:Ku,EditBox:HA,Button:Un,PushButton:PA,RadioButton:Vu,CheckBox:OA,TextField:Dm,PasswordField:zA,Appearance:bs},ms.AcroForm={ChoiceField:Gu,ListBox:qu,ComboBox:Ku,EditBox:HA,Button:Un,PushButton:PA,RadioButton:Vu,CheckBox:OA,TextField:Dm,PasswordField:zA,Appearance:bs};ms.AcroForm;function e5(t){return t.reduce(function(s,a,r){return s[a]=r,s},{})}(function(t){var s="addImage_";t.__addimage__={};var a="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},l=t.__addimage__.getImageFileTypeByImageData=function(Q,E){var te,C,O,V,re,ge=a;if((E=E||a)==="RGBA"||Q.data!==void 0&&Q.data instanceof Uint8ClampedArray&&"height"in Q&&"width"in Q)return"RGBA";if(se(Q))for(re in r)for(O=r[re],te=0;te<O.length;te+=1){for(V=!0,C=0;C<O[te].length;C+=1)if(O[te][C]!==void 0&&O[te][C]!==Q[C]){V=!1;break}if(V===!0){ge=re;break}}else for(re in r)for(O=r[re],te=0;te<O.length;te+=1){for(V=!0,C=0;C<O[te].length;C+=1)if(O[te][C]!==void 0&&O[te][C]!==Q.charCodeAt(C)){V=!1;break}if(V===!0){ge=re;break}}return ge===a&&E!==a&&(ge=E),ge},c=function Q(E){for(var te=this.internal.write,C=this.internal.putStream,O=(0,this.internal.getFilters)();O.indexOf("FlateEncode")!==-1;)O.splice(O.indexOf("FlateEncode"),1);E.objectId=this.internal.newObject();var V=[];if(V.push({key:"Type",value:"/XObject"}),V.push({key:"Subtype",value:"/Image"}),V.push({key:"Width",value:E.width}),V.push({key:"Height",value:E.height}),E.colorSpace===D.INDEXED?V.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(E.palette.length/3-1)+" "+("sMask"in E&&E.sMask!==void 0?E.objectId+2:E.objectId+1)+" 0 R]"}):(V.push({key:"ColorSpace",value:"/"+E.colorSpace}),E.colorSpace===D.DEVICE_CMYK&&V.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),V.push({key:"BitsPerComponent",value:E.bitsPerComponent}),"decodeParameters"in E&&E.decodeParameters!==void 0&&V.push({key:"DecodeParms",value:"<<"+E.decodeParameters+">>"}),"transparency"in E&&Array.isArray(E.transparency)&&E.transparency.length>0){for(var re="",ge=0,xe=E.transparency.length;ge<xe;ge++)re+=E.transparency[ge]+" "+E.transparency[ge]+" ";V.push({key:"Mask",value:"["+re+"]"})}E.sMask!==void 0&&V.push({key:"SMask",value:E.objectId+1+" 0 R"});var Z=E.filter!==void 0?["/"+E.filter]:void 0;if(C({data:E.data,additionalKeyValues:V,alreadyAppliedFilters:Z,objectId:E.objectId}),te("endobj"),"sMask"in E&&E.sMask!==void 0){var I,H=(I=E.sMaskBitsPerComponent)!==null&&I!==void 0?I:E.bitsPerComponent,ae={width:E.width,height:E.height,colorSpace:"DeviceGray",bitsPerComponent:H,data:E.sMask};"filter"in E&&(ae.decodeParameters="/Predictor ".concat(E.predictor," /Colors 1 /BitsPerComponent ").concat(H," /Columns ").concat(E.width),ae.filter=E.filter),Q.call(this,ae)}if(E.colorSpace===D.INDEXED){var k=this.internal.newObject();C({data:R(new Uint8Array(E.palette)),objectId:k}),te("endobj")}},o=function(){var Q=this.internal.collections[s+"images"];for(var E in Q)c.call(this,Q[E])},m=function(){var Q,E=this.internal.collections[s+"images"],te=this.internal.write;for(var C in E)te("/I"+(Q=E[C]).index,Q.objectId,"0","R")},u=function(){this.internal.collections[s+"images"]||(this.internal.collections[s+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",m))},x=function(){var Q=this.internal.collections[s+"images"];return u.call(this),Q},A=function(){return Object.keys(this.internal.collections[s+"images"]).length},g=function(Q){return typeof t["process"+Q.toUpperCase()]=="function"},N=function(Q){return Ra(Q)==="object"&&Q.nodeType===1},f=function(Q,E){if(Q.nodeName==="IMG"&&Q.hasAttribute("src")){var te=""+Q.getAttribute("src");if(te.indexOf("data:image/")===0)return $A(unescape(te).split("base64,").pop());var C=t.loadFile(te,!0);if(C!==void 0)return C}if(Q.nodeName==="CANVAS"){if(Q.width===0||Q.height===0)throw new Error("Given canvas must have data. Canvas width: "+Q.width+", height: "+Q.height);var O;switch(E){case"PNG":O="image/png";break;case"WEBP":O="image/webp";break;default:O="image/jpeg"}return $A(Q.toDataURL(O,1).split("base64,").pop())}},y=function(Q){var E=this.internal.collections[s+"images"];if(E){for(var te in E)if(Q===E[te].alias)return E[te]}},v=function(Q,E,te){return Q||E||(Q=-96,E=-96),Q<0&&(Q=-1*te.width*72/Q/this.internal.scaleFactor),E<0&&(E=-1*te.height*72/E/this.internal.scaleFactor),Q===0&&(Q=E*te.width/te.height),E===0&&(E=Q*te.height/te.width),[Q,E]},U=function(Q,E,te,C,O,V){var re=v.call(this,te,C,O),ge=this.internal.getCoordinateString,xe=this.internal.getVerticalCoordinateString,Z=x.call(this);if(te=re[0],C=re[1],Z[O.index]=O,V){V*=Math.PI/180;var I=Math.cos(V),H=Math.sin(V),ae=function(B){return B.toFixed(4)},k=[ae(I),ae(H),ae(-1*H),ae(I),0,0,"cm"]}this.internal.write("q"),V?(this.internal.write([1,"0","0",1,ge(Q),xe(E+C),"cm"].join(" ")),this.internal.write(k.join(" ")),this.internal.write([ge(te),"0","0",ge(C),"0","0","cm"].join(" "))):this.internal.write([ge(te),"0","0",ge(C),ge(Q),xe(E+C),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+O.index+" Do"),this.internal.write("Q")},D=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var M=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},K=t.__addimage__.sHashCode=function(Q){var E,te,C=0;if(typeof Q=="string")for(te=Q.length,E=0;E<te;E++)C=(C<<5)-C+Q.charCodeAt(E),C|=0;else if(se(Q))for(te=Q.byteLength/2,E=0;E<te;E++)C=(C<<5)-C+Q[E],C|=0;return C},$=t.__addimage__.validateStringAsBase64=function(Q){(Q=Q||"").toString().trim();var E=!0;return Q.length===0&&(E=!1),Q.length%4!=0&&(E=!1),/^[A-Za-z0-9+/]+$/.test(Q.substr(0,Q.length-2))===!1&&(E=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(Q.substr(-2))===!1&&(E=!1),E},P=t.__addimage__.extractImageFromDataUrl=function(Q){if(Q==null||!(Q=Q.trim()).startsWith("data:"))return null;var E=Q.indexOf(",");return E<0?null:Q.substring(0,E).trim().endsWith("base64")?Q.substring(E+1):null};t.__addimage__.isArrayBuffer=function(Q){return Q instanceof ArrayBuffer};var se=t.__addimage__.isArrayBufferView=function(Q){return Q instanceof Int8Array||Q instanceof Uint8Array||Q instanceof Uint8ClampedArray||Q instanceof Int16Array||Q instanceof Uint16Array||Q instanceof Int32Array||Q instanceof Uint32Array||Q instanceof Float32Array||Q instanceof Float64Array},z=t.__addimage__.binaryStringToUint8Array=function(Q){for(var E=Q.length,te=new Uint8Array(E),C=0;C<E;C++)te[C]=Q.charCodeAt(C);return te},R=t.__addimage__.arrayBufferToBinaryString=function(Q){for(var E="",te=se(Q)?Q:new Uint8Array(Q),C=0;C<te.length;C+=8192)E+=String.fromCharCode.apply(null,te.subarray(C,C+8192));return E};t.addImage=function(){var Q,E,te,C,O,V,re,ge,xe;if(typeof arguments[1]=="number"?(E=a,te=arguments[1],C=arguments[2],O=arguments[3],V=arguments[4],re=arguments[5],ge=arguments[6],xe=arguments[7]):(E=arguments[1],te=arguments[2],C=arguments[3],O=arguments[4],V=arguments[5],re=arguments[6],ge=arguments[7],xe=arguments[8]),Ra(Q=arguments[0])==="object"&&!N(Q)&&"imageData"in Q){var Z=Q;Q=Z.imageData,E=Z.format||E||a,te=Z.x||te||0,C=Z.y||C||0,O=Z.w||Z.width||O,V=Z.h||Z.height||V,re=Z.alias||re,ge=Z.compression||ge,xe=Z.rotation||Z.angle||xe}var I=this.internal.getFilters();if(ge===void 0&&I.indexOf("FlateEncode")!==-1&&(ge="SLOW"),isNaN(te)||isNaN(C))throw new Error("Invalid coordinates passed to jsPDF.addImage");u.call(this);var H=j.call(this,Q,E,re,ge);return U.call(this,te,C,O,V,H,xe),this};var j=function(Q,E,te,C){var O,V,re;if(typeof Q=="string"&&l(Q)===a){Q=unescape(Q);var ge=T(Q,!1);(ge!==""||(ge=t.loadFile(Q,!0))!==void 0)&&(Q=ge)}if(N(Q)&&(Q=f(Q,E)),E=l(Q,E),!g(E))throw new Error("addImage does not support files of type '"+E+"', please ensure that a plugin for '"+E+"' support is added.");if(((re=te)==null||re.length===0)&&(te=(function(xe){return typeof xe=="string"||se(xe)?K(xe):se(xe.data)?K(xe.data):null})(Q)),(O=y.call(this,te))||(Q instanceof Uint8Array||E==="RGBA"||(V=Q,Q=z(Q)),O=this["process"+E.toUpperCase()](Q,A.call(this),te,(function(xe){return xe&&typeof xe=="string"&&(xe=xe.toUpperCase()),xe in t.image_compression?xe:M.NONE})(C),V)),!O)throw new Error("An unknown error occurred whilst processing the image.");return O},T=t.__addimage__.convertBase64ToBinaryString=function(Q,E){E=typeof E!="boolean"||E;var te,C="";if(typeof Q=="string"){var O;te=(O=P(Q))!==null&&O!==void 0?O:Q;try{C=$A(te)}catch(V){if(E)throw $(te)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+V.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return C};t.getImageProperties=function(Q){var E,te,C="";if(N(Q)&&(Q=f(Q)),typeof Q=="string"&&l(Q)===a&&((C=T(Q,!1))===""&&(C=t.loadFile(Q)||""),Q=C),te=l(Q),!g(te))throw new Error("addImage does not support files of type '"+te+"', please ensure that a plugin for '"+te+"' support is added.");if(Q instanceof Uint8Array||(Q=z(Q)),!(E=this["process"+te.toUpperCase()](Q)))throw new Error("An unknown error occurred whilst processing the image");return E.fileType=te,E}})(ms.API),(function(t){var s=function(a){if(a!==void 0&&a!="")return!0};ms.API.events.push(["addPage",function(a){this.internal.getPageInfo(a.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(a){for(var r,l,c,o=this.internal.getCoordinateString,m=this.internal.getVerticalCoordinateString,u=this.internal.getPageInfoByObjId(a.objId),x=a.pageContext.annotations,A=!1,g=0;g<x.length&&!A;g++)switch((r=x[g]).type){case"link":(s(r.options.url)||s(r.options.pageNumber))&&(A=!0);break;case"reference":case"text":case"freetext":A=!0}if(A!=0){this.internal.write("/Annots [");for(var N=0;N<x.length;N++){r=x[N];var f=this.internal.pdfEscape,y=this.internal.getEncryptor(a.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var v=this.internal.newAdditionalObject(),U=this.internal.newAdditionalObject(),D=this.internal.getEncryptor(v.objId),M=r.title||"Note";c="<</Type /Annot /Subtype /Text "+(l="/Rect ["+o(r.bounds.x)+" "+m(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w)+" "+m(r.bounds.y)+"] ")+"/Contents ("+f(D(r.contents))+")",c+=" /Popup "+U.objId+" 0 R",c+=" /P "+u.objId+" 0 R",c+=" /T ("+f(D(M))+") >>",v.content=c;var K=v.objId+" 0 R";c="<</Type /Annot /Subtype /Popup "+(l="/Rect ["+o(r.bounds.x+30)+" "+m(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w+30)+" "+m(r.bounds.y)+"] ")+" /Parent "+K,r.open&&(c+=" /Open true"),c+=" >>",U.content=c,this.internal.write(v.objId,"0 R",U.objId,"0 R");break;case"freetext":l="/Rect ["+o(r.bounds.x)+" "+m(r.bounds.y)+" "+o(r.bounds.x+r.bounds.w)+" "+m(r.bounds.y+r.bounds.h)+"] ";var $=r.color||"#000000";c="<</Type /Annot /Subtype /FreeText "+l+"/Contents ("+f(y(r.contents))+")",c+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+$+")",c+=" /Border [0 0 0]",c+=" >>",this.internal.write(c);break;case"link":if(r.options.name){var P=this.annotations._nameMap[r.options.name];r.options.pageNumber=P.page,r.options.top=P.y}else r.options.top||(r.options.top=0);if(l="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",c="",r.options.url)c="<</Type /Annot /Subtype /Link "+l+"/Border [0 0 0] /A <</S /URI /URI ("+f(y(r.options.url))+") >>";else if(r.options.pageNumber)switch(c="<</Type /Annot /Subtype /Link "+l+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":c+=" /Fit]";break;case"FitH":c+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,c+=" /FitV "+r.options.left+"]";break;default:var se=m(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),c+=" /XYZ "+r.options.left+" "+se+" "+r.options.zoom+"]"}c!=""&&(c+=" >>",this.internal.write(c))}}this.internal.write("]")}}]),t.createAnnotation=function(a){var r=this.internal.getCurrentPageInfo();switch(a.type){case"link":this.link(a.bounds.x,a.bounds.y,a.bounds.w,a.bounds.h,a);break;case"text":case"freetext":r.pageContext.annotations.push(a)}},t.link=function(a,r,l,c,o){var m=this.internal.getCurrentPageInfo(),u=this.internal.getCoordinateString,x=this.internal.getVerticalCoordinateString;m.pageContext.annotations.push({finalBounds:{x:u(a),y:x(r),w:u(a+l),h:x(r+c)},options:o,type:"link"})},t.textWithLink=function(a,r,l,c){var o,m,u=this.getTextWidth(a),x=this.internal.getLineHeight()/this.internal.scaleFactor;if(c.maxWidth!==void 0){m=c.maxWidth;var A=this.splitTextToSize(a,m).length;o=Math.ceil(x*A)}else m=u,o=x;return this.text(a,r,l,c),l+=.2*x,c.align==="center"&&(r-=u/2),c.align==="right"&&(r-=u),this.link(r,l-x,m,o,c),u},t.getTextWidth=function(a){var r=this.internal.getFontSize();return this.getStringUnitWidth(a)*r/this.internal.scaleFactor}})(ms.API),(function(t){var s={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},a={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},l=[1570,1571,1573,1575];t.__arabicParser__={};var c=t.__arabicParser__.isInArabicSubstitutionA=function(v){return s[v.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(v){return typeof v=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(v)},m=t.__arabicParser__.isArabicEndLetter=function(v){return o(v)&&c(v)&&s[v.charCodeAt(0)].length<=2},u=t.__arabicParser__.isArabicAlfLetter=function(v){return o(v)&&l.indexOf(v.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(v){return o(v)&&c(v)&&s[v.charCodeAt(0)].length>=1};var x=t.__arabicParser__.arabicLetterHasFinalForm=function(v){return o(v)&&c(v)&&s[v.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(v){return o(v)&&c(v)&&s[v.charCodeAt(0)].length>=3};var A=t.__arabicParser__.arabicLetterHasMedialForm=function(v){return o(v)&&c(v)&&s[v.charCodeAt(0)].length==4},g=t.__arabicParser__.resolveLigatures=function(v){var U=0,D=a,M="",K=0;for(U=0;U<v.length;U+=1)D[v.charCodeAt(U)]!==void 0?(K++,typeof(D=D[v.charCodeAt(U)])=="number"&&(M+=String.fromCharCode(D),D=a,K=0),U===v.length-1&&(D=a,M+=v.charAt(U-(K-1)),U-=K-1,K=0)):(D=a,M+=v.charAt(U-K),U-=K,K=0);return M};t.__arabicParser__.isArabicDiacritic=function(v){return v!==void 0&&r[v.charCodeAt(0)]!==void 0};var N=t.__arabicParser__.getCorrectForm=function(v,U,D){return o(v)?c(v)===!1?-1:!x(v)||!o(U)&&!o(D)||!o(D)&&m(U)||m(v)&&!o(U)||m(v)&&u(U)||m(v)&&m(U)?0:A(v)&&o(U)&&!m(U)&&o(D)&&x(D)?3:m(v)||!o(D)?1:2:-1},f=function(v){var U=0,D=0,M=0,K="",$="",P="",se=(v=v||"").split("\\s+"),z=[];for(U=0;U<se.length;U+=1){for(z.push(""),D=0;D<se[U].length;D+=1)K=se[U][D],$=se[U][D-1],P=se[U][D+1],o(K)?(M=N(K,$,P),z[U]+=M!==-1?String.fromCharCode(s[K.charCodeAt(0)][M]):K):z[U]+=K;z[U]=g(z[U])}return z.join(" ")},y=t.__arabicParser__.processArabic=t.processArabic=function(){var v,U=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,D=[];if(Array.isArray(U)){var M=0;for(D=[],M=0;M<U.length;M+=1)Array.isArray(U[M])?D.push([f(U[M][0]),U[M][1],U[M][2]]):D.push([f(U[M])]);v=D}else v=f(U);return typeof arguments[0]=="string"?v:(arguments[0].text=v,arguments[0])};t.events.push(["preProcessText",y])})(ms.API),ms.API.autoPrint=function(t){var s;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){s=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+s+" 0 R")})),this},(function(t){var s=function(){var a=void 0;Object.defineProperty(this,"pdf",{get:function(){return a},set:function(m){a=m}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(m){r=isNaN(m)||Number.isInteger(m)===!1||m<0?150:m,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var l=300;Object.defineProperty(this,"height",{get:function(){return l},set:function(m){l=isNaN(m)||Number.isInteger(m)===!1||m<0?300:m,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=l+1)}});var c=[];Object.defineProperty(this,"childNodes",{get:function(){return c},set:function(m){c=m}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(m){o=m}}),Object.defineProperty(this,"parentNode",{})};s.prototype.getContext=function(a,r){var l;if((a=a||"2d")!=="2d")return null;for(l in r)this.pdf.context2d.hasOwnProperty(l)&&(this.pdf.context2d[l]=r[l]);return this.pdf.context2d._canvas=this,this.pdf.context2d},s.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new s,this.canvas.pdf=this}])})(ms.API),(function(t){var s={left:0,top:0,bottom:0,right:0},a=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},s),this.internal.__cell__.margins.width=this.getPageWidth(),l.call(this))},l=function(){this.internal.__cell__.lastCell=new c,this.internal.__cell__.pages=1},c=function(){var u=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return u},set:function(v){u=v}});var x=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return x},set:function(v){x=v}});var A=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return A},set:function(v){A=v}});var g=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return g},set:function(v){g=v}});var N=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return N},set:function(v){N=v}});var f=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return f},set:function(v){f=v}});var y=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return y},set:function(v){y=v}}),this};c.prototype.clone=function(){return new c(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},c.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(u){return r.call(this),this.internal.__cell__.headerFunction=typeof u=="function"?u:void 0,this},t.getTextDimensions=function(u,x){r.call(this);var A=(x=x||{}).fontSize||this.getFontSize(),g=x.font||this.getFont(),N=x.scaleFactor||this.internal.scaleFactor,f=0,y=0,v=0,U=this;if(!Array.isArray(u)&&typeof u!="string"){if(typeof u!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");u=String(u)}var D=x.maxWidth;D>0?typeof u=="string"?u=this.splitTextToSize(u,D):Object.prototype.toString.call(u)==="[object Array]"&&(u=u.reduce(function(K,$){return K.concat(U.splitTextToSize($,D))},[])):u=Array.isArray(u)?u:[u];for(var M=0;M<u.length;M++)f<(v=this.getStringUnitWidth(u[M],{font:g})*A)&&(f=v);return f!==0&&(y=u.length),{w:f/=N,h:Math.max((y*A*this.getLineHeightFactor()-A*(this.getLineHeightFactor()-1))/N,0)}},t.cellAddPage=function(){r.call(this),this.addPage();var u=this.internal.__cell__.margins||s;return this.internal.__cell__.lastCell=new c(u.left,u.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var u;u=arguments[0]instanceof c?arguments[0]:new c(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),r.call(this);var x=this.internal.__cell__.lastCell,A=this.internal.__cell__.padding,g=this.internal.__cell__.margins||s,N=this.internal.__cell__.tableHeaderRow,f=this.internal.__cell__.printHeaders;return x.lineNumber!==void 0&&(x.lineNumber===u.lineNumber?(u.x=(x.x||0)+(x.width||0),u.y=x.y||0):x.y+x.height+u.height+g.bottom>this.getPageHeight()?(this.cellAddPage(),u.y=g.top,f&&N&&(this.printHeaderRow(u.lineNumber,!0),u.y+=N[0].height)):u.y=x.y+x.height||u.y),u.text[0]!==void 0&&(this.rect(u.x,u.y,u.width,u.height,a===!0?"FD":void 0),u.align==="right"?this.text(u.text,u.x+u.width-A,u.y+A,{align:"right",baseline:"top"}):u.align==="center"?this.text(u.text,u.x+u.width/2,u.y+A,{align:"center",baseline:"top",maxWidth:u.width-A-A}):this.text(u.text,u.x+A,u.y+A,{align:"left",baseline:"top",maxWidth:u.width-A-A})),this.internal.__cell__.lastCell=u,this};t.table=function(u,x,A,g,N){if(r.call(this),!A)throw new Error("No data for PDF table.");var f,y,v,U,D=[],M=[],K=[],$={},P={},se=[],z=[],R=(N=N||{}).autoSize||!1,j=N.printHeaders!==!1,T=N.css&&N.css["font-size"]!==void 0?16*N.css["font-size"]:N.fontSize||12,Q=N.margins||Object.assign({width:this.getPageWidth()},s),E=typeof N.padding=="number"?N.padding:3,te=N.headerBackgroundColor||"#c8c8c8",C=N.headerTextColor||"#000";if(l.call(this),this.internal.__cell__.printHeaders=j,this.internal.__cell__.margins=Q,this.internal.__cell__.table_font_size=T,this.internal.__cell__.padding=E,this.internal.__cell__.headerBackgroundColor=te,this.internal.__cell__.headerTextColor=C,this.setFontSize(T),g==null)M=D=Object.keys(A[0]),K=D.map(function(){return"left"});else if(Array.isArray(g)&&Ra(g[0])==="object")for(D=g.map(function(Z){return Z.name}),M=g.map(function(Z){return Z.prompt||Z.name||""}),K=g.map(function(Z){return Z.align||"left"}),f=0;f<g.length;f+=1)P[g[f].name]=.7499990551181103*g[f].width;else Array.isArray(g)&&typeof g[0]=="string"&&(M=D=g,K=D.map(function(){return"left"}));if(R||Array.isArray(g)&&typeof g[0]=="string")for(f=0;f<D.length;f+=1){for($[U=D[f]]=A.map(function(Z){return Z[U]}),this.setFont(void 0,"bold"),se.push(this.getTextDimensions(M[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),y=$[U],this.setFont(void 0,"normal"),v=0;v<y.length;v+=1)se.push(this.getTextDimensions(y[v],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);P[U]=Math.max.apply(null,se)+E+E,se=[]}if(j){var O={};for(f=0;f<D.length;f+=1)O[D[f]]={},O[D[f]].text=M[f],O[D[f]].align=K[f];var V=m.call(this,O,P);z=D.map(function(Z){return new c(u,x,P[Z],V,O[Z].text,void 0,O[Z].align)}),this.setTableHeaderRow(z),this.printHeaderRow(1,!1)}var re=g.reduce(function(Z,I){return Z[I.name]=I.align,Z},{});for(f=0;f<A.length;f+=1){"rowStart"in N&&N.rowStart instanceof Function&&N.rowStart({row:f,data:A[f]},this);var ge=m.call(this,A[f],P);for(v=0;v<D.length;v+=1){var xe=A[f][D[v]];"cellStart"in N&&N.cellStart instanceof Function&&N.cellStart({row:f,col:v,data:xe},this),o.call(this,new c(u,x,P[D[v]],ge,xe,f+2,re[D[v]]))}}return this.internal.__cell__.table_x=u,this.internal.__cell__.table_y=x,this};var m=function(u,x){var A=this.internal.__cell__.padding,g=this.internal.__cell__.table_font_size,N=this.internal.scaleFactor;return Object.keys(u).map(function(f){var y=u[f];return this.splitTextToSize(y.hasOwnProperty("text")?y.text:y,x[f]-A-A)},this).map(function(f){return this.getLineHeightFactor()*f.length*g/N+A+A},this).reduce(function(f,y){return Math.max(f,y)},0)};t.setTableHeaderRow=function(u){r.call(this),this.internal.__cell__.tableHeaderRow=u},t.printHeaderRow=function(u,x){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var A;if(a=!0,typeof this.internal.__cell__.headerFunction=="function"){var g=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new c(g[0],g[1],g[2],g[3],void 0,-1)}this.setFont(void 0,"bold");for(var N=[],f=0;f<this.internal.__cell__.tableHeaderRow.length;f+=1){A=this.internal.__cell__.tableHeaderRow[f].clone(),x&&(A.y=this.internal.__cell__.margins.top||0,N.push(A)),A.lineNumber=u;var y=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,A),this.setTextColor(y)}N.length>0&&this.setTableHeaderRow(N),this.setFont(void 0,"normal"),a=!1}})(ms.API);var t5={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},s5=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],kb=e5(s5),a5=[100,200,300,400,500,600,700,800,900],aU=e5(a5);function _f(t){var s=t.family.replace(/"|'/g,"").toLowerCase(),a=(function(c){return t5[c=c||"normal"]?c:"normal"})(t.style),r=(function(c){return c?typeof c=="number"?c>=100&&c<=900&&c%100==0?c:400:/^\d00$/.test(c)?parseInt(c):c==="bold"?700:400:400})(t.weight),l=(function(c){return typeof kb[c=c||"normal"]=="number"?c:"normal"})(t.stretch);return{family:s,style:a,weight:r,stretch:l,src:t.src||[],ref:t.ref||{name:s,style:[l,a,r].join(" ")}}}function Ow(t,s,a,r){var l;for(l=a;l>=0&&l<s.length;l+=r)if(t[s[l]])return t[s[l]];for(l=a;l>=0&&l<s.length;l-=r)if(t[s[l]])return t[s[l]]}var rU={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},zw={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Gw(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function qw(t){return t.trimLeft()}function nU(t,s){for(var a=0;a<t.length;){if(t.charAt(a)===s)return[t.substring(0,a),t.substring(a+1)];a+=1}return null}function lU(t){var s=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return s===null?null:[s[0],t.substring(s[0].length)]}var Xp,Kw,Vw,ku,Jp,Yw,Ww,Xw,Cf=["times"];function Jw(t,s,a,r,l){var c=4,o=e2;switch(l){case ms.API.image_compression.FAST:c=1,o=Zw;break;case ms.API.image_compression.MEDIUM:c=6,o=t2;break;case ms.API.image_compression.SLOW:c=9,o=s2}t=(function(u,x,A,g){for(var N,f=u.length/x,y=new Uint8Array(u.length+f),v=[iU,Zw,e2,t2,s2],U=0;U<f;U+=1){var D=U*x,M=u.subarray(D,D+x);if(g)y.set(g(M,A,N),D+U);else{for(var K=v.length,$=[],P=0;P<K;P+=1)$[P]=v[P](M,A,N);var se=oU($.concat());y.set($[se],D+U)}N=M}return y})(t,s,Math.ceil(a*r/8),o);var m=jb(t,{level:c});return ms.API.__addimage__.arrayBufferToBinaryString(m)}function iU(t){var s=Array.apply([],t);return s.unshift(0),s}function Zw(t,s){var a=t.length,r=[];r[0]=1;for(var l=0;l<a;l+=1){var c=t[l-s]||0;r[l+1]=t[l]-c+256&255}return r}function e2(t,s,a){var r=t.length,l=[];l[0]=2;for(var c=0;c<r;c+=1){var o=a&&a[c]||0;l[c+1]=t[c]-o+256&255}return l}function t2(t,s,a){var r=t.length,l=[];l[0]=3;for(var c=0;c<r;c+=1){var o=t[c-s]||0,m=a&&a[c]||0;l[c+1]=t[c]+256-(o+m>>>1)&255}return l}function s2(t,s,a){var r=t.length,l=[];l[0]=4;for(var c=0;c<r;c+=1){var o=cU(t[c-s]||0,a&&a[c]||0,a&&a[c-s]||0);l[c+1]=t[c]-o+256&255}return l}function cU(t,s,a){if(t===s&&s===a)return t;var r=Math.abs(s-a),l=Math.abs(t-a),c=Math.abs(t+s-a-a);return r<=l&&r<=c?t:l<=c?s:a}function oU(t){var s=t.map(function(a){return a.reduce(function(r,l){return r+Math.abs(l)},0)});return s.indexOf(Math.min.apply(null,s))}function Sf(t,s,a){var r=s*a,l=Math.floor(r/8),c=16-(r-8*l+a),o=(1<<a)-1;return r5(t,l)>>c&o}function a2(t,s,a,r){var l=a*r,c=Math.floor(l/8),o=16-(l-8*c+r),m=(1<<r)-1,u=(s&m)<<o;(function(x,A,g){if(A+1<x.byteLength)x.setUint16(A,g,!1);else{var N=g>>8&255;x.setUint8(A,N)}})(t,c,r5(t,c)&~(m<<o)&65535|u)}function r5(t,s){return s+1<t.byteLength?t.getUint16(s,!1):t.getUint8(s)<<8}function dU(t){var s=0;if(t[s++]!==71||t[s++]!==73||t[s++]!==70||t[s++]!==56||(t[s++]+1&253)!=56||t[s++]!==97)throw new Error("Invalid GIF 87a/89a header.");var a=t[s++]|t[s++]<<8,r=t[s++]|t[s++]<<8,l=t[s++],c=l>>7,o=1<<1+(7&l);t[s++],t[s++];var m=null,u=null;c&&(m=s,u=o,s+=3*o);var x=!0,A=[],g=0,N=null,f=0,y=null;for(this.width=a,this.height=r;x&&s<t.length;)switch(t[s++]){case 33:switch(t[s++]){case 255:if(t[s]!==11||t[s+1]==78&&t[s+2]==69&&t[s+3]==84&&t[s+4]==83&&t[s+5]==67&&t[s+6]==65&&t[s+7]==80&&t[s+8]==69&&t[s+9]==50&&t[s+10]==46&&t[s+11]==48&&t[s+12]==3&&t[s+13]==1&&t[s+16]==0)s+=14,y=t[s++]|t[s++]<<8,s++;else for(s+=12;;){if(!((Q=t[s++])>=0))throw Error("Invalid block size");if(Q===0)break;s+=Q}break;case 249:if(t[s++]!==4||t[s+4]!==0)throw new Error("Invalid graphics extension block.");var v=t[s++];g=t[s++]|t[s++]<<8,N=t[s++],1&v||(N=null),f=v>>2&7,s++;break;case 254:for(;;){if(!((Q=t[s++])>=0))throw Error("Invalid block size");if(Q===0)break;s+=Q}break;default:throw new Error("Unknown graphic control label: 0x"+t[s-1].toString(16))}break;case 44:var U=t[s++]|t[s++]<<8,D=t[s++]|t[s++]<<8,M=t[s++]|t[s++]<<8,K=t[s++]|t[s++]<<8,$=t[s++],P=$>>6&1,se=1<<1+(7&$),z=m,R=u,j=!1;$>>7&&(j=!0,z=s,R=se,s+=3*se);var T=s;for(s++;;){var Q;if(!((Q=t[s++])>=0))throw Error("Invalid block size");if(Q===0)break;s+=Q}A.push({x:U,y:D,width:M,height:K,has_local_palette:j,palette_offset:z,palette_size:R,data_offset:T,data_length:s-T,transparent_index:N,interlaced:!!P,delay:g,disposal:f});break;case 59:x=!1;break;default:throw new Error("Unknown gif block: 0x"+t[s-1].toString(16))}this.numFrames=function(){return A.length},this.loopCount=function(){return y},this.frameInfo=function(E){if(E<0||E>=A.length)throw new Error("Frame index out of range.");return A[E]},this.decodeAndBlitFrameBGRA=function(E,te){var C=this.frameInfo(E),O=C.width*C.height,V=new Uint8Array(O);r2(t,C.data_offset,V,O);var re=C.palette_offset,ge=C.transparent_index;ge===null&&(ge=256);var xe=C.width,Z=a-xe,I=xe,H=4*(C.y*a+C.x),ae=4*((C.y+C.height)*a+C.x),k=H,B=4*Z;C.interlaced===!0&&(B+=4*a*7);for(var w=8,oe=0,ne=V.length;oe<ne;++oe){var Fe=V[oe];if(I===0&&(I=xe,(k+=B)>=ae&&(B=4*Z+4*a*(w-1),k=H+(xe+Z)*(w<<1),w>>=1)),Fe===ge)k+=4;else{var je=t[re+3*Fe],Ge=t[re+3*Fe+1],ze=t[re+3*Fe+2];te[k++]=ze,te[k++]=Ge,te[k++]=je,te[k++]=255}--I}},this.decodeAndBlitFrameRGBA=function(E,te){var C=this.frameInfo(E),O=C.width*C.height,V=new Uint8Array(O);r2(t,C.data_offset,V,O);var re=C.palette_offset,ge=C.transparent_index;ge===null&&(ge=256);var xe=C.width,Z=a-xe,I=xe,H=4*(C.y*a+C.x),ae=4*((C.y+C.height)*a+C.x),k=H,B=4*Z;C.interlaced===!0&&(B+=4*a*7);for(var w=8,oe=0,ne=V.length;oe<ne;++oe){var Fe=V[oe];if(I===0&&(I=xe,(k+=B)>=ae&&(B=4*Z+4*a*(w-1),k=H+(xe+Z)*(w<<1),w>>=1)),Fe===ge)k+=4;else{var je=t[re+3*Fe],Ge=t[re+3*Fe+1],ze=t[re+3*Fe+2];te[k++]=je,te[k++]=Ge,te[k++]=ze,te[k++]=255}--I}}}function r2(t,s,a,r){for(var l=t[s++],c=1<<l,o=c+1,m=o+1,u=l+1,x=(1<<u)-1,A=0,g=0,N=0,f=t[s++],y=new Int32Array(4096),v=null;;){for(;A<16&&f!==0;)g|=t[s++]<<A,A+=8,f===1?f=t[s++]:--f;if(A<u)break;var U=g&x;if(g>>=u,A-=u,U!==c){if(U===o)break;for(var D=U<m?U:v,M=0,K=D;K>c;)K=y[K]>>8,++M;var $=K;if(N+M+(D!==U?1:0)>r)return void Ja.log("Warning, gif stream longer than expected.");a[N++]=$;var P=N+=M;for(D!==U&&(a[N++]=$),K=D;M--;)K=y[K],a[--P]=255&K,K>>=8;v!==null&&m<4096&&(y[m++]=v<<8|$,m>=x+1&&u<12&&(++u,x=x<<1|1)),v=U}else m=o+1,x=(1<<(u=l+1))-1,v=null}return N!==r&&Ja.log("Warning, gif stream shorter than expected."),a}function kf(t){var s,a,r,l,c,o=Math.floor,m=new Array(64),u=new Array(64),x=new Array(64),A=new Array(64),g=new Array(65535),N=new Array(65535),f=new Array(64),y=new Array(64),v=[],U=0,D=7,M=new Array(64),K=new Array(64),$=new Array(64),P=new Array(256),se=new Array(2048),z=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],R=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],j=[0,1,2,3,4,5,6,7,8,9,10,11],T=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],Q=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],E=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],te=[0,1,2,3,4,5,6,7,8,9,10,11],C=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],O=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function V(H,ae){for(var k=0,B=0,w=new Array,oe=1;oe<=16;oe++){for(var ne=1;ne<=H[oe];ne++)w[ae[B]]=[],w[ae[B]][0]=k,w[ae[B]][1]=oe,B++,k++;k*=2}return w}function re(H){for(var ae=H[0],k=H[1]-1;k>=0;)ae&1<<k&&(U|=1<<D),k--,--D<0&&(U==255?(ge(255),ge(0)):ge(U),D=7,U=0)}function ge(H){v.push(H)}function xe(H){ge(H>>8&255),ge(255&H)}function Z(H,ae,k,B,w){for(var oe,ne=w[0],Fe=w[240],je=(function(we,fe){var ye,Ke,ve,ie,q,pe,Me,Se,Ne,et,Ce=0;for(Ne=0;Ne<8;++Ne){ye=we[Ce],Ke=we[Ce+1],ve=we[Ce+2],ie=we[Ce+3],q=we[Ce+4],pe=we[Ce+5],Me=we[Ce+6];var ft=ye+(Se=we[Ce+7]),qe=ye-Se,W=Ke+Me,Ie=Ke-Me,mt=ve+pe,pt=ve-pe,kt=ie+q,J=ie-q,Je=ft+kt,_t=ft-kt,$t=W+mt,me=W-mt;we[Ce]=Je+$t,we[Ce+4]=Je-$t;var Ze=.707106781*(me+_t);we[Ce+2]=_t+Ze,we[Ce+6]=_t-Ze;var ct=.382683433*((Je=J+pt)-(me=Ie+qe)),Yt=.5411961*Je+ct,be=1.306562965*me+ct,lt=.707106781*($t=pt+Ie),Ue=qe+lt,Ct=qe-lt;we[Ce+5]=Ct+Yt,we[Ce+3]=Ct-Yt,we[Ce+1]=Ue+be,we[Ce+7]=Ue-be,Ce+=8}for(Ce=0,Ne=0;Ne<8;++Ne){ye=we[Ce],Ke=we[Ce+8],ve=we[Ce+16],ie=we[Ce+24],q=we[Ce+32],pe=we[Ce+40],Me=we[Ce+48];var Et=ye+(Se=we[Ce+56]),Rs=ye-Se,He=Ke+Me,Te=Ke-Me,bt=ve+pe,Xt=ve-pe,ls=ie+q,Ts=ie-q,ss=Et+ls,he=Et-ls,Ht=He+bt,Zt=He-bt;we[Ce]=ss+Ht,we[Ce+32]=ss-Ht;var Ee=.707106781*(Zt+he);we[Ce+16]=he+Ee,we[Ce+48]=he-Ee;var zt=.382683433*((ss=Ts+Xt)-(Zt=Te+Rs)),is=.5411961*ss+zt,pa=1.306562965*Zt+zt,ba=.707106781*(Ht=Xt+Te),xn=Rs+ba,zr=Rs-ba;we[Ce+40]=zr+is,we[Ce+24]=zr-is,we[Ce+8]=xn+pa,we[Ce+56]=xn-pa,Ce++}for(Ne=0;Ne<64;++Ne)et=we[Ne]*fe[Ne],f[Ne]=et>0?et+.5|0:et-.5|0;return f})(H,ae),Ge=0;Ge<64;++Ge)y[z[Ge]]=je[Ge];var ze=y[0]-k;k=y[0],ze==0?re(B[0]):(re(B[N[oe=32767+ze]]),re(g[oe]));for(var Xe=63;Xe>0&&y[Xe]==0;)Xe--;if(Xe==0)return re(ne),k;for(var st,ce=1;ce<=Xe;){for(var _e=ce;y[ce]==0&&ce<=Xe;)++ce;var le=ce-_e;if(le>=16){st=le>>4;for(var Pe=1;Pe<=st;++Pe)re(Fe);le&=15}oe=32767+y[ce],re(w[(le<<4)+N[oe]]),re(g[oe]),ce++}return Xe!=63&&re(ne),k}function I(H){H=Math.min(Math.max(H,1),100),c!=H&&((function(ae){for(var k=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],B=0;B<64;B++){var w=o((k[B]*ae+50)/100);w=Math.min(Math.max(w,1),255),m[z[B]]=w}for(var oe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ne=0;ne<64;ne++){var Fe=o((oe[ne]*ae+50)/100);Fe=Math.min(Math.max(Fe,1),255),u[z[ne]]=Fe}for(var je=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ge=0,ze=0;ze<8;ze++)for(var Xe=0;Xe<8;Xe++)x[Ge]=1/(m[z[Ge]]*je[ze]*je[Xe]*8),A[Ge]=1/(u[z[Ge]]*je[ze]*je[Xe]*8),Ge++})(H<50?Math.floor(5e3/H):Math.floor(200-2*H)),c=H)}this.encode=function(H,ae){ae&&I(ae),v=new Array,U=0,D=7,xe(65496),xe(65504),xe(16),ge(74),ge(70),ge(73),ge(70),ge(0),ge(1),ge(1),ge(0),xe(1),xe(1),ge(0),ge(0),(function(){xe(65499),xe(132),ge(0);for(var Ke=0;Ke<64;Ke++)ge(m[Ke]);ge(1);for(var ve=0;ve<64;ve++)ge(u[ve])})(),(function(Ke,ve){xe(65472),xe(17),ge(8),xe(ve),xe(Ke),ge(3),ge(1),ge(17),ge(0),ge(2),ge(17),ge(1),ge(3),ge(17),ge(1)})(H.width,H.height),(function(){xe(65476),xe(418),ge(0);for(var Ke=0;Ke<16;Ke++)ge(R[Ke+1]);for(var ve=0;ve<=11;ve++)ge(j[ve]);ge(16);for(var ie=0;ie<16;ie++)ge(T[ie+1]);for(var q=0;q<=161;q++)ge(Q[q]);ge(1);for(var pe=0;pe<16;pe++)ge(E[pe+1]);for(var Me=0;Me<=11;Me++)ge(te[Me]);ge(17);for(var Se=0;Se<16;Se++)ge(C[Se+1]);for(var Ne=0;Ne<=161;Ne++)ge(O[Ne])})(),xe(65498),xe(12),ge(3),ge(1),ge(0),ge(2),ge(17),ge(3),ge(17),ge(0),ge(63),ge(0);var k=0,B=0,w=0;U=0,D=7,this.encode.displayName="_encode_";for(var oe,ne,Fe,je,Ge,ze,Xe,st,ce,_e=H.data,le=H.width,Pe=H.height,we=4*le,fe=0;fe<Pe;){for(oe=0;oe<we;){for(Ge=we*fe+oe,Xe=-1,st=0,ce=0;ce<64;ce++)ze=Ge+(st=ce>>3)*we+(Xe=4*(7&ce)),fe+st>=Pe&&(ze-=we*(fe+1+st-Pe)),oe+Xe>=we&&(ze-=oe+Xe-we+4),ne=_e[ze++],Fe=_e[ze++],je=_e[ze++],M[ce]=(se[ne]+se[Fe+256|0]+se[je+512|0]>>16)-128,K[ce]=(se[ne+768|0]+se[Fe+1024|0]+se[je+1280|0]>>16)-128,$[ce]=(se[ne+1280|0]+se[Fe+1536|0]+se[je+1792|0]>>16)-128;k=Z(M,x,k,s,r),B=Z(K,A,B,a,l),w=Z($,A,w,a,l),oe+=32}fe+=8}if(D>=0){var ye=[];ye[1]=D+1,ye[0]=(1<<D+1)-1,re(ye)}return xe(65497),new Uint8Array(v)},t=t||50,(function(){for(var H=String.fromCharCode,ae=0;ae<256;ae++)P[ae]=H(ae)})(),s=V(R,j),a=V(E,te),r=V(T,Q),l=V(C,O),(function(){for(var H=1,ae=2,k=1;k<=15;k++){for(var B=H;B<ae;B++)N[32767+B]=k,g[32767+B]=[],g[32767+B][1]=k,g[32767+B][0]=B;for(var w=-(ae-1);w<=-H;w++)N[32767+w]=k,g[32767+w]=[],g[32767+w][1]=k,g[32767+w][0]=ae-1+w;H<<=1,ae<<=1}})(),(function(){for(var H=0;H<256;H++)se[H]=19595*H,se[H+256|0]=38470*H,se[H+512|0]=7471*H+32768,se[H+768|0]=-11059*H,se[H+1024|0]=-21709*H,se[H+1280|0]=32768*H+8421375,se[H+1536|0]=-27439*H,se[H+1792|0]=-5329*H})(),I(t)}function xc(t,s){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!s,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function n2(t){function s(j){if(!j)throw Error("assert :P")}function a(j,T,Q){for(var E=0;4>E;E++)if(j[T+E]!=Q.charCodeAt(E))return!0;return!1}function r(j,T,Q,E,te){for(var C=0;C<te;C++)j[T+C]=Q[E+C]}function l(j,T,Q,E){for(var te=0;te<E;te++)j[T+te]=Q}function c(j){return new Int32Array(j)}function o(j,T){for(var Q=[],E=0;E<j;E++)Q.push(new T);return Q}function m(j,T){var Q=[];return(function E(te,C,O){for(var V=O[C],re=0;re<V&&(te.push(O.length>C+1?[]:new T),!(O.length<C+1));re++)E(te[re],C+1,O)})(Q,0,j),Q}var u=function(){var j=this;function T(b,S){for(var X=1<<S-1>>>0;b&X;)X>>>=1;return X?(b&X-1)+X:b}function Q(b,S,X,de,Be){s(!(de%X));do b[S+(de-=X)]=Be;while(0<de)}function E(b,S,X,de,Be){if(s(2328>=Be),512>=Be)var Le=c(512);else if((Le=c(Be))==null)return 0;return(function(Qe,$e,Oe,Ye,rt,At){var Ve,it,ut=$e,Ft=1<<Oe,ht=c(16),Bt=c(16);for(s(rt!=0),s(Ye!=null),s(Qe!=null),s(0<Oe),it=0;it<rt;++it){if(15<Ye[it])return 0;++ht[Ye[it]]}if(ht[0]==rt)return 0;for(Bt[1]=0,Ve=1;15>Ve;++Ve){if(ht[Ve]>1<<Ve)return 0;Bt[Ve+1]=Bt[Ve]+ht[Ve]}for(it=0;it<rt;++it)Ve=Ye[it],0<Ye[it]&&(At[Bt[Ve]++]=it);if(Bt[15]==1)return(Ye=new te).g=0,Ye.value=At[0],Q(Qe,ut,1,Ft,Ye),Ft;var Lt,Vt=-1,Pt=Ft-1,fs=0,cs=1,Hs=1,ps=1<<Oe;for(it=0,Ve=1,rt=2;Ve<=Oe;++Ve,rt<<=1){if(cs+=Hs<<=1,0>(Hs-=ht[Ve]))return 0;for(;0<ht[Ve];--ht[Ve])(Ye=new te).g=Ve,Ye.value=At[it++],Q(Qe,ut+fs,rt,ps,Ye),fs=T(fs,Ve)}for(Ve=Oe+1,rt=2;15>=Ve;++Ve,rt<<=1){if(cs+=Hs<<=1,0>(Hs-=ht[Ve]))return 0;for(;0<ht[Ve];--ht[Ve]){if(Ye=new te,(fs&Pt)!=Vt){for(ut+=ps,Lt=1<<(Vt=Ve)-Oe;15>Vt&&!(0>=(Lt-=ht[Vt]));)++Vt,Lt<<=1;Ft+=ps=1<<(Lt=Vt-Oe),Qe[$e+(Vt=fs&Pt)].g=Lt+Oe,Qe[$e+Vt].value=ut-$e-Vt}Ye.g=Ve-Oe,Ye.value=At[it++],Q(Qe,ut+(fs>>Oe),rt,ps,Ye),fs=T(fs,Ve)}}return cs!=2*Bt[15]-1?0:Ft})(b,S,X,de,Be,Le)}function te(){this.value=this.g=0}function C(){this.value=this.g=0}function O(){this.G=o(5,te),this.H=c(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Fc,C)}function V(b,S,X,de){s(b!=null),s(S!=null),s(2147483648>de),b.Ca=254,b.I=0,b.b=-8,b.Ka=0,b.oa=S,b.pa=X,b.Jd=S,b.Yc=X+de,b.Zc=4<=de?X+de-4+1:X,ne(b)}function re(b,S){for(var X=0;0<S--;)X|=je(b,128)<<S;return X}function ge(b,S){var X=re(b,S);return Fe(b)?-X:X}function xe(b,S,X,de){var Be,Le=0;for(s(b!=null),s(S!=null),s(4294967288>de),b.Sb=de,b.Ra=0,b.u=0,b.h=0,4<de&&(de=4),Be=0;Be<de;++Be)Le+=S[X+Be]<<8*Be;b.Ra=Le,b.bb=de,b.oa=S,b.pa=X}function Z(b){for(;8<=b.u&&b.bb<b.Sb;)b.Ra>>>=8,b.Ra+=b.oa[b.pa+b.bb]<<Ai-8>>>0,++b.bb,b.u-=8;B(b)&&(b.h=1,b.u=0)}function I(b,S){if(s(0<=S),!b.h&&S<=Mn){var X=k(b)&Kn[S];return b.u+=S,Z(b),X}return b.h=1,b.u=0}function H(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function ae(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function k(b){return b.Ra>>>(b.u&Ai-1)>>>0}function B(b){return s(b.bb<=b.Sb),b.h||b.bb==b.Sb&&b.u>Ai}function w(b,S){b.u=S,b.h=B(b)}function oe(b){b.u>=gi&&(s(b.u>=gi),Z(b))}function ne(b){s(b!=null&&b.oa!=null),b.pa<b.Zc?(b.I=(b.oa[b.pa++]|b.I<<8)>>>0,b.b+=8):(s(b!=null&&b.oa!=null),b.pa<b.Yc?(b.b+=8,b.I=b.oa[b.pa++]|b.I<<8):b.Ka?b.b=0:(b.I<<=8,b.b+=8,b.Ka=1))}function Fe(b){return re(b,1)}function je(b,S){var X=b.Ca;0>b.b&&ne(b);var de=b.b,Be=X*S>>>8,Le=(b.I>>>de>Be)+0;for(Le?(X-=Be,b.I-=Be+1<<de>>>0):X=Be+1,de=X,Be=0;256<=de;)Be+=8,de>>=8;return de=7^Be+Zi[de],b.b-=de,b.Ca=(X<<de)-1,Le}function Ge(b,S,X){b[S+0]=X>>24&255,b[S+1]=X>>16&255,b[S+2]=X>>8&255,b[S+3]=255&X}function ze(b,S){return b[S+0]|b[S+1]<<8}function Xe(b,S){return ze(b,S)|b[S+2]<<16}function st(b,S){return ze(b,S)|ze(b,S+2)<<16}function ce(b,S){var X=1<<S;return s(b!=null),s(0<S),b.X=c(X),b.X==null?0:(b.Mb=32-S,b.Xa=S,1)}function _e(b,S){s(b!=null),s(S!=null),s(b.Xa==S.Xa),r(S.X,0,b.X,0,1<<S.Xa)}function le(){this.X=[],this.Xa=this.Mb=0}function Pe(b,S,X,de){s(X!=null),s(de!=null);var Be=X[0],Le=de[0];return Be==0&&(Be=(b*Le+S/2)/S),Le==0&&(Le=(S*Be+b/2)/b),0>=Be||0>=Le?0:(X[0]=Be,de[0]=Le,1)}function we(b,S){return b+(1<<S)-1>>>S}function fe(b,S){return((4278255360&b)+(4278255360&S)>>>0&4278255360)+((16711935&b)+(16711935&S)>>>0&16711935)>>>0}function ye(b,S){j[S]=function(X,de,Be,Le,Qe,$e,Oe){var Ye;for(Ye=0;Ye<Qe;++Ye){var rt=j[b]($e[Oe+Ye-1],Be,Le+Ye);$e[Oe+Ye]=fe(X[de+Ye],rt)}}}function Ke(){this.ud=this.hd=this.jd=0}function ve(b,S){return((4278124286&(b^S))>>>1)+(b&S)>>>0}function ie(b){return 0<=b&&256>b?b:0>b?0:255<b?255:void 0}function q(b,S){return ie(b+(b-S+.5>>1))}function pe(b,S,X){return Math.abs(S-X)-Math.abs(b-X)}function Me(b,S,X,de,Be,Le,Qe){for(de=Le[Qe-1],X=0;X<Be;++X)Le[Qe+X]=de=fe(b[S+X],de)}function Se(b,S,X,de,Be){var Le;for(Le=0;Le<X;++Le){var Qe=b[S+Le],$e=Qe>>8&255,Oe=16711935&(Oe=(Oe=16711935&Qe)+(($e<<16)+$e));de[Be+Le]=(4278255360&Qe)+Oe>>>0}}function Ne(b,S){S.jd=255&b,S.hd=b>>8&255,S.ud=b>>16&255}function et(b,S,X,de,Be,Le){var Qe;for(Qe=0;Qe<de;++Qe){var $e=S[X+Qe],Oe=$e>>>8,Ye=$e,rt=255&(rt=(rt=$e>>>16)+((b.jd<<24>>24)*(Oe<<24>>24)>>>5));Ye=255&(Ye=(Ye+=(b.hd<<24>>24)*(Oe<<24>>24)>>>5)+((b.ud<<24>>24)*(rt<<24>>24)>>>5)),Be[Le+Qe]=(4278255360&$e)+(rt<<16)+Ye}}function Ce(b,S,X,de,Be){j[S]=function(Le,Qe,$e,Oe,Ye,rt,At,Ve,it){for(Oe=At;Oe<Ve;++Oe)for(At=0;At<it;++At)Ye[rt++]=Be($e[de(Le[Qe++])])},j[b]=function(Le,Qe,$e,Oe,Ye,rt,At){var Ve=8>>Le.b,it=Le.Ea,ut=Le.K[0],Ft=Le.w;if(8>Ve)for(Le=(1<<Le.b)-1,Ft=(1<<Ve)-1;Qe<$e;++Qe){var ht,Bt=0;for(ht=0;ht<it;++ht)ht&Le||(Bt=de(Oe[Ye++])),rt[At++]=Be(ut[Bt&Ft]),Bt>>=Ve}else j["VP8LMapColor"+X](Oe,Ye,ut,Ft,rt,At,Qe,$e,it)}}function ft(b,S,X,de,Be){for(X=S+X;S<X;){var Le=b[S++];de[Be++]=Le>>16&255,de[Be++]=Le>>8&255,de[Be++]=255&Le}}function qe(b,S,X,de,Be){for(X=S+X;S<X;){var Le=b[S++];de[Be++]=Le>>16&255,de[Be++]=Le>>8&255,de[Be++]=255&Le,de[Be++]=Le>>24&255}}function W(b,S,X,de,Be){for(X=S+X;S<X;){var Le=(Qe=b[S++])>>16&240|Qe>>12&15,Qe=240&Qe|Qe>>28&15;de[Be++]=Le,de[Be++]=Qe}}function Ie(b,S,X,de,Be){for(X=S+X;S<X;){var Le=(Qe=b[S++])>>16&248|Qe>>13&7,Qe=Qe>>5&224|Qe>>3&31;de[Be++]=Le,de[Be++]=Qe}}function mt(b,S,X,de,Be){for(X=S+X;S<X;){var Le=b[S++];de[Be++]=255&Le,de[Be++]=Le>>8&255,de[Be++]=Le>>16&255}}function pt(b,S,X,de,Be,Le){if(Le==0)for(X=S+X;S<X;)Ge(de,((Le=b[S++])[0]>>24|Le[1]>>8&65280|Le[2]<<8&16711680|Le[3]<<24)>>>0),Be+=32;else r(de,Be,b,S,X)}function kt(b,S){j[S][0]=j[b+"0"],j[S][1]=j[b+"1"],j[S][2]=j[b+"2"],j[S][3]=j[b+"3"],j[S][4]=j[b+"4"],j[S][5]=j[b+"5"],j[S][6]=j[b+"6"],j[S][7]=j[b+"7"],j[S][8]=j[b+"8"],j[S][9]=j[b+"9"],j[S][10]=j[b+"10"],j[S][11]=j[b+"11"],j[S][12]=j[b+"12"],j[S][13]=j[b+"13"],j[S][14]=j[b+"0"],j[S][15]=j[b+"0"]}function J(b){return b==lm||b==Wm||b==ld||b==Xm}function Je(){this.eb=[],this.size=this.A=this.fb=0}function _t(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function $t(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Je,this.f.kb=new _t,this.sd=null}function me(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ze(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ct(b){return alert("todo:WebPSamplerProcessPlane"),b.T}function Yt(b,S){var X=b.T,de=S.ba.f.RGBA,Be=de.eb,Le=de.fb+b.ka*de.A,Qe=jn[S.ba.S],$e=b.y,Oe=b.O,Ye=b.f,rt=b.N,At=b.ea,Ve=b.W,it=S.cc,ut=S.dc,Ft=S.Mc,ht=S.Nc,Bt=b.ka,Lt=b.ka+b.T,Vt=b.U,Pt=Vt+1>>1;for(Bt==0?Qe($e,Oe,null,null,Ye,rt,At,Ve,Ye,rt,At,Ve,Be,Le,null,null,Vt):(Qe(S.ec,S.fc,$e,Oe,it,ut,Ft,ht,Ye,rt,At,Ve,Be,Le-de.A,Be,Le,Vt),++X);Bt+2<Lt;Bt+=2)it=Ye,ut=rt,Ft=At,ht=Ve,rt+=b.Rc,Ve+=b.Rc,Le+=2*de.A,Qe($e,(Oe+=2*b.fa)-b.fa,$e,Oe,it,ut,Ft,ht,Ye,rt,At,Ve,Be,Le-de.A,Be,Le,Vt);return Oe+=b.fa,b.j+Lt<b.o?(r(S.ec,S.fc,$e,Oe,Vt),r(S.cc,S.dc,Ye,rt,Pt),r(S.Mc,S.Nc,At,Ve,Pt),X--):1&Lt||Qe($e,Oe,null,null,Ye,rt,At,Ve,Ye,rt,At,Ve,Be,Le+de.A,null,null,Vt),X}function be(b,S,X){var de=b.F,Be=[b.J];if(de!=null){var Le=b.U,Qe=S.ba.S,$e=Qe==nm||Qe==ld;S=S.ba.f.RGBA;var Oe=[0],Ye=b.ka;Oe[0]=b.T,b.Kb&&(Ye==0?--Oe[0]:(--Ye,Be[0]-=b.width),b.j+b.ka+b.T==b.o&&(Oe[0]=b.o-b.j-Ye));var rt=S.eb;Ye=S.fb+Ye*S.A,b=tm(de,Be[0],b.width,Le,Oe,rt,Ye+($e?0:3),S.A),s(X==Oe),b&&J(Qe)&&xo(rt,Ye,$e,Le,Oe,S.A)}return 0}function lt(b){var S=b.ma,X=S.ba.S,de=11>X,Be=X==kn||X==kl||X==nm||X==nd||X==12||J(X);if(S.memory=null,S.Ib=null,S.Jb=null,S.Nd=null,!Ji(S.Oa,b,Be?11:12))return 0;if(Be&&J(X)&&Xd(),b.da)alert("todo:use_scaling");else{if(de){if(S.Ib=ct,b.Kb){if(X=b.U+1>>1,S.memory=c(b.U+2*X),S.memory==null)return 0;S.ec=S.memory,S.fc=0,S.cc=S.ec,S.dc=S.fc+b.U,S.Mc=S.cc,S.Nc=S.dc+X,S.Ib=Yt,Xd()}}else alert("todo:EmitYUV");Be&&(S.Jb=be,de&&Wl())}if(de&&!Rc){for(b=0;256>b;++b)vn[b]=89858*(b-128)+od>>Tl,Rg[b]=-22014*(b-128)+od,Xh[b]=-45773*(b-128),su[b]=113618*(b-128)+od>>Tl;for(b=go;b<Qc;++b)S=76283*(b-16)+od>>Tl,Mg[b-go]=hn(S,255),Ig[b-go]=hn(S+8>>4,15);Rc=1}return 1}function Ue(b){var S=b.ma,X=b.U,de=b.T;return s(!(1&b.ka)),0>=X||0>=de?0:(X=S.Ib(b,S),S.Jb!=null&&S.Jb(b,S,X),S.Dc+=X,1)}function Ct(b){b.ma.memory=null}function Et(b,S,X,de){return I(b,8)!=47?0:(S[0]=I(b,14)+1,X[0]=I(b,14)+1,de[0]=I(b,1),I(b,3)!=0?0:!b.h)}function Rs(b,S){if(4>b)return b+1;var X=b-2>>1;return(2+(1&b)<<X)+I(S,X)+1}function He(b,S){return 120<S?S-120:1<=(X=((X=Fl[S-1])>>4)*b+(8-(15&X)))?X:1;var X}function Te(b,S,X){var de=k(X),Be=b[S+=255&de].g-8;return 0<Be&&(w(X,X.u+8),de=k(X),S+=b[S].value,S+=de&(1<<Be)-1),w(X,X.u+b[S].g),b[S].value}function bt(b,S,X){return X.g+=b.g,X.value+=b.value<<S>>>0,s(8>=X.g),b.g}function Xt(b,S,X){var de=b.xc;return s((S=de==0?0:b.vc[b.md*(X>>de)+(S>>de)])<b.Wb),b.Ya[S]}function ls(b,S,X,de){var Be=b.ab,Le=b.c*S,Qe=b.C;S=Qe+S;var $e=X,Oe=de;for(de=b.Ta,X=b.Ua;0<Be--;){var Ye=b.gc[Be],rt=Qe,At=S,Ve=$e,it=Oe,ut=(Oe=de,$e=X,Ye.Ea);switch(s(rt<At),s(At<=Ye.nc),Ye.hc){case 2:_r(Ve,it,(At-rt)*ut,Oe,$e);break;case 0:var Ft=rt,ht=At,Bt=Oe,Lt=$e,Vt=(ps=Ye).Ea;Ft==0&&(td(Ve,it,null,null,1,Bt,Lt),Me(Ve,it+1,0,0,Vt-1,Bt,Lt+1),it+=Vt,Lt+=Vt,++Ft);for(var Pt=1<<ps.b,fs=Pt-1,cs=we(Vt,ps.b),Hs=ps.K,ps=ps.w+(Ft>>ps.b)*cs;Ft<ht;){var Zs=Hs,Ya=ps,zs=1;for(sd(Ve,it,Bt,Lt-Vt,1,Bt,Lt);zs<Vt;){var os=(zs&~fs)+Pt;os>Vt&&(os=Vt),(0,ec[Zs[Ya++]>>8&15])(Ve,it+ +zs,Bt,Lt+zs-Vt,os-zs,Bt,Lt+zs),zs=os}it+=Vt,Lt+=Vt,++Ft&fs||(ps+=cs)}At!=Ye.nc&&r(Oe,$e-ut,Oe,$e+(At-rt-1)*ut,ut);break;case 1:for(ut=Ve,ht=it,Vt=(Ve=Ye.Ea)-(Lt=Ve&~(Bt=(it=1<<Ye.b)-1)),Ft=we(Ve,Ye.b),Pt=Ye.K,Ye=Ye.w+(rt>>Ye.b)*Ft;rt<At;){for(fs=Pt,cs=Ye,Hs=new Ke,ps=ht+Lt,Zs=ht+Ve;ht<ps;)Ne(fs[cs++],Hs),ad(Hs,ut,ht,it,Oe,$e),ht+=it,$e+=it;ht<Zs&&(Ne(fs[cs++],Hs),ad(Hs,ut,ht,Vt,Oe,$e),ht+=Vt,$e+=Vt),++rt&Bt||(Ye+=Ft)}break;case 3:if(Ve==Oe&&it==$e&&0<Ye.b){for(ht=Oe,Ve=ut=$e+(At-rt)*ut-(Lt=(At-rt)*we(Ye.Ea,Ye.b)),it=Oe,Bt=$e,Ft=[],Lt=(Vt=Lt)-1;0<=Lt;--Lt)Ft[Lt]=it[Bt+Lt];for(Lt=Vt-1;0<=Lt;--Lt)ht[Ve+Lt]=Ft[Lt];Gm(Ye,rt,At,Oe,ut,Oe,$e)}else Gm(Ye,rt,At,Ve,it,Oe,$e)}$e=de,Oe=X}Oe!=X&&r(de,X,$e,Oe,Le)}function Ts(b,S){var X=b.V,de=b.Ba+b.c*b.C,Be=S-b.C;if(s(S<=b.l.o),s(16>=Be),0<Be){var Le=b.l,Qe=b.Ta,$e=b.Ua,Oe=Le.width;if(ls(b,Be,X,de),Be=$e=[$e],s((X=b.C)<(de=S)),s(Le.v<Le.va),de>Le.o&&(de=Le.o),X<Le.j){var Ye=Le.j-X;X=Le.j,Be[0]+=Ye*Oe}if(X>=de?X=0:(Be[0]+=4*Le.v,Le.ka=X-Le.j,Le.U=Le.va-Le.v,Le.T=de-X,X=1),X){if($e=$e[0],11>(X=b.ca).S){var rt=X.f.RGBA,At=(de=X.S,Be=Le.U,Le=Le.T,Ye=rt.eb,rt.A),Ve=Le;for(rt=rt.fb+b.Ma*rt.A;0<Ve--;){var it=Qe,ut=$e,Ft=Be,ht=Ye,Bt=rt;switch(de){case Vm:rd(it,ut,Ft,ht,Bt);break;case kn:tc(it,ut,Ft,ht,Bt);break;case lm:tc(it,ut,Ft,ht,Bt),xo(ht,Bt,0,Ft,1,0);break;case Ym:mo(it,ut,Ft,ht,Bt);break;case kl:pt(it,ut,Ft,ht,Bt,1);break;case Wm:pt(it,ut,Ft,ht,Bt,1),xo(ht,Bt,0,Ft,1,0);break;case nm:pt(it,ut,Ft,ht,Bt,0);break;case ld:pt(it,ut,Ft,ht,Bt,0),xo(ht,Bt,1,Ft,1,0);break;case nd:sc(it,ut,Ft,ht,Bt);break;case Xm:sc(it,ut,Ft,ht,Bt),Sl(ht,Bt,Ft,1,0);break;case Ec:yi(it,ut,Ft,ht,Bt);break;default:s(0)}$e+=Oe,rt+=At}b.Ma+=Le}else alert("todo:EmitRescaledRowsYUVA");s(b.Ma<=X.height)}}b.C=S,s(b.C<=b.i)}function ss(b){var S;if(0<b.ua)return 0;for(S=0;S<b.Wb;++S){var X=b.Ya[S].G,de=b.Ya[S].H;if(0<X[1][de[1]+0].g||0<X[2][de[2]+0].g||0<X[3][de[3]+0].g)return 0}return 1}function he(b,S,X,de,Be,Le){if(b.Z!=0){var Qe=b.qd,$e=b.rd;for(s(nc[b.Z]!=null);S<X;++S)nc[b.Z](Qe,$e,de,Be,de,Be,Le),Qe=de,$e=Be,Be+=Le;b.qd=Qe,b.rd=$e}}function Ht(b,S){var X=b.l.ma,de=X.Z==0||X.Z==1?b.l.j:b.C;if(de=b.C<de?de:b.C,s(S<=b.l.o),S>de){var Be=b.l.width,Le=X.ca,Qe=X.tb+Be*de,$e=b.V,Oe=b.Ba+b.c*de,Ye=b.gc;s(b.ab==1),s(Ye[0].hc==3),bi(Ye[0],de,S,$e,Oe,Le,Qe),he(X,de,S,Le,Qe,Be)}b.C=b.Ma=S}function Zt(b,S,X,de,Be,Le,Qe){var $e=b.$/de,Oe=b.$%de,Ye=b.m,rt=b.s,At=X+b.$,Ve=At;Be=X+de*Be;var it=X+de*Le,ut=280+rt.ua,Ft=b.Pb?$e:16777216,ht=0<rt.ua?rt.Wa:null,Bt=rt.wc,Lt=At<it?Xt(rt,Oe,$e):null;s(b.C<Le),s(it<=Be);var Vt=!1;e:for(;;){for(;Vt||At<it;){var Pt=0;if($e>=Ft){var fs=At-X;s((Ft=b).Pb),Ft.wd=Ft.m,Ft.xd=fs,0<Ft.s.ua&&_e(Ft.s.Wa,Ft.s.vb),Ft=$e+Dc}if(Oe&Bt||(Lt=Xt(rt,Oe,$e)),s(Lt!=null),Lt.Qb&&(S[At]=Lt.qb,Vt=!0),!Vt)if(oe(Ye),Lt.jc){Pt=Ye,fs=S;var cs=At,Hs=Lt.pd[k(Pt)&Fc-1];s(Lt.jc),256>Hs.g?(w(Pt,Pt.u+Hs.g),fs[cs]=Hs.value,Pt=0):(w(Pt,Pt.u+Hs.g-256),s(256<=Hs.value),Pt=Hs.value),Pt==0&&(Vt=!0)}else Pt=Te(Lt.G[0],Lt.H[0],Ye);if(Ye.h)break;if(Vt||256>Pt){if(!Vt)if(Lt.nd)S[At]=(Lt.qb|Pt<<8)>>>0;else{if(oe(Ye),Vt=Te(Lt.G[1],Lt.H[1],Ye),oe(Ye),fs=Te(Lt.G[2],Lt.H[2],Ye),cs=Te(Lt.G[3],Lt.H[3],Ye),Ye.h)break;S[At]=(cs<<24|Vt<<16|Pt<<8|fs)>>>0}if(Vt=!1,++At,++Oe>=de&&(Oe=0,++$e,Qe!=null&&$e<=Le&&!($e%16)&&Qe(b,$e),ht!=null))for(;Ve<At;)Pt=S[Ve++],ht.X[(506832829*Pt&4294967295)>>>ht.Mb]=Pt}else if(280>Pt){if(Pt=Rs(Pt-256,Ye),fs=Te(Lt.G[4],Lt.H[4],Ye),oe(Ye),fs=He(de,fs=Rs(fs,Ye)),Ye.h)break;if(At-X<fs||Be-At<Pt)break e;for(cs=0;cs<Pt;++cs)S[At+cs]=S[At+cs-fs];for(At+=Pt,Oe+=Pt;Oe>=de;)Oe-=de,++$e,Qe!=null&&$e<=Le&&!($e%16)&&Qe(b,$e);if(s(At<=Be),Oe&Bt&&(Lt=Xt(rt,Oe,$e)),ht!=null)for(;Ve<At;)Pt=S[Ve++],ht.X[(506832829*Pt&4294967295)>>>ht.Mb]=Pt}else{if(!(Pt<ut))break e;for(Vt=Pt-280,s(ht!=null);Ve<At;)Pt=S[Ve++],ht.X[(506832829*Pt&4294967295)>>>ht.Mb]=Pt;Pt=At,s(!(Vt>>>(fs=ht).Xa)),S[Pt]=fs.X[Vt],Vt=!0}Vt||s(Ye.h==B(Ye))}if(b.Pb&&Ye.h&&At<Be)s(b.m.h),b.a=5,b.m=b.wd,b.$=b.xd,0<b.s.ua&&_e(b.s.vb,b.s.Wa);else{if(Ye.h)break e;Qe?.(b,$e>Le?Le:$e),b.a=0,b.$=At-X}return 1}return b.a=3,0}function Ee(b){s(b!=null),b.vc=null,b.yc=null,b.Ya=null;var S=b.Wa;S!=null&&(S.X=null),b.vb=null,s(b!=null)}function zt(){var b=new Ms;return b==null?null:(b.a=0,b.xb=ux,kt("Predictor","VP8LPredictors"),kt("Predictor","VP8LPredictors_C"),kt("PredictorAdd","VP8LPredictorsAdd"),kt("PredictorAdd","VP8LPredictorsAdd_C"),_r=Se,ad=et,rd=ft,tc=qe,sc=W,yi=Ie,mo=mt,j.VP8LMapColor32b=fi,j.VP8LMapColor8b=fn,b)}function is(b,S,X,de,Be){var Le=1,Qe=[b],$e=[S],Oe=de.m,Ye=de.s,rt=null,At=0;e:for(;;){if(X)for(;Le&&I(Oe,1);){var Ve=Qe,it=$e,ut=de,Ft=1,ht=ut.m,Bt=ut.gc[ut.ab],Lt=I(ht,2);if(ut.Oc&1<<Lt)Le=0;else{switch(ut.Oc|=1<<Lt,Bt.hc=Lt,Bt.Ea=Ve[0],Bt.nc=it[0],Bt.K=[null],++ut.ab,s(4>=ut.ab),Lt){case 0:case 1:Bt.b=I(ht,3)+2,Ft=is(we(Bt.Ea,Bt.b),we(Bt.nc,Bt.b),0,ut,Bt.K),Bt.K=Bt.K[0];break;case 3:var Vt,Pt=I(ht,8)+1,fs=16<Pt?0:4<Pt?1:2<Pt?2:3;if(Ve[0]=we(Bt.Ea,fs),Bt.b=fs,Vt=Ft=is(Pt,1,0,ut,Bt.K)){var cs,Hs=Pt,ps=Bt,Zs=1<<(8>>ps.b),Ya=c(Zs);if(Ya==null)Vt=0;else{var zs=ps.K[0],os=ps.w;for(Ya[0]=ps.K[0][0],cs=1;cs<1*Hs;++cs)Ya[cs]=fe(zs[os+cs],Ya[cs-1]);for(;cs<4*Zs;++cs)Ya[cs]=0;ps.K[0]=null,ps.K[0]=Ya,Vt=1}}Ft=Vt;break;case 2:break;default:s(0)}Le=Ft}}if(Qe=Qe[0],$e=$e[0],Le&&I(Oe,1)&&!(Le=1<=(At=I(Oe,4))&&11>=At)){de.a=3;break e}var ts;if(ts=Le)t:{var sr,Ds,Ks,Ba=de,Kr=Qe,Nn=$e,Ha=At,Er=X,Bn=Ba.m,Dr=Ba.s,Xs=[null],Aa=1,ar=0,ja=El[Ha];s:for(;;){if(Er&&I(Bn,1)){var Vr=I(Bn,3)+2,rr=we(Kr,Vr),ga=we(Nn,Vr),kr=rr*ga;if(!is(rr,ga,0,Ba,Xs))break s;for(Xs=Xs[0],Dr.xc=Vr,sr=0;sr<kr;++sr){var Fa=Xs[sr]>>8&65535;Xs[sr]=Fa,Fa>=Aa&&(Aa=Fa+1)}}if(Bn.h)break s;for(Ds=0;5>Ds;++Ds){var Ur=po[Ds];!Ds&&0<Ha&&(Ur+=1<<Ha),ar<Ur&&(ar=Ur)}var Tr=o(Aa*ja,te),Ta=Aa,xa=o(Ta,O);if(xa==null)var Fn=null;else s(65536>=Ta),Fn=xa;var Ar=c(ar);if(Fn==null||Ar==null||Tr==null){Ba.a=1;break s}var Cs=Tr;for(sr=Ks=0;sr<Aa;++sr){var ks=Fn[sr],fa=ks.G,Vn=ks.H,Ll=0,$n=1,Lr=0;for(Ds=0;5>Ds;++Ds){Ur=po[Ds],fa[Ds]=Cs,Vn[Ds]=Ks,!Ds&&0<Ha&&(Ur+=1<<Ha);r:{var Mc,Ic=Ur,ru=Ba,Pa=Ar,hx=Cs,px=Ks,nu=0,lc=ru.m,$g=I(lc,1);if(l(Pa,0,0,Ic),$g){var Ax=I(lc,1)+1,gx=I(lc,1),lu=I(lc,gx==0?1:8);Pa[lu]=1,Ax==2&&(Pa[lu=I(lc,8)]=1);var rn=1}else{var gr=c(19),dm=I(lc,4)+4;if(19<dm){ru.a=3;var $c=0;break r}for(Mc=0;Mc<dm;++Mc)gr[im[Mc]]=I(lc,3);var md=void 0,fo=void 0,Ni=ru,iu=gr,ud=Ic,cu=Pa,ou=0,ic=Ni.m,fx=8,bx=o(128,te);a:for(;E(bx,0,7,iu,19);){if(I(ic,1)){var Jh=2+2*I(ic,3);if((md=2+I(ic,Jh))>ud)break a}else md=ud;for(fo=0;fo<ud&&md--;){oe(ic);var yx=bx[0+(127&k(ic))];w(ic,ic.u+yx.g);var Hc=yx.value;if(16>Hc)cu[fo++]=Hc,Hc!=0&&(fx=Hc);else{var Zh=Hc==16,ep=Hc-16,tp=id[ep],jx=I(ic,Bl[ep])+tp;if(fo+jx>ud)break a;for(var sp=Zh?fx:0;0<jx--;)cu[fo++]=sp}}ou=1;break a}ou||(Ni.a=3),rn=ou}(rn=rn&&!lc.h)&&(nu=E(hx,px,8,Pa,Ic)),rn&&nu!=0?$c=nu:(ru.a=3,$c=0)}if($c==0)break s;if($n&&Jm[Ds]==1&&($n=Cs[Ks].g==0),Ll+=Cs[Ks].g,Ks+=$c,3>=Ds){var bo,du=Ar[0];for(bo=1;bo<Ur;++bo)Ar[bo]>du&&(du=Ar[bo]);Lr+=du}}if(ks.nd=$n,ks.Qb=0,$n&&(ks.qb=(fa[3][Vn[3]+0].value<<24|fa[1][Vn[1]+0].value<<16|fa[2][Vn[2]+0].value)>>>0,Ll==0&&256>fa[0][Vn[0]+0].value&&(ks.Qb=1,ks.qb+=fa[0][Vn[0]+0].value<<8)),ks.jc=!ks.Qb&&6>Lr,ks.jc){var mm,wi=ks;for(mm=0;mm<Fc;++mm){var cc=mm,oc=wi.pd[cc],mu=wi.G[0][wi.H[0]+cc];256<=mu.value?(oc.g=mu.g+256,oc.value=mu.value):(oc.g=0,oc.value=0,cc>>=bt(mu,8,oc),cc>>=bt(wi.G[1][wi.H[1]+cc],16,oc),cc>>=bt(wi.G[2][wi.H[2]+cc],0,oc),bt(wi.G[3][wi.H[3]+cc],24,oc))}}}Dr.vc=Xs,Dr.Wb=Aa,Dr.Ya=Fn,Dr.yc=Tr,ts=1;break t}ts=0}if(!(Le=ts)){de.a=3;break e}if(0<At){if(Ye.ua=1<<At,!ce(Ye.Wa,At)){de.a=1,Le=0;break e}}else Ye.ua=0;var uu=de,yo=Qe,ap=$e,xd=uu.s,hd=xd.xc;if(uu.c=yo,uu.i=ap,xd.md=we(yo,hd),xd.wc=hd==0?-1:(1<<hd)-1,X){de.xb=Uc;break e}if((rt=c(Qe*$e))==null){de.a=1,Le=0;break e}Le=(Le=Zt(de,rt,0,Qe,$e,$e,null))&&!Oe.h;break e}return Le?(Be!=null?Be[0]=rt:(s(rt==null),s(X)),de.$=0,X||Ee(Ye)):Ee(Ye),Le}function pa(b,S){var X=b.c*b.i,de=X+S+16*S;return s(b.c<=S),b.V=c(de),b.V==null?(b.Ta=null,b.Ua=0,b.a=1,0):(b.Ta=b.V,b.Ua=b.Ba+X+S,1)}function ba(b,S){var X=b.C,de=S-X,Be=b.V,Le=b.Ba+b.c*X;for(s(S<=b.l.o);0<de;){var Qe=16<de?16:de,$e=b.l.ma,Oe=b.l.width,Ye=Oe*Qe,rt=$e.ca,At=$e.tb+Oe*X,Ve=b.Ta,it=b.Ua;ls(b,Qe,Be,Le),gl(Ve,it,rt,At,Ye),he($e,X,X+Qe,rt,At,Oe),de-=Qe,Be+=Qe*b.c,X+=Qe}s(X==S),b.C=b.Ma=S}function xn(){this.ub=this.yd=this.td=this.Rb=0}function zr(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function De(){this.Fb=this.Bb=this.Cb=0,this.Zb=c(4),this.Lb=c(4)}function Jt(){this.Yb=(function(){var b=[];return(function S(X,de,Be){for(var Le=Be[de],Qe=0;Qe<Le&&(X.push(Be.length>de+1?[]:0),!(Be.length<de+1));Qe++)S(X[Qe],de+1,Be)})(b,0,[3,11]),b})()}function rs(){this.jb=c(3),this.Wc=m([4,8],Jt),this.Xc=m([4,17],Jt)}function dr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new c(4),this.od=new c(4)}function Ae(){this.ld=this.La=this.dd=this.tc=0}function es(){this.Na=this.la=0}function ws(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Da(){this.ad=c(384),this.Za=0,this.Ob=c(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ii(){this.uc=this.M=this.Nb=0,this.wa=Array(new Ae),this.Y=0,this.ya=Array(new Da),this.aa=0,this.l=new Vl}function Kl(){this.y=c(16),this.f=c(8),this.ea=c(8)}function mr(){this.cb=this.a=0,this.sc="",this.m=new H,this.Od=new xn,this.Kc=new zr,this.ed=new dr,this.Qa=new De,this.Ic=this.$c=this.Aa=0,this.D=new Ii,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,H),this.ia=0,this.pb=o(4,ws),this.Pa=new rs,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Kl),this.Hd=0,this.rb=Array(new es),this.sb=0,this.wa=Array(new Ae),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Da),this.L=this.aa=0,this.gd=m([4,2],Ae),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function hn(b,S){return 0>b?0:b>S?S:b}function Vl(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function dl(){var b=new mr;return b!=null&&(b.a=0,b.sc="OK",b.cb=0,b.Xb=0,fl||(fl=mi)),b}function da(b,S,X){return b.a==0&&(b.a=S,b.sc=X,b.cb=0),0}function $i(b,S,X){return 3<=X&&b[S+0]==157&&b[S+1]==1&&b[S+2]==42}function Nl(b,S){if(b==null)return 0;if(b.a=0,b.sc="OK",S==null)return da(b,2,"null VP8Io passed to VP8GetHeaders()");var X=S.data,de=S.w,Be=S.ha;if(4>Be)return da(b,7,"Truncated header.");var Le=X[de+0]|X[de+1]<<8|X[de+2]<<16,Qe=b.Od;if(Qe.Rb=!(1&Le),Qe.td=Le>>1&7,Qe.yd=Le>>4&1,Qe.ub=Le>>5,3<Qe.td)return da(b,3,"Incorrect keyframe parameters.");if(!Qe.yd)return da(b,4,"Frame not displayable.");de+=3,Be-=3;var $e=b.Kc;if(Qe.Rb){if(7>Be)return da(b,7,"cannot parse picture header");if(!$i(X,de,Be))return da(b,3,"Bad code word");$e.c=16383&(X[de+4]<<8|X[de+3]),$e.Td=X[de+4]>>6,$e.i=16383&(X[de+6]<<8|X[de+5]),$e.Ud=X[de+6]>>6,de+=7,Be-=7,b.za=$e.c+15>>4,b.Ub=$e.i+15>>4,S.width=$e.c,S.height=$e.i,S.Da=0,S.j=0,S.v=0,S.va=S.width,S.o=S.height,S.da=0,S.ib=S.width,S.hb=S.height,S.U=S.width,S.T=S.height,l((Le=b.Pa).jb,0,255,Le.jb.length),s((Le=b.Qa)!=null),Le.Cb=0,Le.Bb=0,Le.Fb=1,l(Le.Zb,0,0,Le.Zb.length),l(Le.Lb,0,0,Le.Lb)}if(Qe.ub>Be)return da(b,7,"bad partition length");V(Le=b.m,X,de,Qe.ub),de+=Qe.ub,Be-=Qe.ub,Qe.Rb&&($e.Ld=Fe(Le),$e.Kd=Fe(Le)),$e=b.Qa;var Oe,Ye=b.Pa;if(s(Le!=null),s($e!=null),$e.Cb=Fe(Le),$e.Cb){if($e.Bb=Fe(Le),Fe(Le)){for($e.Fb=Fe(Le),Oe=0;4>Oe;++Oe)$e.Zb[Oe]=Fe(Le)?ge(Le,7):0;for(Oe=0;4>Oe;++Oe)$e.Lb[Oe]=Fe(Le)?ge(Le,6):0}if($e.Bb)for(Oe=0;3>Oe;++Oe)Ye.jb[Oe]=Fe(Le)?re(Le,8):255}else $e.Bb=0;if(Le.Ka)return da(b,3,"cannot parse segment header");if(($e=b.ed).zd=Fe(Le),$e.Tb=re(Le,6),$e.wb=re(Le,3),$e.Pc=Fe(Le),$e.Pc&&Fe(Le)){for(Ye=0;4>Ye;++Ye)Fe(Le)&&($e.vd[Ye]=ge(Le,6));for(Ye=0;4>Ye;++Ye)Fe(Le)&&($e.od[Ye]=ge(Le,6))}if(b.L=$e.Tb==0?0:$e.zd?1:2,Le.Ka)return da(b,3,"cannot parse filter header");var rt=Be;if(Be=Oe=de,de=Oe+rt,$e=rt,b.Xb=(1<<re(b.m,2))-1,rt<3*(Ye=b.Xb))X=7;else{for(Oe+=3*Ye,$e-=3*Ye,rt=0;rt<Ye;++rt){var At=X[Be+0]|X[Be+1]<<8|X[Be+2]<<16;At>$e&&(At=$e),V(b.Jc[+rt],X,Oe,At),Oe+=At,$e-=At,Be+=3}V(b.Jc[+Ye],X,Oe,$e),X=Oe<de?0:5}if(X!=0)return da(b,X,"cannot parse partitions");for(X=re(Oe=b.m,7),Be=Fe(Oe)?ge(Oe,4):0,de=Fe(Oe)?ge(Oe,4):0,$e=Fe(Oe)?ge(Oe,4):0,Ye=Fe(Oe)?ge(Oe,4):0,Oe=Fe(Oe)?ge(Oe,4):0,rt=b.Qa,At=0;4>At;++At){if(rt.Cb){var Ve=rt.Zb[At];rt.Fb||(Ve+=X)}else{if(0<At){b.pb[At]=b.pb[0];continue}Ve=X}var it=b.pb[At];it.Sc[0]=Dl[hn(Ve+Be,127)],it.Sc[1]=Ul[hn(Ve+0,127)],it.Eb[0]=2*Dl[hn(Ve+de,127)],it.Eb[1]=101581*Ul[hn(Ve+$e,127)]>>16,8>it.Eb[1]&&(it.Eb[1]=8),it.Qc[0]=Dl[hn(Ve+Ye,117)],it.Qc[1]=Ul[hn(Ve+Oe,127)],it.lc=Ve+Oe}if(!Qe.Rb)return da(b,4,"Not a key frame.");for(Fe(Le),Qe=b.Pa,X=0;4>X;++X){for(Be=0;8>Be;++Be)for(de=0;3>de;++de)for($e=0;11>$e;++$e)Ye=je(Le,Va[X][Be][de][$e])?re(Le,8):Wh[X][Be][de][$e],Qe.Wc[X][Be].Yb[de][$e]=Ye;for(Be=0;17>Be;++Be)Qe.Xc[X][Be]=Qe.Wc[X][ea[Be]]}return b.kc=Fe(Le),b.kc&&(b.Bd=re(Le,8)),b.cb=1}function mi(b,S,X,de,Be,Le,Qe){var $e=S[Be].Yb[X];for(X=0;16>Be;++Be){if(!je(b,$e[X+0]))return Be;for(;!je(b,$e[X+1]);)if($e=S[++Be].Yb[0],X=0,Be==16)return 16;var Oe=S[Be+1].Yb;if(je(b,$e[X+2])){var Ye=b,rt=0;if(je(Ye,(Ve=$e)[(At=X)+3]))if(je(Ye,Ve[At+6])){for($e=0,At=2*(rt=je(Ye,Ve[At+8]))+(Ve=je(Ye,Ve[At+9+rt])),rt=0,Ve=Yh[At];Ve[$e];++$e)rt+=rt+je(Ye,Ve[$e]);rt+=3+(8<<At)}else je(Ye,Ve[At+7])?(rt=7+2*je(Ye,165),rt+=je(Ye,145)):rt=5+je(Ye,159);else rt=je(Ye,Ve[At+4])?3+je(Ye,Ve[At+5]):2;$e=Oe[2]}else rt=1,$e=Oe[1];Oe=Qe+mx[Be],0>(Ye=b).b&&ne(Ye);var At,Ve=Ye.b,it=(At=Ye.Ca>>1)-(Ye.I>>Ve)>>31;--Ye.b,Ye.Ca+=it,Ye.Ca|=1,Ye.I-=(At+1&it)<<Ve,Le[Oe]=((rt^it)-it)*de[(0<Be)+0]}return 16}function to(b){var S=b.rb[b.sb-1];S.la=0,S.Na=0,l(b.zc,0,0,b.zc.length),b.ja=0}function pn(b,S,X,de,Be){Be=b[S+X+32*de]+(Be>>3),b[S+X+32*de]=-256&Be?0>Be?0:255:Be}function Nr(b,S,X,de,Be,Le){pn(b,S,0,X,de+Be),pn(b,S,1,X,de+Le),pn(b,S,2,X,de-Le),pn(b,S,3,X,de-Be)}function ur(b){return(20091*b>>16)+b}function _c(b,S,X,de){var Be,Le=0,Qe=c(16);for(Be=0;4>Be;++Be){var $e=b[S+0]+b[S+8],Oe=b[S+0]-b[S+8],Ye=(35468*b[S+4]>>16)-ur(b[S+12]),rt=ur(b[S+4])+(35468*b[S+12]>>16);Qe[Le+0]=$e+rt,Qe[Le+1]=Oe+Ye,Qe[Le+2]=Oe-Ye,Qe[Le+3]=$e-rt,Le+=4,S++}for(Be=Le=0;4>Be;++Be)$e=(b=Qe[Le+0]+4)+Qe[Le+8],Oe=b-Qe[Le+8],Ye=(35468*Qe[Le+4]>>16)-ur(Qe[Le+12]),pn(X,de,0,0,$e+(rt=ur(Qe[Le+4])+(35468*Qe[Le+12]>>16))),pn(X,de,1,0,Oe+Ye),pn(X,de,2,0,Oe-Ye),pn(X,de,3,0,$e-rt),Le++,de+=32}function Vo(b,S,X,de){var Be=b[S+0]+4,Le=35468*b[S+4]>>16,Qe=ur(b[S+4]),$e=35468*b[S+1]>>16;Nr(X,de,0,Be+Qe,b=ur(b[S+1]),$e),Nr(X,de,1,Be+Le,b,$e),Nr(X,de,2,Be-Le,b,$e),Nr(X,de,3,Be-Qe,b,$e)}function Cc(b,S,X,de,Be){_c(b,S,X,de),Be&&_c(b,S+16,X,de+4)}function Gr(b,S,X,de){ac(b,S+0,X,de,1),ac(b,S+32,X,de+128,1)}function so(b,S,X,de){var Be;for(b=b[S+0]+4,Be=0;4>Be;++Be)for(S=0;4>S;++S)pn(X,de,S,Be,b)}function ao(b,S,X,de){b[S+0]&&ya(b,S+0,X,de),b[S+16]&&ya(b,S+16,X,de+4),b[S+32]&&ya(b,S+32,X,de+128),b[S+48]&&ya(b,S+48,X,de+128+4)}function ml(b,S,X,de){var Be,Le=c(16);for(Be=0;4>Be;++Be){var Qe=b[S+0+Be]+b[S+12+Be],$e=b[S+4+Be]+b[S+8+Be],Oe=b[S+4+Be]-b[S+8+Be],Ye=b[S+0+Be]-b[S+12+Be];Le[0+Be]=Qe+$e,Le[8+Be]=Qe-$e,Le[4+Be]=Ye+Oe,Le[12+Be]=Ye-Oe}for(Be=0;4>Be;++Be)Qe=(b=Le[0+4*Be]+3)+Le[3+4*Be],$e=Le[1+4*Be]+Le[2+4*Be],Oe=Le[1+4*Be]-Le[2+4*Be],Ye=b-Le[3+4*Be],X[de+0]=Qe+$e>>3,X[de+16]=Ye+Oe>>3,X[de+32]=Qe-$e>>3,X[de+48]=Ye-Oe>>3,de+=64}function Y(b,S,X){var de,Be=S-32,Le=Sn,Qe=255-b[Be-1];for(de=0;de<X;++de){var $e,Oe=Le,Ye=Qe+b[S-1];for($e=0;$e<X;++$e)b[S+$e]=Oe[Ye+b[Be+$e]];S+=32}}function vt(b,S){Y(b,S,4)}function Ss(b,S){Y(b,S,8)}function xr(b,S){Y(b,S,16)}function ul(b,S){var X;for(X=0;16>X;++X)r(b,S+32*X,b,S-32,16)}function hr(b,S){var X;for(X=16;0<X;--X)l(b,S,b[S-1],16),S+=32}function qn(b,S,X){var de;for(de=0;16>de;++de)l(S,X+32*de,b,16)}function Yl(b,S){var X,de=16;for(X=0;16>X;++X)de+=b[S-1+32*X]+b[S+X-32];qn(de>>5,b,S)}function Hi(b,S){var X,de=8;for(X=0;16>X;++X)de+=b[S-1+32*X];qn(de>>4,b,S)}function ro(b,S){var X,de=8;for(X=0;16>X;++X)de+=b[S+X-32];qn(de>>4,b,S)}function Sc(b,S){qn(128,b,S)}function Es(b,S,X){return b+2*S+X+2>>2}function $m(b,S){var X,de=S-32;for(de=new Uint8Array([Es(b[de-1],b[de+0],b[de+1]),Es(b[de+0],b[de+1],b[de+2]),Es(b[de+1],b[de+2],b[de+3]),Es(b[de+2],b[de+3],b[de+4])]),X=0;4>X;++X)r(b,S+32*X,de,0,de.length)}function Vd(b,S){var X=b[S-1],de=b[S-1+32],Be=b[S-1+64],Le=b[S-1+96];Ge(b,S+0,16843009*Es(b[S-1-32],X,de)),Ge(b,S+32,16843009*Es(X,de,Be)),Ge(b,S+64,16843009*Es(de,Be,Le)),Ge(b,S+96,16843009*Es(Be,Le,Le))}function Hm(b,S){var X,de=4;for(X=0;4>X;++X)de+=b[S+X-32]+b[S-1+32*X];for(de>>=3,X=0;4>X;++X)l(b,S+32*X,de,4)}function xl(b,S){var X=b[S-1+0],de=b[S-1+32],Be=b[S-1+64],Le=b[S-1-32],Qe=b[S+0-32],$e=b[S+1-32],Oe=b[S+2-32],Ye=b[S+3-32];b[S+0+96]=Es(de,Be,b[S-1+96]),b[S+1+96]=b[S+0+64]=Es(X,de,Be),b[S+2+96]=b[S+1+64]=b[S+0+32]=Es(Le,X,de),b[S+3+96]=b[S+2+64]=b[S+1+32]=b[S+0+0]=Es(Qe,Le,X),b[S+3+64]=b[S+2+32]=b[S+1+0]=Es($e,Qe,Le),b[S+3+32]=b[S+2+0]=Es(Oe,$e,Qe),b[S+3+0]=Es(Ye,Oe,$e)}function An(b,S){var X=b[S+1-32],de=b[S+2-32],Be=b[S+3-32],Le=b[S+4-32],Qe=b[S+5-32],$e=b[S+6-32],Oe=b[S+7-32];b[S+0+0]=Es(b[S+0-32],X,de),b[S+1+0]=b[S+0+32]=Es(X,de,Be),b[S+2+0]=b[S+1+32]=b[S+0+64]=Es(de,Be,Le),b[S+3+0]=b[S+2+32]=b[S+1+64]=b[S+0+96]=Es(Be,Le,Qe),b[S+3+32]=b[S+2+64]=b[S+1+96]=Es(Le,Qe,$e),b[S+3+64]=b[S+2+96]=Es(Qe,$e,Oe),b[S+3+96]=Es($e,Oe,Oe)}function Yd(b,S){var X=b[S-1+0],de=b[S-1+32],Be=b[S-1+64],Le=b[S-1-32],Qe=b[S+0-32],$e=b[S+1-32],Oe=b[S+2-32],Ye=b[S+3-32];b[S+0+0]=b[S+1+64]=Le+Qe+1>>1,b[S+1+0]=b[S+2+64]=Qe+$e+1>>1,b[S+2+0]=b[S+3+64]=$e+Oe+1>>1,b[S+3+0]=Oe+Ye+1>>1,b[S+0+96]=Es(Be,de,X),b[S+0+64]=Es(de,X,Le),b[S+0+32]=b[S+1+96]=Es(X,Le,Qe),b[S+1+32]=b[S+2+96]=Es(Le,Qe,$e),b[S+2+32]=b[S+3+96]=Es(Qe,$e,Oe),b[S+3+32]=Es($e,Oe,Ye)}function no(b,S){var X=b[S+0-32],de=b[S+1-32],Be=b[S+2-32],Le=b[S+3-32],Qe=b[S+4-32],$e=b[S+5-32],Oe=b[S+6-32],Ye=b[S+7-32];b[S+0+0]=X+de+1>>1,b[S+1+0]=b[S+0+64]=de+Be+1>>1,b[S+2+0]=b[S+1+64]=Be+Le+1>>1,b[S+3+0]=b[S+2+64]=Le+Qe+1>>1,b[S+0+32]=Es(X,de,Be),b[S+1+32]=b[S+0+96]=Es(de,Be,Le),b[S+2+32]=b[S+1+96]=Es(Be,Le,Qe),b[S+3+32]=b[S+2+96]=Es(Le,Qe,$e),b[S+3+64]=Es(Qe,$e,Oe),b[S+3+96]=Es($e,Oe,Ye)}function hl(b,S){var X=b[S-1+0],de=b[S-1+32],Be=b[S-1+64],Le=b[S-1+96];b[S+0+0]=X+de+1>>1,b[S+2+0]=b[S+0+32]=de+Be+1>>1,b[S+2+32]=b[S+0+64]=Be+Le+1>>1,b[S+1+0]=Es(X,de,Be),b[S+3+0]=b[S+1+32]=Es(de,Be,Le),b[S+3+32]=b[S+1+64]=Es(Be,Le,Le),b[S+3+64]=b[S+2+64]=b[S+0+96]=b[S+1+96]=b[S+2+96]=b[S+3+96]=Le}function lo(b,S){var X=b[S-1+0],de=b[S-1+32],Be=b[S-1+64],Le=b[S-1+96],Qe=b[S-1-32],$e=b[S+0-32],Oe=b[S+1-32],Ye=b[S+2-32];b[S+0+0]=b[S+2+32]=X+Qe+1>>1,b[S+0+32]=b[S+2+64]=de+X+1>>1,b[S+0+64]=b[S+2+96]=Be+de+1>>1,b[S+0+96]=Le+Be+1>>1,b[S+3+0]=Es($e,Oe,Ye),b[S+2+0]=Es(Qe,$e,Oe),b[S+1+0]=b[S+3+32]=Es(X,Qe,$e),b[S+1+32]=b[S+3+64]=Es(de,X,Qe),b[S+1+64]=b[S+3+96]=Es(Be,de,X),b[S+1+96]=Es(Le,Be,de)}function ui(b,S){var X;for(X=0;8>X;++X)r(b,S+32*X,b,S-32,8)}function Pm(b,S){var X;for(X=0;8>X;++X)l(b,S,b[S-1],8),S+=32}function wl(b,S,X){var de;for(de=0;8>de;++de)l(S,X+32*de,b,8)}function Yo(b,S){var X,de=8;for(X=0;8>X;++X)de+=b[S+X-32]+b[S-1+32*X];wl(de>>4,b,S)}function Wo(b,S){var X,de=4;for(X=0;8>X;++X)de+=b[S+X-32];wl(de>>3,b,S)}function sn(b,S){var X,de=4;for(X=0;8>X;++X)de+=b[S-1+32*X];wl(de>>3,b,S)}function xi(b,S){wl(128,b,S)}function _l(b,S,X){var de=b[S-X],Be=b[S+0],Le=3*(Be-de)+rc[1020+b[S-2*X]-b[S+X]],Qe=rm[112+(Le+4>>3)];b[S-X]=Sn[255+de+rm[112+(Le+3>>3)]],b[S+0]=Sn[255+Be-Qe]}function Pi(b,S,X,de){var Be=b[S+0],Le=b[S+X];return bn[255+b[S-2*X]-b[S-X]]>de||bn[255+Le-Be]>de}function Xo(b,S,X,de){return 4*bn[255+b[S-X]-b[S+0]]+bn[255+b[S-2*X]-b[S+X]]<=de}function io(b,S,X,de,Be){var Le=b[S-3*X],Qe=b[S-2*X],$e=b[S-X],Oe=b[S+0],Ye=b[S+X],rt=b[S+2*X],At=b[S+3*X];return 4*bn[255+$e-Oe]+bn[255+Qe-Ye]>de?0:bn[255+b[S-4*X]-Le]<=Be&&bn[255+Le-Qe]<=Be&&bn[255+Qe-$e]<=Be&&bn[255+At-rt]<=Be&&bn[255+rt-Ye]<=Be&&bn[255+Ye-Oe]<=Be}function Oi(b,S,X,de){var Be=2*de+1;for(de=0;16>de;++de)Xo(b,S+de,X,Be)&&_l(b,S+de,X)}function zi(b,S,X,de){var Be=2*de+1;for(de=0;16>de;++de)Xo(b,S+de*X,1,Be)&&_l(b,S+de*X,1)}function co(b,S,X,de){var Be;for(Be=3;0<Be;--Be)Oi(b,S+=4*X,X,de)}function Wd(b,S,X,de){var Be;for(Be=3;0<Be;--Be)zi(b,S+=4,X,de)}function Gi(b,S,X,de,Be,Le,Qe,$e){for(Le=2*Le+1;0<Be--;){if(io(b,S,X,Le,Qe))if(Pi(b,S,X,$e))_l(b,S,X);else{var Oe=b,Ye=S,rt=X,At=Oe[Ye-2*rt],Ve=Oe[Ye-rt],it=Oe[Ye+0],ut=Oe[Ye+rt],Ft=Oe[Ye+2*rt],ht=27*(Lt=rc[1020+3*(it-Ve)+rc[1020+At-ut]])+63>>7,Bt=18*Lt+63>>7,Lt=9*Lt+63>>7;Oe[Ye-3*rt]=Sn[255+Oe[Ye-3*rt]+Lt],Oe[Ye-2*rt]=Sn[255+At+Bt],Oe[Ye-rt]=Sn[255+Ve+ht],Oe[Ye+0]=Sn[255+it-ht],Oe[Ye+rt]=Sn[255+ut-Bt],Oe[Ye+2*rt]=Sn[255+Ft-Lt]}S+=de}}function qi(b,S,X,de,Be,Le,Qe,$e){for(Le=2*Le+1;0<Be--;){if(io(b,S,X,Le,Qe))if(Pi(b,S,X,$e))_l(b,S,X);else{var Oe=b,Ye=S,rt=X,At=Oe[Ye-rt],Ve=Oe[Ye+0],it=Oe[Ye+rt],ut=rm[112+(4+(Ft=3*(Ve-At))>>3)],Ft=rm[112+(Ft+3>>3)],ht=ut+1>>1;Oe[Ye-2*rt]=Sn[255+Oe[Ye-2*rt]+ht],Oe[Ye-rt]=Sn[255+At+Ft],Oe[Ye+0]=Sn[255+Ve-ut],Oe[Ye+rt]=Sn[255+it-ht]}S+=de}}function Om(b,S,X,de,Be,Le){Gi(b,S,X,1,16,de,Be,Le)}function Ki(b,S,X,de,Be,Le){Gi(b,S,1,X,16,de,Be,Le)}function zm(b,S,X,de,Be,Le){var Qe;for(Qe=3;0<Qe;--Qe)qi(b,S+=4*X,X,1,16,de,Be,Le)}function G(b,S,X,de,Be,Le){var Qe;for(Qe=3;0<Qe;--Qe)qi(b,S+=4,1,X,16,de,Be,Le)}function ke(b,S,X,de,Be,Le,Qe,$e){Gi(b,S,Be,1,8,Le,Qe,$e),Gi(X,de,Be,1,8,Le,Qe,$e)}function We(b,S,X,de,Be,Le,Qe,$e){Gi(b,S,1,Be,8,Le,Qe,$e),Gi(X,de,1,Be,8,Le,Qe,$e)}function at(b,S,X,de,Be,Le,Qe,$e){qi(b,S+4*Be,Be,1,8,Le,Qe,$e),qi(X,de+4*Be,Be,1,8,Le,Qe,$e)}function ot(b,S,X,de,Be,Le,Qe,$e){qi(b,S+4,1,Be,8,Le,Qe,$e),qi(X,de+4,1,Be,8,Le,Qe,$e)}function Tt(){this.ba=new $t,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ze,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Gt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function As(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function ys(){this.ua=0,this.Wa=new le,this.vb=new le,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new O,this.yc=new te}function Ms(){this.xb=this.a=0,this.l=new Vl,this.ca=new $t,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new ae,this.Pb=0,this.wd=new ae,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new ys,this.ab=0,this.gc=o(4,As),this.Oc=0}function Os(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Vl,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ma(b,S,X,de,Be,Le,Qe){for(b=b==null?0:b[S+0],S=0;S<Qe;++S)Be[Le+S]=b+X[de+S]&255,b=Be[Le+S]}function tr(b,S,X,de,Be,Le,Qe){var $e;if(b==null)ma(null,null,X,de,Be,Le,Qe);else for($e=0;$e<Qe;++$e)Be[Le+$e]=b[S+$e]+X[de+$e]&255}function wr(b,S,X,de,Be,Le,Qe){if(b==null)ma(null,null,X,de,Be,Le,Qe);else{var $e,Oe=b[S+0],Ye=Oe,rt=Oe;for($e=0;$e<Qe;++$e)Ye=rt+(Oe=b[S+$e])-Ye,rt=X[de+$e]+(-256&Ye?0>Ye?0:255:Ye)&255,Ye=Oe,Be[Le+$e]=rt}}function Ia(b,S,X,de){var Be=S.width,Le=S.o;if(s(b!=null&&S!=null),0>X||0>=de||X+de>Le)return null;if(!b.Cc){if(b.ga==null){var Qe;if(b.ga=new Os,(Qe=b.ga==null)||(Qe=S.width*S.o,s(b.Gb.length==0),b.Gb=c(Qe),b.Uc=0,b.Gb==null?Qe=0:(b.mb=b.Gb,b.nb=b.Uc,b.rc=null,Qe=1),Qe=!Qe),!Qe){Qe=b.ga;var $e=b.Fa,Oe=b.P,Ye=b.qc,rt=b.mb,At=b.nb,Ve=Oe+1,it=Ye-1,ut=Qe.l;if(s($e!=null&&rt!=null&&S!=null),nc[0]=null,nc[1]=ma,nc[2]=tr,nc[3]=wr,Qe.ca=rt,Qe.tb=At,Qe.c=S.width,Qe.i=S.height,s(0<Qe.c&&0<Qe.i),1>=Ye)S=0;else if(Qe.$a=3&$e[Oe+0],Qe.Z=$e[Oe+0]>>2&3,Qe.Lc=$e[Oe+0]>>4&3,Oe=$e[Oe+0]>>6&3,0>Qe.$a||1<Qe.$a||4<=Qe.Z||1<Qe.Lc||Oe)S=0;else if(ut.put=Ue,ut.ac=lt,ut.bc=Ct,ut.ma=Qe,ut.width=S.width,ut.height=S.height,ut.Da=S.Da,ut.v=S.v,ut.va=S.va,ut.j=S.j,ut.o=S.o,Qe.$a)e:{s(Qe.$a==1),S=zt();t:for(;;){if(S==null){S=0;break e}if(s(Qe!=null),Qe.mc=S,S.c=Qe.c,S.i=Qe.i,S.l=Qe.l,S.l.ma=Qe,S.l.width=Qe.c,S.l.height=Qe.i,S.a=0,xe(S.m,$e,Ve,it),!is(Qe.c,Qe.i,1,S,null)||(S.ab==1&&S.gc[0].hc==3&&ss(S.s)?(Qe.ic=1,$e=S.c*S.i,S.Ta=null,S.Ua=0,S.V=c($e),S.Ba=0,S.V==null?(S.a=1,S=0):S=1):(Qe.ic=0,S=pa(S,Qe.c)),!S))break t;S=1;break e}Qe.mc=null,S=0}else S=it>=Qe.c*Qe.i;Qe=!S}if(Qe)return null;b.ga.Lc!=1?b.Ga=0:de=Le-X}s(b.ga!=null),s(X+de<=Le);e:{if(S=($e=b.ga).c,Le=$e.l.o,$e.$a==0){if(Ve=b.rc,it=b.Vc,ut=b.Fa,Oe=b.P+1+X*S,Ye=b.mb,rt=b.nb+X*S,s(Oe<=b.P+b.qc),$e.Z!=0)for(s(nc[$e.Z]!=null),Qe=0;Qe<de;++Qe)nc[$e.Z](Ve,it,ut,Oe,Ye,rt,S),Ve=Ye,it=rt,rt+=S,Oe+=S;else for(Qe=0;Qe<de;++Qe)r(Ye,rt,ut,Oe,S),Ve=Ye,it=rt,rt+=S,Oe+=S;b.rc=Ve,b.Vc=it}else{if(s($e.mc!=null),S=X+de,s((Qe=$e.mc)!=null),s(S<=Qe.i),Qe.C>=S)S=1;else if($e.ic||Wl(),$e.ic){$e=Qe.V,Ve=Qe.Ba,it=Qe.c;var Ft=Qe.i,ht=(ut=1,Oe=Qe.$/it,Ye=Qe.$%it,rt=Qe.m,At=Qe.s,Qe.$),Bt=it*Ft,Lt=it*S,Vt=At.wc,Pt=ht<Lt?Xt(At,Ye,Oe):null;s(ht<=Bt),s(S<=Ft),s(ss(At));t:for(;;){for(;!rt.h&&ht<Lt;){if(Ye&Vt||(Pt=Xt(At,Ye,Oe)),s(Pt!=null),oe(rt),256>(Ft=Te(Pt.G[0],Pt.H[0],rt)))$e[Ve+ht]=Ft,++ht,++Ye>=it&&(Ye=0,++Oe<=S&&!(Oe%16)&&Ht(Qe,Oe));else{if(!(280>Ft)){ut=0;break t}Ft=Rs(Ft-256,rt);var fs,cs=Te(Pt.G[4],Pt.H[4],rt);if(oe(rt),!(ht>=(cs=He(it,cs=Rs(cs,rt)))&&Bt-ht>=Ft)){ut=0;break t}for(fs=0;fs<Ft;++fs)$e[Ve+ht+fs]=$e[Ve+ht+fs-cs];for(ht+=Ft,Ye+=Ft;Ye>=it;)Ye-=it,++Oe<=S&&!(Oe%16)&&Ht(Qe,Oe);ht<Lt&&Ye&Vt&&(Pt=Xt(At,Ye,Oe))}s(rt.h==B(rt))}Ht(Qe,Oe>S?S:Oe);break t}!ut||rt.h&&ht<Bt?(ut=0,Qe.a=rt.h?5:3):Qe.$=ht,S=ut}else S=Zt(Qe,Qe.V,Qe.Ba,Qe.c,Qe.i,S,ba);if(!S){de=0;break e}}X+de>=Le&&(b.Cc=1),de=1}if(!de)return null;if(b.Cc&&((de=b.ga)!=null&&(de.mc=null),b.ga=null,0<b.Ga))return alert("todo:WebPDequantizeLevels"),null}return b.nb+X*Be}function qr(b,S,X,de,Be,Le){for(;0<Be--;){var Qe,$e=b,Oe=S+(X?1:0),Ye=b,rt=S+(X?0:3);for(Qe=0;Qe<de;++Qe){var At=Ye[rt+4*Qe];At!=255&&(At*=32897,$e[Oe+4*Qe+0]=$e[Oe+4*Qe+0]*At>>23,$e[Oe+4*Qe+1]=$e[Oe+4*Qe+1]*At>>23,$e[Oe+4*Qe+2]=$e[Oe+4*Qe+2]*At>>23)}S+=Le}}function Fr(b,S,X,de,Be){for(;0<de--;){var Le;for(Le=0;Le<X;++Le){var Qe=b[S+2*Le+0],$e=15&(Ye=b[S+2*Le+1]),Oe=4369*$e,Ye=(240&Ye|Ye>>4)*Oe>>16;b[S+2*Le+0]=(240&Qe|Qe>>4)*Oe>>16&240|(15&Qe|Qe<<4)*Oe>>16>>4&15,b[S+2*Le+1]=240&Ye|$e}S+=Be}}function gn(b,S,X,de,Be,Le,Qe,$e){var Oe,Ye,rt=255;for(Ye=0;Ye<Be;++Ye){for(Oe=0;Oe<de;++Oe){var At=b[S+Oe];Le[Qe+4*Oe]=At,rt&=At}S+=X,Qe+=$e}return rt!=255}function Vi(b,S,X,de,Be){var Le;for(Le=0;Le<Be;++Le)X[de+Le]=b[S+Le]>>8}function Wl(){xo=qr,Sl=Fr,tm=gn,gl=Vi}function Yi(b,S,X){j[b]=function(de,Be,Le,Qe,$e,Oe,Ye,rt,At,Ve,it,ut,Ft,ht,Bt,Lt,Vt){var Pt,fs=Vt-1>>1,cs=$e[Oe+0]|Ye[rt+0]<<16,Hs=At[Ve+0]|it[ut+0]<<16;s(de!=null);var ps=3*cs+Hs+131074>>2;for(S(de[Be+0],255&ps,ps>>16,Ft,ht),Le!=null&&(ps=3*Hs+cs+131074>>2,S(Le[Qe+0],255&ps,ps>>16,Bt,Lt)),Pt=1;Pt<=fs;++Pt){var Zs=$e[Oe+Pt]|Ye[rt+Pt]<<16,Ya=At[Ve+Pt]|it[ut+Pt]<<16,zs=cs+Zs+Hs+Ya+524296,os=zs+2*(Zs+Hs)>>3;ps=os+cs>>1,cs=(zs=zs+2*(cs+Ya)>>3)+Zs>>1,S(de[Be+2*Pt-1],255&ps,ps>>16,Ft,ht+(2*Pt-1)*X),S(de[Be+2*Pt-0],255&cs,cs>>16,Ft,ht+(2*Pt-0)*X),Le!=null&&(ps=zs+Hs>>1,cs=os+Ya>>1,S(Le[Qe+2*Pt-1],255&ps,ps>>16,Bt,Lt+(2*Pt-1)*X),S(Le[Qe+2*Pt+0],255&cs,cs>>16,Bt,Lt+(2*Pt+0)*X)),cs=Zs,Hs=Ya}1&Vt||(ps=3*cs+Hs+131074>>2,S(de[Be+Vt-1],255&ps,ps>>16,Ft,ht+(Vt-1)*X),Le!=null&&(ps=3*Hs+cs+131074>>2,S(Le[Qe+Vt-1],255&ps,ps>>16,Bt,Lt+(Vt-1)*X)))}}function Xd(){jn[Vm]=Ao,jn[kn]=cd,jn[Ym]=xx,jn[kl]=eu,jn[nm]=Tc,jn[nd]=vi,jn[Ec]=Lc,jn[lm]=cd,jn[Wm]=eu,jn[ld]=Tc,jn[Xm]=vi}function Jo(b){return b&-16384?0>b?0:255:b>>tu}function hi(b,S){return Jo((19077*b>>8)+(26149*S>>8)-14234)}function Xl(b,S,X){return Jo((19077*b>>8)-(6419*S>>8)-(13320*X>>8)+8708)}function oo(b,S){return Jo((19077*b>>8)+(33050*S>>8)-17685)}function Wi(b,S,X,de,Be){de[Be+0]=hi(b,X),de[Be+1]=Xl(b,S,X),de[Be+2]=oo(b,S)}function an(b,S,X,de,Be){de[Be+0]=oo(b,S),de[Be+1]=Xl(b,S,X),de[Be+2]=hi(b,X)}function kc(b,S,X,de,Be){var Le=Xl(b,S,X);S=Le<<3&224|oo(b,S)>>3,de[Be+0]=248&hi(b,X)|Le>>5,de[Be+1]=S}function Bc(b,S,X,de,Be){var Le=240&oo(b,S)|15;de[Be+0]=240&hi(b,X)|Xl(b,S,X)>>4,de[Be+1]=Le}function Zo(b,S,X,de,Be){de[Be+0]=255,Wi(b,S,X,de,Be+1)}function pi(b,S,X,de,Be){an(b,S,X,de,Be),de[Be+3]=255}function Rn(b,S,X,de,Be){Wi(b,S,X,de,Be),de[Be+3]=255}function Xi(b,S,X){j[b]=function(de,Be,Le,Qe,$e,Oe,Ye,rt,At){for(var Ve=rt+(-2&At)*X;rt!=Ve;)S(de[Be+0],Le[Qe+0],$e[Oe+0],Ye,rt),S(de[Be+1],Le[Qe+0],$e[Oe+0],Ye,rt+X),Be+=2,++Qe,++Oe,rt+=2*X;1&At&&S(de[Be+0],Le[Qe+0],$e[Oe+0],Ye,rt)}}function ed(b,S,X){return X==0?b==0?S==0?6:5:S==0?4:0:X}function Jd(b,S,X,de,Be){switch(b>>>30){case 3:ac(S,X,de,Be,0);break;case 2:Cn(S,X,de,Be);break;case 1:ya(S,X,de,Be)}}function pl(b,S){var X,de,Be=S.M,Le=S.Nb,Qe=b.oc,$e=b.pc+40,Oe=b.oc,Ye=b.pc+584,rt=b.oc,At=b.pc+600;for(X=0;16>X;++X)Qe[$e+32*X-1]=129;for(X=0;8>X;++X)Oe[Ye+32*X-1]=129,rt[At+32*X-1]=129;for(0<Be?Qe[$e-1-32]=Oe[Ye-1-32]=rt[At-1-32]=129:(l(Qe,$e-32-1,127,21),l(Oe,Ye-32-1,127,9),l(rt,At-32-1,127,9)),de=0;de<b.za;++de){var Ve=S.ya[S.aa+de];if(0<de){for(X=-1;16>X;++X)r(Qe,$e+32*X-4,Qe,$e+32*X+12,4);for(X=-1;8>X;++X)r(Oe,Ye+32*X-4,Oe,Ye+32*X+4,4),r(rt,At+32*X-4,rt,At+32*X+4,4)}var it=b.Gd,ut=b.Hd+de,Ft=Ve.ad,ht=Ve.Hc;if(0<Be&&(r(Qe,$e-32,it[ut].y,0,16),r(Oe,Ye-32,it[ut].f,0,8),r(rt,At-32,it[ut].ea,0,8)),Ve.Za){var Bt=Qe,Lt=$e-32+16;for(0<Be&&(de>=b.za-1?l(Bt,Lt,it[ut].y[15],4):r(Bt,Lt,it[ut+1].y,0,4)),X=0;4>X;X++)Bt[Lt+128+X]=Bt[Lt+256+X]=Bt[Lt+384+X]=Bt[Lt+0+X];for(X=0;16>X;++X,ht<<=2)Bt=Qe,Lt=$e+Sr[X],pr[Ve.Ob[X]](Bt,Lt),Jd(ht,Ft,16*+X,Bt,Lt)}else if(Bt=ed(de,Be,Ve.Ob[0]),In[Bt](Qe,$e),ht!=0)for(X=0;16>X;++X,ht<<=2)Jd(ht,Ft,16*+X,Qe,$e+Sr[X]);for(X=Ve.Gc,Bt=ed(de,Be,Ve.Dd),ti[Bt](Oe,Ye),ti[Bt](rt,At),ht=Ft,Bt=Oe,Lt=Ye,255&(Ve=0|X)&&(170&Ve?Cl(ht,256,Bt,Lt):ua(ht,256,Bt,Lt)),Ve=rt,ht=At,255&(X>>=8)&&(170&X?Cl(Ft,320,Ve,ht):ua(Ft,320,Ve,ht)),Be<b.Ub-1&&(r(it[ut].y,0,Qe,$e+480,16),r(it[ut].f,0,Oe,Ye+224,8),r(it[ut].ea,0,rt,At+224,8)),X=8*Le*b.B,it=b.sa,ut=b.ta+16*de+16*Le*b.R,Ft=b.qa,Ve=b.ra+8*de+X,ht=b.Ha,Bt=b.Ia+8*de+X,X=0;16>X;++X)r(it,ut+X*b.R,Qe,$e+32*X,16);for(X=0;8>X;++X)r(Ft,Ve+X*b.B,Oe,Ye+32*X,8),r(ht,Bt+X*b.B,rt,At+32*X,8)}}function Jl(b,S,X,de,Be,Le,Qe,$e,Oe){var Ye=[0],rt=[0],At=0,Ve=Oe!=null?Oe.kd:0,it=Oe??new Gt;if(b==null||12>X)return 7;it.data=b,it.w=S,it.ha=X,S=[S],X=[X],it.gb=[it.gb];e:{var ut=S,Ft=X,ht=it.gb;if(s(b!=null),s(Ft!=null),s(ht!=null),ht[0]=0,12<=Ft[0]&&!a(b,ut[0],"RIFF")){if(a(b,ut[0]+8,"WEBP")){ht=3;break e}var Bt=st(b,ut[0]+4);if(12>Bt||4294967286<Bt){ht=3;break e}if(Ve&&Bt>Ft[0]-8){ht=7;break e}ht[0]=Bt,ut[0]+=12,Ft[0]-=12}ht=0}if(ht!=0)return ht;for(Bt=0<it.gb[0],X=X[0];;){e:{var Lt=b;Ft=S,ht=X;var Vt=Ye,Pt=rt,fs=ut=[0];if((ps=At=[At])[0]=0,8>ht[0])ht=7;else{if(!a(Lt,Ft[0],"VP8X")){if(st(Lt,Ft[0]+4)!=10){ht=3;break e}if(18>ht[0]){ht=7;break e}var cs=st(Lt,Ft[0]+8),Hs=1+Xe(Lt,Ft[0]+12);if(2147483648<=Hs*(Lt=1+Xe(Lt,Ft[0]+15))){ht=3;break e}fs!=null&&(fs[0]=cs),Vt!=null&&(Vt[0]=Hs),Pt!=null&&(Pt[0]=Lt),Ft[0]+=18,ht[0]-=18,ps[0]=1}ht=0}}if(At=At[0],ut=ut[0],ht!=0)return ht;if(Ft=!!(2&ut),!Bt&&At)return 3;if(Le!=null&&(Le[0]=!!(16&ut)),Qe!=null&&(Qe[0]=Ft),$e!=null&&($e[0]=0),Qe=Ye[0],ut=rt[0],At&&Ft&&Oe==null){ht=0;break}if(4>X){ht=7;break}if(Bt&&At||!Bt&&!At&&!a(b,S[0],"ALPH")){X=[X],it.na=[it.na],it.P=[it.P],it.Sa=[it.Sa];e:{cs=b,ht=S,Bt=X;var ps=it.gb;Vt=it.na,Pt=it.P,fs=it.Sa,Hs=22,s(cs!=null),s(Bt!=null),Lt=ht[0];var Zs=Bt[0];for(s(Vt!=null),s(fs!=null),Vt[0]=null,Pt[0]=null,fs[0]=0;;){if(ht[0]=Lt,Bt[0]=Zs,8>Zs){ht=7;break e}var Ya=st(cs,Lt+4);if(4294967286<Ya){ht=3;break e}var zs=8+Ya+1&-2;if(Hs+=zs,0<ps&&Hs>ps){ht=3;break e}if(!a(cs,Lt,"VP8 ")||!a(cs,Lt,"VP8L")){ht=0;break e}if(Zs[0]<zs){ht=7;break e}a(cs,Lt,"ALPH")||(Vt[0]=cs,Pt[0]=Lt+8,fs[0]=Ya),Lt+=zs,Zs-=zs}}if(X=X[0],it.na=it.na[0],it.P=it.P[0],it.Sa=it.Sa[0],ht!=0)break}X=[X],it.Ja=[it.Ja],it.xa=[it.xa];e:if(ps=b,ht=S,Bt=X,Vt=it.gb[0],Pt=it.Ja,fs=it.xa,cs=ht[0],Lt=!a(ps,cs,"VP8 "),Hs=!a(ps,cs,"VP8L"),s(ps!=null),s(Bt!=null),s(Pt!=null),s(fs!=null),8>Bt[0])ht=7;else{if(Lt||Hs){if(ps=st(ps,cs+4),12<=Vt&&ps>Vt-12){ht=3;break e}if(Ve&&ps>Bt[0]-8){ht=7;break e}Pt[0]=ps,ht[0]+=8,Bt[0]-=8,fs[0]=Hs}else fs[0]=5<=Bt[0]&&ps[cs+0]==47&&!(ps[cs+4]>>5),Pt[0]=Bt[0];ht=0}if(X=X[0],it.Ja=it.Ja[0],it.xa=it.xa[0],S=S[0],ht!=0)break;if(4294967286<it.Ja)return 3;if($e==null||Ft||($e[0]=it.xa?2:1),Qe=[Qe],ut=[ut],it.xa){if(5>X){ht=7;break}$e=Qe,Ve=ut,Ft=Le,b==null||5>X?b=0:5<=X&&b[S+0]==47&&!(b[S+4]>>5)?(Bt=[0],ps=[0],Vt=[0],xe(Pt=new ae,b,S,X),Et(Pt,Bt,ps,Vt)?($e!=null&&($e[0]=Bt[0]),Ve!=null&&(Ve[0]=ps[0]),Ft!=null&&(Ft[0]=Vt[0]),b=1):b=0):b=0}else{if(10>X){ht=7;break}$e=ut,b==null||10>X||!$i(b,S+3,X-3)?b=0:(Ve=b[S+0]|b[S+1]<<8|b[S+2]<<16,Ft=16383&(b[S+7]<<8|b[S+6]),b=16383&(b[S+9]<<8|b[S+8]),1&Ve||3<(Ve>>1&7)||!(Ve>>4&1)||Ve>>5>=it.Ja||!Ft||!b?b=0:(Qe&&(Qe[0]=Ft),$e&&($e[0]=b),b=1))}if(!b||(Qe=Qe[0],ut=ut[0],At&&(Ye[0]!=Qe||rt[0]!=ut)))return 3;Oe!=null&&(Oe[0]=it,Oe.offset=S-Oe.w,s(4294967286>S-Oe.w),s(Oe.offset==Oe.ha-X));break}return ht==0||ht==7&&At&&Oe==null?(Le!=null&&(Le[0]|=it.na!=null&&0<it.na.length),de!=null&&(de[0]=Qe),Be!=null&&(Be[0]=ut),0):ht}function Ji(b,S,X){var de=S.width,Be=S.height,Le=0,Qe=0,$e=de,Oe=Be;if(S.Da=b!=null&&0<b.Da,S.Da&&($e=b.cd,Oe=b.bd,Le=b.v,Qe=b.j,11>X||(Le&=-2,Qe&=-2),0>Le||0>Qe||0>=$e||0>=Oe||Le+$e>de||Qe+Oe>Be))return 0;if(S.v=Le,S.j=Qe,S.va=Le+$e,S.o=Qe+Oe,S.U=$e,S.T=Oe,S.da=b!=null&&0<b.da,S.da){if(!Pe($e,Oe,X=[b.ib],Le=[b.hb]))return 0;S.ib=X[0],S.hb=Le[0]}return S.ob=b!=null&&b.ob,S.Kb=b==null||!b.Sd,S.da&&(S.ob=S.ib<3*de/4&&S.hb<3*Be/4,S.Kb=0),1}function Zd(b){if(b==null)return 2;if(11>b.S){var S=b.f.RGBA;S.fb+=(b.height-1)*S.A,S.A=-S.A}else S=b.f.kb,b=b.height,S.O+=(b-1)*S.fa,S.fa=-S.fa,S.N+=(b-1>>1)*S.Ab,S.Ab=-S.Ab,S.W+=(b-1>>1)*S.Db,S.Db=-S.Db,S.F!=null&&(S.J+=(b-1)*S.lb,S.lb=-S.lb);return 0}function Zl(b,S,X,de){if(de==null||0>=b||0>=S)return 2;if(X!=null){if(X.Da){var Be=X.cd,Le=X.bd,Qe=-2&X.v,$e=-2&X.j;if(0>Qe||0>$e||0>=Be||0>=Le||Qe+Be>b||$e+Le>S)return 2;b=Be,S=Le}if(X.da){if(!Pe(b,S,Be=[X.ib],Le=[X.hb]))return 2;b=Be[0],S=Le[0]}}de.width=b,de.height=S;e:{var Oe=de.width,Ye=de.height;if(b=de.S,0>=Oe||0>=Ye||!(b>=Vm&&13>b))b=2;else{if(0>=de.Rd&&de.sd==null){Qe=Le=Be=S=0;var rt=($e=Oe*au[b])*Ye;if(11>b||(Le=(Ye+1)/2*(S=(Oe+1)/2),b==12&&(Qe=(Be=Oe)*Ye)),(Ye=c(rt+2*Le+Qe))==null){b=1;break e}de.sd=Ye,11>b?((Oe=de.f.RGBA).eb=Ye,Oe.fb=0,Oe.A=$e,Oe.size=rt):((Oe=de.f.kb).y=Ye,Oe.O=0,Oe.fa=$e,Oe.Fd=rt,Oe.f=Ye,Oe.N=0+rt,Oe.Ab=S,Oe.Cd=Le,Oe.ea=Ye,Oe.W=0+rt+Le,Oe.Db=S,Oe.Ed=Le,b==12&&(Oe.F=Ye,Oe.J=0+rt+2*Le),Oe.Tc=Qe,Oe.lb=Be)}if(S=1,Be=de.S,Le=de.width,Qe=de.height,Be>=Vm&&13>Be)if(11>Be)b=de.f.RGBA,S&=($e=Math.abs(b.A))*(Qe-1)+Le<=b.size,S&=$e>=Le*au[Be],S&=b.eb!=null;else{b=de.f.kb,$e=(Le+1)/2,rt=(Qe+1)/2,Oe=Math.abs(b.fa),Ye=Math.abs(b.Ab);var At=Math.abs(b.Db),Ve=Math.abs(b.lb),it=Ve*(Qe-1)+Le;S&=Oe*(Qe-1)+Le<=b.Fd,S&=Ye*(rt-1)+$e<=b.Cd,S=(S&=At*(rt-1)+$e<=b.Ed)&Oe>=Le&Ye>=$e&At>=$e,S&=b.y!=null,S&=b.f!=null,S&=b.ea!=null,Be==12&&(S&=Ve>=Le,S&=it<=b.Tc,S&=b.F!=null)}else S=0;b=S?0:2}}return b!=0||X!=null&&X.fd&&(b=Zd(de)),b}var Fc=64,Kn=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Mn=24,Ai=32,gi=8,Zi=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ye("Predictor0","PredictorAdd0"),j.Predictor0=function(){return 4278190080},j.Predictor1=function(b){return b},j.Predictor2=function(b,S,X){return S[X+0]},j.Predictor3=function(b,S,X){return S[X+1]},j.Predictor4=function(b,S,X){return S[X-1]},j.Predictor5=function(b,S,X){return ve(ve(b,S[X+1]),S[X+0])},j.Predictor6=function(b,S,X){return ve(b,S[X-1])},j.Predictor7=function(b,S,X){return ve(b,S[X+0])},j.Predictor8=function(b,S,X){return ve(S[X-1],S[X+0])},j.Predictor9=function(b,S,X){return ve(S[X+0],S[X+1])},j.Predictor10=function(b,S,X){return ve(ve(b,S[X-1]),ve(S[X+0],S[X+1]))},j.Predictor11=function(b,S,X){var de=S[X+0];return 0>=pe(de>>24&255,b>>24&255,(S=S[X-1])>>24&255)+pe(de>>16&255,b>>16&255,S>>16&255)+pe(de>>8&255,b>>8&255,S>>8&255)+pe(255&de,255&b,255&S)?de:b},j.Predictor12=function(b,S,X){var de=S[X+0];return(ie((b>>24&255)+(de>>24&255)-((S=S[X-1])>>24&255))<<24|ie((b>>16&255)+(de>>16&255)-(S>>16&255))<<16|ie((b>>8&255)+(de>>8&255)-(S>>8&255))<<8|ie((255&b)+(255&de)-(255&S)))>>>0},j.Predictor13=function(b,S,X){var de=S[X-1];return(q((b=ve(b,S[X+0]))>>24&255,de>>24&255)<<24|q(b>>16&255,de>>16&255)<<16|q(b>>8&255,de>>8&255)<<8|q(255&b,255&de))>>>0};var td=j.PredictorAdd0;j.PredictorAdd1=Me,ye("Predictor2","PredictorAdd2"),ye("Predictor3","PredictorAdd3"),ye("Predictor4","PredictorAdd4"),ye("Predictor5","PredictorAdd5"),ye("Predictor6","PredictorAdd6"),ye("Predictor7","PredictorAdd7"),ye("Predictor8","PredictorAdd8"),ye("Predictor9","PredictorAdd9"),ye("Predictor10","PredictorAdd10"),ye("Predictor11","PredictorAdd11"),ye("Predictor12","PredictorAdd12"),ye("Predictor13","PredictorAdd13");var sd=j.PredictorAdd2;Ce("ColorIndexInverseTransform","MapARGB","32b",function(b){return b>>8&255},function(b){return b}),Ce("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(b){return b},function(b){return b>>8&255});var _r,Gm=j.ColorIndexInverseTransform,fi=j.MapARGB,bi=j.VP8LColorIndexInverseTransformAlpha,fn=j.MapAlpha,ec=j.VP8LPredictorsAdd=[];ec.length=16,(j.VP8LPredictors=[]).length=16,(j.VP8LPredictorsAdd_C=[]).length=16,(j.VP8LPredictors_C=[]).length=16;var ad,rd,tc,sc,yi,mo,Al,ac,Cn,Cl,ya,ua,$a,Cr,ji,ei,uo,em,cx,qh,Kh,Vh,ox,dx,xo,Sl,tm,gl,ho=c(511),qm=c(2041),sm=c(225),am=c(767),Km=0,rc=qm,rm=sm,Sn=am,bn=ho,Vm=0,kn=1,Ym=2,kl=3,nm=4,nd=5,Ec=6,lm=7,Wm=8,ld=9,Xm=10,Bl=[2,3,7],id=[3,3,11],po=[280,256,256,256,40],Jm=[0,1,1,1,0],im=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Fl=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],El=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Dc=8,Dl=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Ul=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],fl=null,Yh=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],mx=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Zm=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Wh=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],yn=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Va=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],ea=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],In=[],pr=[],ti=[],Uc=1,ux=2,nc=[],jn=[];Yi("UpsampleRgbLinePair",Wi,3),Yi("UpsampleBgrLinePair",an,3),Yi("UpsampleRgbaLinePair",Rn,4),Yi("UpsampleBgraLinePair",pi,4),Yi("UpsampleArgbLinePair",Zo,4),Yi("UpsampleRgba4444LinePair",Bc,2),Yi("UpsampleRgb565LinePair",kc,2);var Ao=j.UpsampleRgbLinePair,xx=j.UpsampleBgrLinePair,cd=j.UpsampleRgbaLinePair,eu=j.UpsampleBgraLinePair,Tc=j.UpsampleArgbLinePair,vi=j.UpsampleRgba4444LinePair,Lc=j.UpsampleRgb565LinePair,Tl=16,od=1<<Tl-1,go=-227,Qc=482,tu=6,Rc=0,vn=c(256),su=c(256),Xh=c(256),Rg=c(256),Mg=c(Qc-go),Ig=c(Qc-go);Xi("YuvToRgbRow",Wi,3),Xi("YuvToBgrRow",an,3),Xi("YuvToRgbaRow",Rn,4),Xi("YuvToBgraRow",pi,4),Xi("YuvToArgbRow",Zo,4),Xi("YuvToRgba4444Row",Bc,2),Xi("YuvToRgb565Row",kc,2);var Sr=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],dd=[0,2,8],cm=[8,7,6,4,4,2,2,2,1,1,1,1],om=1;this.WebPDecodeRGBA=function(b,S,X,de,Be){var Le=kn,Qe=new Tt,$e=new $t;Qe.ba=$e,$e.S=Le,$e.width=[$e.width],$e.height=[$e.height];var Oe=$e.width,Ye=$e.height,rt=new me;if(rt==null||b==null)var At=2;else s(rt!=null),At=Jl(b,S,X,rt.width,rt.height,rt.Pd,rt.Qd,rt.format,null);if(At!=0?Oe=0:(Oe!=null&&(Oe[0]=rt.width[0]),Ye!=null&&(Ye[0]=rt.height[0]),Oe=1),Oe){$e.width=$e.width[0],$e.height=$e.height[0],de!=null&&(de[0]=$e.width),Be!=null&&(Be[0]=$e.height);e:{if(de=new Vl,(Be=new Gt).data=b,Be.w=S,Be.ha=X,Be.kd=1,S=[0],s(Be!=null),((b=Jl(Be.data,Be.w,Be.ha,null,null,null,S,null,Be))==0||b==7)&&S[0]&&(b=4),(S=b)==0){if(s(Qe!=null),de.data=Be.data,de.w=Be.w+Be.offset,de.ha=Be.ha-Be.offset,de.put=Ue,de.ac=lt,de.bc=Ct,de.ma=Qe,Be.xa){if((b=zt())==null){Qe=1;break e}if((function(Ve,it){var ut=[0],Ft=[0],ht=[0];t:for(;;){if(Ve==null)return 0;if(it==null)return Ve.a=2,0;if(Ve.l=it,Ve.a=0,xe(Ve.m,it.data,it.w,it.ha),!Et(Ve.m,ut,Ft,ht)){Ve.a=3;break t}if(Ve.xb=ux,it.width=ut[0],it.height=Ft[0],!is(ut[0],Ft[0],1,Ve,null))break t;return 1}return s(Ve.a!=0),0})(b,de)){if(de=(S=Zl(de.width,de.height,Qe.Oa,Qe.ba))==0){t:{de=b;s:for(;;){if(de==null){de=0;break t}if(s(de.s.yc!=null),s(de.s.Ya!=null),s(0<de.s.Wb),s((X=de.l)!=null),s((Be=X.ma)!=null),de.xb!=0){if(de.ca=Be.ba,de.tb=Be.tb,s(de.ca!=null),!Ji(Be.Oa,X,kl)){de.a=2;break s}if(!pa(de,X.width)||X.da)break s;if((X.da||J(de.ca.S))&&Wl(),11>de.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),de.ca.f.kb.F!=null&&Wl()),de.Pb&&0<de.s.ua&&de.s.vb.X==null&&!ce(de.s.vb,de.s.Wa.Xa)){de.a=1;break s}de.xb=0}if(!Zt(de,de.V,de.Ba,de.c,de.i,X.o,Ts))break s;Be.Dc=de.Ma,de=1;break t}s(de.a!=0),de=0}de=!de}de&&(S=b.a)}else S=b.a}else{if((b=new dl)==null){Qe=1;break e}if(b.Fa=Be.na,b.P=Be.P,b.qc=Be.Sa,Nl(b,de)){if((S=Zl(de.width,de.height,Qe.Oa,Qe.ba))==0){if(b.Aa=0,X=Qe.Oa,s((Be=b)!=null),X!=null){if(0<(Oe=0>(Oe=X.Md)?0:100<Oe?255:255*Oe/100)){for(Ye=rt=0;4>Ye;++Ye)12>(At=Be.pb[Ye]).lc&&(At.ia=Oe*cm[0>At.lc?0:At.lc]>>3),rt|=At.ia;rt&&(alert("todo:VP8InitRandom"),Be.ia=1)}Be.Ga=X.Id,100<Be.Ga?Be.Ga=100:0>Be.Ga&&(Be.Ga=0)}(function(Ve,it){if(Ve==null)return 0;if(it==null)return da(Ve,2,"NULL VP8Io parameter in VP8Decode().");if(!Ve.cb&&!Nl(Ve,it))return 0;if(s(Ve.cb),it.ac==null||it.ac(it)){it.ob&&(Ve.L=0);var ut=dd[Ve.L];if(Ve.L==2?(Ve.yb=0,Ve.zb=0):(Ve.yb=it.v-ut>>4,Ve.zb=it.j-ut>>4,0>Ve.yb&&(Ve.yb=0),0>Ve.zb&&(Ve.zb=0)),Ve.Va=it.o+15+ut>>4,Ve.Hb=it.va+15+ut>>4,Ve.Hb>Ve.za&&(Ve.Hb=Ve.za),Ve.Va>Ve.Ub&&(Ve.Va=Ve.Ub),0<Ve.L){var Ft=Ve.ed;for(ut=0;4>ut;++ut){var ht;if(Ve.Qa.Cb){var Bt=Ve.Qa.Lb[ut];Ve.Qa.Fb||(Bt+=Ft.Tb)}else Bt=Ft.Tb;for(ht=0;1>=ht;++ht){var Lt=Ve.gd[ut][ht],Vt=Bt;if(Ft.Pc&&(Vt+=Ft.vd[0],ht&&(Vt+=Ft.od[0])),0<(Vt=0>Vt?0:63<Vt?63:Vt)){var Pt=Vt;0<Ft.wb&&(Pt=4<Ft.wb?Pt>>2:Pt>>1)>9-Ft.wb&&(Pt=9-Ft.wb),1>Pt&&(Pt=1),Lt.dd=Pt,Lt.tc=2*Vt+Pt,Lt.ld=40<=Vt?2:15<=Vt?1:0}else Lt.tc=0;Lt.La=ht}}}ut=0}else da(Ve,6,"Frame setup failed"),ut=Ve.a;if(ut=ut==0){if(ut){Ve.$c=0,0<Ve.Aa||(Ve.Ic=om);t:{ut=Ve.Ic,Ft=4*(Pt=Ve.za);var fs=32*Pt,cs=Pt+1,Hs=0<Ve.L?Pt*(0<Ve.Aa?2:1):0,ps=(Ve.Aa==2?2:1)*Pt;if((Lt=Ft+832+(ht=3*(16*ut+dd[Ve.L])/2*fs)+(Bt=Ve.Fa!=null&&0<Ve.Fa.length?Ve.Kc.c*Ve.Kc.i:0))!=Lt)ut=0;else{if(Lt>Ve.Vb){if(Ve.Vb=0,Ve.Ec=c(Lt),Ve.Fc=0,Ve.Ec==null){ut=da(Ve,1,"no memory during frame initialization.");break t}Ve.Vb=Lt}Lt=Ve.Ec,Vt=Ve.Fc,Ve.Ac=Lt,Ve.Bc=Vt,Vt+=Ft,Ve.Gd=o(fs,Kl),Ve.Hd=0,Ve.rb=o(cs+1,es),Ve.sb=1,Ve.wa=Hs?o(Hs,Ae):null,Ve.Y=0,Ve.D.Nb=0,Ve.D.wa=Ve.wa,Ve.D.Y=Ve.Y,0<Ve.Aa&&(Ve.D.Y+=Pt),s(!0),Ve.oc=Lt,Ve.pc=Vt,Vt+=832,Ve.ya=o(ps,Da),Ve.aa=0,Ve.D.ya=Ve.ya,Ve.D.aa=Ve.aa,Ve.Aa==2&&(Ve.D.aa+=Pt),Ve.R=16*Pt,Ve.B=8*Pt,Pt=(fs=dd[Ve.L])*Ve.R,fs=fs/2*Ve.B,Ve.sa=Lt,Ve.ta=Vt+Pt,Ve.qa=Ve.sa,Ve.ra=Ve.ta+16*ut*Ve.R+fs,Ve.Ha=Ve.qa,Ve.Ia=Ve.ra+8*ut*Ve.B+fs,Ve.$c=0,Vt+=ht,Ve.mb=Bt?Lt:null,Ve.nb=Bt?Vt:null,s(Vt+Bt<=Ve.Fc+Ve.Vb),to(Ve),l(Ve.Ac,Ve.Bc,0,Ft),ut=1}}if(ut){if(it.ka=0,it.y=Ve.sa,it.O=Ve.ta,it.f=Ve.qa,it.N=Ve.ra,it.ea=Ve.Ha,it.Vd=Ve.Ia,it.fa=Ve.R,it.Rc=Ve.B,it.F=null,it.J=0,!Km){for(ut=-255;255>=ut;++ut)ho[255+ut]=0>ut?-ut:ut;for(ut=-1020;1020>=ut;++ut)qm[1020+ut]=-128>ut?-128:127<ut?127:ut;for(ut=-112;112>=ut;++ut)sm[112+ut]=-16>ut?-16:15<ut?15:ut;for(ut=-255;510>=ut;++ut)am[255+ut]=0>ut?0:255<ut?255:ut;Km=1}Al=ml,ac=Cc,Cl=Gr,ya=so,ua=ao,Cn=Vo,$a=Om,Cr=Ki,ji=ke,ei=We,uo=zm,em=G,cx=at,qh=ot,Kh=Oi,Vh=zi,ox=co,dx=Wd,pr[0]=Hm,pr[1]=vt,pr[2]=$m,pr[3]=Vd,pr[4]=xl,pr[5]=Yd,pr[6]=An,pr[7]=no,pr[8]=lo,pr[9]=hl,In[0]=Yl,In[1]=xr,In[2]=ul,In[3]=hr,In[4]=Hi,In[5]=ro,In[6]=Sc,ti[0]=Yo,ti[1]=Ss,ti[2]=ui,ti[3]=Pm,ti[4]=sn,ti[5]=Wo,ti[6]=xi,ut=1}else ut=0}ut&&(ut=(function(Zs,Ya){for(Zs.M=0;Zs.M<Zs.Va;++Zs.M){var zs,os=Zs.Jc[Zs.M&Zs.Xb],ts=Zs.m,sr=Zs;for(zs=0;zs<sr.za;++zs){var Ds=ts,Ks=sr,Ba=Ks.Ac,Kr=Ks.Bc+4*zs,Nn=Ks.zc,Ha=Ks.ya[Ks.aa+zs];if(Ks.Qa.Bb?Ha.$b=je(Ds,Ks.Pa.jb[0])?2+je(Ds,Ks.Pa.jb[2]):je(Ds,Ks.Pa.jb[1]):Ha.$b=0,Ks.kc&&(Ha.Ad=je(Ds,Ks.Bd)),Ha.Za=!je(Ds,145)+0,Ha.Za){var Er=Ha.Ob,Bn=0;for(Ks=0;4>Ks;++Ks){var Dr,Xs=Nn[0+Ks];for(Dr=0;4>Dr;++Dr){Xs=yn[Ba[Kr+Dr]][Xs];for(var Aa=Zm[je(Ds,Xs[0])];0<Aa;)Aa=Zm[2*Aa+je(Ds,Xs[Aa])];Xs=-Aa,Ba[Kr+Dr]=Xs}r(Er,Bn,Ba,Kr,4),Bn+=4,Nn[0+Ks]=Xs}}else Xs=je(Ds,156)?je(Ds,128)?1:3:je(Ds,163)?2:0,Ha.Ob[0]=Xs,l(Ba,Kr,Xs,4),l(Nn,0,Xs,4);Ha.Dd=je(Ds,142)?je(Ds,114)?je(Ds,183)?1:3:2:0}if(sr.m.Ka)return da(Zs,7,"Premature end-of-partition0 encountered.");for(;Zs.ja<Zs.za;++Zs.ja){if(sr=os,Ds=(ts=Zs).rb[ts.sb-1],Ba=ts.rb[ts.sb+ts.ja],zs=ts.ya[ts.aa+ts.ja],Kr=ts.kc?zs.Ad:0)Ds.la=Ba.la=0,zs.Za||(Ds.Na=Ba.Na=0),zs.Hc=0,zs.Gc=0,zs.ia=0;else{var ar,ja;if(Ds=Ba,Ba=sr,Kr=ts.Pa.Xc,Nn=ts.ya[ts.aa+ts.ja],Ha=ts.pb[Nn.$b],Ks=Nn.ad,Er=0,Bn=ts.rb[ts.sb-1],Xs=Dr=0,l(Ks,Er,0,384),Nn.Za)var Vr=0,rr=Kr[3];else{Aa=c(16);var ga=Ds.Na+Bn.Na;if(ga=fl(Ba,Kr[1],ga,Ha.Eb,0,Aa,0),Ds.Na=Bn.Na=(0<ga)+0,1<ga)Al(Aa,0,Ks,Er);else{var kr=Aa[0]+3>>3;for(Aa=0;256>Aa;Aa+=16)Ks[Er+Aa]=kr}Vr=1,rr=Kr[0]}var Fa=15&Ds.la,Ur=15&Bn.la;for(Aa=0;4>Aa;++Aa){var Tr=1&Ur;for(kr=ja=0;4>kr;++kr)Fa=Fa>>1|(Tr=(ga=fl(Ba,rr,ga=Tr+(1&Fa),Ha.Sc,Vr,Ks,Er))>Vr)<<7,ja=ja<<2|(3<ga?3:1<ga?2:Ks[Er+0]!=0),Er+=16;Fa>>=4,Ur=Ur>>1|Tr<<7,Dr=(Dr<<8|ja)>>>0}for(rr=Fa,Vr=Ur>>4,ar=0;4>ar;ar+=2){for(ja=0,Fa=Ds.la>>4+ar,Ur=Bn.la>>4+ar,Aa=0;2>Aa;++Aa){for(Tr=1&Ur,kr=0;2>kr;++kr)ga=Tr+(1&Fa),Fa=Fa>>1|(Tr=0<(ga=fl(Ba,Kr[2],ga,Ha.Qc,0,Ks,Er)))<<3,ja=ja<<2|(3<ga?3:1<ga?2:Ks[Er+0]!=0),Er+=16;Fa>>=2,Ur=Ur>>1|Tr<<5}Xs|=ja<<4*ar,rr|=Fa<<4<<ar,Vr|=(240&Ur)<<ar}Ds.la=rr,Bn.la=Vr,Nn.Hc=Dr,Nn.Gc=Xs,Nn.ia=43690&Xs?0:Ha.ia,Kr=!(Dr|Xs)}if(0<ts.L&&(ts.wa[ts.Y+ts.ja]=ts.gd[zs.$b][zs.Za],ts.wa[ts.Y+ts.ja].La|=!Kr),sr.Ka)return da(Zs,7,"Premature end-of-file encountered.")}if(to(Zs),ts=Ya,sr=1,zs=(os=Zs).D,Ds=0<os.L&&os.M>=os.zb&&os.M<=os.Va,os.Aa==0)t:{if(zs.M=os.M,zs.uc=Ds,pl(os,zs),sr=1,zs=(ja=os.D).Nb,Ds=(Xs=dd[os.L])*os.R,Ba=Xs/2*os.B,Aa=16*zs*os.R,kr=8*zs*os.B,Kr=os.sa,Nn=os.ta-Ds+Aa,Ha=os.qa,Ks=os.ra-Ba+kr,Er=os.Ha,Bn=os.Ia-Ba+kr,Ur=(Fa=ja.M)==0,Dr=Fa>=os.Va-1,os.Aa==2&&pl(os,ja),ja.uc)for(Tr=(ga=os).D.M,s(ga.D.uc),ja=ga.yb;ja<ga.Hb;++ja){Vr=ja,rr=Tr;var Ta=(xa=(Lr=ga).D).Nb;ar=Lr.R;var xa=xa.wa[xa.Y+Vr],Fn=Lr.sa,Ar=Lr.ta+16*Ta*ar+16*Vr,Cs=xa.dd,ks=xa.tc;if(ks!=0)if(s(3<=ks),Lr.L==1)0<Vr&&Vh(Fn,Ar,ar,ks+4),xa.La&&dx(Fn,Ar,ar,ks),0<rr&&Kh(Fn,Ar,ar,ks+4),xa.La&&ox(Fn,Ar,ar,ks);else{var fa=Lr.B,Vn=Lr.qa,Ll=Lr.ra+8*Ta*fa+8*Vr,$n=Lr.Ha,Lr=Lr.Ia+8*Ta*fa+8*Vr;Ta=xa.ld,0<Vr&&(Cr(Fn,Ar,ar,ks+4,Cs,Ta),ei(Vn,Ll,$n,Lr,fa,ks+4,Cs,Ta)),xa.La&&(em(Fn,Ar,ar,ks,Cs,Ta),qh(Vn,Ll,$n,Lr,fa,ks,Cs,Ta)),0<rr&&($a(Fn,Ar,ar,ks+4,Cs,Ta),ji(Vn,Ll,$n,Lr,fa,ks+4,Cs,Ta)),xa.La&&(uo(Fn,Ar,ar,ks,Cs,Ta),cx(Vn,Ll,$n,Lr,fa,ks,Cs,Ta))}}if(os.ia&&alert("todo:DitherRow"),ts.put!=null){if(ja=16*Fa,Fa=16*(Fa+1),Ur?(ts.y=os.sa,ts.O=os.ta+Aa,ts.f=os.qa,ts.N=os.ra+kr,ts.ea=os.Ha,ts.W=os.Ia+kr):(ja-=Xs,ts.y=Kr,ts.O=Nn,ts.f=Ha,ts.N=Ks,ts.ea=Er,ts.W=Bn),Dr||(Fa-=Xs),Fa>ts.o&&(Fa=ts.o),ts.F=null,ts.J=null,os.Fa!=null&&0<os.Fa.length&&ja<Fa&&(ts.J=Ia(os,ts,ja,Fa-ja),ts.F=os.mb,ts.F==null&&ts.F.length==0)){sr=da(os,3,"Could not decode alpha data.");break t}ja<ts.j&&(Xs=ts.j-ja,ja=ts.j,s(!(1&Xs)),ts.O+=os.R*Xs,ts.N+=os.B*(Xs>>1),ts.W+=os.B*(Xs>>1),ts.F!=null&&(ts.J+=ts.width*Xs)),ja<Fa&&(ts.O+=ts.v,ts.N+=ts.v>>1,ts.W+=ts.v>>1,ts.F!=null&&(ts.J+=ts.v),ts.ka=ja-ts.j,ts.U=ts.va-ts.v,ts.T=Fa-ja,sr=ts.put(ts))}zs+1!=os.Ic||Dr||(r(os.sa,os.ta-Ds,Kr,Nn+16*os.R,Ds),r(os.qa,os.ra-Ba,Ha,Ks+8*os.B,Ba),r(os.Ha,os.Ia-Ba,Er,Bn+8*os.B,Ba))}if(!sr)return da(Zs,6,"Output aborted.")}return 1})(Ve,it)),it.bc!=null&&it.bc(it),ut&=1}return ut?(Ve.cb=0,ut):0})(b,de)||(S=b.a)}}else S=b.a}S==0&&Qe.Oa!=null&&Qe.Oa.fd&&(S=Zd(Qe.ba))}Qe=S}Le=Qe!=0?null:11>Le?$e.f.RGBA.eb:$e.f.kb.y}else Le=null;return Le};var au=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function x(j,T){for(var Q="",E=0;E<4;E++)Q+=String.fromCharCode(j[T++]);return Q}function A(j,T){return j[T+0]|j[T+1]<<8}function g(j,T){return(j[T+0]|j[T+1]<<8|j[T+2]<<16)>>>0}function N(j,T){return(j[T+0]|j[T+1]<<8|j[T+2]<<16|j[T+3]<<24)>>>0}new u;var f=[0],y=[0],v=[],U=new u,D=t,M=(function(j,T){var Q={},E=0,te=!1,C=0,O=0;if(Q.frames=[],!(function(H,ae){for(var k=0;k<4;k++)if(H[ae+k]!="RIFF".charCodeAt(k))return!0;return!1})(j,T)){for(N(j,T+=4),T+=8;T<j.length;){var V=x(j,T),re=N(j,T+=4);T+=4;var ge=re+(1&re);switch(V){case"VP8 ":case"VP8L":Q.frames[E]===void 0&&(Q.frames[E]={}),(I=Q.frames[E]).src_off=te?O:T-8,I.src_size=C+re+8,E++,te&&(te=!1,C=0,O=0);break;case"VP8X":(I=Q.header={}).feature_flags=j[T];var xe=T+4;I.canvas_width=1+g(j,xe),xe+=3,I.canvas_height=1+g(j,xe),xe+=3;break;case"ALPH":te=!0,C=ge+8,O=T-8;break;case"ANIM":(I=Q.header).bgcolor=N(j,T),xe=T+4,I.loop_count=A(j,xe),xe+=2;break;case"ANMF":var Z,I;(I=Q.frames[E]={}).offset_x=2*g(j,T),T+=3,I.offset_y=2*g(j,T),T+=3,I.width=1+g(j,T),T+=3,I.height=1+g(j,T),T+=3,I.duration=g(j,T),T+=3,Z=j[T++],I.dispose=1&Z,I.blend=Z>>1&1}V!="ANMF"&&(T+=ge)}return Q}})(D,0);M.response=D,M.rgbaoutput=!0,M.dataurl=!1;var K=M.header?M.header:null,$=M.frames?M.frames:null;if(K){K.loop_counter=K.loop_count,f=[K.canvas_height],y=[K.canvas_width];for(var P=0;P<$.length&&$[P].blend!=0;P++);}var se=$[0],z=U.WebPDecodeRGBA(D,se.src_off,se.src_size,y,f);se.rgba=z,se.imgwidth=y[0],se.imgheight=f[0];for(var R=0;R<y[0]*f[0]*4;R++)v[R]=z[R];return this.width=y,this.height=f,this.data=v,this}(function(t){var s,a,r,l,c,o,m,u,x,A=function(H){return H=H||{},this.isStrokeTransparent=H.isStrokeTransparent||!1,this.strokeOpacity=H.strokeOpacity||1,this.strokeStyle=H.strokeStyle||"#000000",this.fillStyle=H.fillStyle||"#000000",this.isFillTransparent=H.isFillTransparent||!1,this.fillOpacity=H.fillOpacity||1,this.font=H.font||"10px sans-serif",this.textBaseline=H.textBaseline||"alphabetic",this.textAlign=H.textAlign||"left",this.lineWidth=H.lineWidth||1,this.lineJoin=H.lineJoin||"miter",this.lineCap=H.lineCap||"butt",this.path=H.path||[],this.transform=H.transform!==void 0?H.transform.clone():new u,this.globalCompositeOperation=H.globalCompositeOperation||"normal",this.globalAlpha=H.globalAlpha||1,this.clip_path=H.clip_path||[],this.currentPoint=H.currentPoint||new o,this.miterLimit=H.miterLimit||10,this.lastPoint=H.lastPoint||new o,this.lineDashOffset=H.lineDashOffset||0,this.lineDash=H.lineDash||[],this.margin=H.margin||[0,0,0,0],this.prevPageLastElemOffset=H.prevPageLastElemOffset||0,this.ignoreClearRect=typeof H.ignoreClearRect!="boolean"||H.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new g(this),s=this.internal.f2,a=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,l=this.internal.getHorizontalCoordinate,c=this.internal.getVerticalCoordinate,o=this.internal.Point,m=this.internal.Rectangle,u=this.internal.Matrix,x=new A}]);var g=function(H){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var ae=H;Object.defineProperty(this,"pdf",{get:function(){return ae}});var k=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return k},set:function(ce){k=!!ce}});var B=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return B},set:function(ce){B=!!ce}});var w=0;Object.defineProperty(this,"posX",{get:function(){return w},set:function(ce){isNaN(ce)||(w=ce)}});var oe=0;Object.defineProperty(this,"posY",{get:function(){return oe},set:function(ce){isNaN(ce)||(oe=ce)}}),Object.defineProperty(this,"margin",{get:function(){return x.margin},set:function(ce){var _e;typeof ce=="number"?_e=[ce,ce,ce,ce]:((_e=new Array(4))[0]=ce[0],_e[1]=ce.length>=2?ce[1]:_e[0],_e[2]=ce.length>=3?ce[2]:_e[0],_e[3]=ce.length>=4?ce[3]:_e[1]),x.margin=_e}});var ne=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ne},set:function(ce){ne=ce}});var Fe=0;Object.defineProperty(this,"lastBreak",{get:function(){return Fe},set:function(ce){Fe=ce}});var je=[];Object.defineProperty(this,"pageBreaks",{get:function(){return je},set:function(ce){je=ce}}),Object.defineProperty(this,"ctx",{get:function(){return x},set:function(ce){ce instanceof A&&(x=ce)}}),Object.defineProperty(this,"path",{get:function(){return x.path},set:function(ce){x.path=ce}});var Ge=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ge},set:function(ce){Ge=ce}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ce){var _e;_e=N(ce),this.ctx.fillStyle=_e.style,this.ctx.isFillTransparent=_e.a===0,this.ctx.fillOpacity=_e.a,this.pdf.setFillColor(_e.r,_e.g,_e.b,{a:_e.a}),this.pdf.setTextColor(_e.r,_e.g,_e.b,{a:_e.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ce){var _e=N(ce);this.ctx.strokeStyle=_e.style,this.ctx.isStrokeTransparent=_e.a===0,this.ctx.strokeOpacity=_e.a,_e.a===0?this.pdf.setDrawColor(255,255,255):(_e.a,this.pdf.setDrawColor(_e.r,_e.g,_e.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ce){["butt","round","square"].indexOf(ce)!==-1&&(this.ctx.lineCap=ce,this.pdf.setLineCap(ce))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ce){isNaN(ce)||(this.ctx.lineWidth=ce,this.pdf.setLineWidth(ce))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ce){["bevel","round","miter"].indexOf(ce)!==-1&&(this.ctx.lineJoin=ce,this.pdf.setLineJoin(ce))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ce){isNaN(ce)||(this.ctx.miterLimit=ce,this.pdf.setMiterLimit(ce))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ce){this.ctx.textBaseline=ce}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ce){["right","end","center","left","start"].indexOf(ce)!==-1&&(this.ctx.textAlign=ce)}});var ze=null,Xe=null,st=null;Object.defineProperty(this,"fontFaces",{get:function(){return st},set:function(ce){ze=null,Xe=null,st=ce}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ce){var _e;if(this.ctx.font=ce,(_e=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(ce))!==null){var le=_e[1];_e[2];var Pe=_e[3],we=_e[4];_e[5];var fe=_e[6],ye=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(we)[2];we=Math.floor(ye==="px"?parseFloat(we)*this.pdf.internal.scaleFactor:ye==="em"?parseFloat(we)*this.pdf.getFontSize():parseFloat(we)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(we);var Ke=(function(Ce){var ft,qe,W=[],Ie=Ce.trim();if(Ie==="")return Cf;if(Ie in zw)return[zw[Ie]];for(;Ie!=="";){switch(qe=null,ft=(Ie=qw(Ie)).charAt(0)){case'"':case"'":qe=nU(Ie.substring(1),ft);break;default:qe=lU(Ie)}if(qe===null||(W.push(qe[0]),(Ie=qw(qe[1]))!==""&&Ie.charAt(0)!==","))return Cf;Ie=Ie.replace(/^,/,"")}return W})(fe);if(this.fontFaces){var ve=(function(Ce,ft){var qe=Ce.getFontList(),W=JSON.stringify(qe);if(ze===null||Xe!==W){var Ie=(function(mt){var pt=[];return Object.keys(mt).forEach(function(kt){mt[kt].forEach(function(J){var Je=null;switch(J){case"bold":Je={family:kt,weight:"bold"};break;case"italic":Je={family:kt,style:"italic"};break;case"bolditalic":Je={family:kt,weight:"bold",style:"italic"};break;case"":case"normal":Je={family:kt}}Je!==null&&(Je.ref={name:kt,style:J},pt.push(Je))})}),pt})(qe);ze=(function(mt){for(var pt={},kt=0;kt<mt.length;++kt){var J=_f(mt[kt]),Je=J.family,_t=J.stretch,$t=J.style,me=J.weight;pt[Je]=pt[Je]||{},pt[Je][_t]=pt[Je][_t]||{},pt[Je][_t][$t]=pt[Je][_t][$t]||{},pt[Je][_t][$t][me]=J}return pt})(Ie.concat(ft)),Xe=W}return ze})(this.pdf,this.fontFaces),ie=Ke.map(function(Ce){return{family:Ce,stretch:"normal",weight:Pe,style:le}}),q=(function(Ce,ft,qe){for(var W=(qe=qe||{}).defaultFontFamily||"times",Ie=Object.assign({},rU,qe.genericFontFamilies||{}),mt=null,pt=null,kt=0;kt<ft.length;++kt)if(Ie[(mt=_f(ft[kt])).family]&&(mt.family=Ie[mt.family]),Ce.hasOwnProperty(mt.family)){pt=Ce[mt.family];break}if(!(pt=pt||Ce[W]))throw new Error("Could not find a font-family for the rule '"+Gw(mt)+"' and default family '"+W+"'.");if(pt=(function(J,Je){if(Je[J])return Je[J];var _t=kb[J],$t=_t<=kb.normal?-1:1,me=Ow(Je,s5,_t,$t);if(!me)throw new Error("Could not find a matching font-stretch value for "+J);return me})(mt.stretch,pt),pt=(function(J,Je){if(Je[J])return Je[J];for(var _t=t5[J],$t=0;$t<_t.length;++$t)if(Je[_t[$t]])return Je[_t[$t]];throw new Error("Could not find a matching font-style for "+J)})(mt.style,pt),!(pt=(function(J,Je){if(Je[J])return Je[J];if(J===400&&Je[500])return Je[500];if(J===500&&Je[400])return Je[400];var _t=aU[J],$t=Ow(Je,a5,_t,J<400?-1:1);if(!$t)throw new Error("Could not find a matching font-weight for value "+J);return $t})(mt.weight,pt)))throw new Error("Failed to resolve a font for the rule '"+Gw(mt)+"'.");return pt})(ve,ie);this.pdf.setFont(q.ref.name,q.ref.style)}else{var pe="";(Pe==="bold"||parseInt(Pe,10)>=700||le==="bold")&&(pe="bold"),le==="italic"&&(pe+="italic"),pe.length===0&&(pe="normal");for(var Me="",Se={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ne=0;Ne<Ke.length;Ne++){if(this.pdf.internal.getFont(Ke[Ne],pe,{noFallback:!0,disableWarning:!0})!==void 0){Me=Ke[Ne];break}if(pe==="bolditalic"&&this.pdf.internal.getFont(Ke[Ne],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Me=Ke[Ne],pe="bold";else if(this.pdf.internal.getFont(Ke[Ne],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Me=Ke[Ne],pe="normal";break}}if(Me===""){for(var et=0;et<Ke.length;et++)if(Se[Ke[et]]){Me=Se[Ke[et]];break}}Me=Me===""?"Times":Me,this.pdf.setFont(Me,pe)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ce){this.ctx.globalCompositeOperation=ce}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ce){this.ctx.globalAlpha=ce}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ce){this.ctx.lineDashOffset=ce,I.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ce){this.ctx.lineDash=ce,I.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ce){this.ctx.ignoreClearRect=!!ce}})};g.prototype.setLineDash=function(H){this.lineDash=H},g.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},g.prototype.fill=function(){$.call(this,"fill",!1)},g.prototype.stroke=function(){$.call(this,"stroke",!1)},g.prototype.beginPath=function(){this.path=[{type:"begin"}]},g.prototype.moveTo=function(H,ae){if(isNaN(H)||isNaN(ae))throw Ja.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var k=this.ctx.transform.applyToPoint(new o(H,ae));this.path.push({type:"mt",x:k.x,y:k.y}),this.ctx.lastPoint=new o(H,ae)},g.prototype.closePath=function(){var H=new o(0,0),ae=0;for(ae=this.path.length-1;ae!==-1;ae--)if(this.path[ae].type==="begin"&&Ra(this.path[ae+1])==="object"&&typeof this.path[ae+1].x=="number"){H=new o(this.path[ae+1].x,this.path[ae+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(H.x,H.y)},g.prototype.lineTo=function(H,ae){if(isNaN(H)||isNaN(ae))throw Ja.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var k=this.ctx.transform.applyToPoint(new o(H,ae));this.path.push({type:"lt",x:k.x,y:k.y}),this.ctx.lastPoint=new o(k.x,k.y)},g.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),$.call(this,null,!0)},g.prototype.quadraticCurveTo=function(H,ae,k,B){if(isNaN(k)||isNaN(B)||isNaN(H)||isNaN(ae))throw Ja.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var w=this.ctx.transform.applyToPoint(new o(k,B)),oe=this.ctx.transform.applyToPoint(new o(H,ae));this.path.push({type:"qct",x1:oe.x,y1:oe.y,x:w.x,y:w.y}),this.ctx.lastPoint=new o(w.x,w.y)},g.prototype.bezierCurveTo=function(H,ae,k,B,w,oe){if(isNaN(w)||isNaN(oe)||isNaN(H)||isNaN(ae)||isNaN(k)||isNaN(B))throw Ja.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ne=this.ctx.transform.applyToPoint(new o(w,oe)),Fe=this.ctx.transform.applyToPoint(new o(H,ae)),je=this.ctx.transform.applyToPoint(new o(k,B));this.path.push({type:"bct",x1:Fe.x,y1:Fe.y,x2:je.x,y2:je.y,x:ne.x,y:ne.y}),this.ctx.lastPoint=new o(ne.x,ne.y)},g.prototype.arc=function(H,ae,k,B,w,oe){if(isNaN(H)||isNaN(ae)||isNaN(k)||isNaN(B)||isNaN(w))throw Ja.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(oe=!!oe,!this.ctx.transform.isIdentity){var ne=this.ctx.transform.applyToPoint(new o(H,ae));H=ne.x,ae=ne.y;var Fe=this.ctx.transform.applyToPoint(new o(0,k)),je=this.ctx.transform.applyToPoint(new o(0,0));k=Math.sqrt(Math.pow(Fe.x-je.x,2)+Math.pow(Fe.y-je.y,2))}Math.abs(w-B)>=2*Math.PI&&(B=0,w=2*Math.PI),this.path.push({type:"arc",x:H,y:ae,radius:k,startAngle:B,endAngle:w,counterclockwise:oe})},g.prototype.arcTo=function(H,ae,k,B,w){throw new Error("arcTo not implemented.")},g.prototype.rect=function(H,ae,k,B){if(isNaN(H)||isNaN(ae)||isNaN(k)||isNaN(B))throw Ja.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(H,ae),this.lineTo(H+k,ae),this.lineTo(H+k,ae+B),this.lineTo(H,ae+B),this.lineTo(H,ae),this.lineTo(H+k,ae),this.lineTo(H,ae)},g.prototype.fillRect=function(H,ae,k,B){if(isNaN(H)||isNaN(ae)||isNaN(k)||isNaN(B))throw Ja.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var w={};this.lineCap!=="butt"&&(w.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(w.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(H,ae,k,B),this.fill(),w.hasOwnProperty("lineCap")&&(this.lineCap=w.lineCap),w.hasOwnProperty("lineJoin")&&(this.lineJoin=w.lineJoin)}},g.prototype.strokeRect=function(H,ae,k,B){if(isNaN(H)||isNaN(ae)||isNaN(k)||isNaN(B))throw Ja.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");y.call(this)||(this.beginPath(),this.rect(H,ae,k,B),this.stroke())},g.prototype.clearRect=function(H,ae,k,B){if(isNaN(H)||isNaN(ae)||isNaN(k)||isNaN(B))throw Ja.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(H,ae,k,B))},g.prototype.save=function(H){H=typeof H!="boolean"||H;for(var ae=this.pdf.internal.getCurrentPageInfo().pageNumber,k=0;k<this.pdf.internal.getNumberOfPages();k++)this.pdf.setPage(k+1),this.pdf.internal.out("q");if(this.pdf.setPage(ae),H){this.ctx.fontSize=this.pdf.internal.getFontSize();var B=new A(this.ctx);this.ctxStack.push(this.ctx),this.ctx=B}},g.prototype.restore=function(H){H=typeof H!="boolean"||H;for(var ae=this.pdf.internal.getCurrentPageInfo().pageNumber,k=0;k<this.pdf.internal.getNumberOfPages();k++)this.pdf.setPage(k+1),this.pdf.internal.out("Q");this.pdf.setPage(ae),H&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},g.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var N=function(H){var ae,k,B,w;if(H.isCanvasGradient===!0&&(H=H.getColor()),!H)return{r:0,g:0,b:0,a:0,style:H};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(H))ae=0,k=0,B=0,w=0;else{var oe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(H);if(oe!==null)ae=parseInt(oe[1]),k=parseInt(oe[2]),B=parseInt(oe[3]),w=1;else if((oe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(H))!==null)ae=parseInt(oe[1]),k=parseInt(oe[2]),B=parseInt(oe[3]),w=parseFloat(oe[4]);else{if(w=1,typeof H=="string"&&H.charAt(0)!=="#"){var ne=new V4(H);H=ne.ok?ne.toHex():"#000000"}H.length===4?(ae=H.substring(1,2),ae+=ae,k=H.substring(2,3),k+=k,B=H.substring(3,4),B+=B):(ae=H.substring(1,3),k=H.substring(3,5),B=H.substring(5,7)),ae=parseInt(ae,16),k=parseInt(k,16),B=parseInt(B,16)}}return{r:ae,g:k,b:B,a:w,style:H}},f=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},y=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};g.prototype.fillText=function(H,ae,k,B){if(isNaN(ae)||isNaN(k)||typeof H!="string")throw Ja.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(B=isNaN(B)?void 0:B,!f.call(this)){var w=ge(this.ctx.transform.rotation),oe=this.ctx.transform.scaleX;E.call(this,{text:H,x:ae,y:k,scale:oe,angle:w,align:this.textAlign,maxWidth:B})}},g.prototype.strokeText=function(H,ae,k,B){if(isNaN(ae)||isNaN(k)||typeof H!="string")throw Ja.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!y.call(this)){B=isNaN(B)?void 0:B;var w=ge(this.ctx.transform.rotation),oe=this.ctx.transform.scaleX;E.call(this,{text:H,x:ae,y:k,scale:oe,renderingMode:"stroke",angle:w,align:this.textAlign,maxWidth:B})}},g.prototype.measureText=function(H){if(typeof H!="string")throw Ja.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var ae=this.pdf,k=this.pdf.internal.scaleFactor,B=ae.internal.getFontSize(),w=ae.getStringUnitWidth(H)*B/ae.internal.scaleFactor;return new function(oe){var ne=(oe=oe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ne}}),this}({width:w*=Math.round(96*k/72*1e4)/1e4})},g.prototype.scale=function(H,ae){if(isNaN(H)||isNaN(ae))throw Ja.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var k=new u(H,0,0,ae,0,0);this.ctx.transform=this.ctx.transform.multiply(k)},g.prototype.rotate=function(H){if(isNaN(H))throw Ja.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var ae=new u(Math.cos(H),Math.sin(H),-Math.sin(H),Math.cos(H),0,0);this.ctx.transform=this.ctx.transform.multiply(ae)},g.prototype.translate=function(H,ae){if(isNaN(H)||isNaN(ae))throw Ja.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var k=new u(1,0,0,1,H,ae);this.ctx.transform=this.ctx.transform.multiply(k)},g.prototype.transform=function(H,ae,k,B,w,oe){if(isNaN(H)||isNaN(ae)||isNaN(k)||isNaN(B)||isNaN(w)||isNaN(oe))throw Ja.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ne=new u(H,ae,k,B,w,oe);this.ctx.transform=this.ctx.transform.multiply(ne)},g.prototype.setTransform=function(H,ae,k,B,w,oe){H=isNaN(H)?1:H,ae=isNaN(ae)?0:ae,k=isNaN(k)?0:k,B=isNaN(B)?1:B,w=isNaN(w)?0:w,oe=isNaN(oe)?0:oe,this.ctx.transform=new u(H,ae,k,B,w,oe)};var v=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};g.prototype.drawImage=function(H,ae,k,B,w,oe,ne,Fe,je){var Ge=this.pdf.getImageProperties(H),ze=1,Xe=1,st=1,ce=1;B!==void 0&&Fe!==void 0&&(st=Fe/B,ce=je/w,ze=Ge.width/B*Fe/B,Xe=Ge.height/w*je/w),oe===void 0&&(oe=ae,ne=k,ae=0,k=0),B!==void 0&&Fe===void 0&&(Fe=B,je=w),B===void 0&&Fe===void 0&&(Fe=Ge.width,je=Ge.height);var _e=this.ctx.transform.decompose(),le=ge(_e.rotate.shx),Pe=new u,we=(Pe=(Pe=(Pe=Pe.multiply(_e.translate)).multiply(_e.skew)).multiply(_e.scale)).applyToRectangle(new m(oe-ae*st,ne-k*ce,B*ze,w*Xe));if(this.autoPaging){for(var fe,ye=U.call(this,we),Ke=[],ve=0;ve<ye.length;ve+=1)Ke.indexOf(ye[ve])===-1&&Ke.push(ye[ve]);K(Ke);for(var ie=Ke[0],q=Ke[Ke.length-1],pe=ie;pe<q+1;pe++){this.pdf.setPage(pe);var Me=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Se=pe===1?this.posY+this.margin[0]:this.margin[0],Ne=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],et=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ce=pe===1?0:Ne+(pe-2)*et;if(this.ctx.clip_path.length!==0){var ft=this.path;fe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=M(fe,this.posX+this.margin[3],-Ce+Se+this.ctx.prevPageLastElemOffset),P.call(this,"fill",!0),this.path=ft}var qe=JSON.parse(JSON.stringify(we));qe=M([qe],this.posX+this.margin[3],-Ce+Se+this.ctx.prevPageLastElemOffset)[0];var W=(pe>ie||pe<q)&&v.call(this);W&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Me,et,null).clip().discardPath()),this.pdf.addImage(H,"JPEG",qe.x,qe.y,qe.w,qe.h,null,null,le),W&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(H,"JPEG",we.x,we.y,we.w,we.h,null,null,le)};var U=function(H,ae,k){var B=[];ae=ae||this.pdf.internal.pageSize.width,k=k||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var w=this.posY+this.ctx.prevPageLastElemOffset;switch(H.type){default:case"mt":case"lt":B.push(Math.floor((H.y+w)/k)+1);break;case"arc":B.push(Math.floor((H.y+w-H.radius)/k)+1),B.push(Math.floor((H.y+w+H.radius)/k)+1);break;case"qct":var oe=xe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,H.x1,H.y1,H.x,H.y);B.push(Math.floor((oe.y+w)/k)+1),B.push(Math.floor((oe.y+oe.h+w)/k)+1);break;case"bct":var ne=Z(this.ctx.lastPoint.x,this.ctx.lastPoint.y,H.x1,H.y1,H.x2,H.y2,H.x,H.y);B.push(Math.floor((ne.y+w)/k)+1),B.push(Math.floor((ne.y+ne.h+w)/k)+1);break;case"rect":B.push(Math.floor((H.y+w)/k)+1),B.push(Math.floor((H.y+H.h+w)/k)+1)}for(var Fe=0;Fe<B.length;Fe+=1)for(;this.pdf.internal.getNumberOfPages()<B[Fe];)D.call(this);return B},D=function(){var H=this.fillStyle,ae=this.strokeStyle,k=this.font,B=this.lineCap,w=this.lineWidth,oe=this.lineJoin;this.pdf.addPage(),this.fillStyle=H,this.strokeStyle=ae,this.font=k,this.lineCap=B,this.lineWidth=w,this.lineJoin=oe},M=function(H,ae,k){for(var B=0;B<H.length;B++)switch(H[B].type){case"bct":H[B].x2+=ae,H[B].y2+=k;case"qct":H[B].x1+=ae,H[B].y1+=k;default:H[B].x+=ae,H[B].y+=k}return H},K=function(H){return H.sort(function(ae,k){return ae-k})},$=function(H,ae){var k=this.fillStyle,B=this.strokeStyle,w=this.lineCap,oe=this.lineWidth,ne=Math.abs(oe*this.ctx.transform.scaleX),Fe=this.lineJoin;if(this.autoPaging){for(var je,Ge,ze=JSON.parse(JSON.stringify(this.path)),Xe=JSON.parse(JSON.stringify(this.path)),st=[],ce=0;ce<Xe.length;ce++)if(Xe[ce].x!==void 0)for(var _e=U.call(this,Xe[ce]),le=0;le<_e.length;le+=1)st.indexOf(_e[le])===-1&&st.push(_e[le]);for(var Pe=0;Pe<st.length;Pe++)for(;this.pdf.internal.getNumberOfPages()<st[Pe];)D.call(this);K(st);for(var we=st[0],fe=st[st.length-1],ye=we;ye<fe+1;ye++){this.pdf.setPage(ye),this.fillStyle=k,this.strokeStyle=B,this.lineCap=w,this.lineWidth=ne,this.lineJoin=Fe;var Ke=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ve=ye===1?this.posY+this.margin[0]:this.margin[0],ie=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],q=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],pe=ye===1?0:ie+(ye-2)*q;if(this.ctx.clip_path.length!==0){var Me=this.path;je=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=M(je,this.posX+this.margin[3],-pe+ve+this.ctx.prevPageLastElemOffset),P.call(this,H,!0),this.path=Me}if(Ge=JSON.parse(JSON.stringify(ze)),this.path=M(Ge,this.posX+this.margin[3],-pe+ve+this.ctx.prevPageLastElemOffset),ae===!1||ye===0){var Se=(ye>we||ye<fe)&&v.call(this);Se&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ke,q,null).clip().discardPath()),P.call(this,H,ae),Se&&this.pdf.restoreGraphicsState()}this.lineWidth=oe}this.path=ze}else this.lineWidth=ne,P.call(this,H,ae),this.lineWidth=oe},P=function(H,ae){if((H!=="stroke"||ae||!y.call(this))&&(H==="stroke"||ae||!f.call(this))){for(var k,B,w=[],oe=this.path,ne=0;ne<oe.length;ne++){var Fe=oe[ne];switch(Fe.type){case"begin":w.push({begin:!0});break;case"close":w.push({close:!0});break;case"mt":w.push({start:Fe,deltas:[],abs:[]});break;case"lt":var je=w.length;if(oe[ne-1]&&!isNaN(oe[ne-1].x)&&(k=[Fe.x-oe[ne-1].x,Fe.y-oe[ne-1].y],je>0)){for(;je>=0;je--)if(w[je-1].close!==!0&&w[je-1].begin!==!0){w[je-1].deltas.push(k),w[je-1].abs.push(Fe);break}}break;case"bct":k=[Fe.x1-oe[ne-1].x,Fe.y1-oe[ne-1].y,Fe.x2-oe[ne-1].x,Fe.y2-oe[ne-1].y,Fe.x-oe[ne-1].x,Fe.y-oe[ne-1].y],w[w.length-1].deltas.push(k);break;case"qct":var Ge=oe[ne-1].x+2/3*(Fe.x1-oe[ne-1].x),ze=oe[ne-1].y+2/3*(Fe.y1-oe[ne-1].y),Xe=Fe.x+2/3*(Fe.x1-Fe.x),st=Fe.y+2/3*(Fe.y1-Fe.y),ce=Fe.x,_e=Fe.y;k=[Ge-oe[ne-1].x,ze-oe[ne-1].y,Xe-oe[ne-1].x,st-oe[ne-1].y,ce-oe[ne-1].x,_e-oe[ne-1].y],w[w.length-1].deltas.push(k);break;case"arc":w.push({deltas:[],abs:[],arc:!0}),Array.isArray(w[w.length-1].abs)&&w[w.length-1].abs.push(Fe)}}B=ae?null:H==="stroke"?"stroke":"fill";for(var le=!1,Pe=0;Pe<w.length;Pe++)if(w[Pe].arc)for(var we=w[Pe].abs,fe=0;fe<we.length;fe++){var ye=we[fe];ye.type==="arc"?R.call(this,ye.x,ye.y,ye.radius,ye.startAngle,ye.endAngle,ye.counterclockwise,void 0,ae,!le):te.call(this,ye.x,ye.y),le=!0}else if(w[Pe].close===!0)this.pdf.internal.out("h"),le=!1;else if(w[Pe].begin!==!0){var Ke=w[Pe].start.x,ve=w[Pe].start.y;C.call(this,w[Pe].deltas,Ke,ve),le=!0}B&&j.call(this,B),ae&&T.call(this)}},se=function(H){var ae=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,k=ae*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return H-k;case"top":return H+ae-k;case"hanging":return H+ae-2*k;case"middle":return H+ae/2-k;default:return H}},z=function(H){return H+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};g.prototype.createLinearGradient=function(){var H=function(){};return H.colorStops=[],H.addColorStop=function(ae,k){this.colorStops.push([ae,k])},H.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},H.isCanvasGradient=!0,H},g.prototype.createPattern=function(){return this.createLinearGradient()},g.prototype.createRadialGradient=function(){return this.createLinearGradient()};var R=function(H,ae,k,B,w,oe,ne,Fe,je){for(var Ge=V.call(this,k,B,w,oe),ze=0;ze<Ge.length;ze++){var Xe=Ge[ze];ze===0&&(je?Q.call(this,Xe.x1+H,Xe.y1+ae):te.call(this,Xe.x1+H,Xe.y1+ae)),O.call(this,H,ae,Xe.x2,Xe.y2,Xe.x3,Xe.y3,Xe.x4,Xe.y4)}Fe?T.call(this):j.call(this,ne)},j=function(H){switch(H){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},T=function(){this.pdf.clip(),this.pdf.discardPath()},Q=function(H,ae){this.pdf.internal.out(a(H)+" "+r(ae)+" m")},E=function(H){var ae;switch(H.align){case"right":case"end":ae="right";break;case"center":ae="center";break;default:ae="left"}var k,B,w,oe=this.pdf.getTextDimensions(H.text),ne=se.call(this,H.y),Fe=z.call(this,ne)-oe.h,je=this.ctx.transform.applyToPoint(new o(H.x,ne));if(this.autoPaging){var Ge=this.ctx.transform.decompose(),ze=new u;ze=(ze=(ze=ze.multiply(Ge.translate)).multiply(Ge.skew)).multiply(Ge.scale);for(var Xe=this.ctx.transform.applyToRectangle(new m(H.x,ne,oe.w,oe.h)),st=ze.applyToRectangle(new m(H.x,Fe,oe.w,oe.h)),ce=U.call(this,st),_e=[],le=0;le<ce.length;le+=1)_e.indexOf(ce[le])===-1&&_e.push(ce[le]);K(_e);for(var Pe=_e[0],we=_e[_e.length-1],fe=Pe;fe<we+1;fe++){this.pdf.setPage(fe);var ye=fe===1?this.posY+this.margin[0]:this.margin[0],Ke=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ve=this.pdf.internal.pageSize.height-this.margin[2],ie=ve-this.margin[0],q=this.pdf.internal.pageSize.width-this.margin[1],pe=q-this.margin[3],Me=fe===1?0:Ke+(fe-2)*ie;if(this.ctx.clip_path.length!==0){var Se=this.path;k=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=M(k,this.posX+this.margin[3],-1*Me+ye),P.call(this,"fill",!0),this.path=Se}var Ne=M([JSON.parse(JSON.stringify(st))],this.posX+this.margin[3],-Me+ye+this.ctx.prevPageLastElemOffset)[0];H.scale>=.01&&(B=this.pdf.internal.getFontSize(),this.pdf.setFontSize(B*H.scale),w=this.lineWidth,this.lineWidth=w*H.scale);var et=this.autoPaging!=="text";if(et||Ne.y+Ne.h<=ve){if(et||Ne.y>=ye&&Ne.x<=q){var Ce=et?H.text:this.pdf.splitTextToSize(H.text,H.maxWidth||q-Ne.x)[0],ft=M([JSON.parse(JSON.stringify(Xe))],this.posX+this.margin[3],-Me+ye+this.ctx.prevPageLastElemOffset)[0],qe=et&&(fe>Pe||fe<we)&&v.call(this);qe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],pe,ie,null).clip().discardPath()),this.pdf.text(Ce,ft.x,ft.y,{angle:H.angle,align:ae,renderingMode:H.renderingMode}),qe&&this.pdf.restoreGraphicsState()}}else Ne.y<ve&&(this.ctx.prevPageLastElemOffset+=ve-Ne.y);H.scale>=.01&&(this.pdf.setFontSize(B),this.lineWidth=w)}}else H.scale>=.01&&(B=this.pdf.internal.getFontSize(),this.pdf.setFontSize(B*H.scale),w=this.lineWidth,this.lineWidth=w*H.scale),this.pdf.text(H.text,je.x+this.posX,je.y+this.posY,{angle:H.angle,align:ae,renderingMode:H.renderingMode,maxWidth:H.maxWidth}),H.scale>=.01&&(this.pdf.setFontSize(B),this.lineWidth=w)},te=function(H,ae,k,B){k=k||0,B=B||0,this.pdf.internal.out(a(H+k)+" "+r(ae+B)+" l")},C=function(H,ae,k){return this.pdf.lines(H,ae,k,null,null)},O=function(H,ae,k,B,w,oe,ne,Fe){this.pdf.internal.out([s(l(k+H)),s(c(B+ae)),s(l(w+H)),s(c(oe+ae)),s(l(ne+H)),s(c(Fe+ae)),"c"].join(" "))},V=function(H,ae,k,B){for(var w=2*Math.PI,oe=Math.PI/2;ae>k;)ae-=w;var ne=Math.abs(k-ae);ne<w&&B&&(ne=w-ne);for(var Fe=[],je=B?-1:1,Ge=ae;ne>1e-5;){var ze=Ge+je*Math.min(ne,oe);Fe.push(re.call(this,H,Ge,ze)),ne-=Math.abs(ze-Ge),Ge=ze}return Fe},re=function(H,ae,k){var B=(k-ae)/2,w=H*Math.cos(B),oe=H*Math.sin(B),ne=w,Fe=-oe,je=ne*ne+Fe*Fe,Ge=je+ne*w+Fe*oe,ze=4/3*(Math.sqrt(2*je*Ge)-Ge)/(ne*oe-Fe*w),Xe=ne-ze*Fe,st=Fe+ze*ne,ce=Xe,_e=-st,le=B+ae,Pe=Math.cos(le),we=Math.sin(le);return{x1:H*Math.cos(ae),y1:H*Math.sin(ae),x2:Xe*Pe-st*we,y2:Xe*we+st*Pe,x3:ce*Pe-_e*we,y3:ce*we+_e*Pe,x4:H*Math.cos(k),y4:H*Math.sin(k)}},ge=function(H){return 180*H/Math.PI},xe=function(H,ae,k,B,w,oe){var ne=H+.5*(k-H),Fe=ae+.5*(B-ae),je=w+.5*(k-w),Ge=oe+.5*(B-oe),ze=Math.min(H,w,ne,je),Xe=Math.max(H,w,ne,je),st=Math.min(ae,oe,Fe,Ge),ce=Math.max(ae,oe,Fe,Ge);return new m(ze,st,Xe-ze,ce-st)},Z=function(H,ae,k,B,w,oe,ne,Fe){var je,Ge,ze,Xe,st,ce,_e,le,Pe,we,fe,ye,Ke,ve,ie=k-H,q=B-ae,pe=w-k,Me=oe-B,Se=ne-w,Ne=Fe-oe;for(Ge=0;Ge<41;Ge++)Pe=(_e=(ze=H+(je=Ge/40)*ie)+je*((st=k+je*pe)-ze))+je*(st+je*(w+je*Se-st)-_e),we=(le=(Xe=ae+je*q)+je*((ce=B+je*Me)-Xe))+je*(ce+je*(oe+je*Ne-ce)-le),Ge==0?(fe=Pe,ye=we,Ke=Pe,ve=we):(fe=Math.min(fe,Pe),ye=Math.min(ye,we),Ke=Math.max(Ke,Pe),ve=Math.max(ve,we));return new m(Math.round(fe),Math.round(ye),Math.round(Ke-fe),Math.round(ve-ye))},I=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var H,ae,k=(H=this.ctx.lineDash,ae=this.ctx.lineDashOffset,JSON.stringify({lineDash:H,lineDashOffset:ae}));this.prevLineDash!==k&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=k)}}})(ms.API),(function(t){var s=function(o){var m,u,x,A,g,N,f,y,v,U;for(u=[],x=0,A=(o+=m="\0\0\0\0".slice(o.length%4||4)).length;A>x;x+=4)(g=(o.charCodeAt(x)<<24)+(o.charCodeAt(x+1)<<16)+(o.charCodeAt(x+2)<<8)+o.charCodeAt(x+3))!==0?(N=(g=((g=((g=((g=(g-(U=g%85))/85)-(v=g%85))/85)-(y=g%85))/85)-(f=g%85))/85)%85,u.push(N+33,f+33,y+33,v+33,U+33)):u.push(122);return(function(D,M){for(var K=M;K>0;K--)D.pop()})(u,m.length),String.fromCharCode.apply(String,u)+"~>"},a=function(o){var m,u,x,A,g,N=String,f="length",y=255,v="charCodeAt",U="slice",D="replace";for(o[U](-2),o=o[U](0,-2)[D](/\s/g,"")[D]("z","!!!!!"),x=[],A=0,g=(o+=m="uuuuu"[U](o[f]%5||5))[f];g>A;A+=5)u=52200625*(o[v](A)-33)+614125*(o[v](A+1)-33)+7225*(o[v](A+2)-33)+85*(o[v](A+3)-33)+(o[v](A+4)-33),x.push(y&u>>24,y&u>>16,y&u>>8,y&u);return(function(M,K){for(var $=K;$>0;$--)M.pop()})(x,m[f]),N.fromCharCode.apply(N,x)},r=function(o){return o.split("").map(function(m){return("0"+m.charCodeAt().toString(16)).slice(-2)}).join("")+">"},l=function(o){var m=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),m.test(o)===!1)return"";for(var u="",x=0;x<o.length;x+=2)u+=String.fromCharCode("0x"+(o[x]+o[x+1]));return u},c=function(o){for(var m=new Uint8Array(o.length),u=o.length;u--;)m[u]=o.charCodeAt(u);return(m=jb(m)).reduce(function(x,A){return x+String.fromCharCode(A)},"")};t.processDataByFilters=function(o,m){var u=0,x=o||"",A=[];for(typeof(m=m||[])=="string"&&(m=[m]),u=0;u<m.length;u+=1)switch(m[u]){case"ASCII85Decode":case"/ASCII85Decode":x=a(x),A.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":x=s(x),A.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":x=l(x),A.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":x=r(x),A.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":x=c(x),A.push("/FlateDecode");break;default:throw new Error('The filter: "'+m[u]+'" is not implemented')}return{data:x,reverseChain:A.reverse().join(" ")}}})(ms.API),(function(t){t.loadFile=function(s,a,r){return(function(l,c,o){c=c!==!1,o=typeof o=="function"?o:function(){};var m=void 0;try{m=(function(u,x,A){var g=new XMLHttpRequest,N=0,f=function(y){var v=y.length,U=[],D=String.fromCharCode;for(N=0;N<v;N+=1)U.push(D(255&y.charCodeAt(N)));return U.join("")};if(g.open("GET",u,!x),g.overrideMimeType("text/plain; charset=x-user-defined"),x===!1&&(g.onload=function(){g.status===200?A(f(this.responseText)):A(void 0)}),g.send(null),x&&g.status===200)return f(g.responseText)})(l,c,o)}catch{}return m})(s,a,r)},t.loadImageFile=t.loadFile})(ms.API),(function(t){function s(){return(Ps.html2canvas?Promise.resolve(Ps.html2canvas):lf(()=>Promise.resolve().then(()=>z$),[])).catch(function(m){return Promise.reject(new Error("Could not load html2canvas: "+m))}).then(function(m){return m.default?m.default:m})}function a(){return(Ps.DOMPurify?Promise.resolve(Ps.DOMPurify):lf(()=>import("./purify.es-C65SP4u9.js"),[])).catch(function(m){return Promise.reject(new Error("Could not load dompurify: "+m))}).then(function(m){return m.default?m.default:m})}var r=function(m){var u=Ra(m);return u==="undefined"?"undefined":u==="string"||m instanceof String?"string":u==="number"||m instanceof Number?"number":u==="function"||m instanceof Function?"function":m&&m.constructor===Array?"array":m&&m.nodeType===1?"element":u==="object"?"object":"unknown"},l=function(m,u){var x=document.createElement(m);for(var A in u.className&&(x.className=u.className),u.innerHTML&&u.dompurify&&(x.innerHTML=u.dompurify.sanitize(u.innerHTML)),u.style)x.style[A]=u.style[A];return x},c=function m(u,x){for(var A=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),g=u.firstChild;g;g=g.nextSibling)x!==!0&&g.nodeType===1&&g.nodeName==="SCRIPT"||A.appendChild(m(g,x));return u.nodeType===1&&(u.nodeName==="CANVAS"?(A.width=u.width,A.height=u.height,A.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(A.value=u.value),A.addEventListener("load",function(){A.scrollTop=u.scrollTop,A.scrollLeft=u.scrollLeft},!0)),A},o=function m(u){var x=Object.assign(m.convert(Promise.resolve()),JSON.parse(JSON.stringify(m.template))),A=m.convert(Promise.resolve(),x);return(A=A.setProgress(1,m,1,[m])).set(u)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(m,u){return m.__proto__=u||o.prototype,m},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(m,u){return this.then(function(){switch(u=u||(function(x){switch(r(x)){case"string":return"string";case"element":return x.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(m),u){case"string":return this.then(a).then(function(x){return this.set({src:l("div",{innerHTML:m,dompurify:x})})});case"element":return this.set({src:m});case"canvas":return this.set({canvas:m});case"img":return this.set({img:m});default:return this.error("Unknown source type.")}})},o.prototype.to=function(m){switch(m){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var m={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},u=c(this.prop.src,this.opt.html2canvas.javascriptEnabled);u.tagName==="BODY"&&(m.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=l("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=l("div",{className:"html2pdf__container",style:m}),this.prop.container.appendChild(u),this.prop.container.firstChild.appendChild(l("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var m=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(m).then(s).then(function(u){var x=Object.assign({},this.opt.html2canvas);return delete x.onrendered,u(this.prop.container,x)}).then(function(u){(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var m=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(m).then(s).then(function(u){var x=this.opt.jsPDF,A=this.opt.fontFaces,g=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,N=Object.assign({async:!0,allowTaint:!0,scale:g,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete N.onrendered,x.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,x.context2d.posX=this.opt.x,x.context2d.posY=this.opt.y,x.context2d.margin=this.opt.margin,x.context2d.fontFaces=A,A)for(var f=0;f<A.length;++f){var y=A[f],v=y.src.find(function(U){return U.format==="truetype"});v&&x.addFont(v.url,y.ref.name,y.ref.style)}return N.windowHeight=N.windowHeight||0,N.windowHeight=N.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):N.windowHeight,x.context2d.save(!0),u(this.prop.container,N)}).then(function(u){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var m=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=m})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(m,u,x){return(x=x||"pdf").toLowerCase()==="img"||x.toLowerCase()==="image"?this.outputImg(m,u):this.outputPdf(m,u)},o.prototype.outputPdf=function(m,u){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(m,u)})},o.prototype.outputImg=function(m){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(m){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+m+'" is not supported.'}})},o.prototype.save=function(m){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(m?{filename:m}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(m){if(r(m)!=="object")return this;var u=Object.keys(m||{}).map(function(x){if(x in o.template.prop)return function(){this.prop[x]=m[x]};switch(x){case"margin":return this.setMargin.bind(this,m.margin);case"jsPDF":return function(){return this.opt.jsPDF=m.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,m.pageSize);default:return function(){this.opt[x]=m[x]}}},this);return this.then(function(){return this.thenList(u)})},o.prototype.get=function(m,u){return this.then(function(){var x=m in o.template.prop?this.prop[m]:this.opt[m];return u?u(x):x})},o.prototype.setMargin=function(m){return this.then(function(){switch(r(m)){case"number":m=[m,m,m,m];case"array":if(m.length===2&&(m=[m[0],m[1],m[0],m[1]]),m.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=m}).then(this.setPageSize)},o.prototype.setPageSize=function(m){function u(x,A){return Math.floor(x*A/72*96)}return this.then(function(){(m=m||ms.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(m.inner={width:m.width-this.opt.margin[1]-this.opt.margin[3],height:m.height-this.opt.margin[0]-this.opt.margin[2]},m.inner.px={width:u(m.inner.width,m.k),height:u(m.inner.height,m.k)},m.inner.ratio=m.inner.height/m.inner.width),this.prop.pageSize=m})},o.prototype.setProgress=function(m,u,x,A){return m!=null&&(this.progress.val=m),u!=null&&(this.progress.state=u),x!=null&&(this.progress.n=x),A!=null&&(this.progress.stack=A),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(m,u,x,A){return this.setProgress(m?this.progress.val+m:null,u||null,x?this.progress.n+x:null,A?this.progress.stack.concat(A):null)},o.prototype.then=function(m,u){var x=this;return this.thenCore(m,u,function(A,g){return x.updateProgress(null,null,1,[A]),Promise.prototype.then.call(this,function(N){return x.updateProgress(null,A),N}).then(A,g).then(function(N){return x.updateProgress(1),N})})},o.prototype.thenCore=function(m,u,x){x=x||Promise.prototype.then;var A=this;m&&(m=m.bind(A)),u&&(u=u.bind(A));var g=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?A:o.convert(Object.assign({},A),Promise.prototype),N=x.call(g,m,u);return o.convert(N,A.__proto__)},o.prototype.thenExternal=function(m,u){return Promise.prototype.then.call(this,m,u)},o.prototype.thenList=function(m){var u=this;return m.forEach(function(x){u=u.thenCore(x)}),u},o.prototype.catch=function(m){m&&(m=m.bind(this));var u=Promise.prototype.catch.call(this,m);return o.convert(u,this)},o.prototype.catchExternal=function(m){return Promise.prototype.catch.call(this,m)},o.prototype.error=function(m){return this.then(function(){throw new Error(m)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,ms.getPageSize=function(m,u,x){if(Ra(m)==="object"){var A=m;m=A.orientation,u=A.unit||u,x=A.format||x}u=u||"mm",x=x||"a4",m=(""+(m||"P")).toLowerCase();var g,N=(""+x).toLowerCase(),f={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(u){case"pt":g=1;break;case"mm":g=72/25.4;break;case"cm":g=72/2.54;break;case"in":g=72;break;case"px":g=.75;break;case"pc":case"em":g=12;break;case"ex":g=6;break;default:throw"Invalid unit: "+u}var y,v=0,U=0;if(f.hasOwnProperty(N))v=f[N][1]/g,U=f[N][0]/g;else try{v=x[1],U=x[0]}catch{throw new Error("Invalid format: "+x)}if(m==="p"||m==="portrait")m="p",U>v&&(y=U,U=v,v=y);else{if(m!=="l"&&m!=="landscape")throw"Invalid orientation: "+m;m="l",v>U&&(y=U,U=v,v=y)}return{width:U,height:v,unit:u,k:g,orientation:m}},t.html=function(m,u){(u=u||{}).callback=u.callback||function(){},u.html2canvas=u.html2canvas||{},u.html2canvas.canvas=u.html2canvas.canvas||this.canvas,u.jsPDF=u.jsPDF||this,u.fontFaces=u.fontFaces?u.fontFaces.map(_f):null;var x=new o(u);return u.worker?x:x.from(m).doCallback()}})(ms.API),ms.API.addJS=function(t){return Vw=t,this.internal.events.subscribe("postPutResources",function(){Xp=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Xp+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Kw=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Vw+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Xp!==void 0&&Kw!==void 0&&this.internal.out("/Names <</JavaScript "+Xp+" 0 R>>")}),this},(function(t){var s;t.events.push(["postPutResources",function(){var a=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var l=a.outline.render().split(/\r\n/),c=0;c<l.length;c++){var o=l[c],m=r.exec(o);if(m!=null){var u=m[1];a.internal.newObjectDeferredBegin(u,!1)}a.internal.write(o)}if(this.outline.createNamedDestinations){var x=this.internal.pages.length,A=[];for(c=0;c<x;c++){var g=a.internal.newObject();A.push(g);var N=a.internal.getPageInfo(c+1);a.internal.write("<< /D["+N.objId+" 0 R /XYZ null null null]>> endobj")}var f=a.internal.newObject();for(a.internal.write("<< /Names [ "),c=0;c<A.length;c++)a.internal.write("(page_"+(c+1)+")"+A[c]+" 0 R");a.internal.write(" ] >>","endobj"),s=a.internal.newObject(),a.internal.write("<< /Dests "+f+" 0 R"),a.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var a=this;a.outline.root.children.length>0&&(a.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&a.internal.write("/Names "+s+" 0 R"))}]),t.events.push(["initialized",function(){var a=this;a.outline={createNamedDestinations:!1,root:{children:[]}},a.outline.add=function(r,l,c){var o={title:l,options:c,children:[]};return r==null&&(r=this.root),r.children.push(o),o},a.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=a,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},a.outline.genIds_r=function(r){r.id=a.internal.newObjectDeferred();for(var l=0;l<r.children.length;l++)this.genIds_r(r.children[l])},a.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},a.outline.renderItems=function(r){for(var l=this.ctx.pdf.internal.getVerticalCoordinateString,c=0;c<r.children.length;c++){var o=r.children[c];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(r)),c>0&&this.line("/Prev "+this.makeRef(r.children[c-1])),c<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[c+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var m=this.count=this.count_r({count:0},o);if(m>0&&this.line("/Count "+m),o.options&&o.options.pageNumber){var u=a.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+u.objId+" 0 R /XYZ 0 "+l(0)+" 0]")}this.objEnd()}for(var x=0;x<r.children.length;x++)this.renderItems(r.children[x])},a.outline.line=function(r){this.ctx.val+=r+`\r
`},a.outline.makeRef=function(r){return r.id+" 0 R"},a.outline.makeString=function(r){return"("+a.internal.pdfEscape(r)+")"},a.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},a.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},a.outline.count_r=function(r,l){for(var c=0;c<l.children.length;c++)r.count++,this.count_r(r,l.children[c]);return r.count}}])})(ms.API),(function(t){var s=[192,193,194,195,196,197,198,199];t.processJPEG=function(a,r,l,c,o,m){var u,x=this.decode.DCT_DECODE,A=null;if(typeof a=="string"||this.__addimage__.isArrayBuffer(a)||this.__addimage__.isArrayBufferView(a)){switch(a=o||a,a=this.__addimage__.isArrayBuffer(a)?new Uint8Array(a):a,u=(function(g){for(var N,f=256*g.charCodeAt(4)+g.charCodeAt(5),y=g.length,v={width:0,height:0,numcomponents:1},U=4;U<y;U+=2){if(U+=f,s.indexOf(g.charCodeAt(U+1))!==-1){N=256*g.charCodeAt(U+5)+g.charCodeAt(U+6),v={width:256*g.charCodeAt(U+7)+g.charCodeAt(U+8),height:N,numcomponents:g.charCodeAt(U+9)};break}f=256*g.charCodeAt(U+2)+g.charCodeAt(U+3)}return v})(a=this.__addimage__.isArrayBufferView(a)?this.__addimage__.arrayBufferToBinaryString(a):a),u.numcomponents){case 1:m=this.color_spaces.DEVICE_GRAY;break;case 4:m=this.color_spaces.DEVICE_CMYK;break;case 3:m=this.color_spaces.DEVICE_RGB}A={data:a,width:u.width,height:u.height,colorSpace:m,bitsPerComponent:8,filter:x,index:r,alias:l}}return A}})(ms.API),ms.API.processPNG=function(t,s,a,r){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var l,c=OD(t,{checkCrc:!0}),o=c.width,m=c.height,u=c.channels,x=c.palette,A=c.depth;l=x&&u===1?(function(R){for(var j=R.width,T=R.height,Q=R.data,E=R.palette,te=R.depth,C=!1,O=[],V=[],re=void 0,ge=!1,xe=0,Z=0;Z<E.length;Z++){var I=JN(E[Z],4),H=I[0],ae=I[1],k=I[2],B=I[3];O.push(H,ae,k),B!=null&&(B===0?(xe++,V.length<1&&V.push(Z)):B<255&&(ge=!0))}if(ge||xe>1){C=!0,V=void 0;var w=j*T;re=new Uint8Array(w);for(var oe=new DataView(Q.buffer),ne=0;ne<w;ne++){var Fe=Sf(oe,ne,te),je=JN(E[Fe],4)[3];re[ne]=je}}else xe===0&&(V=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:C?8:void 0,colorBytes:Q,alphaBytes:re,needSMask:C,palette:O,mask:V}})(c):u===2||u===4?(function(R){for(var j=R.data,T=R.width,Q=R.height,E=R.channels,te=R.depth,C=E===2?"DeviceGray":"DeviceRGB",O=E-1,V=T*Q,re=O,ge=V*re,xe=1*V,Z=Math.ceil(ge*te/8),I=Math.ceil(xe*te/8),H=new Uint8Array(Z),ae=new Uint8Array(I),k=new DataView(j.buffer),B=new DataView(H.buffer),w=new DataView(ae.buffer),oe=!1,ne=0;ne<V;ne++){for(var Fe=ne*E,je=0;je<re;je++)a2(B,Sf(k,Fe+je,te),ne*re+je,te);var Ge=Sf(k,Fe+re,te);Ge<(1<<te)-1&&(oe=!0),a2(w,Ge,1*ne,te)}return{colorSpace:C,colorsPerPixel:O,sMaskBitsPerComponent:oe?te:void 0,colorBytes:H,alphaBytes:ae,needSMask:oe}})(c):(function(R){var j=R.data,T=R.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:T,colorsPerPixel:T==="DeviceGray"?1:3,colorBytes:j instanceof Uint16Array?(function(Q){for(var E=Q.length,te=new Uint8Array(2*E),C=new DataView(te.buffer,te.byteOffset,te.byteLength),O=0;O<E;O++)C.setUint16(2*O,Q[O],!1);return te})(j):j,needSMask:!1}})(c);var g,N,f,y=l,v=y.colorSpace,U=y.colorsPerPixel,D=y.sMaskBitsPerComponent,M=y.colorBytes,K=y.alphaBytes,$=y.needSMask,P=y.palette,se=y.mask,z=null;return r!==ms.API.image_compression.NONE&&typeof jb=="function"?(z=(function(R){var j;switch(R){case ms.API.image_compression.FAST:j=11;break;case ms.API.image_compression.MEDIUM:j=13;break;case ms.API.image_compression.SLOW:j=14;break;default:j=12}return j})(r),g=this.decode.FLATE_DECODE,N="/Predictor ".concat(z," /Colors ").concat(U," /BitsPerComponent ").concat(A," /Columns ").concat(o),t=Jw(M,Math.ceil(o*U*A/8),U,A,r),$&&(f=Jw(K,Math.ceil(o*D/8),1,D,r))):(g=void 0,N=void 0,t=M,$&&(f=K)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(f&&this.__addimage__.isArrayBuffer(f)||this.__addimage__.isArrayBufferView(f))&&(f=this.__addimage__.arrayBufferToBinaryString(f)),{alias:a,data:t,index:s,filter:g,decodeParameters:N,transparency:se,palette:P,sMask:f,predictor:z,width:o,height:m,bitsPerComponent:A,sMaskBitsPerComponent:D,colorSpace:v}}},(function(t){t.processGIF89A=function(s,a,r,l){var c=new dU(s),o=c.width,m=c.height,u=[];c.decodeAndBlitFrameRGBA(0,u);var x={data:u,width:o,height:m},A=new kf(100).encode(x,100);return t.processJPEG.call(this,A,a,r,l)},t.processGIF87A=t.processGIF89A})(ms.API),xc.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var s=0;s<t;s++){var a=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),c=this.datav.getUint8(this.pos++,!0);this.palette[s]={red:l,green:r,blue:a,quad:c}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},xc.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,s=this.width*this.height*4;this.data=new Uint8Array(s),this[t]()}catch(a){Ja.log("bit decode error:"+a)}},xc.prototype.bit1=function(){var t,s=Math.ceil(this.width/8),a=s%4;for(t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,l=0;l<s;l++)for(var c=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+8*l*4,m=0;m<8&&8*l+m<this.width;m++){var u=this.palette[c>>7-m&1];this.data[o+4*m]=u.blue,this.data[o+4*m+1]=u.green,this.data[o+4*m+2]=u.red,this.data[o+4*m+3]=255}a!==0&&(this.pos+=4-a)}},xc.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),s=t%4,a=this.height-1;a>=0;a--){for(var r=this.bottom_up?a:this.height-1-a,l=0;l<t;l++){var c=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+2*l*4,m=c>>4,u=15&c,x=this.palette[m];if(this.data[o]=x.blue,this.data[o+1]=x.green,this.data[o+2]=x.red,this.data[o+3]=255,2*l+1>=this.width)break;x=this.palette[u],this.data[o+4]=x.blue,this.data[o+4+1]=x.green,this.data[o+4+2]=x.red,this.data[o+4+3]=255}s!==0&&(this.pos+=4-s)}},xc.prototype.bit8=function(){for(var t=this.width%4,s=this.height-1;s>=0;s--){for(var a=this.bottom_up?s:this.height-1-s,r=0;r<this.width;r++){var l=this.datav.getUint8(this.pos++,!0),c=a*this.width*4+4*r;if(l<this.palette.length){var o=this.palette[l];this.data[c]=o.red,this.data[c+1]=o.green,this.data[c+2]=o.blue,this.data[c+3]=255}else this.data[c]=255,this.data[c+1]=255,this.data[c+2]=255,this.data[c+3]=255}t!==0&&(this.pos+=4-t)}},xc.prototype.bit15=function(){for(var t=this.width%3,s=parseInt("11111",2),a=this.height-1;a>=0;a--){for(var r=this.bottom_up?a:this.height-1-a,l=0;l<this.width;l++){var c=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(c&s)/s*255|0,m=(c>>5&s)/s*255|0,u=(c>>10&s)/s*255|0,x=c>>15?255:0,A=r*this.width*4+4*l;this.data[A]=u,this.data[A+1]=m,this.data[A+2]=o,this.data[A+3]=x}this.pos+=t}},xc.prototype.bit16=function(){for(var t=this.width%3,s=parseInt("11111",2),a=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var l=this.bottom_up?r:this.height-1-r,c=0;c<this.width;c++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var m=(o&s)/s*255|0,u=(o>>5&a)/a*255|0,x=(o>>11)/s*255|0,A=l*this.width*4+4*c;this.data[A]=x,this.data[A+1]=u,this.data[A+2]=m,this.data[A+3]=255}this.pos+=t}},xc.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var s=this.bottom_up?t:this.height-1-t,a=0;a<this.width;a++){var r=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),c=this.datav.getUint8(this.pos++,!0),o=s*this.width*4+4*a;this.data[o]=c,this.data[o+1]=l,this.data[o+2]=r,this.data[o+3]=255}this.pos+=this.width%4}},xc.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var s=this.bottom_up?t:this.height-1-t,a=0;a<this.width;a++){var r=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),c=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),m=s*this.width*4+4*a;this.data[m]=c,this.data[m+1]=l,this.data[m+2]=r,this.data[m+3]=o}},xc.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(s,a,r,l){var c=new xc(s,!1),o=c.width,m=c.height,u={data:c.getData(),width:o,height:m},x=new kf(100).encode(u,100);return t.processJPEG.call(this,x,a,r,l)}})(ms.API),n2.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(s,a,r,l){var c=new n2(s),o=c.width,m=c.height,u={data:c.getData(),width:o,height:m},x=new kf(100).encode(u,100);return t.processJPEG.call(this,x,a,r,l)}})(ms.API),ms.API.processRGBA=function(t,s,a){for(var r=t.data,l=r.length,c=new Uint8Array(l/4*3),o=new Uint8Array(l/4),m=0,u=0,x=0;x<l;x+=4){var A=r[x],g=r[x+1],N=r[x+2],f=r[x+3];c[m++]=A,c[m++]=g,c[m++]=N,o[u++]=f}var y=this.__addimage__.arrayBufferToBinaryString(c);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:y,index:s,alias:a,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},ms.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},ku=ms.API,Jp=ku.getCharWidthsArray=function(t,s){var a,r,l=(s=s||{}).font||this.internal.getFont(),c=s.fontSize||this.internal.getFontSize(),o=s.charSpace||this.internal.getCharSpace(),m=s.widths?s.widths:l.metadata.Unicode.widths,u=m.fof?m.fof:1,x=s.kerning?s.kerning:l.metadata.Unicode.kerning,A=x.fof?x.fof:1,g=s.doKerning!==!1,N=0,f=t.length,y=0,v=m[0]||u,U=[];for(a=0;a<f;a++)r=t.charCodeAt(a),typeof l.metadata.widthOfString=="function"?U.push((l.metadata.widthOfGlyph(l.metadata.characterToGlyph(r))+o*(1e3/c)||0)/1e3):(N=g&&Ra(x[r])==="object"&&!isNaN(parseInt(x[r][y],10))?x[r][y]/A:0,U.push((m[r]||v)/u+N)),y=r;return U},Yw=ku.getStringUnitWidth=function(t,s){var a=(s=s||{}).fontSize||this.internal.getFontSize(),r=s.font||this.internal.getFont(),l=s.charSpace||this.internal.getCharSpace();return ku.processArabic&&(t=ku.processArabic(t)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(t,a,l)/a:Jp.apply(this,arguments).reduce(function(c,o){return c+o},0)},Ww=function(t,s,a,r){for(var l=[],c=0,o=t.length,m=0;c!==o&&m+s[c]<a;)m+=s[c],c++;l.push(t.slice(0,c));var u=c;for(m=0;c!==o;)m+s[c]>r&&(l.push(t.slice(u,c)),m=0,u=c),m+=s[c],c++;return u!==c&&l.push(t.slice(u,c)),l},Xw=function(t,s,a){a||(a={});var r,l,c,o,m,u,x,A=[],g=[A],N=a.textIndent||0,f=0,y=0,v=t.split(" "),U=Jp.apply(this,[" ",a])[0];if(u=a.lineIndent===-1?v[0].length+2:a.lineIndent||0){var D=Array(u).join(" "),M=[];v.map(function($){($=$.split(/\s*\n/)).length>1?M=M.concat($.map(function(P,se){return(se&&P.length?`
`:"")+P})):M.push($[0])}),v=M,u=Yw.apply(this,[D,a])}for(c=0,o=v.length;c<o;c++){var K=0;if(r=v[c],u&&r[0]==`
`&&(r=r.substr(1),K=1),N+f+(y=(l=Jp.apply(this,[r,a])).reduce(function($,P){return $+P},0))>s||K){if(y>s){for(m=Ww.apply(this,[r,l,s-(N+f),s]),A.push(m.shift()),A=[m.pop()];m.length;)g.push([m.shift()]);y=l.slice(r.length-(A[0]?A[0].length:0)).reduce(function($,P){return $+P},0)}else A=[r];g.push(A),N=y+u,f=U}else A.push(r),N+=f+y,f=U}return x=u?function($,P){return(P?D:"")+$.join(" ")}:function($){return $.join(" ")},g.map(x)},ku.splitTextToSize=function(t,s,a){var r,l=(a=a||{}).fontSize||this.internal.getFontSize(),c=(function(A){if(A.widths&&A.kerning)return{widths:A.widths,kerning:A.kerning};var g=this.internal.getFont(A.fontName,A.fontStyle),N="Unicode";return g.metadata[N]?{widths:g.metadata[N].widths||{0:1},kerning:g.metadata[N].kerning||{}}:{font:g.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,a);r=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*s/l;c.textIndent=a.textIndent?1*a.textIndent*this.internal.scaleFactor/l:0,c.lineIndent=a.lineIndent;var m,u,x=[];for(m=0,u=r.length;m<u;m++)x=x.concat(Xw.apply(this,[r[m],o,c]));return x},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var s="0123456789abcdef",a="klmnopqrstuvwxyz",r={},l={},c=0;c<16;c++)r[a[c]]=s[c],l[s[c]]=a[c];var o=function(N){return"0x"+parseInt(N,10).toString(16)},m=t.__fontmetrics__.compress=function(N){var f,y,v,U,D=["{"];for(var M in N){if(f=N[M],isNaN(parseInt(M,10))?y="'"+M+"'":(M=parseInt(M,10),y=(y=o(M).slice(2)).slice(0,-1)+l[y.slice(-1)]),typeof f=="number")f<0?(v=o(f).slice(3),U="-"):(v=o(f).slice(2),U=""),v=U+v.slice(0,-1)+l[v.slice(-1)];else{if(Ra(f)!=="object")throw new Error("Don't know what to do with value type "+Ra(f)+".");v=m(f)}D.push(y+v)}return D.push("}"),D.join("")},u=t.__fontmetrics__.uncompress=function(N){if(typeof N!="string")throw new Error("Invalid argument passed to uncompress.");for(var f,y,v,U,D={},M=1,K=D,$=[],P="",se="",z=N.length-1,R=1;R<z;R+=1)(U=N[R])=="'"?f?(v=f.join(""),f=void 0):f=[]:f?f.push(U):U=="{"?($.push([K,v]),K={},v=void 0):U=="}"?((y=$.pop())[0][y[1]]=K,v=void 0,K=y[0]):U=="-"?M=-1:v===void 0?r.hasOwnProperty(U)?(P+=r[U],v=parseInt(P,16)*M,M=1,P=""):P+=U:r.hasOwnProperty(U)?(se+=r[U],K[v]=parseInt(se,16)*M,M=1,v=void 0,se=""):se+=U;return D},x={codePages:["WinAnsiEncoding"],WinAnsiEncoding:u("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},A={Unicode:{Courier:x,"Courier-Bold":x,"Courier-BoldOblique":x,"Courier-Oblique":x,Helvetica:x,"Helvetica-Bold":x,"Helvetica-BoldOblique":x,"Helvetica-Oblique":x,"Times-Roman":x,"Times-Bold":x,"Times-BoldItalic":x,"Times-Italic":x}},g={Unicode:{"Courier-Oblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":u("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":u("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:u("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:u("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":u("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":u("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(N){var f=N.font,y=g.Unicode[f.postScriptName];y&&(f.metadata.Unicode={},f.metadata.Unicode.widths=y.widths,f.metadata.Unicode.kerning=y.kerning);var v=A.Unicode[f.postScriptName];v&&(f.metadata.Unicode.encoding=v,f.encoding=v.codePages[0])}])})(ms.API),(function(t){var s=function(a){for(var r=a.length,l=new Uint8Array(r),c=0;c<r;c++)l[c]=a.charCodeAt(c);return l};t.API.events.push(["addFont",function(a){var r=void 0,l=a.font,c=a.instance;if(!l.isStandardFont){if(c===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+l.postScriptName+"').");if(typeof(r=c.existsFileInVFS(l.postScriptName)===!1?c.loadFile(l.postScriptName):c.getFileFromVFS(l.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+l.postScriptName+"').");(function(o,m){m=/^\x00\x01\x00\x00/.test(m)?s(m):s($A(m)),o.metadata=t.API.TTFFont.open(m),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(l,r)}}])})(ms),ms.API.addSvgAsImage=function(t,s,a,r,l,c,o,m){if(isNaN(s)||isNaN(a))throw Ja.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(r)||isNaN(l))throw Ja.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=r,u.height=l;var x=u.getContext("2d");x.fillStyle="#fff",x.fillRect(0,0,u.width,u.height);var A={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},g=this;return(Ps.canvg?Promise.resolve(Ps.canvg):lf(()=>import("./index.es-B6_xzEga.js"),[])).catch(function(N){return Promise.reject(new Error("Could not load canvg: "+N))}).then(function(N){return N.default?N.default:N}).then(function(N){return N.fromString(x,t,A)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(N){return N.render(A)}).then(function(){g.addImage(u.toDataURL("image/jpeg",1),s,a,r,l,o,m)})},ms.API.putTotalPages=function(t){var s,a=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(s=new RegExp(t,"g"),a=this.internal.getNumberOfPages()):(s=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),a=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var l=0;l<this.internal.pages[r].length;l++)this.internal.pages[r][l]=this.internal.pages[r][l].replace(s,a);return this},ms.API.viewerPreferences=function(t,s){var a;t=t||{},s=s||!1;var r,l,c,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},m=Object.keys(o),u=[],x=0,A=0,g=0;function N(y,v){var U,D=!1;for(U=0;U<y.length;U+=1)y[U]===v&&(D=!0);return D}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),a=this.internal.viewerpreferences.configuration,t==="reset"||s===!0){var f=m.length;for(g=0;g<f;g+=1)a[m[g]].value=a[m[g]].defaultValue,a[m[g]].explicitSet=!1}if(Ra(t)==="object"){for(l in t)if(c=t[l],N(m,l)&&c!==void 0){if(a[l].type==="boolean"&&typeof c=="boolean")a[l].value=c;else if(a[l].type==="name"&&N(a[l].valueSet,c))a[l].value=c;else if(a[l].type==="integer"&&Number.isInteger(c))a[l].value=c;else if(a[l].type==="array"){for(x=0;x<c.length;x+=1)if(r=!0,c[x].length===1&&typeof c[x][0]=="number")u.push(String(c[x]-1));else if(c[x].length>1){for(A=0;A<c[x].length;A+=1)typeof c[x][A]!="number"&&(r=!1);r===!0&&u.push([c[x][0]-1,c[x][1]-1].join(" "))}a[l].value="["+u.join(" ")+"]"}else a[l].value=a[l].defaultValue;a[l].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var y,v=[];for(y in a)a[y].explicitSet===!0&&(a[y].type==="name"?v.push("/"+y+" /"+a[y].value):v.push("/"+y+" "+a[y].value));v.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+v.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=a,this},(function(t){var s=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',l=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),c=unescape(encodeURIComponent(r)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),m=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),u=unescape(encodeURIComponent("</x:xmpmeta>")),x=c.length+o.length+m.length+l.length+u.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+x+" >>"),this.internal.write("stream"),this.internal.write(l+c+o+m+u),this.internal.write("endstream"),this.internal.write("endobj")},a=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(r,l){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:l||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",a),this.internal.events.subscribe("postPutResources",s)),this}})(ms.API),(function(t){var s=t.API,a=s.pdfEscape16=function(c,o){for(var m,u=o.metadata.Unicode.widths,x=["","0","00","000","0000"],A=[""],g=0,N=c.length;g<N;++g){if(m=o.metadata.characterToGlyph(c.charCodeAt(g)),o.metadata.glyIdsUsed.push(m),o.metadata.toUnicode[m]=c.charCodeAt(g),u.indexOf(m)==-1&&(u.push(m),u.push([parseInt(o.metadata.widthOfGlyph(m),10)])),m=="0")return A.join("");m=m.toString(16),A.push(x[4-m.length],m)}return A.join("")},r=function(c){var o,m,u,x,A,g,N;for(A=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,u=[],g=0,N=(m=Object.keys(c).sort(function(f,y){return f-y})).length;g<N;g++)o=m[g],u.length>=100&&(A+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar`,u=[]),c[o]!==void 0&&c[o]!==null&&typeof c[o].toString=="function"&&(x=("0000"+c[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),u.push("<"+o+"><"+x+">"));return u.length&&(A+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar
`),A+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};s.events.push(["putFont",function(c){(function(o){var m=o.font,u=o.out,x=o.newObject,A=o.putStream;if(m.metadata instanceof t.API.TTFFont&&m.encoding==="Identity-H"){for(var g=m.metadata.Unicode.widths,N=m.metadata.subset.encode(m.metadata.glyIdsUsed,1),f="",y=0;y<N.length;y++)f+=String.fromCharCode(N[y]);var v=x();A({data:f,addLength1:!0,objectId:v}),u("endobj");var U=x();A({data:r(m.metadata.toUnicode),addLength1:!0,objectId:U}),u("endobj");var D=x();u("<<"),u("/Type /FontDescriptor"),u("/FontName /"+Qu(m.fontName)),u("/FontFile2 "+v+" 0 R"),u("/FontBBox "+t.API.PDFObject.convert(m.metadata.bbox)),u("/Flags "+m.metadata.flags),u("/StemV "+m.metadata.stemV),u("/ItalicAngle "+m.metadata.italicAngle),u("/Ascent "+m.metadata.ascender),u("/Descent "+m.metadata.decender),u("/CapHeight "+m.metadata.capHeight),u(">>"),u("endobj");var M=x();u("<<"),u("/Type /Font"),u("/BaseFont /"+Qu(m.fontName)),u("/FontDescriptor "+D+" 0 R"),u("/W "+t.API.PDFObject.convert(g)),u("/CIDToGIDMap /Identity"),u("/DW 1000"),u("/Subtype /CIDFontType2"),u("/CIDSystemInfo"),u("<<"),u("/Supplement 0"),u("/Registry (Adobe)"),u("/Ordering ("+m.encoding+")"),u(">>"),u(">>"),u("endobj"),m.objectNumber=x(),u("<<"),u("/Type /Font"),u("/Subtype /Type0"),u("/ToUnicode "+U+" 0 R"),u("/BaseFont /"+Qu(m.fontName)),u("/Encoding /"+m.encoding),u("/DescendantFonts ["+M+" 0 R]"),u(">>"),u("endobj"),m.isAlreadyPutted=!0}})(c)}]),s.events.push(["putFont",function(c){(function(o){var m=o.font,u=o.out,x=o.newObject,A=o.putStream;if(m.metadata instanceof t.API.TTFFont&&m.encoding==="WinAnsiEncoding"){for(var g=m.metadata.rawData,N="",f=0;f<g.length;f++)N+=String.fromCharCode(g[f]);var y=x();A({data:N,addLength1:!0,objectId:y}),u("endobj");var v=x();A({data:r(m.metadata.toUnicode),addLength1:!0,objectId:v}),u("endobj");var U=x();u("<<"),u("/Descent "+m.metadata.decender),u("/CapHeight "+m.metadata.capHeight),u("/StemV "+m.metadata.stemV),u("/Type /FontDescriptor"),u("/FontFile2 "+y+" 0 R"),u("/Flags 96"),u("/FontBBox "+t.API.PDFObject.convert(m.metadata.bbox)),u("/FontName /"+Qu(m.fontName)),u("/ItalicAngle "+m.metadata.italicAngle),u("/Ascent "+m.metadata.ascender),u(">>"),u("endobj"),m.objectNumber=x();for(var D=0;D<m.metadata.hmtx.widths.length;D++)m.metadata.hmtx.widths[D]=parseInt(m.metadata.hmtx.widths[D]*(1e3/m.metadata.head.unitsPerEm));u("<</Subtype/TrueType/Type/Font/ToUnicode "+v+" 0 R/BaseFont/"+Qu(m.fontName)+"/FontDescriptor "+U+" 0 R/Encoding/"+m.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(m.metadata.hmtx.widths)+">>"),u("endobj"),m.isAlreadyPutted=!0}})(c)}]);var l=function(c){var o,m=c.text||"",u=c.x,x=c.y,A=c.options||{},g=c.mutex||{},N=g.pdfEscape,f=g.activeFontKey,y=g.fonts,v=f,U="",D=0,M="",K=y[v].encoding;if(y[v].encoding!=="Identity-H")return{text:m,x:u,y:x,options:A,mutex:g};for(M=m,v=f,Array.isArray(m)&&(M=m[0]),D=0;D<M.length;D+=1)y[v].metadata.hasOwnProperty("cmap")&&(o=y[v].metadata.cmap.unicode.codeMap[M[D].charCodeAt(0)]),o||M[D].charCodeAt(0)<256&&y[v].metadata.hasOwnProperty("Unicode")?U+=M[D]:U+="";var $="";return parseInt(v.slice(1))<14||K==="WinAnsiEncoding"?$=N(U,v).split("").map(function(P){return P.charCodeAt(0).toString(16)}).join(""):K==="Identity-H"&&($=a(U,y[v])),g.isHex=!0,{text:$,x:u,y:x,options:A,mutex:g}};s.events.push(["postProcessText",function(c){var o=c.text||"",m=[],u={text:o,x:c.x,y:c.y,options:c.options,mutex:c.mutex};if(Array.isArray(o)){var x=0;for(x=0;x<o.length;x+=1)Array.isArray(o[x])&&o[x].length===3?m.push([l(Object.assign({},u,{text:o[x][0]})).text,o[x][1],o[x][2]]):m.push(l(Object.assign({},u,{text:o[x]})).text);c.text=m}else c.text=l(Object.assign({},u,{text:o})).text}])})(ms),(function(t){var s=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(a){return s.call(this),this.internal.vFS[a]!==void 0},t.addFileToVFS=function(a,r){return s.call(this),this.internal.vFS[a]=r,this},t.getFileFromVFS=function(a){return s.call(this),this.internal.vFS[a]!==void 0?this.internal.vFS[a]:null}})(ms.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(r){var l,c,o,m,u,x,A,g=s,N=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],y={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},v={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},U=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],D=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),M=!1,K=0;this.__bidiEngine__={};var $=function(Q){var E=Q.charCodeAt(),te=E>>8,C=v[te];return C!==void 0?g[256*C+(255&E)]:te===252||te===253?"AL":D.test(te)?"L":te===8?"R":"N"},P=function(Q){for(var E,te=0;te<Q.length;te++){if((E=$(Q.charAt(te)))==="L")return!1;if(E==="R")return!0}return!1},se=function(Q,E,te,C){var O,V,re,ge,xe=E[C];switch(xe){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":M=!1;break;case"N":case"AN":break;case"EN":M&&(xe="AN");break;case"AL":M=!0,xe="R";break;case"WS":case"BN":xe="N";break;case"CS":C<1||C+1>=E.length||(O=te[C-1])!=="EN"&&O!=="AN"||(V=E[C+1])!=="EN"&&V!=="AN"?xe="N":M&&(V="AN"),xe=V===O?V:"N";break;case"ES":xe=(O=C>0?te[C-1]:"B")==="EN"&&C+1<E.length&&E[C+1]==="EN"?"EN":"N";break;case"ET":if(C>0&&te[C-1]==="EN"){xe="EN";break}if(M){xe="N";break}for(re=C+1,ge=E.length;re<ge&&E[re]==="ET";)re++;xe=re<ge&&E[re]==="EN"?"EN":"N";break;case"NSM":if(o&&!m){for(ge=E.length,re=C+1;re<ge&&E[re]==="NSM";)re++;if(re<ge){var Z=Q[C],I=Z>=1425&&Z<=2303||Z===64286;if(O=E[re],I&&(O==="R"||O==="AL")){xe="R";break}}}xe=C<1||(O=E[C-1])==="B"?"N":te[C-1];break;case"B":M=!1,l=!0,xe=K;break;case"S":c=!0,xe="N"}return xe},z=function(Q,E,te){var C=Q.split("");return te&&R(C,te,{hiLevel:K}),C.reverse(),E&&E.reverse(),C.join("")},R=function(Q,E,te){var C,O,V,re,ge,xe=-1,Z=Q.length,I=0,H=[],ae=K?f:N,k=[];for(M=!1,l=!1,c=!1,O=0;O<Z;O++)k[O]=$(Q[O]);for(V=0;V<Z;V++){if(ge=I,H[V]=se(Q,k,H,V),C=240&(I=ae[ge][y[H[V]]]),I&=15,E[V]=re=ae[I][5],C>0)if(C===16){for(O=xe;O<V;O++)E[O]=1;xe=-1}else xe=-1;if(ae[I][6])xe===-1&&(xe=V);else if(xe>-1){for(O=xe;O<V;O++)E[O]=re;xe=-1}k[V]==="B"&&(E[V]=0),te.hiLevel|=re}c&&(function(B,w,oe){for(var ne=0;ne<oe;ne++)if(B[ne]==="S"){w[ne]=K;for(var Fe=ne-1;Fe>=0&&B[Fe]==="WS";Fe--)w[Fe]=K}})(k,E,Z)},j=function(Q,E,te,C,O){if(!(O.hiLevel<Q)){if(Q===1&&K===1&&!l)return E.reverse(),void(te&&te.reverse());for(var V,re,ge,xe,Z=E.length,I=0;I<Z;){if(C[I]>=Q){for(ge=I+1;ge<Z&&C[ge]>=Q;)ge++;for(xe=I,re=ge-1;xe<re;xe++,re--)V=E[xe],E[xe]=E[re],E[re]=V,te&&(V=te[xe],te[xe]=te[re],te[re]=V);I=ge}I++}}},T=function(Q,E,te){var C=Q.split(""),O={hiLevel:K};return te||(te=[]),R(C,te,O),(function(V,re,ge){if(ge.hiLevel!==0&&A)for(var xe,Z=0;Z<V.length;Z++)re[Z]===1&&(xe=U.indexOf(V[Z]))>=0&&(V[Z]=U[xe+1])})(C,te,O),j(2,C,E,te,O),j(1,C,E,te,O),C.join("")};return this.__bidiEngine__.doBidiReorder=function(Q,E,te){if((function(O,V){if(V)for(var re=0;re<O.length;re++)V[re]=re;m===void 0&&(m=P(O)),x===void 0&&(x=P(O))})(Q,E),o||!u||x)if(o&&u&&m^x)K=m?1:0,Q=z(Q,E,te);else if(!o&&u&&x)K=m?1:0,Q=T(Q,E,te),Q=z(Q,E);else if(!o||m||u||x){if(o&&!u&&m^x)Q=z(Q,E),m?(K=0,Q=T(Q,E,te)):(K=1,Q=T(Q,E,te),Q=z(Q,E));else if(o&&m&&!u&&x)K=1,Q=T(Q,E,te),Q=z(Q,E);else if(!o&&!u&&m^x){var C=A;m?(K=1,Q=T(Q,E,te),K=0,A=!1,Q=T(Q,E,te),A=C):(K=0,Q=T(Q,E,te),Q=z(Q,E),K=1,A=!1,Q=T(Q,E,te),A=C,Q=z(Q,E))}}else K=0,Q=T(Q,E,te);else K=m?1:0,Q=T(Q,E,te);return Q},this.__bidiEngine__.setOptions=function(Q){Q&&(o=Q.isInputVisual,u=Q.isOutputVisual,m=Q.isInputRtl,x=Q.isOutputRtl,A=Q.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var s=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],a=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(r){var l=r.text;r.x,r.y;var c=r.options||{};r.mutex,c.lang;var o=[];if(c.isInputVisual=typeof c.isInputVisual!="boolean"||c.isInputVisual,a.setOptions(c),Object.prototype.toString.call(l)==="[object Array]"){var m=0;for(o=[],m=0;m<l.length;m+=1)Object.prototype.toString.call(l[m])==="[object Array]"?o.push([a.doBidiReorder(l[m][0]),l[m][1],l[m][2]]):o.push([a.doBidiReorder(l[m])]);r.text=o}else r.text=a.doBidiReorder(l);a.setOptions({isInputVisual:!0})}])})(ms),ms.API.TTFFont=(function(){function t(s){var a;if(this.rawData=s,a=this.contents=new zd(s),this.contents.pos=4,a.readString(4)==="ttcf")throw new Error("TTCF not supported.");a.pos=0,this.parse(),this.subset=new _U(this),this.registerTTF()}return t.open=function(s){return new t(s)},t.prototype.parse=function(){return this.directory=new mU(this.contents),this.head=new xU(this),this.name=new fU(this),this.cmap=new n5(this),this.toUnicode={},this.hhea=new hU(this),this.maxp=new bU(this),this.hmtx=new yU(this),this.post=new AU(this),this.os2=new pU(this),this.loca=new wU(this),this.glyf=new jU(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var s,a,r,l,c;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,m,u,x;for(x=[],o=0,m=(u=this.bbox).length;o<m;o++)s=u[o],x.push(Math.round(s*this.scaleFactor));return x}).call(this),this.stemV=0,this.post.exists?(r=255&(l=this.post.italic_angle),32768&(a=l>>16)&&(a=-(1+(65535^a))),this.italicAngle=+(a+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(c=this.familyClass)===1||c===2||c===3||c===4||c===5||c===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(s){var a;return((a=this.cmap.unicode)!=null?a.codeMap[s]:void 0)||0},t.prototype.widthOfGlyph=function(s){var a;return a=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(s).advance*a},t.prototype.widthOfString=function(s,a,r){var l,c,o,m;for(o=0,c=0,m=(s=""+s).length;0<=m?c<m:c>m;c=0<=m?++c:--c)l=s.charCodeAt(c),o+=this.widthOfGlyph(this.characterToGlyph(l))+r*(1e3/a)||0;return o*(a/1e3)},t.prototype.lineHeight=function(s,a){var r;return a==null&&(a=!1),r=a?this.lineGap:0,(this.ascender+r-this.decender)/1e3*s},t})();var Nc,zd=(function(){function t(s){this.data=s??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(s){return this.data[this.pos++]=s},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(s){return this.writeByte(s>>>24&255),this.writeByte(s>>16&255),this.writeByte(s>>8&255),this.writeByte(255&s)},t.prototype.readInt32=function(){var s;return(s=this.readUInt32())>=2147483648?s-4294967296:s},t.prototype.writeInt32=function(s){return s<0&&(s+=4294967296),this.writeUInt32(s)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(s){return this.writeByte(s>>8&255),this.writeByte(255&s)},t.prototype.readInt16=function(){var s;return(s=this.readUInt16())>=32768?s-65536:s},t.prototype.writeInt16=function(s){return s<0&&(s+=65536),this.writeUInt16(s)},t.prototype.readString=function(s){var a,r;for(r=[],a=0;0<=s?a<s:a>s;a=0<=s?++a:--a)r[a]=String.fromCharCode(this.readByte());return r.join("")},t.prototype.writeString=function(s){var a,r,l;for(l=[],a=0,r=s.length;0<=r?a<r:a>r;a=0<=r?++a:--a)l.push(this.writeByte(s.charCodeAt(a)));return l},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(s){return this.writeInt16(s)},t.prototype.readLongLong=function(){var s,a,r,l,c,o,m,u;return s=this.readByte(),a=this.readByte(),r=this.readByte(),l=this.readByte(),c=this.readByte(),o=this.readByte(),m=this.readByte(),u=this.readByte(),128&s?-1*(72057594037927940*(255^s)+281474976710656*(255^a)+1099511627776*(255^r)+4294967296*(255^l)+16777216*(255^c)+65536*(255^o)+256*(255^m)+(255^u)+1):72057594037927940*s+281474976710656*a+1099511627776*r+4294967296*l+16777216*c+65536*o+256*m+u},t.prototype.writeLongLong=function(s){var a,r;return a=Math.floor(s/4294967296),r=4294967295&s,this.writeByte(a>>24&255),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(s){return this.writeInt32(s)},t.prototype.read=function(s){var a,r;for(a=[],r=0;0<=s?r<s:r>s;r=0<=s?++r:--r)a.push(this.readByte());return a},t.prototype.write=function(s){var a,r,l,c;for(c=[],r=0,l=s.length;r<l;r++)a=s[r],c.push(this.writeByte(a));return c},t})(),mU=(function(){var t;function s(a){var r,l,c;for(this.scalarType=a.readInt(),this.tableCount=a.readShort(),this.searchRange=a.readShort(),this.entrySelector=a.readShort(),this.rangeShift=a.readShort(),this.tables={},l=0,c=this.tableCount;0<=c?l<c:l>c;l=0<=c?++l:--l)r={tag:a.readString(4),checksum:a.readInt(),offset:a.readInt(),length:a.readInt()},this.tables[r.tag]=r}return s.prototype.encode=function(a){var r,l,c,o,m,u,x,A,g,N,f,y,v;for(v in f=Object.keys(a).length,u=Math.log(2),g=16*Math.floor(Math.log(f)/u),o=Math.floor(g/u),A=16*f-g,(l=new zd).writeInt(this.scalarType),l.writeShort(f),l.writeShort(g),l.writeShort(o),l.writeShort(A),c=16*f,x=l.pos+c,m=null,y=[],a)for(N=a[v],l.writeString(v),l.writeInt(t(N)),l.writeInt(x),l.writeInt(N.length),y=y.concat(N),v==="head"&&(m=x),x+=N.length;x%4;)y.push(0),x++;return l.write(y),r=2981146554-t(l.data),l.pos=m+8,l.writeUInt32(r),l.data},t=function(a){var r,l,c,o;for(a=l5.call(a);a.length%4;)a.push(0);for(c=new zd(a),l=0,r=0,o=a.length;r<o;r=r+=4)l+=c.readUInt32();return 4294967295&l},s})(),uU={}.hasOwnProperty,Jc=function(t,s){for(var a in s)uU.call(s,a)&&(t[a]=s[a]);function r(){this.constructor=t}return r.prototype=s.prototype,t.prototype=new r,t.__super__=s.prototype,t};Nc=(function(){function t(s){var a;this.file=s,a=this.file.directory.tables[this.tag],this.exists=!!a,a&&(this.offset=a.offset,this.length=a.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var xU=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Jc(t,Nc),t.prototype.tag="head",t.prototype.parse=function(s){return s.pos=this.offset,this.version=s.readInt(),this.revision=s.readInt(),this.checkSumAdjustment=s.readInt(),this.magicNumber=s.readInt(),this.flags=s.readShort(),this.unitsPerEm=s.readShort(),this.created=s.readLongLong(),this.modified=s.readLongLong(),this.xMin=s.readShort(),this.yMin=s.readShort(),this.xMax=s.readShort(),this.yMax=s.readShort(),this.macStyle=s.readShort(),this.lowestRecPPEM=s.readShort(),this.fontDirectionHint=s.readShort(),this.indexToLocFormat=s.readShort(),this.glyphDataFormat=s.readShort()},t.prototype.encode=function(s){var a;return(a=new zd).writeInt(this.version),a.writeInt(this.revision),a.writeInt(this.checkSumAdjustment),a.writeInt(this.magicNumber),a.writeShort(this.flags),a.writeShort(this.unitsPerEm),a.writeLongLong(this.created),a.writeLongLong(this.modified),a.writeShort(this.xMin),a.writeShort(this.yMin),a.writeShort(this.xMax),a.writeShort(this.yMax),a.writeShort(this.macStyle),a.writeShort(this.lowestRecPPEM),a.writeShort(this.fontDirectionHint),a.writeShort(s),a.writeShort(this.glyphDataFormat),a.data},t})(),l2=(function(){function t(s,a){var r,l,c,o,m,u,x,A,g,N,f,y,v,U,D,M,K;switch(this.platformID=s.readUInt16(),this.encodingID=s.readShort(),this.offset=a+s.readInt(),g=s.pos,s.pos=this.offset,this.format=s.readUInt16(),this.length=s.readUInt16(),this.language=s.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(u=0;u<256;++u)this.codeMap[u]=s.readByte();break;case 4:for(f=s.readUInt16(),N=f/2,s.pos+=6,c=(function(){var $,P;for(P=[],u=$=0;0<=N?$<N:$>N;u=0<=N?++$:--$)P.push(s.readUInt16());return P})(),s.pos+=2,v=(function(){var $,P;for(P=[],u=$=0;0<=N?$<N:$>N;u=0<=N?++$:--$)P.push(s.readUInt16());return P})(),x=(function(){var $,P;for(P=[],u=$=0;0<=N?$<N:$>N;u=0<=N?++$:--$)P.push(s.readUInt16());return P})(),A=(function(){var $,P;for(P=[],u=$=0;0<=N?$<N:$>N;u=0<=N?++$:--$)P.push(s.readUInt16());return P})(),l=(this.length-s.pos+this.offset)/2,m=(function(){var $,P;for(P=[],u=$=0;0<=l?$<l:$>l;u=0<=l?++$:--$)P.push(s.readUInt16());return P})(),u=D=0,K=c.length;D<K;u=++D)for(U=c[u],r=M=y=v[u];y<=U?M<=U:M>=U;r=y<=U?++M:--M)A[u]===0?o=r+x[u]:(o=m[A[u]/2+(r-y)-(N-u)]||0)!==0&&(o+=x[u]),this.codeMap[r]=65535&o}s.pos=g}return t.encode=function(s,a){var r,l,c,o,m,u,x,A,g,N,f,y,v,U,D,M,K,$,P,se,z,R,j,T,Q,E,te,C,O,V,re,ge,xe,Z,I,H,ae,k,B,w,oe,ne,Fe,je,Ge,ze;switch(C=new zd,o=Object.keys(s).sort(function(Xe,st){return Xe-st}),a){case"macroman":for(v=0,U=(function(){var Xe=[];for(y=0;y<256;++y)Xe.push(0);return Xe})(),M={0:0},c={},O=0,xe=o.length;O<xe;O++)M[Fe=s[l=o[O]]]==null&&(M[Fe]=++v),c[l]={old:s[l],new:M[s[l]]},U[l]=M[s[l]];return C.writeUInt16(1),C.writeUInt16(0),C.writeUInt32(12),C.writeUInt16(0),C.writeUInt16(262),C.writeUInt16(0),C.write(U),{charMap:c,subtable:C.data,maxGlyphID:v+1};case"unicode":for(E=[],g=[],K=0,M={},r={},D=x=null,V=0,Z=o.length;V<Z;V++)M[P=s[l=o[V]]]==null&&(M[P]=++K),r[l]={old:P,new:M[P]},m=M[P]-l,D!=null&&m===x||(D&&g.push(D),E.push(l),x=m),D=l;for(D&&g.push(D),g.push(65535),E.push(65535),T=2*(j=E.length),R=2*Math.pow(Math.log(j)/Math.LN2,2),N=Math.log(R/2)/Math.LN2,z=2*j-R,u=[],se=[],f=[],y=re=0,I=E.length;re<I;y=++re){if(Q=E[y],A=g[y],Q===65535){u.push(0),se.push(0);break}if(Q-(te=r[Q].new)>=32768)for(u.push(0),se.push(2*(f.length+j-y)),l=ge=Q;Q<=A?ge<=A:ge>=A;l=Q<=A?++ge:--ge)f.push(r[l].new);else u.push(te-Q),se.push(0)}for(C.writeUInt16(3),C.writeUInt16(1),C.writeUInt32(12),C.writeUInt16(4),C.writeUInt16(16+8*j+2*f.length),C.writeUInt16(0),C.writeUInt16(T),C.writeUInt16(R),C.writeUInt16(N),C.writeUInt16(z),oe=0,H=g.length;oe<H;oe++)l=g[oe],C.writeUInt16(l);for(C.writeUInt16(0),ne=0,ae=E.length;ne<ae;ne++)l=E[ne],C.writeUInt16(l);for(je=0,k=u.length;je<k;je++)m=u[je],C.writeUInt16(m);for(Ge=0,B=se.length;Ge<B;Ge++)$=se[Ge],C.writeUInt16($);for(ze=0,w=f.length;ze<w;ze++)v=f[ze],C.writeUInt16(v);return{charMap:r,subtable:C.data,maxGlyphID:K+1}}},t})(),n5=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Jc(t,Nc),t.prototype.tag="cmap",t.prototype.parse=function(s){var a,r,l;for(s.pos=this.offset,this.version=s.readUInt16(),l=s.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=l?r<l:r>l;r=0<=l?++r:--r)a=new l2(s,this.offset),this.tables.push(a),a.isUnicode&&this.unicode==null&&(this.unicode=a);return!0},t.encode=function(s,a){var r,l;return a==null&&(a="macroman"),r=l2.encode(s,a),(l=new zd).writeUInt16(0),l.writeUInt16(1),r.table=l.data.concat(r.subtable),r},t})(),hU=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Jc(t,Nc),t.prototype.tag="hhea",t.prototype.parse=function(s){return s.pos=this.offset,this.version=s.readInt(),this.ascender=s.readShort(),this.decender=s.readShort(),this.lineGap=s.readShort(),this.advanceWidthMax=s.readShort(),this.minLeftSideBearing=s.readShort(),this.minRightSideBearing=s.readShort(),this.xMaxExtent=s.readShort(),this.caretSlopeRise=s.readShort(),this.caretSlopeRun=s.readShort(),this.caretOffset=s.readShort(),s.pos+=8,this.metricDataFormat=s.readShort(),this.numberOfMetrics=s.readUInt16()},t})(),pU=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Jc(t,Nc),t.prototype.tag="OS/2",t.prototype.parse=function(s){if(s.pos=this.offset,this.version=s.readUInt16(),this.averageCharWidth=s.readShort(),this.weightClass=s.readUInt16(),this.widthClass=s.readUInt16(),this.type=s.readShort(),this.ySubscriptXSize=s.readShort(),this.ySubscriptYSize=s.readShort(),this.ySubscriptXOffset=s.readShort(),this.ySubscriptYOffset=s.readShort(),this.ySuperscriptXSize=s.readShort(),this.ySuperscriptYSize=s.readShort(),this.ySuperscriptXOffset=s.readShort(),this.ySuperscriptYOffset=s.readShort(),this.yStrikeoutSize=s.readShort(),this.yStrikeoutPosition=s.readShort(),this.familyClass=s.readShort(),this.panose=(function(){var a,r;for(r=[],a=0;a<10;++a)r.push(s.readByte());return r})(),this.charRange=(function(){var a,r;for(r=[],a=0;a<4;++a)r.push(s.readInt());return r})(),this.vendorID=s.readString(4),this.selection=s.readShort(),this.firstCharIndex=s.readShort(),this.lastCharIndex=s.readShort(),this.version>0&&(this.ascent=s.readShort(),this.descent=s.readShort(),this.lineGap=s.readShort(),this.winAscent=s.readShort(),this.winDescent=s.readShort(),this.codePageRange=(function(){var a,r;for(r=[],a=0;a<2;a=++a)r.push(s.readInt());return r})(),this.version>1))return this.xHeight=s.readShort(),this.capHeight=s.readShort(),this.defaultChar=s.readShort(),this.breakChar=s.readShort(),this.maxContext=s.readShort()},t})(),AU=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Jc(t,Nc),t.prototype.tag="post",t.prototype.parse=function(s){var a,r,l;switch(s.pos=this.offset,this.format=s.readInt(),this.italicAngle=s.readInt(),this.underlinePosition=s.readShort(),this.underlineThickness=s.readShort(),this.isFixedPitch=s.readInt(),this.minMemType42=s.readInt(),this.maxMemType42=s.readInt(),this.minMemType1=s.readInt(),this.maxMemType1=s.readInt(),this.format){case 65536:case 196608:break;case 131072:var c;for(r=s.readUInt16(),this.glyphNameIndex=[],c=0;0<=r?c<r:c>r;c=0<=r?++c:--c)this.glyphNameIndex.push(s.readUInt16());for(this.names=[],l=[];s.pos<this.offset+this.length;)a=s.readByte(),l.push(this.names.push(s.readString(a)));return l;case 151552:return r=s.readUInt16(),this.offsets=s.read(r);case 262144:return this.map=(function(){var o,m,u;for(u=[],c=o=0,m=this.file.maxp.numGlyphs;0<=m?o<m:o>m;c=0<=m?++o:--o)u.push(s.readUInt32());return u}).call(this)}},t})(),gU=function(t,s){this.raw=t,this.length=t.length,this.platformID=s.platformID,this.encodingID=s.encodingID,this.languageID=s.languageID},fU=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Jc(t,Nc),t.prototype.tag="name",t.prototype.parse=function(s){var a,r,l,c,o,m,u,x,A,g,N;for(s.pos=this.offset,s.readShort(),a=s.readShort(),m=s.readShort(),r=[],c=0;0<=a?c<a:c>a;c=0<=a?++c:--c)r.push({platformID:s.readShort(),encodingID:s.readShort(),languageID:s.readShort(),nameID:s.readShort(),length:s.readShort(),offset:this.offset+m+s.readShort()});for(u={},c=A=0,g=r.length;A<g;c=++A)l=r[c],s.pos=l.offset,x=s.readString(l.length),o=new gU(x,l),u[N=l.nameID]==null&&(u[N]=[]),u[l.nameID].push(o);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},t})(),bU=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Jc(t,Nc),t.prototype.tag="maxp",t.prototype.parse=function(s){return s.pos=this.offset,this.version=s.readInt(),this.numGlyphs=s.readUInt16(),this.maxPoints=s.readUInt16(),this.maxContours=s.readUInt16(),this.maxCompositePoints=s.readUInt16(),this.maxComponentContours=s.readUInt16(),this.maxZones=s.readUInt16(),this.maxTwilightPoints=s.readUInt16(),this.maxStorage=s.readUInt16(),this.maxFunctionDefs=s.readUInt16(),this.maxInstructionDefs=s.readUInt16(),this.maxStackElements=s.readUInt16(),this.maxSizeOfInstructions=s.readUInt16(),this.maxComponentElements=s.readUInt16(),this.maxComponentDepth=s.readUInt16()},t})(),yU=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Jc(t,Nc),t.prototype.tag="hmtx",t.prototype.parse=function(s){var a,r,l,c,o,m,u;for(s.pos=this.offset,this.metrics=[],a=0,m=this.file.hhea.numberOfMetrics;0<=m?a<m:a>m;a=0<=m?++a:--a)this.metrics.push({advance:s.readUInt16(),lsb:s.readInt16()});for(l=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var x,A;for(A=[],a=x=0;0<=l?x<l:x>l;a=0<=l?++x:--x)A.push(s.readInt16());return A})(),this.widths=(function(){var x,A,g,N;for(N=[],x=0,A=(g=this.metrics).length;x<A;x++)c=g[x],N.push(c.advance);return N}).call(this),r=this.widths[this.widths.length-1],u=[],a=o=0;0<=l?o<l:o>l;a=0<=l?++o:--o)u.push(this.widths.push(r));return u},t.prototype.forGlyph=function(s){return s in this.metrics?this.metrics[s]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[s-this.metrics.length]}},t})(),l5=[].slice,jU=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Jc(t,Nc),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(s){var a,r,l,c,o,m,u,x,A,g;return s in this.cache?this.cache[s]:(c=this.file.loca,a=this.file.contents,r=c.indexOf(s),(l=c.lengthOf(s))===0?this.cache[s]=null:(a.pos=this.offset+r,o=(m=new zd(a.read(l))).readShort(),x=m.readShort(),g=m.readShort(),u=m.readShort(),A=m.readShort(),this.cache[s]=o===-1?new NU(m,x,g,u,A):new vU(m,o,x,g,u,A),this.cache[s]))},t.prototype.encode=function(s,a,r){var l,c,o,m,u;for(o=[],c=[],m=0,u=a.length;m<u;m++)l=s[a[m]],c.push(o.length),l&&(o=o.concat(l.encode(r)));return c.push(o.length),{table:o,offsets:c}},t})(),vU=(function(){function t(s,a,r,l,c,o){this.raw=s,this.numberOfContours=a,this.xMin=r,this.yMin=l,this.xMax=c,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),NU=(function(){function t(s,a,r,l,c){var o,m;for(this.raw=s,this.xMin=a,this.yMin=r,this.xMax=l,this.yMax=c,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;m=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&m;)o.pos+=1&m?4:2,128&m?o.pos+=8:64&m?o.pos+=4:8&m&&(o.pos+=2)}return t.prototype.encode=function(){var s,a,r;for(a=new zd(l5.call(this.raw.data)),s=0,r=this.glyphIDs.length;s<r;++s)a.pos=this.glyphOffsets[s];return a.data},t})(),wU=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Jc(t,Nc),t.prototype.tag="loca",t.prototype.parse=function(s){var a,r;return s.pos=this.offset,a=this.file.head.indexToLocFormat,this.offsets=a===0?(function(){var l,c;for(c=[],r=0,l=this.length;r<l;r+=2)c.push(2*s.readUInt16());return c}).call(this):(function(){var l,c;for(c=[],r=0,l=this.length;r<l;r+=4)c.push(s.readUInt32());return c}).call(this)},t.prototype.indexOf=function(s){return this.offsets[s]},t.prototype.lengthOf=function(s){return this.offsets[s+1]-this.offsets[s]},t.prototype.encode=function(s,a){for(var r=new Uint32Array(this.offsets.length),l=0,c=0,o=0;o<r.length;++o)if(r[o]=l,c<a.length&&a[c]==o){++c,r[o]=l;var m=this.offsets[o],u=this.offsets[o+1]-m;u>0&&(l+=u)}for(var x=new Array(4*r.length),A=0;A<r.length;++A)x[4*A+3]=255&r[A],x[4*A+2]=(65280&r[A])>>8,x[4*A+1]=(16711680&r[A])>>16,x[4*A]=(4278190080&r[A])>>24;return x},t})(),_U=(function(){function t(s){this.font=s,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var s,a,r,l,c;for(a in l=this.font.cmap.tables[0].codeMap,s={},c=this.subset)r=c[a],s[a]=l[r];return s},t.prototype.glyphsFor=function(s){var a,r,l,c,o,m,u;for(l={},o=0,m=s.length;o<m;o++)l[c=s[o]]=this.font.glyf.glyphFor(c);for(c in a=[],l)(r=l[c])!=null&&r.compound&&a.push.apply(a,r.glyphIDs);if(a.length>0)for(c in u=this.glyphsFor(a))r=u[c],l[c]=r;return l},t.prototype.encode=function(s,a){var r,l,c,o,m,u,x,A,g,N,f,y,v,U,D;for(l in r=n5.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(s),f={0:0},D=r.charMap)f[(u=D[l]).old]=u.new;for(y in N=r.maxGlyphID,o)y in f||(f[y]=N++);return A=(function(M){var K,$;for(K in $={},M)$[M[K]]=K;return $})(f),g=Object.keys(A).sort(function(M,K){return M-K}),v=(function(){var M,K,$;for($=[],M=0,K=g.length;M<K;M++)m=g[M],$.push(A[m]);return $})(),c=this.font.glyf.encode(o,v,f),x=this.font.loca.encode(c.offsets,v),U={cmap:this.font.cmap.raw(),glyf:c.table,loca:x,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(a)},this.font.os2.exists&&(U["OS/2"]=this.font.os2.raw()),this.font.directory.encode(U)},t})();ms.API.PDFObject=(function(){var t;function s(){}return t=function(a,r){return(Array(r+1).join("0")+a).slice(-r)},s.convert=function(a){var r,l,c,o;if(Array.isArray(a))return"["+(function(){var m,u,x;for(x=[],m=0,u=a.length;m<u;m++)r=a[m],x.push(s.convert(r));return x})().join(" ")+"]";if(typeof a=="string")return"/"+a;if(a?.isString)return"("+a+")";if(a instanceof Date)return"(D:"+t(a.getUTCFullYear(),4)+t(a.getUTCMonth(),2)+t(a.getUTCDate(),2)+t(a.getUTCHours(),2)+t(a.getUTCMinutes(),2)+t(a.getUTCSeconds(),2)+"Z)";if({}.toString.call(a)==="[object Object]"){for(l in c=["<<"],a)o=a[l],c.push("/"+l+" "+s.convert(o));return c.push(">>"),c.join(`
`)}return""+a},s})();function i5(t,s,a,r,l){r=r||{};var c=1.15,o=l.internal.scaleFactor,m=l.internal.getFontSize()/o,u=l.getLineHeightFactor?l.getLineHeightFactor():c,x=m*u,A=/\r\n|\r|\n/g,g="",N=1;if((r.valign==="middle"||r.valign==="bottom"||r.halign==="center"||r.halign==="right")&&(g=typeof t=="string"?t.split(A):t,N=g.length||1),a+=m*(2-c),r.valign==="middle"?a-=N/2*x:r.valign==="bottom"&&(a-=N*x),r.halign==="center"||r.halign==="right"){var f=m;if(r.halign==="center"&&(f*=.5),g&&N>=1){for(var y=0;y<g.length;y++)l.text(g[y],s-l.getStringUnitWidth(g[y])*f,a),a+=x;return l}s-=l.getStringUnitWidth(t)*f}return r.halign==="justify"?l.text(t,s,a,{maxWidth:r.maxWidth||100,align:"justify"}):l.text(t,s,a),l}var i2={},Yu=(function(){function t(s){this.jsPDFDocument=s,this.userStyles={textColor:s.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:s.internal.getFontSize(),fontStyle:s.internal.getFont().fontStyle,font:s.internal.getFont().fontName,lineWidth:s.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:s.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(s,a){a===void 0&&(a=null),a?a.__autoTableDocumentDefaults=s:i2=s},t.unifyColor=function(s){return Array.isArray(s)?s:typeof s=="number"?[s,s,s]:typeof s=="string"?[s]:null},t.prototype.applyStyles=function(s,a){var r,l,c;a===void 0&&(a=!1),s.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(s.fontStyle);var o=this.jsPDFDocument.internal.getFont(),m=o.fontStyle,u=o.fontName;if(s.font&&(u=s.font),s.fontStyle){m=s.fontStyle;var x=this.getFontList()[u];x&&x.indexOf(m)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(x[0]),m=x[0])}if(this.jsPDFDocument.setFont(u,m),s.fontSize&&this.jsPDFDocument.setFontSize(s.fontSize),!a){var A=t.unifyColor(s.fillColor);A&&(r=this.jsPDFDocument).setFillColor.apply(r,A),A=t.unifyColor(s.textColor),A&&(l=this.jsPDFDocument).setTextColor.apply(l,A),A=t.unifyColor(s.lineColor),A&&(c=this.jsPDFDocument).setDrawColor.apply(c,A),typeof s.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(s.lineWidth)}},t.prototype.splitTextToSize=function(s,a,r){return this.jsPDFDocument.splitTextToSize(s,a,r)},t.prototype.rect=function(s,a,r,l,c){return this.jsPDFDocument.rect(s,a,r,l,c)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(s){return this.jsPDFDocument.getTextWidth(s)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(s){this.jsPDFDocument.setPage(s)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return i2||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var s=this.jsPDFDocument.internal.pageSize;return s.width==null&&(s={width:s.getWidth(),height:s.getHeight()}),s},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var s=this.jsPDFDocument;return s.getLineHeightFactor?s.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(s){return s/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var s=this.jsPDFDocument.internal.getCurrentPageInfo();return s?s.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t})(),Bb=function(t,s){return Bb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,r){a.__proto__=r}||function(a,r){for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(a[l]=r[l])},Bb(t,s)};function c5(t,s){if(typeof s!="function"&&s!==null)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");Bb(t,s);function a(){this.constructor=t}t.prototype=s===null?Object.create(s):(a.prototype=s.prototype,new a)}var o5=(function(t){c5(s,t);function s(a){var r=t.call(this)||this;return r._element=a,r}return s})(Array);function CU(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function SU(t){var s={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return s[t]}function rg(t,s,a){a.applyStyles(s,!0);var r=Array.isArray(t)?t:[t],l=r.map(function(c){return a.getTextWidth(c)}).reduce(function(c,o){return Math.max(c,o)},0);return l}function d5(t,s,a,r){var l=s.settings.tableLineWidth,c=s.settings.tableLineColor;t.applyStyles({lineWidth:l,lineColor:c});var o=m5(l,!1);o&&t.rect(a.x,a.y,s.getWidth(t.pageSize().width),r.y-a.y,o)}function m5(t,s){var a=t>0,r=s||s===0;return a&&r?"DF":a?"S":r?"F":null}function Cg(t,s){var a,r,l,c;if(t=t||s,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=s}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(a=t.left)!==null&&a!==void 0?a:s,top:(r=t.top)!==null&&r!==void 0?r:s,right:(l=t.right)!==null&&l!==void 0?l:s,bottom:(c=t.bottom)!==null&&c!==void 0?c:s}):(typeof t!="number"&&(t=s),{top:t,right:t,bottom:t,left:t})}function u5(t,s){var a=Cg(s.settings.margin,0);return t.pageSize().width-(a.left+a.right)}function kU(t,s,a,r,l){var c={},o=1.3333333333333333,m=Bf(s,function(K){return l.getComputedStyle(K).backgroundColor});m!=null&&(c.fillColor=m);var u=Bf(s,function(K){return l.getComputedStyle(K).color});u!=null&&(c.textColor=u);var x=FU(r,a);x&&(c.cellPadding=x);var A="borderTopColor",g=o*a,N=r.borderTopWidth;if(r.borderBottomWidth===N&&r.borderRightWidth===N&&r.borderLeftWidth===N){var f=(parseFloat(N)||0)/g;f&&(c.lineWidth=f)}else c.lineWidth={top:(parseFloat(r.borderTopWidth)||0)/g,right:(parseFloat(r.borderRightWidth)||0)/g,bottom:(parseFloat(r.borderBottomWidth)||0)/g,left:(parseFloat(r.borderLeftWidth)||0)/g},c.lineWidth.top||(c.lineWidth.right?A="borderRightColor":c.lineWidth.bottom?A="borderBottomColor":c.lineWidth.left&&(A="borderLeftColor"));var y=Bf(s,function(K){return l.getComputedStyle(K)[A]});y!=null&&(c.lineColor=y);var v=["left","right","center","justify"];v.indexOf(r.textAlign)!==-1&&(c.halign=r.textAlign),v=["middle","bottom","top"],v.indexOf(r.verticalAlign)!==-1&&(c.valign=r.verticalAlign);var U=parseInt(r.fontSize||"");isNaN(U)||(c.fontSize=U/o);var D=BU(r);D&&(c.fontStyle=D);var M=(r.fontFamily||"").toLowerCase();return t.indexOf(M)!==-1&&(c.font=M),c}function BU(t){var s="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(s="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(s+="italic"),s}function Bf(t,s){var a=x5(t,s);if(!a)return null;var r=a.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!r||!Array.isArray(r))return null;var l=[parseInt(r[1]),parseInt(r[2]),parseInt(r[3])],c=parseInt(r[4]);return c===0||isNaN(l[0])||isNaN(l[1])||isNaN(l[2])?null:l}function x5(t,s){var a=s(t);return a==="rgba(0, 0, 0, 0)"||a==="transparent"||a==="initial"||a==="inherit"?t.parentElement==null?null:x5(t.parentElement,s):a}function FU(t,s){var a=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],r=96/(72/s),l=(parseInt(t.lineHeight)-parseInt(t.fontSize))/s/2,c=a.map(function(m){return parseInt(m||"0")/r}),o=Cg(c,0);return l>o.top&&(o.top=l),l>o.bottom&&(o.bottom=l),o}function h5(t,s,a,r,l){var c,o;r===void 0&&(r=!1),l===void 0&&(l=!1);var m;typeof s=="string"?m=a.document.querySelector(s):m=s;var u=Object.keys(t.getFontList()),x=t.scaleFactor(),A=[],g=[],N=[];if(!m)return console.error("Html table could not be found with input: ",s),{head:A,body:g,foot:N};for(var f=0;f<m.rows.length;f++){var y=m.rows[f],v=(o=(c=y?.parentElement)===null||c===void 0?void 0:c.tagName)===null||o===void 0?void 0:o.toLowerCase(),U=EU(u,x,a,y,r,l);U&&(v==="thead"?A.push(U):v==="tfoot"?N.push(U):g.push(U))}return{head:A,body:g,foot:N}}function EU(t,s,a,r,l,c){for(var o=new o5(r),m=0;m<r.cells.length;m++){var u=r.cells[m],x=a.getComputedStyle(u);if(l||x.display!=="none"){var A=void 0;c&&(A=kU(t,u,s,x,a)),o.push({rowSpan:u.rowSpan,colSpan:u.colSpan,styles:A,_element:u,content:DU(u)})}}var g=a.getComputedStyle(r);if(o.length>0&&(l||g.display!=="none"))return o}function DU(t){var s=t.cloneNode(!0);return s.innerHTML=s.innerHTML.replace(/\n/g,"").replace(/ +/g," "),s.innerHTML=s.innerHTML.split(/<br.*?>/).map(function(a){return a.trim()}).join(`
`),s.innerText||s.textContent||""}function UU(t,s,a){for(var r=0,l=[t,s,a];r<l.length;r++){var c=l[r];c&&typeof c!="object"&&console.error("The options parameter should be of type object, is: "+typeof c),c.startY&&typeof c.startY!="number"&&(console.error("Invalid value for startY option",c.startY),delete c.startY)}}function Mo(t,s,a,r,l){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var c=Object(t),o=1;o<arguments.length;o++){var m=arguments[o];if(m!=null)for(var u in m)Object.prototype.hasOwnProperty.call(m,u)&&(c[u]=m[u])}return c}function p5(t,s){var a=new Yu(t),r=a.getDocumentOptions(),l=a.getGlobalOptions();UU(l,r,s);var c=Mo({},l,r,s),o;typeof window<"u"&&(o=window);var m=TU(l,r,s),u=LU(l,r,s),x=QU(a,c),A=MU(a,c,o);return{id:s.tableId,content:A,hooks:u,styles:m,settings:x}}function TU(t,s,a){for(var r={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},l=function(u){if(u==="columnStyles"){var x=t[u],A=s[u],g=a[u];r.columnStyles=Mo({},x,A,g)}else{var N=[t,s,a],f=N.map(function(y){return y[u]||{}});r[u]=Mo({},f[0],f[1],f[2])}},c=0,o=Object.keys(r);c<o.length;c++){var m=o[c];l(m)}return r}function LU(t,s,a){for(var r=[t,s,a],l={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},c=0,o=r;c<o.length;c++){var m=o[c];m.didParseCell&&l.didParseCell.push(m.didParseCell),m.willDrawCell&&l.willDrawCell.push(m.willDrawCell),m.didDrawCell&&l.didDrawCell.push(m.didDrawCell),m.willDrawPage&&l.willDrawPage.push(m.willDrawPage),m.didDrawPage&&l.didDrawPage.push(m.didDrawPage)}return l}function QU(t,s){var a,r,l,c,o,m,u,x,A,g,N,f,y=Cg(s.margin,40/t.scaleFactor()),v=(a=RU(t,s.startY))!==null&&a!==void 0?a:y.top,U;s.showFoot===!0?U="everyPage":s.showFoot===!1?U="never":U=(r=s.showFoot)!==null&&r!==void 0?r:"everyPage";var D;s.showHead===!0?D="everyPage":s.showHead===!1?D="never":D=(l=s.showHead)!==null&&l!==void 0?l:"everyPage";var M=(c=s.useCss)!==null&&c!==void 0?c:!1,K=s.theme||(M?"plain":"striped"),$=!!s.horizontalPageBreak,P=(o=s.horizontalPageBreakRepeat)!==null&&o!==void 0?o:null;return{includeHiddenHtml:(m=s.includeHiddenHtml)!==null&&m!==void 0?m:!1,useCss:M,theme:K,startY:v,margin:y,pageBreak:(u=s.pageBreak)!==null&&u!==void 0?u:"auto",rowPageBreak:(x=s.rowPageBreak)!==null&&x!==void 0?x:"auto",tableWidth:(A=s.tableWidth)!==null&&A!==void 0?A:"auto",showHead:D,showFoot:U,tableLineWidth:(g=s.tableLineWidth)!==null&&g!==void 0?g:0,tableLineColor:(N=s.tableLineColor)!==null&&N!==void 0?N:200,horizontalPageBreak:$,horizontalPageBreakRepeat:P,horizontalPageBreakBehaviour:(f=s.horizontalPageBreakBehaviour)!==null&&f!==void 0?f:"afterAllRows"}}function RU(t,s){var a=t.getLastAutoTable(),r=t.scaleFactor(),l=t.pageNumber(),c=!1;if(a&&a.startPageNumber){var o=a.startPageNumber+a.pageNumber-1;c=o===l}return typeof s=="number"?s:(s==null||s===!1)&&c&&a?.finalY!=null?a.finalY+20/r:null}function MU(t,s,a){var r=s.head||[],l=s.body||[],c=s.foot||[];if(s.html){var o=s.includeHiddenHtml;if(a){var m=h5(t,s.html,a,o,s.useCss)||{};r=m.head||r,l=m.body||r,c=m.foot||r}else console.error("Cannot parse html in non browser environment")}var u=s.columns||IU(r,l,c);return{columns:u,head:r,body:l,foot:c}}function IU(t,s,a){var r=t[0]||s[0]||a[0]||[],l=[];return Object.keys(r).filter(function(c){return c!=="_element"}).forEach(function(c){var o=1,m;Array.isArray(r)?m=r[parseInt(c)]:m=r[c],typeof m=="object"&&!Array.isArray(m)&&(o=m?.colSpan||1);for(var u=0;u<o;u++){var x=void 0;Array.isArray(r)?x=l.length:x=c+(u>0?"_".concat(u):"");var A={dataKey:x};l.push(A)}}),l}var Fb=(function(){function t(s,a,r){this.table=a,this.pageNumber=a.pageNumber,this.settings=a.settings,this.cursor=r,this.doc=s.getDocument()}return t})(),$U=(function(t){c5(s,t);function s(a,r,l,c,o,m){var u=t.call(this,a,r,m)||this;return u.cell=l,u.row=c,u.column=o,u.section=c.section,u}return s})(Fb),HU=(function(){function t(s,a){this.pageNumber=1,this.id=s.id,this.settings=s.settings,this.styles=s.styles,this.hooks=s.hooks,this.columns=a.columns,this.head=a.head,this.body=a.body,this.foot=a.foot}return t.prototype.getHeadHeight=function(s){return this.head.reduce(function(a,r){return a+r.getMaxCellHeight(s)},0)},t.prototype.getFootHeight=function(s){return this.foot.reduce(function(a,r){return a+r.getMaxCellHeight(s)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(s,a,r,l,c,o){for(var m=0,u=a;m<u.length;m++){var x=u[m],A=new $U(s,this,r,l,c,o),g=x(A)===!1;if(r.text=Array.isArray(r.text)?r.text:[r.text],g)return!1}return!0},t.prototype.callEndPageHooks=function(s,a){s.applyStyles(s.userStyles);for(var r=0,l=this.hooks.didDrawPage;r<l.length;r++){var c=l[r];c(new Fb(s,this,a))}},t.prototype.callWillDrawPageHooks=function(s,a){for(var r=0,l=this.hooks.willDrawPage;r<l.length;r++){var c=l[r];c(new Fb(s,this,a))}},t.prototype.getWidth=function(s){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var a=this.columns.reduce(function(l,c){return l+c.wrappedWidth},0);return a}else{var r=this.settings.margin;return s-r.left-r.right}},t})(),A5=(function(){function t(s,a,r,l,c){c===void 0&&(c=!1),this.height=0,this.raw=s,s instanceof o5&&(this.raw=s._element,this.element=s._element),this.index=a,this.section=r,this.cells=l,this.spansMultiplePages=c}return t.prototype.getMaxCellHeight=function(s){var a=this;return s.reduce(function(r,l){var c;return Math.max(r,((c=a.cells[l.index])===null||c===void 0?void 0:c.height)||0)},0)},t.prototype.hasRowSpan=function(s){var a=this;return s.filter(function(r){var l=a.cells[r.index];return l?l.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(s,a){return this.getMaxCellHeight(a)<=s},t.prototype.getMinimumRowHeight=function(s,a){var r=this;return s.reduce(function(l,c){var o=r.cells[c.index];if(!o)return 0;var m=a.getLineHeight(o.styles.fontSize),u=o.padding("vertical"),x=u+m;return x>l?x:l},0)},t})(),g5=(function(){function t(s,a,r){var l;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=a,this.section=r,this.raw=s;var c=s;s!=null&&typeof s=="object"&&!Array.isArray(s)?(this.rowSpan=s.rowSpan||1,this.colSpan=s.colSpan||1,c=(l=s.content)!==null&&l!==void 0?l:s,s._element&&(this.raw=s._element)):(this.rowSpan=1,this.colSpan=1);var o=c!=null?""+c:"",m=/\r\n|\r|\n/g;this.text=o.split(m)}return t.prototype.getTextPos=function(){var s;if(this.styles.valign==="top")s=this.y+this.padding("top");else if(this.styles.valign==="bottom")s=this.y+this.height-this.padding("bottom");else{var a=this.height-this.padding("vertical");s=this.y+a/2+this.padding("top")}var r;if(this.styles.halign==="right")r=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var l=this.width-this.padding("horizontal");r=this.x+l/2+this.padding("left")}else r=this.x+this.padding("left");return{x:r,y:s}},t.prototype.getContentHeight=function(s,a){a===void 0&&(a=1.15);var r=Array.isArray(this.text)?this.text.length:1,l=this.styles.fontSize/s*a,c=r*l+this.padding("vertical");return Math.max(c,this.styles.minCellHeight)},t.prototype.padding=function(s){var a=Cg(this.styles.cellPadding,0);return s==="vertical"?a.top+a.bottom:s==="horizontal"?a.left+a.right:a[s]},t})(),PU=(function(){function t(s,a,r){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=s,this.raw=a,this.index=r}return t.prototype.getMaxCustomCellWidth=function(s){for(var a=0,r=0,l=s.allRows();r<l.length;r++){var c=l[r],o=c.cells[this.index];o&&typeof o.styles.cellWidth=="number"&&(a=Math.max(a,o.styles.cellWidth))}return a},t})();function OU(t,s){zU(t,s);var a=[],r=0;s.columns.forEach(function(c){var o=c.getMaxCustomCellWidth(s);o?c.width=o:(c.width=c.wrappedWidth,a.push(c)),r+=c.width});var l=s.getWidth(t.pageSize().width)-r;l&&(l=Eb(a,l,function(c){return Math.max(c.minReadableWidth,c.minWidth)})),l&&(l=Eb(a,l,function(c){return c.minWidth})),l=Math.abs(l),!s.settings.horizontalPageBreak&&l>.1/t.scaleFactor()&&(l=l<1?l:Math.round(l),console.warn("Of the table content, ".concat(l," units width could not fit page"))),qU(s),KU(s,t),GU(s)}function zU(t,s){var a=t.scaleFactor(),r=s.settings.horizontalPageBreak,l=u5(t,s);s.allRows().forEach(function(c){for(var o=0,m=s.columns;o<m.length;o++){var u=m[o],x=c.cells[u.index];if(x){var A=s.hooks.didParseCell;s.callCellHooks(t,A,x,c,u,null);var g=x.padding("horizontal");x.contentWidth=rg(x.text,x.styles,t)+g;var N=rg(x.text.join(" ").split(/[^\S\u00A0]+/),x.styles,t);if(x.minReadableWidth=N+x.padding("horizontal"),typeof x.styles.cellWidth=="number")x.minWidth=x.styles.cellWidth,x.wrappedWidth=x.styles.cellWidth;else if(x.styles.cellWidth==="wrap"||r===!0)x.contentWidth>l?(x.minWidth=l,x.wrappedWidth=l):(x.minWidth=x.contentWidth,x.wrappedWidth=x.contentWidth);else{var f=10/a;x.minWidth=x.styles.minCellWidth||f,x.wrappedWidth=x.contentWidth,x.minWidth>x.wrappedWidth&&(x.wrappedWidth=x.minWidth)}}}}),s.allRows().forEach(function(c){for(var o=0,m=s.columns;o<m.length;o++){var u=m[o],x=c.cells[u.index];if(x&&x.colSpan===1)u.wrappedWidth=Math.max(u.wrappedWidth,x.wrappedWidth),u.minWidth=Math.max(u.minWidth,x.minWidth),u.minReadableWidth=Math.max(u.minReadableWidth,x.minReadableWidth);else{var A=s.styles.columnStyles[u.dataKey]||s.styles.columnStyles[u.index]||{},g=A.cellWidth||A.minCellWidth;g&&typeof g=="number"&&(u.minWidth=g,u.wrappedWidth=g)}x&&(x.colSpan>1&&!u.minWidth&&(u.minWidth=x.minWidth),x.colSpan>1&&!u.wrappedWidth&&(u.wrappedWidth=x.minWidth))}})}function Eb(t,s,a){for(var r=s,l=t.reduce(function(f,y){return f+y.wrappedWidth},0),c=0;c<t.length;c++){var o=t[c],m=o.wrappedWidth/l,u=r*m,x=o.width+u,A=a(o),g=x<A?A:x;s-=g-o.width,o.width=g}if(s=Math.round(s*1e10)/1e10,s){var N=t.filter(function(f){return s<0?f.width>a(f):!0});N.length&&(s=Eb(N,s,a))}return s}function GU(t){for(var s={},a=1,r=t.allRows(),l=0;l<r.length;l++)for(var c=r[l],o=0,m=t.columns;o<m.length;o++){var u=m[o],x=s[u.index];if(a>1)a--,delete c.cells[u.index];else if(x)x.cell.height+=c.height,a=x.cell.colSpan,delete c.cells[u.index],x.left--,x.left<=1&&delete s[u.index];else{var A=c.cells[u.index];if(!A)continue;if(A.height=c.height,A.rowSpan>1){var g=r.length-l,N=A.rowSpan>g?g:A.rowSpan;s[u.index]={cell:A,left:N,row:c}}}}}function qU(t){for(var s=t.allRows(),a=0;a<s.length;a++)for(var r=s[a],l=null,c=0,o=0,m=0;m<t.columns.length;m++){var u=t.columns[m];if(o-=1,o>1&&t.columns[m+1])c+=u.width,delete r.cells[u.index];else if(l){var x=l;delete r.cells[u.index],l=null,x.width=u.width+c}else{var x=r.cells[u.index];if(!x)continue;if(o=x.colSpan,c=0,x.colSpan>1){l=x,c+=u.width;continue}x.width=u.width+c}}}function KU(t,s){for(var a={count:0,height:0},r=0,l=t.allRows();r<l.length;r++){for(var c=l[r],o=0,m=t.columns;o<m.length;o++){var u=m[o],x=c.cells[u.index];if(x){s.applyStyles(x.styles,!0);var A=x.width-x.padding("horizontal");if(x.styles.overflow==="linebreak")x.text=s.splitTextToSize(x.text,A+1/s.scaleFactor(),{fontSize:x.styles.fontSize});else if(x.styles.overflow==="ellipsize")x.text=c2(x.text,A,x.styles,s,"...");else if(x.styles.overflow==="hidden")x.text=c2(x.text,A,x.styles,s,"");else if(typeof x.styles.overflow=="function"){var g=x.styles.overflow(x.text,A);typeof g=="string"?x.text=[g]:x.text=g}x.contentHeight=x.getContentHeight(s.scaleFactor(),s.getLineHeightFactor());var N=x.contentHeight/x.rowSpan;x.rowSpan>1&&a.count*a.height<N*x.rowSpan?a={height:N,count:x.rowSpan}:a&&a.count>0&&a.height>N&&(N=a.height),N>c.height&&(c.height=N)}}a.count--}}function c2(t,s,a,r,l){return t.map(function(c){return VU(c,s,a,r,l)})}function VU(t,s,a,r,l){var c=1e4*r.scaleFactor();if(s=Math.ceil(s*c)/c,s>=rg(t,a,r))return t;for(;s<rg(t+l,a,r)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+l}function f5(t,s){var a=new Yu(t),r=YU(s,a.scaleFactor()),l=new HU(s,r);return OU(a,l),a.applyStyles(a.userStyles),l}function YU(t,s){var a=t.content,r=XU(a.columns);if(a.head.length===0){var l=o2(r,"head");l&&a.head.push(l)}if(a.foot.length===0){var l=o2(r,"foot");l&&a.foot.push(l)}var c=t.settings.theme,o=t.styles;return{columns:r,head:Ff("head",a.head,r,o,c,s),body:Ff("body",a.body,r,o,c,s),foot:Ff("foot",a.foot,r,o,c,s)}}function Ff(t,s,a,r,l,c){var o={},m=s.map(function(u,x){for(var A=0,g={},N=0,f=0,y=0,v=a;y<v.length;y++){var U=v[y];if(o[U.index]==null||o[U.index].left===0)if(f===0){var D=void 0;Array.isArray(u)?D=u[U.index-N-A]:D=u[U.dataKey];var M={};typeof D=="object"&&!Array.isArray(D)&&(M=D?.styles||{});var K=JU(t,U,x,l,r,c,M),$=new g5(D,K,t);g[U.dataKey]=$,g[U.index]=$,f=$.colSpan-1,o[U.index]={left:$.rowSpan-1,times:f}}else f--,N++;else o[U.index].left--,f=o[U.index].times,A++}return new A5(u,x,t,g)});return m}function o2(t,s){var a={};return t.forEach(function(r){if(r.raw!=null){var l=WU(s,r.raw);l!=null&&(a[r.dataKey]=l)}}),Object.keys(a).length>0?a:null}function WU(t,s){if(t==="head"){if(typeof s=="object")return s.header||null;if(typeof s=="string"||typeof s=="number")return s}else if(t==="foot"&&typeof s=="object")return s.footer;return null}function XU(t){return t.map(function(s,a){var r,l;return typeof s=="object"?l=(r=s.dataKey)!==null&&r!==void 0?r:a:l=a,new PU(l,s,a)})}function JU(t,s,a,r,l,c,o){var m=SU(r),u;t==="head"?u=l.headStyles:t==="body"?u=l.bodyStyles:t==="foot"&&(u=l.footStyles);var x=Mo({},m.table,m[t],l.styles,u),A=l.columnStyles[s.dataKey]||l.columnStyles[s.index]||{},g=t==="body"?A:{},N=t==="body"&&a%2===0?Mo({},m.alternateRow,l.alternateRowStyles):{},f=CU(c),y=Mo({},f,x,N,g);return Mo(y,o)}function ZU(t,s,a){var r;a===void 0&&(a={});var l=u5(t,s),c=new Map,o=[],m=[],u=[];Array.isArray(s.settings.horizontalPageBreakRepeat)?u=s.settings.horizontalPageBreakRepeat:(typeof s.settings.horizontalPageBreakRepeat=="string"||typeof s.settings.horizontalPageBreakRepeat=="number")&&(u=[s.settings.horizontalPageBreakRepeat]),u.forEach(function(N){var f=s.columns.find(function(y){return y.dataKey===N||y.index===N});f&&!c.has(f.index)&&(c.set(f.index,!0),o.push(f.index),m.push(s.columns[f.index]),l-=f.wrappedWidth)});for(var x=!0,A=(r=a?.start)!==null&&r!==void 0?r:0;A<s.columns.length;){if(c.has(A)){A++;continue}var g=s.columns[A].wrappedWidth;if(x||l>=g)x=!1,o.push(A),m.push(s.columns[A]),l-=g;else break;A++}return{colIndexes:o,columns:m,lastIndex:A-1}}function eT(t,s){for(var a=[],r=0;r<s.columns.length;r++){var l=ZU(t,s,{start:r});l.columns.length&&(a.push(l),r=l.lastIndex)}return a}function b5(t,s){var a=s.settings,r=a.startY,l=a.margin,c={x:l.left,y:r},o=s.getHeadHeight(s.columns)+s.getFootHeight(s.columns),m=r+l.bottom+o;if(a.pageBreak==="avoid"){var u=s.body,x=u.reduce(function(N,f){return N+f.height},0);m+=x}var A=new Yu(t);(a.pageBreak==="always"||a.startY!=null&&m>A.pageSize().height)&&(j5(A),c.y=l.top),s.callWillDrawPageHooks(A,c);var g=Mo({},c);s.startPageNumber=A.pageNumber(),a.horizontalPageBreak?tT(A,s,g,c):(A.applyStyles(A.userStyles),(a.showHead==="firstPage"||a.showHead==="everyPage")&&s.head.forEach(function(N){return zo(A,s,N,c,s.columns)}),A.applyStyles(A.userStyles),s.body.forEach(function(N,f){var y=f===s.body.length-1;ng(A,s,N,y,g,c,s.columns)}),A.applyStyles(A.userStyles),(a.showFoot==="lastPage"||a.showFoot==="everyPage")&&s.foot.forEach(function(N){return zo(A,s,N,c,s.columns)})),d5(A,s,g,c),s.callEndPageHooks(A,c),s.finalY=c.y,t.lastAutoTable=s,A.applyStyles(A.userStyles)}function tT(t,s,a,r){var l=eT(t,s),c=s.settings;if(c.horizontalPageBreakBehaviour==="afterAllRows")l.forEach(function(x,A){t.applyStyles(t.userStyles),A>0?hh(t,s,a,r,x.columns,!0):d2(t,s,r,x.columns),sT(t,s,a,r,x.columns),Ef(t,s,r,x.columns)});else for(var o=-1,m=l[0],u=function(){var x=o;if(m){t.applyStyles(t.userStyles);var A=m.columns;o>=0?hh(t,s,a,r,A,!0):d2(t,s,r,A),x=m2(t,s,o+1,r,A),Ef(t,s,r,A)}var g=x-o;l.slice(1).forEach(function(N){t.applyStyles(t.userStyles),hh(t,s,a,r,N.columns,!0),m2(t,s,o+1,r,N.columns,g),Ef(t,s,r,N.columns)}),o=x};o<s.body.length-1;)u()}function d2(t,s,a,r){var l=s.settings;t.applyStyles(t.userStyles),(l.showHead==="firstPage"||l.showHead==="everyPage")&&s.head.forEach(function(c){return zo(t,s,c,a,r)})}function sT(t,s,a,r,l){t.applyStyles(t.userStyles),s.body.forEach(function(c,o){var m=o===s.body.length-1;ng(t,s,c,m,a,r,l)})}function m2(t,s,a,r,l,c){t.applyStyles(t.userStyles),c=c??s.body.length;var o=Math.min(a+c,s.body.length),m=-1;return s.body.slice(a,o).forEach(function(u,x){var A=a+x===s.body.length-1,g=y5(t,s,A,r);u.canEntireRowFit(g,l)&&(zo(t,s,u,r,l),m=a+x)}),m}function Ef(t,s,a,r){var l=s.settings;t.applyStyles(t.userStyles),(l.showFoot==="lastPage"||l.showFoot==="everyPage")&&s.foot.forEach(function(c){return zo(t,s,c,a,r)})}function aT(t,s,a){var r=a.getLineHeight(t.styles.fontSize),l=t.padding("vertical"),c=Math.floor((s-l)/r);return Math.max(0,c)}function rT(t,s,a,r){var l={};t.spansMultiplePages=!0,t.height=0;for(var c=0,o=0,m=a.columns;o<m.length;o++){var u=m[o],x=t.cells[u.index];if(x){Array.isArray(x.text)||(x.text=[x.text]);var A=new g5(x.raw,x.styles,x.section);A=Mo(A,x),A.text=[];var g=aT(x,s,r);x.text.length>g&&(A.text=x.text.splice(g,x.text.length));var N=r.scaleFactor(),f=r.getLineHeightFactor();x.contentHeight=x.getContentHeight(N,f),x.contentHeight>=s&&(x.contentHeight=s,A.styles.minCellHeight-=s),x.contentHeight>t.height&&(t.height=x.contentHeight),A.contentHeight=A.getContentHeight(N,f),A.contentHeight>c&&(c=A.contentHeight),l[u.index]=A}}var y=new A5(t.raw,-1,t.section,l,!0);y.height=c;for(var v=0,U=a.columns;v<U.length;v++){var u=U[v],A=y.cells[u.index];A&&(A.height=y.height);var x=t.cells[u.index];x&&(x.height=t.height)}return y}function nT(t,s,a,r){var l=t.pageSize().height,c=r.settings.margin,o=c.top+c.bottom,m=l-o;s.section==="body"&&(m-=r.getHeadHeight(r.columns)+r.getFootHeight(r.columns));var u=s.getMinimumRowHeight(r.columns,t),x=u<a;if(u>m)return console.error("Will not be able to print row ".concat(s.index," correctly since it's minimum height is larger than page height")),!0;if(!x)return!1;var A=s.hasRowSpan(r.columns),g=s.getMaxCellHeight(r.columns)>m;return g?(A&&console.error("The content of row ".concat(s.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(A||r.settings.rowPageBreak==="avoid")}function ng(t,s,a,r,l,c,o){var m=y5(t,s,r,c);if(a.canEntireRowFit(m,o))zo(t,s,a,c,o);else if(nT(t,a,m,s)){var u=rT(a,m,s,t);zo(t,s,a,c,o),hh(t,s,l,c,o),ng(t,s,u,r,l,c,o)}else hh(t,s,l,c,o),ng(t,s,a,r,l,c,o)}function zo(t,s,a,r,l){r.x=s.settings.margin.left;for(var c=0,o=l;c<o.length;c++){var m=o[c],u=a.cells[m.index];if(!u){r.x+=m.width;continue}t.applyStyles(u.styles),u.x=r.x,u.y=r.y;var x=s.callCellHooks(t,s.hooks.willDrawCell,u,a,m,r);if(x===!1){r.x+=m.width;continue}lT(t,u,r);var A=u.getTextPos();i5(u.text,A.x,A.y,{halign:u.styles.halign,valign:u.styles.valign,maxWidth:Math.ceil(u.width-u.padding("left")-u.padding("right"))},t.getDocument()),s.callCellHooks(t,s.hooks.didDrawCell,u,a,m,r),r.x+=m.width}r.y+=a.height}function lT(t,s,a){var r=s.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof r.lineWidth=="number"){var l=m5(r.lineWidth,r.fillColor);l&&t.rect(s.x,a.y,s.width,s.height,l)}else typeof r.lineWidth=="object"&&(r.fillColor&&t.rect(s.x,a.y,s.width,s.height,"F"),iT(t,s,a,r.lineWidth))}function iT(t,s,a,r){var l,c,o,m;r.top&&(l=a.x,c=a.y,o=a.x+s.width,m=a.y,r.right&&(o+=.5*r.right),r.left&&(l-=.5*r.left),u(r.top,l,c,o,m)),r.bottom&&(l=a.x,c=a.y+s.height,o=a.x+s.width,m=a.y+s.height,r.right&&(o+=.5*r.right),r.left&&(l-=.5*r.left),u(r.bottom,l,c,o,m)),r.left&&(l=a.x,c=a.y,o=a.x,m=a.y+s.height,r.top&&(c-=.5*r.top),r.bottom&&(m+=.5*r.bottom),u(r.left,l,c,o,m)),r.right&&(l=a.x+s.width,c=a.y,o=a.x+s.width,m=a.y+s.height,r.top&&(c-=.5*r.top),r.bottom&&(m+=.5*r.bottom),u(r.right,l,c,o,m));function u(x,A,g,N,f){t.getDocument().setLineWidth(x),t.getDocument().line(A,g,N,f,"S")}}function y5(t,s,a,r){var l=s.settings.margin.bottom,c=s.settings.showFoot;return(c==="everyPage"||c==="lastPage"&&a)&&(l+=s.getFootHeight(s.columns)),t.pageSize().height-r.y-l}function hh(t,s,a,r,l,c){l===void 0&&(l=[]),c===void 0&&(c=!1),t.applyStyles(t.userStyles),s.settings.showFoot==="everyPage"&&!c&&s.foot.forEach(function(m){return zo(t,s,m,r,l)}),s.callEndPageHooks(t,r);var o=s.settings.margin;d5(t,s,a,r),j5(t),s.pageNumber++,r.x=o.left,r.y=o.top,a.y=o.top,s.callWillDrawPageHooks(t,r),s.settings.showHead==="everyPage"&&(s.head.forEach(function(m){return zo(t,s,m,r,l)}),t.applyStyles(t.userStyles))}function j5(t){var s=t.pageNumber();t.setPage(s+1);var a=t.pageNumber();return a===s?(t.addPage(),!0):!1}function cT(t){t.API.autoTable=function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];var r=s[0],l=p5(this,r),c=f5(this,l);return b5(this,c),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(s,a,r,l){i5(s,a,r,l,this)},t.API.autoTableSetDefaults=function(s){return Yu.setDefaults(s,this),this},t.autoTableSetDefaults=function(s,a){Yu.setDefaults(s,a)},t.API.autoTableHtmlToJson=function(s,a){var r;if(a===void 0&&(a=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var l=new Yu(this),c=h5(l,s,window,a,!1),o=c.head,m=c.body,u=((r=o[0])===null||r===void 0?void 0:r.map(function(x){return x.content}))||[];return{columns:u,rows:m,data:m}}}var Df;function Ma(t,s){var a=p5(t,s),r=f5(t,a);b5(t,r)}try{if(typeof window<"u"&&window){var u2=window,x2=u2.jsPDF||((Df=u2.jspdf)===null||Df===void 0?void 0:Df.jsPDF);x2&&cT(x2)}}catch(t){console.error("Could not apply autoTable plugin",t)}function oT(){const[t,s]=h.useState([]),[a,r]=h.useState(!1),[l,c]=h.useState("all"),[o,m]=h.useState({type:"all",category:"all",user:"",dateFrom:"",dateTo:"",search:"",severity:"all"}),[u,x]=h.useState({total:0,today:0,errors:0,warnings:0,info:0,success:0}),[A,g]=h.useState({page:1,perPage:50,total:0,totalPages:0}),[N,f]=h.useState(!1),[y,v]=h.useState(30),[U,D]=h.useState(null),[M,K]=h.useState(!1),[$,P]=h.useState(!1),[se,z]=h.useState(!1),[R,j]=h.useState(null),[T,Q]=h.useState([]),[E,te]=h.useState({byType:[],byCategory:[],byDay:[],byHour:[]}),[C,O]=h.useState([]),[V,re]=h.useState([]),[ge,xe]=h.useState([]),[Z,I]=h.useState({retentionDays:90,autoArchive:!0,archiveAfterDays:30,alertOnCritical:!0,alertEmail:""}),H=h.useRef(null),ae=[{value:"all",label:"All Categories",icon:Vc},{value:"auth",label:"Authentication",icon:Ui},{value:"students",label:"Students",icon:Qs},{value:"teachers",label:"Teachers",icon:Rt},{value:"finance",label:"Finance",icon:aa},{value:"attendance",label:"Attendance",icon:Ot},{value:"exams",label:"Exams",icon:as},{value:"communication",label:"Communication",icon:wa},{value:"settings",label:"Settings",icon:Ka},{value:"system",label:"System",icon:jB},{value:"api",label:"API",icon:Ou}],k=[{value:"all",label:"All Severities"},{value:"critical",label:"Critical",color:"red"},{value:"major",label:"Major",color:"orange"},{value:"minor",label:"Minor",color:"yellow"},{value:"low",label:"Low",color:"blue"}];h.useEffect(()=>{B(),oe(),ne(),Fe(),je(),Ge(),ze()},[]),h.useEffect(()=>{l==="security"?je():l==="sessions"?Ge():l==="api"&&ze()},[l]),h.useEffect(()=>(N?H.current=setInterval(()=>{oe(),ne()},y*1e3):H.current&&clearInterval(H.current),()=>{H.current&&clearInterval(H.current)}),[N,y]);const B=()=>{const ie=localStorage.getItem("log_settings");ie&&I(JSON.parse(ie))},w=()=>{localStorage.setItem("log_settings",JSON.stringify(Z)),P(!1),alert(" Settings saved!")},oe=async()=>{try{r(!0);const ie=new URLSearchParams;ie.append("page",A.page),ie.append("per_page",A.perPage),o.type!=="all"&&ie.append("type",o.type),o.category!=="all"&&ie.append("category",o.category),o.severity!=="all"&&ie.append("severity",o.severity),o.user&&ie.append("user",o.user),o.dateFrom&&ie.append("date_from",o.dateFrom),o.dateTo&&ie.append("date_to",o.dateTo),o.search&&ie.append("search",o.search);const q=await F.get(`${ee}/logs.php?${ie}`);q.data.success&&(s(q.data.logs||[]),q.data.pagination&&g(pe=>({...pe,total:q.data.pagination.total,totalPages:q.data.pagination.total_pages})))}catch(ie){console.error("Error fetching logs:",ie)}finally{r(!1)}},ne=async()=>{try{const ie=await F.get(`${ee}/logs.php?stats=true`);ie.data.success&&ie.data.stats&&x({total:parseInt(ie.data.stats.total)||0,today:parseInt(ie.data.stats.today)||0,errors:parseInt(ie.data.stats.errors)||0,warnings:parseInt(ie.data.stats.warnings)||0,info:parseInt(ie.data.stats.info)||0,success:parseInt(ie.data.stats.success)||0})}catch(ie){console.error("Error fetching stats:",ie)}},Fe=async()=>{try{const ie=await F.get(`${ee}/logs.php?analytics=true`);ie.data.success&&ie.data.analytics&&te(ie.data.analytics)}catch(ie){console.error("Error fetching analytics:",ie)}},je=async()=>{try{const ie=await F.get(`${ee}/logs.php?type=security`);ie.data.success&&ie.data.logs&&O(ie.data.logs)}catch(ie){console.error("Error fetching security logs:",ie)}},Ge=async()=>{try{const ie=await F.get(`${ee}/logs.php?type=sessions`);ie.data.success&&ie.data.sessions&&re(ie.data.sessions)}catch(ie){console.error("Error fetching sessions:",ie)}},ze=async()=>{try{const ie=await F.get(`${ee}/logs.php?type=api`);ie.data.success&&ie.data.logs&&xe(ie.data.logs)}catch(ie){console.error("Error fetching API logs:",ie)}},Xe=async(ie,q)=>{j({id:ie,name:q});try{const pe=await F.get(`${ee}/logs.php?user_id=${ie}`);Q(pe.data.logs||[])}catch(pe){console.error("Error fetching user activity:",pe),Q(t.filter(Me=>Me.user_id===ie||Me.user_name===q).slice(0,20))}z(!0)},st=()=>{const ie=`ID,Type,Category,Severity,Message,User,IP,Timestamp
`+t.map(Me=>`${Me.id},"${Me.type}","${Me.category||""}","${Me.severity||""}","${Me.message}","${Me.user_name||"System"}","${Me.ip_address||""}","${Me.created_at}"`).join(`
`),q=new Blob([ie],{type:"text/csv"}),pe=document.createElement("a");pe.href=URL.createObjectURL(q),pe.download=`system_logs_${new Date().toISOString().split("T")[0]}.csv`,pe.click()},ce=()=>{const ie=new ms;ie.setFontSize(18),ie.text("System Logs Report",14,22),ie.setFontSize(10),ie.text(`Generated: ${new Date().toLocaleString()}`,14,30),ie.text(`Total Logs: ${t.length}`,14,36),Ma(ie,{startY:45,head:[["Type","Category","Message","User","Timestamp"]],body:t.slice(0,100).map(q=>[q.type,q.category||"-",q.message.substring(0,40),q.user_name||"System",new Date(q.created_at).toLocaleString()]),theme:"striped",headStyles:{fillColor:[59,130,246]},styles:{fontSize:8}}),ie.save(`system_logs_${new Date().toISOString().split("T")[0]}.pdf`)},_e=async ie=>{if(confirm(`Are you sure you want to delete logs older than ${ie} days? This cannot be undone.`))try{await F.delete(`${ee}/logs.php?older_than=${ie}`),alert(" Old logs cleared successfully!"),oe(),ne()}catch{alert("Logs cleared (simulated)")}},le=async()=>{if(confirm("Archive logs older than 30 days?"))try{await F.post(`${ee}/logs.php?action=archive`),alert(" Logs archived successfully!")}catch{alert("Logs archived (simulated)")}},Pe=async ie=>{confirm("Terminate this session?")&&(re(q=>q.map(pe=>pe.id===ie?{...pe,status:"terminated"}:pe)),alert(" Session terminated!"))},we=ie=>{switch(ie){case"error":return e.jsx(Js,{className:"w-5 h-5 text-red-600"});case"warning":return e.jsx(ka,{className:"w-5 h-5 text-orange-600"});case"success":return e.jsx(Mt,{className:"w-5 h-5 text-green-600"});default:return e.jsx(fc,{className:"w-5 h-5 text-blue-600"})}},fe=ie=>{const q={error:"bg-red-100 text-red-700",warning:"bg-orange-100 text-orange-700",success:"bg-green-100 text-green-700",info:"bg-blue-100 text-blue-700"};return q[ie]||q.info},ye=ie=>({critical:"bg-red-600 text-white",major:"bg-orange-500 text-white",minor:"bg-yellow-500 text-white",low:"bg-blue-500 text-white"})[ie]||"bg-gray-500 text-white",Ke=ie=>{const q=ae.find(pe=>pe.value===ie);return q?q.icon:Vc},ve=Math.max(...E.byType.map(ie=>ie.count),1);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Ir,{className:"w-7 h-7 text-blue-600"})," System Logs"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Monitor system activity, security events, and API requests"})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs("button",{onClick:()=>f(!N),className:`btn flex items-center gap-2 ${N?"bg-green-100 text-green-700":"bg-gray-100"}`,children:[N?e.jsx(fg,{className:"w-4 h-4"}):e.jsx(Qi,{className:"w-4 h-4"}),N?"Stop":"Auto"," Refresh"]}),e.jsxs("button",{onClick:()=>{oe(),ne()},className:"btn bg-gray-100 hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ns,{className:"w-4 h-4"})," Refresh"]}),e.jsxs("button",{onClick:()=>P(!0),className:"btn bg-gray-100 hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ka,{className:"w-4 h-4"})," Settings"]}),e.jsxs("div",{className:"relative group",children:[e.jsxs("button",{className:"btn btn-primary flex items-center gap-2",children:[e.jsx(xs,{className:"w-4 h-4"})," Export"]}),e.jsxs("div",{className:"absolute right-0 mt-1 bg-white border rounded-lg shadow-lg hidden group-hover:block z-10",children:[e.jsx("button",{onClick:st,className:"block w-full px-4 py-2 text-left hover:bg-gray-50 text-sm",children:"Export CSV"}),e.jsx("button",{onClick:ce,className:"block w-full px-4 py-2 text-left hover:bg-gray-50 text-sm",children:"Export PDF"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:[e.jsx(Ir,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Total"}),e.jsx("p",{className:"text-2xl font-bold",children:u.total.toLocaleString()})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-green-500 to-green-600 text-white",children:[e.jsx(Wt,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Today"}),e.jsx("p",{className:"text-2xl font-bold",children:u.today})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-cyan-500 to-cyan-600 text-white",children:[e.jsx(fc,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Info"}),e.jsx("p",{className:"text-2xl font-bold",children:u.info})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-emerald-500 to-emerald-600 text-white",children:[e.jsx(Mt,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Success"}),e.jsx("p",{className:"text-2xl font-bold",children:u.success})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-orange-500 to-orange-600 text-white",children:[e.jsx(ka,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Warnings"}),e.jsx("p",{className:"text-2xl font-bold",children:u.warnings})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-red-500 to-red-600 text-white",children:[e.jsx(Js,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Errors"}),e.jsx("p",{className:"text-2xl font-bold",children:u.errors})]})]}),e.jsx("div",{className:"flex gap-1 bg-gray-100 p-1 rounded-lg overflow-x-auto",children:[{id:"all",label:"All Logs",icon:Vc},{id:"analytics",label:"Analytics",icon:Fs},{id:"security",label:"Security",icon:$r},{id:"sessions",label:"Sessions",icon:Rt},{id:"api",label:"API Logs",icon:Ou}].map(ie=>e.jsxs("button",{onClick:()=>c(ie.id),className:`px-4 py-2 rounded-md font-medium flex items-center gap-2 whitespace-nowrap ${l===ie.id?"bg-white shadow":"hover:bg-gray-200"}`,children:[e.jsx(ie.icon,{className:"w-4 h-4"})," ",ie.label]},ie.id))}),l==="all"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card p-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Type"}),e.jsxs("select",{value:o.type,onChange:ie=>m({...o,type:ie.target.value}),className:"input",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"info",children:"Info"}),e.jsx("option",{value:"success",children:"Success"}),e.jsx("option",{value:"warning",children:"Warning"}),e.jsx("option",{value:"error",children:"Error"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Category"}),e.jsx("select",{value:o.category,onChange:ie=>m({...o,category:ie.target.value}),className:"input",children:ae.map(ie=>e.jsx("option",{value:ie.value,children:ie.label},ie.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Severity"}),e.jsx("select",{value:o.severity,onChange:ie=>m({...o,severity:ie.target.value}),className:"input",children:k.map(ie=>e.jsx("option",{value:ie.value,children:ie.label},ie.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"From"}),e.jsx("input",{type:"date",value:o.dateFrom,onChange:ie=>m({...o,dateFrom:ie.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"To"}),e.jsx("input",{type:"date",value:o.dateTo,onChange:ie=>m({...o,dateTo:ie.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Search"}),e.jsx("input",{type:"text",value:o.search,onChange:ie=>m({...o,search:ie.target.value}),placeholder:"Search...",className:"input"})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("button",{onClick:oe,className:"btn btn-primary flex items-center gap-2",children:[e.jsx(Ko,{className:"w-4 h-4"})," Apply Filters"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>_e(30),className:"btn bg-red-100 text-red-700 hover:bg-red-200 text-sm flex items-center gap-2",children:[e.jsx(us,{className:"w-4 h-4"})," Clear 30+ days"]}),e.jsxs("button",{onClick:le,className:"btn bg-purple-100 text-purple-700 hover:bg-purple-200 text-sm flex items-center gap-2",children:[e.jsx(my,{className:"w-4 h-4"})," Archive"]})]})]})]}),e.jsx("div",{className:"card overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Category"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Severity"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Message"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"User"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"IP"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Time"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:a?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"px-4 py-8 text-center text-gray-500",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}),"Loading..."]})})}):t.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"px-4 py-8 text-center text-gray-500",children:"No logs found"})}):t.map(ie=>{const q=Ke(ie.category);return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[we(ie.type),e.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full ${fe(ie.type)}`,children:ie.type})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm",children:ie.category||"-"})]})}),e.jsx("td",{className:"px-4 py-3",children:ie.severity&&e.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${ye(ie.severity)}`,children:ie.severity})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("p",{className:"text-sm text-gray-900 truncate max-w-xs",children:ie.message})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{onClick:()=>Xe(ie.user_id,ie.user_name),className:"text-sm text-blue-600 hover:underline",children:ie.user_name||"System"})}),e.jsx("td",{className:"px-4 py-3 text-sm font-mono text-gray-600",children:ie.ip_address||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:new Date(ie.created_at).toLocaleString()}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{onClick:()=>{D(ie),K(!0)},className:"p-1 hover:bg-gray-100 rounded",children:e.jsx(na,{className:"w-4 h-4 text-gray-600"})})})]},ie.id)})})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",t.length," of ",A.total," logs"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>g(ie=>({...ie,page:Math.max(1,ie.page-1)})),disabled:A.page===1,className:"btn bg-gray-100 hover:bg-gray-200 disabled:opacity-50",children:e.jsx(Kd,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-sm",children:["Page ",A.page," of ",A.totalPages]}),e.jsx("button",{onClick:()=>g(ie=>({...ie,page:Math.min(ie.totalPages,ie.page+1)})),disabled:A.page===A.totalPages,className:"btn bg-gray-100 hover:bg-gray-200 disabled:opacity-50",children:e.jsx(cr,{className:"w-4 h-4"})})]})]})]}),l==="analytics"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Fs,{className:"w-5 h-5 text-blue-600"})," Logs by Type"]}),e.jsx("div",{className:"space-y-3",children:E.byType.map(ie=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`w-20 text-sm capitalize ${fe(ie.type)} px-2 py-1 rounded text-center`,children:ie.type}),e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-4",children:e.jsx("div",{className:`h-4 rounded-full ${ie.type==="error"?"bg-red-500":ie.type==="warning"?"bg-orange-500":ie.type==="success"?"bg-green-500":"bg-blue-500"}`,style:{width:`${ie.count/ve*100}%`}})}),e.jsx("span",{className:"w-16 text-right text-sm font-medium",children:ie.count})]},ie.type))})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Vc,{className:"w-5 h-5 text-purple-600"})," Logs by Category"]}),e.jsx("div",{className:"space-y-3",children:E.byCategory.map(ie=>{const pe=ae.find(Me=>Me.value===ie.category)?.icon||Vc;return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-20 flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm capitalize",children:ie.category})]}),e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-4",children:e.jsx("div",{className:"h-4 rounded-full bg-purple-500",style:{width:`${ie.count/Math.max(...E.byCategory.map(Me=>Me.count))*100}%`}})}),e.jsx("span",{className:"w-16 text-right text-sm font-medium",children:ie.count})]},ie.category)})})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2",children:[e.jsx($s,{className:"w-5 h-5 text-green-600"})," Logs by Day"]}),e.jsx("div",{className:"flex items-end gap-2 h-40",children:E.byDay.map(ie=>e.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[e.jsx("div",{className:"w-full bg-green-500 rounded-t",style:{height:`${ie.count/Math.max(...E.byDay.map(q=>q.count))*100}%`}}),e.jsx("span",{className:"text-xs mt-2",children:ie.day}),e.jsx("span",{className:"text-xs text-gray-500",children:ie.count})]},ie.day))})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Wt,{className:"w-5 h-5 text-orange-600"})," Logs by Hour"]}),e.jsx("div",{className:"flex items-end gap-1 h-40 overflow-x-auto",children:E.byHour.map(ie=>e.jsxs("div",{className:"flex flex-col items-center min-w-[20px]",children:[e.jsx("div",{className:"w-4 bg-orange-500 rounded-t",style:{height:`${ie.count/Math.max(...E.byHour.map(q=>q.count))*100}%`}}),e.jsx("span",{className:"text-xs mt-1",children:ie.hour})]},ie.hour))})]})]}),l==="security"&&e.jsxs("div",{className:"card overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b bg-gray-50",children:e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx($r,{className:"w-5 h-5 text-red-600"})," Security Events"]})}),e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Event"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"User"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"IP Address"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Attempts"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Time"})]})}),e.jsx("tbody",{className:"divide-y",children:C.map(ie=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[ie.event.includes("Failed")?e.jsx(Js,{className:"w-4 h-4 text-red-600"}):ie.event.includes("locked")?e.jsx(Ui,{className:"w-4 h-4 text-orange-600"}):e.jsx($r,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm",children:ie.event})]})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:ie.user}),e.jsx("td",{className:"px-4 py-3 text-sm font-mono",children:ie.ip}),e.jsx("td",{className:"px-4 py-3 text-sm",children:ie.attempts||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded ${ie.status==="blocked"?"bg-red-100 text-red-700":ie.status==="locked"?"bg-orange-100 text-orange-700":ie.status==="warning"?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:ie.status})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:new Date(ie.created_at).toLocaleString()})]},ie.id))})]})]}),l==="sessions"&&e.jsxs("div",{className:"card overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b bg-gray-50",children:e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(Rt,{className:"w-5 h-5 text-purple-600"})," Active Sessions"]})}),e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"User"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Device"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"IP"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Login Time"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Last Activity"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:V.map(ie=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:ie.user}),e.jsx("p",{className:"text-xs text-gray-500",children:ie.email})]})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:ie.device}),e.jsx("td",{className:"px-4 py-3 text-sm font-mono",children:ie.ip}),e.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(ie.login_time).toLocaleString()}),e.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(ie.last_activity).toLocaleString()}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded ${ie.status==="active"?"bg-green-100 text-green-700":ie.status==="expired"?"bg-gray-100 text-gray-700":"bg-red-100 text-red-700"}`,children:ie.status})}),e.jsx("td",{className:"px-4 py-3",children:ie.status==="active"&&e.jsx("button",{onClick:()=>Pe(ie.id),className:"btn bg-red-100 text-red-700 hover:bg-red-200 text-xs",children:"Terminate"})})]},ie.id))})]})]}),l==="api"&&e.jsxs("div",{className:"card overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b bg-gray-50",children:e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(Ou,{className:"w-5 h-5 text-cyan-600"})," API Request Logs"]})}),e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Endpoint"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Method"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Duration"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"User"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Time"})]})}),e.jsx("tbody",{className:"divide-y",children:ge.map(ie=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-mono",children:ie.endpoint}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded font-medium ${ie.method==="GET"?"bg-blue-100 text-blue-700":ie.method==="POST"?"bg-green-100 text-green-700":ie.method==="PUT"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:ie.method})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded ${ie.status>=200&&ie.status<300?"bg-green-100 text-green-700":ie.status>=400&&ie.status<500?"bg-orange-100 text-orange-700":"bg-red-100 text-red-700"}`,children:ie.status})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("span",{className:ie.duration>1e3?"text-red-600 font-medium":"",children:[ie.duration,"ms"]})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:ie.user}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:new Date(ie.created_at).toLocaleString()})]},ie.id))})]})]}),M&&U&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between sticky top-0 bg-white",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(na,{className:"w-5 h-5 text-blue-600"})," Log Details"]}),e.jsx("button",{onClick:()=>K(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Type"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[we(U.type),e.jsx("span",{className:`px-2 py-1 text-sm rounded ${fe(U.type)}`,children:U.type})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Category"}),e.jsx("p",{className:"mt-1 capitalize",children:U.category||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Severity"}),e.jsx("p",{className:"mt-1",children:U.severity&&e.jsx("span",{className:`px-2 py-1 text-sm rounded ${ye(U.severity)}`,children:U.severity})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Timestamp"}),e.jsx("p",{className:"mt-1",children:new Date(U.created_at).toLocaleString()})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Message"}),e.jsx("p",{className:"mt-1 p-3 bg-gray-50 rounded-lg",children:U.message})]}),U.details&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Details"}),e.jsx("p",{className:"mt-1 p-3 bg-gray-50 rounded-lg text-sm",children:U.details})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"User"}),e.jsx("p",{className:"mt-1",children:U.user_name||"System"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"IP Address"}),e.jsx("p",{className:"mt-1 font-mono",children:U.ip_address||"-"})]}),U.user_agent&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"text-sm text-gray-500",children:"User Agent"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 break-all",children:U.user_agent})]}),U.request_url&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Request URL"}),e.jsx("p",{className:"mt-1 font-mono text-sm",children:U.request_url})]}),U.request_method&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Method"}),e.jsx("p",{className:"mt-1",children:U.request_method})]}),U.response_code&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500",children:"Response Code"}),e.jsx("p",{className:"mt-1",children:U.response_code})]})]})]})]})}),se&&R&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-3xl w-full max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between sticky top-0 bg-white",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(ha,{className:"w-5 h-5 text-purple-600"})," Activity: ",R.name]}),e.jsx("button",{onClick:()=>z(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-6",children:T.length===0?e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No activity found"}):e.jsx("div",{className:"space-y-3",children:T.map(ie=>e.jsxs("div",{className:"flex items-start gap-3 p-3 border rounded-lg",children:[we(ie.type),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm",children:ie.message}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[new Date(ie.created_at).toLocaleString(),"  ",ie.ip_address]})]})]},ie.id))})})]})}),$&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Ka,{className:"w-5 h-5"})," Log Settings"]}),e.jsx("button",{onClick:()=>P(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Auto-Refresh Interval (seconds)"}),e.jsxs("select",{value:y,onChange:ie=>v(parseInt(ie.target.value)),className:"input",children:[e.jsx("option",{value:"10",children:"10 seconds"}),e.jsx("option",{value:"30",children:"30 seconds"}),e.jsx("option",{value:"60",children:"1 minute"}),e.jsx("option",{value:"300",children:"5 minutes"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Log Retention (days)"}),e.jsx("input",{type:"number",value:Z.retentionDays,onChange:ie=>I({...Z,retentionDays:parseInt(ie.target.value)}),className:"input",min:"7",max:"365"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Archive After (days)"}),e.jsx("input",{type:"number",value:Z.archiveAfterDays,onChange:ie=>I({...Z,archiveAfterDays:parseInt(ie.target.value)}),className:"input",min:"7",max:"90"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:Z.autoArchive,onChange:ie=>I({...Z,autoArchive:ie.target.checked}),className:"w-4 h-4"}),e.jsx("span",{children:"Auto-archive old logs"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:Z.alertOnCritical,onChange:ie=>I({...Z,alertOnCritical:ie.target.checked}),className:"w-4 h-4"}),e.jsx("span",{children:"Alert on critical errors"})]}),Z.alertOnCritical&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Alert Email"}),e.jsx("input",{type:"email",value:Z.alertEmail,onChange:ie=>I({...Z,alertEmail:ie.target.value}),className:"input",placeholder:"admin@school.com"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:()=>P(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{onClick:w,className:"btn btn-primary",children:"Save Settings"})]})]})})]})}function dT(){const t=la(),[s,a]=h.useState(!0),[r,l]=h.useState(!1),[c,o]=h.useState("general"),[m,u]=h.useState(""),x=h.useRef(null),[A,g]=h.useState({}),{refreshSettings:N,updateSettings:f}=x4(),[y,v]=h.useState({school_name:"",school_motto:"",school_address:"",school_phone:"",school_email:"",school_website:"",school_logo:"",current_academic_year:"",current_term:"1",terms_per_year:"3",grading_system:"percentage",timezone:"Africa/Accra",date_format:"DD/MM/YYYY",time_format:"12h",currency:"GHS",currency_symbol:"",language:"en",primary_color:"#3B82F6",secondary_color:"#10B981",accent_color:"#F59E0B",hubtel_client_id:"",hubtel_client_secret:"",hubtel_merchant_number:"",hubtel_mode:"sandbox",hubtel_enabled:!1,paystack_public_key:"",paystack_secret_key:"",paystack_mode:"test",paystack_enabled:!1,stripe_public_key:"",stripe_secret_key:"",stripe_mode:"test",stripe_enabled:!1,bank_name:"",bank_account_name:"",bank_account_number:"",bank_branch:"",bank_transfer_enabled:!1,mnotify_api_key:"",mnotify_sender_id:"",mnotify_enabled:!1,arkesel_api_key:"",arkesel_sender_id:"",arkesel_enabled:!1,twilio_account_sid:"",twilio_auth_token:"",twilio_phone_number:"",twilio_enabled:!1,sms_payment_confirmation:!0,sms_invoice_reminder:!0,sms_enrollment_confirmation:!0,sms_attendance_alert:!1,sms_exam_results:!0,sms_event_reminder:!0,smtp_host:"",smtp_port:"587",smtp_username:"",smtp_password:"",smtp_encryption:"tls",smtp_from_name:"",smtp_from_email:"",smtp_enabled:!1,email_payment_confirmation:!0,email_invoice_reminder:!0,email_enrollment_confirmation:!0,email_attendance_alert:!1,email_exam_results:!0,email_newsletter:!0,whatsapp_api_url:"",whatsapp_api_token:"",whatsapp_phone_number_id:"",whatsapp_business_id:"",whatsapp_enabled:!1,push_notifications_enabled:!1,firebase_server_key:"",password_min_length:8,password_require_uppercase:!0,password_require_lowercase:!0,password_require_number:!0,password_require_special:!1,password_expiry_days:90,session_timeout_minutes:30,max_login_attempts:5,lockout_duration_minutes:15,two_factor_enabled:!1,two_factor_method:"email",ip_whitelist_enabled:!1,ip_whitelist:"",auto_backup_enabled:!1,backup_frequency:"daily",backup_time:"02:00",backup_retention_days:30,backup_location:"local",maintenance_mode:!1,maintenance_message:"System is under maintenance. Please check back later.",debug_mode:!1,debug_log_api_requests:!1,debug_show_sql_errors:!1,google_calendar_enabled:!1,google_client_id:"",google_client_secret:"",microsoft_365_enabled:!1,microsoft_client_id:"",microsoft_client_secret:"",zoom_enabled:!1,zoom_api_key:"",zoom_api_secret:"",google_meet_enabled:!1}),U=[{id:"general",label:"General",icon:mn},{id:"payment",label:"Payment",icon:aa},{id:"sms",label:"SMS",icon:er},{id:"email",label:"Email",icon:ra},{id:"notifications",label:"Notifications",icon:nl},{id:"security",label:"Security",icon:$r},{id:"backup",label:"Backup",icon:Pu},{id:"integrations",label:"Integrations",icon:Hd},{id:"debug",label:"Debug",icon:$p}];h.useEffect(()=>{D()},[]);const D=async()=>{try{a(!0);const j=await F.get(`${ee}/system_config.php`);if(j.data.success&&j.data.config){const T={};Object.keys(j.data.config).forEach(Q=>{T[Q]=j.data.config[Q]??""}),v(Q=>({...Q,...T}))}}catch(j){console.error("Error fetching configuration:",j)}finally{a(!1)}},M=async()=>{try{l(!0),(await F.post(`${ee}/system_config.php`,y)).data.success?(f({school_name:y.school_name,school_logo:y.school_logo,school_tagline:y.school_motto||y.school_tagline,school_abbreviation:y.school_abbreviation||"",school_address:y.school_address,school_phone:y.school_phone,school_email:y.school_email}),await N(),alert(" Configuration saved!")):alert(" Failed to save")}catch{alert(" Error saving configuration")}finally{l(!1)}},K=async j=>{u(j);try{const T=await F.post(`${ee}/system_config.php?action=test_${j}`,y);alert(T.data.success?` ${j} connection successful!`:` ${j} failed: ${T.data.message||"Check credentials"}`)}catch{alert(" Connection test failed")}finally{u("")}},$=async j=>{const T=j.target.files[0];if(!T)return;const Q=new FormData;Q.append("logo",T);try{const E=await F.post(`${ee}/upload_logo.php`,Q);E.data.success&&(v(te=>({...te,school_logo:E.data.logo_url})),alert(" Logo uploaded!"),await N())}catch{alert(" Failed to upload logo")}},P=async()=>{if(confirm("Create a database backup now?"))try{l(!0);const j=await F.post(`${ee}/system_config.php?action=backup`);alert(j.data.success?" Backup created: "+j.data.filename:" Backup failed")}catch{alert(" Backup failed")}finally{l(!1)}},se=j=>g(T=>({...T,[j]:!T[j]})),z=({field:j,value:T,placeholder:Q,label:E})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:E}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:A[j]?"text":"password",value:T||"",onChange:te=>v({...y,[j]:te.target.value}),placeholder:Q,className:"input pr-10"}),e.jsx("button",{type:"button",onClick:()=>se(j),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:A[j]?e.jsx(ib,{className:"w-4 h-4"}):e.jsx(na,{className:"w-4 h-4"})})]})]}),R=({field:j,label:T,desc:Q})=>e.jsxs("label",{className:"flex items-center justify-between p-4 border rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:T}),Q&&e.jsx("p",{className:"text-sm text-gray-600",children:Q})]}),e.jsx("input",{type:"checkbox",checked:y[j]||!1,onChange:E=>v({...y,[j]:E.target.checked}),className:"toggle"})]});return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Ka,{className:"w-7 h-7 text-blue-600"}),"System Configuration"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Configure all system settings, integrations, and preferences"})]}),e.jsxs("button",{onClick:M,disabled:r,className:"btn btn-primary",children:[e.jsx(Br,{className:"w-4 h-4"}),r?"Saving...":"Save All"]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"border-b overflow-x-auto",children:e.jsx("div",{className:"flex gap-1 px-4 min-w-max",children:U.map(j=>e.jsxs("button",{onClick:()=>o(j.id),className:`py-3 px-4 border-b-2 font-medium flex items-center gap-2 whitespace-nowrap ${c===j.id?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:[e.jsx(j.icon,{className:"w-4 h-4"}),j.label]},j.id))})}),e.jsxs("div",{className:"p-6",children:[c==="general"&&e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(mn,{className:"w-5 h-5 text-blue-600"}),"School Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"School Name *"}),e.jsx("input",{type:"text",value:y.school_name,onChange:j=>v({...y,school_name:j.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Motto"}),e.jsx("input",{type:"text",value:y.school_motto,onChange:j=>v({...y,school_motto:j.target.value}),className:"input"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),e.jsx("textarea",{value:y.school_address,onChange:j=>v({...y,school_address:j.target.value}),className:"input",rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),e.jsx("input",{type:"tel",value:y.school_phone,onChange:j=>v({...y,school_phone:j.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx("input",{type:"email",value:y.school_email,onChange:j=>v({...y,school_email:j.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Website"}),e.jsx("input",{type:"url",value:y.school_website,onChange:j=>v({...y,school_website:j.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Logo"}),e.jsxs("div",{className:"flex items-center gap-4",children:[y.school_logo&&e.jsx("img",{src:y.school_logo,alt:"Logo",className:"w-16 h-16 object-contain border rounded"}),e.jsx("input",{type:"file",ref:x,onChange:$,accept:"image/*",className:"hidden"}),e.jsxs("button",{onClick:()=>x.current?.click(),className:"btn bg-gray-100 hover:bg-gray-200",children:[e.jsx(Hr,{className:"w-4 h-4"}),"Upload"]})]})]})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Ot,{className:"w-5 h-5 text-green-600"}),"Academic Settings"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Academic Year"}),e.jsx("input",{type:"text",value:y.current_academic_year,onChange:j=>v({...y,current_academic_year:j.target.value}),placeholder:"2024/2025",className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Term"}),e.jsxs("select",{value:y.current_term,onChange:j=>v({...y,current_term:j.target.value}),className:"input",children:[e.jsx("option",{value:"1",children:"Term 1"}),e.jsx("option",{value:"2",children:"Term 2"}),e.jsx("option",{value:"3",children:"Term 3"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Terms/Year"}),e.jsxs("select",{value:y.terms_per_year,onChange:j=>v({...y,terms_per_year:j.target.value}),className:"input",children:[e.jsx("option",{value:"2",children:"2"}),e.jsx("option",{value:"3",children:"3"}),e.jsx("option",{value:"4",children:"4"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Grading"}),e.jsxs("select",{value:y.grading_system,onChange:j=>v({...y,grading_system:j.target.value}),className:"input",children:[e.jsx("option",{value:"percentage",children:"Percentage"}),e.jsx("option",{value:"letter",children:"Letter"}),e.jsx("option",{value:"gpa",children:"GPA"})]})]})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Ou,{className:"w-5 h-5 text-purple-600"}),"Locale Settings"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Timezone"}),e.jsxs("select",{value:y.timezone,onChange:j=>v({...y,timezone:j.target.value}),className:"input",children:[e.jsx("option",{value:"Africa/Accra",children:"Africa/Accra"}),e.jsx("option",{value:"Africa/Lagos",children:"Africa/Lagos"}),e.jsx("option",{value:"Europe/London",children:"Europe/London"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date Format"}),e.jsxs("select",{value:y.date_format,onChange:j=>v({...y,date_format:j.target.value}),className:"input",children:[e.jsx("option",{value:"DD/MM/YYYY",children:"DD/MM/YYYY"}),e.jsx("option",{value:"MM/DD/YYYY",children:"MM/DD/YYYY"}),e.jsx("option",{value:"YYYY-MM-DD",children:"YYYY-MM-DD"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Currency"}),e.jsxs("select",{value:y.currency,onChange:j=>v({...y,currency:j.target.value}),className:"input",children:[e.jsx("option",{value:"GHS",children:"GHS"}),e.jsx("option",{value:"NGN",children:"NGN"}),e.jsx("option",{value:"USD",children:"USD"})]})]})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Gk,{className:"w-5 h-5 text-pink-600"}),"Branding"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Primary Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"color",value:y.primary_color,onChange:j=>v({...y,primary_color:j.target.value}),className:"w-12 h-10 rounded"}),e.jsx("input",{type:"text",value:y.primary_color,onChange:j=>v({...y,primary_color:j.target.value}),className:"input flex-1"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Secondary Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"color",value:y.secondary_color,onChange:j=>v({...y,secondary_color:j.target.value}),className:"w-12 h-10 rounded"}),e.jsx("input",{type:"text",value:y.secondary_color,onChange:j=>v({...y,secondary_color:j.target.value}),className:"input flex-1"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Accent Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"color",value:y.accent_color,onChange:j=>v({...y,accent_color:j.target.value}),className:"w-12 h-10 rounded"}),e.jsx("input",{type:"text",value:y.accent_color,onChange:j=>v({...y,accent_color:j.target.value}),className:"input flex-1"})]})]})]})]})]}),c==="payment"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(aa,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Hubtel"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Mobile Money & Cards"})]})]}),e.jsx("input",{type:"checkbox",checked:y.hubtel_enabled,onChange:j=>v({...y,hubtel_enabled:j.target.checked}),className:"toggle"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Client ID"}),e.jsx("input",{type:"text",value:y.hubtel_client_id,onChange:j=>v({...y,hubtel_client_id:j.target.value}),className:"input"})]}),e.jsx(z,{field:"hubtel_client_secret",value:y.hubtel_client_secret,placeholder:"Client Secret",label:"Client Secret"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Merchant Number"}),e.jsx("input",{type:"text",value:y.hubtel_merchant_number,onChange:j=>v({...y,hubtel_merchant_number:j.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mode"}),e.jsxs("select",{value:y.hubtel_mode,onChange:j=>v({...y,hubtel_mode:j.target.value}),className:"input",children:[e.jsx("option",{value:"sandbox",children:"Sandbox"}),e.jsx("option",{value:"live",children:"Live"})]})]})]}),e.jsxs("button",{onClick:()=>K("hubtel"),disabled:m==="hubtel",className:"btn bg-green-600 hover:bg-green-700 text-white mt-4",children:[e.jsx($p,{className:"w-4 h-4"}),m==="hubtel"?"Testing...":"Test"]})]}),e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(aa,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"PayStack"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Card & Mobile Money"})]})]}),e.jsx("input",{type:"checkbox",checked:y.paystack_enabled,onChange:j=>v({...y,paystack_enabled:j.target.checked}),className:"toggle"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Public Key"}),e.jsx("input",{type:"text",value:y.paystack_public_key,onChange:j=>v({...y,paystack_public_key:j.target.value}),className:"input"})]}),e.jsx(z,{field:"paystack_secret_key",value:y.paystack_secret_key,placeholder:"Secret Key",label:"Secret Key"})]})]}),e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(aa,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Stripe"}),e.jsx("p",{className:"text-sm text-gray-600",children:"International Payments"})]})]}),e.jsx("input",{type:"checkbox",checked:y.stripe_enabled,onChange:j=>v({...y,stripe_enabled:j.target.checked}),className:"toggle"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Publishable Key"}),e.jsx("input",{type:"text",value:y.stripe_public_key,onChange:j=>v({...y,stripe_public_key:j.target.value}),className:"input"})]}),e.jsx(z,{field:"stripe_secret_key",value:y.stripe_secret_key,placeholder:"Secret Key",label:"Secret Key"})]})]}),e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(mn,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Bank Transfer"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manual Payment"})]})]}),e.jsx("input",{type:"checkbox",checked:y.bank_transfer_enabled,onChange:j=>v({...y,bank_transfer_enabled:j.target.checked}),className:"toggle"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bank Name"}),e.jsx("input",{type:"text",value:y.bank_name,onChange:j=>v({...y,bank_name:j.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account Name"}),e.jsx("input",{type:"text",value:y.bank_account_name,onChange:j=>v({...y,bank_account_name:j.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account Number"}),e.jsx("input",{type:"text",value:y.bank_account_number,onChange:j=>v({...y,bank_account_number:j.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Branch"}),e.jsx("input",{type:"text",value:y.bank_branch,onChange:j=>v({...y,bank_branch:j.target.value}),className:"input"})]})]})]})]}),c==="sms"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center",children:e.jsx(er,{className:"w-5 h-5 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"mNotify"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Ghana SMS"})]})]}),e.jsx("input",{type:"checkbox",checked:y.mnotify_enabled,onChange:j=>v({...y,mnotify_enabled:j.target.checked}),className:"toggle"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(z,{field:"mnotify_api_key",value:y.mnotify_api_key,placeholder:"API Key",label:"API Key"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sender ID"}),e.jsx("input",{type:"text",value:y.mnotify_sender_id,onChange:j=>v({...y,mnotify_sender_id:j.target.value}),maxLength:11,className:"input"})]})]}),e.jsxs("button",{onClick:()=>K("mnotify"),disabled:m==="mnotify",className:"btn bg-green-600 hover:bg-green-700 text-white mt-4",children:[e.jsx($p,{className:"w-4 h-4"}),"Test"]})]}),e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx(er,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Arkesel"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Ghana SMS"})]})]}),e.jsx("input",{type:"checkbox",checked:y.arkesel_enabled,onChange:j=>v({...y,arkesel_enabled:j.target.checked}),className:"toggle"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(z,{field:"arkesel_api_key",value:y.arkesel_api_key,placeholder:"API Key",label:"API Key"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sender ID"}),e.jsx("input",{type:"text",value:y.arkesel_sender_id,onChange:j=>v({...y,arkesel_sender_id:j.target.value}),maxLength:11,className:"input"})]})]})]}),e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-pink-100 rounded-lg flex items-center justify-center",children:e.jsx(er,{className:"w-5 h-5 text-pink-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Twilio"}),e.jsx("p",{className:"text-sm text-gray-600",children:"International SMS"})]})]}),e.jsx("input",{type:"checkbox",checked:y.twilio_enabled,onChange:j=>v({...y,twilio_enabled:j.target.checked}),className:"toggle"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account SID"}),e.jsx("input",{type:"text",value:y.twilio_account_sid,onChange:j=>v({...y,twilio_account_sid:j.target.value}),className:"input"})]}),e.jsx(z,{field:"twilio_auth_token",value:y.twilio_auth_token,placeholder:"Auth Token",label:"Auth Token"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),e.jsx("input",{type:"text",value:y.twilio_phone_number,onChange:j=>v({...y,twilio_phone_number:j.target.value}),className:"input"})]})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"SMS Triggers"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx(R,{field:"sms_payment_confirmation",label:"Payment Confirmation",desc:"SMS on payment"}),e.jsx(R,{field:"sms_invoice_reminder",label:"Invoice Reminder",desc:"SMS for unpaid invoices"}),e.jsx(R,{field:"sms_enrollment_confirmation",label:"Enrollment",desc:"SMS on enrollment"}),e.jsx(R,{field:"sms_attendance_alert",label:"Attendance Alert",desc:"SMS on absence"}),e.jsx(R,{field:"sms_exam_results",label:"Exam Results",desc:"SMS on results"}),e.jsx(R,{field:"sms_event_reminder",label:"Event Reminder",desc:"SMS for events"})]})]})]}),c==="email"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(ra,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"SMTP Configuration"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Email server settings"})]})]}),e.jsx("input",{type:"checkbox",checked:y.smtp_enabled,onChange:j=>v({...y,smtp_enabled:j.target.checked}),className:"toggle"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SMTP Host"}),e.jsx("input",{type:"text",value:y.smtp_host,onChange:j=>v({...y,smtp_host:j.target.value}),placeholder:"smtp.gmail.com",className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Port"}),e.jsx("input",{type:"text",value:y.smtp_port,onChange:j=>v({...y,smtp_port:j.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Encryption"}),e.jsxs("select",{value:y.smtp_encryption,onChange:j=>v({...y,smtp_encryption:j.target.value}),className:"input",children:[e.jsx("option",{value:"tls",children:"TLS"}),e.jsx("option",{value:"ssl",children:"SSL"}),e.jsx("option",{value:"none",children:"None"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),e.jsx("input",{type:"text",value:y.smtp_username,onChange:j=>v({...y,smtp_username:j.target.value}),className:"input"})]}),e.jsx(z,{field:"smtp_password",value:y.smtp_password,placeholder:"Password",label:"Password"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"From Name"}),e.jsx("input",{type:"text",value:y.smtp_from_name,onChange:j=>v({...y,smtp_from_name:j.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"From Email"}),e.jsx("input",{type:"email",value:y.smtp_from_email,onChange:j=>v({...y,smtp_from_email:j.target.value}),className:"input"})]})]}),e.jsxs("button",{onClick:()=>K("smtp"),disabled:m==="smtp",className:"btn bg-green-600 hover:bg-green-700 text-white mt-4",children:[e.jsx(va,{className:"w-4 h-4"}),"Send Test Email"]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Email Triggers"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx(R,{field:"email_payment_confirmation",label:"Payment Confirmation"}),e.jsx(R,{field:"email_invoice_reminder",label:"Invoice Reminder"}),e.jsx(R,{field:"email_enrollment_confirmation",label:"Enrollment"}),e.jsx(R,{field:"email_attendance_alert",label:"Attendance Alert"}),e.jsx(R,{field:"email_exam_results",label:"Exam Results"}),e.jsx(R,{field:"email_newsletter",label:"Newsletter"})]})]})]}),c==="notifications"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(wa,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"WhatsApp Business API"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Send via WhatsApp"})]})]}),e.jsx("input",{type:"checkbox",checked:y.whatsapp_enabled,onChange:j=>v({...y,whatsapp_enabled:j.target.checked}),className:"toggle"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"API URL"}),e.jsx("input",{type:"url",value:y.whatsapp_api_url,onChange:j=>v({...y,whatsapp_api_url:j.target.value}),className:"input"})]}),e.jsx(z,{field:"whatsapp_api_token",value:y.whatsapp_api_token,placeholder:"Access Token",label:"Access Token"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number ID"}),e.jsx("input",{type:"text",value:y.whatsapp_phone_number_id,onChange:j=>v({...y,whatsapp_phone_number_id:j.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Business ID"}),e.jsx("input",{type:"text",value:y.whatsapp_business_id,onChange:j=>v({...y,whatsapp_business_id:j.target.value}),className:"input"})]})]})]}),e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(nl,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Push Notifications"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Firebase Cloud Messaging"})]})]}),e.jsx("input",{type:"checkbox",checked:y.push_notifications_enabled,onChange:j=>v({...y,push_notifications_enabled:j.target.checked}),className:"toggle"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Firebase Server Key"}),e.jsx("input",{type:"text",value:y.firebase_server_key,onChange:j=>v({...y,firebase_server_key:j.target.value}),className:"input"})]})]})]}),c==="security"&&e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Ui,{className:"w-5 h-5 text-red-600"}),"Password Policy"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Min Length"}),e.jsx("input",{type:"number",value:y.password_min_length,onChange:j=>v({...y,password_min_length:parseInt(j.target.value)}),min:6,className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expiry (days, 0=never)"}),e.jsx("input",{type:"number",value:y.password_expiry_days,onChange:j=>v({...y,password_expiry_days:parseInt(j.target.value)}),min:0,className:"input"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-4",children:[e.jsx(R,{field:"password_require_uppercase",label:"Require Uppercase"}),e.jsx(R,{field:"password_require_lowercase",label:"Require Lowercase"}),e.jsx(R,{field:"password_require_number",label:"Require Number"}),e.jsx(R,{field:"password_require_special",label:"Require Special Char"})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Rt,{className:"w-5 h-5 text-blue-600"}),"Session Security"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Session Timeout (min)"}),e.jsx("input",{type:"number",value:y.session_timeout_minutes,onChange:j=>v({...y,session_timeout_minutes:parseInt(j.target.value)}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Login Attempts"}),e.jsx("input",{type:"number",value:y.max_login_attempts,onChange:j=>v({...y,max_login_attempts:parseInt(j.target.value)}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lockout (min)"}),e.jsx("input",{type:"number",value:y.lockout_duration_minutes,onChange:j=>v({...y,lockout_duration_minutes:parseInt(j.target.value)}),className:"input"})]})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(H1,{className:"w-5 h-5 text-green-600"}),"Two-Factor Auth"]}),e.jsx(R,{field:"two_factor_enabled",label:"Enable 2FA",desc:"Require 2FA for admins"}),y.two_factor_enabled&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"2FA Method"}),e.jsxs("select",{value:y.two_factor_method,onChange:j=>v({...y,two_factor_method:j.target.value}),className:"input w-auto",children:[e.jsx("option",{value:"email",children:"Email OTP"}),e.jsx("option",{value:"sms",children:"SMS OTP"}),e.jsx("option",{value:"authenticator",children:"Authenticator"})]})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx($r,{className:"w-5 h-5 text-purple-600"}),"IP Whitelist"]}),e.jsx(R,{field:"ip_whitelist_enabled",label:"Enable IP Whitelist"}),y.ip_whitelist_enabled&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Allowed IPs (one per line)"}),e.jsx("textarea",{value:y.ip_whitelist,onChange:j=>v({...y,ip_whitelist:j.target.value}),className:"input",rows:4})]})]})]}),c==="backup"&&e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(ck,{className:"w-5 h-5 text-blue-600"}),"Manual Backup"]}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Create a backup of the database now"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:P,disabled:r,className:"btn bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(xs,{className:"w-4 h-4"}),"Backup Now"]}),e.jsxs("button",{onClick:()=>window.open(`${ee}/system_config.php?action=export`,"_blank"),className:"btn bg-gray-100 hover:bg-gray-200",children:[e.jsx(xs,{className:"w-4 h-4"}),"Export Data"]})]})]}),e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Ns,{className:"w-5 h-5 text-green-600"}),"Auto Backup"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Schedule automatic backups"})]}),e.jsx("input",{type:"checkbox",checked:y.auto_backup_enabled,onChange:j=>v({...y,auto_backup_enabled:j.target.checked}),className:"toggle"})]}),y.auto_backup_enabled&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Frequency"}),e.jsxs("select",{value:y.backup_frequency,onChange:j=>v({...y,backup_frequency:j.target.value}),className:"input",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time"}),e.jsx("input",{type:"time",value:y.backup_time,onChange:j=>v({...y,backup_time:j.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Retention (days)"}),e.jsx("input",{type:"number",value:y.backup_retention_days,onChange:j=>v({...y,backup_retention_days:parseInt(j.target.value)}),className:"input"})]})]})]}),e.jsxs("div",{className:"border rounded-lg p-6 bg-yellow-50 border-yellow-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2 text-yellow-800",children:[e.jsx(_s,{className:"w-5 h-5"}),"Maintenance Mode"]}),e.jsx("p",{className:"text-sm text-yellow-700",children:"Disable access during updates"})]}),e.jsx("input",{type:"checkbox",checked:y.maintenance_mode,onChange:j=>v({...y,maintenance_mode:j.target.checked}),className:"toggle"})]}),y.maintenance_mode&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message"}),e.jsx("textarea",{value:y.maintenance_message,onChange:j=>v({...y,maintenance_message:j.target.value}),className:"input",rows:2})]})]})]}),c==="integrations"&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center",children:e.jsx(fy,{className:"w-10 h-10 text-blue-600"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Integration Hub"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6 max-w-md mx-auto",children:"All integrations have been moved to the dedicated Integration Hub for better management of SMS, Email, Payment Gateways, and more."}),e.jsxs("button",{onClick:()=>t("/admin/integrations"),className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(vh,{className:"w-5 h-5"}),"Go to Integration Hub"]})]}),c==="debug"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(_s,{className:"w-6 h-6 text-yellow-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-yellow-800",children:"Developer Mode"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"Debug mode should only be enabled during development or troubleshooting. Disable it in production to prevent exposing sensitive error information."})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx($p,{className:"w-5 h-5 text-purple-600"}),"Debug Settings"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex items-center justify-between p-4 border rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Enable Debug Mode"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Show detailed error messages in API responses"})]}),e.jsx("input",{type:"checkbox",checked:y.debug_mode,onChange:j=>v({...y,debug_mode:j.target.checked}),className:"w-5 h-5 rounded text-blue-600"})]}),e.jsxs("label",{className:"flex items-center justify-between p-4 border rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Log API Requests"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Log all API requests to the server error log"})]}),e.jsx("input",{type:"checkbox",checked:y.debug_log_api_requests,onChange:j=>v({...y,debug_log_api_requests:j.target.checked}),className:"w-5 h-5 rounded text-blue-600"})]}),e.jsxs("label",{className:"flex items-center justify-between p-4 border rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Show SQL Errors"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Include SQL error details in debug output"})]}),e.jsx("input",{type:"checkbox",checked:y.debug_show_sql_errors,onChange:j=>v({...y,debug_show_sql_errors:j.target.checked}),className:"w-5 h-5 rounded text-blue-600"})]})]})]}),e.jsxs("div",{className:"bg-gray-100 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Debug Status"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-3 h-3 rounded-full ${y.debug_mode?"bg-green-500 animate-pulse":"bg-gray-400"}`}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Debug mode is currently ",e.jsx("strong",{children:y.debug_mode?"ENABLED":"DISABLED"})]})]}),y.debug_mode&&e.jsx("p",{className:"text-xs text-orange-600 mt-2",children:" Remember to disable debug mode after troubleshooting"})]})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:M,disabled:r,className:"btn btn-primary",children:[e.jsx(Br,{className:"w-4 h-4"}),r?"Saving...":"Save All Changes"]})})]})}const mT=()=>{const[t,s]=h.useState(null),[a,r]=h.useState(!0),[l,c]=h.useState(!1),[o,m]=h.useState(""),[u,x]=h.useState(!1),[A,g]=h.useState(null),[N,f]=h.useState(null),[y,v]=h.useState({keep_all_users:!1,reset_terms:!1,reset_academic_years:!1,clear_uploads:!0});h.useEffect(()=>{U()},[]);const U=async()=>{try{r(!0),f(null);const K=await F.get(`${ee}/system_reset.php?action=preview`);s(K.data)}catch(K){f("Failed to load reset preview: "+(K.response?.data?.error||K.message))}finally{r(!1)}},D=async()=>{if(o!=="RESET-CONFIRM"){f("Please enter the correct confirmation code: RESET-CONFIRM");return}try{c(!0),f(null);const K=localStorage.getItem("token"),$=JSON.parse(localStorage.getItem("user")||"{}"),P=await F.post(`${ee}/system_reset.php`,{confirmation_code:o,admin_user_id:$.id,...y},{headers:{Authorization:`Bearer ${K}`,"Content-Type":"application/json"}});g(P.data),x(!1),m(""),setTimeout(()=>{U()},1e3)}catch(K){f("Reset failed: "+(K.response?.data?.error||K.message))}finally{c(!1)}},M=K=>K.includes("student")||K.includes("teacher")||K.includes("parent")||K.includes("user")?e.jsx(Rt,{className:"w-4 h-4"}):K.includes("invoice")||K.includes("payment")||K.includes("fee")||K.includes("payroll")?e.jsx(vs,{className:"w-4 h-4"}):K.includes("attendance")||K.includes("timetable")||K.includes("term")?e.jsx(Ot,{className:"w-4 h-4"}):e.jsx(Pu,{className:"w-4 h-4"});return a?e.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[e.jsx(hs,{className:"w-8 h-8 animate-spin text-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading system data..."})]}):e.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(Ns,{className:"w-8 h-8 text-red-600"}),"System Reset"]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Reset the system for a new school setup. This will delete all demo/existing data."})]}),e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-6 rounded-r-lg",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(_s,{className:"w-6 h-6 text-red-500 mr-3 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-red-800 font-semibold",children:"Warning: Destructive Action"}),e.jsx("p",{className:"text-red-700 mt-1",children:"This action will permanently delete all data from the system. This cannot be undone. Make sure you have a backup before proceeding."})]})]})}),N&&e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6 flex items-center",children:[e.jsx(Js,{className:"w-5 h-5 mr-2"}),N]}),A&&A.success&&e.jsxs("div",{className:"bg-green-50 border border-green-400 rounded-lg p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(Mt,{className:"w-6 h-6 text-green-600 mr-2"}),e.jsx("h3",{className:"text-green-800 font-semibold text-lg",children:"System Reset Completed"})]}),e.jsxs("p",{className:"text-green-700 mb-4",children:["The system has been reset successfully at ",A.timestamp,"."]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 max-h-60 overflow-y-auto",children:[e.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Reset Summary:"}),e.jsx("ul",{className:"space-y-1 text-sm",children:A.reset_log?.map((K,$)=>e.jsxs("li",{className:"flex items-center text-gray-600",children:[e.jsx(Mt,{className:"w-4 h-4 text-green-500 mr-2"}),K.table,": ",K.records_deleted," records deleted"]},$))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(Pu,{className:"w-5 h-5 mr-2 text-blue-600"}),"Data to be Deleted"]}),t&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-2xl font-bold text-red-600",children:t.total_records?.toLocaleString()}),e.jsx("span",{className:"text-gray-600 ml-2",children:"total records will be deleted"})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Table"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Records"})]})}),e.jsx("tbody",{children:t.preview?.map((K,$)=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsxs("td",{className:"py-2 px-3 flex items-center",children:[M(K.table),e.jsx("span",{className:"ml-2",children:K.description})]}),e.jsx("td",{className:"py-2 px-3 text-right font-mono",children:K.record_count>0?e.jsx("span",{className:"text-red-600 font-semibold",children:K.record_count.toLocaleString()}):e.jsx("span",{className:"text-gray-400",children:"0"})})]},$))})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx($r,{className:"w-5 h-5 mr-2 text-green-600"}),"Data Preserved"]}),e.jsx("p",{className:"text-gray-600 mb-3 text-sm",children:"The following will NOT be deleted:"}),e.jsx("ul",{className:"space-y-2",children:t?.preserved?.map((K,$)=>e.jsxs("li",{className:"flex items-center text-gray-700",children:[e.jsx(Mt,{className:"w-4 h-4 text-green-500 mr-2"}),K]},$))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(Kt,{className:"w-5 h-5 mr-2 text-purple-600"}),"Reset Options"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex items-start cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:y.clear_uploads,onChange:K=>v({...y,clear_uploads:K.target.checked}),className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{className:"ml-3",children:[e.jsxs("span",{className:"text-gray-700 font-medium flex items-center",children:[e.jsx(Hr,{className:"w-4 h-4 mr-1"}),"Clear uploaded files"]}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Delete all uploaded images and documents"})]})]}),e.jsxs("label",{className:"flex items-start cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:y.reset_terms,onChange:K=>v({...y,reset_terms:K.target.checked}),className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{className:"ml-3",children:[e.jsxs("span",{className:"text-gray-700 font-medium flex items-center",children:[e.jsx(Ot,{className:"w-4 h-4 mr-1"}),"Reset academic terms"]}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Delete all term definitions"})]})]}),e.jsxs("label",{className:"flex items-start cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:y.reset_academic_years,onChange:K=>v({...y,reset_academic_years:K.target.checked}),className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Reset academic years"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Delete all academic year definitions"})]})]}),e.jsxs("label",{className:"flex items-start cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:y.keep_all_users,onChange:K=>v({...y,keep_all_users:K.target.checked}),className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{className:"ml-3",children:[e.jsxs("span",{className:"text-gray-700 font-medium flex items-center",children:[e.jsx(Rt,{className:"w-4 h-4 mr-1"}),"Keep all user accounts"]}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Preserve non-admin user accounts (teachers, students, parents)"})]})]})]})]}),e.jsxs("button",{onClick:()=>x(!0),className:"w-full bg-red-600 hover:bg-red-700 text-white font-semibold py-4 px-6 rounded-lg flex items-center justify-center transition-colors",children:[e.jsx(us,{className:"w-5 h-5 mr-2"}),"Reset System"]})]})]}),u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(_s,{className:"w-8 h-8 text-red-500 mr-3"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Confirm System Reset"})]}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["You are about to permanently delete ",e.jsxs("strong",{className:"text-red-600",children:[t?.total_records?.toLocaleString()," records"]})," from the system."]}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["To confirm, type ",e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded font-mono text-red-600",children:"RESET-CONFIRM"})," below:"]}),e.jsx("input",{type:"text",value:o,onChange:K=>m(K.target.value.toUpperCase()),placeholder:"Type RESET-CONFIRM",className:"w-full border border-gray-300 rounded-lg px-4 py-2 mb-4 font-mono focus:ring-2 focus:ring-red-500 focus:border-red-500"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{x(!1),m("")},className:"flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-2 px-4 rounded-lg transition-colors",children:"Cancel"}),e.jsx("button",{onClick:D,disabled:o!=="RESET-CONFIRM"||l,className:`flex-1 font-semibold py-2 px-4 rounded-lg flex items-center justify-center transition-colors ${o==="RESET-CONFIRM"&&!l?"bg-red-600 hover:bg-red-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:l?e.jsxs(e.Fragment,{children:[e.jsx(hs,{className:"w-4 h-4 mr-2 animate-spin"}),"Resetting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(us,{className:"w-4 h-4 mr-2"}),"Confirm Reset"]})})]})]})})]})};function uT(){const{user:t}=Us(),[s,a]=h.useState("this_month"),[r,l]=h.useState("all"),[c,o]=h.useState(!1),[m,u]=h.useState(""),[x,A]=h.useState(""),[g,N]=h.useState(""),[f,y]=h.useState(!1),[v,U]=h.useState([]),[D,M]=h.useState([]),[K,$]=h.useState([]),[P,se]=h.useState([]),[z,R]=h.useState({students:0,revenue:0,attendance:0,outstanding:0}),[j,T]=h.useState(!1),[Q,E]=h.useState(!1),[te,C]=h.useState(!1),[O,V]=h.useState(!1),[re,ge]=h.useState(null),[xe,Z]=h.useState({report_type:"",frequency:"weekly",day_of_week:"monday",time:"08:00",recipients:"",format:"pdf"}),[I,H]=h.useState({name:"",report_type:"",filters:{},columns:[]}),[ae,k]=h.useState({recipients:"",subject:"",message:"",attach_pdf:!0}),B=[{id:"academic",title:"Academic Reports",icon:Qs,color:"blue",reports:[{id:"student_performance",name:"Student Performance",description:"View student grades and performance metrics",link:"/admin/reports/academic"},{id:"class_performance",name:"Class Performance",description:"Compare performance across classes",link:"/admin/reports/academic"},{id:"subject_analysis",name:"Subject Analysis",description:"Analyze performance by subject",link:"/admin/reports/academic"},{id:"attendance_summary",name:"Attendance Summary",description:"Student attendance statistics",link:"/admin/reports/academic"},{id:"progress_report",name:"Progress Reports",description:"Individual student progress tracking",link:"/admin/reports/academic"}]},{id:"financial",title:"Financial Reports",icon:vs,color:"green",reports:[{id:"revenue_report",name:"Revenue Report",description:"Total revenue and collections",link:"/admin/reports/financial"},{id:"outstanding_fees",name:"Outstanding Fees",description:"Unpaid invoices and balances",link:"/admin/reports/financial"},{id:"payment_history",name:"Payment History",description:"Payment transactions over time",link:"/admin/reports/financial"},{id:"collection_rate",name:"Fee Collection Rate",description:"Collection efficiency metrics",link:"/admin/reports/financial"},{id:"budget_variance",name:"Budget vs Actual",description:"Financial variance analysis",link:"/admin/reports/financial"}]},{id:"student",title:"Student Reports",icon:Rt,color:"purple",reports:[{id:"enrollment",name:"Enrollment Report",description:"Student enrollment statistics",link:"/admin/reports/students"},{id:"demographics",name:"Demographics",description:"Student demographic breakdown",link:"/admin/reports/students"},{id:"class_distribution",name:"Class Distribution",description:"Students per class/level",link:"/admin/reports/students"},{id:"admissions",name:"New Admissions",description:"Recent admission statistics",link:"/admin/reports/students"},{id:"parent_engagement",name:"Parent Engagement",description:"Portal usage and meeting attendance",link:"/admin/reports/students"}]},{id:"executive",title:"Executive Reports",icon:$s,color:"orange",reports:[{id:"executive_dashboard",name:"Executive Dashboard",description:"High-level overview of all metrics",link:"/admin/reports/executive"},{id:"monthly_summary",name:"Monthly Summary",description:"Comprehensive monthly report",link:"/admin/reports/executive"},{id:"year_over_year",name:"Year-over-Year",description:"Compare performance across years",link:"/admin/reports/executive"},{id:"kpi_dashboard",name:"KPI Dashboard",description:"Key performance indicators tracking",link:"/admin/reports/executive"}]},{id:"staff",title:"Staff Reports",icon:Pr,color:"indigo",reports:[{id:"staff_directory",name:"Staff Directory",description:"Complete staff listing",link:"/admin/hr-payroll"},{id:"payroll_summary",name:"Payroll Summary",description:"Monthly payroll breakdown",link:"/admin/hr-payroll"},{id:"leave_report",name:"Leave Report",description:"Staff leave statistics",link:"/admin/hr-payroll"},{id:"teacher_workload",name:"Teacher Workload",description:"Teaching assignments analysis",link:"/admin/hr-payroll"}]},{id:"transport",title:"Transport Reports",icon:Qo,color:"teal",reports:[{id:"vehicle_usage",name:"Vehicle Usage",description:"Fleet utilization statistics",link:"/admin/transport"},{id:"route_efficiency",name:"Route Efficiency",description:"Route optimization analysis",link:"/admin/transport"},{id:"fuel_consumption",name:"Fuel Consumption",description:"Fuel usage and costs",link:"/admin/transport"},{id:"maintenance_log",name:"Maintenance Log",description:"Vehicle maintenance history",link:"/admin/transport"}]},{id:"communication",title:"Communication Reports",icon:wa,color:"pink",reports:[{id:"sms_delivery",name:"SMS Delivery",description:"SMS delivery statistics",link:"/admin/sms"},{id:"email_delivery",name:"Email Delivery",description:"Email delivery and open rates",link:"/admin/email"},{id:"whatsapp_stats",name:"WhatsApp Stats",description:"WhatsApp message statistics",link:"/admin/whatsapp"},{id:"notification_log",name:"Notification Log",description:"All notifications sent",link:"/admin/messages"}]},{id:"compliance",title:"Compliance Reports",icon:Or,color:"red",reports:[{id:"audit_trail",name:"Audit Trail",description:"System activity log",link:"/admin/logs"},{id:"data_privacy",name:"Data Privacy",description:"GDPR compliance report",link:"/admin/logs"},{id:"access_log",name:"Access Log",description:"User access history",link:"/admin/logs"}]}];h.useEffect(()=>{w(),oe(),ne()},[]);const w=()=>{const ve=localStorage.getItem("report_favorites");ve&&M(JSON.parse(ve));const ie=localStorage.getItem("report_schedules");ie&&$(JSON.parse(ie));const q=localStorage.getItem("report_templates");q&&se(JSON.parse(q))},oe=async()=>{try{const[ve,ie]=await Promise.all([F.get(`${ee}/students.php`),F.get(`${ee}/finance.php?resource=dashboard`)]);R({students:ve.data.students?.length||ve.data.total||0,revenue:ie.data.total_revenue||ie.data.stats?.total_revenue||0,attendance:94.5,outstanding:ie.data.outstanding||ie.data.stats?.outstanding||0})}catch(ve){console.error(ve)}},ne=async()=>{try{const ve=await F.get(`${ee}/reports.php?action=recent`);U(ve.data.reports||[])}catch(ve){console.error("Error fetching recent reports:",ve),U([])}},Fe=ve=>{const ie=D.includes(ve)?D.filter(q=>q!==ve):[...D,ve];M(ie),localStorage.setItem("report_favorites",JSON.stringify(ie))},je=ve=>{ve.preventDefault();const ie={...xe,id:Date.now(),created_at:new Date().toISOString(),status:"active"},q=[...K,ie];$(q),localStorage.setItem("report_schedules",JSON.stringify(q)),T(!1),Z({report_type:"",frequency:"weekly",day_of_week:"monday",time:"08:00",recipients:"",format:"pdf"}),alert(" Report scheduled successfully!")},Ge=ve=>{if(!confirm("Delete this scheduled report?"))return;const ie=K.filter(q=>q.id!==ve);$(ie),localStorage.setItem("report_schedules",JSON.stringify(ie))},ze=ve=>{const ie=K.map(q=>q.id===ve?{...q,status:q.status==="active"?"paused":"active"}:q);$(ie),localStorage.setItem("report_schedules",JSON.stringify(ie))},Xe=ve=>{if(ve.preventDefault(),!I.name){alert("Enter template name");return}const ie={...I,id:Date.now(),created_at:new Date().toISOString()},q=[...P,ie];se(q),localStorage.setItem("report_templates",JSON.stringify(q)),C(!1),H({name:"",report_type:"",filters:{},columns:[]}),alert(" Template saved!")},st=ve=>{if(!confirm("Delete this template?"))return;const ie=P.filter(q=>q.id!==ve);se(ie),localStorage.setItem("report_templates",JSON.stringify(ie))},ce=()=>{const ve=`${window.location.origin}/shared-report/${re?.id}`;navigator.clipboard.writeText(ve),alert(" Share link copied to clipboard!"),E(!1)},_e=async ve=>{ve.preventDefault();try{await F.post(`${ee}/reports.php?action=email`,{report_id:re?.id,...ae}),alert(" Report emailed successfully!"),V(!1),k({recipients:"",subject:"",message:"",attach_pdf:!0})}catch{alert("Email sent (simulated)"),V(!1)}},le=ve=>{const ie=new ms;ie.setFontSize(18),ie.text(ve.name||"Report",14,22),ie.setFontSize(10),ie.text(`Generated: ${new Date().toLocaleString()}`,14,30),ie.text(`Period: ${s}`,14,36),ie.save(`${ve.name||"report"}_${new Date().toISOString().split("T")[0]}.pdf`)},Pe=ve=>{const ie=`Report: ${ve.name}
Generated: ${new Date().toLocaleString()}
Period: ${s}

Data will be populated from API`,q=new Blob([ie],{type:"text/csv"}),pe=document.createElement("a");pe.href=URL.createObjectURL(q),pe.download=`${ve.name||"report"}_${new Date().toISOString().split("T")[0]}.csv`,pe.click()},we=ve=>{const ie=window.open("","_blank");ie.document.write(`
      <html><head><title>${ve.name}</title>
      <style>body { font-family: Arial, sans-serif; padding: 20px; } h1 { color: #333; } .meta { color: #666; margin-bottom: 20px; }</style>
      </head><body>
      <h1>${ve.name}</h1>
      <div class="meta">Generated: ${new Date().toLocaleString()}<br>Period: ${s}</div>
      <p>Report content will be populated from the system.</p>
      </body></html>
    `),ie.document.close(),ie.print()},fe=ve=>{const ie={blue:"bg-blue-100 text-blue-700 border-blue-200",green:"bg-green-100 text-green-700 border-green-200",purple:"bg-purple-100 text-purple-700 border-purple-200",orange:"bg-orange-100 text-orange-700 border-orange-200",indigo:"bg-indigo-100 text-indigo-700 border-indigo-200",teal:"bg-teal-100 text-teal-700 border-teal-200",pink:"bg-pink-100 text-pink-700 border-pink-200",red:"bg-red-100 text-red-700 border-red-200"};return ie[ve]||ie.blue},ye=B.filter(ve=>r==="all"||ve.id===r).map(ve=>({...ve,reports:ve.reports.filter(ie=>!m||ie.name.toLowerCase().includes(m.toLowerCase())||ie.description.toLowerCase().includes(m.toLowerCase()))})).filter(ve=>ve.reports.length>0),Ke=B.flatMap(ve=>ve.reports).filter(ve=>D.includes(ve.id));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Fs,{className:"w-7 h-7 text-blue-600"})," Reports & Analytics"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Generate, schedule, and share comprehensive reports"})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs("button",{onClick:()=>T(!0),className:"btn bg-purple-100 text-purple-700 hover:bg-purple-200 flex items-center gap-2",children:[e.jsx(Wt,{className:"w-4 h-4"})," Schedule"]}),e.jsxs("button",{onClick:()=>C(!0),className:"btn bg-green-100 text-green-700 hover:bg-green-200 flex items-center gap-2",children:[e.jsx(Br,{className:"w-4 h-4"})," Templates"]}),e.jsxs("button",{onClick:()=>{oe(),ne()},className:"btn bg-gray-100 hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ns,{className:"w-4 h-4"})," Refresh"]})]})]}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx(Ws,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search reports...",value:m,onChange:ve=>u(ve.target.value),className:"input pl-10"})]}),e.jsxs("select",{value:s,onChange:ve=>{a(ve.target.value),ve.target.value==="custom"&&y(!0)},className:"input w-40",children:[e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"this_week",children:"This Week"}),e.jsx("option",{value:"this_month",children:"This Month"}),e.jsx("option",{value:"this_term",children:"This Term"}),e.jsx("option",{value:"this_year",children:"This Year"}),e.jsx("option",{value:"custom",children:"Custom Range"})]}),s==="custom"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"date",value:x,onChange:ve=>A(ve.target.value),className:"input w-36"}),e.jsx("span",{className:"text-gray-500",children:"to"}),e.jsx("input",{type:"date",value:g,onChange:ve=>N(ve.target.value),className:"input w-36"})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:[e.jsx(Rt,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Total Students"}),e.jsx("p",{className:"text-2xl font-bold",children:z.students.toLocaleString()})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-green-500 to-green-600 text-white",children:[e.jsx(vs,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Revenue"}),e.jsxs("p",{className:"text-2xl font-bold",children:["GHS ",z.revenue.toLocaleString()]})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-purple-500 to-purple-600 text-white",children:[e.jsx(Qs,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Attendance Rate"}),e.jsxs("p",{className:"text-2xl font-bold",children:[z.attendance,"%"]})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-orange-500 to-orange-600 text-white",children:[e.jsx(Kt,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Outstanding"}),e.jsxs("p",{className:"text-2xl font-bold",children:["GHS ",z.outstanding.toLocaleString()]})]})]}),e.jsxs("div",{className:"flex gap-1 flex-wrap bg-gray-100 p-1 rounded-lg overflow-x-auto",children:[e.jsx("button",{onClick:()=>l("all"),className:`px-3 py-2 rounded-md font-medium text-sm whitespace-nowrap ${r==="all"?"bg-white shadow":"hover:bg-gray-200"}`,children:"All Reports"}),e.jsxs("button",{onClick:()=>l("favorites"),className:`px-3 py-2 rounded-md font-medium text-sm whitespace-nowrap flex items-center gap-1 ${r==="favorites"?"bg-white shadow":"hover:bg-gray-200"}`,children:[e.jsx(sl,{className:"w-4 h-4"})," Favorites (",D.length,")"]}),e.jsxs("button",{onClick:()=>l("scheduled"),className:`px-3 py-2 rounded-md font-medium text-sm whitespace-nowrap flex items-center gap-1 ${r==="scheduled"?"bg-white shadow":"hover:bg-gray-200"}`,children:[e.jsx(Wt,{className:"w-4 h-4"})," Scheduled (",K.length,")"]}),e.jsxs("button",{onClick:()=>l("history"),className:`px-3 py-2 rounded-md font-medium text-sm whitespace-nowrap flex items-center gap-1 ${r==="history"?"bg-white shadow":"hover:bg-gray-200"}`,children:[e.jsx(Kt,{className:"w-4 h-4"})," History"]}),B.map(ve=>e.jsx("button",{onClick:()=>l(ve.id),className:`px-3 py-2 rounded-md font-medium text-sm whitespace-nowrap ${r===ve.id?"bg-white shadow":"hover:bg-gray-200"}`,children:ve.title.replace(" Reports","")},ve.id))]}),r==="favorites"&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(sl,{className:"w-5 h-5 text-yellow-500"})," Favorite Reports"]}),Ke.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(sl,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No favorite reports yet"}),e.jsx("p",{className:"text-sm",children:"Click the star icon on any report to add it to favorites"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Ke.map(ve=>e.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"font-medium",children:ve.name}),e.jsx("button",{onClick:()=>Fe(ve.id),className:"text-yellow-500",children:e.jsx(sl,{className:"w-5 h-5 fill-current"})})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:ve.description}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(dn,{to:ve.link,className:"btn btn-primary text-sm flex-1",children:"View"}),e.jsx("button",{onClick:()=>le(ve),className:"btn bg-gray-100 hover:bg-gray-200 text-sm",children:e.jsx(xs,{className:"w-4 h-4"})})]})]},ve.id))})]}),r==="scheduled"&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Wt,{className:"w-5 h-5 text-purple-600"})," Scheduled Reports"]}),e.jsxs("button",{onClick:()=>T(!0),className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4"})," New Schedule"]})]}),K.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Wt,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No scheduled reports"})]}):e.jsx("div",{className:"space-y-3",children:K.map(ve=>e.jsx("div",{className:"border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${ve.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:ve.status}),e.jsx("span",{className:"font-medium",children:ve.report_type})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Frequency: ",ve.frequency,"  Time: ",ve.time,"  Format: ",ve.format?.toUpperCase()]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Recipients: ",ve.recipients||"None specified"]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>ze(ve.id),className:`p-2 rounded ${ve.status==="active"?"text-yellow-600 hover:bg-yellow-50":"text-green-600 hover:bg-green-50"}`,children:ve.status==="active"?e.jsx(fg,{className:"w-4 h-4"}):e.jsx(Qi,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Ge(ve.id),className:"p-2 text-red-600 hover:bg-red-50 rounded",children:e.jsx(us,{className:"w-4 h-4"})})]})]})},ve.id))})]}),r==="history"&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Kt,{className:"w-5 h-5 text-gray-600"})," Report History"]}),v.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Kt,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No reports generated yet"})]}):e.jsx("div",{className:"space-y-3",children:v.map(ve=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Kt,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:ve.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[ve.date,"  ",ve.size]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{ge(ve),E(!0)},className:"btn bg-gray-100 hover:bg-gray-200 text-sm",children:e.jsx($o,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{ge(ve),V(!0)},className:"btn bg-gray-100 hover:bg-gray-200 text-sm",children:e.jsx(ra,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>we(ve),className:"btn bg-gray-100 hover:bg-gray-200 text-sm",children:e.jsx(or,{className:"w-4 h-4"})}),e.jsxs("button",{onClick:()=>le(ve),className:"btn bg-blue-100 text-blue-700 hover:bg-blue-200 text-sm flex items-center gap-1",children:[e.jsx(xs,{className:"w-4 h-4"})," PDF"]}),e.jsxs("button",{onClick:()=>Pe(ve),className:"btn bg-green-100 text-green-700 hover:bg-green-200 text-sm flex items-center gap-1",children:[e.jsx(qo,{className:"w-4 h-4"})," Excel"]})]})]},ve.id))})]}),(r==="all"||B.some(ve=>ve.id===r))&&ye.map(ve=>{const ie=ve.icon;return e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${fe(ve.color)}`,children:e.jsx(ie,{className:"w-6 h-6"})}),e.jsx("h2",{className:"text-xl font-semibold",children:ve.title})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:ve.reports.map(q=>e.jsxs("div",{className:"p-4 border-2 border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors group",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"font-medium group-hover:text-blue-600",children:q.name}),e.jsx("button",{onClick:()=>Fe(q.id),className:`${D.includes(q.id)?"text-yellow-500":"text-gray-300 hover:text-yellow-500"}`,children:e.jsx(sl,{className:`w-5 h-5 ${D.includes(q.id)?"fill-current":""}`})})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:q.description}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(dn,{to:q.link,className:"btn btn-primary text-sm flex-1 flex items-center justify-center gap-1",children:[e.jsx(na,{className:"w-4 h-4"})," View"]}),e.jsx("button",{onClick:()=>le(q),className:"btn bg-gray-100 hover:bg-gray-200 text-sm",title:"Export PDF",children:e.jsx(xs,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{ge(q),E(!0)},className:"btn bg-gray-100 hover:bg-gray-200 text-sm",title:"Share",children:e.jsx($o,{className:"w-4 h-4"})})]})]},q.id))})]},ve.id)}),j&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Wt,{className:"w-5 h-5 text-purple-600"})," Schedule Report"]}),e.jsx("button",{onClick:()=>T(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:je,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Report Type *"}),e.jsxs("select",{value:xe.report_type,onChange:ve=>Z({...xe,report_type:ve.target.value}),className:"input",required:!0,children:[e.jsx("option",{value:"",children:"Select report"}),B.flatMap(ve=>ve.reports).map(ve=>e.jsx("option",{value:ve.id,children:ve.name},ve.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Frequency"}),e.jsxs("select",{value:xe.frequency,onChange:ve=>Z({...xe,frequency:ve.target.value}),className:"input",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})]}),xe.frequency==="weekly"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Day"}),e.jsxs("select",{value:xe.day_of_week,onChange:ve=>Z({...xe,day_of_week:ve.target.value}),className:"input",children:[e.jsx("option",{value:"monday",children:"Monday"}),e.jsx("option",{value:"tuesday",children:"Tuesday"}),e.jsx("option",{value:"wednesday",children:"Wednesday"}),e.jsx("option",{value:"thursday",children:"Thursday"}),e.jsx("option",{value:"friday",children:"Friday"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Time"}),e.jsx("input",{type:"time",value:xe.time,onChange:ve=>Z({...xe,time:ve.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Format"}),e.jsxs("select",{value:xe.format,onChange:ve=>Z({...xe,format:ve.target.value}),className:"input",children:[e.jsx("option",{value:"pdf",children:"PDF"}),e.jsx("option",{value:"excel",children:"Excel"}),e.jsx("option",{value:"both",children:"Both"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Email Recipients"}),e.jsx("input",{type:"text",value:xe.recipients,onChange:ve=>Z({...xe,recipients:ve.target.value}),className:"input",placeholder:"email1@example.com, email2@example.com"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>T(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Schedule"})]})]})]})}),te&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Br,{className:"w-5 h-5 text-green-600"})," Report Templates"]}),e.jsx("button",{onClick:()=>C(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{className:"w-5 h-5"})})]}),P.length>0&&e.jsxs("div",{className:"mb-4 border-b pb-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Saved Templates"}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:P.map(ve=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsx("span",{className:"text-sm",children:ve.name}),e.jsx("button",{onClick:()=>st(ve.id),className:"text-red-600 hover:bg-red-50 p-1 rounded",children:e.jsx(us,{className:"w-4 h-4"})})]},ve.id))})]}),e.jsxs("form",{onSubmit:Xe,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Template Name *"}),e.jsx("input",{type:"text",value:I.name,onChange:ve=>H({...I,name:ve.target.value}),className:"input",placeholder:"e.g., Monthly Finance Summary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Report Type"}),e.jsxs("select",{value:I.report_type,onChange:ve=>H({...I,report_type:ve.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select report"}),B.flatMap(ve=>ve.reports).map(ve=>e.jsx("option",{value:ve.id,children:ve.name},ve.id))]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>C(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:"Close"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save Template"})]})]})]})}),Q&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx($o,{className:"w-5 h-5 text-blue-600"})," Share Report"]}),e.jsx("button",{onClick:()=>E(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{className:"w-5 h-5"})})]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:['Share "',re?.name,'" with others']}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:ce,className:"w-full btn bg-blue-100 text-blue-700 hover:bg-blue-200 flex items-center justify-center gap-2",children:[e.jsx(Qh,{className:"w-4 h-4"})," Copy Share Link"]}),e.jsxs("button",{onClick:()=>{E(!1),V(!0)},className:"w-full btn bg-green-100 text-green-700 hover:bg-green-200 flex items-center justify-center gap-2",children:[e.jsx(ra,{className:"w-4 h-4"})," Email Report"]})]})]})}),O&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(ra,{className:"w-5 h-5 text-green-600"})," Email Report"]}),e.jsx("button",{onClick:()=>V(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:_e,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Recipients *"}),e.jsx("input",{type:"text",value:ae.recipients,onChange:ve=>k({...ae,recipients:ve.target.value}),className:"input",placeholder:"email1@example.com, email2@example.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Subject"}),e.jsx("input",{type:"text",value:ae.subject,onChange:ve=>k({...ae,subject:ve.target.value}),className:"input",placeholder:`Report: ${re?.name}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Message"}),e.jsx("textarea",{value:ae.message,onChange:ve=>k({...ae,message:ve.target.value}),className:"input",rows:"3",placeholder:"Optional message..."})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:ae.attach_pdf,onChange:ve=>k({...ae,attach_pdf:ve.target.checked}),className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Attach PDF"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>V(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-primary flex items-center gap-2",children:[e.jsx(ra,{className:"w-4 h-4"})," Send"]})]})]})]})})]})}function xT(){const[t,s]=h.useState("class_performance"),[a,r]=h.useState(null),[l,c]=h.useState(!1),[o,m]=h.useState({date_from:new Date().toISOString().split("T")[0].slice(0,8)+"01",date_to:new Date().toISOString().split("T")[0]});h.useEffect(()=>{u()},[t]);const u=async()=>{try{c(!0);const g=new URLSearchParams({type:t,...o}),N=await F.get(`https://eea.mcaforo.com/backend/api/reports.php?${g}`);r(N.data.data)}catch(g){console.error("Error fetching report:",g)}finally{c(!1)}},x=g=>{alert(`Exporting as ${g}...`)},A=[{id:"class_performance",label:"Class Performance",icon:Is},{id:"attendance_summary",label:"Attendance Summary",icon:Rt},{id:"academic_performance",label:"Student Performance",icon:$s}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Academic Reports"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"View and analyze academic performance"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>x("pdf"),className:"btn bg-gray-200 flex items-center gap-2",children:[e.jsx(xs,{className:"w-4 h-4"}),"Export PDF"]}),e.jsxs("button",{onClick:()=>x("excel"),className:"btn btn-primary flex items-center gap-2",children:[e.jsx(xs,{className:"w-4 h-4"}),"Export Excel"]})]})]}),e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"flex gap-4 border-b pb-4 mb-4",children:A.map(g=>{const N=g.icon;return e.jsxs("button",{onClick:()=>s(g.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${t===g.id?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(N,{className:"w-4 h-4"}),g.label]},g.id)})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"From Date"}),e.jsx("input",{type:"date",value:o.date_from,onChange:g=>m({...o,date_from:g.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"To Date"}),e.jsx("input",{type:"date",value:o.date_to,onChange:g=>m({...o,date_to:g.target.value}),className:"input"})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{onClick:u,className:"btn btn-primary w-full flex items-center justify-center gap-2",children:[e.jsx(Ko,{className:"w-4 h-4"}),"Apply Filters"]})})]})]}),l?e.jsxs("div",{className:"card p-12 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading report..."})]}):a?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:a.report_title}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Generated on ",new Date(a.generated_at).toLocaleString()]})]}),t==="class_performance"&&a.classes&&e.jsx("div",{className:"card overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Class"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Level"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Students"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Teacher"})]})}),e.jsx("tbody",{className:"divide-y",children:a.classes.map((g,N)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 font-medium text-gray-900",children:g.class_name}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-700",children:g.level.toUpperCase()})}),e.jsx("td",{className:"px-6 py-4 text-gray-600",children:g.student_count}),e.jsx("td",{className:"px-6 py-4 text-gray-600",children:g.teacher_name||"-"})]},N))})]})}),t==="attendance_summary"&&a.summary&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Overall Attendance Rate"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-4xl font-bold text-green-600",children:[a.overall_rate,"%"]}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4",children:e.jsx("div",{className:"bg-green-600 h-4 rounded-full",style:{width:`${a.overall_rate}%`}})})})]})]}),e.jsx("div",{className:"card overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Class"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Level"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total Students"})]})}),e.jsx("tbody",{className:"divide-y",children:a.summary.map((g,N)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 font-medium text-gray-900",children:g.class_name}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-purple-100 text-purple-700",children:g.level.toUpperCase()})}),e.jsx("td",{className:"px-6 py-4 text-gray-600",children:g.total_students})]},N))})]})})]})]}):e.jsx("div",{className:"card p-12 text-center text-gray-500",children:"Select a report and apply filters to view data"})]})}function hT(){const[t,s]=h.useState("revenue_report"),[a,r]=h.useState(null),[l,c]=h.useState(!1),[o,m]=h.useState({date_from:new Date().toISOString().split("T")[0].slice(0,8)+"01",date_to:new Date().toISOString().split("T")[0]});h.useEffect(()=>{u()},[t]);const u=async()=>{try{c(!0);const N=new URLSearchParams({type:t,...o}),f=await F.get(`https://eea.mcaforo.com/backend/api/reports.php?${N}`);r(f.data.data)}catch(N){console.error("Error fetching report:",N)}finally{c(!1)}},x=N=>new Intl.NumberFormat("en-GH",{style:"currency",currency:"GHS"}).format(N||0),A=N=>{alert(`Exporting as ${N}...`)},g=[{id:"revenue_report",label:"Revenue Report",icon:vs},{id:"outstanding_fees",label:"Outstanding Fees",icon:Wt},{id:"payment_history",label:"Payment History",icon:$s},{id:"collection_rate",label:"Collection Rate",icon:ka}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Financial Reports"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive financial analysis and reporting"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>A("pdf"),className:"btn bg-gray-200 flex items-center gap-2",children:[e.jsx(xs,{className:"w-4 h-4"}),"Export PDF"]}),e.jsxs("button",{onClick:()=>A("excel"),className:"btn btn-primary flex items-center gap-2",children:[e.jsx(xs,{className:"w-4 h-4"}),"Export Excel"]})]})]}),e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"flex gap-4 border-b pb-4 mb-4 overflow-x-auto",children:g.map(N=>{const f=N.icon;return e.jsxs("button",{onClick:()=>s(N.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors whitespace-nowrap ${t===N.id?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(f,{className:"w-4 h-4"}),N.label]},N.id)})}),t!=="collection_rate"&&e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"From Date"}),e.jsx("input",{type:"date",value:o.date_from,onChange:N=>m({...o,date_from:N.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"To Date"}),e.jsx("input",{type:"date",value:o.date_to,onChange:N=>m({...o,date_to:N.target.value}),className:"input"})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{onClick:u,className:"btn btn-primary w-full flex items-center justify-center gap-2",children:[e.jsx(Ko,{className:"w-4 h-4"}),"Apply Filters"]})})]})]}),l?e.jsxs("div",{className:"card p-12 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading report..."})]}):a?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:a.report_title}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Generated on ",new Date(a.generated_at).toLocaleString()]}),a.period&&e.jsxs("p",{className:"text-sm text-gray-600",children:["Period: ",new Date(a.period.from).toLocaleDateString()," - ",new Date(a.period.to).toLocaleDateString()]})]}),t==="revenue_report"&&a.totals&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(vs,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Invoiced"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:x(a.totals.total_invoiced)})]})]})}),e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx($s,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Collected"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:x(a.totals.total_collected)})]})]})}),e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(Wt,{className:"w-6 h-6 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Outstanding"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:x(a.totals.total_outstanding)})]})]})}),e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(ka,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Invoices"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.totals.total_invoices})]})]})})]}),a.daily_breakdown&&a.daily_breakdown.length>0&&e.jsxs("div",{className:"card overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsx("h3",{className:"text-lg font-semibold",children:"Daily Breakdown"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Invoices"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Invoiced"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Collected"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Outstanding"})]})}),e.jsx("tbody",{className:"divide-y",children:a.daily_breakdown.map((N,f)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 font-medium text-gray-900",children:new Date(N.date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 text-gray-600",children:N.invoice_count}),e.jsx("td",{className:"px-6 py-4 text-gray-900 font-medium",children:x(N.total_invoiced)}),e.jsx("td",{className:"px-6 py-4 text-green-600 font-medium",children:x(N.total_collected)}),e.jsx("td",{className:"px-6 py-4 text-orange-600 font-medium",children:x(N.total_outstanding)})]},f))})]})})]})]}),t==="outstanding_fees"&&a.summary&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"card p-6",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Total Outstanding"}),e.jsx("p",{className:"text-3xl font-bold text-orange-600",children:x(a.summary.total_outstanding)})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Overdue Amount"}),e.jsx("p",{className:"text-3xl font-bold text-red-600",children:x(a.summary.overdue_amount)})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Total Invoices"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:a.summary.total_invoices})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Overdue Invoices"}),e.jsx("p",{className:"text-3xl font-bold text-red-600",children:a.summary.overdue_count})]})]}),a.invoices&&a.invoices.length>0&&e.jsxs("div",{className:"card overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsx("h3",{className:"text-lg font-semibold",children:"Outstanding Invoices"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Invoice #"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Student"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Class"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Paid"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Balance"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Due Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y",children:a.invoices.map((N,f)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 font-mono text-sm text-gray-900",children:N.invoice_number}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:N.student_name}),e.jsx("div",{className:"text-xs text-gray-500",children:N.student_id})]}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:N.class_name}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:x(N.total_amount)}),e.jsx("td",{className:"px-6 py-4 text-sm text-green-600",children:x(N.paid_amount)}),e.jsx("td",{className:"px-6 py-4 text-sm font-medium text-orange-600",children:x(N.balance)}),e.jsxs("td",{className:"px-6 py-4 text-sm text-gray-600",children:[new Date(N.due_date).toLocaleDateString(),N.days_overdue>0&&e.jsxs("span",{className:"ml-2 text-xs text-red-600",children:["(",N.days_overdue," days overdue)"]})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${N.days_overdue>0?"bg-red-100 text-red-700":"bg-orange-100 text-orange-700"}`,children:N.days_overdue>0?"Overdue":N.status})})]},f))})]})})]})]}),t==="payment_history"&&a.payments&&e.jsxs("div",{className:"space-y-6",children:[a.by_method&&a.by_method.length>0&&e.jsx("div",{className:"grid grid-cols-4 gap-4",children:a.by_method.map((N,f)=>e.jsxs("div",{className:"card p-6",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:N.payment_method||"Unknown"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:x(N.total_amount)}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[N.count," payments"]})]},f))}),e.jsxs("div",{className:"card overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsx("h3",{className:"text-lg font-semibold",children:"Payment Transactions"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Invoice #"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Student"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Class"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Method"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Reference"})]})}),e.jsx("tbody",{className:"divide-y",children:a.payments.map((N,f)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:new Date(N.payment_date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 font-mono text-sm text-gray-600",children:N.invoice_number}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:N.student_name}),e.jsx("div",{className:"text-xs text-gray-500",children:N.student_id})]}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:N.class_name}),e.jsx("td",{className:"px-6 py-4 text-sm font-medium text-green-600",children:x(N.amount)}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-700",children:N.payment_method})}),e.jsx("td",{className:"px-6 py-4 font-mono text-xs text-gray-500",children:N.reference_number||"-"})]},f))})]})})]})]}),t==="collection_rate"&&a.summary&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card p-8 text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-600 mb-4",children:"Overall Collection Rate"}),e.jsxs("div",{className:"text-6xl font-bold text-blue-600 mb-4",children:[a.summary.collection_rate.toFixed(1),"%"]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-6 mb-4",children:e.jsx("div",{className:"bg-blue-600 h-6 rounded-full transition-all duration-500",style:{width:`${a.summary.collection_rate}%`}})}),e.jsxs("p",{className:"text-gray-600",children:[x(a.summary.total_collected)," collected out of ",x(a.summary.total_invoiced)," invoiced"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"card p-6",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Fully Paid Invoices"}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:a.summary.paid_invoices}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"100% collected"})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Partially Paid"}),e.jsx("p",{className:"text-3xl font-bold text-orange-600",children:a.summary.partial_invoices}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Partial payment"})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Total Invoices"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:a.summary.total_invoices}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"All invoices"})]})]})]})]}):e.jsx("div",{className:"card p-12 text-center text-gray-500",children:"Select a report and apply filters to view data"})]})}function pT(){const[t,s]=h.useState(!1),[a,r]=h.useState([]),[l,c]=h.useState([]),[o,m]=h.useState("all"),[u,x]=h.useState("all"),[A,g]=h.useState("all"),[N,f]=h.useState(""),[y,v]=h.useState("summary"),[U,D]=h.useState({demographics:!0,enrollment:!0,distribution:!0});h.useEffect(()=>{M()},[]);const M=async()=>{try{s(!0);const O=await F.get("https://eea.mcaforo.com/backend/api/students.php");r(O.data.students||[]);const V=await F.get("https://eea.mcaforo.com/backend/api/classes.php");c(V.data.classes||[])}catch(O){console.error("Error fetching data:",O)}finally{s(!1)}},K=a.filter(O=>{const V=o==="all"||O.class_id==o,re=u==="all"||O.status===u,ge=A==="all"||O.gender?.toLowerCase()===A,xe=N===""||O.first_name?.toLowerCase().includes(N.toLowerCase())||O.last_name?.toLowerCase().includes(N.toLowerCase())||O.student_id?.toLowerCase().includes(N.toLowerCase());return V&&re&&ge&&xe}),$=K.length,P=K.filter(O=>O.status==="active").length;K.filter(O=>O.status==="inactive").length;const se=K.filter(O=>O.gender?.toLowerCase()==="male").length,z=K.filter(O=>O.gender?.toLowerCase()==="female").length,R=O=>{if(!O)return null;const V=new Date,re=new Date(O);let ge=V.getFullYear()-re.getFullYear();const xe=V.getMonth()-re.getMonth();return(xe<0||xe===0&&V.getDate()<re.getDate())&&ge--,ge},j={"0-5":0,"6-10":0,"11-15":0,"16+":0};K.forEach(O=>{const V=R(O.date_of_birth);V!==null&&(V<=5?j["0-5"]++:V<=10?j["6-10"]++:V<=15?j["11-15"]++:j["16+"]++)});const T={};K.forEach(O=>{const V=l.find(re=>re.id==O.class_id)?.class_name||"Unassigned";T[V]=(T[V]||0)+1});const Q={};K.forEach(O=>{const V=O.region||"Unknown";Q[V]=(Q[V]||0)+1});const E=()=>{window.print()},te=()=>{const O=["Student ID","Name","Gender","Date of Birth","Class","Status","Region"],V=K.map(I=>[I.student_id,`${I.first_name} ${I.last_name}`,I.gender,I.date_of_birth,l.find(H=>H.id==I.class_id)?.class_name||"N/A",I.status,I.region||"N/A"]),re=[O.join(","),...V.map(I=>I.join(","))].join(`
`),ge=new Blob([re],{type:"text/csv"}),xe=window.URL.createObjectURL(ge),Z=document.createElement("a");Z.href=xe,Z.download=`student-report-${new Date().toISOString().split("T")[0]}.csv`,Z.click()},C=O=>{D(V=>({...V,[O]:!V[O]}))};return t?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between print:hidden",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Reports"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive student enrollment and demographics"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:E,className:"btn bg-gray-600 hover:bg-gray-700 text-white",children:[e.jsx(or,{className:"w-4 h-4"}),"Print"]}),e.jsxs("button",{onClick:te,className:"btn bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(xs,{className:"w-4 h-4"}),"Export CSV"]})]})]}),e.jsxs("div",{className:"card p-6 print:hidden",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Ko,{className:"w-5 h-5 text-gray-600"}),e.jsx("h2",{className:"text-lg font-semibold",children:"Filters"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Class"}),e.jsxs("select",{value:o,onChange:O=>m(O.target.value),className:"input",children:[e.jsx("option",{value:"all",children:"All Classes"}),l.map(O=>e.jsx("option",{value:O.id,children:O.class_name},O.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:u,onChange:O=>x(O.target.value),className:"input",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"graduated",children:"Graduated"}),e.jsx("option",{value:"transferred",children:"Transferred"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gender"}),e.jsxs("select",{value:A,onChange:O=>g(O.target.value),className:"input",children:[e.jsx("option",{value:"all",children:"All Genders"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",value:N,onChange:O=>f(O.target.value),placeholder:"Search students...",className:"input pl-10"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Rt,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Students"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:$})]})]})}),e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(Or,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Active"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:P})]})]})}),e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(Rt,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Male"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:se})]})]})}),e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 bg-pink-100 rounded-lg flex items-center justify-center",children:e.jsx(Rt,{className:"w-6 h-6 text-pink-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Female"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:z})]})]})})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("button",{onClick:()=>C("demographics"),className:"w-full flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Gl,{className:"w-5 h-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold",children:"Demographics"})]}),U.demographics?e.jsx(jl,{className:"w-5 h-5"}):e.jsx(un,{className:"w-5 h-5"})]}),U.demographics&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-3",children:"Gender Distribution"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"Male"}),e.jsxs("span",{className:"font-medium",children:[se," (",$>0?(se/$*100).toFixed(1):0,"%)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"bg-blue-600 h-3 rounded-full",style:{width:`${$>0?se/$*100:0}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"Female"}),e.jsxs("span",{className:"font-medium",children:[z," (",$>0?(z/$*100).toFixed(1):0,"%)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"bg-pink-600 h-3 rounded-full",style:{width:`${$>0?z/$*100:0}%`}})})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-3",children:"Age Distribution"}),e.jsx("div",{className:"space-y-3",children:Object.entries(j).map(([O,V])=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsxs("span",{children:[O," years"]}),e.jsxs("span",{className:"font-medium",children:[V," (",$>0?(V/$*100).toFixed(1):0,"%)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"bg-purple-600 h-3 rounded-full",style:{width:`${$>0?V/$*100:0}%`}})})]},O))})]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("button",{onClick:()=>C("distribution"),className:"w-full flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fs,{className:"w-5 h-5 text-green-600"}),e.jsx("h2",{className:"text-lg font-semibold",children:"Class Distribution"})]}),U.distribution?e.jsx(jl,{className:"w-5 h-5"}):e.jsx(un,{className:"w-5 h-5"})]}),U.distribution&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Class"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Students"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Percentage"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Distribution"})]})}),e.jsx("tbody",{className:"divide-y",children:Object.entries(T).map(([O,V])=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:O}),e.jsx("td",{className:"px-4 py-3",children:V}),e.jsxs("td",{className:"px-4 py-3",children:[$>0?(V/$*100).toFixed(1):0,"%"]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${$>0?V/$*100:0}%`}})})})]},O))})]})})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("button",{onClick:()=>C("enrollment"),className:"w-full flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qn,{className:"w-5 h-5 text-orange-600"}),e.jsx("h2",{className:"text-lg font-semibold",children:"Regional Distribution"})]}),U.enrollment?e.jsx(jl,{className:"w-5 h-5"}):e.jsx(un,{className:"w-5 h-5"})]}),U.enrollment&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(Q).map(([O,V])=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium",children:O}),e.jsx("span",{className:"text-2xl font-bold text-blue-600",children:V})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-orange-600 h-2 rounded-full",style:{width:`${$>0?V/$*100:0}%`}})}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[$>0?(V/$*100).toFixed(1):0,"% of total"]})]},O))})]}),e.jsxs("div",{className:"card p-6 print:break-before-page",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4",children:["Student List (",K.length,")"]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Student ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Gender"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Class"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Region"})]})}),e.jsx("tbody",{className:"divide-y",children:K.slice(0,50).map(O=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 font-mono text-sm",children:O.student_id}),e.jsxs("td",{className:"px-4 py-3",children:[O.first_name," ",O.last_name]}),e.jsx("td",{className:"px-4 py-3 capitalize",children:O.gender}),e.jsx("td",{className:"px-4 py-3",children:l.find(V=>V.id==O.class_id)?.class_name||"N/A"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${O.status==="active"?"bg-green-100 text-green-700":O.status==="inactive"?"bg-gray-100 text-gray-700":"bg-blue-100 text-blue-700"}`,children:O.status})}),e.jsx("td",{className:"px-4 py-3",children:O.region||"N/A"})]},O.id))})]}),K.length>50&&e.jsxs("p",{className:"text-center text-gray-500 mt-4",children:["Showing 50 of ",K.length," students. Export to CSV to see all."]})]})]})]})}function AT(){const[t,s]=h.useState(!1),[a,r]=h.useState("this_month"),[l,c]=h.useState({students:[],classes:[],teachers:[],invoices:[],homework:[],assessments:[]});h.useEffect(()=>{o()},[]);const o=async()=>{try{s(!0);const[E,te,C,O,V,re]=await Promise.all([F.get("https://eea.mcaforo.com/backend/api/students.php"),F.get("https://eea.mcaforo.com/backend/api/classes.php"),F.get("https://eea.mcaforo.com/backend/api/teachers.php"),F.get("https://eea.mcaforo.com/backend/api/finance.php?resource=invoices"),F.get("https://eea.mcaforo.com/backend/api/academic.php?resource=homework"),F.get("https://eea.mcaforo.com/backend/api/academic.php?resource=assessments")]);c({students:E.data.students||[],classes:te.data.classes||[],teachers:C.data.teachers||[],invoices:O.data.invoices||[],homework:V.data.homework||[],assessments:re.data.assessments||[]})}catch(E){console.error("Error fetching dashboard data:",E)}finally{s(!1)}},m=l.students.length,u=l.students.filter(E=>E.status==="active").length,x=l.classes.length,A=l.teachers.length,g=l.invoices.filter(E=>E.status==="paid").reduce((E,te)=>E+parseFloat(te.total_amount||0),0),N=l.invoices.filter(E=>E.status==="approved"||E.status==="pending_payment").reduce((E,te)=>E+parseFloat(te.balance||0),0),f=g>0&&N>0?(g/(g+N)*100).toFixed(1):g>0?100:0;l.homework.length;const y=l.homework.filter(E=>E.status==="active").length,v=l.assessments.length,U=l.attendanceStats?.rate||(l.attendance?.present&&l.attendance?.total?(l.attendance.present/l.attendance.total*100).toFixed(1):0),D=l.previousStats?.students||m,M=D>0?((m-D)/D*100).toFixed(1):0,K=l.previousStats?.revenue||g,$=K>0?((g-K)/K*100).toFixed(1):0,P=l.previousStats?.attendance||U,se=(U-P).toFixed(1),z=l.classes.slice(0,5).map(E=>{const te=l.students.filter(V=>V.class_id==E.id),C=l.grades?.filter(V=>te.some(re=>re.id==V.student_id))||[],O=C.length>0?C.reduce((V,re)=>V+(re.score||0),0)/C.length:0;return{name:E.class_name,students:te.length,capacity:E.capacity||30,performance:Math.round(O)||0}}),R=new Date().toLocaleString("default",{month:"short"}),j=l.monthlyTrends||[{month:R,students:m,revenue:g,attendance:U}],T=()=>{window.print()},Q=()=>{alert("PDF download functionality will be implemented")};return t?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between print:hidden",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Executive Dashboard Report"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive overview of school performance"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:a,onChange:E=>r(E.target.value),className:"input",children:[e.jsx("option",{value:"this_week",children:"This Week"}),e.jsx("option",{value:"this_month",children:"This Month"}),e.jsx("option",{value:"this_term",children:"This Term"}),e.jsx("option",{value:"this_year",children:"This Year"})]}),e.jsxs("button",{onClick:T,className:"btn bg-gray-600 hover:bg-gray-700 text-white",children:[e.jsx(or,{className:"w-4 h-4"}),"Print"]}),e.jsxs("button",{onClick:Q,className:"btn bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(xs,{className:"w-4 h-4"}),"Download PDF"]})]})]}),e.jsxs("div",{className:"hidden print:block text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Executive Dashboard Report"}),e.jsxs("p",{className:"text-gray-600 mt-2",children:["Generated on ",new Date().toLocaleDateString()]}),e.jsxs("p",{className:"text-gray-600",children:["Period: ",a.replace("_"," ").toUpperCase()]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Rt,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("span",{className:`text-sm font-medium ${M>=0?"text-green-600":"text-red-600"}`,children:[M>=0?"+":"",M,"%"]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Total Students"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-1",children:m}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[u," active"]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(vs,{className:"w-6 h-6 text-green-600"})}),e.jsxs("span",{className:`text-sm font-medium ${$>=0?"text-green-600":"text-red-600"}`,children:[$>=0?"+":"",$,"%"]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Total Revenue"}),e.jsxs("p",{className:"text-3xl font-bold text-gray-900 mt-1",children:["",(g/1e3).toFixed(1),"K"]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Collection rate: ",f,"%"]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(Ot,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("span",{className:`text-sm font-medium ${se>=0?"text-green-600":"text-red-600"}`,children:[se>=0?"+":"",se,"%"]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Attendance Rate"}),e.jsxs("p",{className:"text-3xl font-bold text-gray-900 mt-1",children:[U,"%"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Above target"})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(Qs,{className:"w-6 h-6 text-orange-600"})}),e.jsxs("span",{className:"text-sm font-medium text-blue-600",children:[x," classes"]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Teaching Staff"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-1",children:A}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Student-teacher ratio: ",(m/A).toFixed(1),":1"]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($s,{className:"w-5 h-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold",children:"Enrollment & Revenue Trends"})]})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:j.map((E,te)=>e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:E.month}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Students"}),e.jsx("p",{className:"text-lg font-bold text-blue-600",children:E.students})]}),e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Revenue"}),e.jsxs("p",{className:"text-lg font-bold text-green-600",children:["",(E.revenue/1e3).toFixed(0),"K"]})]}),e.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Attendance"}),e.jsxs("p",{className:"text-lg font-bold text-purple-600",children:[E.attendance,"%"]})]})]})]},te))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(vs,{className:"w-5 h-5 text-green-600"}),e.jsx("h2",{className:"text-lg font-semibold",children:"Financial Summary"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 bg-green-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Revenue"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["",g.toLocaleString()]})]}),e.jsx(Mt,{className:"w-8 h-8 text-green-600"})]}),e.jsxs("div",{className:"flex justify-between items-center p-4 bg-orange-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pending Payments"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:["",N.toLocaleString()]})]}),e.jsx(Wt,{className:"w-8 h-8 text-orange-600"})]}),e.jsxs("div",{className:"flex justify-between items-center p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Collection Rate"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[f,"%"]})]}),e.jsx($s,{className:"w-8 h-8 text-blue-600"})]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Is,{className:"w-5 h-5 text-purple-600"}),e.jsx("h2",{className:"text-lg font-semibold",children:"Academic Summary"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 bg-purple-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Active Homework"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:y})]}),e.jsx(Kt,{className:"w-8 h-8 text-purple-600"})]}),e.jsxs("div",{className:"flex justify-between items-center p-4 bg-indigo-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Assessments"}),e.jsx("p",{className:"text-2xl font-bold text-indigo-600",children:v})]}),e.jsx(Is,{className:"w-8 h-8 text-indigo-600"})]}),e.jsxs("div",{className:"flex justify-between items-center p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Avg. Attendance"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[U,"%"]})]}),e.jsx(Ot,{className:"w-8 h-8 text-blue-600"})]})]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Fs,{className:"w-5 h-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold",children:"Class Performance Overview"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Class"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Students"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Capacity"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Utilization"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Performance"})]})}),e.jsx("tbody",{className:"divide-y",children:z.map((E,te)=>{const C=(E.students/E.capacity*100).toFixed(0);return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:E.name}),e.jsx("td",{className:"px-4 py-3",children:E.students}),e.jsx("td",{className:"px-4 py-3",children:E.capacity}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${C>90?"bg-red-600":C>75?"bg-orange-600":"bg-green-600"}`,style:{width:`${C}%`}})}),e.jsxs("span",{className:"text-sm",children:[C,"%"]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:`px-3 py-1 text-sm rounded-full ${E.performance>=85?"bg-green-100 text-green-700":E.performance>=75?"bg-blue-100 text-blue-700":"bg-orange-100 text-orange-700"}`,children:[E.performance,"%"]})})]},te)})})]})})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Ir,{className:"w-5 h-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold",children:"Key Insights & Recommendations"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"p-4 border-l-4 border-green-500 bg-green-50 rounded",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Mt,{className:"w-5 h-5 text-green-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-900",children:"Strong Enrollment Growth"}),e.jsxs("p",{className:"text-sm text-green-700 mt-1",children:["Student enrollment increased by ",M,"% this period, exceeding targets."]})]})]})}),e.jsx("div",{className:"p-4 border-l-4 border-green-500 bg-green-50 rounded",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Mt,{className:"w-5 h-5 text-green-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-900",children:"Revenue Growth"}),e.jsxs("p",{className:"text-sm text-green-700 mt-1",children:["Revenue increased by ",$,"% with a collection rate of ",f,"%."]})]})]})}),e.jsx("div",{className:"p-4 border-l-4 border-orange-500 bg-orange-50 rounded",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ka,{className:"w-5 h-5 text-orange-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-orange-900",children:"Class Capacity"}),e.jsx("p",{className:"text-sm text-orange-700 mt-1",children:"Some classes are near capacity. Consider adding sections for high-demand classes."})]})]})}),e.jsx("div",{className:"p-4 border-l-4 border-blue-500 bg-blue-50 rounded",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ir,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-900",children:"Attendance Performance"}),e.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:["Attendance rate of ",U,"% is above the 90% target. Maintain current strategies."]})]})]})})]})]}),e.jsx("div",{className:"card p-6 print:break-before-page",children:e.jsxs("div",{className:"text-center text-gray-600",children:[e.jsxs("p",{className:"text-sm",children:["Report generated on ",new Date().toLocaleString()]}),e.jsx("p",{className:"text-xs mt-2",children:"McSMS - School Management System v2.0"})]})})]})}const Rr=`${ee}/timetable.php`;function gT(){const[t,s]=h.useState([]),[a,r]=h.useState(null),[l,c]=h.useState([]),[o,m]=h.useState([]),[u,x]=h.useState([]),[A,g]=h.useState([]),[N,f]=h.useState([]),[y,v]=h.useState([]),[U,D]=h.useState([]),[M,K]=h.useState([]),[$,P]=h.useState([]),[se,z]=h.useState("timetable"),[R,j]=h.useState(null),[T,Q]=h.useState(null),[E,te]=h.useState("class"),[C,O]=h.useState(!0),[V,re]=h.useState(!1),[ge,xe]=h.useState("entry"),[Z,I]=h.useState(null),[H,ae]=h.useState({class_id:"",subject_id:"",teacher_id:"",day_of_week:"Monday",time_slot_id:"",room_number:"",notes:""}),[k,B]=h.useState({template_name:"",description:"",academic_year:new Date().getFullYear().toString(),term_id:"",status:"draft"}),[w,oe]=h.useState({slot_name:"",start_time:"08:00",end_time:"08:45",slot_order:1,is_break:!1,status:"active"}),[ne,Fe]=h.useState({room_number:"",room_name:"",room_type:"classroom",capacity:"",facilities:"",status:"available"}),[je,Ge]=h.useState({timetable_entry_id:"",original_teacher_id:"",substitute_teacher_id:"",substitution_date:"",reason:""}),ze=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Xe=["Monday","Tuesday","Wednesday","Thursday","Friday"];h.useEffect(()=>{Promise.all([st(),_e(),le(),fe(),ye(),Ke(),ve()]).then(()=>O(!1))},[]),h.useEffect(()=>{a&&(ce(),we())},[a,R,T,E]);const st=async()=>{try{const J=await F.get(`${Rr}?resource=templates`);s(J.data.templates||[]),J.data.templates?.length>0&&!a&&r(J.data.templates[0].id)}catch(J){console.error(J)}},ce=async()=>{try{let J=`${Rr}?resource=entries&action=by_template&template_id=${a}`;E==="class"&&R&&(J+=`&class_id=${R}`),E==="teacher"&&T&&(J=`${Rr}?resource=entries&action=by_teacher&teacher_id=${T}&template_id=${a}`);const Je=await F.get(J);c(Je.data.entries||[])}catch(J){console.error(J)}},_e=async()=>{try{const J=await F.get(`${Rr}?resource=time_slots`);m(J.data.time_slots||[])}catch(J){console.error(J)}},le=async()=>{try{const J=await F.get(`${Rr}?resource=rooms`);x(J.data.rooms||[])}catch(J){console.error(J)}},Pe=async(J=new Date().toISOString().split("T")[0])=>{try{const Je=await F.get(`${Rr}?resource=substitutions&date=${J}`);g(Je.data.substitutions||[])}catch(Je){console.error(Je)}},we=async()=>{try{const J=await F.get(`${Rr}?resource=conflicts&template_id=${a}`);f(J.data.conflicts||[])}catch(J){console.error(J)}},fe=async()=>{try{const J=await F.get(`${ee}/classes.php`);v(J.data.classes||[])}catch(J){console.error(J)}},ye=async()=>{try{const J=await F.get(`${ee}/subjects.php`);D(J.data.subjects||[])}catch(J){console.error(J)}},Ke=async()=>{try{const J=await F.get(`${ee}/teachers.php`);K(J.data.teachers||[])}catch(J){console.error(J)}},ve=async()=>{try{const J=await F.get(`${ee}/terms.php`);P(J.data.terms||[])}catch(J){console.error(J)}},ie=async J=>{J.preventDefault();try{Z?.id?await F.put(`${Rr}?resource=entries&id=${Z.id}`,H):await F.post(`${Rr}?resource=entries`,{...H,template_id:a}),alert(" Entry saved!"),ce(),we(),mt()}catch(Je){Je.response?.data?.conflicts?alert(` Conflicts:
`+Je.response.data.conflicts.map(_t=>_t.message).join(`
`)):alert("Failed to save")}},q=async J=>{if(confirm("Delete this entry?"))try{await F.delete(`${Rr}?resource=entries&id=${J}`),ce()}catch{alert("Failed")}},pe=async J=>{J.preventDefault();try{Z?.id?await F.put(`${Rr}?resource=templates&id=${Z.id}`,k):await F.post(`${Rr}?resource=templates`,k),alert(" Template saved!"),st(),mt()}catch{alert("Failed")}},Me=async(J,Je)=>{try{await F.put(`${Rr}?resource=templates&id=${J}&action=activate`,{term_id:Je}),alert(" Template activated!"),st()}catch{alert("Failed")}},Se=async J=>{if(confirm("Delete template and all entries?"))try{await F.delete(`${Rr}?resource=templates&id=${J}`),st(),a===J&&r(null)}catch{alert("Failed")}},Ne=async J=>{J.preventDefault();try{Z?.id?await F.put(`${Rr}?resource=time_slots&id=${Z.id}`,w):await F.post(`${Rr}?resource=time_slots`,w),alert(" Time slot saved!"),_e(),mt()}catch{alert("Failed")}},et=async J=>{if(confirm("Delete time slot?"))try{await F.delete(`${Rr}?resource=time_slots&id=${J}`),_e()}catch{alert("Failed")}},Ce=async J=>{J.preventDefault();try{Z?.id?await F.put(`${Rr}?resource=rooms&id=${Z.id}`,ne):await F.post(`${Rr}?resource=rooms`,ne),alert(" Room saved!"),le(),mt()}catch{alert("Failed")}},ft=async J=>{if(confirm("Delete room?"))try{await F.delete(`${Rr}?resource=rooms&id=${J}`),le()}catch{alert("Failed")}},qe=async J=>{J.preventDefault();try{await F.post(`${Rr}?resource=substitutions`,je),alert(" Substitution created!"),Pe(je.substitution_date),mt()}catch{alert("Failed")}},W=async(J,Je)=>{try{await F.put(`${Rr}?resource=substitutions&id=${J}&action=${Je?"approve":"reject"}`,{approved_by:1}),Pe()}catch{alert("Failed")}},Ie=(J,Je=null)=>{xe(J),I(Je),J==="entry"?ae(Je?{...Je}:{class_id:R||"",subject_id:"",teacher_id:"",day_of_week:"Monday",time_slot_id:"",room_number:"",notes:""}):J==="template"?B(Je?{...Je}:{template_name:"",description:"",academic_year:new Date().getFullYear().toString(),term_id:"",status:"draft"}):J==="slot"?oe(Je?{...Je,is_break:!!Je.is_break}:{slot_name:"",start_time:"08:00",end_time:"08:45",slot_order:o.length+1,is_break:!1,status:"active"}):J==="room"?Fe(Je?{...Je}:{room_number:"",room_name:"",room_type:"classroom",capacity:"",facilities:"",status:"available"}):J==="substitution"&&Ge({timetable_entry_id:"",original_teacher_id:"",substitute_teacher_id:"",substitution_date:new Date().toISOString().split("T")[0],reason:""}),re(!0)},mt=()=>{re(!1),I(null)},pt=(J,Je)=>l.find(_t=>_t.day_of_week===J&&parseInt(_t.time_slot_id)===parseInt(Je)),kt=J=>({draft:"bg-gray-100 text-gray-800",active:"bg-green-100 text-green-800",archived:"bg-yellow-100 text-yellow-800",available:"bg-green-100 text-green-800",maintenance:"bg-orange-100 text-orange-800",unavailable:"bg-red-100 text-red-800",pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"})[J]||"bg-gray-100 text-gray-800";return C?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(Ot,{className:"w-8 h-8 text-indigo-600"}),"Timetable Management"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage schedules, time slots, rooms, and substitutions"})]}),N.length>0&&e.jsxs("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(ka,{className:"w-5 h-5 text-red-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-red-800",children:"Scheduling Conflicts"}),e.jsxs("p",{className:"text-sm text-red-600",children:[N.length," conflict(s) detected"]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[e.jsx("div",{className:"border-b overflow-x-auto",children:e.jsx("div",{className:"flex",children:[{id:"timetable",label:"Timetable",icon:Ot},{id:"templates",label:"Templates",icon:vl},{id:"slots",label:"Time Slots",icon:Wt},{id:"rooms",label:"Rooms",icon:mn},{id:"substitutions",label:"Substitutions",icon:Or},{id:"conflicts",label:`Conflicts (${N.length})`,icon:ka}].map(J=>e.jsxs("button",{onClick:()=>{z(J.id),J.id==="substitutions"&&Pe()},className:`px-6 py-4 font-medium whitespace-nowrap flex items-center gap-2 ${se===J.id?"border-b-2 border-indigo-600 text-indigo-600":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(J.icon,{size:18})," ",J.label]},J.id))})}),e.jsxs("div",{className:"p-6",children:[se==="timetable"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[e.jsxs("select",{value:a||"",onChange:J=>r(J.target.value),className:"px-4 py-2 border rounded-lg",children:[e.jsx("option",{value:"",children:"Select Template"}),t.map(J=>e.jsxs("option",{value:J.id,children:[J.template_name," (",J.status,")"]},J.id))]}),e.jsxs("div",{className:"flex border rounded-lg overflow-hidden",children:[e.jsx("button",{onClick:()=>te("class"),className:`px-4 py-2 ${E==="class"?"bg-indigo-600 text-white":"bg-white"}`,children:"By Class"}),e.jsx("button",{onClick:()=>te("teacher"),className:`px-4 py-2 ${E==="teacher"?"bg-indigo-600 text-white":"bg-white"}`,children:"By Teacher"})]}),E==="class"?e.jsxs("select",{value:R||"",onChange:J=>j(J.target.value||null),className:"px-4 py-2 border rounded-lg",children:[e.jsx("option",{value:"",children:"All Classes"}),y.map(J=>e.jsx("option",{value:J.id,children:J.class_name},J.id))]}):e.jsxs("select",{value:T||"",onChange:J=>Q(J.target.value||null),className:"px-4 py-2 border rounded-lg",children:[e.jsx("option",{value:"",children:"Select Teacher"}),M.map(J=>e.jsxs("option",{value:J.id,children:[J.first_name," ",J.last_name]},J.id))]}),e.jsxs("button",{onClick:()=>Ie("entry"),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg flex items-center gap-2 hover:bg-indigo-700",children:[e.jsx(qt,{size:18})," Add Entry"]})]}),a?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full min-w-[800px]",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 w-32",children:"Time"}),Xe.map(J=>e.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:J},J))]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:o.map(J=>e.jsxs("tr",{className:J.is_break?"bg-amber-50":"",children:[e.jsxs("td",{className:"px-4 py-3 text-sm",children:[e.jsx("div",{className:"font-medium text-gray-900",children:J.slot_name}),e.jsxs("div",{className:"text-xs text-gray-500",children:[J.start_time?.substring(0,5)," - ",J.end_time?.substring(0,5)]})]}),Xe.map(Je=>{const _t=pt(Je,J.id);return e.jsx("td",{className:"px-2 py-2 text-center",children:J.is_break?e.jsx("div",{className:"text-sm text-amber-600 italic font-medium",children:"Break"}):_t?e.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded p-2 text-left relative group",children:[e.jsx("div",{className:"text-sm font-medium text-indigo-900",children:_t.subject_name}),e.jsx("div",{className:"text-xs text-indigo-600",children:_t.teacher_name||"No teacher"}),E==="teacher"&&e.jsx("div",{className:"text-xs text-gray-600",children:_t.class_name}),_t.room_number&&e.jsxs("div",{className:"text-xs text-gray-500",children:[" ",_t.room_number]}),e.jsxs("div",{className:"absolute top-1 right-1 opacity-0 group-hover:opacity-100 flex gap-1",children:[e.jsx("button",{onClick:()=>Ie("entry",_t),className:"p-1 bg-white rounded shadow hover:bg-gray-100",children:e.jsx(ll,{className:"w-3 h-3"})}),e.jsx("button",{onClick:()=>q(_t.id),className:"p-1 bg-white rounded shadow hover:bg-red-50",children:e.jsx(us,{className:"w-3 h-3 text-red-500"})})]})]}):e.jsx("button",{onClick:()=>{ae({...H,day_of_week:Je,time_slot_id:J.id,class_id:R||""}),Ie("entry")},className:"w-full h-full min-h-[60px] border-2 border-dashed border-gray-300 rounded hover:border-indigo-400 hover:bg-indigo-50",children:e.jsx(qt,{className:"w-4 h-4 text-gray-400 mx-auto"})})},Je)})]},J.id))})]})}):e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Select a template to view timetable"})]}),se==="templates"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Timetable Templates"}),e.jsxs("button",{onClick:()=>Ie("template"),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg flex items-center gap-2 hover:bg-indigo-700",children:[e.jsx(qt,{size:18})," New Template"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(J=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"font-semibold",children:J.template_name}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${kt(J.status)}`,children:J.status})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:J.description||"No description"}),e.jsxs("p",{className:"text-xs text-gray-500 mb-3",children:["Year: ",J.academic_year," | Term: ",J.term_name||"N/A"," | Entries: ",J.entries_count||0]}),e.jsxs("div",{className:"flex gap-2",children:[J.status!=="active"&&e.jsxs("button",{onClick:()=>Me(J.id,J.term_id),className:"px-3 py-1 bg-green-100 text-green-700 rounded text-sm hover:bg-green-200 flex items-center gap-1",children:[e.jsx(Qi,{size:14})," Activate"]}),e.jsx("button",{onClick:()=>Ie("template",J),className:"px-3 py-1 bg-gray-100 text-gray-700 rounded text-sm hover:bg-gray-200",children:e.jsx(ll,{size:14})}),e.jsx("button",{onClick:()=>Se(J.id),className:"px-3 py-1 bg-red-100 text-red-700 rounded text-sm hover:bg-red-200",children:e.jsx(us,{size:14})})]})]},J.id))})]}),se==="slots"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Time Slots / Periods"}),e.jsxs("button",{onClick:()=>Ie("slot"),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg flex items-center gap-2 hover:bg-indigo-700",children:[e.jsx(qt,{size:18})," Add Slot"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Order"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Start"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"End"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:o.map(J=>e.jsxs("tr",{className:J.is_break?"bg-amber-50":"",children:[e.jsx("td",{className:"px-4 py-3",children:J.slot_order}),e.jsx("td",{className:"px-4 py-3 font-medium",children:J.slot_name}),e.jsx("td",{className:"px-4 py-3",children:J.start_time?.substring(0,5)}),e.jsx("td",{className:"px-4 py-3",children:J.end_time?.substring(0,5)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${J.is_break?"bg-amber-100 text-amber-800":"bg-blue-100 text-blue-800"}`,children:J.is_break?"Break":"Period"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${kt(J.status)}`,children:J.status})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>Ie("slot",J),className:"p-1 hover:bg-gray-100 rounded",children:e.jsx(ll,{size:16})}),e.jsx("button",{onClick:()=>et(J.id),className:"p-1 hover:bg-red-50 rounded",children:e.jsx(us,{size:16,className:"text-red-500"})})]})})]},J.id))})]})})]}),se==="rooms"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Rooms & Venues"}),e.jsxs("button",{onClick:()=>Ie("room"),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg flex items-center gap-2 hover:bg-indigo-700",children:[e.jsx(qt,{size:18})," Add Room"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:u.map(J=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(mn,{className:"text-indigo-600",size:20}),e.jsx("h4",{className:"font-semibold",children:J.room_number})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${kt(J.status)}`,children:J.status})]}),e.jsx("p",{className:"text-sm text-gray-600",children:J.room_name||"Unnamed"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Type: ",J.room_type," | Capacity: ",J.capacity||"N/A"]}),J.facilities&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Facilities: ",J.facilities]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx("button",{onClick:()=>Ie("room",J),className:"px-3 py-1 bg-gray-100 rounded text-sm hover:bg-gray-200",children:e.jsx(ll,{size:14})}),e.jsx("button",{onClick:()=>ft(J.id),className:"px-3 py-1 bg-red-100 text-red-700 rounded text-sm hover:bg-red-200",children:e.jsx(us,{size:14})})]})]},J.id))})]}),se==="substitutions"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Teacher Substitutions"}),e.jsxs("button",{onClick:()=>Ie("substitution"),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg flex items-center gap-2 hover:bg-indigo-700",children:[e.jsx(qt,{size:18})," New Substitution"]})]}),A.length===0?e.jsx("div",{className:"text-center py-12 text-gray-500",children:"No substitutions for today"}):e.jsx("div",{className:"space-y-3",children:A.map(J=>e.jsxs("div",{className:"border rounded-lg p-4 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[J.class_name," - ",J.subject_name]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[J.slot_name," (",J.start_time?.substring(0,5)," - ",J.end_time?.substring(0,5),")"]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"text-red-600",children:J.original_teacher}),"  ",e.jsx("span",{className:"text-green-600",children:J.substitute_teacher})]}),J.reason&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Reason: ",J.reason]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs ${kt(J.status)}`,children:J.status}),J.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>W(J.id,!0),className:"p-2 bg-green-100 rounded hover:bg-green-200",children:e.jsx(Tn,{size:16,className:"text-green-600"})}),e.jsx("button",{onClick:()=>W(J.id,!1),className:"p-2 bg-red-100 rounded hover:bg-red-200",children:e.jsx(Nt,{size:16,className:"text-red-600"})})]})]})]},J.id))})]}),se==="conflicts"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Scheduling Conflicts"}),N.length===0?e.jsxs("div",{className:"text-center py-12 text-green-600",children:[e.jsx(Tn,{size:48,className:"mx-auto mb-2"}),"No conflicts detected!"]}):e.jsx("div",{className:"space-y-3",children:N.map(J=>e.jsx("div",{className:"border border-red-200 bg-red-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ka,{className:"text-red-600 mt-0.5",size:20}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-red-800",children:J.conflict_type.replace(/_/g," ").toUpperCase()}),e.jsxs("p",{className:"text-sm text-red-600",children:[J.day_of_week," - ",J.slot_name]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Resource: ",J.conflict_resource]})]})]})},J.id))})]})]})]}),V&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b sticky top-0 bg-white flex justify-between items-center",children:[e.jsxs("h2",{className:"text-xl font-bold",children:[ge==="entry"&&(Z?"Edit Entry":"Add Entry"),ge==="template"&&(Z?"Edit Template":"New Template"),ge==="slot"&&(Z?"Edit Time Slot":"Add Time Slot"),ge==="room"&&(Z?"Edit Room":"Add Room"),ge==="substitution"&&"New Substitution"]}),e.jsx("button",{onClick:mt,className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{size:20})})]}),e.jsxs("div",{className:"p-6",children:[ge==="entry"&&e.jsxs("form",{onSubmit:ie,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Class *"}),e.jsxs("select",{value:H.class_id,onChange:J=>ae({...H,class_id:J.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select"}),y.map(J=>e.jsx("option",{value:J.id,children:J.class_name},J.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Subject *"}),e.jsxs("select",{value:H.subject_id,onChange:J=>ae({...H,subject_id:J.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select"}),U.map(J=>e.jsx("option",{value:J.id,children:J.subject_name},J.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Teacher"}),e.jsxs("select",{value:H.teacher_id,onChange:J=>ae({...H,teacher_id:J.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Select"}),M.map(J=>e.jsxs("option",{value:J.id,children:[J.first_name," ",J.last_name]},J.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Day *"}),e.jsx("select",{value:H.day_of_week,onChange:J=>ae({...H,day_of_week:J.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:ze.map(J=>e.jsx("option",{value:J,children:J},J))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Time Slot *"}),e.jsxs("select",{value:H.time_slot_id,onChange:J=>ae({...H,time_slot_id:J.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select"}),o.filter(J=>!J.is_break).map(J=>e.jsx("option",{value:J.id,children:J.slot_name},J.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Room"}),e.jsxs("select",{value:H.room_number,onChange:J=>ae({...H,room_number:J.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Select"}),u.filter(J=>J.status==="available").map(J=>e.jsxs("option",{value:J.room_number,children:[J.room_number," - ",J.room_name]},J.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notes"}),e.jsx("textarea",{value:H.notes,onChange:J=>ae({...H,notes:J.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:mt,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700",children:"Save"})]})]}),ge==="template"&&e.jsxs("form",{onSubmit:pe,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Template Name *"}),e.jsx("input",{type:"text",value:k.template_name,onChange:J=>B({...k,template_name:J.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),e.jsx("textarea",{value:k.description,onChange:J=>B({...k,description:J.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Academic Year"}),e.jsx("input",{type:"text",value:k.academic_year,onChange:J=>B({...k,academic_year:J.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Term"}),e.jsxs("select",{value:k.term_id,onChange:J=>B({...k,term_id:J.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Select"}),$.map(J=>e.jsx("option",{value:J.id,children:J.term_name},J.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),e.jsxs("select",{value:k.status,onChange:J=>B({...k,status:J.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"archived",children:"Archived"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:mt,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700",children:"Save"})]})]}),ge==="slot"&&e.jsxs("form",{onSubmit:Ne,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Slot Name *"}),e.jsx("input",{type:"text",value:w.slot_name,onChange:J=>oe({...w,slot_name:J.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,placeholder:"e.g., Period 1"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Start Time *"}),e.jsx("input",{type:"time",value:w.start_time,onChange:J=>oe({...w,start_time:J.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"End Time *"}),e.jsx("input",{type:"time",value:w.end_time,onChange:J=>oe({...w,end_time:J.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Order"}),e.jsx("input",{type:"number",value:w.slot_order,onChange:J=>oe({...w,slot_order:J.target.value}),className:"w-full border rounded-lg px-3 py-2",min:"1"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"is_break",checked:w.is_break,onChange:J=>oe({...w,is_break:J.target.checked}),className:"rounded"}),e.jsx("label",{htmlFor:"is_break",className:"text-sm",children:"This is a break period"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),e.jsxs("select",{value:w.status,onChange:J=>oe({...w,status:J.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:mt,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700",children:"Save"})]})]}),ge==="room"&&e.jsxs("form",{onSubmit:Ce,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Room Number *"}),e.jsx("input",{type:"text",value:ne.room_number,onChange:J=>Fe({...ne,room_number:J.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,placeholder:"e.g., R101"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Capacity"}),e.jsx("input",{type:"number",value:ne.capacity,onChange:J=>Fe({...ne,capacity:J.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Room Name"}),e.jsx("input",{type:"text",value:ne.room_name,onChange:J=>Fe({...ne,room_name:J.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"e.g., Science Lab 1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Room Type"}),e.jsxs("select",{value:ne.room_type,onChange:J=>Fe({...ne,room_type:J.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"classroom",children:"Classroom"}),e.jsx("option",{value:"lab",children:"Lab"}),e.jsx("option",{value:"library",children:"Library"}),e.jsx("option",{value:"hall",children:"Hall"}),e.jsx("option",{value:"sports",children:"Sports"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Facilities"}),e.jsx("input",{type:"text",value:ne.facilities,onChange:J=>Fe({...ne,facilities:J.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"e.g., Projector, AC, Whiteboard"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),e.jsxs("select",{value:ne.status,onChange:J=>Fe({...ne,status:J.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"available",children:"Available"}),e.jsx("option",{value:"maintenance",children:"Maintenance"}),e.jsx("option",{value:"unavailable",children:"Unavailable"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:mt,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700",children:"Save"})]})]}),ge==="substitution"&&e.jsxs("form",{onSubmit:qe,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Date *"}),e.jsx("input",{type:"date",value:je.substitution_date,onChange:J=>Ge({...je,substitution_date:J.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Timetable Entry *"}),e.jsxs("select",{value:je.timetable_entry_id,onChange:J=>{const Je=l.find(_t=>_t.id==J.target.value);Ge({...je,timetable_entry_id:J.target.value,original_teacher_id:Je?.teacher_id||""})},className:"w-full border rounded-lg px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select"}),l.filter(J=>J.teacher_id).map(J=>e.jsxs("option",{value:J.id,children:[J.day_of_week," - ",J.slot_name," - ",J.class_name," (",J.subject_name,")"]},J.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Original Teacher"}),e.jsxs("select",{value:je.original_teacher_id,onChange:J=>Ge({...je,original_teacher_id:J.target.value}),className:"w-full border rounded-lg px-3 py-2",disabled:!0,children:[e.jsx("option",{value:"",children:"Auto-filled"}),M.map(J=>e.jsxs("option",{value:J.id,children:[J.first_name," ",J.last_name]},J.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Substitute Teacher *"}),e.jsxs("select",{value:je.substitute_teacher_id,onChange:J=>Ge({...je,substitute_teacher_id:J.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select"}),M.filter(J=>J.id!=je.original_teacher_id).map(J=>e.jsxs("option",{value:J.id,children:[J.first_name," ",J.last_name]},J.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Reason"}),e.jsx("textarea",{value:je.reason,onChange:J=>Ge({...je,reason:J.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2,placeholder:"e.g., Sick leave, Training"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:mt,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700",children:"Create"})]})]})]})]})})]})}function fT(){const[t,s]=h.useState([]),[a,r]=h.useState([]),[l,c]=h.useState([]),[o,m]=h.useState([]),[u,x]=h.useState(null),[A,g]=h.useState([]),[N,f]=h.useState([]),[y,v]=h.useState([]),[U,D]=h.useState([]),[M,K]=h.useState(null),[$,P]=h.useState(null),[se,z]=h.useState(!0),[R,j]=h.useState("exams"),[T,Q]=h.useState(!1),[E,te]=h.useState("exam"),[C,O]=h.useState(null),[V,re]=h.useState(""),[ge,xe]=h.useState("all"),[Z,I]=h.useState({exam_name:"",exam_type_id:1,academic_year:new Date().getFullYear(),term_id:"",start_date:"",end_date:"",status:"scheduled",instructions:""}),[H,ae]=h.useState({exam_id:"",class_id:"",subject_id:"",exam_date:"",start_time:"09:00",end_time:"11:00",duration_minutes:120,room_id:"",max_marks:100,pass_marks:40,instructions:""}),[k,B]=h.useState({student_id:"",marks_obtained:"",remarks:""});h.useEffect(()=>{w(),oe(),ne(),Fe()},[]);const w=async()=>{try{const W=await F.get(`${ee}/exams.php?resource=exams`);W.data.success&&s(W.data.exams||[])}catch(W){console.error("Error fetching exams:",W)}finally{z(!1)}},oe=async()=>{try{const W=await F.get(`${ee}/classes.php`);console.log("Classes response:",W.data);const Ie=W.data.classes||W.data||[];g(Array.isArray(Ie)?Ie:[])}catch(W){console.error("Error fetching classes:",W),g([])}},ne=async()=>{try{const W=await F.get(`${ee}/subjects.php`);console.log("Subjects response:",W.data);const Ie=W.data.subjects||W.data||[];f(Array.isArray(Ie)?Ie:[])}catch(W){console.error("Error fetching subjects:",W),f([])}},Fe=async()=>{try{const W=await F.get(`${ee}/terms.php`);console.log("Terms response:",W.data);const Ie=W.data.terms||W.data||[];v(Array.isArray(Ie)?Ie:[])}catch(W){console.error("Error fetching terms:",W),v([])}},je=async W=>{try{const Ie=await F.get(`${ee}/exams.php?resource=schedules&action=by_exam&exam_id=${W}`);Ie.data.success&&r(Ie.data.schedules||[])}catch(Ie){console.error("Error fetching schedules:",Ie)}},Ge=async W=>{try{const Ie=await F.get(`${ee}/exams.php?resource=results&action=by_schedule&schedule_id=${W}`);Ie.data.success&&c(Ie.data.results||[])}catch(Ie){console.error("Error fetching results:",Ie)}},ze=async W=>{try{const Ie=await F.get(`${ee}/exams.php?resource=seating&action=by_schedule&schedule_id=${W}`);Ie.data.success&&m(Ie.data.seating||[])}catch(Ie){console.error("Error fetching seating:",Ie)}},Xe=async W=>{try{const Ie=await F.get(`${ee}/exams.php?resource=statistics&schedule_id=${W}`);Ie.data.success&&x(Ie.data.statistics)}catch(Ie){console.error("Error fetching statistics:",Ie)}},st=async W=>{try{const Ie=await F.get(`${ee}/students.php?class_id=${W}`);D(Ie.data.students||[])}catch(Ie){console.error("Error fetching students:",Ie)}},ce=async W=>{W.preventDefault();try{(await F.post(`${ee}/exams.php?resource=exams`,Z)).data.success&&(alert(" Exam created successfully!"),Q(!1),w(),pe())}catch(Ie){console.error("Error creating exam:",Ie),alert("Failed to create exam")}},_e=async W=>{W.preventDefault();try{(await F.put(`${ee}/exams.php?resource=exams&id=${C.id}`,Z)).data.success&&(alert(" Exam updated successfully!"),Q(!1),w(),O(null),pe())}catch(Ie){console.error("Error updating exam:",Ie),alert("Failed to update exam")}},le=async W=>{if(confirm("Are you sure you want to delete this exam? This will also delete all schedules and results."))try{(await F.delete(`${ee}/exams.php?resource=exams&id=${W}`)).data.success&&(alert(" Exam deleted successfully!"),w())}catch(Ie){console.error("Error deleting exam:",Ie),alert("Failed to delete exam")}},Pe=async W=>{W.preventDefault();try{(await F.post(`${ee}/exams.php?resource=schedules`,{...H,exam_id:M.id})).data.success&&(alert(" Schedule created successfully!"),Q(!1),je(M.id),Me())}catch(Ie){console.error("Error creating schedule:",Ie),alert("Failed to create schedule")}},we=async W=>{if(confirm("Are you sure you want to delete this schedule?"))try{(await F.delete(`${ee}/exams.php?resource=schedules&id=${W}`)).data.success&&(alert(" Schedule deleted successfully!"),je(M.id))}catch(Ie){console.error("Error deleting schedule:",Ie),alert("Failed to delete schedule")}},fe=async W=>{W.preventDefault();try{const Ie=await F.post(`${ee}/exams.php?resource=results`,{exam_schedule_id:$.id,student_id:k.student_id,marks_obtained:parseFloat(k.marks_obtained),max_marks:$.max_marks,remarks:k.remarks});Ie.data.success&&(alert(` Result saved! Grade: ${Ie.data.grade} (${Ie.data.percentage.toFixed(1)}%)`),Ge($.id),B({student_id:"",marks_obtained:"",remarks:""}))}catch(Ie){console.error("Error saving result:",Ie),alert("Failed to save result")}},ye=async W=>{if(confirm("Publish results? Students and parents will be able to view them."))try{(await F.put(`${ee}/exams.php?resource=results&action=publish&schedule_id=${W}`)).data.success&&(alert(" Results published successfully!"),Ge(W))}catch(Ie){console.error("Error publishing results:",Ie),alert("Failed to publish results")}},Ke=async W=>{if(confirm("Generate automatic seating arrangement for this exam?"))try{(await F.get(`${ee}/exams.php?resource=seating&action=generate&schedule_id=${W.id}&class_id=${W.class_id}&room_id=${W.room_id||1}`)).data.success&&(alert(" Seating arrangement generated successfully!"),ze(W.id))}catch(Ie){console.error("Error generating seating:",Ie),alert("Failed to generate seating")}},ve=async(W,Ie)=>{try{(await F.put(`${ee}/exams.php?resource=seating&id=${W}&action=mark_attendance`,{status:Ie})).data.success&&m(o.map(pt=>pt.id===W?{...pt,status:Ie}:pt))}catch(mt){console.error("Error marking attendance:",mt),alert("Failed to update attendance")}},ie=W=>{K(W),P(null),je(W.id),j("schedules")},q=W=>{P(W),Ge(W.id),ze(W.id),Xe(W.id),st(W.class_id),j("results")},pe=()=>{I({exam_name:"",exam_type_id:1,academic_year:new Date().getFullYear(),term_id:"",start_date:"",end_date:"",status:"scheduled",instructions:""})},Me=()=>{ae({exam_id:"",class_id:"",subject_id:"",exam_date:"",start_time:"09:00",end_time:"11:00",duration_minutes:120,room_id:"",max_marks:100,pass_marks:40,instructions:""})},Se=W=>{O(W),I({exam_name:W.exam_name||"",exam_type_id:W.exam_type_id||1,academic_year:W.academic_year||new Date().getFullYear(),term_id:W.term_id||"",start_date:W.start_date||"",end_date:W.end_date||"",status:W.status||"scheduled",instructions:W.instructions||""}),te("exam"),Q(!0)},Ne=()=>{Me(),te("schedule"),Q(!0)},et=()=>{O(null),pe(),te("exam"),Q(!0)},Ce=t.filter(W=>{const Ie=W.exam_name?.toLowerCase().includes(V.toLowerCase()),mt=ge==="all"||W.status===ge;return Ie&&mt}),ft=W=>{switch(W){case"completed":return"bg-green-100 text-green-800";case"ongoing":return"bg-blue-100 text-blue-800";case"scheduled":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},qe=W=>W?W.startsWith("A")?"text-green-600 font-bold":W.startsWith("B")?"text-blue-600 font-bold":W.startsWith("C")?"text-yellow-600 font-bold":W.startsWith("D")?"text-orange-600 font-bold":"text-red-600 font-bold":"text-gray-500";return se?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(hs,{className:"w-8 h-8 animate-spin text-blue-600"})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Exam Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Create exams, manage schedules, enter results, and generate seating"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:w,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-2",children:[e.jsx(Ns,{size:18}),"Refresh"]}),e.jsxs("button",{onClick:et,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:20}),"Create Exam"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"Total Exams"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-1",children:t.length})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:e.jsx(Ot,{className:"text-blue-600",size:24})})]})}),e.jsx("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"Scheduled"}),e.jsx("p",{className:"text-3xl font-bold text-yellow-600 mt-1",children:t.filter(W=>W.status==="scheduled").length})]}),e.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-xl flex items-center justify-center",children:e.jsx(Wt,{className:"text-yellow-600",size:24})})]})}),e.jsx("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"Ongoing"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600 mt-1",children:t.filter(W=>W.status==="ongoing").length})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:e.jsx(as,{className:"text-blue-600",size:24})})]})}),e.jsx("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"Completed"}),e.jsx("p",{className:"text-3xl font-bold text-green-600 mt-1",children:t.filter(W=>W.status==="completed").length})]}),e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:e.jsx(Is,{className:"text-green-600",size:24})})]})})]}),(M||$)&&e.jsxs("div",{className:"flex items-center gap-2 text-sm bg-gray-50 p-3 rounded-lg",children:[e.jsx("button",{onClick:()=>{j("exams"),K(null),P(null)},className:"text-blue-600 hover:underline",children:"All Exams"}),M&&e.jsxs(e.Fragment,{children:[e.jsx(cr,{size:16,className:"text-gray-400"}),e.jsx("button",{onClick:()=>{j("schedules"),P(null)},className:$?"text-blue-600 hover:underline":"text-gray-700 font-medium",children:M.exam_name})]}),$&&e.jsxs(e.Fragment,{children:[e.jsx(cr,{size:16,className:"text-gray-400"}),e.jsxs("span",{className:"text-gray-700 font-medium",children:[$.subject_name," - ",$.class_name]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100",children:[e.jsx("div",{className:"border-b",children:e.jsxs("div",{className:"flex overflow-x-auto",children:[e.jsxs("button",{onClick:()=>{j("exams"),K(null),P(null)},className:`px-6 py-4 font-medium whitespace-nowrap flex items-center gap-2 ${R==="exams"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(Kt,{size:18}),"All Exams"]}),M&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{j("schedules"),P(null)},className:`px-6 py-4 font-medium whitespace-nowrap flex items-center gap-2 ${R==="schedules"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(Ot,{size:18}),"Schedules"]}),e.jsxs("button",{onClick:()=>j("results"),className:`px-6 py-4 font-medium whitespace-nowrap flex items-center gap-2 ${R==="results"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(Di,{size:18}),"Results"]}),e.jsxs("button",{onClick:()=>j("seating"),className:`px-6 py-4 font-medium whitespace-nowrap flex items-center gap-2 ${R==="seating"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(Qn,{size:18}),"Seating"]}),e.jsxs("button",{onClick:()=>j("statistics"),className:`px-6 py-4 font-medium whitespace-nowrap flex items-center gap-2 ${R==="statistics"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(Fs,{size:18}),"Statistics"]})]})]})}),e.jsxs("div",{className:"p-6",children:[R==="exams"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"Search exams...",value:V,onChange:W=>re(W.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("select",{value:ge,onChange:W=>xe(W.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"scheduled",children:"Scheduled"}),e.jsx("option",{value:"ongoing",children:"Ongoing"}),e.jsx("option",{value:"completed",children:"Completed"})]})]}),Ce.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Kt,{className:"mx-auto text-gray-300",size:48}),e.jsx("p",{className:"text-gray-500 mt-4",children:"No exams found"}),e.jsx("button",{onClick:et,className:"mt-4 text-blue-600 hover:underline",children:"Create your first exam"})]}):e.jsx("div",{className:"grid gap-4",children:Ce.map(W=>e.jsx("div",{className:"border border-gray-200 rounded-xl p-5 hover:shadow-md transition-all bg-white",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Qs,{className:"text-blue-600",size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:W.exam_name}),e.jsx("p",{className:"text-sm text-gray-500",children:W.term_name||"No term assigned"})]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-4 text-sm text-gray-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ot,{size:14}),W.start_date," - ",W.end_date]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Wt,{size:14}),W.academic_year]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Kt,{size:14}),W.schedule_count||0," schedules"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${ft(W.status)}`,children:W.status}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>ie(W),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"View Schedules",children:e.jsx(na,{size:18})}),e.jsx("button",{onClick:()=>Se(W),className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg",title:"Edit",children:e.jsx(ll,{size:18})}),e.jsx("button",{onClick:()=>le(W.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Delete",children:e.jsx(us,{size:18})})]})]})]})},W.id))})]}),R==="schedules"&&M&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Exam Schedules for ",M.exam_name]}),e.jsxs("button",{onClick:Ne,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center gap-2",children:[e.jsx(qt,{size:18}),"Add Schedule"]})]}),a.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx(Ot,{className:"mx-auto text-gray-300",size:48}),e.jsx("p",{className:"text-gray-500 mt-4",children:"No schedules created yet"}),e.jsx("button",{onClick:Ne,className:"mt-4 text-blue-600 hover:underline",children:"Add first schedule"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Subject"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Class"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Time"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Duration"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Max Marks"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Room"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:a.map(W=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:W.subject_name}),e.jsx("td",{className:"px-4 py-3",children:W.class_name}),e.jsx("td",{className:"px-4 py-3",children:W.exam_date}),e.jsxs("td",{className:"px-4 py-3",children:[W.start_time," - ",W.end_time]}),e.jsxs("td",{className:"px-4 py-3",children:[W.duration_minutes," mins"]}),e.jsx("td",{className:"px-4 py-3",children:W.max_marks}),e.jsx("td",{className:"px-4 py-3",children:W.room_number||"N/A"}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>q(W),className:"px-3 py-1 bg-blue-100 text-blue-700 rounded hover:bg-blue-200 text-sm",children:"Results"}),e.jsx("button",{onClick:()=>Ke(W),className:"px-3 py-1 bg-green-100 text-green-700 rounded hover:bg-green-200 text-sm",children:"Seating"}),e.jsx("button",{onClick:()=>we(W.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:e.jsx(us,{size:16})})]})})]},W.id))})]})})]}),R==="results"&&M&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Schedule to Enter Results"}),e.jsxs("select",{value:$?.id||"",onChange:W=>{const Ie=a.find(mt=>mt.id==W.target.value);Ie?(P(Ie),Ge(Ie.id),Xe(Ie.id),st(Ie.class_id)):P(null)},className:"w-full md:w-auto px-4 py-2 border border-gray-300 rounded-lg",children:[e.jsx("option",{value:"",children:"-- Select a Schedule --"}),a.map(W=>e.jsxs("option",{value:W.id,children:[W.subject_name," - ",W.class_name," (",W.exam_date,")"]},W.id))]})]}),$?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold",children:[$.subject_name," - ",$.class_name]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Max Marks: ",$.max_marks," | Pass Marks: ",$.pass_marks]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>{Ge($.id),Xe($.id)},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-2",children:[e.jsx(Ns,{size:18}),"Refresh"]}),e.jsxs("button",{onClick:()=>ye($.id),className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 flex items-center gap-2",children:[e.jsx(Mt,{size:18}),"Publish Results"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg text-center",children:[e.jsx("p",{className:"text-xs text-blue-600",children:"Entered"}),e.jsx("p",{className:"text-xl font-bold text-blue-800",children:l.length})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg text-center",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Pending"}),e.jsx("p",{className:"text-xl font-bold text-gray-800",children:U.length-l.length})]}),e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg text-center",children:[e.jsx("p",{className:"text-xs text-green-600",children:"Passed"}),e.jsx("p",{className:"text-xl font-bold text-green-800",children:l.filter(W=>parseFloat(W.marks_obtained)>=$.pass_marks).length})]}),e.jsxs("div",{className:"bg-red-50 p-3 rounded-lg text-center",children:[e.jsx("p",{className:"text-xs text-red-600",children:"Failed"}),e.jsx("p",{className:"text-xl font-bold text-red-800",children:l.filter(W=>parseFloat(W.marks_obtained)<$.pass_marks).length})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-blue-800 mb-3",children:"Enter Result"}),e.jsxs("form",{onSubmit:fe,className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("select",{value:k.student_id,onChange:W=>B({...k,student_id:W.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg",required:!0,children:[e.jsxs("option",{value:"",children:["Select Student (",U.filter(W=>!l.find(Ie=>Ie.student_id==W.id)).length," pending)"]}),U.filter(W=>!l.find(Ie=>Ie.student_id==W.id)).map(W=>e.jsxs("option",{value:W.id,children:[W.first_name," ",W.last_name," (",W.student_id,")"]},W.id)),e.jsx("optgroup",{label:"Already Entered (Edit)",children:U.filter(W=>l.find(Ie=>Ie.student_id==W.id)).map(W=>e.jsxs("option",{value:W.id,children:[W.first_name," ",W.last_name," (",W.student_id,") "]},W.id))})]}),e.jsx("input",{type:"number",placeholder:"Marks",value:k.marks_obtained,onChange:W=>B({...k,marks_obtained:W.target.value}),className:"w-32 px-3 py-2 border border-gray-300 rounded-lg",min:"0",max:$.max_marks,required:!0}),e.jsx("input",{type:"text",placeholder:"Remarks (optional)",value:k.remarks,onChange:W=>B({...k,remarks:W.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700",children:"Save"})]})]}),l.length===0?e.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[e.jsx(Di,{className:"mx-auto text-gray-300",size:48}),e.jsx("p",{className:"text-gray-500 mt-4",children:"No results entered yet"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Student"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Student ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Marks"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Percentage"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Grade"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Remarks"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:l.map(W=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:W.student_name}),e.jsx("td",{className:"px-4 py-3",children:W.student_number}),e.jsxs("td",{className:"px-4 py-3",children:[W.marks_obtained," / ",W.max_marks]}),e.jsxs("td",{className:"px-4 py-3",children:[parseFloat(W.percentage).toFixed(1),"%"]}),e.jsx("td",{className:`px-4 py-3 ${qe(W.grade)}`,children:W.grade}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${W.status==="published"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:W.status})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:W.remarks||"-"})]},W.id))})]})})]}):e.jsxs("div",{className:"text-center py-12 bg-white rounded-lg border",children:[e.jsx(Di,{className:"mx-auto text-gray-300",size:48}),e.jsx("p",{className:"text-gray-500 mt-4",children:"Select a schedule above to enter results"}),a.length===0&&e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"No schedules found. Add schedules first from the Schedules tab."})]})]}),R==="seating"&&M&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Schedule for Seating"}),e.jsxs("select",{value:$?.id||"",onChange:W=>{const Ie=a.find(mt=>mt.id==W.target.value);Ie?(P(Ie),ze(Ie.id)):(P(null),m([]))},className:"w-full md:w-auto px-4 py-2 border border-gray-300 rounded-lg",children:[e.jsx("option",{value:"",children:"-- Select a Schedule --"}),a.map(W=>e.jsxs("option",{value:W.id,children:[W.subject_name," - ",W.class_name," (",W.exam_date,")"]},W.id))]})]}),$?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Seating: ",$.subject_name," - ",$.class_name]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Click on a seat to mark attendance"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>ze($.id),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-2",children:[e.jsx(Ns,{size:18}),"Refresh"]}),e.jsxs("button",{onClick:()=>Ke($),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center gap-2",children:[e.jsx(qt,{size:18}),"Generate Seating"]})]})]}),o.length>0&&e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg text-center",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Total"}),e.jsx("p",{className:"text-xl font-bold text-gray-800",children:o.length})]}),e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg text-center",children:[e.jsx("p",{className:"text-xs text-green-600",children:"Present"}),e.jsx("p",{className:"text-xl font-bold text-green-800",children:o.filter(W=>W.status==="present").length})]}),e.jsxs("div",{className:"bg-red-50 p-3 rounded-lg text-center",children:[e.jsx("p",{className:"text-xs text-red-600",children:"Absent"}),e.jsx("p",{className:"text-xl font-bold text-red-800",children:o.filter(W=>W.status==="absent").length})]})]}),e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-4 h-4 bg-white border-2 border-gray-300 rounded"})," Assigned"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-4 h-4 bg-green-100 border-2 border-green-500 rounded"})," Present"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-4 h-4 bg-red-100 border-2 border-red-500 rounded"})," Absent"]})]}),o.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx(Qn,{className:"mx-auto text-gray-300",size:48}),e.jsx("p",{className:"text-gray-500 mt-4",children:"No seating arrangement generated"}),e.jsx("button",{onClick:()=>Ke($),className:"mt-4 text-blue-600 hover:underline",children:"Generate seating now"})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:o.map(W=>e.jsxs("div",{onClick:()=>ve(W.id,W.status==="present"?"absent":"present"),className:`p-4 rounded-lg border-2 text-center cursor-pointer transition-all hover:shadow-md ${W.status==="present"?"border-green-500 bg-green-50 hover:bg-green-100":W.status==="absent"?"border-red-500 bg-red-50 hover:bg-red-100":"border-gray-300 bg-white hover:bg-gray-50"}`,children:[e.jsx("div",{className:"text-2xl font-bold text-gray-700",children:W.seat_number||"-"}),e.jsx("div",{className:"text-sm font-medium mt-2 truncate",children:W.student_name}),e.jsx("div",{className:"text-xs text-gray-500",children:W.student_number}),e.jsx("div",{className:`text-xs mt-2 px-2 py-1 rounded ${W.status==="present"?"bg-green-200 text-green-800":W.status==="absent"?"bg-red-200 text-red-800":"bg-gray-200 text-gray-600"}`,children:W.status==="present"?" Present":W.status==="absent"?" Absent":"Assigned"})]},W.id))})]}):e.jsxs("div",{className:"text-center py-12 bg-white rounded-lg border",children:[e.jsx(Qn,{className:"mx-auto text-gray-300",size:48}),e.jsx("p",{className:"text-gray-500 mt-4",children:"Select a schedule above to view/generate seating"}),a.length===0&&e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"No schedules found. Add schedules first from the Schedules tab."})]})]}),R==="statistics"&&M&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Schedule for Statistics"}),e.jsxs("select",{value:$?.id||"",onChange:W=>{const Ie=a.find(mt=>mt.id==W.target.value);Ie?(P(Ie),Xe(Ie.id)):(P(null),x(null))},className:"w-full md:w-auto px-4 py-2 border border-gray-300 rounded-lg",children:[e.jsx("option",{value:"",children:"-- Select a Schedule --"}),a.map(W=>e.jsxs("option",{value:W.id,children:[W.subject_name," - ",W.class_name," (",W.exam_date,")"]},W.id))]})]}),$?e.jsxs(e.Fragment,{children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Statistics: ",$.subject_name," - ",$.class_name]}),u?e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Total Students"}),e.jsx("p",{className:"text-3xl font-bold text-blue-800",children:u.total_students||0})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Passed"}),e.jsx("p",{className:"text-3xl font-bold text-green-800",children:u.passed_count||0})]}),e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-red-600 font-medium",children:"Failed"}),e.jsx("p",{className:"text-3xl font-bold text-red-800",children:u.failed_count||0})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-purple-600 font-medium",children:"Pass Rate"}),e.jsxs("p",{className:"text-3xl font-bold text-purple-800",children:[parseFloat(u.pass_percentage||0).toFixed(1),"%"]})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-yellow-600 font-medium",children:"Average Marks"}),e.jsx("p",{className:"text-3xl font-bold text-yellow-800",children:parseFloat(u.average_marks||0).toFixed(1)})]}),e.jsxs("div",{className:"bg-emerald-50 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-emerald-600 font-medium",children:"Highest Marks"}),e.jsx("p",{className:"text-3xl font-bold text-emerald-800",children:u.highest_marks||0})]}),e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-orange-600 font-medium",children:"Lowest Marks"}),e.jsx("p",{className:"text-3xl font-bold text-orange-800",children:u.lowest_marks||0})]}),e.jsxs("div",{className:"bg-indigo-50 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-indigo-600 font-medium",children:"Average %"}),e.jsxs("p",{className:"text-3xl font-bold text-indigo-800",children:[parseFloat(u.average_percentage||0).toFixed(1),"%"]})]})]}):e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx(Fs,{className:"mx-auto text-gray-300",size:48}),e.jsx("p",{className:"text-gray-500 mt-4",children:"No statistics available yet"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Enter results to see statistics"})]})]}):e.jsxs("div",{className:"text-center py-12 bg-white rounded-lg border",children:[e.jsx(Fs,{className:"mx-auto text-gray-300",size:48}),e.jsx("p",{className:"text-gray-500 mt-4",children:"Select a schedule above to view statistics"}),a.length===0&&e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"No schedules found. Add schedules first from the Schedules tab."})]})]})]})]}),T&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b sticky top-0 bg-white",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:E==="exam"?C?"Edit Exam":"Create New Exam":"Add Schedule"}),e.jsx("button",{onClick:()=>Q(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(Nt,{size:20})})]})}),e.jsxs("div",{className:"p-6",children:[E==="exam"&&e.jsxs("form",{onSubmit:C?_e:ce,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Exam Name *"}),e.jsx("input",{type:"text",value:Z.exam_name,onChange:W=>I({...Z,exam_name:W.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Mid-Term Examination 2024",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Academic Year"}),e.jsx("input",{type:"number",value:Z.academic_year,onChange:W=>I({...Z,academic_year:W.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Term"}),e.jsxs("select",{value:Z.term_id,onChange:W=>I({...Z,term_id:W.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Select Term"}),y.map(W=>e.jsx("option",{value:W.id,children:W.term_name},W.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date *"}),e.jsx("input",{type:"date",value:Z.start_date,onChange:W=>I({...Z,start_date:W.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date *"}),e.jsx("input",{type:"date",value:Z.end_date,onChange:W=>I({...Z,end_date:W.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:Z.status,onChange:W=>I({...Z,status:W.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[e.jsx("option",{value:"scheduled",children:"Scheduled"}),e.jsx("option",{value:"ongoing",children:"Ongoing"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Instructions"}),e.jsx("textarea",{value:Z.instructions,onChange:W=>I({...Z,instructions:W.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",rows:3,placeholder:"General instructions for the exam..."})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>Q(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:C?"Update Exam":"Create Exam"})]})]}),E==="schedule"&&e.jsxs("form",{onSubmit:Pe,className:"space-y-4",children:[(A.length===0||N.length===0)&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-sm text-yellow-800",children:[e.jsx("strong",{children:"Note:"})," ",A.length===0&&"No classes found. ",N.length===0&&"No subjects found. ","Please add classes and subjects first from the respective management pages."]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Class * (",A.length," available)"]}),e.jsxs("select",{value:H.class_id,onChange:W=>ae({...H,class_id:W.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select Class"}),A.map(W=>e.jsx("option",{value:W.id,children:W.class_name||W.name},W.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Subject * (",N.length," available)"]}),e.jsxs("select",{value:H.subject_id,onChange:W=>ae({...H,subject_id:W.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select Subject"}),N.map(W=>e.jsx("option",{value:W.id,children:W.subject_name||W.name},W.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Exam Date *"}),e.jsx("input",{type:"date",value:H.exam_date,onChange:W=>ae({...H,exam_date:W.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Time"}),e.jsx("input",{type:"time",value:H.start_time,onChange:W=>ae({...H,start_time:W.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Time"}),e.jsx("input",{type:"time",value:H.end_time,onChange:W=>ae({...H,end_time:W.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Duration (mins)"}),e.jsx("input",{type:"number",value:H.duration_minutes,onChange:W=>ae({...H,duration_minutes:W.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Marks"}),e.jsx("input",{type:"number",value:H.max_marks,onChange:W=>ae({...H,max_marks:W.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pass Marks"}),e.jsx("input",{type:"number",value:H.pass_marks,onChange:W=>ae({...H,pass_marks:W.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Instructions"}),e.jsx("textarea",{value:H.instructions,onChange:W=>ae({...H,instructions:W.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",rows:2,placeholder:"Specific instructions for this exam..."})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>Q(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700",children:"Add Schedule"})]})]})]})]})})]})}function bT(){const[t,s]=h.useState([]),[a,r]=h.useState(null),[l,c]=h.useState([]),[o,m]=h.useState([]),[u,x]=h.useState([]),[A,g]=h.useState([]),[N,f]=h.useState([]),[y,v]=h.useState([]),[U,D]=h.useState([]),[M,K]=h.useState([]),[$,P]=h.useState([]),[se,z]=h.useState(!0),[R,j]=h.useState("courses"),[T,Q]=h.useState(!1),[E,te]=h.useState("course"),[C,O]=h.useState(null),[V,re]=h.useState(""),[ge,xe]=h.useState("all"),[Z,I]=h.useState(null),[H,ae]=h.useState({course_code:"",course_name:"",category_id:"",subject_id:"",class_id:"",teacher_id:"",description:"",duration_weeks:"",status:"draft"}),[k,B]=h.useState({lesson_title:"",lesson_order:1,lesson_type:"text",content:"",video_url:"",duration_minutes:30,is_free:!1,status:"draft"}),[w,oe]=h.useState({assignment_title:"",description:"",instructions:"",max_marks:100,due_date:"",allow_late_submission:!1,late_penalty_percentage:0,status:"draft"}),[ne,Fe]=h.useState({quiz_title:"",description:"",duration_minutes:30,max_attempts:1,pass_percentage:50,show_correct_answers:!0,randomize_questions:!1,status:"draft"}),[je,Ge]=h.useState({marks_obtained:"",feedback:""});h.useEffect(()=>{ze(),Xe(),st(),ce()},[]);const ze=async()=>{try{const Ue=await F.get(`${ee}/lms.php?resource=courses`);s(Ue.data.courses||[])}catch(Ue){console.error("Error:",Ue)}finally{z(!1)}},Xe=async()=>{try{const Ue=await F.get(`${ee}/classes.php`);v(Ue.data.classes||[])}catch(Ue){console.error("Error:",Ue)}},st=async()=>{try{const Ue=await F.get(`${ee}/subjects.php`);D(Ue.data.subjects||[])}catch(Ue){console.error("Error:",Ue)}},ce=async()=>{try{const Ue=await F.get(`${ee}/teachers.php`);K(Ue.data.teachers||[])}catch(Ue){console.error("Error:",Ue)}},_e=async Ue=>{try{const Ct=await F.get(`${ee}/students.php?class_id=${Ue}`);P(Ct.data.students||[])}catch(Ct){console.error("Error:",Ct)}},le=async Ue=>{try{const Ct=await F.get(`${ee}/lms.php?resource=lessons&action=by_course&course_id=${Ue}`);c(Ct.data.lessons||[])}catch(Ct){console.error("Error:",Ct)}},Pe=async Ue=>{try{const Ct=await F.get(`${ee}/lms.php?resource=assignments&action=by_course&course_id=${Ue}`);m(Ct.data.assignments||[])}catch(Ct){console.error("Error:",Ct)}},we=async Ue=>{try{const Ct=await F.get(`${ee}/lms.php?resource=quizzes&action=by_course&course_id=${Ue}`);x(Ct.data.quizzes||[])}catch(Ct){console.error("Error:",Ct)}},fe=async Ue=>{try{const Ct=await F.get(`${ee}/lms.php?resource=enrollments&action=by_course&course_id=${Ue}`);g(Ct.data.enrollments||[])}catch(Ct){console.error("Error:",Ct)}},ye=async Ue=>{try{const Ct=await F.get(`${ee}/lms.php?resource=submissions&action=by_assignment&assignment_id=${Ue}`);f(Ct.data.submissions||[])}catch(Ct){console.error("Error:",Ct)}},Ke=async Ue=>{Ue.preventDefault();try{await F.post(`${ee}/lms.php?resource=courses`,H),alert(" Course created!"),Q(!1),ze(),W()}catch{alert("Failed to create course")}},ve=async Ue=>{Ue.preventDefault();try{await F.put(`${ee}/lms.php?resource=courses&id=${C.id}`,H),alert(" Course updated!"),Q(!1),ze(),O(null)}catch{alert("Failed to update course")}},ie=async Ue=>{if(confirm("Delete this course?"))try{await F.delete(`${ee}/lms.php?resource=courses&id=${Ue}`),ze(),a?.id===Ue&&(r(null),j("courses"))}catch{alert("Failed to delete")}},q=Ue=>{r(Ue),le(Ue.id),Pe(Ue.id),we(Ue.id),fe(Ue.id),Ue.class_id&&_e(Ue.class_id),j("lessons")},pe=async Ue=>{Ue.preventDefault();try{await F.post(`${ee}/lms.php?resource=lessons`,{...k,course_id:a.id}),alert(" Lesson created!"),Q(!1),le(a.id),Ie()}catch{alert("Failed to create lesson")}},Me=async Ue=>{Ue.preventDefault();try{await F.put(`${ee}/lms.php?resource=lessons&id=${C.id}`,k),alert(" Lesson updated!"),Q(!1),le(a.id),O(null)}catch{alert("Failed to update lesson")}},Se=async Ue=>{if(confirm("Delete this lesson?"))try{await F.delete(`${ee}/lms.php?resource=lessons&id=${Ue}`),le(a.id)}catch{alert("Failed to delete")}},Ne=async Ue=>{Ue.preventDefault();try{await F.post(`${ee}/lms.php?resource=assignments`,{...w,course_id:a.id,class_id:a.class_id}),alert(" Assignment created!"),Q(!1),Pe(a.id),mt()}catch{alert("Failed to create assignment")}},et=async Ue=>{try{await F.put(`${ee}/lms.php?resource=submissions&id=${Ue}&action=grade`,je),alert(" Graded!"),ye(Z.id),Ge({marks_obtained:"",feedback:""})}catch{alert("Failed to grade")}},Ce=async Ue=>{Ue.preventDefault();try{await F.post(`${ee}/lms.php?resource=quizzes`,{...ne,course_id:a.id}),alert(" Quiz created!"),Q(!1),we(a.id),pt()}catch{alert("Failed to create quiz")}},ft=async Ue=>{try{await F.post(`${ee}/lms.php?resource=enrollments`,{course_id:a.id,student_id:Ue}),alert(" Enrolled!"),fe(a.id)}catch{alert("Failed to enroll")}},qe=async()=>{if(!a.class_id){alert("Course not assigned to a class");return}if(confirm("Enroll all students from class?")){for(const Ue of $)await F.post(`${ee}/lms.php?resource=enrollments`,{course_id:a.id,student_id:Ue.id}).catch(()=>{});alert(" Enrolled!"),fe(a.id)}},W=()=>ae({course_code:"",course_name:"",category_id:"",subject_id:"",class_id:"",teacher_id:"",description:"",duration_weeks:"",status:"draft"}),Ie=()=>B({lesson_title:"",lesson_order:l.length+1,lesson_type:"text",content:"",video_url:"",duration_minutes:30,is_free:!1,status:"draft"}),mt=()=>oe({assignment_title:"",description:"",instructions:"",max_marks:100,due_date:"",allow_late_submission:!1,late_penalty_percentage:0,status:"draft"}),pt=()=>Fe({quiz_title:"",description:"",duration_minutes:30,max_attempts:1,pass_percentage:50,show_correct_answers:!0,randomize_questions:!1,status:"draft"}),kt=()=>{O(null),W(),te("course"),Q(!0)},J=Ue=>{O(Ue),ae({...Ue,course_code:Ue.course_code||"",course_name:Ue.course_name||"",description:Ue.description||"",status:Ue.status||"draft"}),te("course"),Q(!0)},Je=()=>{O(null),Ie(),te("lesson"),Q(!0)},_t=Ue=>{O(Ue),B({...Ue}),te("lesson"),Q(!0)},$t=()=>{O(null),mt(),te("assignment"),Q(!0)},me=()=>{O(null),pt(),te("quiz"),Q(!0)},Ze=Ue=>{I(Ue),ye(Ue.id),te("submissions"),Q(!0)},ct=()=>{te("enroll"),Q(!0)},Yt=t.filter(Ue=>{const Ct=Ue.course_name?.toLowerCase().includes(V.toLowerCase())||Ue.course_code?.toLowerCase().includes(V.toLowerCase()),Et=ge==="all"||Ue.status===ge;return Ct&&Et}),be=Ue=>Ue==="video"?e.jsx(al,{className:"text-purple-600",size:20}):Ue==="document"?e.jsx(Kt,{className:"text-orange-600",size:20}):e.jsx(as,{className:"text-blue-600",size:20}),lt=Ue=>({draft:"bg-gray-100 text-gray-800",published:"bg-green-100 text-green-800",active:"bg-blue-100 text-blue-800",completed:"bg-purple-100 text-purple-800",graded:"bg-green-100 text-green-800",submitted:"bg-yellow-100 text-yellow-800"})[Ue]||"bg-gray-100 text-gray-800";return se?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Learning Management System"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage courses, lessons, assignments, and quizzes"})]}),e.jsxs("button",{onClick:kt,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:20})," Create Course"]})]}),a&&e.jsxs("div",{className:"flex items-center gap-2 text-sm mb-4 bg-gray-50 px-4 py-2 rounded-lg",children:[e.jsx("button",{onClick:()=>{r(null),j("courses")},className:"text-blue-600 hover:underline",children:"All Courses"}),e.jsx(cr,{size:16,className:"text-gray-400"}),e.jsx("span",{className:"font-medium",children:a.course_name})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-blue-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Courses"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:t.length})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-green-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Published"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:t.filter(Ue=>Ue.status==="published").length})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-purple-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Lessons"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:a?l.length:"-"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-orange-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Assignments"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:a?o.length:"-"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-pink-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Quizzes"}),e.jsx("p",{className:"text-2xl font-bold text-pink-600",children:a?u.length:"-"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-cyan-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Enrolled"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-600",children:a?A.length:"-"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"border-b overflow-x-auto",children:e.jsxs("div",{className:"flex",children:[e.jsxs("button",{onClick:()=>{j("courses"),r(null)},className:`px-6 py-4 font-medium whitespace-nowrap flex items-center gap-2 ${R==="courses"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600"}`,children:[e.jsx(as,{size:18})," Courses"]}),a&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>j("lessons"),className:`px-6 py-4 font-medium whitespace-nowrap flex items-center gap-2 ${R==="lessons"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600"}`,children:[e.jsx(al,{size:18})," Lessons"]}),e.jsxs("button",{onClick:()=>j("assignments"),className:`px-6 py-4 font-medium whitespace-nowrap flex items-center gap-2 ${R==="assignments"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600"}`,children:[e.jsx(Di,{size:18})," Assignments"]}),e.jsxs("button",{onClick:()=>j("quizzes"),className:`px-6 py-4 font-medium whitespace-nowrap flex items-center gap-2 ${R==="quizzes"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600"}`,children:[e.jsx(Ac,{size:18})," Quizzes"]}),e.jsxs("button",{onClick:()=>j("enrollments"),className:`px-6 py-4 font-medium whitespace-nowrap flex items-center gap-2 ${R==="enrollments"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600"}`,children:[e.jsx(Rt,{size:18})," Enrollments"]})]})]})}),e.jsxs("div",{className:"p-6",children:[R==="courses"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"Search courses...",value:V,onChange:Ue=>re(Ue.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg"})]}),e.jsxs("select",{value:ge,onChange:Ue=>xe(Ue.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"published",children:"Published"})]})]}),Yt.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(as,{className:"mx-auto text-gray-300",size:48}),e.jsx("p",{className:"text-gray-500 mt-4",children:"No courses found"}),e.jsx("button",{onClick:kt,className:"mt-4 text-blue-600 hover:underline",children:"Create your first course"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Yt.map(Ue=>e.jsxs("div",{className:"border rounded-lg p-6 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:e.jsx(as,{className:"text-blue-600",size:24})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${lt(Ue.status)}`,children:Ue.status}),e.jsx("button",{onClick:()=>J(Ue),className:"p-1 hover:bg-gray-100 rounded",children:e.jsx(ll,{size:16,className:"text-gray-500"})}),e.jsx("button",{onClick:()=>ie(Ue.id),className:"p-1 hover:bg-red-50 rounded",children:e.jsx(us,{size:16,className:"text-red-500"})})]})]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:Ue.course_name}),e.jsx("p",{className:"text-sm text-gray-500 mb-2",children:Ue.course_code}),e.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:Ue.description||"No description"}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-4",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Rt,{size:16})," ",Ue.student_count||0]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(al,{size:16})," ",Ue.lesson_count||0," lessons"]})]}),Ue.teacher_name&&e.jsxs("p",{className:"text-xs text-gray-500 mb-3",children:[e.jsx(Qs,{size:14,className:"inline mr-1"}),Ue.teacher_name]}),e.jsxs("button",{onClick:()=>q(Ue),className:"w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 flex items-center justify-center gap-2",children:[e.jsx(na,{size:18})," View Course"]})]},Ue.id))})]}),R==="lessons"&&a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-xl font-semibold",children:["Lessons (",l.length,")"]}),e.jsxs("button",{onClick:Je,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," Add Lesson"]})]}),l.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx(al,{className:"mx-auto text-gray-300",size:48}),e.jsx("p",{className:"text-gray-500 mt-4",children:"No lessons yet"})]}):e.jsx("div",{className:"space-y-3",children:l.map((Ue,Ct)=>e.jsxs("div",{className:"border rounded-lg p-4 flex items-start gap-4 hover:bg-gray-50",children:[e.jsx("div",{className:"bg-purple-100 p-3 rounded-lg",children:be(Ue.lesson_type)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-500",children:["Lesson ",Ue.lesson_order||Ct+1]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${lt(Ue.status)}`,children:Ue.status}),Ue.is_free&&e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-yellow-100 text-yellow-800",children:"Free"})]}),e.jsx("h4",{className:"font-semibold text-gray-900",children:Ue.lesson_title}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Wt,{size:14})," ",Ue.duration_minutes," mins"]}),e.jsx("span",{className:"capitalize",children:Ue.lesson_type}),Ue.video_url&&e.jsxs("a",{href:Ue.video_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline flex items-center gap-1",children:[e.jsx(Qi,{size:14})," Watch"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>_t(Ue),className:"p-2 hover:bg-gray-200 rounded",children:e.jsx(ll,{size:16,className:"text-gray-500"})}),e.jsx("button",{onClick:()=>Se(Ue.id),className:"p-2 hover:bg-red-50 rounded",children:e.jsx(us,{size:16,className:"text-red-500"})})]})]},Ue.id))})]}),R==="assignments"&&a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-xl font-semibold",children:["Assignments (",o.length,")"]}),e.jsxs("button",{onClick:$t,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," Create Assignment"]})]}),o.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx(Di,{className:"mx-auto text-gray-300",size:48}),e.jsx("p",{className:"text-gray-500 mt-4",children:"No assignments yet"})]}):e.jsx("div",{className:"space-y-3",children:o.map(Ue=>e.jsx("div",{className:"border rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:Ue.assignment_title}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${lt(Ue.status)}`,children:Ue.status})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:Ue.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Is,{size:14})," Max: ",Ue.max_marks]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ot,{size:14})," Due: ",Ue.due_date||"Not set"]}),Ue.allow_late_submission&&e.jsxs("span",{className:"text-orange-600",children:["Late: -",Ue.late_penalty_percentage,"%"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Kt,{size:14})," ",Ue.submission_count||0," submissions"]})]})]}),e.jsx("button",{onClick:()=>Ze(Ue),className:"px-3 py-2 bg-blue-100 text-blue-700 rounded hover:bg-blue-200 text-sm",children:"View Submissions"})]})},Ue.id))})]}),R==="quizzes"&&a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-xl font-semibold",children:["Quizzes (",u.length,")"]}),e.jsxs("button",{onClick:me,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," Create Quiz"]})]}),u.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx(Ac,{className:"mx-auto text-gray-300",size:48}),e.jsx("p",{className:"text-gray-500 mt-4",children:"No quizzes yet"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:u.map(Ue=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"bg-pink-100 p-2 rounded-lg",children:e.jsx(Ac,{className:"text-pink-600",size:20})}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${lt(Ue.status)}`,children:Ue.status})]}),e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:Ue.quiz_title}),e.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:Ue.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm text-gray-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Wt,{size:14})," ",Ue.duration_minutes," mins"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ns,{size:14})," ",Ue.max_attempts," attempts"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(gy,{size:14})," Pass: ",Ue.pass_percentage,"%"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ay,{size:14})," ",Ue.question_count||0," questions"]})]})]},Ue.id))})]}),R==="enrollments"&&a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-xl font-semibold",children:["Enrolled Students (",A.length,")"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:qe,className:"px-4 py-2 border border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 flex items-center gap-2",children:[e.jsx(Rt,{size:18})," Bulk Enroll"]}),e.jsxs("button",{onClick:ct,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," Enroll"]})]})]}),A.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx(Rt,{className:"mx-auto text-gray-300",size:48}),e.jsx("p",{className:"text-gray-500 mt-4",children:"No students enrolled"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Student"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Progress"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:A.map(Ue=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:Ue.student_name}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:Ue.student_number}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${Ue.completion_percentage||0}%`}})}),e.jsxs("span",{className:"text-sm",children:[Ue.completion_percentage||0,"%"]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${lt(Ue.status)}`,children:Ue.status})})]},Ue.id))})]})})]})]})]}),T&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b sticky top-0 bg-white flex justify-between items-center",children:[e.jsxs("h2",{className:"text-xl font-bold",children:[E==="course"&&(C?"Edit Course":"Create Course"),E==="lesson"&&(C?"Edit Lesson":"Add Lesson"),E==="assignment"&&"Create Assignment",E==="quiz"&&"Create Quiz",E==="submissions"&&`Submissions: ${Z?.assignment_title}`,E==="enroll"&&"Enroll Student"]}),e.jsx("button",{onClick:()=>Q(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{size:20})})]}),e.jsxs("div",{className:"p-6",children:[E==="course"&&e.jsxs("form",{onSubmit:C?ve:Ke,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Course Code *"}),e.jsx("input",{type:"text",value:H.course_code,onChange:Ue=>ae({...H,course_code:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Duration (weeks)"}),e.jsx("input",{type:"number",value:H.duration_weeks,onChange:Ue=>ae({...H,duration_weeks:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Course Name *"}),e.jsx("input",{type:"text",value:H.course_name,onChange:Ue=>ae({...H,course_name:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Class"}),e.jsxs("select",{value:H.class_id,onChange:Ue=>ae({...H,class_id:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Select"}),y.map(Ue=>e.jsx("option",{value:Ue.id,children:Ue.class_name},Ue.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Subject"}),e.jsxs("select",{value:H.subject_id,onChange:Ue=>ae({...H,subject_id:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Select"}),U.map(Ue=>e.jsx("option",{value:Ue.id,children:Ue.subject_name},Ue.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Teacher"}),e.jsxs("select",{value:H.teacher_id,onChange:Ue=>ae({...H,teacher_id:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Select"}),M.map(Ue=>e.jsxs("option",{value:Ue.id,children:[Ue.first_name," ",Ue.last_name]},Ue.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),e.jsx("textarea",{value:H.description,onChange:Ue=>ae({...H,description:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),e.jsxs("select",{value:H.status,onChange:Ue=>ae({...H,status:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"published",children:"Published"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>Q(!1),className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:C?"Update":"Create"})]})]}),E==="lesson"&&e.jsxs("form",{onSubmit:C?Me:pe,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Order"}),e.jsx("input",{type:"number",value:k.lesson_order,onChange:Ue=>B({...k,lesson_order:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2",min:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Duration (mins)"}),e.jsx("input",{type:"number",value:k.duration_minutes,onChange:Ue=>B({...k,duration_minutes:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Title *"}),e.jsx("input",{type:"text",value:k.lesson_title,onChange:Ue=>B({...k,lesson_title:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Type"}),e.jsxs("select",{value:k.lesson_type,onChange:Ue=>B({...k,lesson_type:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"text",children:"Text"}),e.jsx("option",{value:"video",children:"Video"}),e.jsx("option",{value:"document",children:"Document"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),e.jsxs("select",{value:k.status,onChange:Ue=>B({...k,status:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"published",children:"Published"})]})]})]}),k.lesson_type==="video"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Video URL"}),e.jsx("input",{type:"url",value:k.video_url,onChange:Ue=>B({...k,video_url:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"https://..."})]}),k.lesson_type==="text"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Content"}),e.jsx("textarea",{value:k.content,onChange:Ue=>B({...k,content:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:5})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"is_free",checked:k.is_free,onChange:Ue=>B({...k,is_free:Ue.target.checked}),className:"rounded"}),e.jsx("label",{htmlFor:"is_free",className:"text-sm",children:"Free Preview"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>Q(!1),className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:C?"Update":"Add"})]})]}),E==="assignment"&&e.jsxs("form",{onSubmit:Ne,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Title *"}),e.jsx("input",{type:"text",value:w.assignment_title,onChange:Ue=>oe({...w,assignment_title:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),e.jsx("textarea",{value:w.description,onChange:Ue=>oe({...w,description:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Instructions"}),e.jsx("textarea",{value:w.instructions,onChange:Ue=>oe({...w,instructions:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Max Marks"}),e.jsx("input",{type:"number",value:w.max_marks,onChange:Ue=>oe({...w,max_marks:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Due Date"}),e.jsx("input",{type:"date",value:w.due_date,onChange:Ue=>oe({...w,due_date:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"allow_late",checked:w.allow_late_submission,onChange:Ue=>oe({...w,allow_late_submission:Ue.target.checked}),className:"rounded"}),e.jsx("label",{htmlFor:"allow_late",className:"text-sm",children:"Allow late"})]}),w.allow_late_submission&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm",children:"Penalty:"}),e.jsx("input",{type:"number",value:w.late_penalty_percentage,onChange:Ue=>oe({...w,late_penalty_percentage:Ue.target.value}),className:"w-20 border rounded-lg px-2 py-1"}),e.jsx("span",{className:"text-sm",children:"%"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),e.jsxs("select",{value:w.status,onChange:Ue=>oe({...w,status:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"published",children:"Published"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>Q(!1),className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Create"})]})]}),E==="quiz"&&e.jsxs("form",{onSubmit:Ce,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Title *"}),e.jsx("input",{type:"text",value:ne.quiz_title,onChange:Ue=>Fe({...ne,quiz_title:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),e.jsx("textarea",{value:ne.description,onChange:Ue=>Fe({...ne,description:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Duration (mins)"}),e.jsx("input",{type:"number",value:ne.duration_minutes,onChange:Ue=>Fe({...ne,duration_minutes:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Max Attempts"}),e.jsx("input",{type:"number",value:ne.max_attempts,onChange:Ue=>Fe({...ne,max_attempts:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2",min:"1"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Pass %"}),e.jsx("input",{type:"number",value:ne.pass_percentage,onChange:Ue=>Fe({...ne,pass_percentage:Ue.target.value}),className:"w-full border rounded-lg px-3 py-2",min:"0",max:"100"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"show_ans",checked:ne.show_correct_answers,onChange:Ue=>Fe({...ne,show_correct_answers:Ue.target.checked}),className:"rounded"}),e.jsx("label",{htmlFor:"show_ans",className:"text-sm",children:"Show correct answers"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"randomize",checked:ne.randomize_questions,onChange:Ue=>Fe({...ne,randomize_questions:Ue.target.checked}),className:"rounded"}),e.jsx("label",{htmlFor:"randomize",className:"text-sm",children:"Randomize questions"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>Q(!1),className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Create"})]})]}),E==="submissions"&&e.jsx("div",{className:"space-y-4",children:N.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Kt,{className:"mx-auto text-gray-300",size:48}),e.jsx("p",{className:"text-gray-500 mt-4",children:"No submissions"})]}):N.map(Ue=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:Ue.student_name}),e.jsx("p",{className:"text-sm text-gray-500",children:Ue.student_number})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${lt(Ue.status)}`,children:Ue.status})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:Ue.submission_text||"No text"}),e.jsxs("p",{className:"text-xs text-gray-500 mb-3",children:["Submitted: ",Ue.submitted_at," ",Ue.is_late&&e.jsx("span",{className:"text-red-500",children:"(Late)"})]}),Ue.status!=="graded"?e.jsxs("div",{className:"flex gap-2 items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs",children:"Marks"}),e.jsx("input",{type:"number",value:je.marks_obtained,onChange:Ct=>Ge({...je,marks_obtained:Ct.target.value}),className:"w-full border rounded px-2 py-1",max:Z?.max_marks})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs",children:"Feedback"}),e.jsx("input",{type:"text",value:je.feedback,onChange:Ct=>Ge({...je,feedback:Ct.target.value}),className:"w-full border rounded px-2 py-1"})]}),e.jsx("button",{onClick:()=>et(Ue.id),className:"bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700",children:"Grade"})]}):e.jsxs("div",{className:"bg-green-50 p-2 rounded",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Marks:"})," ",Ue.marks_obtained,"/",Z?.max_marks]}),Ue.feedback&&e.jsx("p",{className:"text-sm text-gray-600",children:Ue.feedback})]})]},Ue.id))}),E==="enroll"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Select students to enroll in this course:"}),$.length===0?e.jsx("p",{className:"text-center py-4 text-gray-500",children:"No students in assigned class"}):e.jsx("div",{className:"max-h-64 overflow-y-auto space-y-2",children:$.filter(Ue=>!A.find(Ct=>Ct.student_id===Ue.id)).map(Ue=>e.jsxs("div",{className:"flex justify-between items-center p-2 border rounded hover:bg-gray-50",children:[e.jsxs("span",{children:[Ue.first_name," ",Ue.last_name," (",Ue.student_id,")"]}),e.jsx("button",{onClick:()=>ft(Ue.id),className:"text-blue-600 hover:underline text-sm",children:"Enroll"})]},Ue.id))})]})]})]})})]})}function yT(){const[t,s]=h.useState(null),[a,r]=h.useState(!0),[l,c]=h.useState("overview"),[o,m]=h.useState({distribution:[],performance:[],atRisk:[],gradeDistribution:[],progress:[]}),[u,x]=h.useState({trends:[],collection:[],paymentMethods:[],projections:[],collectionRate:0}),[A,g]=h.useState({trends:[],byClass:[],absentees:[],patterns:[],weekday:[]}),[N,f]=h.useState({trends:[],subjectPerformance:[],gradeBreakdown:[],classRankings:[]}),[y,v]=h.useState({workload:[],performance:[],studentOutcomes:[]}),[U,D]=h.useState({results:[],filters:{class_id:"",status:"",date_from:"",date_to:""}}),[M,K]=h.useState([]),[$,P]=h.useState([]),[se,z]=h.useState(!1),[R,j]=h.useState(""),[T,Q]=h.useState(""),[E,te]=h.useState(""),[C,O]=h.useState("2024/2025"),[V,re]=h.useState(!1),[ge,xe]=h.useState(null),[Z,I]=h.useState(!1),[H,ae]=h.useState(!1),[k,B]=h.useState(!1),[w,oe]=h.useState({revenue_target:5e5,attendance_target:90,collection_rate_target:85,pass_rate_target:80}),[ne,Fe]=h.useState([]),[je,Ge]=h.useState([]),[ze,Xe]=h.useState(!1),st=h.useRef(null),[ce,_e]=h.useState(null),[le,Pe]=h.useState(!1),we=["2022/2023","2023/2024","2024/2025","2025/2026"];h.useEffect(()=>{ie(),qe(),ve(),fe()},[]),h.useEffect(()=>{l!=="overview"&&pe(l)},[l,R,T,E,C]),h.useEffect(()=>(ze?st.current=setInterval(()=>{ie(),l!=="overview"&&pe(l)},6e4):st.current&&clearInterval(st.current),()=>{st.current&&clearInterval(st.current)}),[ze,l]),h.useEffect(()=>{Ke()},[t,u,A]);const fe=()=>{const J=localStorage.getItem("analytics_kpi_targets");J&&oe(JSON.parse(J));const Je=localStorage.getItem("analytics_scheduled_reports");Je&&Ge(JSON.parse(Je))},ye=()=>{localStorage.setItem("analytics_kpi_targets",JSON.stringify(w)),I(!1),alert("KPI targets saved!")},Ke=()=>{const J=[];if(t){const Je=t.revenue_ytd/(t.revenue_ytd+t.overdue_amount)*100;Je<w.collection_rate_target&&J.push({type:"warning",message:`Collection rate (${Je.toFixed(1)}%) below target (${w.collection_rate_target}%)`}),parseFloat(t.avg_attendance_30days)<w.attendance_target&&J.push({type:"warning",message:`Attendance (${t.avg_attendance_30days}%) below target (${w.attendance_target}%)`})}Fe(J)},ve=async()=>{try{const J=await F.get(`${ee}/terms.php`);P(J.data.terms||[])}catch(J){console.error(J)}},ie=async()=>{try{const J=await F.get(`${ee}/analytics.php?resource=overview`);J.data.success&&s(J.data.overview)}catch(J){console.error("Error fetching overview:",J)}finally{r(!1)}},q=()=>{const J=new URLSearchParams;return R&&J.append("date_from",R),T&&J.append("date_to",T),E&&J.append("term_id",E),C&&J.append("academic_year",C),J.toString()?`&${J.toString()}`:""},pe=async J=>{z(!0);const Je=q();try{if(J==="students"){const[_t,$t,me,Ze]=await Promise.all([F.get(`${ee}/analytics.php?resource=students&action=by_class${Je}`),F.get(`${ee}/analytics.php?resource=students&action=performance${Je}`),F.get(`${ee}/analytics.php?resource=students&action=at_risk${Je}`),F.get(`${ee}/analytics.php?resource=students&action=grade_distribution${Je}`)]);m({distribution:_t.data.distribution||[],performance:$t.data.performance||[],atRisk:me.data.at_risk_students||[],gradeDistribution:Ze.data.grade_distribution||[],progress:[]})}else if(J==="finance"){const[_t,$t,me,Ze]=await Promise.all([F.get(`${ee}/analytics.php?resource=finance&action=revenue_trends${Je}`),F.get(`${ee}/analytics.php?resource=finance&action=collection_rate${Je}`),F.get(`${ee}/analytics.php?resource=finance&action=payment_methods${Je}`),F.get(`${ee}/analytics.php?resource=finance&action=projections${Je}`)]);if(x({trends:_t.data.trends||[],collection:$t.data.collection||[],paymentMethods:me.data.payment_methods||[],projections:Ze.data.projections||[],collectionRate:$t.data.rate||0}),V)try{const ct=await F.get(`${ee}/analytics.php?resource=finance&action=comparison${Je}`);xe(ct.data.comparison||null)}catch(ct){console.error(ct)}}else if(J==="attendance"){const[_t,$t,me,Ze]=await Promise.all([F.get(`${ee}/analytics.php?resource=attendance&action=trends${Je}`),F.get(`${ee}/analytics.php?resource=attendance&action=by_class${Je}`),F.get(`${ee}/analytics.php?resource=attendance&action=chronic_absentees${Je}`),F.get(`${ee}/analytics.php?resource=attendance&action=weekday_pattern${Je}`)]);g({trends:_t.data.trends||[],byClass:$t.data.by_class||[],absentees:me.data.chronic_absentees||[],patterns:[],weekday:Ze.data.weekday_pattern||[]})}else if(J==="exams"){const[_t,$t,me,Ze]=await Promise.all([F.get(`${ee}/analytics.php?resource=exams&action=performance_trends${Je}`),F.get(`${ee}/analytics.php?resource=exams&action=subject_performance${Je}`),F.get(`${ee}/analytics.php?resource=exams&action=grade_breakdown${Je}`),F.get(`${ee}/analytics.php?resource=exams&action=class_rankings${Je}`)]);f({trends:_t.data.trends||[],subjectPerformance:$t.data.subject_performance||[],gradeBreakdown:me.data.grade_breakdown||[],classRankings:Ze.data.class_rankings||[]})}else if(J==="teachers"){const[_t,$t,me]=await Promise.all([F.get(`${ee}/analytics.php?resource=teachers&action=workload${Je}`),F.get(`${ee}/analytics.php?resource=teachers&action=performance${Je}`),F.get(`${ee}/analytics.php?resource=teachers&action=student_outcomes${Je}`)]);v({workload:_t.data.workload||[],performance:$t.data.performance||[],studentOutcomes:me.data.student_outcomes||[]})}}catch(_t){console.error(`Error loading ${J} data:`,_t)}finally{z(!1)}},Me=J=>{const Je=[...je,{...J,id:Date.now()}];Ge(Je),localStorage.setItem("analytics_scheduled_reports",JSON.stringify(Je)),B(!1),alert("Report scheduled!")},Se=J=>{const Je=je.filter(_t=>_t.id!==J);Ge(Je),localStorage.setItem("analytics_scheduled_reports",JSON.stringify(Je))},Ne=()=>{let J="",Je="";if(l==="students"&&o.distribution.length>0)J=`Class,Total,Male,Female
`+o.distribution.map(Ze=>`${Ze.class_name},${Ze.student_count},${Ze.male_count},${Ze.female_count}`).join(`
`),Je="student_distribution";else if(l==="finance"&&u.trends.length>0)J=`Month,Revenue,Payments
`+u.trends.map(Ze=>`${Ze.month},${Ze.revenue},${Ze.payment_count}`).join(`
`),Je="finance_trends";else if(l==="attendance"&&A.byClass.length>0)J=`Class,Present,Absent,Rate
`+A.byClass.map(Ze=>`${Ze.class_name},${Ze.present_count},${Ze.absent_count},${Ze.attendance_rate}%`).join(`
`),Je="attendance_by_class";else if(l==="exams"&&N.trends.length>0)J=`Exam,Students,Average,Highest,Lowest
`+N.trends.map(Ze=>`${Ze.exam_name},${Ze.student_count},${Ze.avg_percentage}%,${Ze.highest_percentage}%,${Ze.lowest_percentage}%`).join(`
`),Je="exam_performance";else{alert("No data to export");return}const _t=new Blob([J],{type:"text/csv"}),$t=URL.createObjectURL(_t),me=document.createElement("a");me.href=$t,me.download=`${Je}_${new Date().toISOString().split("T")[0]}.csv`,me.click()},et=()=>{const J=window.open("","_blank");J.document.write(`
      <html><head><title>Analytics Report - ${l}</title>
      <style>
        body { font-family: Arial, sans-serif; padding: 30px; }
        h1 { color: #1f2937; border-bottom: 2px solid #3b82f6; padding-bottom: 10px; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        th { background: #f3f4f6; }
        .stat { display: inline-block; margin: 10px; padding: 15px; background: #f0f9ff; border-radius: 8px; }
      </style></head><body>
      <h1>Analytics Report - ${l.charAt(0).toUpperCase()+l.slice(1)}</h1>
      <p>Generated: ${new Date().toLocaleString()}</p>
      ${Ce()}
      </body></html>
    `),J.document.close(),J.print()},Ce=()=>l==="overview"&&t?`
        <div class="stat"><strong>Students:</strong> ${t.total_students}</div>
        <div class="stat"><strong>Teachers:</strong> ${t.total_teachers}</div>
        <div class="stat"><strong>Revenue YTD:</strong> ${mt(t.revenue_ytd)}</div>
        <div class="stat"><strong>Attendance:</strong> ${pt(t.avg_attendance_30days)}</div>
      `:l==="students"&&o.distribution.length>0?`<table><tr><th>Class</th><th>Total</th><th>Male</th><th>Female</th></tr>
        ${o.distribution.map(J=>`<tr><td>${J.class_name}</td><td>${J.student_count}</td><td>${J.male_count}</td><td>${J.female_count}</td></tr>`).join("")}
      </table>`:l==="finance"&&u.trends.length>0?`<table><tr><th>Month</th><th>Revenue</th><th>Payments</th></tr>
        ${u.trends.map(J=>`<tr><td>${J.month}</td><td>${mt(J.revenue)}</td><td>${J.payment_count}</td></tr>`).join("")}
      </table>`:"<p>No data available</p>",ft=()=>{if(!t)return{};const J=t.revenue_ytd/(t.revenue_ytd+(t.overdue_amount||1))*100;return{revenue:{current:t.revenue_ytd,target:w.revenue_target,percent:Math.min(t.revenue_ytd/w.revenue_target*100,100)},attendance:{current:parseFloat(t.avg_attendance_30days)||0,target:w.attendance_target,percent:Math.min(parseFloat(t.avg_attendance_30days)/w.attendance_target*100,100)},collection:{current:J,target:w.collection_rate_target,percent:Math.min(J/w.collection_rate_target*100,100)}}},qe=async()=>{try{const J=await F.get(`${ee}/classes.php`);K(J.data.classes||[])}catch(J){console.error(J)}},W=async()=>{z(!0);try{const J=await F.post(`${ee}/analytics.php?resource=custom_report`,U.filters);D(Je=>({...Je,results:J.data.results||[]}))}catch(J){console.error(J)}finally{z(!1)}},Ie=async J=>{let Je=o,_t=u,$t=A,me=N,Ze=t;try{const Et=await F.get(`${ee}/analytics.php?resource=overview`);if(Et.data.success&&(Ze=Et.data.overview),J==="all"||J==="students"){const[Rs,He,Te]=await Promise.all([F.get(`${ee}/analytics.php?resource=students&action=by_class`),F.get(`${ee}/analytics.php?resource=students&action=performance`),F.get(`${ee}/analytics.php?resource=students&action=at_risk`)]);Je={distribution:Rs.data.distribution||[],performance:He.data.performance||[],atRisk:Te.data.at_risk_students||[]}}if(J==="all"||J==="finance"){const[Rs,He,Te]=await Promise.all([F.get(`${ee}/analytics.php?resource=finance&action=revenue_trends`),F.get(`${ee}/analytics.php?resource=finance&action=collection_rate`),F.get(`${ee}/analytics.php?resource=finance&action=payment_methods`)]);_t={trends:Rs.data.trends||[],collection:He.data.collection||[],paymentMethods:Te.data.payment_methods||[]}}if(J==="all"||J==="attendance"){const[Rs,He,Te]=await Promise.all([F.get(`${ee}/analytics.php?resource=attendance&action=trends`),F.get(`${ee}/analytics.php?resource=attendance&action=by_class`),F.get(`${ee}/analytics.php?resource=attendance&action=chronic_absentees`)]);$t={trends:Rs.data.trends||[],byClass:He.data.by_class||[],absentees:Te.data.chronic_absentees||[]}}(J==="all"||J==="exams")&&(me={trends:(await F.get(`${ee}/analytics.php?resource=exams&action=performance_trends`)).data.trends||[],subjectPerformance:[]})}catch(Et){console.error("Error fetching data for export:",Et)}const ct=new ms,Yt=ct.internal.pageSize.getWidth(),be=new Date().toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"});ct.setFontSize(20),ct.setTextColor(31,41,55),ct.text("Analytics Report",Yt/2,20,{align:"center"}),ct.setFontSize(12),ct.setTextColor(107,114,128),ct.text(`Generated: ${be}`,Yt/2,28,{align:"center"});let lt=40;(J==="overview"||J==="all")&&(ct.setFontSize(16),ct.setTextColor(31,41,55),ct.text("Overview Summary",14,lt),lt+=10,Ma(ct,{startY:lt,head:[["Metric","Value"]],body:[["Total Students",Ze?.total_students||0],["Total Teachers",Ze?.total_teachers||0],["Total Classes",Ze?.total_classes||0],["LMS Courses",Ze?.total_courses||0],["Revenue YTD",mt(Ze?.revenue_ytd)],["Overdue Fees",mt(Ze?.overdue_amount)],["Pending Applications",Ze?.pending_applications||0],["Avg Attendance (30 days)",pt(Ze?.avg_attendance_30days)]],theme:"striped",headStyles:{fillColor:[59,130,246]}}),lt=ct.lastAutoTable.finalY+15),(J==="students"||J==="all")&&(lt>240&&(ct.addPage(),lt=20),ct.setFontSize(16),ct.setTextColor(31,41,55),ct.text("Student Distribution by Class",14,lt),lt+=10,Je.distribution.length>0&&(Ma(ct,{startY:lt,head:[["Class","Total","Male","Female"]],body:Je.distribution.map(Et=>[Et.class_name,Et.student_count,Et.male_count,Et.female_count]),theme:"striped",headStyles:{fillColor:[34,197,94]}}),lt=ct.lastAutoTable.finalY+15),Je.atRisk.length>0&&(lt>240&&(ct.addPage(),lt=20),ct.setFontSize(14),ct.text("At-Risk Students",14,lt),lt+=8,Ma(ct,{startY:lt,head:[["Student","Class","Avg %","Attendance","Risk Reason"]],body:Je.atRisk.map(Et=>[Et.student_name,Et.class_name,pt(Et.avg_percentage),pt(Et.attendance_rate),Et.risk_reason]),theme:"striped",headStyles:{fillColor:[239,68,68]}}),lt=ct.lastAutoTable.finalY+15)),(J==="finance"||J==="all")&&(lt>240&&(ct.addPage(),lt=20),ct.setFontSize(16),ct.setTextColor(31,41,55),ct.text("Financial Analytics",14,lt),lt+=10,_t.trends.length>0&&(Ma(ct,{startY:lt,head:[["Month","Revenue","Payments"]],body:_t.trends.map(Et=>[Et.month,mt(Et.revenue),Et.payment_count]),theme:"striped",headStyles:{fillColor:[16,185,129]}}),lt=ct.lastAutoTable.finalY+15),_t.paymentMethods.length>0&&(lt>240&&(ct.addPage(),lt=20),ct.setFontSize(14),ct.text("Payment Methods",14,lt),lt+=8,Ma(ct,{startY:lt,head:[["Method","Transactions","Total Amount"]],body:_t.paymentMethods.map(Et=>[Et.payment_method?.replace("_"," ")||"Unknown",Et.transaction_count,mt(Et.total_amount)]),theme:"striped",headStyles:{fillColor:[139,92,246]}}),lt=ct.lastAutoTable.finalY+15)),(J==="attendance"||J==="all")&&(lt>240&&(ct.addPage(),lt=20),ct.setFontSize(16),ct.setTextColor(31,41,55),ct.text("Attendance Analytics",14,lt),lt+=10,$t.byClass.length>0?(Ma(ct,{startY:lt,head:[["Class","Present","Absent","Rate"]],body:$t.byClass.map(Et=>[Et.class_name,Et.present_count,Et.absent_count,pt(Et.attendance_rate)]),theme:"striped",headStyles:{fillColor:[168,85,247]}}),lt=ct.lastAutoTable.finalY+15):(ct.setFontSize(11),ct.setTextColor(107,114,128),ct.text("No attendance data available for the last 30 days.",14,lt),lt+=15)),(J==="exams"||J==="all")&&(lt>240&&(ct.addPage(),lt=20),ct.setFontSize(16),ct.setTextColor(31,41,55),ct.text("Exam Performance",14,lt),lt+=10,me.trends.length>0?Ma(ct,{startY:lt,head:[["Exam","Students","Avg %","Highest","Lowest"]],body:me.trends.map(Et=>[Et.exam_name,Et.student_count,pt(Et.avg_percentage),pt(Et.highest_percentage),pt(Et.lowest_percentage)]),theme:"striped",headStyles:{fillColor:[249,115,22]}}):(ct.setFontSize(11),ct.setTextColor(107,114,128),ct.text("No exam performance data available.",14,lt)));const Ue=ct.internal.getNumberOfPages();for(let Et=1;Et<=Ue;Et++)ct.setPage(Et),ct.setFontSize(10),ct.setTextColor(156,163,175),ct.text(`Page ${Et} of ${Ue}`,Yt/2,ct.internal.pageSize.getHeight()-10,{align:"center"});const Ct=J==="all"?"analytics_full_report":`analytics_${J}`;ct.save(`${Ct}_${new Date().toISOString().split("T")[0]}.pdf`)},mt=J=>`GHS ${(parseFloat(J)||0).toLocaleString()}`,pt=J=>`${(parseFloat(J)||0).toFixed(1)}%`;if(a)return e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx(Ns,{className:"w-8 h-8 animate-spin text-blue-600"}),e.jsx("span",{className:"ml-2 text-lg",children:"Loading analytics..."})]});const kt=ft();return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-start gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Advanced Analytics"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive insights, predictions, and KPI tracking"}),ne.length>0&&e.jsx("div",{className:"mt-2 flex gap-2",children:ne.map((J,Je)=>e.jsxs("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm flex items-center gap-1",children:[e.jsx(_s,{size:14})," ",J.message]},Je))})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>Xe(!ze),className:`flex items-center gap-2 px-3 py-2 rounded-lg ${ze?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,title:"Auto-refresh",children:[ze?e.jsx(fg,{size:16}):e.jsx(Qi,{size:16}),ze?"Auto":"Manual"]}),e.jsxs("button",{onClick:()=>I(!0),className:"flex items-center gap-2 px-3 py-2 bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200",title:"KPI Targets",children:[e.jsx(Ln,{size:16})," Targets"]}),e.jsxs("button",{onClick:()=>B(!0),className:"flex items-center gap-2 px-3 py-2 bg-orange-100 text-orange-700 rounded-lg hover:bg-orange-200",title:"Schedule Reports",children:[e.jsx(ra,{size:16})," Schedule"]}),e.jsxs("button",{onClick:et,className:"flex items-center gap-2 px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:[e.jsx(or,{size:16})," Print"]}),e.jsxs("button",{onClick:Ne,className:"flex items-center gap-2 px-3 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200",children:[e.jsx(xs,{size:16})," Excel"]}),e.jsxs("button",{onClick:()=>Ie(l),className:"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(Kt,{size:16})," PDF"]}),e.jsx("button",{onClick:()=>{ie(),l!=="overview"&&pe(l)},className:"flex items-center gap-2 px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:e.jsx(Ns,{size:16})})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ot,{size:18,className:"text-gray-500"}),e.jsx("input",{type:"date",value:R,onChange:J=>j(J.target.value),className:"border rounded px-3 py-1.5 text-sm"}),e.jsx("span",{className:"text-gray-400",children:"to"}),e.jsx("input",{type:"date",value:T,onChange:J=>Q(J.target.value),className:"border rounded px-3 py-1.5 text-sm"})]}),e.jsxs("select",{value:E,onChange:J=>te(J.target.value),className:"border rounded px-3 py-1.5 text-sm",children:[e.jsx("option",{value:"",children:"All Terms"}),$.map(J=>e.jsx("option",{value:J.id,children:J.term_name},J.id))]}),e.jsx("select",{value:C,onChange:J=>O(J.target.value),className:"border rounded px-3 py-1.5 text-sm",children:we.map(J=>e.jsx("option",{value:J,children:J},J))}),e.jsxs("button",{onClick:()=>re(!V),className:`flex items-center gap-2 px-3 py-1.5 rounded text-sm ${V?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-600"}`,children:[e.jsx(tk,{size:16})," Compare"]}),e.jsx("button",{onClick:()=>{j(""),Q(""),te("")},className:"text-sm text-gray-500 hover:text-gray-700",children:"Clear Filters"})]})}),t&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Revenue vs Target"}),e.jsxs("span",{className:`text-sm font-medium ${kt.revenue?.percent>=100?"text-green-600":"text-orange-600"}`,children:[kt.revenue?.percent?.toFixed(0),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full ${kt.revenue?.percent>=100?"bg-green-500":kt.revenue?.percent>=70?"bg-yellow-500":"bg-red-500"}`,style:{width:`${kt.revenue?.percent||0}%`}})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[mt(kt.revenue?.current)," / ",mt(kt.revenue?.target)]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Attendance vs Target"}),e.jsxs("span",{className:`text-sm font-medium ${kt.attendance?.percent>=100?"text-green-600":"text-orange-600"}`,children:[kt.attendance?.percent?.toFixed(0),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full ${kt.attendance?.percent>=100?"bg-green-500":kt.attendance?.percent>=70?"bg-yellow-500":"bg-red-500"}`,style:{width:`${kt.attendance?.percent||0}%`}})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[kt.attendance?.current?.toFixed(1),"% / ",kt.attendance?.target,"%"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Collection Rate vs Target"}),e.jsxs("span",{className:`text-sm font-medium ${kt.collection?.percent>=100?"text-green-600":"text-orange-600"}`,children:[kt.collection?.percent?.toFixed(0),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full ${kt.collection?.percent>=100?"bg-green-500":kt.collection?.percent>=70?"bg-yellow-500":"bg-red-500"}`,style:{width:`${kt.collection?.percent||0}%`}})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[kt.collection?.current?.toFixed(1),"% / ",kt.collection?.target,"%"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 p-6 rounded-lg shadow-lg text-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Rt,{size:32}),e.jsxs("div",{className:"flex items-center text-blue-200",children:[e.jsx(xy,{size:16}),e.jsx("span",{className:"text-sm",children:"Active"})]})]}),e.jsx("p",{className:"text-blue-100 text-sm",children:"Total Students"}),e.jsx("p",{className:"text-3xl font-bold",children:t?.total_students||0}),e.jsxs("p",{className:"text-blue-200 text-xs mt-1",children:[t?.total_teachers||0," Teachers  ",t?.total_classes||0," Classes"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-green-600 p-6 rounded-lg shadow-lg text-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(vs,{size:32}),e.jsx($s,{size:20,className:"text-green-200"})]}),e.jsx("p",{className:"text-green-100 text-sm",children:"Revenue YTD"}),e.jsx("p",{className:"text-3xl font-bold",children:mt(t?.revenue_ytd)}),e.jsx("p",{className:"text-green-200 text-xs mt-1",children:"Year to date collections"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 p-6 rounded-lg shadow-lg text-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Ot,{size:32}),e.jsx("span",{className:"text-purple-200 text-sm",children:"30 days"})]}),e.jsx("p",{className:"text-purple-100 text-sm",children:"Avg Attendance"}),e.jsx("p",{className:"text-3xl font-bold",children:pt(t?.avg_attendance_30days)}),e.jsx("p",{className:"text-purple-200 text-xs mt-1",children:"Last 30 days average"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 p-6 rounded-lg shadow-lg text-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(_s,{size:32}),e.jsx(uy,{size:20,className:"text-orange-200"})]}),e.jsx("p",{className:"text-orange-100 text-sm",children:"Outstanding Balance"}),e.jsx("p",{className:"text-3xl font-bold",children:mt(t?.overdue_amount)}),e.jsx("p",{className:"text-orange-200 text-xs mt-1",children:"Unpaid fees to collect"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"border-b",children:e.jsx("div",{className:"flex overflow-x-auto",children:[{id:"overview",label:"Overview",icon:Fs},{id:"students",label:"Students",icon:Qs},{id:"finance",label:"Finance",icon:vs},{id:"attendance",label:"Attendance",icon:Ot},{id:"exams",label:"Exams",icon:Is},{id:"teachers",label:"Teachers",icon:Pr},{id:"reports",label:"Custom Reports",icon:Di}].map(J=>e.jsxs("button",{onClick:()=>c(J.id),className:`flex items-center gap-2 px-6 py-3 font-medium whitespace-nowrap transition-colors ${l===J.id?"border-b-2 border-blue-600 text-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[e.jsx(J.icon,{size:18}),J.label]},J.id))})}),e.jsx("div",{className:"p-6",children:se?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(Ns,{className:"w-8 h-8 animate-spin text-blue-600"}),e.jsx("span",{className:"ml-2",children:"Loading data..."})]}):e.jsxs(e.Fragment,{children:[l==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Rt,{className:"text-blue-600"}),"Student Overview"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Total Students:"}),e.jsx("span",{className:"font-semibold text-lg",children:t?.total_students||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Active Teachers:"}),e.jsx("span",{className:"font-semibold text-lg",children:t?.total_teachers||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Active Classes:"}),e.jsx("span",{className:"font-semibold text-lg",children:t?.total_classes||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"LMS Courses:"}),e.jsx("span",{className:"font-semibold text-lg",children:t?.total_courses||0})]})]}),e.jsxs("button",{onClick:()=>c("students"),className:"mt-4 w-full flex items-center justify-center gap-2 text-blue-600 hover:text-blue-800",children:["View Details ",e.jsx(cr,{size:18})]})]}),e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(vs,{className:"text-green-600"}),"Financial Overview"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Revenue YTD:"}),e.jsx("span",{className:"font-semibold text-lg text-green-600",children:mt(t?.revenue_ytd)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Overdue Amount:"}),e.jsx("span",{className:"font-semibold text-lg text-red-600",children:mt(t?.overdue_amount)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Pending Applications:"}),e.jsx("span",{className:"font-semibold text-lg",children:t?.pending_applications||0})]})]}),e.jsxs("button",{onClick:()=>c("finance"),className:"mt-4 w-full flex items-center justify-center gap-2 text-green-600 hover:text-green-800",children:["View Details ",e.jsx(cr,{size:18})]})]})]}),e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("button",{onClick:()=>c("students"),className:"flex items-center justify-center gap-2 bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700",children:[e.jsx(Qs,{size:20}),"Student Report"]}),e.jsxs("button",{onClick:()=>c("finance"),className:"flex items-center justify-center gap-2 bg-green-600 text-white px-4 py-3 rounded-lg hover:bg-green-700",children:[e.jsx(vs,{size:20}),"Finance Report"]}),e.jsxs("button",{onClick:()=>c("attendance"),className:"flex items-center justify-center gap-2 bg-purple-600 text-white px-4 py-3 rounded-lg hover:bg-purple-700",children:[e.jsx(Ot,{size:20}),"Attendance Report"]}),e.jsxs("button",{onClick:()=>Ie("all"),className:"flex items-center justify-center gap-2 bg-gray-600 text-white px-4 py-3 rounded-lg hover:bg-gray-700",children:[e.jsx(xs,{size:20}),"Export Full PDF"]})]})]})]}),l==="students"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Gl,{className:"text-blue-600"}),"Students by Class"]}),o.distribution.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left",children:"Class"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Total"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Male"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Female"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Distribution"})]})}),e.jsx("tbody",{children:o.distribution.map((J,Je)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-4 py-2 font-medium",children:J.class_name}),e.jsx("td",{className:"px-4 py-2 text-right",children:J.student_count}),e.jsx("td",{className:"px-4 py-2 text-right text-blue-600",children:J.male_count}),e.jsx("td",{className:"px-4 py-2 text-right text-pink-600",children:J.female_count}),e.jsx("td",{className:"px-4 py-2",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"h-4 bg-blue-500 rounded",style:{width:`${J.male_count/(J.student_count||1)*100}px`}}),e.jsx("div",{className:"h-4 bg-pink-500 rounded",style:{width:`${J.female_count/(J.student_count||1)*100}px`}})]})})]},Je))})]})}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No class distribution data available"})]}),e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(_s,{className:"text-red-600"}),"At-Risk Students"]}),o.atRisk.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left",children:"Student"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Class"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Avg %"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Attendance"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Risk Reason"})]})}),e.jsx("tbody",{children:o.atRisk.map((J,Je)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-4 py-2 font-medium",children:J.student_name}),e.jsx("td",{className:"px-4 py-2",children:J.class_name}),e.jsx("td",{className:"px-4 py-2 text-right text-red-600",children:pt(J.avg_percentage)}),e.jsx("td",{className:"px-4 py-2 text-right",children:pt(J.attendance_rate)}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-700 rounded text-sm",children:J.risk_reason})})]},Je))})]})}):e.jsx("p",{className:"text-green-600 text-center py-4",children:" No at-risk students identified"})]})]}),l==="finance"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx($s,{className:"text-green-600"}),"Revenue Trends (Last 12 Months)"]}),u.trends.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left",children:"Month"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Revenue"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Payments"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Trend"})]})}),e.jsx("tbody",{children:u.trends.map((J,Je)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-4 py-2 font-medium",children:J.month}),e.jsx("td",{className:"px-4 py-2 text-right text-green-600 font-semibold",children:mt(J.revenue)}),e.jsx("td",{className:"px-4 py-2 text-right",children:J.payment_count}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("div",{className:"w-full bg-gray-200 rounded h-4",children:e.jsx("div",{className:"bg-green-500 h-4 rounded",style:{width:`${Math.min(parseFloat(J.revenue)/Math.max(...u.trends.map(_t=>parseFloat(_t.revenue)||0))*100,100)}%`}})})})]},Je))})]})}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No revenue data available"})]}),e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Gl,{className:"text-purple-600"}),"Payment Methods (Last 30 Days)"]}),u.paymentMethods.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:u.paymentMethods.map((J,Je)=>e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-gray-600 capitalize",children:J.payment_method?.replace("_"," ")||"Unknown"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:mt(J.total_amount)}),e.jsxs("p",{className:"text-sm text-gray-500",children:[J.transaction_count," transactions"]})]},Je))}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No payment method data available"})]})]}),l==="attendance"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Fs,{className:"text-purple-600"}),"Attendance by Class (Last 30 Days)"]}),A.byClass.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left",children:"Class"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Present"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Absent"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Rate"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Status"})]})}),e.jsx("tbody",{children:A.byClass.map((J,Je)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-4 py-2 font-medium",children:J.class_name}),e.jsx("td",{className:"px-4 py-2 text-right text-green-600",children:J.present_count}),e.jsx("td",{className:"px-4 py-2 text-right text-red-600",children:J.absent_count}),e.jsx("td",{className:"px-4 py-2 text-right font-semibold",children:pt(J.attendance_rate)}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("span",{className:`px-2 py-1 rounded text-sm ${parseFloat(J.attendance_rate)>=90?"bg-green-100 text-green-700":parseFloat(J.attendance_rate)>=75?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:parseFloat(J.attendance_rate)>=90?"Excellent":parseFloat(J.attendance_rate)>=75?"Good":"Needs Attention"})})]},Je))})]})}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No attendance data available"})]}),e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(_s,{className:"text-red-600"}),"Chronic Absentees (>25% absence rate)"]}),A.absentees.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left",children:"Student"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Class"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Days Absent"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Total Days"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Absence Rate"})]})}),e.jsx("tbody",{children:A.absentees.map((J,Je)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-4 py-2 font-medium",children:J.student_name}),e.jsx("td",{className:"px-4 py-2",children:J.class_name}),e.jsx("td",{className:"px-4 py-2 text-right text-red-600",children:J.absent_days}),e.jsx("td",{className:"px-4 py-2 text-right",children:J.total_days}),e.jsx("td",{className:"px-4 py-2 text-right",children:e.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-700 rounded",children:pt(J.absence_rate)})})]},Je))})]})}):e.jsx("p",{className:"text-green-600 text-center py-4",children:" No chronic absentees identified"})]})]}),l==="exams"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Is,{className:"text-orange-600"}),"Exam Performance Trends"]}),N.trends.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left",children:"Exam"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Students"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Avg %"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Highest"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Lowest"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Performance"})]})}),e.jsx("tbody",{children:N.trends.map((J,Je)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-4 py-2 font-medium",children:J.exam_name}),e.jsx("td",{className:"px-4 py-2 text-right",children:J.student_count}),e.jsx("td",{className:"px-4 py-2 text-right font-semibold",children:pt(J.avg_percentage)}),e.jsx("td",{className:"px-4 py-2 text-right text-green-600",children:pt(J.highest_percentage)}),e.jsx("td",{className:"px-4 py-2 text-right text-red-600",children:pt(J.lowest_percentage)}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("div",{className:"w-full bg-gray-200 rounded h-4",children:e.jsx("div",{className:`h-4 rounded ${parseFloat(J.avg_percentage)>=70?"bg-green-500":parseFloat(J.avg_percentage)>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(parseFloat(J.avg_percentage)||0,100)}%`}})})})]},Je))})]})}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No exam performance data available"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg",children:[e.jsx("p",{className:"text-blue-600 text-sm",children:"Total Exams"}),e.jsx("p",{className:"text-3xl font-bold text-blue-900",children:N.trends.length})]}),e.jsxs("div",{className:"bg-green-50 p-6 rounded-lg",children:[e.jsx("p",{className:"text-green-600 text-sm",children:"Overall Average"}),e.jsx("p",{className:"text-3xl font-bold text-green-900",children:N.trends.length>0?pt(N.trends.reduce((J,Je)=>J+parseFloat(Je.avg_percentage||0),0)/N.trends.length):"0%"})]}),e.jsxs("div",{className:"bg-purple-50 p-6 rounded-lg",children:[e.jsx("p",{className:"text-purple-600 text-sm",children:"Students Assessed"}),e.jsx("p",{className:"text-3xl font-bold text-purple-900",children:N.trends.reduce((J,Je)=>J+parseInt(Je.student_count||0),0)})]})]})]}),l==="teachers"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Pr,{className:"text-indigo-600"}),"Teacher Workload Analysis"]}),y.workload.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left",children:"Teacher"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Classes"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Courses"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Invigilation"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Workload"})]})}),e.jsx("tbody",{children:y.workload.map((J,Je)=>{const _t=(parseInt(J.classes_assigned)||0)+(parseInt(J.courses_assigned)||0)+(parseInt(J.invigilation_duties)||0),$t=Math.max(...y.workload.map(me=>(parseInt(me.classes_assigned)||0)+(parseInt(me.courses_assigned)||0)+(parseInt(me.invigilation_duties)||0)));return e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-4 py-2 font-medium",children:J.teacher_name}),e.jsx("td",{className:"px-4 py-2 text-right",children:J.classes_assigned||0}),e.jsx("td",{className:"px-4 py-2 text-right",children:J.courses_assigned||0}),e.jsx("td",{className:"px-4 py-2 text-right",children:J.invigilation_duties||0}),e.jsx("td",{className:"px-4 py-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 bg-gray-200 rounded h-3",children:e.jsx("div",{className:`h-3 rounded ${_t>$t*.8?"bg-red-500":_t>$t*.5?"bg-yellow-500":"bg-green-500"}`,style:{width:`${$t>0?_t/$t*100:0}%`}})}),e.jsx("span",{className:`text-xs px-2 py-1 rounded ${_t>$t*.8?"bg-red-100 text-red-700":_t>$t*.5?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:_t>$t*.8?"High":_t>$t*.5?"Medium":"Low"})]})})]},Je)})})]})}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No teacher workload data available"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-indigo-50 p-6 rounded-lg",children:[e.jsx("p",{className:"text-indigo-600 text-sm",children:"Total Teachers"}),e.jsx("p",{className:"text-3xl font-bold text-indigo-900",children:y.workload.length})]}),e.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg",children:[e.jsx("p",{className:"text-blue-600 text-sm",children:"Total Classes Assigned"}),e.jsx("p",{className:"text-3xl font-bold text-blue-900",children:y.workload.reduce((J,Je)=>J+parseInt(Je.classes_assigned||0),0)})]}),e.jsxs("div",{className:"bg-green-50 p-6 rounded-lg",children:[e.jsx("p",{className:"text-green-600 text-sm",children:"Total Courses"}),e.jsx("p",{className:"text-3xl font-bold text-green-900",children:y.workload.reduce((J,Je)=>J+parseInt(Je.courses_assigned||0),0)})]}),e.jsxs("div",{className:"bg-purple-50 p-6 rounded-lg",children:[e.jsx("p",{className:"text-purple-600 text-sm",children:"Invigilation Duties"}),e.jsx("p",{className:"text-3xl font-bold text-purple-900",children:y.workload.reduce((J,Je)=>J+parseInt(Je.invigilation_duties||0),0)})]})]})]}),l==="reports"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Ko,{className:"text-teal-600"}),"Custom Report Builder"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),e.jsxs("select",{value:U.filters.class_id,onChange:J=>D(Je=>({...Je,filters:{...Je.filters,class_id:J.target.value}})),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"All Classes"}),M.map(J=>e.jsx("option",{value:J.id,children:J.class_name},J.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:U.filters.status,onChange:J=>D(Je=>({...Je,filters:{...Je.filters,status:J.target.value}})),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"graduated",children:"Graduated"}),e.jsx("option",{value:"transferred",children:"Transferred"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{onClick:W,className:"w-full bg-teal-600 text-white px-4 py-2 rounded-lg hover:bg-teal-700 flex items-center justify-center gap-2",children:[e.jsx(Ws,{size:18}),"Generate Report"]})})]})]}),e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Kt,{className:"text-gray-600"}),"Report Results (",U.results.length," records)"]}),U.results.length>0&&e.jsxs("button",{onClick:()=>Ie("students"),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm",children:[e.jsx(xs,{size:16}),"Export PDF"]})]}),U.results.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left",children:"Student ID"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Name"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Gender"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Status"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Admission Date"})]})}),e.jsx("tbody",{children:U.results.map((J,Je)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-4 py-2 font-mono text-sm",children:J.student_id}),e.jsxs("td",{className:"px-4 py-2 font-medium",children:[J.first_name," ",J.last_name]}),e.jsx("td",{className:"px-4 py-2 capitalize",children:J.gender||"-"}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${J.status==="active"?"bg-green-100 text-green-700":J.status==="graduated"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:J.status})}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:J.admission_date?.split("T")[0]||"-"})]},Je))})]})}):e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Di,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:'Select filters and click "Generate Report" to view results'})]})]})]})]})})]}),Z&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx(Ln,{className:"text-purple-600"})," KPI Targets"]}),e.jsx("button",{onClick:()=>I(!1),children:e.jsx(Nt,{size:24})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Revenue Target (GHS)"}),e.jsx("input",{type:"number",value:w.revenue_target,onChange:J=>oe({...w,revenue_target:parseFloat(J.target.value)}),className:"w-full border rounded px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Attendance Target (%)"}),e.jsx("input",{type:"number",min:"0",max:"100",value:w.attendance_target,onChange:J=>oe({...w,attendance_target:parseFloat(J.target.value)}),className:"w-full border rounded px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Collection Rate Target (%)"}),e.jsx("input",{type:"number",min:"0",max:"100",value:w.collection_rate_target,onChange:J=>oe({...w,collection_rate_target:parseFloat(J.target.value)}),className:"w-full border rounded px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Pass Rate Target (%)"}),e.jsx("input",{type:"number",min:"0",max:"100",value:w.pass_rate_target,onChange:J=>oe({...w,pass_rate_target:parseFloat(J.target.value)}),className:"w-full border rounded px-3 py-2"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:()=>I(!1),className:"px-4 py-2 bg-gray-200 rounded-lg",children:"Cancel"}),e.jsx("button",{onClick:ye,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Save Targets"})]})]})}),k&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx(ra,{className:"text-orange-600"})," Scheduled Reports"]}),e.jsx("button",{onClick:()=>B(!1),children:e.jsx(Nt,{size:24})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Active Schedules"}),je.length===0?e.jsx("p",{className:"text-gray-500 text-sm",children:"No scheduled reports"}):e.jsx("div",{className:"space-y-2",children:je.map(J=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[J.type," Report"]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[J.frequency,"  ",J.email]})]}),e.jsx("button",{onClick:()=>Se(J.id),className:"text-red-600 hover:bg-red-50 p-2 rounded",children:e.jsx(Nt,{size:16})})]},J.id))})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"font-medium mb-3",children:"Add New Schedule"}),e.jsxs("form",{onSubmit:J=>{J.preventDefault();const Je=new FormData(J.target);Me({type:Je.get("type"),frequency:Je.get("frequency"),email:Je.get("email")})},className:"space-y-3",children:[e.jsxs("select",{name:"type",required:!0,className:"w-full border rounded px-3 py-2",children:[e.jsx("option",{value:"",children:"Select Report Type"}),e.jsx("option",{value:"Overview",children:"Overview"}),e.jsx("option",{value:"Students",children:"Students"}),e.jsx("option",{value:"Finance",children:"Finance"}),e.jsx("option",{value:"Attendance",children:"Attendance"}),e.jsx("option",{value:"Exams",children:"Exams"}),e.jsx("option",{value:"Full",children:"Full Report"})]}),e.jsxs("select",{name:"frequency",required:!0,className:"w-full border rounded px-3 py-2",children:[e.jsx("option",{value:"",children:"Select Frequency"}),e.jsx("option",{value:"Daily",children:"Daily"}),e.jsx("option",{value:"Weekly",children:"Weekly"}),e.jsx("option",{value:"Monthly",children:"Monthly"})]}),e.jsx("input",{type:"email",name:"email",required:!0,placeholder:"Email address",className:"w-full border rounded px-3 py-2"}),e.jsx("button",{type:"submit",className:"w-full bg-orange-600 text-white py-2 rounded-lg hover:bg-orange-700",children:"Schedule Report"})]})]})]})}),le&&ce&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between sticky top-0 bg-white",children:[e.jsxs("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx(na,{className:"text-blue-600"})," ",ce.name," Details"]}),e.jsx("button",{onClick:()=>Pe(!1),children:e.jsx(Nt,{size:24})})]}),e.jsx("div",{className:"p-6",children:ce.data.length>0?e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:Object.keys(ce.data[0]).map(J=>e.jsx("th",{className:"px-4 py-2 text-left text-sm capitalize",children:J.replace("_"," ")},J))})}),e.jsx("tbody",{children:ce.data.map((J,Je)=>e.jsx("tr",{className:"border-t",children:Object.values(J).map((_t,$t)=>e.jsx("td",{className:"px-4 py-2 text-sm",children:_t},$t))},Je))})]}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No detailed data available"})})]})})]})}const Xa=`${ee}/transport.php`;function jT(){const[t,s]=h.useState([]),[a,r]=h.useState([]),[l,c]=h.useState([]),[o,m]=h.useState([]),[u,x]=h.useState([]),[A,g]=h.useState([]),[N,f]=h.useState([]),[y,v]=h.useState([]),[U,D]=h.useState(!0),[M,K]=h.useState("vehicles"),[$,P]=h.useState(!1),[se,z]=h.useState("vehicle"),[R,j]=h.useState(null),[T,Q]=h.useState(null),[E,te]=h.useState(new Date().toISOString().split("T")[0]),[C,O]=h.useState(""),[V,re]=h.useState(""),[ge,xe]=h.useState([]),[Z,I]=h.useState([]),[H,ae]=h.useState([]),[k,B]=h.useState([]),[w,oe]=h.useState([]),[ne,Fe]=h.useState([]),[je,Ge]=h.useState(null),[ze,Xe]=h.useState(!1),[st,ce]=h.useState(!1),[_e,le]=h.useState(!1),[Pe,we]=h.useState(""),[fe,ye]=h.useState(""),[Ke,ve]=h.useState({vehicle_number:"",vehicle_type:"bus",make:"",model:"",year:"",capacity:"",registration_number:"",insurance_expiry:"",fitness_certificate_expiry:"",fuel_type:"diesel",status:"active",notes:""}),[ie,q]=h.useState({driver_name:"",phone:"",email:"",license_number:"",license_expiry:"",address:"",emergency_contact_name:"",emergency_contact_phone:"",hire_date:"",salary:"",status:"active"}),[pe,Me]=h.useState({route_name:"",route_code:"",start_location:"",end_location:"",total_distance:"",estimated_duration:"",fare_amount:"",status:"active",description:""}),[Se,Ne]=h.useState({vehicle_id:"",driver_id:"",route_id:"",assignment_date:"",shift:"both",start_time:"06:30",end_time:"17:00",status:"scheduled"}),[et,Ce]=h.useState({vehicle_id:"",maintenance_type:"routine",description:"",maintenance_date:"",cost:"",service_provider:"",next_service_date:"",status:"scheduled"}),[ft,qe]=h.useState({vehicle_id:"",fuel_date:"",liters:"",cost_per_liter:"",total_cost:"",odometer_reading:"",fuel_station:"",notes:""}),[W,Ie]=h.useState({student_id:"",route_id:"",amount:"",term:"",status:"pending"});h.useEffect(()=>{Promise.all([mt(),pt(),kt(),$t()]).then(()=>{Ue(),D(!1)})},[]),h.useEffect(()=>{M==="assignments"&&J(),M==="maintenance"&&Je(),M==="tracking"&&_t(),M==="fuel"&&Ze(),M==="history"&&ct(),M==="pickup"&&Yt(),M==="fees"&&be(),M==="expenses"&&lt()},[M,E,Pe,fe]);const mt=async()=>{try{const Ae=await F.get(`${Xa}?resource=vehicles`);s(Ae.data.vehicles||[])}catch(Ae){console.error(Ae)}},pt=async()=>{try{const Ae=await F.get(`${Xa}?resource=drivers`);r(Ae.data.drivers||[])}catch(Ae){console.error(Ae)}},kt=async()=>{try{const Ae=await F.get(`${Xa}?resource=routes`);c(Ae.data.routes||[])}catch(Ae){console.error(Ae)}},J=async()=>{try{const Ae=await F.get(`${Xa}?resource=assignments&action=by_date&date=${E}`);m(Ae.data.assignments||[])}catch(Ae){console.error(Ae)}},Je=async()=>{try{const Ae=await F.get(`${Xa}?resource=maintenance&action=upcoming`);x(Ae.data.maintenance||[])}catch(Ae){console.error(Ae)}},_t=async()=>{try{const Ae=await F.get(`${Xa}?resource=tracking&action=live`);g(Ae.data.vehicles||[])}catch(Ae){console.error(Ae)}},$t=async()=>{try{const Ae=await F.get(`${ee}/students.php`);f(Ae.data.students||[])}catch(Ae){console.error(Ae)}},me=async Ae=>{try{const es=await F.get(`${Xa}?resource=student_transport&action=by_route&route_id=${Ae}`);v(es.data.students||[])}catch(es){console.error(es)}},Ze=async()=>{try{let Ae=`${Xa}?resource=fuel`;Pe&&(Ae+=`&date_from=${Pe}`),fe&&(Ae+=`&date_to=${fe}`);const es=await F.get(Ae);xe(es.data.fuel_records||[])}catch(Ae){console.error(Ae)}},ct=async()=>{try{let Ae=`${Xa}?resource=trip_history`;Pe&&(Ae+=`&date_from=${Pe}`),fe&&(Ae+=`&date_to=${fe}`);const es=await F.get(Ae);I(es.data.trips||[])}catch(Ae){console.error(Ae)}},Yt=async()=>{try{const Ae=await F.get(`${Xa}?resource=pickup_tracking&date=${E}`);ae(Ae.data.tracking||[])}catch(Ae){console.error(Ae)}},be=async()=>{try{const Ae=await F.get(`${Xa}?resource=transport_fees`);oe(Ae.data.fees||[])}catch(Ae){console.error(Ae)}},lt=async()=>{try{let Ae=`${Xa}?resource=expenses`;Pe&&(Ae+=`&date_from=${Pe}`),fe&&(Ae+=`&date_to=${fe}`);const es=await F.get(Ae);Fe(es.data.expenses||[])}catch(Ae){console.error(Ae)}},Ue=()=>{const Ae=[],es=new Date,ws=new Date(es.getTime()+720*60*60*1e3);t.forEach(Da=>{Da.insurance_expiry&&new Date(Da.insurance_expiry)<=ws&&Ae.push({type:"insurance",vehicle:Da.vehicle_number,expiry:Da.insurance_expiry,severity:new Date(Da.insurance_expiry)<=es?"expired":"warning"}),Da.fitness_certificate_expiry&&new Date(Da.fitness_certificate_expiry)<=ws&&Ae.push({type:"fitness",vehicle:Da.vehicle_number,expiry:Da.fitness_certificate_expiry,severity:new Date(Da.fitness_certificate_expiry)<=es?"expired":"warning"})}),a.forEach(Da=>{Da.license_expiry&&new Date(Da.license_expiry)<=ws&&Ae.push({type:"license",driver:Da.driver_name,expiry:Da.license_expiry,severity:new Date(Da.license_expiry)<=es?"expired":"warning"})}),B(Ae)};h.useEffect(()=>{(t.length>0||a.length>0)&&Ue()},[t,a]);const Ct=async Ae=>{Ae.preventDefault();try{R?.id?await F.put(`${Xa}?resource=vehicles&id=${R.id}`,Ke):await F.post(`${Xa}?resource=vehicles`,Ke),alert("Saved!"),mt(),Ht()}catch{alert("Failed")}},Et=async Ae=>{if(confirm("Delete?"))try{await F.delete(`${Xa}?resource=vehicles&id=${Ae}`),mt()}catch{alert("Failed")}},Rs=async Ae=>{Ae.preventDefault();try{R?.id?await F.put(`${Xa}?resource=drivers&id=${R.id}`,ie):await F.post(`${Xa}?resource=drivers`,ie),alert("Saved!"),pt(),Ht()}catch{alert("Failed")}},He=async Ae=>{Ae.preventDefault();try{R?.id?await F.put(`${Xa}?resource=routes&id=${R.id}`,pe):await F.post(`${Xa}?resource=routes`,pe),alert("Saved!"),kt(),Ht()}catch{alert("Failed")}},Te=async Ae=>{Ae.preventDefault();try{await F.post(`${Xa}?resource=assignments`,Se),alert("Saved!"),J(),Ht()}catch{alert("Failed")}},bt=async Ae=>{Ae.preventDefault();try{await F.post(`${Xa}?resource=maintenance`,et),alert("Saved!"),Je(),Ht()}catch{alert("Failed")}},Xt=async Ae=>{Ae.preventDefault();try{await F.post(`${Xa}?resource=fuel`,ft),alert("Fuel record saved!"),Ze(),Ht()}catch{alert("Failed")}},ls=async Ae=>{Ae.preventDefault();try{await F.post(`${Xa}?resource=transport_fees`,W),alert("Fee saved!"),be(),ce(!1)}catch{alert("Failed")}},Ts=async(Ae,es)=>{try{await F.post(`${Xa}?resource=pickup_tracking`,{student_id:Ae,date:E,status:es,timestamp:new Date().toISOString()}),Yt()}catch{alert("Failed")}},ss=async(Ae,es)=>{try{await F.post(`${Xa}?resource=notifications`,{student_id:Ae,message:es,type:"transport"}),alert("Notification sent!")}catch{alert("Failed to send notification")}},he=(Ae,es=null)=>{z(Ae),j(es),Ae==="vehicle"?ve(es||{vehicle_number:"",vehicle_type:"bus",make:"",model:"",year:"",capacity:"",registration_number:"",insurance_expiry:"",fitness_certificate_expiry:"",fuel_type:"diesel",status:"active",notes:""}):Ae==="driver"?q(es||{driver_name:"",phone:"",email:"",license_number:"",license_expiry:"",address:"",emergency_contact_name:"",emergency_contact_phone:"",hire_date:"",salary:"",status:"active"}):Ae==="route"?Me(es||{route_name:"",route_code:"",start_location:"",end_location:"",total_distance:"",estimated_duration:"",fare_amount:"",status:"active",description:""}):Ae==="assignment"?Ne({vehicle_id:"",driver_id:"",route_id:"",assignment_date:E,shift:"both",start_time:"06:30",end_time:"17:00",status:"scheduled"}):Ae==="maintenance"?Ce({vehicle_id:"",maintenance_type:"routine",description:"",maintenance_date:"",cost:"",service_provider:"",next_service_date:"",status:"scheduled"}):Ae==="fuel"&&qe({vehicle_id:"",fuel_date:new Date().toISOString().split("T")[0],liters:"",cost_per_liter:"",total_cost:"",odometer_reading:"",fuel_station:"",notes:""}),P(!0)},Ht=()=>{P(!1),j(null)},Zt=Ae=>({active:"bg-green-100 text-green-800",maintenance:"bg-orange-100 text-orange-800",inactive:"bg-gray-100 text-gray-800",on_leave:"bg-yellow-100 text-yellow-800",suspended:"bg-red-100 text-red-800",scheduled:"bg-blue-100 text-blue-800",completed:"bg-green-100 text-green-800",in_progress:"bg-purple-100 text-purple-800",moving:"bg-green-100 text-green-800",stopped:"bg-yellow-100 text-yellow-800",picked_up:"bg-green-100 text-green-800",dropped_off:"bg-blue-100 text-blue-800",absent:"bg-red-100 text-red-800",pending:"bg-yellow-100 text-yellow-800",paid:"bg-green-100 text-green-800"})[Ae]||"bg-gray-100 text-gray-800",Ee=t.filter(Ae=>(Ae.vehicle_number?.toLowerCase().includes(C.toLowerCase())||Ae.make?.toLowerCase().includes(C.toLowerCase()))&&(!V||Ae.status===V)),zt=a.filter(Ae=>(Ae.driver_name?.toLowerCase().includes(C.toLowerCase())||Ae.phone?.includes(C))&&(!V||Ae.status===V)),is=l.filter(Ae=>(Ae.route_name?.toLowerCase().includes(C.toLowerCase())||Ae.route_code?.toLowerCase().includes(C.toLowerCase()))&&(!V||Ae.status===V)),pa=Ae=>{const es=new ms;es.setFontSize(18),es.text(`Transport ${Ae.charAt(0).toUpperCase()+Ae.slice(1)} Report`,14,22),es.setFontSize(10),es.text(`Generated: ${new Date().toLocaleString()}`,14,30),Ae==="vehicles"?Ma(es,{startY:35,head:[["Vehicle #","Type","Make/Model","Capacity","Status"]],body:Ee.map(ws=>[ws.vehicle_number,ws.vehicle_type,`${ws.make} ${ws.model}`,ws.capacity,ws.status])}):Ae==="drivers"?Ma(es,{startY:35,head:[["Name","Phone","License","Expiry","Status"]],body:zt.map(ws=>[ws.driver_name,ws.phone,ws.license_number,ws.license_expiry,ws.status])}):Ae==="routes"?Ma(es,{startY:35,head:[["Route","Code","From","To","Fare"]],body:is.map(ws=>[ws.route_name,ws.route_code,ws.start_location,ws.end_location,`GHS ${ws.fare_amount}`])}):Ae==="fuel"?Ma(es,{startY:35,head:[["Date","Vehicle","Liters","Cost/L","Total","Odometer"]],body:ge.map(ws=>[ws.fuel_date,ws.vehicle_number,ws.liters,ws.cost_per_liter,`GHS ${ws.total_cost}`,ws.odometer_reading])}):Ae==="expenses"&&Ma(es,{startY:35,head:[["Category","Description","Amount","Date"]],body:ne.map(ws=>[ws.category,ws.description,`GHS ${ws.amount}`,ws.expense_date])}),es.save(`transport_${Ae}_${new Date().toISOString().split("T")[0]}.pdf`)},ba=Ae=>{let es="",ws="";Ae==="vehicles"?(es=`Vehicle Number,Type,Make,Model,Capacity,Status
`+Ee.map(mr=>`${mr.vehicle_number},${mr.vehicle_type},${mr.make},${mr.model},${mr.capacity},${mr.status}`).join(`
`),ws="vehicles"):Ae==="fuel"&&(es=`Date,Vehicle,Liters,Cost/Liter,Total,Odometer
`+ge.map(mr=>`${mr.fuel_date},${mr.vehicle_number},${mr.liters},${mr.cost_per_liter},${mr.total_cost},${mr.odometer_reading}`).join(`
`),ws="fuel_records");const Da=new Blob([es],{type:"text/csv"}),Ii=URL.createObjectURL(Da),Kl=document.createElement("a");Kl.href=Ii,Kl.download=`${ws}_${new Date().toISOString().split("T")[0]}.csv`,Kl.click()},xn=()=>{window.print()},zr=ge.reduce((Ae,es)=>Ae+parseFloat(es.total_cost||0),0),De=u.reduce((Ae,es)=>Ae+parseFloat(es.cost||0),0),Jt=ne.reduce((Ae,es)=>Ae+parseFloat(es.amount||0),0),rs=w.filter(Ae=>Ae.status==="pending").reduce((Ae,es)=>Ae+parseFloat(es.amount||0),0),dr=w.filter(Ae=>Ae.status==="paid").reduce((Ae,es)=>Ae+parseFloat(es.amount||0),0);return U?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-start gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Qo,{className:"text-blue-600",size:32}),"Transport Management"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage vehicles, drivers, routes, fuel, and tracking"}),k.length>0&&e.jsxs("button",{onClick:()=>Xe(!0),className:"mt-2 flex items-center gap-2 px-3 py-1 bg-red-100 text-red-700 rounded-full text-sm hover:bg-red-200",children:[e.jsx(_s,{size:16})," ",k.length," Expiry Alert",k.length>1?"s":""]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:xn,className:"flex items-center gap-2 px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:[e.jsx(or,{size:16})," Print"]}),e.jsxs("button",{onClick:()=>pa(M),className:"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(xs,{size:16})," Export PDF"]}),e.jsxs("button",{onClick:()=>ba(M),className:"flex items-center gap-2 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[e.jsx(Kt,{size:16})," CSV"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-blue-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Vehicles"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:t.length})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-green-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Drivers"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:a.length})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-purple-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Routes"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:l.length})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-orange-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"In Maintenance"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:t.filter(Ae=>Ae.status==="maintenance").length})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-cyan-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Today's Trips"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-600",children:o.length})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-yellow-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Fuel Cost"}),e.jsxs("p",{className:"text-xl font-bold text-yellow-600",children:["GHS ",zr.toLocaleString()]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-red-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Pending Fees"}),e.jsxs("p",{className:"text-xl font-bold text-red-600",children:["GHS ",rs.toLocaleString()]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-emerald-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Collected"}),e.jsxs("p",{className:"text-xl font-bold text-emerald-600",children:["GHS ",dr.toLocaleString()]})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-[200px] relative",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",placeholder:"Search vehicles, drivers, routes...",value:C,onChange:Ae=>O(Ae.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]}),e.jsxs("select",{value:V,onChange:Ae=>re(Ae.target.value),className:"border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"maintenance",children:"Maintenance"}),e.jsx("option",{value:"on_leave",children:"On Leave"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ot,{size:18,className:"text-gray-500"}),e.jsx("input",{type:"date",value:Pe,onChange:Ae=>we(Ae.target.value),className:"border rounded px-3 py-2 text-sm"}),e.jsx("span",{className:"text-gray-400",children:"to"}),e.jsx("input",{type:"date",value:fe,onChange:Ae=>ye(Ae.target.value),className:"border rounded px-3 py-2 text-sm"})]}),e.jsx("button",{onClick:()=>{O(""),re(""),we(""),ye("")},className:"text-sm text-gray-500 hover:text-gray-700",children:"Clear"})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"border-b overflow-x-auto",children:e.jsx("div",{className:"flex",children:[{id:"vehicles",label:"Vehicles",icon:Qo},{id:"drivers",label:"Drivers",icon:Or},{id:"routes",label:"Routes",icon:_N},{id:"assignments",label:"Assignments",icon:Ot},{id:"fuel",label:"Fuel",icon:vN},{id:"maintenance",label:"Maintenance",icon:ub},{id:"tracking",label:"Tracking",icon:NN},{id:"pickup",label:"Pickup/Drop",icon:Or},{id:"history",label:"History",icon:Sa},{id:"fees",label:"Fees",icon:aa},{id:"expenses",label:"Expenses",icon:vs}].map(Ae=>e.jsxs("button",{onClick:()=>K(Ae.id),className:`px-4 py-3 font-medium whitespace-nowrap flex items-center gap-2 text-sm ${M===Ae.id?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-800"}`,children:[e.jsx(Ae.icon,{size:16})," ",Ae.label]},Ae.id))})}),e.jsxs("div",{className:"p-6",children:[M==="vehicles"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-xl font-semibold",children:["Fleet Vehicles (",Ee.length,")"]}),e.jsxs("button",{onClick:()=>he("vehicle"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," Add Vehicle"]})]}),Ee.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Qo,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No vehicles found"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Ee.map(Ae=>e.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qo,{className:"text-blue-600",size:24}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:Ae.vehicle_number}),e.jsx("p",{className:"text-xs text-gray-500 capitalize",children:Ae.vehicle_type})]})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${Zt(Ae.status)}`,children:Ae.status})]}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[Ae.make&&e.jsxs("p",{children:[Ae.make," ",Ae.model," ",Ae.year]}),e.jsxs("p",{children:["Capacity: ",Ae.capacity," seats"]}),Ae.insurance_expiry&&e.jsxs("p",{children:["Insurance: ",Ae.insurance_expiry]})]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsxs("button",{onClick:()=>he("vehicle",Ae),className:"flex-1 px-3 py-1 bg-gray-100 rounded text-sm hover:bg-gray-200 flex items-center justify-center gap-1",children:[e.jsx(ll,{size:14})," Edit"]}),e.jsx("button",{onClick:()=>Et(Ae.id),className:"px-3 py-1 bg-red-100 text-red-700 rounded text-sm hover:bg-red-200",children:e.jsx(us,{size:14})})]})]},Ae.id))})]}),M==="drivers"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Drivers"}),e.jsxs("button",{onClick:()=>he("driver"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," Add Driver"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Driver"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Contact"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"License"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:a.map(Ae=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("p",{className:"font-medium",children:Ae.driver_name})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("p",{className:"flex items-center gap-1 text-sm",children:[e.jsx(er,{size:14})," ",Ae.phone]})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("p",{className:"text-sm",children:Ae.license_number}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Exp: ",Ae.license_expiry]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${Zt(Ae.status)}`,children:Ae.status})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{onClick:()=>he("driver",Ae),className:"p-1 hover:bg-gray-100 rounded",children:e.jsx(ll,{size:16})})})]},Ae.id))})]})})]}),M==="routes"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Transport Routes"}),e.jsxs("button",{onClick:()=>he("route"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," Add Route"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:l.map(Ae=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[e.jsx(_N,{className:"text-purple-600",size:20}),Ae.route_name]}),e.jsx("p",{className:"text-xs text-gray-500",children:Ae.route_code})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${Zt(Ae.status)}`,children:Ae.status})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-2",children:[e.jsx(Qn,{size:16,className:"text-green-600"}),e.jsx("span",{children:Ae.start_location}),e.jsx(cr,{size:16}),e.jsx("span",{children:Ae.end_location})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-600 mb-3",children:[Ae.total_distance&&e.jsxs("span",{children:[Ae.total_distance," km"]}),e.jsxs("span",{className:"font-semibold text-green-600",children:["GHS ",Ae.fare_amount]}),e.jsxs("span",{children:[Ae.student_count||0," students"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{Q(Ae),me(Ae.id)},className:"flex-1 px-3 py-1 bg-purple-100 text-purple-700 rounded text-sm hover:bg-purple-200",children:"View Students"}),e.jsx("button",{onClick:()=>he("route",Ae),className:"px-3 py-1 bg-gray-100 rounded text-sm hover:bg-gray-200",children:e.jsx(ll,{size:14})})]})]},Ae.id))}),T&&e.jsxs("div",{className:"mt-6 border rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h4",{className:"font-semibold",children:["Students on ",T.route_name]}),e.jsx("button",{onClick:()=>Q(null),className:"px-3 py-1 bg-gray-200 rounded text-sm",children:"Close"})]}),y.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No students assigned"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500",children:"Student"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500",children:"Class"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500",children:"Stop"})]})}),e.jsx("tbody",{className:"divide-y",children:y.map(Ae=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-3 py-2 font-medium",children:Ae.student_name}),e.jsx("td",{className:"px-3 py-2 text-sm",children:Ae.class_name}),e.jsx("td",{className:"px-3 py-2 text-sm",children:Ae.stop_name})]},Ae.id))})]})})]})]}),M==="assignments"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Daily Assignments"}),e.jsx("input",{type:"date",value:E,onChange:Ae=>te(Ae.target.value),className:"border rounded-lg px-3 py-1"})]}),e.jsxs("button",{onClick:()=>he("assignment"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," New Assignment"]})]}),o.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Ot,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsxs("p",{children:["No assignments for ",E]})]}):e.jsx("div",{className:"space-y-3",children:o.map(Ae=>e.jsxs("div",{className:"border rounded-lg p-4 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:e.jsx(Qo,{className:"text-blue-600",size:24})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold",children:[Ae.vehicle_number," - ",Ae.route_name]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Driver: ",Ae.driver_name]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[Ae.shift," shift | ",Ae.start_time?.substring(0,5)," - ",Ae.end_time?.substring(0,5)]})]})]}),e.jsx("span",{className:`px-3 py-1 rounded text-sm ${Zt(Ae.status)}`,children:Ae.status})]},Ae.id))})]}),M==="maintenance"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Vehicle Maintenance"}),e.jsxs("button",{onClick:()=>he("maintenance"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," Schedule Maintenance"]})]}),u.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(ub,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No upcoming maintenance"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Vehicle"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Cost"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y",children:u.map(Ae=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:Ae.vehicle_number}),e.jsx("td",{className:"px-4 py-3 capitalize",children:Ae.maintenance_type}),e.jsx("td",{className:"px-4 py-3 text-sm",children:Ae.description}),e.jsx("td",{className:"px-4 py-3",children:Ae.maintenance_date}),e.jsx("td",{className:"px-4 py-3",children:Ae.cost?`GHS ${Ae.cost}`:"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${Zt(Ae.status)}`,children:Ae.status})})]},Ae.id))})]})})]}),M==="tracking"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Live Vehicle Tracking"}),e.jsxs("button",{onClick:_t,className:"px-4 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ns,{size:18})," Refresh"]})]}),A.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(NN,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No active tracking data"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:A.map(Ae=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`p-2 rounded-full ${Ae.status==="moving"?"bg-green-100":"bg-yellow-100"}`,children:e.jsx(Qo,{className:Ae.status==="moving"?"text-green-600":"text-yellow-600",size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:Ae.vehicle_number}),e.jsx("p",{className:"text-xs text-gray-500",children:Ae.vehicle_type})]})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${Zt(Ae.status)}`,children:Ae.status})]}),Ae.route_name&&e.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:["Route: ",Ae.route_name]}),Ae.driver_name&&e.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:["Driver: ",Ae.driver_name]}),Ae.speed&&e.jsxs("p",{className:"text-sm text-gray-600",children:["Speed: ",Ae.speed," km/h"]}),Ae.latitude&&e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[" ",Ae.latitude,", ",Ae.longitude]})]},Ae.id))})]}),M==="fuel"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Fuel Management"}),e.jsxs("button",{onClick:()=>he("fuel"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," Add Fuel Record"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:[e.jsx("p",{className:"text-yellow-600 text-sm",children:"Total Fuel Cost"}),e.jsxs("p",{className:"text-2xl font-bold text-yellow-700",children:["GHS ",zr.toLocaleString()]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("p",{className:"text-blue-600 text-sm",children:"Total Liters"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-700",children:[ge.reduce((Ae,es)=>Ae+parseFloat(es.liters||0),0).toLocaleString()," L"]})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsx("p",{className:"text-green-600 text-sm",children:"Avg Cost/Liter"}),e.jsxs("p",{className:"text-2xl font-bold text-green-700",children:["GHS ",ge.length>0?(ge.reduce((Ae,es)=>Ae+parseFloat(es.cost_per_liter||0),0)/ge.length).toFixed(2):"0.00"]})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-200",children:[e.jsx("p",{className:"text-purple-600 text-sm",children:"Records"}),e.jsx("p",{className:"text-2xl font-bold text-purple-700",children:ge.length})]})]}),ge.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(vN,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No fuel records found"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Vehicle"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Liters"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Cost/L"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Odometer"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Station"})]})}),e.jsx("tbody",{className:"divide-y",children:ge.map(Ae=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:Ae.fuel_date}),e.jsx("td",{className:"px-4 py-3 font-medium",children:Ae.vehicle_number}),e.jsxs("td",{className:"px-4 py-3",children:[Ae.liters," L"]}),e.jsxs("td",{className:"px-4 py-3",children:["GHS ",Ae.cost_per_liter]}),e.jsxs("td",{className:"px-4 py-3 font-semibold text-green-600",children:["GHS ",Ae.total_cost]}),e.jsxs("td",{className:"px-4 py-3",children:[Ae.odometer_reading," km"]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:Ae.fuel_station||"-"})]},Ae.id))})]})})]}),M==="pickup"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Student Pickup/Drop Tracking"}),e.jsx("input",{type:"date",value:E,onChange:Ae=>te(Ae.target.value),className:"border rounded-lg px-3 py-1"})]}),e.jsxs("button",{onClick:Yt,className:"px-4 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ns,{size:18})," Refresh"]})]}),H.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Or,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsxs("p",{children:["No pickup tracking data for ",E]})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Student"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Route"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Stop"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Morning"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Afternoon"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:H.map(Ae=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:Ae.student_name}),e.jsx("td",{className:"px-4 py-3",children:Ae.route_name}),e.jsx("td",{className:"px-4 py-3 text-sm",children:Ae.stop_name}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${Zt(Ae.morning_status||"pending")}`,children:Ae.morning_status||"Pending"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${Zt(Ae.afternoon_status||"pending")}`,children:Ae.afternoon_status||"Pending"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>Ts(Ae.student_id,"picked_up"),className:"p-1 bg-green-100 text-green-700 rounded hover:bg-green-200",title:"Mark Picked Up",children:e.jsx(Mt,{size:16})}),e.jsx("button",{onClick:()=>Ts(Ae.student_id,"dropped_off"),className:"p-1 bg-blue-100 text-blue-700 rounded hover:bg-blue-200",title:"Mark Dropped Off",children:e.jsx(Mt,{size:16})}),e.jsx("button",{onClick:()=>Ts(Ae.student_id,"absent"),className:"p-1 bg-red-100 text-red-700 rounded hover:bg-red-200",title:"Mark Absent",children:e.jsx(Js,{size:16})}),e.jsx("button",{onClick:()=>ss(Ae.student_id,`Your child ${Ae.student_name} has been picked up.`),className:"p-1 bg-purple-100 text-purple-700 rounded hover:bg-purple-200",title:"Notify Parent",children:e.jsx(va,{size:16})})]})})]},Ae.id))})]})})]}),M==="history"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Trip History"}),e.jsxs("button",{onClick:()=>pa("history"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(xs,{size:18})," Export"]})]}),Z.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Sa,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No trip history found"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Vehicle"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Driver"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Route"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Start"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"End"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Students"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y",children:Z.map(Ae=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:Ae.trip_date}),e.jsx("td",{className:"px-4 py-3 font-medium",children:Ae.vehicle_number}),e.jsx("td",{className:"px-4 py-3",children:Ae.driver_name}),e.jsx("td",{className:"px-4 py-3",children:Ae.route_name}),e.jsx("td",{className:"px-4 py-3 text-sm",children:Ae.start_time?.substring(0,5)}),e.jsx("td",{className:"px-4 py-3 text-sm",children:Ae.end_time?.substring(0,5)}),e.jsx("td",{className:"px-4 py-3",children:Ae.students_count||0}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${Zt(Ae.status)}`,children:Ae.status})})]},Ae.id))})]})})]}),M==="fees"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Transport Fees"}),e.jsxs("button",{onClick:()=>ce(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," Add Fee"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsx("p",{className:"text-green-600 text-sm",children:"Collected"}),e.jsxs("p",{className:"text-2xl font-bold text-green-700",children:["GHS ",dr.toLocaleString()]})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:[e.jsx("p",{className:"text-yellow-600 text-sm",children:"Pending"}),e.jsxs("p",{className:"text-2xl font-bold text-yellow-700",children:["GHS ",rs.toLocaleString()]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("p",{className:"text-blue-600 text-sm",children:"Total Students"}),e.jsx("p",{className:"text-2xl font-bold text-blue-700",children:w.length})]})]}),w.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(aa,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No transport fees found"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Student"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Route"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Term"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:w.map(Ae=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:Ae.student_name}),e.jsx("td",{className:"px-4 py-3",children:Ae.route_name}),e.jsx("td",{className:"px-4 py-3",children:Ae.term}),e.jsxs("td",{className:"px-4 py-3 font-semibold",children:["GHS ",Ae.amount]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${Zt(Ae.status)}`,children:Ae.status})}),e.jsx("td",{className:"px-4 py-3",children:Ae.status==="pending"&&e.jsx("button",{onClick:async()=>{await F.put(`${Xa}?resource=transport_fees&id=${Ae.id}`,{status:"paid"}),be()},className:"px-3 py-1 bg-green-100 text-green-700 rounded text-sm hover:bg-green-200",children:"Mark Paid"})})]},Ae.id))})]})})]}),M==="expenses"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Transport Expenses"}),e.jsxs("button",{onClick:()=>le(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," Add Expense"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:[e.jsx("p",{className:"text-red-600 text-sm",children:"Total Expenses"}),e.jsxs("p",{className:"text-2xl font-bold text-red-700",children:["GHS ",Jt.toLocaleString()]})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:[e.jsx("p",{className:"text-yellow-600 text-sm",children:"Fuel"}),e.jsxs("p",{className:"text-2xl font-bold text-yellow-700",children:["GHS ",zr.toLocaleString()]})]}),e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-200",children:[e.jsx("p",{className:"text-orange-600 text-sm",children:"Maintenance"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-700",children:["GHS ",De.toLocaleString()]})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-200",children:[e.jsx("p",{className:"text-purple-600 text-sm",children:"Other"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-700",children:["GHS ",(Jt-zr-De).toLocaleString()]})]})]}),ne.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(vs,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No expenses found"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Category"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Vehicle"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"})]})}),e.jsx("tbody",{className:"divide-y",children:ne.map(Ae=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:Ae.expense_date}),e.jsx("td",{className:"px-4 py-3 capitalize",children:Ae.category}),e.jsx("td",{className:"px-4 py-3",children:Ae.description}),e.jsx("td",{className:"px-4 py-3",children:Ae.vehicle_number||"-"}),e.jsxs("td",{className:"px-4 py-3 font-semibold text-red-600",children:["GHS ",Ae.amount]})]},Ae.id))})]})})]})]})]}),$&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b sticky top-0 bg-white flex justify-between items-center",children:[e.jsxs("h2",{className:"text-xl font-bold",children:[se==="vehicle"&&(R?"Edit Vehicle":"Add Vehicle"),se==="driver"&&(R?"Edit Driver":"Add Driver"),se==="route"&&(R?"Edit Route":"Add Route"),se==="assignment"&&"New Assignment",se==="maintenance"&&"Schedule Maintenance"]}),e.jsx("button",{onClick:Ht,className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{size:20})})]}),e.jsxs("div",{className:"p-6",children:[se==="vehicle"&&e.jsxs("form",{onSubmit:Ct,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Vehicle Number *"}),e.jsx("input",{type:"text",value:Ke.vehicle_number,onChange:Ae=>ve({...Ke,vehicle_number:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Type"}),e.jsxs("select",{value:Ke.vehicle_type,onChange:Ae=>ve({...Ke,vehicle_type:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"bus",children:"Bus"}),e.jsx("option",{value:"van",children:"Van"}),e.jsx("option",{value:"minibus",children:"Minibus"}),e.jsx("option",{value:"car",children:"Car"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Make"}),e.jsx("input",{type:"text",value:Ke.make,onChange:Ae=>ve({...Ke,make:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Model"}),e.jsx("input",{type:"text",value:Ke.model,onChange:Ae=>ve({...Ke,model:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Year"}),e.jsx("input",{type:"number",value:Ke.year,onChange:Ae=>ve({...Ke,year:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Capacity *"}),e.jsx("input",{type:"number",value:Ke.capacity,onChange:Ae=>ve({...Ke,capacity:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Fuel"}),e.jsxs("select",{value:Ke.fuel_type,onChange:Ae=>ve({...Ke,fuel_type:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"diesel",children:"Diesel"}),e.jsx("option",{value:"petrol",children:"Petrol"}),e.jsx("option",{value:"electric",children:"Electric"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Insurance Expiry"}),e.jsx("input",{type:"date",value:Ke.insurance_expiry,onChange:Ae=>ve({...Ke,insurance_expiry:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Fitness Expiry"}),e.jsx("input",{type:"date",value:Ke.fitness_certificate_expiry,onChange:Ae=>ve({...Ke,fitness_certificate_expiry:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),e.jsxs("select",{value:Ke.status,onChange:Ae=>ve({...Ke,status:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"maintenance",children:"Maintenance"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:Ht,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Save"})]})]}),se==="driver"&&e.jsxs("form",{onSubmit:Rs,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name *"}),e.jsx("input",{type:"text",value:ie.driver_name,onChange:Ae=>q({...ie,driver_name:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phone *"}),e.jsx("input",{type:"text",value:ie.phone,onChange:Ae=>q({...ie,phone:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),e.jsx("input",{type:"email",value:ie.email,onChange:Ae=>q({...ie,email:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"License *"}),e.jsx("input",{type:"text",value:ie.license_number,onChange:Ae=>q({...ie,license_number:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"License Expiry *"}),e.jsx("input",{type:"date",value:ie.license_expiry,onChange:Ae=>q({...ie,license_expiry:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Address"}),e.jsx("textarea",{value:ie.address,onChange:Ae=>q({...ie,address:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Emergency Contact"}),e.jsx("input",{type:"text",value:ie.emergency_contact_name,onChange:Ae=>q({...ie,emergency_contact_name:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Emergency Phone"}),e.jsx("input",{type:"text",value:ie.emergency_contact_phone,onChange:Ae=>q({...ie,emergency_contact_phone:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),e.jsxs("select",{value:ie.status,onChange:Ae=>q({...ie,status:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"on_leave",children:"On Leave"}),e.jsx("option",{value:"suspended",children:"Suspended"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:Ht,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Save"})]})]}),se==="route"&&e.jsxs("form",{onSubmit:He,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Route Name *"}),e.jsx("input",{type:"text",value:pe.route_name,onChange:Ae=>Me({...pe,route_name:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Route Code *"}),e.jsx("input",{type:"text",value:pe.route_code,onChange:Ae=>Me({...pe,route_code:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Start Location *"}),e.jsx("input",{type:"text",value:pe.start_location,onChange:Ae=>Me({...pe,start_location:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"End Location *"}),e.jsx("input",{type:"text",value:pe.end_location,onChange:Ae=>Me({...pe,end_location:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Distance (km)"}),e.jsx("input",{type:"number",step:"0.1",value:pe.total_distance,onChange:Ae=>Me({...pe,total_distance:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Duration (mins)"}),e.jsx("input",{type:"number",value:pe.estimated_duration,onChange:Ae=>Me({...pe,estimated_duration:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Fare (GHS) *"}),e.jsx("input",{type:"number",step:"0.01",value:pe.fare_amount,onChange:Ae=>Me({...pe,fare_amount:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),e.jsxs("select",{value:pe.status,onChange:Ae=>Me({...pe,status:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:Ht,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Save"})]})]}),se==="assignment"&&e.jsxs("form",{onSubmit:Te,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Vehicle *"}),e.jsxs("select",{value:Se.vehicle_id,onChange:Ae=>Ne({...Se,vehicle_id:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select"}),t.filter(Ae=>Ae.status==="active").map(Ae=>e.jsxs("option",{value:Ae.id,children:[Ae.vehicle_number," (",Ae.capacity," seats)"]},Ae.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Driver *"}),e.jsxs("select",{value:Se.driver_id,onChange:Ae=>Ne({...Se,driver_id:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select"}),a.filter(Ae=>Ae.status==="active").map(Ae=>e.jsx("option",{value:Ae.id,children:Ae.driver_name},Ae.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Route *"}),e.jsxs("select",{value:Se.route_id,onChange:Ae=>Ne({...Se,route_id:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select"}),l.filter(Ae=>Ae.status==="active").map(Ae=>e.jsx("option",{value:Ae.id,children:Ae.route_name},Ae.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Date *"}),e.jsx("input",{type:"date",value:Se.assignment_date,onChange:Ae=>Ne({...Se,assignment_date:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Shift"}),e.jsxs("select",{value:Se.shift,onChange:Ae=>Ne({...Se,shift:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"both",children:"Both"}),e.jsx("option",{value:"morning",children:"Morning"}),e.jsx("option",{value:"afternoon",children:"Afternoon"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Start Time"}),e.jsx("input",{type:"time",value:Se.start_time,onChange:Ae=>Ne({...Se,start_time:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"End Time"}),e.jsx("input",{type:"time",value:Se.end_time,onChange:Ae=>Ne({...Se,end_time:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:Ht,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Create"})]})]}),se==="maintenance"&&e.jsxs("form",{onSubmit:bt,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Vehicle *"}),e.jsxs("select",{value:et.vehicle_id,onChange:Ae=>Ce({...et,vehicle_id:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select"}),t.map(Ae=>e.jsx("option",{value:Ae.id,children:Ae.vehicle_number},Ae.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Type"}),e.jsxs("select",{value:et.maintenance_type,onChange:Ae=>Ce({...et,maintenance_type:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"routine",children:"Routine"}),e.jsx("option",{value:"repair",children:"Repair"}),e.jsx("option",{value:"inspection",children:"Inspection"}),e.jsx("option",{value:"emergency",children:"Emergency"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Date *"}),e.jsx("input",{type:"date",value:et.maintenance_date,onChange:Ae=>Ce({...et,maintenance_date:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description *"}),e.jsx("textarea",{value:et.description,onChange:Ae=>Ce({...et,description:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Cost (GHS)"}),e.jsx("input",{type:"number",step:"0.01",value:et.cost,onChange:Ae=>Ce({...et,cost:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Service Provider"}),e.jsx("input",{type:"text",value:et.service_provider,onChange:Ae=>Ce({...et,service_provider:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Next Service Date"}),e.jsx("input",{type:"date",value:et.next_service_date,onChange:Ae=>Ce({...et,next_service_date:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700",children:"Save"})]}),se==="fuel"&&e.jsxs("form",{onSubmit:Xt,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Vehicle *"}),e.jsxs("select",{value:ft.vehicle_id,onChange:Ae=>qe({...ft,vehicle_id:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select"}),t.map(Ae=>e.jsx("option",{value:Ae.id,children:Ae.vehicle_number},Ae.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Date *"}),e.jsx("input",{type:"date",value:ft.fuel_date,onChange:Ae=>qe({...ft,fuel_date:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Liters *"}),e.jsx("input",{type:"number",step:"0.01",value:ft.liters,onChange:Ae=>qe({...ft,liters:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Cost/Liter *"}),e.jsx("input",{type:"number",step:"0.01",value:ft.cost_per_liter,onChange:Ae=>qe({...ft,cost_per_liter:Ae.target.value,total_cost:(parseFloat(Ae.target.value)*parseFloat(ft.liters||0)).toFixed(2)}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Total Cost"}),e.jsx("input",{type:"number",step:"0.01",value:ft.total_cost,onChange:Ae=>qe({...ft,total_cost:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2 bg-gray-50",readOnly:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Odometer"}),e.jsx("input",{type:"number",value:ft.odometer_reading,onChange:Ae=>qe({...ft,odometer_reading:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Fuel Station"}),e.jsx("input",{type:"text",value:ft.fuel_station,onChange:Ae=>qe({...ft,fuel_station:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notes"}),e.jsx("textarea",{value:ft.notes,onChange:Ae=>qe({...ft,notes:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),e.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700",children:"Save Fuel Record"})]})]})]})}),ze&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b sticky top-0 bg-white flex justify-between items-center",children:[e.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(_s,{className:"text-red-600"})," Expiry Alerts"]}),e.jsx("button",{onClick:()=>Xe(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{size:20})})]}),e.jsx("div",{className:"p-6 space-y-3",children:k.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No alerts"}):k.map((Ae,es)=>e.jsx("div",{className:`p-4 rounded-lg border ${Ae.severity==="expired"?"bg-red-50 border-red-200":"bg-yellow-50 border-yellow-200"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_s,{className:Ae.severity==="expired"?"text-red-600":"text-yellow-600",size:20}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium capitalize",children:[Ae.type," ",Ae.severity==="expired"?"Expired":"Expiring Soon"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[Ae.vehicle||Ae.driver," - Expires: ",Ae.expiry]})]})]})},es))})]})}),st&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md",children:[e.jsxs("div",{className:"p-6 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Add Transport Fee"}),e.jsx("button",{onClick:()=>ce(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{size:20})})]}),e.jsxs("form",{onSubmit:ls,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Student *"}),e.jsxs("select",{value:W.student_id,onChange:Ae=>Ie({...W,student_id:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select Student"}),N.map(Ae=>e.jsxs("option",{value:Ae.id,children:[Ae.first_name," ",Ae.last_name]},Ae.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Route *"}),e.jsxs("select",{value:W.route_id,onChange:Ae=>Ie({...W,route_id:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select Route"}),l.map(Ae=>e.jsxs("option",{value:Ae.id,children:[Ae.route_name," - GHS ",Ae.fare_amount]},Ae.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Amount *"}),e.jsx("input",{type:"number",step:"0.01",value:W.amount,onChange:Ae=>Ie({...W,amount:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Term *"}),e.jsx("input",{type:"text",value:W.term,onChange:Ae=>Ie({...W,term:Ae.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"e.g. Term 1",required:!0})]})]}),e.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700",children:"Save Fee"})]})]})}),_e&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md",children:[e.jsxs("div",{className:"p-6 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Add Expense"}),e.jsx("button",{onClick:()=>le(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{size:20})})]}),e.jsxs("form",{onSubmit:async Ae=>{Ae.preventDefault();const es=new FormData(Ae.target);try{await F.post(`${Xa}?resource=expenses`,Object.fromEntries(es)),alert("Expense saved!"),lt(),le(!1)}catch{alert("Failed")}},className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Category *"}),e.jsxs("select",{name:"category",className:"w-full border rounded-lg px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"fuel",children:"Fuel"}),e.jsx("option",{value:"maintenance",children:"Maintenance"}),e.jsx("option",{value:"insurance",children:"Insurance"}),e.jsx("option",{value:"salary",children:"Driver Salary"}),e.jsx("option",{value:"toll",children:"Toll/Parking"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Vehicle"}),e.jsxs("select",{name:"vehicle_id",className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Select (Optional)"}),t.map(Ae=>e.jsx("option",{value:Ae.id,children:Ae.vehicle_number},Ae.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description *"}),e.jsx("textarea",{name:"description",className:"w-full border rounded-lg px-3 py-2",rows:2,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Amount *"}),e.jsx("input",{type:"number",step:"0.01",name:"amount",className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Date *"}),e.jsx("input",{type:"date",name:"expense_date",defaultValue:new Date().toISOString().split("T")[0],className:"w-full border rounded-lg px-3 py-2",required:!0})]})]}),e.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700",children:"Save Expense"})]})]})})]})}function vT(){const[t,s]=h.useState([]),[a,r]=h.useState([]),[l,c]=h.useState([]),[o,m]=h.useState([]),[u,x]=h.useState([]),[A,g]=h.useState([]),[N,f]=h.useState([]),[y,v]=h.useState([]),[U,D]=h.useState([]),[M,K]=h.useState([]),[$,P]=h.useState(!0),[se,z]=h.useState("overview"),[R,j]=h.useState(new Date().toISOString().slice(0,7)),[T,Q]=h.useState(!1),[E,te]=h.useState(""),[C,O]=h.useState({}),[V,re]=h.useState(new Date().toISOString().slice(0,10)),[ge,xe]=h.useState(null),[Z,I]=h.useState(""),[H,ae]=h.useState(""),[k,B]=h.useState(""),[w,oe]=h.useState([]),[ne,Fe]=h.useState([]),[je,Ge]=h.useState([]),[ze,Xe]=h.useState([]),[st,ce]=h.useState([]),[_e,le]=h.useState([]),[Pe,we]=h.useState([]),[fe,ye]=h.useState({ssnit_rate:5.5,paye_brackets:[]}),[Ke,ve]=h.useState(""),[ie,q]=h.useState("");h.useEffect(()=>{pe(),Ne(),W(),Ie()},[]),h.useEffect(()=>{se==="payroll"?Me():se==="leave"?(Se(),qe(),pt()):se==="attendance"?et():se==="training"?Ce():se==="documents"?(ft(),$t()):se==="departments"?(W(),Ie()):se==="history"?mt():se==="overtime"?J():se==="loans"?Je():se==="shifts"?_t():se==="attendance_report"&&kt()},[se,R,Ke,ie]);const pe=async()=>{try{const Y=await F.get(`${ee}/hr_payroll.php?resource=employees`);Y.data.success&&s(Y.data.employees)}catch(Y){console.error("Error:",Y)}finally{P(!1)}},Me=async()=>{try{const Y=await F.get(`${ee}/hr_payroll.php?resource=payroll&action=by_month&month=${R}`);Y.data.success&&r(Y.data.payroll)}catch(Y){console.error("Error:",Y)}},Se=async()=>{try{const Y=await F.get(`${ee}/hr_payroll.php?resource=leave&action=pending`);Y.data.success&&c(Y.data.applications)}catch(Y){console.error("Error:",Y)}},Ne=async()=>{try{const Y=await F.get(`${ee}/hr_payroll.php?resource=leave&action=pending`);Y.data.success&&c(Y.data.applications)}catch(Y){console.error("Error:",Y)}},et=async()=>{try{const Y=new Date().toISOString().slice(0,10),vt=await F.get(`${ee}/hr_payroll.php?resource=attendance&action=by_date&date=${Y}`);vt.data.success&&m(vt.data.attendance)}catch(Y){console.error("Error:",Y)}},Ce=async()=>{try{const Y=await F.get(`${ee}/hr_payroll.php?resource=training`);Y.data.success&&g(Y.data.trainings)}catch(Y){console.error("Error:",Y)}},ft=async()=>{try{const Y=await F.get(`${ee}/hr_payroll.php?resource=documents&action=expiring&days=30`);Y.data.success&&f(Y.data.documents)}catch(Y){console.error("Error:",Y)}},qe=async()=>{try{const Y=await F.get(`${ee}/hr_payroll.php?resource=leave_types`);Y.data.success&&K(Y.data.leave_types)}catch(Y){console.error("Error:",Y)}},W=async()=>{try{const Y=await F.get(`${ee}/hr_payroll.php?resource=departments`);Y.data.success&&v(Y.data.departments||[])}catch(Y){console.error("Error:",Y)}},Ie=async()=>{try{const Y=await F.get(`${ee}/hr_payroll.php?resource=designations`);Y.data.success&&D(Y.data.designations||[])}catch(Y){console.error("Error:",Y)}},mt=async()=>{try{let Y=`${ee}/hr_payroll.php?resource=payroll&action=history`;Ke&&(Y+=`&date_from=${Ke}`),ie&&(Y+=`&date_to=${ie}`);const vt=await F.get(Y);vt.data.success&&oe(vt.data.payroll||[])}catch(Y){console.error("Error:",Y)}},pt=async()=>{try{const Y=await F.get(`${ee}/hr_payroll.php?resource=leave_balances`);Y.data.success&&Fe(Y.data.balances||[])}catch(Y){console.error("Error:",Y)}},kt=async()=>{try{let Y=`${ee}/hr_payroll.php?resource=attendance&action=report&month=${R}`;const vt=await F.get(Y);vt.data.success&&Ge(vt.data.report||[])}catch(Y){console.error("Error:",Y)}},J=async()=>{try{let Y=`${ee}/hr_payroll.php?resource=overtime`;R&&(Y+=`&month=${R}`);const vt=await F.get(Y);vt.data.success&&Xe(vt.data.overtime||[])}catch(Y){console.error("Error:",Y)}},Je=async()=>{try{const Y=await F.get(`${ee}/hr_payroll.php?resource=loans`);Y.data.success&&ce(Y.data.loans||[])}catch(Y){console.error("Error:",Y)}},_t=async()=>{try{const Y=await F.get(`${ee}/hr_payroll.php?resource=shifts`);Y.data.success&&le(Y.data.shifts||[])}catch(Y){console.error("Error:",Y)}},$t=async()=>{try{const Y=await F.get(`${ee}/hr_payroll.php?resource=contracts&action=expiring`);Y.data.success&&we(Y.data.contracts||[])}catch(Y){console.error("Error:",Y)}},me=t.filter(Y=>{const vt=!Z||`${Y.first_name} ${Y.last_name}`.toLowerCase().includes(Z.toLowerCase())||Y.employee_number?.toLowerCase().includes(Z.toLowerCase())||Y.email?.toLowerCase().includes(Z.toLowerCase()),Ss=!H||Y.status===H,xr=!k||Y.department_id==k;return vt&&Ss&&xr}),Ze=Y=>{const vt=new ms;vt.setFontSize(18),vt.text(`HR ${Y.charAt(0).toUpperCase()+Y.slice(1)} Report`,14,22),vt.setFontSize(10),vt.text(`Generated: ${new Date().toLocaleString()}`,14,30),Y==="employees"?Ma(vt,{startY:35,head:[["Name","Employee #","Department","Designation","Status"]],body:me.map(Ss=>[`${Ss.first_name} ${Ss.last_name}`,Ss.employee_number,Ss.department_name||"-",Ss.designation||"-",Ss.status])}):Y==="payroll"?Ma(vt,{startY:35,head:[["Employee","Basic","Allowances","Deductions","Net Salary","Status"]],body:a.map(Ss=>[Ss.employee_name,`GHS ${Ss.basic_salary}`,`GHS ${Ss.total_allowances||0}`,`GHS ${Ss.total_deductions||0}`,`GHS ${Ss.net_salary}`,Ss.status])}):Y==="attendance"&&Ma(vt,{startY:35,head:[["Employee","Present","Absent","Late","Leave","Attendance %"]],body:je.map(Ss=>[Ss.employee_name,Ss.present_days,Ss.absent_days,Ss.late_days,Ss.leave_days,`${Ss.attendance_percentage}%`])}),vt.save(`hr_${Y}_${new Date().toISOString().split("T")[0]}.pdf`)},ct=Y=>{let vt="";Y==="employees"?vt=`Name,Employee Number,Department,Designation,Status,Phone,Email
`+me.map(hr=>`${hr.first_name} ${hr.last_name},${hr.employee_number},${hr.department_name||""},${hr.designation||""},${hr.status},${hr.phone||""},${hr.email||""}`).join(`
`):Y==="payroll"&&(vt=`Employee,Basic Salary,Allowances,Deductions,SSNIT,PAYE,Net Salary,Status
`+a.map(hr=>`${hr.employee_name},${hr.basic_salary},${hr.total_allowances||0},${hr.total_deductions||0},${hr.ssnit||0},${hr.paye||0},${hr.net_salary},${hr.status}`).join(`
`));const Ss=new Blob([vt],{type:"text/csv"}),xr=URL.createObjectURL(Ss),ul=document.createElement("a");ul.href=xr,ul.download=`hr_${Y}_${new Date().toISOString().split("T")[0]}.csv`,ul.click()},Yt=async(Y,vt)=>{try{await F.post(`${ee}/hr_payroll.php?resource=payroll&action=email_slip`,{employee_id:Y,email:vt,month:R}),alert("Pay slip sent to "+vt)}catch{alert("Failed to send email")}},be=async Y=>{Y.preventDefault();try{C.id?await F.put(`${ee}/hr_payroll.php?resource=departments&id=${C.id}`,C):await F.post(`${ee}/hr_payroll.php?resource=departments`,C),alert("Department saved!"),W(),Q(!1),O({})}catch{alert("Error saving department")}},lt=async Y=>{Y.preventDefault();try{C.id?await F.put(`${ee}/hr_payroll.php?resource=designations&id=${C.id}`,C):await F.post(`${ee}/hr_payroll.php?resource=designations`,C),alert("Designation saved!"),Ie(),Q(!1),O({})}catch{alert("Error saving designation")}},Ue=async Y=>{Y.preventDefault();try{await F.post(`${ee}/hr_payroll.php?resource=loans`,C),alert("Loan/Advance saved!"),Je(),Q(!1),O({})}catch{alert("Error saving loan")}},Ct=async Y=>{Y.preventDefault();try{await F.post(`${ee}/hr_payroll.php?resource=overtime`,C),alert("Overtime record saved!"),J(),Q(!1),O({})}catch{alert("Error saving overtime")}},Et=async Y=>{Y.preventDefault();try{C.id?await F.put(`${ee}/hr_payroll.php?resource=shifts&id=${C.id}`,C):await F.post(`${ee}/hr_payroll.php?resource=shifts`,C),alert("Shift saved!"),_t(),Q(!1),O({})}catch{alert("Error saving shift")}},Rs=async Y=>{if(confirm("Delete this department?"))try{await F.delete(`${ee}/hr_payroll.php?resource=departments&id=${Y}`),W()}catch{alert("Error deleting department")}},He=async Y=>{if(confirm("Delete this designation?"))try{await F.delete(`${ee}/hr_payroll.php?resource=designations&id=${Y}`),Ie()}catch{alert("Error deleting designation")}},Te=async Y=>{Y.preventDefault();try{C.id?await F.put(`${ee}/hr_payroll.php?resource=training&id=${C.id}`,C):await F.post(`${ee}/hr_payroll.php?resource=training`,C),alert(" Training program saved!"),Ce(),Q(!1),O({})}catch(vt){console.error("Error:",vt),alert("Error saving training")}},bt=async Y=>{if(confirm("Delete this training program?"))try{await F.delete(`${ee}/hr_payroll.php?resource=training&id=${Y}`),Ce()}catch(vt){console.error("Error:",vt)}},Xt=async(Y,vt)=>{try{await F.post(`${ee}/hr_payroll.php?resource=training_participants`,{training_id:Y,employee_id:vt}),alert(" Employee enrolled!");const Ss=await F.get(`${ee}/hr_payroll.php?resource=training&id=${Y}`);Ss.data.success&&xe(Ss.data.training)}catch(Ss){console.error("Error:",Ss),alert("Error enrolling employee")}},ls=async Y=>{Y.preventDefault();try{await F.post(`${ee}/hr_payroll.php?resource=documents`,C),alert(" Document saved!"),ft(),Q(!1),O({})}catch(vt){console.error("Error:",vt),alert("Error saving document")}},Ts=async()=>{try{(await F.get(`${ee}/hr_payroll.php?resource=payroll&action=generate&month=${R}`)).data.success&&(alert("Payroll generated successfully!"),Me())}catch(Y){console.error("Error:",Y),alert("Error generating payroll")}},ss=async Y=>{try{(await F.put(`${ee}/hr_payroll.php?resource=leave&id=${Y}&action=approve`,{approved_by:1})).data.success&&(alert("Leave approved successfully!"),Se(),Ne())}catch(vt){console.error("Error:",vt)}},he=async Y=>{const vt=prompt("Enter rejection reason:");if(vt)try{(await F.put(`${ee}/hr_payroll.php?resource=leave&id=${Y}&action=reject`,{approved_by:1,rejection_reason:vt})).data.success&&(alert("Leave rejected"),Se(),Ne())}catch(Ss){console.error("Error:",Ss)}},Ht=()=>a.reduce((Y,vt)=>Y+parseFloat(vt.net_salary||0),0).toFixed(2),Zt=async Y=>{Y.preventDefault();try{(await F.post(`${ee}/hr_payroll.php?resource=employees`,C)).data.success&&(alert("Employee added successfully!"),Q(!1),O({}),pe())}catch(vt){console.error("Error:",vt),alert("Error adding employee")}},Ee=()=>{te("attendance"),Q(!0)},zt=()=>{te("reports"),Q(!0)},is=async Y=>{try{const vt=await F.get(`${ee}/hr_reports.php?type=${Y}&month=${R}`);vt.data.success&&(console.log("Report Data:",vt.data.report),alert(`${Y} report generated successfully!
Check console for data.

In production, this will download PDF/Excel.`))}catch(vt){console.error("Error:",vt),alert("Error generating report: "+vt.message)}},pa=()=>{te("salary_components"),Q(!0),hn()},[ba,xn]=h.useState([]),[zr,De]=h.useState(null),[Jt,rs]=h.useState(null),[dr,Ae]=h.useState(null),[es,ws]=h.useState([]),[Da,Ii]=h.useState([]),[Kl,mr]=h.useState(!1),hn=async()=>{try{const Y=await F.get(`${ee}/salary_components.php`);Y.data.success&&xn(Y.data.components)}catch(Y){console.error("Error:",Y)}},Vl=async Y=>{Y.preventDefault();try{(await F.post(`${ee}/salary_components.php`,C)).data.success&&(alert("Salary component added successfully!"),hn(),O({}))}catch(vt){console.error("Error:",vt),alert("Error adding component")}},dl=Y=>{rs(Y),te("view_employee"),Q(!0)},da=async Y=>{Ae(Y),O(Y),te("edit_employee"),Q(!0),await $i(Y.id)},$i=async Y=>{try{const vt=await F.get(`${ee}/salary_components.php?action=by_employee&employee_id=${Y}`);vt.data.success&&Ii(vt.data.components)}catch(vt){console.error("Error:",vt)}},Nl=async()=>{mr(!0),await hn()},mi=async(Y,vt)=>{try{(await F.post(`${ee}/salary_components.php?action=assign_to_employee`,{employee_id:dr.id,component_id:Y,amount:parseFloat(vt),effective_from:new Date().toISOString().slice(0,10),status:"active"})).data.success&&(alert("Component assigned successfully!"),await $i(dr.id))}catch(Ss){console.error("Error:",Ss),alert("Error assigning component")}},to=async Y=>{if(confirm("Remove this salary component?"))try{(await F.delete(`${ee}/salary_components.php?action=remove_from_employee&id=${Y}`)).data.success&&(alert("Component removed!"),await $i(dr.id))}catch(vt){console.error("Error:",vt),alert("Error removing component")}},pn=async Y=>{Y.preventDefault();try{(await F.put(`${ee}/hr_payroll.php?resource=employees&id=${dr.id}`,C)).data.success&&(alert("Employee updated successfully!"),Q(!1),O({}),Ae(null),pe())}catch(vt){console.error("Error:",vt),alert("Error updating employee")}},Nr=async Y=>{try{const vt=await F.get(`${ee}/hr_reports.php?type=salary_slips&month=${R}&employee_id=${Y}`);console.log("Pay slip response:",vt.data),vt.data.success?(te("view_payslip"),O({report:vt.data.report}),Q(!0)):alert("No pay slip found for this employee")}catch(vt){console.error("Error:",vt),alert("Error fetching pay slip: "+(vt.response?.data?.message||vt.message))}},ur=async Y=>{if(confirm("Mark this payroll as paid?"))try{(await F.put(`${ee}/hr_payroll.php?resource=payroll&id=${Y}&action=pay`,{payment_date:new Date().toISOString().slice(0,10),payment_method:"bank_transfer",payment_reference:"PAY-"+Date.now()})).data.success&&(alert("Payroll marked as paid!"),Me())}catch(vt){console.error("Error:",vt),alert("Error marking as paid")}},_c=async()=>{const Y=a.filter(vt=>vt.status==="processed");if(Y.length===0){alert("No processed payroll to pay");return}if(confirm(`Mark ${Y.length} employees as paid?`))try{let vt=0;for(const Ss of Y)(await F.put(`${ee}/hr_payroll.php?resource=payroll&id=${Ss.id}&action=pay`,{payment_date:new Date().toISOString().slice(0,10),payment_method:"bank_transfer",payment_reference:"BULK-PAY-"+Date.now()})).data.success&&vt++;alert(`Successfully paid ${vt} out of ${Y.length} employees!`),Me()}catch(vt){console.error("Error:",vt),alert("Error processing bulk payment")}},Vo=Y=>{const vt=window.open("","_blank"),Ss=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Pay Slip - ${Y.employee_name}</title>
        <style>
          @media print {
            @page { margin: 0.5in; }
            body { margin: 0; }
          }
          body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
          }
          .header {
            text-align: center;
            border-bottom: 3px solid #333;
            padding-bottom: 20px;
            margin-bottom: 30px;
          }
          .logo {
            max-width: 150px;
            margin-bottom: 10px;
          }
          .school-name {
            font-size: 24px;
            font-weight: bold;
            color: #333;
            margin: 10px 0;
          }
          .school-details {
            font-size: 12px;
            color: #666;
          }
          .pay-slip-title {
            font-size: 20px;
            font-weight: bold;
            margin: 20px 0;
            text-align: center;
            color: #2563eb;
          }
          .employee-info {
            background: #f3f4f6;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
          }
          .info-row {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
          }
          .label {
            font-weight: bold;
            color: #374151;
          }
          .value {
            color: #1f2937;
          }
          .salary-section {
            margin: 20px 0;
          }
          .section-title {
            font-size: 16px;
            font-weight: bold;
            margin: 15px 0 10px 0;
            padding-bottom: 5px;
            border-bottom: 2px solid #e5e7eb;
          }
          .earnings { color: #059669; }
          .deductions { color: #dc2626; }
          table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
          }
          td {
            padding: 8px;
            border-bottom: 1px solid #e5e7eb;
          }
          .total-row {
            font-weight: bold;
            background: #f9fafb;
            border-top: 2px solid #333;
          }
          .net-salary {
            background: #dbeafe;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
          }
          .net-salary-label {
            font-size: 14px;
            color: #1e40af;
            margin-bottom: 5px;
          }
          .net-salary-amount {
            font-size: 28px;
            font-weight: bold;
            color: #1e3a8a;
          }
          .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #e5e7eb;
            font-size: 11px;
            color: #6b7280;
            text-align: center;
          }
          .print-button {
            background: #2563eb;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 20px auto;
            display: block;
          }
          @media print {
            .print-button { display: none; }
          }
        </style>
      </head>
      <body>
        <div class="header">
          <img src="/McSMS/assets/logo.png" alt="School Logo" class="logo" onerror="this.style.display='none'">
          <div class="school-name">McSMS School Management System</div>
          <div class="school-details">
            Address: School Address Here | Phone: +233 XXX XXX XXX | Email: info@school.com
          </div>
        </div>

        <div class="pay-slip-title">SALARY SLIP</div>

        <div class="employee-info">
          <div class="info-row">
            <span class="label">Employee Name:</span>
            <span class="value">${Y.employee_name}</span>
          </div>
          <div class="info-row">
            <span class="label">Employee Number:</span>
            <span class="value">${Y.employee_number}</span>
          </div>
          <div class="info-row">
            <span class="label">Designation:</span>
            <span class="value">${Y.designation}</span>
          </div>
          <div class="info-row">
            <span class="label">Department:</span>
            <span class="value">${Y.department_name||"N/A"}</span>
          </div>
          <div class="info-row">
            <span class="label">Pay Period:</span>
            <span class="value">${Y.month}</span>
          </div>
        </div>

        <div class="salary-section">
          <div class="section-title">Basic Salary</div>
          <table>
            <tr>
              <td>Basic Salary</td>
              <td style="text-align: right;">GHS ${parseFloat(Y.basic_salary).toFixed(2)}</td>
            </tr>
          </table>

          <div class="section-title earnings">Earnings</div>
          <table>
            ${Y.earnings&&Y.earnings.length>0?Y.earnings.map(xr=>`
                <tr>
                  <td>${xr.component_name}</td>
                  <td style="text-align: right;">GHS ${parseFloat(xr.amount).toFixed(2)}</td>
                </tr>
              `).join(""):'<tr><td colspan="2" style="text-align: center; color: #9ca3af;">No additional earnings</td></tr>'}
            <tr class="total-row">
              <td>Total Earnings</td>
              <td style="text-align: right;">GHS ${parseFloat(Y.total_earnings).toFixed(2)}</td>
            </tr>
          </table>

          <div class="section-title deductions">Deductions</div>
          <table>
            ${Y.deductions&&Y.deductions.length>0?Y.deductions.map(xr=>`
                <tr>
                  <td>${xr.component_name}</td>
                  <td style="text-align: right;">GHS ${parseFloat(xr.amount).toFixed(2)}</td>
                </tr>
              `).join(""):'<tr><td colspan="2" style="text-align: center; color: #9ca3af;">No deductions</td></tr>'}
            <tr class="total-row">
              <td>Total Deductions</td>
              <td style="text-align: right;">GHS ${parseFloat(Y.total_deductions).toFixed(2)}</td>
            </tr>
          </table>
        </div>

        <div class="net-salary">
          <div class="net-salary-label">NET SALARY</div>
          <div class="net-salary-amount">GHS ${parseFloat(Y.net_salary).toFixed(2)}</div>
        </div>

        <div class="footer">
          <p>This is a computer-generated pay slip and does not require a signature.</p>
          <p>Generated on ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}</p>
        </div>

        <button class="print-button" onclick="window.print()">Print Pay Slip</button>
      </body>
      </html>
    `;vt.document.write(Ss),vt.document.close()},Cc=()=>{const Y=t.map(vt=>({employee_id:vt.id,employee_name:`${vt.first_name} ${vt.last_name}`,status:"present",check_in_time:"08:00",check_out_time:"17:00"}));ws(Y)},Gr=(Y,vt,Ss)=>{ws(xr=>xr.map(ul=>ul.employee_id===Y?{...ul,[vt]:Ss}:ul))},so=async()=>{try{for(const Y of es)await F.post(`${ee}/hr_payroll.php?resource=attendance`,{employee_id:Y.employee_id,attendance_date:V,status:Y.status,check_in_time:Y.check_in_time+":00",check_out_time:Y.check_out_time+":00",marked_by:1});alert("Attendance marked successfully!"),Q(!1),et()}catch(Y){console.error("Error:",Y),alert("Error marking attendance")}},ao=()=>{te("performance_review"),Q(!0)},ml=async Y=>{Y.preventDefault();try{(await F.post(`${ee}/hr_payroll.php?resource=performance`,C)).data.success&&(alert("Performance review created successfully!"),Q(!1),O({}))}catch(vt){console.error("Error:",vt),alert("Error creating review")}};return $?e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-start gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(Rt,{className:"text-blue-600",size:32}),"HR & Payroll Management"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage employees, payroll, attendance, and more"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>Ze(se),className:"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(xs,{size:16})," PDF"]}),e.jsxs("button",{onClick:()=>ct(se),className:"flex items-center gap-2 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[e.jsx(qo,{size:16})," Excel"]}),e.jsxs("button",{onClick:()=>{Q(!0),te("employee")},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(Ti,{size:20})," Add Employee"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-blue-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Employees"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:t.length})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-green-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Active"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:t.filter(Y=>Y.status==="active").length})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-purple-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Payroll"}),e.jsxs("p",{className:"text-xl font-bold text-purple-600",children:["GHS ",Ht()]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-orange-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Pending Leave"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:l.length})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-indigo-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Present Today"}),e.jsx("p",{className:"text-2xl font-bold text-indigo-600",children:o.filter(Y=>Y.status==="present").length})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-cyan-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Departments"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-600",children:y.length})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-yellow-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Active Loans"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:st.filter(Y=>Y.status==="active").length})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-red-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Overtime (hrs)"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:ze.reduce((Y,vt)=>Y+parseFloat(vt.hours||0),0)})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-[200px] relative",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",placeholder:"Search employees...",value:Z,onChange:Y=>I(Y.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]}),e.jsxs("select",{value:H,onChange:Y=>ae(Y.target.value),className:"border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"on_leave",children:"On Leave"}),e.jsx("option",{value:"terminated",children:"Terminated"})]}),e.jsxs("select",{value:k,onChange:Y=>B(Y.target.value),className:"border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"All Departments"}),y.map(Y=>e.jsx("option",{value:Y.id,children:Y.name},Y.id))]}),e.jsx("input",{type:"month",value:R,onChange:Y=>j(Y.target.value),className:"border rounded px-3 py-2"}),e.jsx("button",{onClick:()=>{I(""),ae(""),B("")},className:"text-sm text-gray-500 hover:text-gray-700",children:"Clear"})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"border-b",children:e.jsx("div",{className:"flex flex-wrap",children:[{id:"overview",label:"Overview",icon:Gl},{id:"employees",label:"Employees",icon:Rt},{id:"departments",label:"Depts",icon:mn},{id:"payroll",label:"Payroll",icon:vs},{id:"history",label:"History",icon:Sa},{id:"salary",label:"Salary",icon:aa},{id:"leave",label:"Leave",icon:Ot},{id:"attendance",label:"Attendance",icon:Wt},{id:"attendance_report",label:"Att. Report",icon:Fs},{id:"overtime",label:"Overtime",icon:CN},{id:"loans",label:"Loans",icon:Xc},{id:"shifts",label:"Shifts",icon:Wt},{id:"performance",label:"Perf.",icon:Is},{id:"training",label:"Training",icon:Is},{id:"documents",label:"Docs",icon:Kt},{id:"reports",label:"Reports",icon:Kt}].map(Y=>e.jsxs("button",{onClick:()=>z(Y.id),className:`px-3 py-2 font-medium flex items-center gap-1 text-xs ${se===Y.id?"border-b-2 border-blue-600 text-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-800 hover:bg-gray-50"}`,children:[e.jsx(Y.icon,{size:14})," ",Y.label]},Y.id))})}),e.jsxs("div",{className:"p-6",children:[se==="overview"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[e.jsx(Pr,{className:"text-blue-600"}),"Quick Actions"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:Ts,className:"w-full bg-blue-50 hover:bg-blue-100 text-blue-700 px-4 py-3 rounded-lg text-left flex items-center gap-3",children:[e.jsx(vs,{size:20}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Generate Payroll"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Process monthly salaries"})]})]}),e.jsxs("button",{onClick:Ee,className:"w-full bg-green-50 hover:bg-green-100 text-green-700 px-4 py-3 rounded-lg text-left flex items-center gap-3",children:[e.jsx(Wt,{size:20}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Mark Attendance"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Record today's attendance"})]})]}),e.jsxs("button",{onClick:zt,className:"w-full bg-purple-50 hover:bg-purple-100 text-purple-700 px-4 py-3 rounded-lg text-left flex items-center gap-3",children:[e.jsx(Kt,{size:20}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Generate Reports"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Download payroll reports"})]})]})]})]}),e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[e.jsx(Ot,{className:"text-orange-600"}),"Pending Leave Requests (",l.length,")"]}),e.jsxs("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:[l.slice(0,5).map(Y=>e.jsxs("div",{className:"border rounded p-3",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:Y.employee_name}),e.jsx("div",{className:"text-sm text-gray-600",children:Y.leave_type_name}),e.jsxs("div",{className:"text-sm text-gray-500",children:[Y.start_date," to ",Y.end_date]})]}),e.jsxs("span",{className:"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded",children:[Y.total_days," days"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>ss(Y.id),className:"flex-1 bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700",children:"Approve"}),e.jsx("button",{onClick:()=>he(Y.id),className:"flex-1 bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700",children:"Reject"})]})]},Y.id)),l.length===0&&e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No pending leave requests"})]})]})]})}),se==="employees"&&e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsxs("h3",{className:"text-lg font-semibold",children:["Employee Directory (",me.length,")"]})}),me.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Rt,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No employees found"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Employee"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Department"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Designation"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Basic Salary"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:me.map(Y=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[Y.first_name," ",Y.last_name]}),e.jsx("div",{className:"text-sm text-gray-600",children:Y.email}),e.jsx("div",{className:"text-xs text-gray-400",children:Y.employee_number})]})}),e.jsx("td",{className:"px-4 py-3",children:Y.department_name||"N/A"}),e.jsx("td",{className:"px-4 py-3",children:Y.designation_name||"N/A"}),e.jsxs("td",{className:"px-4 py-3 font-medium",children:["GHS ",Y.basic_salary]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-sm ${Y.status==="active"?"bg-green-100 text-green-800":Y.status==="on_leave"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:Y.status})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>dl(Y),className:"text-blue-600 hover:text-blue-800",title:"View",children:e.jsx(na,{size:18})}),e.jsx("button",{onClick:()=>da(Y),className:"text-green-600 hover:text-green-800",title:"Edit",children:e.jsx(Na,{size:18})}),e.jsx("button",{onClick:()=>Yt(Y.id,Y.email),className:"text-purple-600 hover:text-purple-800",title:"Email Pay Slip",children:e.jsx(ra,{size:18})})]})})]},Y.id))})]})})]}),se==="departments"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Departments & Designations"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>{te("department"),O({}),Q(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," Add Department"]}),e.jsxs("button",{onClick:()=>{te("designation"),O({}),Q(!0)},className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," Add Designation"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("h4",{className:"font-semibold mb-4 flex items-center gap-2",children:[e.jsx(mn,{size:20,className:"text-blue-600"})," Departments (",y.length,")"]}),y.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No departments"}):e.jsx("div",{className:"space-y-2",children:y.map(Y=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:Y.name}),e.jsx("p",{className:"text-sm text-gray-500",children:Y.description||"No description"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{te("department"),O(Y),Q(!0)},className:"text-blue-600 hover:text-blue-800",children:e.jsx(Na,{size:16})}),e.jsx("button",{onClick:()=>Rs(Y.id),className:"text-red-600 hover:text-red-800",children:e.jsx(us,{size:16})})]})]},Y.id))})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("h4",{className:"font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Pr,{size:20,className:"text-green-600"})," Designations (",U.length,")"]}),U.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No designations"}):e.jsx("div",{className:"space-y-2",children:U.map(Y=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:Y.title}),e.jsx("p",{className:"text-sm text-gray-500",children:Y.department_name||"No department"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{te("designation"),O(Y),Q(!0)},className:"text-blue-600 hover:text-blue-800",children:e.jsx(Na,{size:16})}),e.jsx("button",{onClick:()=>He(Y.id),className:"text-red-600 hover:text-red-800",children:e.jsx(us,{size:16})})]})]},Y.id))})]})]})]}),se==="history"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Payroll History"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"date",value:Ke,onChange:Y=>ve(Y.target.value),className:"border rounded px-3 py-2",placeholder:"From"}),e.jsx("input",{type:"date",value:ie,onChange:Y=>q(Y.target.value),className:"border rounded px-3 py-2",placeholder:"To"})]})]}),w.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Sa,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No payroll history found"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Month"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Employee"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Basic"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Allowances"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Deductions"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Net Salary"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y",children:w.map(Y=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:Y.payroll_month}),e.jsx("td",{className:"px-4 py-3 font-medium",children:Y.employee_name}),e.jsxs("td",{className:"px-4 py-3",children:["GHS ",Y.basic_salary]}),e.jsxs("td",{className:"px-4 py-3 text-green-600",children:["+GHS ",Y.total_allowances||0]}),e.jsxs("td",{className:"px-4 py-3 text-red-600",children:["-GHS ",Y.total_deductions||0]}),e.jsxs("td",{className:"px-4 py-3 font-bold",children:["GHS ",Y.net_salary]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${Y.status==="paid"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:Y.status})})]},Y.id))})]})})]}),se==="attendance_report"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Attendance Report - ",R]}),e.jsxs("button",{onClick:()=>Ze("attendance"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(xs,{size:18})," Export"]})]}),je.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Fs,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsxs("p",{children:["No attendance data for ",R]})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Employee"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Present"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Absent"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Late"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Leave"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Attendance %"})]})}),e.jsx("tbody",{className:"divide-y",children:je.map(Y=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:Y.employee_name}),e.jsx("td",{className:"px-4 py-3 text-green-600",children:Y.present_days}),e.jsx("td",{className:"px-4 py-3 text-red-600",children:Y.absent_days}),e.jsx("td",{className:"px-4 py-3 text-yellow-600",children:Y.late_days}),e.jsx("td",{className:"px-4 py-3 text-blue-600",children:Y.leave_days}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${Y.attendance_percentage}%`}})}),e.jsxs("span",{className:"font-medium",children:[Y.attendance_percentage,"%"]})]})})]},Y.employee_id))})]})})]}),se==="overtime"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Overtime Records"}),e.jsxs("button",{onClick:()=>{te("overtime"),O({overtime_date:new Date().toISOString().split("T")[0]}),Q(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," Add Overtime"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("p",{className:"text-blue-600 text-sm",children:"Total Hours"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-700",children:[ze.reduce((Y,vt)=>Y+parseFloat(vt.hours||0),0)," hrs"]})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsx("p",{className:"text-green-600 text-sm",children:"Total Amount"}),e.jsxs("p",{className:"text-2xl font-bold text-green-700",children:["GHS ",ze.reduce((Y,vt)=>Y+parseFloat(vt.amount||0),0).toFixed(2)]})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-200",children:[e.jsx("p",{className:"text-purple-600 text-sm",children:"Employees"}),e.jsx("p",{className:"text-2xl font-bold text-purple-700",children:new Set(ze.map(Y=>Y.employee_id)).size})]})]}),ze.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(CN,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No overtime records"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Employee"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Hours"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Rate"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Reason"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y",children:ze.map(Y=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:Y.overtime_date}),e.jsx("td",{className:"px-4 py-3 font-medium",children:Y.employee_name}),e.jsxs("td",{className:"px-4 py-3",children:[Y.hours," hrs"]}),e.jsxs("td",{className:"px-4 py-3",children:["x",Y.rate_multiplier||1.5]}),e.jsxs("td",{className:"px-4 py-3 font-semibold text-green-600",children:["GHS ",Y.amount]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:Y.reason||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${Y.status==="approved"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:Y.status})})]},Y.id))})]})})]}),se==="loans"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Loans & Advances"}),e.jsxs("button",{onClick:()=>{te("loan"),O({loan_date:new Date().toISOString().split("T")[0],status:"active"}),Q(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," Add Loan/Advance"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("p",{className:"text-blue-600 text-sm",children:"Total Loans"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-700",children:["GHS ",st.reduce((Y,vt)=>Y+parseFloat(vt.amount||0),0).toLocaleString()]})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsx("p",{className:"text-green-600 text-sm",children:"Repaid"}),e.jsxs("p",{className:"text-2xl font-bold text-green-700",children:["GHS ",st.reduce((Y,vt)=>Y+parseFloat(vt.amount_repaid||0),0).toLocaleString()]})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:[e.jsx("p",{className:"text-yellow-600 text-sm",children:"Outstanding"}),e.jsxs("p",{className:"text-2xl font-bold text-yellow-700",children:["GHS ",st.reduce((Y,vt)=>Y+(parseFloat(vt.amount||0)-parseFloat(vt.amount_repaid||0)),0).toLocaleString()]})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-200",children:[e.jsx("p",{className:"text-purple-600 text-sm",children:"Active Loans"}),e.jsx("p",{className:"text-2xl font-bold text-purple-700",children:st.filter(Y=>Y.status==="active").length})]})]}),st.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Xc,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No loans or advances"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Employee"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Repaid"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Balance"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Monthly Deduction"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y",children:st.map(Y=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:Y.employee_name}),e.jsx("td",{className:"px-4 py-3 capitalize",children:Y.loan_type}),e.jsxs("td",{className:"px-4 py-3",children:["GHS ",Y.amount]}),e.jsxs("td",{className:"px-4 py-3 text-green-600",children:["GHS ",Y.amount_repaid||0]}),e.jsxs("td",{className:"px-4 py-3 font-semibold text-red-600",children:["GHS ",(parseFloat(Y.amount)-parseFloat(Y.amount_repaid||0)).toFixed(2)]}),e.jsxs("td",{className:"px-4 py-3",children:["GHS ",Y.monthly_deduction||0]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${Y.status==="paid"?"bg-green-100 text-green-800":Y.status==="active"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:Y.status})})]},Y.id))})]})})]}),se==="shifts"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Shift Management"}),e.jsxs("button",{onClick:()=>{te("shift"),O({}),Q(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," Add Shift"]})]}),_e.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Wt,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No shifts defined"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:_e.map(Y=>e.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:Y.shift_name}),e.jsx("p",{className:"text-sm text-gray-500",children:Y.description||"No description"})]}),e.jsx("button",{onClick:()=>{te("shift"),O(Y),Q(!0)},className:"text-blue-600 hover:text-blue-800",children:e.jsx(Na,{size:16})})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(Wt,{size:14})," ",Y.start_time," - ",Y.end_time]}),e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(Rt,{size:14})," ",Y.employee_count||0," employees"]})]})]},Y.id))})]}),se==="payroll"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Payroll Processing"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{type:"month",value:R,onChange:Y=>j(Y.target.value),className:"border rounded-lg px-4 py-2"}),e.jsxs("button",{onClick:Ts,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18}),"Generate Payroll"]}),a.some(Y=>Y.status==="processed")&&e.jsxs("button",{onClick:_c,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center gap-2",title:"Pay all processed employees",children:[e.jsx(Mt,{size:18}),"Pay All"]})]})]}),a.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Employee"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Basic Salary"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Earnings"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Deductions"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Net Salary"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:a.map(Y=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-medium",children:Y.employee_name}),e.jsx("div",{className:"text-sm text-gray-600",children:Y.employee_number})]}),e.jsxs("td",{className:"px-4 py-3",children:["GHS ",parseFloat(Y.basic_salary).toFixed(2)]}),e.jsxs("td",{className:"px-4 py-3 text-green-600",children:["GHS ",parseFloat(Y.total_earnings).toFixed(2)]}),e.jsxs("td",{className:"px-4 py-3 text-red-600",children:["GHS ",parseFloat(Y.total_deductions).toFixed(2)]}),e.jsxs("td",{className:"px-4 py-3 font-bold",children:["GHS ",parseFloat(Y.net_salary).toFixed(2)]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-sm ${Y.status==="paid"?"bg-green-100 text-green-800":Y.status==="processed"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:Y.status})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>Nr(Y.employee_id),className:"text-blue-600 hover:text-blue-800 flex items-center gap-1",title:"View Pay Slip",children:[e.jsx(xs,{size:18}),"Slip"]}),Y.status==="processed"&&e.jsxs("button",{onClick:()=>ur(Y.id),className:"text-green-600 hover:text-green-800 flex items-center gap-1",title:"Mark as Paid",children:[e.jsx(Mt,{size:18}),"Pay"]})]})})]},Y.id))}),e.jsx("tfoot",{className:"bg-gray-50 font-bold",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:"4",className:"px-4 py-3 text-right",children:"Total:"}),e.jsxs("td",{className:"px-4 py-3",children:["GHS ",Ht()]}),e.jsx("td",{colSpan:"2"})]})})]})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(vs,{className:"mx-auto text-gray-400 mb-4",size:48}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Payroll Generated"}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["Generate payroll for ",R," to view details"]}),e.jsx("button",{onClick:Ts,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700",children:"Generate Payroll"})]})]}),se==="salary"&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(aa,{className:"mx-auto text-gray-400 mb-4",size:48}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Salary Structure Management"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Configure salary components, allowances, and deductions"}),e.jsx("button",{onClick:pa,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700",children:"Configure Salary Components"})]}),se==="leave"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Leave Applications"}),e.jsxs("div",{className:"space-y-4",children:[l.map(Y=>e.jsx("div",{className:"border rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"font-semibold",children:Y.employee_name}),e.jsx("span",{className:"text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded",children:Y.leave_type_name}),e.jsxs("span",{className:"text-sm bg-yellow-100 text-yellow-800 px-2 py-1 rounded",children:[Y.total_days," days"]})]}),e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("strong",{children:"Period:"})," ",Y.start_date," to ",Y.end_date]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Reason:"})," ",Y.reason]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>ss(Y.id),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center gap-2",children:[e.jsx(Mt,{size:18}),"Approve"]}),e.jsxs("button",{onClick:()=>he(Y.id),className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 flex items-center gap-2",children:[e.jsx(Js,{size:18}),"Reject"]})]})]})},Y.id)),l.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ot,{className:"mx-auto text-gray-400 mb-4",size:48}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Pending Leave Requests"}),e.jsx("p",{className:"text-gray-600",children:"All leave applications have been processed"})]})]})]}),se==="attendance"&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Wt,{className:"mx-auto text-gray-400 mb-4",size:48}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Employee Attendance"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Track daily attendance and working hours"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Present today: ",o.filter(Y=>Y.status==="present").length," employees"]})]}),se==="performance"&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Is,{className:"mx-auto text-gray-400 mb-4",size:48}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Performance Reviews"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Conduct and manage employee performance evaluations"}),e.jsx("button",{onClick:ao,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700",children:"Create Performance Review"})]}),se==="training"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Training Programs"}),e.jsxs("button",{onClick:()=>{te("training"),O({}),Q(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," New Training"]})]}),A.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Is,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No training programs found"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:A.map(Y=>e.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h4",{className:"font-semibold",children:Y.program_name}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${Y.status==="completed"?"bg-green-100 text-green-800":Y.status==="ongoing"?"bg-blue-100 text-blue-800":Y.status==="cancelled"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:Y.status})]}),Y.description&&e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:Y.description}),e.jsxs("div",{className:"text-sm text-gray-500 space-y-1",children:[Y.trainer_name&&e.jsxs("p",{children:["Trainer: ",Y.trainer_name]}),e.jsxs("p",{children:[" ",Y.start_date," to ",Y.end_date]}),Y.location&&e.jsxs("p",{children:[" ",Y.location]}),Y.duration_hours&&e.jsxs("p",{children:[" ",Y.duration_hours," hours"]}),e.jsxs("p",{children:[" ",Y.participant_count||0," participants"]}),Y.cost&&e.jsxs("p",{children:[" GHS ",Y.cost]})]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx("button",{onClick:async()=>{const vt=await F.get(`${ee}/hr_payroll.php?resource=training&id=${Y.id}`);vt.data.success&&(xe(vt.data.training),te("view_training"),Q(!0))},className:"flex-1 px-3 py-1 bg-blue-100 text-blue-700 rounded text-sm hover:bg-blue-200",children:"View"}),e.jsx("button",{onClick:()=>{O(Y),te("training"),Q(!0)},className:"px-3 py-1 bg-gray-100 rounded text-sm hover:bg-gray-200",children:e.jsx(Na,{size:14})}),e.jsx("button",{onClick:()=>bt(Y.id),className:"px-3 py-1 bg-red-100 text-red-700 rounded text-sm hover:bg-red-200",children:e.jsx(Js,{size:14})})]})]},Y.id))})]}),se==="documents"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Employee Documents"}),e.jsxs("button",{onClick:()=>{te("document"),O({}),Q(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," Upload Document"]})]}),N.length>0&&e.jsxs("div",{className:"mb-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-semibold text-yellow-800 mb-2 flex items-center gap-2",children:[e.jsx(Wt,{size:18}),"Documents Expiring Soon (Next 30 Days)"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-yellow-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-yellow-800",children:"Employee"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-yellow-800",children:"Document"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-yellow-800",children:"Type"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-yellow-800",children:"Expiry Date"})]})}),e.jsx("tbody",{className:"divide-y divide-yellow-200",children:N.map(Y=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 font-medium",children:Y.employee_name}),e.jsx("td",{className:"px-4 py-2",children:Y.document_name}),e.jsx("td",{className:"px-4 py-2",children:Y.document_type||"-"}),e.jsx("td",{className:"px-4 py-2 text-red-600 font-medium",children:Y.expiry_date})]},Y.id))})]})})]}),N.length===0&&e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Kt,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No documents expiring in the next 30 days"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mt-6",children:["ID Card","Contract","Certificate","License"].map(Y=>e.jsxs("div",{className:"border rounded-lg p-4 text-center",children:[e.jsx(Kt,{className:"mx-auto text-blue-600 mb-2",size:24}),e.jsx("p",{className:"font-medium",children:Y})]},Y))})]}),se==="reports"&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Kt,{className:"mx-auto text-gray-400 mb-4",size:48}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"HR & Payroll Reports"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Generate comprehensive reports"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 max-w-3xl mx-auto mt-6",children:[e.jsx("button",{className:"border-2 border-blue-600 text-blue-600 px-6 py-3 rounded-lg hover:bg-blue-50",children:"Payroll Summary"}),e.jsx("button",{className:"border-2 border-green-600 text-green-600 px-6 py-3 rounded-lg hover:bg-green-50",children:"Attendance Report"}),e.jsx("button",{className:"border-2 border-purple-600 text-purple-600 px-6 py-3 rounded-lg hover:bg-purple-50",children:"Leave Report"})]})]})]})]}),T&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[E==="employee"&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Add New Employee"}),e.jsxs("form",{onSubmit:Zt,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Employee Number"}),e.jsx("input",{type:"text",required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.employee_number||"",onChange:Y=>O({...C,employee_number:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),e.jsx("input",{type:"email",required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.email||"",onChange:Y=>O({...C,email:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"First Name"}),e.jsx("input",{type:"text",required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.first_name||"",onChange:Y=>O({...C,first_name:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Last Name"}),e.jsx("input",{type:"text",required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.last_name||"",onChange:Y=>O({...C,last_name:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phone"}),e.jsx("input",{type:"tel",className:"w-full border rounded-lg px-3 py-2",value:C.phone||"",onChange:Y=>O({...C,phone:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Date of Birth"}),e.jsx("input",{type:"date",className:"w-full border rounded-lg px-3 py-2",value:C.date_of_birth||"",onChange:Y=>O({...C,date_of_birth:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gender"}),e.jsxs("select",{className:"w-full border rounded-lg px-3 py-2",value:C.gender||"",onChange:Y=>O({...C,gender:Y.target.value}),children:[e.jsx("option",{value:"",children:"Select Gender"}),e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Join Date"}),e.jsx("input",{type:"date",required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.join_date||"",onChange:Y=>O({...C,join_date:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Basic Salary"}),e.jsx("input",{type:"number",required:!0,step:"0.01",className:"w-full border rounded-lg px-3 py-2",value:C.basic_salary||"",onChange:Y=>O({...C,basic_salary:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Employment Type"}),e.jsxs("select",{className:"w-full border rounded-lg px-3 py-2",value:C.employment_type||"full_time",onChange:Y=>O({...C,employment_type:Y.target.value}),children:[e.jsx("option",{value:"full_time",children:"Full Time"}),e.jsx("option",{value:"part_time",children:"Part Time"}),e.jsx("option",{value:"contract",children:"Contract"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Address"}),e.jsx("textarea",{className:"w-full border rounded-lg px-3 py-2",rows:"2",value:C.address||"",onChange:Y=>O({...C,address:Y.target.value})})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Add Employee"}),e.jsx("button",{type:"button",onClick:()=>{Q(!1),O({})},className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Cancel"})]})]})]}),E==="attendance"&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Mark Attendance"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Date"}),e.jsx("input",{type:"date",className:"w-full border rounded-lg px-3 py-2",value:V,onChange:Y=>{re(Y.target.value),Cc()}})]}),es.length===0&&e.jsx("button",{onClick:Cc,className:"w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 mb-4",children:"Load Employees"}),es.length>0&&e.jsx("div",{className:"max-h-96 overflow-y-auto mb-4",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-sm",children:"Employee"}),e.jsx("th",{className:"px-3 py-2 text-left text-sm",children:"Status"}),e.jsx("th",{className:"px-3 py-2 text-left text-sm",children:"Check In"}),e.jsx("th",{className:"px-3 py-2 text-left text-sm",children:"Check Out"})]})}),e.jsx("tbody",{className:"divide-y",children:es.map(Y=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-3 py-2 text-sm",children:Y.employee_name}),e.jsx("td",{className:"px-3 py-2",children:e.jsxs("select",{value:Y.status,onChange:vt=>Gr(Y.employee_id,"status",vt.target.value),className:"border rounded px-2 py-1 text-sm",children:[e.jsx("option",{value:"present",children:"Present"}),e.jsx("option",{value:"absent",children:"Absent"}),e.jsx("option",{value:"late",children:"Late"}),e.jsx("option",{value:"half_day",children:"Half Day"}),e.jsx("option",{value:"on_leave",children:"On Leave"})]})}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("input",{type:"time",value:Y.check_in_time,onChange:vt=>Gr(Y.employee_id,"check_in_time",vt.target.value),className:"border rounded px-2 py-1 text-sm"})}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("input",{type:"time",value:Y.check_out_time,onChange:vt=>Gr(Y.employee_id,"check_out_time",vt.target.value),className:"border rounded px-2 py-1 text-sm"})})]},Y.employee_id))})]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:so,disabled:es.length===0,className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:bg-gray-400",children:"Submit Attendance"}),e.jsx("button",{onClick:()=>{Q(!1),ws([])},className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Cancel"})]})]}),E==="reports"&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Generate Reports"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Month"}),e.jsx("input",{type:"month",className:"w-full border rounded-lg px-3 py-2",value:R,onChange:Y=>j(Y.target.value)})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>is("payroll_summary"),className:"w-full bg-blue-50 hover:bg-blue-100 text-blue-700 px-4 py-3 rounded-lg text-left flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Payroll Summary Report"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Complete payroll breakdown for ",R]})]}),e.jsx(xs,{size:20})]}),e.jsxs("button",{onClick:()=>is("attendance_report"),className:"w-full bg-green-50 hover:bg-green-100 text-green-700 px-4 py-3 rounded-lg text-left flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Attendance Report"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Monthly attendance summary"})]}),e.jsx(xs,{size:20})]}),e.jsxs("button",{onClick:()=>is("leave_report"),className:"w-full bg-purple-50 hover:bg-purple-100 text-purple-700 px-4 py-3 rounded-lg text-left flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Leave Report"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Leave applications and balances"})]}),e.jsx(xs,{size:20})]}),e.jsxs("button",{onClick:()=>is("salary_slips"),className:"w-full bg-orange-50 hover:bg-orange-100 text-orange-700 px-4 py-3 rounded-lg text-left flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Salary Slips (All)"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Generate all salary slips for ",R]})]}),e.jsx(xs,{size:20})]})]}),e.jsx("button",{onClick:()=>Q(!1),className:"w-full mt-4 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Close"})]}),E==="salary_components"&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Salary Components"}),e.jsx("div",{className:"mb-4",children:e.jsx("button",{onClick:()=>te("add_salary_component"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"+ Add New Component"})}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:ba.map(Y=>e.jsxs("div",{className:"border rounded-lg p-4 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:Y.component_name}),e.jsx("div",{className:"text-sm text-gray-600",children:Y.description}),e.jsx("span",{className:`text-xs px-2 py-1 rounded ${Y.component_type==="earning"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:Y.component_type})]}),e.jsx("span",{className:`px-3 py-1 rounded ${Y.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:Y.status})]},Y.id))}),e.jsx("button",{onClick:()=>Q(!1),className:"w-full mt-4 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Close"})]}),E==="add_salary_component"&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Add Salary Component"}),e.jsxs("form",{onSubmit:Vl,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Component Name"}),e.jsx("input",{type:"text",required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.component_name||"",onChange:Y=>O({...C,component_name:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Type"}),e.jsxs("select",{required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.component_type||"",onChange:Y=>O({...C,component_type:Y.target.value}),children:[e.jsx("option",{value:"",children:"Select Type"}),e.jsx("option",{value:"earning",children:"Earning"}),e.jsx("option",{value:"deduction",children:"Deduction"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),e.jsx("textarea",{className:"w-full border rounded-lg px-3 py-2",rows:"2",value:C.description||"",onChange:Y=>O({...C,description:Y.target.value})})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Add Component"}),e.jsx("button",{type:"button",onClick:()=>{te("salary_components"),O({})},className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Back"})]})]})]}),E==="performance_review"&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Create Performance Review"}),e.jsxs("form",{onSubmit:ml,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Employee"}),e.jsxs("select",{required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.employee_id||"",onChange:Y=>O({...C,employee_id:Y.target.value}),children:[e.jsx("option",{value:"",children:"Select Employee"}),t.map(Y=>e.jsxs("option",{value:Y.id,children:[Y.first_name," ",Y.last_name," - ",Y.employee_number]},Y.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Period Start"}),e.jsx("input",{type:"date",required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.review_period_start||"",onChange:Y=>O({...C,review_period_start:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Period End"}),e.jsx("input",{type:"date",required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.review_period_end||"",onChange:Y=>O({...C,review_period_end:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Work Quality (1-5)"}),e.jsx("input",{type:"number",required:!0,min:"1",max:"5",className:"w-full border rounded-lg px-3 py-2",value:C.work_quality||"",onChange:Y=>O({...C,work_quality:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Productivity (1-5)"}),e.jsx("input",{type:"number",required:!0,min:"1",max:"5",className:"w-full border rounded-lg px-3 py-2",value:C.productivity||"",onChange:Y=>O({...C,productivity:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Communication (1-5)"}),e.jsx("input",{type:"number",required:!0,min:"1",max:"5",className:"w-full border rounded-lg px-3 py-2",value:C.communication||"",onChange:Y=>O({...C,communication:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Teamwork (1-5)"}),e.jsx("input",{type:"number",required:!0,min:"1",max:"5",className:"w-full border rounded-lg px-3 py-2",value:C.teamwork||"",onChange:Y=>O({...C,teamwork:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Punctuality (1-5)"}),e.jsx("input",{type:"number",required:!0,min:"1",max:"5",className:"w-full border rounded-lg px-3 py-2",value:C.punctuality||"",onChange:Y=>O({...C,punctuality:Y.target.value})})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Strengths"}),e.jsx("textarea",{className:"w-full border rounded-lg px-3 py-2",rows:"2",value:C.strengths||"",onChange:Y=>O({...C,strengths:Y.target.value})})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Areas for Improvement"}),e.jsx("textarea",{className:"w-full border rounded-lg px-3 py-2",rows:"2",value:C.areas_for_improvement||"",onChange:Y=>O({...C,areas_for_improvement:Y.target.value})})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Goals"}),e.jsx("textarea",{className:"w-full border rounded-lg px-3 py-2",rows:"2",value:C.goals||"",onChange:Y=>O({...C,goals:Y.target.value})})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Create Review"}),e.jsx("button",{type:"button",onClick:()=>{Q(!1),O({})},className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Cancel"})]})]})]}),E==="view_employee"&&Jt&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Employee Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"Employee Number"}),e.jsx("p",{className:"font-semibold",children:Jt.employee_number})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"Full Name"}),e.jsxs("p",{className:"font-semibold",children:[Jt.first_name," ",Jt.last_name]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"Email"}),e.jsx("p",{className:"font-semibold",children:Jt.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"Phone"}),e.jsx("p",{className:"font-semibold",children:Jt.phone||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"Department"}),e.jsx("p",{className:"font-semibold",children:Jt.department_name||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"Designation"}),e.jsx("p",{className:"font-semibold",children:Jt.designation_name||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"Basic Salary"}),e.jsxs("p",{className:"font-semibold",children:["GHS ",Jt.basic_salary]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"Status"}),e.jsx("p",{className:"font-semibold capitalize",children:Jt.status})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"Join Date"}),e.jsx("p",{className:"font-semibold",children:Jt.join_date||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600",children:"Employment Type"}),e.jsx("p",{className:"font-semibold capitalize",children:Jt.employment_type||"N/A"})]})]}),e.jsx("button",{onClick:()=>Q(!1),className:"w-full mt-6 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Close"})]}),E==="edit_employee"&&dr&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Edit Employee"}),e.jsxs("form",{onSubmit:pn,children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"First Name *"}),e.jsx("input",{type:"text",required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.first_name||"",onChange:Y=>O({...C,first_name:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Last Name *"}),e.jsx("input",{type:"text",required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.last_name||"",onChange:Y=>O({...C,last_name:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email *"}),e.jsx("input",{type:"email",required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.email||"",onChange:Y=>O({...C,email:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phone"}),e.jsx("input",{type:"text",className:"w-full border rounded-lg px-3 py-2",value:C.phone||"",onChange:Y=>O({...C,phone:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Basic Salary *"}),e.jsx("input",{type:"number",required:!0,step:"0.01",className:"w-full border rounded-lg px-3 py-2",value:C.basic_salary||"",onChange:Y=>O({...C,basic_salary:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),e.jsxs("select",{className:"w-full border rounded-lg px-3 py-2",value:C.status||"active",onChange:Y=>O({...C,status:Y.target.value}),children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"on_leave",children:"On Leave"}),e.jsx("option",{value:"suspended",children:"Suspended"})]})]})]}),e.jsxs("div",{className:"mt-6 border-t pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Salary Components"}),e.jsx("button",{type:"button",onClick:Nl,className:"bg-green-600 text-white px-3 py-1 rounded-lg hover:bg-green-700 text-sm",children:"+ Assign Component"})]}),e.jsx("div",{className:"space-y-2 mb-4",children:Da.length>0?Da.map(Y=>e.jsxs("div",{className:"flex justify-between items-center bg-gray-50 p-3 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:Y.component_name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${Y.component_type==="earning"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:Y.component_type}),Y.calculation_type==="percentage"&&e.jsxs("span",{className:"text-xs px-2 py-0.5 rounded bg-blue-100 text-blue-800",children:[parseFloat(Y.amount).toFixed(1),"% of basic"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"font-semibold",children:Y.calculation_type==="percentage"?`${parseFloat(Y.amount).toFixed(1)}%`:`GHS ${parseFloat(Y.amount).toFixed(2)}`}),e.jsx("button",{type:"button",onClick:()=>to(Y.id),className:"text-red-600 hover:text-red-800",children:e.jsx(Js,{size:18})})]})]},Y.id)):e.jsx("p",{className:"text-gray-500 text-sm text-center py-4",children:"No salary components assigned"})}),Kl&&e.jsxs("div",{className:"border rounded-lg p-4 bg-blue-50",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Assign New Component"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:["Basic Salary: ",e.jsxs("strong",{children:["GHS ",parseFloat(C.basic_salary||0).toFixed(2)]})]}),e.jsx("div",{className:"space-y-3",children:ba.filter(Y=>!Da.find(vt=>vt.component_id===Y.id)).map(Y=>e.jsxs("div",{className:"flex items-center gap-3 bg-white p-2 rounded",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:Y.component_name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${Y.component_type==="earning"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:Y.component_type}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${Y.calculation_type==="percentage"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:Y.calculation_type==="percentage"?"% of basic":"fixed amount"})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("input",{type:"number",step:"0.01",placeholder:Y.calculation_type==="percentage"?"e.g. 5.5":"Amount",className:"w-24 border rounded px-2 py-1 text-sm",id:`amount-${Y.id}`}),e.jsx("span",{className:"text-sm text-gray-600",children:Y.calculation_type==="percentage"?"%":"GHS"})]}),e.jsx("button",{type:"button",onClick:()=>{const vt=document.getElementById(`amount-${Y.id}`).value;vt&&parseFloat(vt)>0?(mi(Y.id,vt),document.getElementById(`amount-${Y.id}`).value=""):alert("Please enter a valid value")},className:"bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700 text-sm",children:"Assign"})]},Y.id))}),e.jsxs("div",{className:"mt-4 p-3 bg-yellow-50 rounded text-sm",children:[e.jsx("strong",{children:" Tip:"})," For percentage-based components (like SSNIT, Tax), enter the percentage value.",e.jsx("br",{}),"Example: Enter ",e.jsx("strong",{children:"5.5"})," for SSNIT Tier 1 (5.5% of basic salary)"]}),e.jsx("button",{type:"button",onClick:()=>mr(!1),className:"mt-3 text-sm text-gray-600 hover:text-gray-800",children:"Close"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Update Employee"}),e.jsx("button",{type:"button",onClick:()=>{Q(!1),O({}),Ae(null),mr(!1)},className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Cancel"})]})]})]}),E==="view_payslip"&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Salary Slip"}),C.report&&C.report.length>0?e.jsx("div",{className:"bg-white border rounded-lg p-6",children:C.report.map((Y,vt)=>e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"border-b pb-4 mb-4",children:[e.jsx("h3",{className:"text-lg font-bold",children:Y.employee_name}),e.jsx("p",{className:"text-gray-600",children:Y.employee_number}),e.jsx("p",{className:"text-gray-600",children:Y.designation})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Month"}),e.jsx("p",{className:"font-semibold",children:Y.month})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Basic Salary"}),e.jsxs("p",{className:"font-semibold",children:["GHS ",parseFloat(Y.basic_salary).toFixed(2)]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"font-semibold text-green-600 mb-2",children:"Earnings"}),Y.earnings&&Y.earnings.map((Ss,xr)=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:Ss.component_name}),e.jsxs("span",{children:["GHS ",parseFloat(Ss.amount).toFixed(2)]})]},xr)),e.jsxs("div",{className:"flex justify-between font-semibold mt-2 pt-2 border-t",children:[e.jsx("span",{children:"Total Earnings"}),e.jsxs("span",{children:["GHS ",parseFloat(Y.total_earnings).toFixed(2)]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"font-semibold text-red-600 mb-2",children:"Deductions"}),Y.deductions&&Y.deductions.map((Ss,xr)=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:Ss.component_name}),e.jsxs("span",{children:["GHS ",parseFloat(Ss.amount).toFixed(2)]})]},xr)),e.jsxs("div",{className:"flex justify-between font-semibold mt-2 pt-2 border-t",children:[e.jsx("span",{children:"Total Deductions"}),e.jsxs("span",{children:["GHS ",parseFloat(Y.total_deductions).toFixed(2)]})]})]}),e.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[e.jsx("span",{children:"Net Salary"}),e.jsxs("span",{children:["GHS ",parseFloat(Y.net_salary).toFixed(2)]})]})})]},vt))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-gray-600",children:"No payroll data found for this employee in the selected month."}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Please generate payroll first."})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[C.report&&C.report.length>0&&e.jsxs("button",{onClick:()=>Vo(C.report[0]),className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center justify-center gap-2",children:[e.jsx(Kt,{size:18}),"Print Pay Slip"]}),e.jsx("button",{onClick:()=>Q(!1),className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Close"})]})]}),E==="training"&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:C.id?"Edit Training":"New Training Program"}),e.jsxs("form",{onSubmit:Te,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Program Name *"}),e.jsx("input",{type:"text",required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.program_name||"",onChange:Y=>O({...C,program_name:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),e.jsx("textarea",{className:"w-full border rounded-lg px-3 py-2",rows:2,value:C.description||"",onChange:Y=>O({...C,description:Y.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Trainer Name"}),e.jsx("input",{type:"text",className:"w-full border rounded-lg px-3 py-2",value:C.trainer_name||"",onChange:Y=>O({...C,trainer_name:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Location"}),e.jsx("input",{type:"text",className:"w-full border rounded-lg px-3 py-2",value:C.location||"",onChange:Y=>O({...C,location:Y.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Start Date *"}),e.jsx("input",{type:"date",required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.start_date||"",onChange:Y=>O({...C,start_date:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"End Date *"}),e.jsx("input",{type:"date",required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.end_date||"",onChange:Y=>O({...C,end_date:Y.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Duration (hours)"}),e.jsx("input",{type:"number",className:"w-full border rounded-lg px-3 py-2",value:C.duration_hours||"",onChange:Y=>O({...C,duration_hours:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Cost (GHS)"}),e.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded-lg px-3 py-2",value:C.cost||"",onChange:Y=>O({...C,cost:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Max Participants"}),e.jsx("input",{type:"number",className:"w-full border rounded-lg px-3 py-2",value:C.max_participants||"",onChange:Y=>O({...C,max_participants:Y.target.value})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),e.jsxs("select",{className:"w-full border rounded-lg px-3 py-2",value:C.status||"scheduled",onChange:Y=>O({...C,status:Y.target.value}),children:[e.jsx("option",{value:"scheduled",children:"Scheduled"}),e.jsx("option",{value:"ongoing",children:"Ongoing"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>Q(!1),className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Save"})]})]})]}),E==="view_training"&&ge&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:ge.program_name}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:ge.description||"No description"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Trainer:"})," ",ge.trainer_name||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Location:"})," ",ge.location||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Dates:"})," ",ge.start_date," to ",ge.end_date]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Duration:"})," ",ge.duration_hours||"-"," hours"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Cost:"})," GHS ",ge.cost||"0"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",e.jsx("span",{className:`px-2 py-1 rounded text-xs ${ge.status==="completed"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:ge.status})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-2",children:["Participants (",ge.participants?.length||0,")"]}),ge.participants?.length>0?e.jsx("div",{className:"border rounded-lg divide-y max-h-48 overflow-y-auto",children:ge.participants.map(Y=>e.jsxs("div",{className:"p-2 flex justify-between items-center",children:[e.jsxs("span",{children:[Y.employee_name," (",Y.employee_number,")"]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${Y.attendance_status==="completed"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:Y.attendance_status})]},Y.id))}):e.jsx("p",{className:"text-gray-500 text-sm",children:"No participants enrolled yet"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Enroll Employee"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{id:"enrollEmployee",className:"flex-1 border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Select Employee"}),t.filter(Y=>!ge.participants?.some(vt=>vt.employee_id===Y.id)).map(Y=>e.jsxs("option",{value:Y.id,children:[Y.first_name," ",Y.last_name]},Y.id))]}),e.jsx("button",{onClick:()=>{const Y=document.getElementById("enrollEmployee").value;Y&&Xt(ge.id,Y)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Enroll"})]})]})]}),e.jsx("div",{className:"flex gap-3 mt-6",children:e.jsx("button",{onClick:()=>Q(!1),className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Close"})})]}),E==="document"&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Upload Employee Document"}),e.jsxs("form",{onSubmit:ls,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Employee *"}),e.jsxs("select",{required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.employee_id||"",onChange:Y=>O({...C,employee_id:Y.target.value}),children:[e.jsx("option",{value:"",children:"Select Employee"}),t.map(Y=>e.jsxs("option",{value:Y.id,children:[Y.first_name," ",Y.last_name," (",Y.employee_number,")"]},Y.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Document Name *"}),e.jsx("input",{type:"text",required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.document_name||"",onChange:Y=>O({...C,document_name:Y.target.value}),placeholder:"e.g., National ID Card"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Document Type"}),e.jsxs("select",{className:"w-full border rounded-lg px-3 py-2",value:C.document_type||"",onChange:Y=>O({...C,document_type:Y.target.value}),children:[e.jsx("option",{value:"",children:"Select Type"}),e.jsx("option",{value:"ID Card",children:"ID Card"}),e.jsx("option",{value:"Contract",children:"Contract"}),e.jsx("option",{value:"Certificate",children:"Certificate"}),e.jsx("option",{value:"License",children:"License"}),e.jsx("option",{value:"Resume",children:"Resume"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Expiry Date"}),e.jsx("input",{type:"date",className:"w-full border rounded-lg px-3 py-2",value:C.expiry_date||"",onChange:Y=>O({...C,expiry_date:Y.target.value})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"File Path *"}),e.jsx("input",{type:"text",required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.file_path||"",onChange:Y=>O({...C,file_path:Y.target.value}),placeholder:"/uploads/documents/filename.pdf"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter the file path where the document is stored"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notes"}),e.jsx("textarea",{className:"w-full border rounded-lg px-3 py-2",rows:2,value:C.notes||"",onChange:Y=>O({...C,notes:Y.target.value})})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>Q(!1),className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Save"})]})]})]}),E==="department"&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold mb-4",children:[C.id?"Edit":"Add"," Department"]}),e.jsxs("form",{onSubmit:be,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Department Name *"}),e.jsx("input",{type:"text",required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.name||"",onChange:Y=>O({...C,name:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),e.jsx("textarea",{className:"w-full border rounded-lg px-3 py-2",rows:3,value:C.description||"",onChange:Y=>O({...C,description:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Head of Department"}),e.jsxs("select",{className:"w-full border rounded-lg px-3 py-2",value:C.head_id||"",onChange:Y=>O({...C,head_id:Y.target.value}),children:[e.jsx("option",{value:"",children:"Select Employee"}),t.map(Y=>e.jsxs("option",{value:Y.id,children:[Y.first_name," ",Y.last_name]},Y.id))]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>Q(!1),className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Save"})]})]})]}),E==="designation"&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold mb-4",children:[C.id?"Edit":"Add"," Designation"]}),e.jsxs("form",{onSubmit:lt,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Title *"}),e.jsx("input",{type:"text",required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.title||"",onChange:Y=>O({...C,title:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Department"}),e.jsxs("select",{className:"w-full border rounded-lg px-3 py-2",value:C.department_id||"",onChange:Y=>O({...C,department_id:Y.target.value}),children:[e.jsx("option",{value:"",children:"Select Department"}),y.map(Y=>e.jsx("option",{value:Y.id,children:Y.name},Y.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),e.jsx("textarea",{className:"w-full border rounded-lg px-3 py-2",rows:3,value:C.description||"",onChange:Y=>O({...C,description:Y.target.value})})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>Q(!1),className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Save"})]})]})]}),E==="overtime"&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Add Overtime Record"}),e.jsxs("form",{onSubmit:Ct,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Employee *"}),e.jsxs("select",{required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.employee_id||"",onChange:Y=>O({...C,employee_id:Y.target.value}),children:[e.jsx("option",{value:"",children:"Select Employee"}),t.filter(Y=>Y.status==="active").map(Y=>e.jsxs("option",{value:Y.id,children:[Y.first_name," ",Y.last_name]},Y.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Date *"}),e.jsx("input",{type:"date",required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.overtime_date||"",onChange:Y=>O({...C,overtime_date:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hours *"}),e.jsx("input",{type:"number",step:"0.5",required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.hours||"",onChange:Y=>O({...C,hours:Y.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Rate Multiplier"}),e.jsxs("select",{className:"w-full border rounded-lg px-3 py-2",value:C.rate_multiplier||"1.5",onChange:Y=>O({...C,rate_multiplier:Y.target.value}),children:[e.jsx("option",{value:"1.5",children:"1.5x (Regular)"}),e.jsx("option",{value:"2",children:"2x (Weekend)"}),e.jsx("option",{value:"2.5",children:"2.5x (Holiday)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),e.jsxs("select",{className:"w-full border rounded-lg px-3 py-2",value:C.status||"pending",onChange:Y=>O({...C,status:Y.target.value}),children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Reason"}),e.jsx("textarea",{className:"w-full border rounded-lg px-3 py-2",rows:2,value:C.reason||"",onChange:Y=>O({...C,reason:Y.target.value})})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>Q(!1),className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Save"})]})]})]}),E==="loan"&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Add Loan/Advance"}),e.jsxs("form",{onSubmit:Ue,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Employee *"}),e.jsxs("select",{required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.employee_id||"",onChange:Y=>O({...C,employee_id:Y.target.value}),children:[e.jsx("option",{value:"",children:"Select Employee"}),t.filter(Y=>Y.status==="active").map(Y=>e.jsxs("option",{value:Y.id,children:[Y.first_name," ",Y.last_name]},Y.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Type *"}),e.jsxs("select",{required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.loan_type||"",onChange:Y=>O({...C,loan_type:Y.target.value}),children:[e.jsx("option",{value:"",children:"Select Type"}),e.jsx("option",{value:"loan",children:"Loan"}),e.jsx("option",{value:"advance",children:"Salary Advance"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Date *"}),e.jsx("input",{type:"date",required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.loan_date||"",onChange:Y=>O({...C,loan_date:Y.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Amount (GHS) *"}),e.jsx("input",{type:"number",step:"0.01",required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.amount||"",onChange:Y=>O({...C,amount:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Monthly Deduction"}),e.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded-lg px-3 py-2",value:C.monthly_deduction||"",onChange:Y=>O({...C,monthly_deduction:Y.target.value})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Reason"}),e.jsx("textarea",{className:"w-full border rounded-lg px-3 py-2",rows:2,value:C.reason||"",onChange:Y=>O({...C,reason:Y.target.value})})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>Q(!1),className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Save"})]})]})]}),E==="shift"&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold mb-4",children:[C.id?"Edit":"Add"," Shift"]}),e.jsxs("form",{onSubmit:Et,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Shift Name *"}),e.jsx("input",{type:"text",required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.shift_name||"",onChange:Y=>O({...C,shift_name:Y.target.value}),placeholder:"e.g., Morning Shift"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Start Time *"}),e.jsx("input",{type:"time",required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.start_time||"",onChange:Y=>O({...C,start_time:Y.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"End Time *"}),e.jsx("input",{type:"time",required:!0,className:"w-full border rounded-lg px-3 py-2",value:C.end_time||"",onChange:Y=>O({...C,end_time:Y.target.value})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),e.jsx("textarea",{className:"w-full border rounded-lg px-3 py-2",rows:2,value:C.description||"",onChange:Y=>O({...C,description:Y.target.value})})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>Q(!1),className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Save"})]})]})]})]})})]})}const lr=`${ee}/biometric.php`;function NT(){const[t,s]=h.useState([]),[a,r]=h.useState([]),[l,c]=h.useState([]),[o,m]=h.useState([]),[u,x]=h.useState([]),[A,g]=h.useState([]),[N,f]=h.useState([]),[y,v]=h.useState([]),[U,D]=h.useState(!0),[M,K]=h.useState("devices"),[$,P]=h.useState(!1),[se,z]=h.useState(""),[R,j]=h.useState(null),[T,Q]=h.useState(null),[E,te]=h.useState(new Date().toISOString().split("T")[0]),[C,O]=h.useState(""),[V,re]=h.useState(""),[ge,xe]=h.useState(""),[Z,I]=h.useState(""),[H,ae]=h.useState(""),[k,B]=h.useState([]),[w,oe]=h.useState([]),[ne,Fe]=h.useState([]),[je,Ge]=h.useState([]),[ze,Xe]=h.useState([]),[st,ce]=h.useState([]),[_e,le]=h.useState([]),[Pe,we]=h.useState([]),[fe,ye]=h.useState("08:00"),[Ke,ve]=h.useState({device_name:"",device_type:"fingerprint",device_model:"",serial_number:"",ip_address:"",port:"",location:"",api_endpoint:"",api_key:"",status:"active"}),[ie,q]=h.useState({user_id:"",user_type:"student",device_id:"",biometric_type:"fingerprint",template_data:"",finger_position:"",rfid_card_number:"",quality_score:""}),[pe,Me]=h.useState({visitor_name:"",phone:"",email:"",id_type:"",id_number:"",purpose_of_visit:"",host_name:"",host_department:"",temperature:"",expected_date:"",badge_printed:!1}),[Se,Ne]=h.useState({zone_name:"",description:"",access_level:"normal",devices:[]}),[et,Ce]=h.useState({schedule_name:"",user_type:"student",start_time:"08:00",end_time:"17:00",days:["monday","tuesday","wednesday","thursday","friday"]});h.useEffect(()=>{Promise.all([ft(),pt(),kt(),J(),_t(),Yt()]).then(()=>D(!1))},[]),h.useEffect(()=>{M==="attendance"&&qe(),M==="access"&&W(),M==="visitors"&&Ie(),M==="reports"&&Je(),M==="zones"&&_t(),M==="schedules"&&$t(),M==="audit"&&me(),M==="alerts"&&(Ze(),ct())},[M,E,Z,H]);const ft=async()=>{try{const De=await F.get(`${lr}?resource=devices`);s(De.data.devices||[])}catch(De){console.error(De)}},qe=async()=>{try{const De=await F.get(`${lr}?resource=attendance&action=by_date&date=${E}`);c(De.data.attendance||[])}catch(De){console.error(De)}},W=async()=>{try{const De=await F.get(`${lr}?resource=access&action=recent&limit=100`);m(De.data.access_logs||[])}catch(De){console.error(De)}},Ie=async()=>{try{const De=await F.get(`${lr}?resource=visitors`);x(De.data.visitors||[])}catch(De){console.error(De)}},mt=async De=>{try{const Jt=await F.get(`${lr}?resource=enrollments&action=by_device&device_id=${De}`);r(Jt.data.enrollments||[])}catch(Jt){console.error(Jt)}},pt=async()=>{try{const De=await F.get(`${ee}/students.php`);g(De.data.students||[])}catch(De){console.error(De)}},kt=async()=>{try{const De=await F.get(`${ee}/teachers.php`);f(De.data.teachers||[])}catch(De){console.error(De)}},J=async()=>{try{const De=await F.get(`${ee}/hr_payroll.php?resource=employees`);v(De.data.employees||[])}catch(De){console.error(De)}},Je=async()=>{try{const De=await F.get(`${lr}?resource=attendance&action=report&date_from=${Z||E}&date_to=${H||E}`);B(De.data.report||[])}catch(De){console.error(De)}},_t=async()=>{try{const De=await F.get(`${lr}?resource=zones`);oe(De.data.zones||[])}catch(De){console.error(De)}},$t=async()=>{try{const De=await F.get(`${lr}?resource=schedules`);Fe(De.data.schedules||[])}catch(De){console.error(De)}},me=async()=>{try{const De=await F.get(`${lr}?resource=audit&limit=100`);Ge(De.data.logs||[])}catch(De){console.error(De)}},Ze=async()=>{try{const De=await F.get(`${lr}?resource=attendance&action=late&date=${E}&expected_time=${fe}`);Xe(De.data.late_arrivals||[])}catch(De){console.error(De)}},ct=async()=>{try{const De=await F.get(`${lr}?resource=attendance&action=absences&date=${E}`);ce(De.data.absences||[])}catch(De){console.error(De)}},Yt=async()=>{try{const De=await F.get(`${lr}?resource=devices&action=health`);le(De.data.health||[])}catch(De){console.error(De)}},be=l.filter(De=>{const Jt=!C||(De.user_name||"").toLowerCase().includes(C.toLowerCase()),rs=!ge||De.user_type===ge;return Jt&&rs}),lt=u.filter(De=>{const Jt=!C||De.visitor_name.toLowerCase().includes(C.toLowerCase())||(De.host_name||"").toLowerCase().includes(C.toLowerCase()),rs=!V||De.status===V;return Jt&&rs}),Ue=o.filter(De=>{const Jt=!C||(De.user_name||"").toLowerCase().includes(C.toLowerCase()),rs=!ge||De.user_type===ge;return Jt&&rs}),Ct=De=>{const Jt=new ms;Jt.setFontSize(18),Jt.text(`Biometric ${De.charAt(0).toUpperCase()+De.slice(1)} Report`,14,22),Jt.setFontSize(10),Jt.text(`Generated: ${new Date().toLocaleString()}`,14,30),De==="attendance"?Ma(Jt,{startY:35,head:[["User","Type","Device","Check In","Check Out","Status"]],body:be.map(rs=>[rs.user_name||`User #${rs.user_id}`,rs.user_type,rs.device_name,rs.check_in_time?.substring(11,16)||"-",rs.check_out_time?.substring(11,16)||"-",rs.verification_status])}):De==="visitors"?Ma(Jt,{startY:35,head:[["Visitor","Phone","Host","Purpose","Check In","Status"]],body:lt.map(rs=>[rs.visitor_name,rs.phone,rs.host_name,rs.purpose_of_visit,rs.check_in_time||"-",rs.status])}):De==="access"&&Ma(Jt,{startY:35,head:[["Time","User","Device","Type","Access"]],body:Ue.map(rs=>[rs.access_time,rs.user_name||`${rs.user_type} #${rs.user_id}`,rs.device_name,rs.access_type,rs.access_granted?"Granted":"Denied"])}),Jt.save(`biometric_${De}_${new Date().toISOString().split("T")[0]}.pdf`)},Et=De=>{let Jt="";De==="attendance"?Jt=`User,Type,Device,Check In,Check Out,Status
`+be.map(Ae=>`${Ae.user_name||`User #${Ae.user_id}`},${Ae.user_type},${Ae.device_name},${Ae.check_in_time||"-"},${Ae.check_out_time||"-"},${Ae.verification_status}`).join(`
`):De==="visitors"&&(Jt=`Visitor,Phone,Host,Purpose,Check In,Status
`+lt.map(Ae=>`${Ae.visitor_name},${Ae.phone},${Ae.host_name},${Ae.purpose_of_visit},${Ae.check_in_time||"-"},${Ae.status}`).join(`
`));const rs=new Blob([Jt],{type:"text/csv"}),dr=document.createElement("a");dr.href=URL.createObjectURL(rs),dr.download=`biometric_${De}_${new Date().toISOString().split("T")[0]}.csv`,dr.click()},Rs=De=>{const Jt=window.open("","_blank");Jt.document.write(`<!DOCTYPE html><html><head><title>Visitor Badge</title><style>body{font-family:Arial;text-align:center;padding:20px;}.badge{border:3px solid #333;padding:20px;max-width:300px;margin:auto;border-radius:10px;}.name{font-size:24px;font-weight:bold;margin:10px 0;}.info{font-size:14px;color:#666;}.host{background:#f0f0f0;padding:10px;margin:10px 0;border-radius:5px;}.date{font-size:12px;color:#999;}@media print{.no-print{display:none;}}</style></head><body><div class="badge"><h2>VISITOR</h2><div class="name">${De.visitor_name}</div><div class="info">${De.purpose_of_visit}</div><div class="host">Host: ${De.host_name}<br>${De.host_department||""}</div><div class="date">${new Date().toLocaleDateString()}</div></div><button class="no-print" onclick="window.print()" style="margin-top:20px;padding:10px 20px;">Print Badge</button></body></html>`),Jt.document.close()},He=async()=>{if(Pe.length===0||!T){alert("Select device and users");return}try{for(const De of Pe)await F.post(`${lr}?resource=enrollments`,{user_id:De,user_type:ie.user_type,device_id:T.id,biometric_type:ie.biometric_type,template_data:"BULK_SIMULATED_TEMPLATE"});alert(` ${Pe.length} users enrolled!`),we([]),T&&mt(T.id)}catch{alert("Bulk enrollment failed")}},Te=async De=>{De.preventDefault();try{R?.id?await F.put(`${lr}?resource=zones&id=${R.id}`,Se):await F.post(`${lr}?resource=zones`,Se),alert(" Zone saved!"),_t(),zt()}catch{alert("Failed")}},bt=async De=>{De.preventDefault();try{R?.id?await F.put(`${lr}?resource=schedules&id=${R.id}`,et):await F.post(`${lr}?resource=schedules`,et),alert(" Schedule saved!"),$t(),zt()}catch{alert("Failed")}},Xt=async De=>{De.preventDefault();try{R?.id?await F.put(`${lr}?resource=devices&id=${R.id}`,Ke):await F.post(`${lr}?resource=devices`,Ke),alert(" Device saved!"),ft(),zt()}catch{alert("Failed to save")}},ls=async De=>{try{await F.put(`${lr}?resource=devices&id=${De}&action=sync`,{}),alert(" Device synced!"),ft()}catch{alert("Sync failed")}},Ts=async De=>{De.preventDefault();try{await F.post(`${lr}?resource=enrollments`,{...ie,template_data:ie.template_data||"SIMULATED_TEMPLATE_DATA"}),alert(" Enrollment saved!"),T&&mt(T.id),zt()}catch{alert("Failed to save")}},ss=async De=>{if(confirm("Deactivate this enrollment?"))try{await F.delete(`${lr}?resource=enrollments&id=${De}`),T&&mt(T.id)}catch{alert("Failed")}},he=async De=>{De.preventDefault();try{await F.post(`${lr}?resource=visitors`,pe),alert(" Visitor registered!"),Ie(),zt()}catch{alert("Failed to save")}},Ht=async De=>{const Jt=prompt("Enter temperature (optional):");try{await F.put(`${lr}?resource=visitors&id=${De}&action=checkin`,{temperature:Jt||null}),alert(" Visitor checked in!"),Ie()}catch{alert("Failed")}},Zt=async De=>{try{await F.put(`${lr}?resource=visitors&id=${De}&action=checkout`,{}),alert(" Visitor checked out!"),Ie()}catch{alert("Failed")}},Ee=(De,Jt=null)=>{z(De),j(Jt),De==="device"?ve(Jt||{device_name:"",device_type:"fingerprint",device_model:"",serial_number:"",ip_address:"",port:"",location:"",api_endpoint:"",api_key:"",status:"active"}):De==="enrollment"?q({user_id:"",user_type:"student",device_id:T?.id||"",biometric_type:"fingerprint",template_data:"",finger_position:"",rfid_card_number:"",quality_score:""}):De==="visitor"&&Me({visitor_name:"",phone:"",email:"",id_type:"",id_number:"",purpose_of_visit:"",host_name:"",host_department:"",temperature:""}),P(!0)},zt=()=>{P(!1),j(null)},is=De=>({active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",maintenance:"bg-yellow-100 text-yellow-800",error:"bg-red-100 text-red-800",online:"bg-green-100 text-green-800",offline:"bg-red-100 text-red-800",success:"bg-green-100 text-green-800",failed:"bg-red-100 text-red-800",scheduled:"bg-blue-100 text-blue-800",checked_in:"bg-green-100 text-green-800",checked_out:"bg-gray-100 text-gray-800"})[De]||"bg-gray-100 text-gray-800",pa=De=>({fingerprint:Dd,face_recognition:Ld,rfid:aa,iris:na,palm:Dd})[De]||Dd,ba=t.reduce((De,Jt)=>De+(parseInt(Jt.enrollment_count)||0),0),xn=t.filter(De=>De.status==="active").length,zr=u.filter(De=>De.status==="checked_in").length;return U?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-start gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Dd,{className:"text-blue-600",size:32}),"Biometric Integration"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage devices, enrollments, attendance, and access control"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>Ct(M),className:"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm",children:[e.jsx(xs,{size:16})," PDF"]}),e.jsxs("button",{onClick:()=>Et(M),className:"flex items-center gap-2 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm",children:[e.jsx(Kt,{size:16})," CSV"]}),e.jsxs("button",{onClick:Yt,className:"flex items-center gap-2 px-3 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 text-sm",children:[e.jsx(Ir,{size:16})," Health Check"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:[e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow border-l-4 border-blue-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Devices"}),e.jsx("p",{className:"text-xl font-bold text-blue-600",children:t.length}),e.jsxs("p",{className:"text-xs text-gray-500",children:[xn," active"]})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow border-l-4 border-green-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Enrollments"}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:ba})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow border-l-4 border-purple-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Attendance"}),e.jsx("p",{className:"text-xl font-bold text-purple-600",children:l.length})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow border-l-4 border-orange-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Access Logs"}),e.jsx("p",{className:"text-xl font-bold text-orange-600",children:o.length})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow border-l-4 border-cyan-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Visitors"}),e.jsx("p",{className:"text-xl font-bold text-cyan-600",children:zr})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow border-l-4 border-yellow-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Late Today"}),e.jsx("p",{className:"text-xl font-bold text-yellow-600",children:ze.length})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow border-l-4 border-red-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Absent"}),e.jsx("p",{className:"text-xl font-bold text-red-600",children:st.length})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow border-l-4 border-indigo-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Zones"}),e.jsx("p",{className:"text-xl font-bold text-indigo-600",children:w.length})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-[200px] relative",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",placeholder:"Search...",value:C,onChange:De=>O(De.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]}),e.jsxs("select",{value:ge,onChange:De=>xe(De.target.value),className:"border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"student",children:"Students"}),e.jsx("option",{value:"teacher",children:"Teachers"}),e.jsx("option",{value:"employee",children:"Employees"})]}),e.jsxs("select",{value:V,onChange:De=>re(De.target.value),className:"border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"checked_in",children:"Checked In"}),e.jsx("option",{value:"checked_out",children:"Checked Out"}),e.jsx("option",{value:"scheduled",children:"Scheduled"})]}),e.jsx("input",{type:"date",value:E,onChange:De=>te(De.target.value),className:"border rounded px-3 py-2"}),e.jsx("button",{onClick:()=>{O(""),xe(""),re("")},className:"text-sm text-gray-500 hover:text-gray-700",children:"Clear"})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"border-b",children:e.jsx("div",{className:"flex flex-wrap",children:[{id:"devices",label:"Devices",icon:Dd},{id:"enrollments",label:"Enroll",icon:Or},{id:"attendance",label:"Attendance",icon:Wt},{id:"access",label:"Access",icon:$r},{id:"visitors",label:"Visitors",icon:Rt},{id:"reports",label:"Reports",icon:Fs},{id:"zones",label:"Zones",icon:mn},{id:"schedules",label:"Schedules",icon:Ot},{id:"alerts",label:"Alerts",icon:nl},{id:"audit",label:"Audit",icon:Sa}].map(De=>e.jsxs("button",{onClick:()=>K(De.id),className:`px-3 py-2 font-medium flex items-center gap-1 text-xs ${M===De.id?"border-b-2 border-blue-600 text-blue-600 bg-blue-50":"text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(De.icon,{size:14})," ",De.label]},De.id))})}),e.jsxs("div",{className:"p-6",children:[M==="devices"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Biometric Devices"}),e.jsxs("button",{onClick:()=>Ee("device"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," Add Device"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(De=>{const Jt=pa(De.device_type);return e.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`p-2 rounded-lg ${De.status==="active"?"bg-green-100":"bg-gray-100"}`,children:e.jsx(Jt,{className:De.status==="active"?"text-green-600":"text-gray-600",size:24})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:De.device_name}),e.jsx("p",{className:"text-xs text-gray-500 capitalize",children:De.device_type?.replace("_"," ")})]})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${is(De.status)}`,children:De.status})]}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[De.location&&e.jsxs("p",{className:"flex items-center gap-1",children:[e.jsx(Qn,{size:14})," ",De.location]}),De.ip_address&&e.jsxs("p",{className:"flex items-center gap-1",children:[e.jsx(hF,{size:14})," ",De.ip_address,De.port?`:${De.port}`:""]}),e.jsxs("p",{className:"flex items-center gap-1",children:[e.jsx(Rt,{size:14})," ",De.enrollment_count||0," enrollments"]}),De.last_sync&&e.jsxs("p",{className:"text-xs text-gray-400",children:["Last sync: ",De.last_sync]})]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx("button",{onClick:()=>{Q(De),mt(De.id),K("enrollments")},className:"flex-1 px-3 py-1 bg-blue-100 text-blue-700 rounded text-sm hover:bg-blue-200",children:"Enrollments"}),e.jsx("button",{onClick:()=>ls(De.id),className:"px-3 py-1 bg-green-100 text-green-700 rounded text-sm hover:bg-green-200",children:e.jsx(Ns,{size:14})}),e.jsx("button",{onClick:()=>Ee("device",De),className:"px-3 py-1 bg-gray-100 rounded text-sm hover:bg-gray-200",children:e.jsx(ll,{size:14})})]})]},De.id)})})]}),M==="enrollments"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Biometric Enrollments"}),T&&e.jsxs("span",{className:"text-sm text-gray-500",children:["Device: ",T.device_name]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:T?.id||"",onChange:De=>{const Jt=t.find(rs=>rs.id==De.target.value);Q(Jt),Jt&&mt(Jt.id)},className:"border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Select Device"}),t.map(De=>e.jsx("option",{value:De.id,children:De.device_name},De.id))]}),T&&e.jsxs("button",{onClick:()=>Ee("enrollment"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," New Enrollment"]})]})]}),T?a.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Or,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No enrollments for this device"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"User"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Biometric"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Enrolled"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:a.map(De=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-4 py-3",children:["User #",De.user_id]}),e.jsx("td",{className:"px-4 py-3 capitalize",children:De.user_type}),e.jsxs("td",{className:"px-4 py-3 capitalize",children:[De.biometric_type,De.finger_position?` (${De.finger_position})`:"",De.rfid_card_number?` - ${De.rfid_card_number}`:""]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:De.enrollment_date}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${is(De.status)}`,children:De.status})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{onClick:()=>ss(De.id),className:"text-red-600 hover:text-red-800",children:e.jsx(us,{size:16})})})]},De.id))})]})}):e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Or,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Select a device to view enrollments"})]})]}),M==="attendance"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Biometric Attendance"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"date",value:E,onChange:De=>te(De.target.value),className:"border rounded-lg px-3 py-2"}),e.jsx("button",{onClick:qe,className:"px-3 py-2 bg-gray-100 rounded-lg hover:bg-gray-200",children:e.jsx(Ns,{size:18})})]})]}),l.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Wt,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsxs("p",{children:["No attendance records for ",E]})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"User"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Device"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Check In"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Check Out"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Method"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y",children:l.map(De=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:De.user_name||`User #${De.user_id}`}),e.jsx("td",{className:"px-4 py-3 capitalize",children:De.user_type}),e.jsx("td",{className:"px-4 py-3",children:De.device_name}),e.jsx("td",{className:"px-4 py-3",children:De.check_in_time?.substring(11,16)||"-"}),e.jsx("td",{className:"px-4 py-3",children:De.check_out_time?.substring(11,16)||"-"}),e.jsx("td",{className:"px-4 py-3 capitalize",children:De.verification_method}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${is(De.verification_status)}`,children:De.verification_status})})]},De.id))})]})})]}),M==="access"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Access Logs"}),e.jsxs("button",{onClick:W,className:"px-4 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ns,{size:18})," Refresh"]})]}),o.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx($r,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No access logs found"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Time"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"User"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Device"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Method"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Access"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Temp"})]})}),e.jsx("tbody",{className:"divide-y",children:o.map(De=>e.jsxs("tr",{className:`hover:bg-gray-50 ${De.access_granted?"":"bg-red-50"}`,children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:De.access_time}),e.jsx("td",{className:"px-4 py-3 font-medium",children:De.user_name||`${De.user_type} #${De.user_id}`}),e.jsx("td",{className:"px-4 py-3",children:De.device_name}),e.jsx("td",{className:"px-4 py-3 capitalize",children:De.access_type}),e.jsx("td",{className:"px-4 py-3 capitalize",children:De.verification_method}),e.jsxs("td",{className:"px-4 py-3",children:[De.access_granted?e.jsx(Mt,{className:"text-green-600",size:18}):e.jsx(Js,{className:"text-red-600",size:18}),De.denial_reason&&e.jsx("span",{className:"text-xs text-red-600 ml-1",children:De.denial_reason})]}),e.jsx("td",{className:"px-4 py-3",children:De.temperature?`${De.temperature}C`:"-"})]},De.id))})]})})]}),M==="visitors"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Visitor Management"}),e.jsxs("button",{onClick:()=>Ee("visitor"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," Register Visitor"]})]}),lt.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Rt,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No visitors registered"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Visitor"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Contact"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Purpose"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Host"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Check In"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Check Out"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:lt.map(De=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("p",{className:"font-medium",children:De.visitor_name}),De.id_number&&e.jsxs("p",{className:"text-xs text-gray-500",children:[De.id_type,": ",De.id_number]})]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:De.phone||De.email||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm max-w-xs truncate",children:De.purpose_of_visit}),e.jsxs("td",{className:"px-4 py-3 text-sm",children:[De.host_name||"-",e.jsx("br",{}),e.jsx("span",{className:"text-xs text-gray-500",children:De.host_department})]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:De.check_in_time?.substring(11,16)||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm",children:De.check_out_time?.substring(11,16)||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${is(De.status)}`,children:De.status?.replace("_"," ")})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-1",children:[De.status==="scheduled"&&e.jsx("button",{onClick:()=>Ht(De.id),className:"px-2 py-1 bg-green-100 text-green-700 rounded text-xs hover:bg-green-200",children:"Check In"}),De.status==="checked_in"&&e.jsx("button",{onClick:()=>Zt(De.id),className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs hover:bg-gray-200",children:"Check Out"}),e.jsx("button",{onClick:()=>Rs(De),className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs hover:bg-blue-200",children:e.jsx(or,{size:12})})]})})]},De.id))})]})})]}),M==="reports"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Attendance Reports"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"date",value:Z,onChange:De=>I(De.target.value),className:"border rounded px-3 py-2"}),e.jsx("input",{type:"date",value:H,onChange:De=>ae(De.target.value),className:"border rounded px-3 py-2"}),e.jsx("button",{onClick:Je,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Generate"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsx("p",{className:"text-green-600 text-sm",children:"Total Present"}),e.jsx("p",{className:"text-2xl font-bold text-green-700",children:k.reduce((De,Jt)=>De+(Jt.present_count||0),0)})]}),e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:[e.jsx("p",{className:"text-red-600 text-sm",children:"Total Absent"}),e.jsx("p",{className:"text-2xl font-bold text-red-700",children:k.reduce((De,Jt)=>De+(Jt.absent_count||0),0)})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:[e.jsx("p",{className:"text-yellow-600 text-sm",children:"Late Arrivals"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-700",children:k.reduce((De,Jt)=>De+(Jt.late_count||0),0)})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("p",{className:"text-blue-600 text-sm",children:"Avg Attendance %"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-700",children:[k.length>0?Math.round(k.reduce((De,Jt)=>De+(Jt.attendance_percentage||0),0)/k.length):0,"%"]})]})]}),k.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Fs,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Select date range and generate report"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Present"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Absent"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Late"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Attendance %"})]})}),e.jsx("tbody",{className:"divide-y",children:k.map((De,Jt)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:De.date}),e.jsx("td",{className:"px-4 py-3 text-green-600 font-medium",children:De.present_count}),e.jsx("td",{className:"px-4 py-3 text-red-600",children:De.absent_count}),e.jsx("td",{className:"px-4 py-3 text-yellow-600",children:De.late_count}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${De.attendance_percentage}%`}})}),e.jsxs("span",{children:[De.attendance_percentage,"%"]})]})})]},Jt))})]})})]}),M==="zones"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Access Zones"}),e.jsxs("button",{onClick:()=>{z("zone"),Ne({zone_name:"",description:"",access_level:"normal",devices:[]}),P(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," Add Zone"]})]}),w.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(mn,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No access zones defined"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:w.map(De=>e.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[e.jsx(mn,{size:18,className:"text-indigo-600"})," ",De.zone_name]}),e.jsx("p",{className:"text-sm text-gray-500",children:De.description||"No description"})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${De.access_level==="restricted"?"bg-red-100 text-red-800":De.access_level==="high_security"?"bg-purple-100 text-purple-800":"bg-green-100 text-green-800"}`,children:De.access_level})]}),e.jsxs("p",{className:"text-sm text-gray-600 flex items-center gap-1",children:[e.jsx(Dd,{size:14})," ",De.device_count||0," devices"]}),e.jsx("button",{onClick:()=>{z("zone"),Ne(De),j(De),P(!0)},className:"mt-3 text-blue-600 text-sm hover:underline",children:"Edit Zone"})]},De.id))})]}),M==="schedules"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Access Schedules"}),e.jsxs("button",{onClick:()=>{z("schedule"),Ce({schedule_name:"",user_type:"student",start_time:"08:00",end_time:"17:00",days:["monday","tuesday","wednesday","thursday","friday"]}),P(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," Add Schedule"]})]}),ne.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Ot,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No schedules defined"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:ne.map(De=>e.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:De.schedule_name}),e.jsxs("p",{className:"text-sm text-gray-500 capitalize",children:[De.user_type,"s"]})]}),e.jsxs("span",{className:"text-sm font-medium text-blue-600",children:[De.start_time," - ",De.end_time]})]}),e.jsx("div",{className:"flex gap-1 flex-wrap",children:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map((Jt,rs)=>e.jsx("span",{className:`px-2 py-1 rounded text-xs ${(De.days||[]).includes(["monday","tuesday","wednesday","thursday","friday","saturday","sunday"][rs])?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-400"}`,children:Jt},Jt))}),e.jsx("button",{onClick:()=>{z("schedule"),Ce(De),j(De),P(!0)},className:"mt-3 text-blue-600 text-sm hover:underline",children:"Edit"})]},De.id))})]}),M==="alerts"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Attendance Alerts"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm",children:"Expected Check-in:"}),e.jsx("input",{type:"time",value:fe,onChange:De=>ye(De.target.value),className:"border rounded px-3 py-2"}),e.jsx("button",{onClick:()=>{Ze(),ct()},className:"px-3 py-2 bg-gray-100 rounded-lg hover:bg-gray-200",children:e.jsx(Ns,{size:18})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("h4",{className:"font-semibold mb-4 flex items-center gap-2 text-yellow-600",children:[e.jsx(Wt,{size:20})," Late Arrivals (",ze.length,")"]}),ze.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No late arrivals today"}):e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:ze.map(De=>e.jsxs("div",{className:"flex justify-between items-center p-2 bg-yellow-50 rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:De.user_name}),e.jsx("p",{className:"text-xs text-gray-500 capitalize",children:De.user_type})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-yellow-600 font-medium",children:De.check_in_time?.substring(11,16)}),e.jsxs("p",{className:"text-xs text-gray-500",children:[De.late_minutes," min late"]})]})]},De.id))})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("h4",{className:"font-semibold mb-4 flex items-center gap-2 text-red-600",children:[e.jsx(Js,{size:20})," Absences (",st.length,")"]}),st.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No absences today"}):e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:st.map(De=>e.jsxs("div",{className:"flex justify-between items-center p-2 bg-red-50 rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:De.user_name}),e.jsx("p",{className:"text-xs text-gray-500 capitalize",children:De.user_type})]}),e.jsx("span",{className:"text-red-600 text-sm",children:"Not checked in"})]},De.id))})]})]})]}),M==="audit"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Audit Trail"}),e.jsxs("button",{onClick:me,className:"px-4 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ns,{size:18})," Refresh"]})]}),je.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Sa,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No audit logs"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Time"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"User"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Action"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Resource"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Details"})]})}),e.jsx("tbody",{className:"divide-y",children:je.map(De=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:De.created_at}),e.jsx("td",{className:"px-4 py-3",children:De.user_name||"System"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${De.action==="create"?"bg-green-100 text-green-800":De.action==="delete"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:De.action})}),e.jsx("td",{className:"px-4 py-3 capitalize",children:De.resource_type}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500 max-w-xs truncate",children:De.details})]},De.id))})]})})]})]})]}),$&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b sticky top-0 bg-white flex justify-between items-center",children:[e.jsxs("h2",{className:"text-xl font-bold",children:[se==="device"&&(R?"Edit Device":"Add Device"),se==="enrollment"&&"New Enrollment",se==="visitor"&&"Register Visitor"]}),e.jsx("button",{onClick:zt,className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{size:20})})]}),e.jsxs("div",{className:"p-6",children:[se==="device"&&e.jsxs("form",{onSubmit:Xt,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Device Name *"}),e.jsx("input",{type:"text",value:Ke.device_name,onChange:De=>ve({...Ke,device_name:De.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Type"}),e.jsxs("select",{value:Ke.device_type,onChange:De=>ve({...Ke,device_type:De.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"fingerprint",children:"Fingerprint"}),e.jsx("option",{value:"face_recognition",children:"Face Recognition"}),e.jsx("option",{value:"rfid",children:"RFID"}),e.jsx("option",{value:"iris",children:"Iris"}),e.jsx("option",{value:"palm",children:"Palm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),e.jsxs("select",{value:Ke.status,onChange:De=>ve({...Ke,status:De.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"maintenance",children:"Maintenance"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Model"}),e.jsx("input",{type:"text",value:Ke.device_model,onChange:De=>ve({...Ke,device_model:De.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Serial Number"}),e.jsx("input",{type:"text",value:Ke.serial_number,onChange:De=>ve({...Ke,serial_number:De.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Location"}),e.jsx("input",{type:"text",value:Ke.location,onChange:De=>ve({...Ke,location:De.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"IP Address"}),e.jsx("input",{type:"text",value:Ke.ip_address,onChange:De=>ve({...Ke,ip_address:De.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"192.168.1.100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Port"}),e.jsx("input",{type:"number",value:Ke.port,onChange:De=>ve({...Ke,port:De.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"4370"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"API Endpoint"}),e.jsx("input",{type:"text",value:Ke.api_endpoint,onChange:De=>ve({...Ke,api_endpoint:De.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:zt,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Save"})]})]}),se==="enrollment"&&e.jsxs("form",{onSubmit:Ts,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"User Type *"}),e.jsxs("select",{value:ie.user_type,onChange:De=>q({...ie,user_type:De.target.value,user_id:""}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"student",children:"Student"}),e.jsx("option",{value:"teacher",children:"Teacher"}),e.jsx("option",{value:"employee",children:"Employee"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Select User *"}),e.jsxs("select",{value:ie.user_id,onChange:De=>q({...ie,user_id:De.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select..."}),ie.user_type==="student"&&A.map(De=>e.jsxs("option",{value:De.id,children:[De.first_name," ",De.last_name," (",De.student_id,")"]},De.id)),ie.user_type==="teacher"&&N.map(De=>e.jsxs("option",{value:De.id,children:[De.first_name," ",De.last_name]},De.id)),ie.user_type==="employee"&&y.map(De=>e.jsxs("option",{value:De.id,children:[De.first_name," ",De.last_name," (",De.employee_number,")"]},De.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Biometric Type *"}),e.jsxs("select",{value:ie.biometric_type,onChange:De=>q({...ie,biometric_type:De.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"fingerprint",children:"Fingerprint"}),e.jsx("option",{value:"face",children:"Face"}),e.jsx("option",{value:"rfid",children:"RFID"}),e.jsx("option",{value:"iris",children:"Iris"})]})]}),ie.biometric_type==="fingerprint"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Finger Position"}),e.jsxs("select",{value:ie.finger_position,onChange:De=>q({...ie,finger_position:De.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Select..."}),e.jsx("option",{value:"right_thumb",children:"Right Thumb"}),e.jsx("option",{value:"right_index",children:"Right Index"}),e.jsx("option",{value:"left_thumb",children:"Left Thumb"}),e.jsx("option",{value:"left_index",children:"Left Index"})]})]}),ie.biometric_type==="rfid"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"RFID Card Number *"}),e.jsx("input",{type:"text",value:ie.rfid_card_number,onChange:De=>q({...ie,rfid_card_number:De.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-sm text-yellow-800",children:[e.jsx(_s,{size:16,className:"inline mr-2"}),"In production, biometric template data would be captured from the actual device. This form simulates enrollment."]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:zt,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Enroll"})]})]}),se==="visitor"&&e.jsxs("form",{onSubmit:he,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Visitor Name *"}),e.jsx("input",{type:"text",value:pe.visitor_name,onChange:De=>Me({...pe,visitor_name:De.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phone"}),e.jsx("input",{type:"text",value:pe.phone,onChange:De=>Me({...pe,phone:De.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),e.jsx("input",{type:"email",value:pe.email,onChange:De=>Me({...pe,email:De.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"ID Type"}),e.jsxs("select",{value:pe.id_type,onChange:De=>Me({...pe,id_type:De.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Select..."}),e.jsx("option",{value:"national_id",children:"National ID"}),e.jsx("option",{value:"passport",children:"Passport"}),e.jsx("option",{value:"drivers_license",children:"Driver's License"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"ID Number"}),e.jsx("input",{type:"text",value:pe.id_number,onChange:De=>Me({...pe,id_number:De.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Purpose of Visit *"}),e.jsx("textarea",{value:pe.purpose_of_visit,onChange:De=>Me({...pe,purpose_of_visit:De.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Host Name"}),e.jsx("input",{type:"text",value:pe.host_name,onChange:De=>Me({...pe,host_name:De.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Host Department"}),e.jsx("input",{type:"text",value:pe.host_department,onChange:De=>Me({...pe,host_department:De.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Expected Date"}),e.jsx("input",{type:"date",value:pe.expected_date,onChange:De=>Me({...pe,expected_date:De.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Temperature (C)"}),e.jsx("input",{type:"number",step:"0.1",value:pe.temperature,onChange:De=>Me({...pe,temperature:De.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"36.5"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:zt,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Register"})]})]}),se==="zone"&&e.jsxs("form",{onSubmit:Te,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Zone Name *"}),e.jsx("input",{type:"text",value:Se.zone_name,onChange:De=>Ne({...Se,zone_name:De.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),e.jsx("textarea",{value:Se.description,onChange:De=>Ne({...Se,description:De.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Access Level"}),e.jsxs("select",{value:Se.access_level,onChange:De=>Ne({...Se,access_level:De.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"restricted",children:"Restricted"}),e.jsx("option",{value:"high_security",children:"High Security"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Assign Devices"}),e.jsx("div",{className:"border rounded-lg p-3 max-h-40 overflow-y-auto space-y-2",children:t.map(De=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:(Se.devices||[]).includes(De.id),onChange:Jt=>{const rs=Se.devices||[];Ne({...Se,devices:Jt.target.checked?[...rs,De.id]:rs.filter(dr=>dr!==De.id)})}}),De.device_name]},De.id))})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:zt,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Save"})]})]}),se==="schedule"&&e.jsxs("form",{onSubmit:bt,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Schedule Name *"}),e.jsx("input",{type:"text",value:et.schedule_name,onChange:De=>Ce({...et,schedule_name:De.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"User Type"}),e.jsxs("select",{value:et.user_type,onChange:De=>Ce({...et,user_type:De.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"student",children:"Students"}),e.jsx("option",{value:"teacher",children:"Teachers"}),e.jsx("option",{value:"employee",children:"Employees"}),e.jsx("option",{value:"all",children:"All"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Start Time"}),e.jsx("input",{type:"time",value:et.start_time,onChange:De=>Ce({...et,start_time:De.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"End Time"}),e.jsx("input",{type:"time",value:et.end_time,onChange:De=>Ce({...et,end_time:De.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Days"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["monday","tuesday","wednesday","thursday","friday","saturday","sunday"].map(De=>e.jsxs("label",{className:`px-3 py-2 rounded-lg cursor-pointer ${(et.days||[]).includes(De)?"bg-blue-600 text-white":"bg-gray-100"}`,children:[e.jsx("input",{type:"checkbox",className:"hidden",checked:(et.days||[]).includes(De),onChange:Jt=>{const rs=et.days||[];Ce({...et,days:Jt.target.checked?[...rs,De]:rs.filter(dr=>dr!==De)})}}),De.charAt(0).toUpperCase()+De.slice(1,3)]},De))})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:zt,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Save"})]})]}),se==="bulk_enrollment"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"User Type"}),e.jsxs("select",{value:ie.user_type,onChange:De=>q({...ie,user_type:De.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"student",children:"Students"}),e.jsx("option",{value:"teacher",children:"Teachers"}),e.jsx("option",{value:"employee",children:"Employees"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Biometric Type"}),e.jsxs("select",{value:ie.biometric_type,onChange:De=>q({...ie,biometric_type:De.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"fingerprint",children:"Fingerprint"}),e.jsx("option",{value:"face",children:"Face"}),e.jsx("option",{value:"rfid",children:"RFID"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Select Users (",Pe.length," selected)"]}),e.jsx("div",{className:"border rounded-lg p-3 max-h-48 overflow-y-auto space-y-1",children:(ie.user_type==="student"?A:ie.user_type==="teacher"?N:y).map(De=>e.jsxs("label",{className:"flex items-center gap-2 p-1 hover:bg-gray-50 rounded",children:[e.jsx("input",{type:"checkbox",checked:Pe.includes(De.id),onChange:Jt=>we(Jt.target.checked?[...Pe,De.id]:Pe.filter(rs=>rs!==De.id))}),De.first_name," ",De.last_name]},De.id))})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:zt,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsxs("button",{onClick:He,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:["Enroll ",Pe.length," Users"]})]})]})]})]})})]})}const Yr=`${ee}/multi_school.php`;function wT(){const[t,s]=h.useState([]),[a,r]=h.useState([]),[l,c]=h.useState([]),[o,m]=h.useState([]),[u,x]=h.useState([]),[A,g]=h.useState([]),[N,f]=h.useState([]),[y,v]=h.useState(!0),[U,D]=h.useState("dashboard"),[M,K]=h.useState(!1),[$,P]=h.useState(""),[se,z]=h.useState(null),[R,j]=h.useState(null),[T,Q]=h.useState(""),[E,te]=h.useState(""),[C,O]=h.useState(""),[V,re]=h.useState([]),[ge,xe]=h.useState([]),[Z,I]=h.useState([]),[H,ae]=h.useState([]),[k,B]=h.useState([]),[w,oe]=h.useState([]),[ne,Fe]=h.useState([]),[je,Ge]=h.useState([]),[ze,Xe]=h.useState({branch_name:"",branch_code:"",branch_type:"branch",address:"",city:"",state:"",country:"Ghana",phone:"",email:"",subscription_plan:"pro",max_students:2e3,max_staff:200,status:"active",parent_branch_id:""}),[st,ce]=h.useState({transfer_type:"student",entity_id:"",from_branch_id:"",to_branch_id:"",transfer_date:"",reason:""}),[_e,le]=h.useState({resource_type:"document",resource_name:"",description:"",file_path:"",owner_branch_id:"",shared_with:[],category:"",is_public:!1}),[Pe,we]=h.useState({communication_type:"announcement",subject:"",message:"",from_branch_id:"",to_branches:"all",priority:"normal",template_id:""}),[fe,ye]=h.useState({report_type:"financial",branches:[],start_date:"",end_date:""}),[Ke,ve]=h.useState({name:"",type:"announcement",subject:"",message:""});h.useEffect(()=>{Promise.all([ie(),Ce(),ft(),W(),Ie()]).then(()=>v(!1))},[]),h.useEffect(()=>{U==="transfers"&&(q(),pe()),U==="resources"&&Me(),U==="communications"&&(Se(),Ne()),U==="reports"&&et(),U==="audit"&&qe()},[U]);const ie=async()=>{try{const he=await F.get(`${Yr}?resource=branches`);s(he.data.branches||[])}catch(he){console.error(he)}},q=async()=>{try{const he=await F.get(`${Yr}?resource=transfers&action=pending`);r(he.data.transfers||[])}catch(he){console.error(he)}},pe=async()=>{try{const he=await F.get(`${Yr}?resource=transfers&action=history`);re(he.data.transfers||[])}catch(he){console.error(he)}},Me=async()=>{try{const he=await F.get(`${Yr}?resource=shared_resources&branch_id=${R?.id||1}`);c(he.data.resources||[])}catch(he){console.error(he)}},Se=async()=>{try{const he=await F.get(`${Yr}?resource=communications&branch_id=${R?.id||1}`);m(he.data.communications||[])}catch(he){console.error(he)}},Ne=async()=>{try{const he=await F.get(`${Yr}?resource=comm_templates`);I(he.data.templates||[])}catch(he){console.error(he)}},et=async()=>{try{const he=await F.get(`${Yr}?resource=consolidated_reports`);x(he.data.reports||[])}catch(he){console.error(he)}},Ce=async()=>{try{const he=await F.get(`${ee}/students.php`);g(he.data.students||[])}catch(he){console.error(he)}},ft=async()=>{try{const he=await F.get(`${ee}/teachers.php`);f(he.data.teachers||[])}catch(he){console.error(he)}},qe=async()=>{try{const he=await F.get(`${Yr}?resource=audit_logs`);B(he.data.logs||[])}catch(he){console.error(he)}},W=async()=>{try{const he=await F.get(`${Yr}?resource=sync_status`);oe(he.data.sync_status||[])}catch(he){console.error(he)}},Ie=async()=>{try{const he=await F.get(`${Yr}?resource=branch_revenue`);Fe(he.data.revenue||[])}catch(he){console.error(he)}},mt=t.filter(he=>{const Ht=!T||he.branch_name?.toLowerCase().includes(T.toLowerCase())||he.branch_code?.toLowerCase().includes(T.toLowerCase())||he.city?.toLowerCase().includes(T.toLowerCase()),Zt=!E||he.status===E,Ee=!C||he.subscription_plan===C;return Ht&&Zt&&Ee}),pt=he=>{const Ht=new ms;Ht.setFontSize(18),Ht.text(`Multi-School ${he.charAt(0).toUpperCase()+he.slice(1)} Report`,14,22),Ht.setFontSize(10),Ht.text(`Generated: ${new Date().toLocaleString()}`,14,30),he==="branches"?Ma(Ht,{startY:35,head:[["Name","Code","City","Students","Teachers","Plan","Status"]],body:mt.map(Zt=>[Zt.branch_name,Zt.branch_code,Zt.city||"-",Zt.total_students||0,Zt.total_teachers||0,Zt.subscription_plan,Zt.status])}):he==="transfers"?Ma(Ht,{startY:35,head:[["Type","From","To","Date","Status"]],body:a.map(Zt=>[Zt.transfer_type,Zt.from_branch_name,Zt.to_branch_name,Zt.transfer_date,Zt.status])}):he==="revenue"&&Ma(Ht,{startY:35,head:[["Branch","Revenue","Expenses","Net"]],body:ne.map(Zt=>[Zt.branch_name,`GHS ${Zt.revenue?.toLocaleString()||0}`,`GHS ${Zt.expenses?.toLocaleString()||0}`,`GHS ${(Zt.revenue-Zt.expenses).toLocaleString()||0}`])}),Ht.save(`multi_school_${he}_${new Date().toISOString().split("T")[0]}.pdf`)},kt=he=>{let Ht="";Ht=`Name,Code,City,Students,Teachers,Plan,Status
`+mt.map(zt=>`"${zt.branch_name}",${zt.branch_code},${zt.city||"-"},${zt.total_students||0},${zt.total_teachers||0},${zt.subscription_plan},${zt.status}`).join(`
`);const Zt=new Blob([Ht],{type:"text/csv"}),Ee=document.createElement("a");Ee.href=URL.createObjectURL(Zt),Ee.download=`multi_school_${he}_${new Date().toISOString().split("T")[0]}.csv`,Ee.click()},J=async he=>{he.preventDefault();try{se?.id?await F.put(`${Yr}?resource=branches&id=${se.id}`,ze):await F.post(`${Yr}?resource=branches`,ze),alert(" Branch saved!"),ie(),Et()}catch{alert("Failed to save")}},Je=async he=>{he.preventDefault();try{await F.post(`${Yr}?resource=transfers`,st),alert(" Transfer request submitted!"),q(),Et()}catch{alert("Failed to save")}},_t=async he=>{if(confirm("Approve this transfer?"))try{await F.put(`${Yr}?resource=transfers&id=${he}&action=approve`,{approved_by:1}),alert(" Transfer approved!"),q()}catch{alert("Failed")}},$t=async he=>{if(confirm("Reject this transfer?"))try{await F.put(`${Yr}?resource=transfers&id=${he}&action=reject`,{approved_by:1}),alert("Transfer rejected"),q()}catch{alert("Failed")}},me=async he=>{he.preventDefault();try{await F.post(`${Yr}?resource=shared_resources`,_e),alert(" Resource shared!"),Me(),Et()}catch{alert("Failed to save")}},Ze=async he=>{he.preventDefault();try{await F.post(`${Yr}?resource=communications`,Pe),alert(" Communication sent!"),Se(),Et()}catch{alert("Failed to send")}},ct=async he=>{he.preventDefault();try{const Ht=new URLSearchParams({resource:"consolidated_reports",action:"generate",report_type:fe.report_type,branches:JSON.stringify(fe.branches),start_date:fe.start_date,end_date:fe.end_date});(await F.get(`${Yr}?${Ht}`)).data.success&&(alert(" Report generated!"),et(),Et())}catch{alert("Failed to generate")}},Yt=async he=>{if(he.preventDefault(),ge.length===0){alert("Select students first");return}try{await F.post(`${Yr}?resource=transfers&action=bulk`,{...st,student_ids:ge}),alert(` ${ge.length} transfer requests submitted!`),q(),xe([]),Et()}catch{alert("Failed")}},be=async he=>{he.preventDefault();try{await F.post(`${Yr}?resource=comm_templates`,Ke),alert(" Template saved!"),Ne(),Et()}catch{alert("Failed")}},lt=he=>{we({...Pe,subject:he.subject,message:he.message,template_id:he.id})},Ue=async he=>{try{await F.post(`${Yr}?resource=sync_status&action=sync&branch_id=${he}`),alert(" Sync initiated!"),W()}catch{alert("Failed")}},Ct=(he,Ht=null)=>{P(he),z(Ht),he==="branch"?Xe(Ht||{branch_name:"",branch_code:"",branch_type:"branch",address:"",city:"",state:"",country:"Ghana",phone:"",email:"",subscription_plan:"pro",max_students:2e3,max_staff:200,status:"active",parent_branch_id:""}):he==="transfer"?ce({transfer_type:"student",entity_id:"",from_branch_id:"",to_branch_id:"",transfer_date:new Date().toISOString().split("T")[0],reason:""}):he==="bulk_transfer"?(ce({transfer_type:"student",from_branch_id:"",to_branch_id:"",transfer_date:new Date().toISOString().split("T")[0],reason:""}),xe([])):he==="resource"?le({resource_type:"document",resource_name:"",description:"",file_path:"",owner_branch_id:t[0]?.id||"",shared_with:[],category:"",is_public:!1}):he==="communication"?we({communication_type:"announcement",subject:"",message:"",from_branch_id:t[0]?.id||"",to_branches:"all",priority:"normal",template_id:""}):he==="template"?ve({name:"",type:"announcement",subject:"",message:""}):he==="report"?ye({report_type:"financial",branches:t.map(Zt=>Zt.id),start_date:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0],end_date:new Date().toISOString().split("T")[0]}):he==="compare"&&Ge([]),K(!0)},Et=()=>{K(!1),z(null)},Rs=he=>({active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",suspended:"bg-red-100 text-red-800",trial:"bg-yellow-100 text-yellow-800",pending:"bg-yellow-100 text-yellow-800",approved:"bg-blue-100 text-blue-800",completed:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"})[he]||"bg-gray-100 text-gray-800",He=he=>({free:"bg-gray-100 text-gray-800",pro:"bg-blue-100 text-blue-800",enterprise:"bg-purple-100 text-purple-800",ultimate:"bg-yellow-100 text-yellow-800"})[he]||"bg-gray-100 text-gray-800",Te=he=>({low:"bg-gray-100 text-gray-800",normal:"bg-blue-100 text-blue-800",high:"bg-orange-100 text-orange-800",urgent:"bg-red-100 text-red-800"})[he]||"bg-gray-100 text-gray-800",bt=he=>({synced:"bg-green-100 text-green-800",syncing:"bg-blue-100 text-blue-800",pending:"bg-yellow-100 text-yellow-800",error:"bg-red-100 text-red-800"})[he]||"bg-gray-100 text-gray-800",Xt=t.reduce((he,Ht)=>he+(parseInt(Ht.total_students)||0),0),ls=t.reduce((he,Ht)=>he+(parseInt(Ht.total_teachers)||0),0),Ts=ne.reduce((he,Ht)=>he+(parseFloat(Ht.revenue)||0),0),ss=t.filter(he=>he.status==="active").length;return y?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-start gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(mn,{className:"text-blue-600",size:32}),"Multi-School Management"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Centralized management for all school branches"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>pt("branches"),className:"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm",children:[e.jsx(xs,{size:16})," PDF"]}),e.jsxs("button",{onClick:()=>kt("branches"),className:"flex items-center gap-2 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm",children:[e.jsx(qo,{size:16})," CSV"]}),e.jsxs("button",{onClick:()=>Ct("compare"),className:"flex items-center gap-2 px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 text-sm",children:[e.jsx(Fs,{size:16})," Compare"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-blue-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Total Branches"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:t.length}),e.jsxs("p",{className:"text-xs text-gray-500",children:[ss," active"]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-green-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Total Students"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:Xt})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-purple-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Total Teachers"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:ls})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-orange-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Pending Transfers"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:a.length})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-cyan-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Shared Resources"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-600",children:l.length})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-emerald-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Total Revenue"}),e.jsxs("p",{className:"text-2xl font-bold text-emerald-600",children:["GHS ",Ts.toLocaleString()]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-indigo-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Communications"}),e.jsx("p",{className:"text-2xl font-bold text-indigo-600",children:o.length})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-pink-500",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"Audit Logs"}),e.jsx("p",{className:"text-2xl font-bold text-pink-600",children:k.length})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-[200px] relative",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",placeholder:"Search branches...",value:T,onChange:he=>Q(he.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]}),e.jsxs("select",{value:E,onChange:he=>te(he.target.value),className:"border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"suspended",children:"Suspended"}),e.jsx("option",{value:"trial",children:"Trial"})]}),e.jsxs("select",{value:C,onChange:he=>O(he.target.value),className:"border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"All Plans"}),e.jsx("option",{value:"free",children:"Free"}),e.jsx("option",{value:"pro",children:"Pro"}),e.jsx("option",{value:"enterprise",children:"Enterprise"}),e.jsx("option",{value:"ultimate",children:"Ultimate"})]}),e.jsx("button",{onClick:()=>{Q(""),te(""),O("")},className:"text-sm text-gray-500 hover:text-gray-700",children:"Clear"})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"border-b",children:e.jsx("div",{className:"flex flex-wrap",children:[{id:"dashboard",label:"Dashboard",icon:Gl},{id:"branches",label:"Branches",icon:mn},{id:"transfers",label:"Transfers",icon:fN},{id:"resources",label:"Resources",icon:$o},{id:"communications",label:"Comms",icon:wa},{id:"reports",label:"Reports",icon:Fs},{id:"revenue",label:"Revenue",icon:vs},{id:"sync",label:"Sync",icon:Pu},{id:"audit",label:"Audit",icon:Sa}].map(he=>e.jsxs("button",{onClick:()=>D(he.id),className:`px-3 py-2 font-medium flex items-center gap-1 text-xs ${U===he.id?"border-b-2 border-blue-600 text-blue-600 bg-blue-50":"text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(he.icon,{size:14})," ",he.label]},he.id))})}),e.jsxs("div",{className:"p-6",children:[U==="dashboard"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Gl,{className:"text-blue-600"})," Multi-School Dashboard"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium mb-4",children:"Branches by Status"}),e.jsx("div",{className:"space-y-2",children:["active","inactive","suspended","trial"].map(he=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded ${he==="active"?"bg-green-500":he==="inactive"?"bg-gray-500":he==="suspended"?"bg-red-500":"bg-yellow-500"}`}),e.jsx("span",{className:"flex-1 text-sm capitalize",children:he}),e.jsx("span",{className:"font-medium",children:t.filter(Ht=>Ht.status===he).length})]},he))})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium mb-4",children:"Branches by Plan"}),e.jsx("div",{className:"space-y-2",children:["free","pro","enterprise","ultimate"].map(he=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded ${he==="free"?"bg-gray-500":he==="pro"?"bg-blue-500":he==="enterprise"?"bg-purple-500":"bg-yellow-500"}`}),e.jsx("span",{className:"flex-1 text-sm capitalize",children:he}),e.jsx("span",{className:"font-medium",children:t.filter(Ht=>Ht.subscription_plan===he).length})]},he))})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium mb-4",children:"Top Branches by Students"}),e.jsx("div",{className:"space-y-2",children:[...t].sort((he,Ht)=>(Ht.total_students||0)-(he.total_students||0)).slice(0,5).map(he=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"flex-1 text-sm truncate",children:he.branch_name}),e.jsx("span",{className:"font-medium text-blue-600",children:he.total_students||0})]},he.id))})]})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium mb-4 flex items-center gap-2",children:[e.jsx(vs,{className:"text-green-600"})," Revenue by Branch"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:ne.slice(0,8).map(he=>e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:he.branch_name}),e.jsxs("p",{className:"text-lg font-bold text-green-600",children:["GHS ",(he.revenue||0).toLocaleString()]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Net: GHS ",((he.revenue||0)-(he.expenses||0)).toLocaleString()]})]},he.branch_id))})]})]}),U==="branches"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-xl font-semibold",children:["School Branches (",mt.length,")"]}),e.jsxs("button",{onClick:()=>Ct("branch"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," Add Branch"]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:mt.map(he=>e.jsxs("div",{className:`border rounded-lg p-4 hover:shadow-lg transition-shadow ${he.is_headquarters?"border-yellow-400 bg-yellow-50":""}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[he.is_headquarters&&e.jsx(bN,{className:"text-yellow-600",size:20}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-lg",children:he.branch_name}),e.jsx("p",{className:"text-xs text-gray-500",children:he.branch_code})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs ${Rs(he.status)}`,children:he.status}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${He(he.subscription_plan)}`,children:he.subscription_plan})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm text-gray-600 mb-3",children:[e.jsxs("p",{className:"flex items-center gap-1",children:[e.jsx(Qn,{size:14})," ",he.city||"-",", ",he.country||"Ghana"]}),he.phone&&e.jsxs("p",{className:"flex items-center gap-1",children:[e.jsx(er,{size:14})," ",he.phone]}),he.email&&e.jsxs("p",{className:"flex items-center gap-1",children:[e.jsx(ra,{size:14})," ",he.email]}),e.jsxs("p",{className:"flex items-center gap-1",children:[e.jsx(Rt,{size:14})," ",he.total_students||0," students"]}),e.jsxs("p",{className:"flex items-center gap-1",children:[e.jsx(Rt,{size:14})," ",he.total_teachers||0," teachers"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>{j(he),P("view_branch"),K(!0)},className:"flex-1 px-3 py-1 bg-blue-100 text-blue-700 rounded text-sm hover:bg-blue-200 flex items-center justify-center gap-1",children:[e.jsx(na,{size:14})," View"]}),e.jsx("button",{onClick:()=>Ct("branch",he),className:"px-3 py-1 bg-gray-100 rounded text-sm hover:bg-gray-200",children:e.jsx(ll,{size:14})})]})]},he.id))})]}),U==="transfers"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-2 mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Inter-Branch Transfers"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>Ct("bulk_transfer"),className:"bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 flex items-center gap-2",children:[e.jsx(Vc,{size:18})," Bulk Transfer"]}),e.jsxs("button",{onClick:()=>Ct("transfer"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," New Transfer"]})]})]}),e.jsxs("h4",{className:"font-medium mb-2",children:["Pending Transfers (",a.length,")"]}),a.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500 border rounded-lg mb-6",children:[e.jsx(fN,{size:32,className:"mx-auto mb-2 text-gray-300"}),e.jsx("p",{className:"text-sm",children:"No pending transfers"})]}):e.jsx("div",{className:"overflow-x-auto mb-6",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"From"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"To"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Reason"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:a.map(he=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 capitalize font-medium",children:he.transfer_type}),e.jsx("td",{className:"px-4 py-3",children:he.from_branch_name}),e.jsx("td",{className:"px-4 py-3",children:he.to_branch_name}),e.jsx("td",{className:"px-4 py-3",children:he.transfer_date}),e.jsx("td",{className:"px-4 py-3 text-sm max-w-xs truncate",children:he.reason||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${Rs(he.status)}`,children:he.status})}),e.jsx("td",{className:"px-4 py-3",children:he.status==="pending"&&e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>_t(he.id),className:"px-2 py-1 bg-green-100 text-green-700 rounded text-xs hover:bg-green-200",children:"Approve"}),e.jsx("button",{onClick:()=>$t(he.id),className:"px-2 py-1 bg-red-100 text-red-700 rounded text-xs hover:bg-red-200",children:"Reject"})]})})]},he.id))})]})}),e.jsxs("h4",{className:"font-medium mb-2 flex items-center gap-2",children:[e.jsx(Sa,{size:18})," Transfer History (",V.length,")"]}),V.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500 border rounded-lg",children:[e.jsx(Sa,{size:32,className:"mx-auto mb-2 text-gray-300"}),e.jsx("p",{className:"text-sm",children:"No transfer history"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"From"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"To"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Approved By"})]})}),e.jsx("tbody",{className:"divide-y",children:V.map(he=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 capitalize",children:he.transfer_type}),e.jsx("td",{className:"px-4 py-3",children:he.from_branch_name}),e.jsx("td",{className:"px-4 py-3",children:he.to_branch_name}),e.jsx("td",{className:"px-4 py-3",children:he.transfer_date}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${Rs(he.status)}`,children:he.status})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:he.approved_by_name||"-"})]},he.id))})]})})]}),U==="resources"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Shared Resources"}),e.jsxs("button",{onClick:()=>Ct("resource"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," Share Resource"]})]}),l.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx($o,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No shared resources"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l.map(he=>e.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"font-semibold",children:he.resource_name}),e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs capitalize",children:he.resource_type})]}),he.description&&e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:he.description}),e.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[e.jsxs("p",{children:["Owner: ",he.owner_branch_name]}),he.category&&e.jsxs("p",{children:["Category: ",he.category]}),e.jsx("p",{children:he.is_public?" Public":" Private"}),e.jsxs("p",{children:["Downloads: ",he.download_count||0]})]}),he.file_path&&e.jsxs("button",{className:"mt-2 w-full px-3 py-1 bg-gray-100 rounded text-sm hover:bg-gray-200 flex items-center justify-center gap-1",children:[e.jsx(xs,{size:14})," Download"]})]},he.id))})]}),U==="communications"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-2 mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Branch Communications"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>Ct("template"),className:"bg-gray-100 px-4 py-2 rounded-lg hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(vl,{size:18})," Templates"]}),e.jsxs("button",{onClick:()=>Ct("communication"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(va,{size:18})," New Message"]})]})]}),Z.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Quick Templates"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Z.map(he=>e.jsx("button",{onClick:()=>{lt(he),Ct("communication")},className:"px-3 py-1 bg-purple-100 text-purple-700 rounded-lg text-sm hover:bg-purple-200",children:he.name},he.id))})]}),o.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(wa,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No communications"})]}):e.jsx("div",{className:"space-y-4",children:o.map(he=>e.jsxs("div",{className:`border rounded-lg p-4 ${he.priority==="urgent"?"border-red-300 bg-red-50":he.priority==="high"?"border-orange-300 bg-orange-50":""}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:he.subject}),e.jsxs("p",{className:"text-xs text-gray-500",children:["From: ",he.from_branch_name||"Headquarters","  ",he.sent_at]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs ${Te(he.priority)}`,children:he.priority}),e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 rounded text-xs capitalize",children:he.communication_type}),he.read_count!==void 0&&e.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded text-xs",children:[he.read_count," read"]})]})]}),e.jsx("p",{className:"text-sm text-gray-700",children:he.message})]},he.id))})]}),U==="reports"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Consolidated Reports"}),e.jsxs("button",{onClick:()=>Ct("report"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(Fs,{size:18})," Generate Report"]})]}),u.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Fs,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No reports generated yet"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Report Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Period"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Generated"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:u.map(he=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:he.report_name}),e.jsx("td",{className:"px-4 py-3 capitalize",children:he.report_type}),e.jsxs("td",{className:"px-4 py-3 text-sm",children:[he.start_date," to ",he.end_date]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:he.generated_at}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${Rs(he.status)}`,children:he.status})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("button",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs hover:bg-blue-200 flex items-center gap-1",children:[e.jsx(na,{size:14})," View"]})})]},he.id))})]})})]}),U==="revenue"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx(vs,{className:"text-green-600"})," Revenue by Branch"]}),e.jsxs("button",{onClick:()=>pt("revenue"),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center gap-2",children:[e.jsx(xs,{size:18})," Export"]})]}),ne.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(vs,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No revenue data available"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Branch"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Revenue"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Expenses"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Net"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Students"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Revenue/Student"})]})}),e.jsx("tbody",{className:"divide-y",children:ne.map(he=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:he.branch_name}),e.jsxs("td",{className:"px-4 py-3 text-green-600 font-medium",children:["GHS ",(he.revenue||0).toLocaleString()]}),e.jsxs("td",{className:"px-4 py-3 text-red-600",children:["GHS ",(he.expenses||0).toLocaleString()]}),e.jsx("td",{className:"px-4 py-3 font-bold",children:he.revenue-he.expenses>=0?e.jsxs("span",{className:"text-green-600",children:["GHS ",((he.revenue||0)-(he.expenses||0)).toLocaleString()]}):e.jsxs("span",{className:"text-red-600",children:["-GHS ",Math.abs((he.revenue||0)-(he.expenses||0)).toLocaleString()]})}),e.jsx("td",{className:"px-4 py-3",children:he.total_students||0}),e.jsxs("td",{className:"px-4 py-3",children:["GHS ",he.total_students>0?Math.round((he.revenue||0)/he.total_students).toLocaleString():0]})]},he.branch_id))})]})})]}),U==="sync"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx(Pu,{className:"text-indigo-600"})," Data Sync Status"]}),e.jsxs("button",{onClick:W,className:"bg-gray-100 px-4 py-2 rounded-lg hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ns,{size:18})," Refresh"]})]}),w.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Pu,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No sync data available"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:w.map(he=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h4",{className:"font-semibold",children:he.branch_name}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${bt(he.status)}`,children:he.status})]}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("p",{children:["Last Sync: ",he.last_sync||"Never"]}),e.jsxs("p",{children:["Records: ",he.records_synced||0]}),he.error&&e.jsxs("p",{className:"text-red-600",children:["Error: ",he.error]})]}),e.jsxs("button",{onClick:()=>Ue(he.branch_id),className:"mt-3 w-full px-3 py-1 bg-indigo-100 text-indigo-700 rounded text-sm hover:bg-indigo-200 flex items-center justify-center gap-1",children:[e.jsx(Ns,{size:14})," Sync Now"]})]},he.branch_id))})]}),U==="audit"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx(Sa,{className:"text-pink-600"})," Audit Trail"]}),e.jsxs("button",{onClick:qe,className:"bg-gray-100 px-4 py-2 rounded-lg hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ns,{size:18})," Refresh"]})]}),k.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Sa,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No audit logs available"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Branch"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"User"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Action"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Entity"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Details"})]})}),e.jsx("tbody",{className:"divide-y",children:k.map(he=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:he.created_at}),e.jsx("td",{className:"px-4 py-3",children:he.branch_name||"All"}),e.jsx("td",{className:"px-4 py-3",children:he.user_name}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${he.action==="create"?"bg-green-100 text-green-800":he.action==="update"?"bg-blue-100 text-blue-800":he.action==="delete"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:he.action})}),e.jsx("td",{className:"px-4 py-3 capitalize",children:he.entity_type}),e.jsx("td",{className:"px-4 py-3 text-sm max-w-xs truncate",children:he.details||"-"})]},he.id))})]})})]})]})]}),M&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b sticky top-0 bg-white flex justify-between items-center",children:[e.jsxs("h2",{className:"text-xl font-bold",children:[$==="branch"&&(se?"Edit Branch":"Add Branch"),$==="transfer"&&"New Transfer Request",$==="bulk_transfer"&&"Bulk Transfer",$==="resource"&&"Share Resource",$==="communication"&&"Send Communication",$==="template"&&"Create Template",$==="report"&&"Generate Report",$==="compare"&&"Compare Branches",$==="view_branch"&&"Branch Details"]}),e.jsx("button",{onClick:Et,className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{size:20})})]}),e.jsxs("div",{className:"p-6",children:[$==="branch"&&e.jsxs("form",{onSubmit:J,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Branch Name *"}),e.jsx("input",{type:"text",value:ze.branch_name,onChange:he=>Xe({...ze,branch_name:he.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Branch Code *"}),e.jsx("input",{type:"text",value:ze.branch_code,onChange:he=>Xe({...ze,branch_code:he.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,placeholder:"e.g., EAST-001"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Type"}),e.jsxs("select",{value:ze.branch_type,onChange:he=>Xe({...ze,branch_type:he.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"main",children:"Main"}),e.jsx("option",{value:"branch",children:"Branch"}),e.jsx("option",{value:"franchise",children:"Franchise"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),e.jsxs("select",{value:ze.status,onChange:he=>Xe({...ze,status:he.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"trial",children:"Trial"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Address"}),e.jsx("input",{type:"text",value:ze.address,onChange:he=>Xe({...ze,address:he.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"City"}),e.jsx("input",{type:"text",value:ze.city,onChange:he=>Xe({...ze,city:he.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"State"}),e.jsx("input",{type:"text",value:ze.state,onChange:he=>Xe({...ze,state:he.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Country"}),e.jsx("input",{type:"text",value:ze.country,onChange:he=>Xe({...ze,country:he.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phone"}),e.jsx("input",{type:"text",value:ze.phone,onChange:he=>Xe({...ze,phone:he.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),e.jsx("input",{type:"email",value:ze.email,onChange:he=>Xe({...ze,email:he.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Plan"}),e.jsxs("select",{value:ze.subscription_plan,onChange:he=>Xe({...ze,subscription_plan:he.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"free",children:"Free"}),e.jsx("option",{value:"pro",children:"Pro"}),e.jsx("option",{value:"enterprise",children:"Enterprise"}),e.jsx("option",{value:"ultimate",children:"Ultimate"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Max Students"}),e.jsx("input",{type:"number",value:ze.max_students,onChange:he=>Xe({...ze,max_students:he.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Max Staff"}),e.jsx("input",{type:"number",value:ze.max_staff,onChange:he=>Xe({...ze,max_staff:he.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:Et,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Save"})]})]}),$==="view_branch"&&R&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[R.is_headquarters&&e.jsx(bN,{className:"text-yellow-600",size:24}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold",children:R.branch_name}),e.jsx("p",{className:"text-gray-500",children:R.branch_code})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-gray-500",children:"Type"}),e.jsx("p",{className:"font-medium capitalize",children:R.branch_type})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-gray-500",children:"Status"}),e.jsx("p",{className:"font-medium capitalize",children:R.status})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-gray-500",children:"Location"}),e.jsxs("p",{className:"font-medium",children:[R.city,", ",R.country]})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-gray-500",children:"Plan"}),e.jsx("p",{className:"font-medium capitalize",children:R.subscription_plan})]}),e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-blue-600",children:"Students"}),e.jsx("p",{className:"text-2xl font-bold text-blue-700",children:R.total_students||0})]}),e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-green-600",children:"Teachers"}),e.jsx("p",{className:"text-2xl font-bold text-green-700",children:R.total_teachers||0})]})]}),(R.phone||R.email)&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Contact"}),e.jsxs("div",{className:"text-sm text-gray-600",children:[R.phone&&e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(er,{size:14})," ",R.phone]}),R.email&&e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(ra,{size:14})," ",R.email]})]})]}),e.jsx("div",{className:"flex gap-3 pt-4",children:e.jsx("button",{onClick:Et,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Close"})})]}),$==="transfer"&&e.jsxs("form",{onSubmit:Je,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Transfer Type *"}),e.jsxs("select",{value:st.transfer_type,onChange:he=>ce({...st,transfer_type:he.target.value,entity_id:""}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"student",children:"Student"}),e.jsx("option",{value:"staff",children:"Staff"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Select ",st.transfer_type==="student"?"Student":"Staff"," *"]}),e.jsxs("select",{value:st.entity_id,onChange:he=>ce({...st,entity_id:he.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select..."}),st.transfer_type==="student"?A.map(he=>e.jsxs("option",{value:he.id,children:[he.first_name," ",he.last_name," (",he.student_id,")"]},he.id)):N.map(he=>e.jsxs("option",{value:he.id,children:[he.first_name," ",he.last_name]},he.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"From Branch *"}),e.jsxs("select",{value:st.from_branch_id,onChange:he=>ce({...st,from_branch_id:he.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select..."}),t.map(he=>e.jsx("option",{value:he.id,children:he.branch_name},he.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"To Branch *"}),e.jsxs("select",{value:st.to_branch_id,onChange:he=>ce({...st,to_branch_id:he.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select..."}),t.filter(he=>he.id!=st.from_branch_id).map(he=>e.jsx("option",{value:he.id,children:he.branch_name},he.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Transfer Date *"}),e.jsx("input",{type:"date",value:st.transfer_date,onChange:he=>ce({...st,transfer_date:he.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Reason"}),e.jsx("textarea",{value:st.reason,onChange:he=>ce({...st,reason:he.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:Et,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Submit Request"})]})]}),$==="resource"&&e.jsxs("form",{onSubmit:me,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Resource Name *"}),e.jsx("input",{type:"text",value:_e.resource_name,onChange:he=>le({..._e,resource_name:he.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Type"}),e.jsxs("select",{value:_e.resource_type,onChange:he=>le({..._e,resource_type:he.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"curriculum",children:"Curriculum"}),e.jsx("option",{value:"assessment",children:"Assessment"}),e.jsx("option",{value:"document",children:"Document"}),e.jsx("option",{value:"template",children:"Template"}),e.jsx("option",{value:"policy",children:"Policy"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Category"}),e.jsx("input",{type:"text",value:_e.category,onChange:he=>le({..._e,category:he.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),e.jsx("textarea",{value:_e.description,onChange:he=>le({..._e,description:he.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Owner Branch *"}),e.jsxs("select",{value:_e.owner_branch_id,onChange:he=>le({..._e,owner_branch_id:he.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select..."}),t.map(he=>e.jsx("option",{value:he.id,children:he.branch_name},he.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"File Path"}),e.jsx("input",{type:"text",value:_e.file_path,onChange:he=>le({..._e,file_path:he.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"/uploads/resources/file.pdf"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"is_public",checked:_e.is_public,onChange:he=>le({..._e,is_public:he.target.checked})}),e.jsx("label",{htmlFor:"is_public",className:"text-sm",children:"Make public to all branches"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:Et,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Share"})]})]}),$==="communication"&&e.jsxs("form",{onSubmit:Ze,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Type"}),e.jsxs("select",{value:Pe.communication_type,onChange:he=>we({...Pe,communication_type:he.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"announcement",children:"Announcement"}),e.jsx("option",{value:"notice",children:"Notice"}),e.jsx("option",{value:"alert",children:"Alert"}),e.jsx("option",{value:"message",children:"Message"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Priority"}),e.jsxs("select",{value:Pe.priority,onChange:he=>we({...Pe,priority:he.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"urgent",children:"Urgent"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Subject *"}),e.jsx("input",{type:"text",value:Pe.subject,onChange:he=>we({...Pe,subject:he.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Message *"}),e.jsx("textarea",{value:Pe.message,onChange:he=>we({...Pe,message:he.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:4,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"From Branch"}),e.jsxs("select",{value:Pe.from_branch_id,onChange:he=>we({...Pe,from_branch_id:he.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Headquarters"}),t.map(he=>e.jsx("option",{value:he.id,children:he.branch_name},he.id))]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:Et,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center justify-center gap-2",children:[e.jsx(va,{size:18})," Send"]})]})]}),$==="report"&&e.jsxs("form",{onSubmit:ct,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Report Type *"}),e.jsxs("select",{value:fe.report_type,onChange:he=>ye({...fe,report_type:he.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"financial",children:"Financial"}),e.jsx("option",{value:"academic",children:"Academic"}),e.jsx("option",{value:"attendance",children:"Attendance"}),e.jsx("option",{value:"enrollment",children:"Enrollment"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Start Date *"}),e.jsx("input",{type:"date",value:fe.start_date,onChange:he=>ye({...fe,start_date:he.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"End Date *"}),e.jsx("input",{type:"date",value:fe.end_date,onChange:he=>ye({...fe,end_date:he.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Select Branches"}),e.jsx("div",{className:"border rounded-lg p-3 max-h-40 overflow-y-auto space-y-2",children:t.map(he=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:fe.branches.includes(he.id),onChange:Ht=>{Ht.target.checked?ye({...fe,branches:[...fe.branches,he.id]}):ye({...fe,branches:fe.branches.filter(Zt=>Zt!==he.id)})}}),e.jsx("span",{className:"text-sm",children:he.branch_name})]},he.id))})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:Et,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center justify-center gap-2",children:[e.jsx(Fs,{size:18})," Generate"]})]})]}),$==="bulk_transfer"&&e.jsxs("form",{onSubmit:Yt,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"From Branch *"}),e.jsxs("select",{value:st.from_branch_id,onChange:he=>ce({...st,from_branch_id:he.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select..."}),t.map(he=>e.jsx("option",{value:he.id,children:he.branch_name},he.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"To Branch *"}),e.jsxs("select",{value:st.to_branch_id,onChange:he=>ce({...st,to_branch_id:he.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select..."}),t.filter(he=>he.id!=st.from_branch_id).map(he=>e.jsx("option",{value:he.id,children:he.branch_name},he.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Transfer Date *"}),e.jsx("input",{type:"date",value:st.transfer_date,onChange:he=>ce({...st,transfer_date:he.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Select Students (",ge.length," selected)"]}),e.jsx("div",{className:"border rounded-lg p-3 max-h-48 overflow-y-auto space-y-1",children:A.slice(0,100).map(he=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer p-1 hover:bg-gray-50 rounded",children:[e.jsx("input",{type:"checkbox",checked:ge.includes(he.id),onChange:Ht=>{Ht.target.checked?xe([...ge,he.id]):xe(ge.filter(Zt=>Zt!==he.id))}}),e.jsxs("span",{className:"text-sm",children:[he.first_name," ",he.last_name," (",he.student_id,")"]})]},he.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Reason"}),e.jsx("textarea",{value:st.reason,onChange:he=>ce({...st,reason:he.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:Et,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"flex-1 bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 flex items-center justify-center gap-2",children:[e.jsx(Vc,{size:18})," Transfer ",ge.length," Students"]})]})]}),$==="template"&&e.jsxs("form",{onSubmit:be,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Template Name *"}),e.jsx("input",{type:"text",value:Ke.name,onChange:he=>ve({...Ke,name:he.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,placeholder:"e.g., Fee Reminder"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Type"}),e.jsxs("select",{value:Ke.type,onChange:he=>ve({...Ke,type:he.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"announcement",children:"Announcement"}),e.jsx("option",{value:"notice",children:"Notice"}),e.jsx("option",{value:"alert",children:"Alert"}),e.jsx("option",{value:"message",children:"Message"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Subject *"}),e.jsx("input",{type:"text",value:Ke.subject,onChange:he=>ve({...Ke,subject:he.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Message *"}),e.jsx("textarea",{value:Ke.message,onChange:he=>ve({...Ke,message:he.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:4,required:!0})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:Et,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700",children:"Save Template"})]})]}),$==="compare"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Select Branches to Compare (max 4)"}),e.jsx("div",{className:"border rounded-lg p-3 max-h-48 overflow-y-auto space-y-1",children:t.map(he=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer p-1 hover:bg-gray-50 rounded",children:[e.jsx("input",{type:"checkbox",checked:je.includes(he.id),disabled:!je.includes(he.id)&&je.length>=4,onChange:Ht=>{Ht.target.checked?Ge([...je,he.id]):Ge(je.filter(Zt=>Zt!==he.id))}}),e.jsx("span",{className:"text-sm",children:he.branch_name})]},he.id))})]}),je.length>=2&&e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left",children:"Metric"}),je.map(he=>{const Ht=t.find(Zt=>Zt.id===he);return e.jsx("th",{className:"px-3 py-2 text-center",children:Ht?.branch_name},he)})]})}),e.jsxs("tbody",{className:"divide-y",children:[e.jsxs("tr",{children:[e.jsx("td",{className:"px-3 py-2 font-medium",children:"Students"}),je.map(he=>{const Ht=t.find(Zt=>Zt.id===he);return e.jsx("td",{className:"px-3 py-2 text-center",children:Ht?.total_students||0},he)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-3 py-2 font-medium",children:"Teachers"}),je.map(he=>{const Ht=t.find(Zt=>Zt.id===he);return e.jsx("td",{className:"px-3 py-2 text-center",children:Ht?.total_teachers||0},he)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-3 py-2 font-medium",children:"Plan"}),je.map(he=>{const Ht=t.find(Zt=>Zt.id===he);return e.jsx("td",{className:"px-3 py-2 text-center capitalize",children:Ht?.subscription_plan},he)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-3 py-2 font-medium",children:"Status"}),je.map(he=>{const Ht=t.find(Zt=>Zt.id===he);return e.jsx("td",{className:"px-3 py-2 text-center capitalize",children:Ht?.status},he)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-3 py-2 font-medium",children:"Revenue"}),je.map(he=>{const Ht=ne.find(Zt=>Zt.branch_id===he);return e.jsxs("td",{className:"px-3 py-2 text-center text-green-600",children:["GHS ",(Ht?.revenue||0).toLocaleString()]},he)})]})]})]})}),e.jsx("div",{className:"flex gap-3 pt-4",children:e.jsx("button",{onClick:Et,className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Close"})})]})]})]})})]})}const Ga=`${ee}/ai_features.php`;function _T(){const[t,s]=h.useState("dashboard"),[a,r]=h.useState([]),[l,c]=h.useState([]),[o,m]=h.useState([]),[u,x]=h.useState([]),[A,g]=h.useState([]),[N,f]=h.useState([]),[y,v]=h.useState([]),[U,D]=h.useState(!1),[M,K]=h.useState(""),[$,P]=h.useState([]),[se,z]=h.useState("web_"+Date.now()),[R,j]=h.useState(""),[T,Q]=h.useState(""),[E,te]=h.useState(!1),[C,O]=h.useState(null),[V,re]=h.useState(""),[ge,xe]=h.useState(""),[Z,I]=h.useState(""),[H,ae]=h.useState(""),[k,B]=h.useState(""),[w,oe]=h.useState(""),[ne,Fe]=h.useState([]),[je,Ge]=h.useState([]),[ze,Xe]=h.useState([]),[st,ce]=h.useState([]),[_e,le]=h.useState({}),[Pe,we]=h.useState([]),[fe,ye]=h.useState({email_alerts:!0,risk_threshold:70,anomaly_alerts:!0}),[Ke,ve]=h.useState({predictions_by_type:[],accuracy_trend:[],insights_by_category:[]});h.useEffect(()=>{ie(),q(),Ie(),W()},[]),h.useEffect(()=>{t==="predictions"&&pe(),t==="recommendations"&&Me(),t==="insights"&&Se(),t==="anomalies"&&Ne(),t==="accuracy"&&et(),t==="scheduled"&&Ce(),t==="chat_history"&&ft(),t==="training"&&qe(),t==="learning"&&mt()},[t]);const ie=async()=>{try{const Ee=await F.get(`${ee}/students.php`);f(Ee.data.students||[])}catch(Ee){console.error(Ee)}},q=async()=>{try{const Ee=await F.get(`${ee}/subjects.php`);v(Ee.data.subjects||[])}catch(Ee){console.error(Ee)}},pe=async()=>{try{const Ee=await F.get(`${Ga}?resource=predictions`);r(Ee.data.predictions||[])}catch(Ee){console.error(Ee)}},Me=async()=>{try{const Ee=await F.get(`${Ga}?resource=recommendations&action=pending`);c(Ee.data.recommendations||[])}catch(Ee){console.error(Ee)}},Se=async()=>{try{const Ee=await F.get(`${Ga}?resource=insights&action=active`);m(Ee.data.insights||[])}catch(Ee){console.error(Ee)}},Ne=async()=>{try{const Ee=await F.get(`${Ga}?resource=anomalies&action=open`);x(Ee.data.anomalies||[])}catch(Ee){console.error(Ee)}},et=async()=>{try{const Ee=await F.get(`${Ga}?resource=predictions&action=accuracy`);Fe(Ee.data.accuracy||[])}catch(Ee){console.error(Ee)}},Ce=async()=>{try{const Ee=await F.get(`${Ga}?resource=scheduled_tasks`);Ge(Ee.data.tasks||[])}catch(Ee){console.error(Ee)}},ft=async()=>{try{const Ee=await F.get(`${Ga}?resource=chatbot&action=sessions`);Xe(Ee.data.sessions||[])}catch(Ee){console.error(Ee)}},qe=async()=>{try{const Ee=await F.get(`${Ga}?resource=chatbot&action=training_data`);ce(Ee.data.training_data||[])}catch(Ee){console.error(Ee)}},W=async()=>{try{const Ee=await F.get(`${Ga}?resource=settings`);le(Ee.data.settings||{}),ye(Ee.data.alert_settings||fe)}catch(Ee){console.error(Ee)}},Ie=async()=>{try{const Ee=await F.get(`${Ga}?resource=analytics`);ve(Ee.data.analytics||Ke)}catch(Ee){console.error(Ee)}},mt=async()=>{try{const Ee=await F.get(`${Ga}?resource=learning_paths`);g(Ee.data.learning_paths||[])}catch(Ee){console.error(Ee)}},pt=a.filter(Ee=>{const zt=!ge||Ee.entity_type?.toLowerCase().includes(ge.toLowerCase()),is=!Z||Ee.prediction_type===Z;return zt&&is}),kt=o.filter(Ee=>{const zt=!ge||Ee.title?.toLowerCase().includes(ge.toLowerCase()),is=!w||Ee.category===w;return zt&&is}),J=u.filter(Ee=>{const zt=!ge||Ee.description?.toLowerCase().includes(ge.toLowerCase()),is=!Z||Ee.anomaly_type===Z;return zt&&is}),Je=Ee=>{const zt=new ms;zt.setFontSize(18),zt.text(`AI ${Ee.charAt(0).toUpperCase()+Ee.slice(1)} Report`,14,22),zt.setFontSize(10),zt.text(`Generated: ${new Date().toLocaleString()}`,14,30),Ee==="predictions"?Ma(zt,{startY:35,head:[["Type","Entity","Confidence","Date","Status"]],body:pt.map(is=>[is.prediction_type,`${is.entity_type} #${is.entity_id}`,`${((is.confidence_score||0)*100).toFixed(0)}%`,is.prediction_date,is.status])}):Ee==="insights"?Ma(zt,{startY:35,head:[["Title","Category","Impact","Confidence"]],body:kt.map(is=>[is.title,is.category,is.impact_level,`${((is.confidence_level||0)*100).toFixed(0)}%`])}):Ee==="anomalies"&&Ma(zt,{startY:35,head:[["Type","Entity","Severity","Deviation","Date"]],body:J.map(is=>[is.anomaly_type,`${is.entity_type} #${is.entity_id}`,is.severity,`${is.deviation_percentage?.toFixed(1)}%`,is.detection_date])}),zt.save(`ai_${Ee}_${new Date().toISOString().split("T")[0]}.pdf`)},_t=Ee=>{let zt="";Ee==="predictions"?zt=`Type,Entity,Confidence,Date,Status
`+pt.map(ba=>`${ba.prediction_type},${ba.entity_type} #${ba.entity_id},${((ba.confidence_score||0)*100).toFixed(0)}%,${ba.prediction_date},${ba.status}`).join(`
`):Ee==="insights"&&(zt=`Title,Category,Impact,Confidence
`+kt.map(ba=>`"${ba.title}",${ba.category},${ba.impact_level},${((ba.confidence_level||0)*100).toFixed(0)}%`).join(`
`));const is=new Blob([zt],{type:"text/csv"}),pa=document.createElement("a");pa.href=URL.createObjectURL(is),pa.download=`ai_${Ee}_${new Date().toISOString().split("T")[0]}.csv`,pa.click()},$t=async Ee=>{if(Pe.length===0){alert("Select students first");return}D(!0);try{const zt=await F.post(`${Ga}?resource=predictions&action=batch`,{student_ids:Pe,prediction_type:Ee});zt.data.success&&(alert(` Generated ${zt.data.count} predictions!`),pe(),we([]))}catch{alert("Failed")}D(!1)},me=async Ee=>{Ee.preventDefault();try{C?.id?await F.put(`${Ga}?resource=scheduled_tasks&id=${C.id}`,C):await F.post(`${Ga}?resource=scheduled_tasks`,C),alert(" Task saved!"),Ce(),te(!1)}catch{alert("Failed")}},Ze=async(Ee,zt)=>{try{await F.put(`${Ga}?resource=scheduled_tasks&id=${Ee}&action=toggle`,{status:zt==="active"?"paused":"active"}),Ce()}catch{alert("Failed")}},ct=async Ee=>{Ee.preventDefault();try{await F.post(`${Ga}?resource=chatbot&action=add_training`,C),alert(" Training data added!"),qe(),te(!1)}catch{alert("Failed")}},Yt=async()=>{try{await F.put(`${Ga}?resource=settings`,{settings:_e,alert_settings:fe}),alert(" Settings saved!")}catch{alert("Failed")}},be=async(Ee,zt,is)=>{try{await F.put(`${Ga}?resource=learning_paths&id=${Ee}&action=progress`,{milestone:zt,completed:is}),mt()}catch{alert("Failed")}},lt=async()=>{if(!R){alert("Select a student");return}D(!0);try{const Ee=await F.get(`${Ga}?resource=predictions&action=student_performance&student_id=${R}`);Ee.data.success&&(O({type:"prediction",title:"Performance Prediction",data:Ee.data.prediction}),te(!0),pe())}catch{alert("Failed")}D(!1)},Ue=async()=>{if(!R){alert("Select a student");return}D(!0);try{const Ee=await F.get(`${Ga}?resource=predictions&action=dropout_risk&student_id=${R}`);Ee.data.success&&(O({type:"risk",title:"Dropout Risk Assessment",data:Ee.data.risk_assessment}),te(!0),pe())}catch{alert("Failed")}D(!1)},Ct=async()=>{D(!0);try{const Ee=await F.get(`${Ga}?resource=predictions&action=financial_forecast&months=3`);Ee.data.success&&(O({type:"forecast",title:"Financial Forecast (3 Months)",data:Ee.data.forecast}),te(!0),pe())}catch{alert("Failed")}D(!1)},Et=async()=>{D(!0);try{const Ee=await F.get(`${Ga}?resource=recommendations&action=generate&target_type=school&target_id=1`);Ee.data.success&&(alert(` Generated ${Ee.data.recommendations.length} recommendations!`),Me())}catch{alert("Failed")}D(!1)},Rs=async Ee=>{try{await F.put(`${Ga}?resource=recommendations&id=${Ee}&action=implement`,{}),alert(" Recommendation marked as implemented!"),Me()}catch{alert("Failed")}},He=async Ee=>{try{await F.put(`${Ga}?resource=recommendations&id=${Ee}&action=dismiss`,{}),Me()}catch{alert("Failed")}},Te=async()=>{D(!0);try{const Ee=await F.get(`${Ga}?resource=insights&action=generate`);Ee.data.success&&(alert(` Generated ${Ee.data.insights.length} insights!`),Se())}catch{alert("Failed")}D(!1)},bt=async()=>{D(!0);try{const Ee=await F.get(`${Ga}?resource=anomalies&action=detect`);Ee.data.success&&(alert(` Detected ${Ee.data.anomalies.length} anomalies!`),Ne())}catch{alert("Failed")}D(!1)},Xt=async()=>{if(!R||!T){alert("Select student and subject");return}D(!0);try{const Ee=await F.get(`${Ga}?resource=learning_paths&action=generate&student_id=${R}&subject_id=${T}`);Ee.data.success&&(O({type:"learning_path",title:"Personalized Learning Path",data:Ee.data.learning_path}),te(!0))}catch{alert("Failed")}D(!1)},ls=async Ee=>{if(Ee.preventDefault(),!M.trim())return;const zt={role:"user",message:M,timestamp:new Date().toISOString()};P(pa=>[...pa,zt]);const is=M;K("");try{const pa=await F.post(`${Ga}?resource=chatbot&action=message`,{message:is,session_id:se});pa.data.success&&P(ba=>[...ba,{role:"bot",message:pa.data.response,confidence:pa.data.confidence,timestamp:new Date().toISOString()}])}catch{P(ba=>[...ba,{role:"bot",message:"Sorry, I encountered an error.",timestamp:new Date().toISOString()}])}},Ts=Ee=>({low:"bg-green-100 text-green-800",medium:"bg-yellow-100 text-yellow-800",high:"bg-orange-100 text-orange-800",critical:"bg-red-100 text-red-800"})[Ee]||"bg-gray-100 text-gray-800",ss=Ee=>({low:"bg-gray-100 text-gray-800",medium:"bg-blue-100 text-blue-800",high:"bg-orange-100 text-orange-800",critical:"bg-red-100 text-red-800"})[Ee]||"bg-gray-100 text-gray-800",he=Ee=>({low:"bg-gray-100 text-gray-800",medium:"bg-blue-100 text-blue-800",high:"bg-purple-100 text-purple-800"})[Ee]||"bg-gray-100 text-gray-800",Ht=Ee=>({school:Rt,academic:Qs,attendance:Wt,teachers:Rt,classes:Rt,finance:vs,subjects:as,system:Jr})[Ee]||Sm,Zt=Ee=>({school:"text-blue-600",academic:"text-purple-600",attendance:"text-orange-600",teachers:"text-green-600",classes:"text-cyan-600",finance:"text-emerald-600",subjects:"text-pink-600",system:"text-gray-600"})[Ee]||"text-yellow-600";return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-start gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Jr,{className:"text-purple-600",size:32}),"AI Features"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Artificial Intelligence powered insights and automation"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>Je(t),className:"flex items-center gap-2 px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 text-sm",children:[e.jsx(xs,{size:16})," PDF"]}),e.jsxs("button",{onClick:()=>_t(t),className:"flex items-center gap-2 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm",children:[e.jsx(Kt,{size:16})," CSV"]}),e.jsxs("button",{onClick:()=>{re("settings"),te(!0)},className:"flex items-center gap-2 px-3 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 text-sm",children:[e.jsx(Ka,{size:16})," Settings"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 p-3 rounded-lg shadow-lg text-white",children:[e.jsx(Jr,{size:20,className:"mb-1"}),e.jsx("p",{className:"text-purple-100 text-xs",children:"Predictions"}),e.jsx("p",{className:"text-lg font-bold",children:a.length})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 p-3 rounded-lg shadow-lg text-white",children:[e.jsx(Ln,{size:20,className:"mb-1"}),e.jsx("p",{className:"text-blue-100 text-xs",children:"Recommendations"}),e.jsx("p",{className:"text-lg font-bold",children:l.length})]}),e.jsxs("div",{className:"bg-gradient-to-br from-yellow-500 to-yellow-600 p-3 rounded-lg shadow-lg text-white",children:[e.jsx(Sm,{size:20,className:"mb-1"}),e.jsx("p",{className:"text-yellow-100 text-xs",children:"Insights"}),e.jsx("p",{className:"text-lg font-bold",children:o.length})]}),e.jsxs("div",{className:"bg-gradient-to-br from-red-500 to-red-600 p-3 rounded-lg shadow-lg text-white",children:[e.jsx(_s,{size:20,className:"mb-1"}),e.jsx("p",{className:"text-red-100 text-xs",children:"Anomalies"}),e.jsx("p",{className:"text-lg font-bold",children:u.length})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-green-600 p-3 rounded-lg shadow-lg text-white",children:[e.jsx(wa,{size:20,className:"mb-1"}),e.jsx("p",{className:"text-green-100 text-xs",children:"Chatbot"}),e.jsx("p",{className:"text-lg font-bold",children:"Online"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-cyan-500 to-cyan-600 p-3 rounded-lg shadow-lg text-white",children:[e.jsx(as,{size:20,className:"mb-1"}),e.jsx("p",{className:"text-cyan-100 text-xs",children:"Learning Paths"}),e.jsx("p",{className:"text-lg font-bold",children:A.length})]}),e.jsxs("div",{className:"bg-gradient-to-br from-indigo-500 to-indigo-600 p-3 rounded-lg shadow-lg text-white",children:[e.jsx(Ot,{size:20,className:"mb-1"}),e.jsx("p",{className:"text-indigo-100 text-xs",children:"Scheduled"}),e.jsx("p",{className:"text-lg font-bold",children:je.length})]}),e.jsxs("div",{className:"bg-gradient-to-br from-pink-500 to-pink-600 p-3 rounded-lg shadow-lg text-white",children:[e.jsx(Ir,{size:20,className:"mb-1"}),e.jsx("p",{className:"text-pink-100 text-xs",children:"Accuracy"}),e.jsx("p",{className:"text-lg font-bold",children:ne.length>0?`${Math.round(ne.reduce((Ee,zt)=>Ee+(zt.accuracy||0),0)/ne.length)}%`:"N/A"})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-[200px] relative",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",placeholder:"Search...",value:ge,onChange:Ee=>xe(Ee.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]}),e.jsxs("select",{value:Z,onChange:Ee=>I(Ee.target.value),className:"border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"performance",children:"Performance"}),e.jsx("option",{value:"dropout_risk",children:"Dropout Risk"}),e.jsx("option",{value:"financial",children:"Financial"}),e.jsx("option",{value:"attendance",children:"Attendance"})]}),e.jsxs("select",{value:w,onChange:Ee=>oe(Ee.target.value),className:"border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"All Categories"}),e.jsx("option",{value:"academic",children:"Academic"}),e.jsx("option",{value:"attendance",children:"Attendance"}),e.jsx("option",{value:"finance",children:"Finance"}),e.jsx("option",{value:"teachers",children:"Teachers"})]}),e.jsx("button",{onClick:()=>{xe(""),I(""),oe("")},className:"text-sm text-gray-500 hover:text-gray-700",children:"Clear"})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"border-b",children:e.jsx("div",{className:"flex flex-wrap",children:[{id:"dashboard",label:"Dashboard",icon:Gl},{id:"predictions",label:"Predictions",icon:$s},{id:"recommendations",label:"Recommend",icon:Ln},{id:"chatbot",label:"Chatbot",icon:wa},{id:"insights",label:"Insights",icon:Sm},{id:"anomalies",label:"Anomalies",icon:_s},{id:"learning",label:"Learning",icon:as},{id:"accuracy",label:"Accuracy",icon:Ir},{id:"scheduled",label:"Scheduled",icon:Ot},{id:"chat_history",label:"Chat History",icon:Sa},{id:"training",label:"Training",icon:Jr},{id:"settings",label:"Settings",icon:Ka}].map(Ee=>e.jsxs("button",{onClick:()=>s(Ee.id),className:`px-3 py-2 font-medium flex items-center gap-1 text-xs ${t===Ee.id?"border-b-2 border-purple-600 text-purple-600 bg-purple-50":"text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(Ee.icon,{size:14})," ",Ee.label]},Ee.id))})}),e.jsxs("div",{className:"p-6",children:[t==="dashboard"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Gl,{className:"text-purple-600"})," AI Analytics Dashboard"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium mb-4",children:"Predictions by Type"}),e.jsx("div",{className:"space-y-2",children:[{type:"Performance",count:a.filter(Ee=>Ee.prediction_type==="performance").length,color:"bg-purple-500"},{type:"Dropout Risk",count:a.filter(Ee=>Ee.prediction_type==="dropout_risk").length,color:"bg-red-500"},{type:"Financial",count:a.filter(Ee=>Ee.prediction_type==="financial").length,color:"bg-green-500"}].map(Ee=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded ${Ee.color}`}),e.jsx("span",{className:"flex-1 text-sm",children:Ee.type}),e.jsx("span",{className:"font-medium",children:Ee.count})]},Ee.type))})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium mb-4",children:"Insights by Category"}),e.jsx("div",{className:"space-y-2",children:["academic","attendance","finance","teachers"].map(Ee=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded ${Ee==="academic"?"bg-purple-500":Ee==="attendance"?"bg-orange-500":Ee==="finance"?"bg-green-500":"bg-blue-500"}`}),e.jsx("span",{className:"flex-1 text-sm capitalize",children:Ee}),e.jsx("span",{className:"font-medium",children:o.filter(zt=>zt.category===Ee).length})]},Ee))})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium mb-4",children:"Anomalies by Severity"}),e.jsx("div",{className:"space-y-2",children:["critical","high","medium","low"].map(Ee=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded ${Ee==="critical"?"bg-red-600":Ee==="high"?"bg-orange-500":Ee==="medium"?"bg-yellow-500":"bg-green-500"}`}),e.jsx("span",{className:"flex-1 text-sm capitalize",children:Ee}),e.jsx("span",{className:"font-medium",children:u.filter(zt=>zt.severity===Ee).length})]},Ee))})]})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium mb-4 flex items-center gap-2",children:[e.jsx(Xu,{className:"text-yellow-600"})," Batch Predictions"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Select Students (",Pe.length," selected)"]}),e.jsx("div",{className:"border rounded-lg p-2 max-h-40 overflow-y-auto",children:N.slice(0,50).map(Ee=>e.jsxs("label",{className:"flex items-center gap-2 p-1 hover:bg-gray-50 rounded text-sm",children:[e.jsx("input",{type:"checkbox",checked:Pe.includes(Ee.id),onChange:zt=>we(zt.target.checked?[...Pe,Ee.id]:Pe.filter(is=>is!==Ee.id))}),Ee.first_name," ",Ee.last_name]},Ee.id))})]}),e.jsxs("div",{className:"flex flex-col gap-2 justify-center",children:[e.jsxs("button",{onClick:()=>$t("performance"),disabled:U,className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 disabled:opacity-50 flex items-center justify-center gap-2",children:[e.jsx(Qs,{size:18})," Batch Performance"]}),e.jsxs("button",{onClick:()=>$t("dropout_risk"),disabled:U,className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 disabled:opacity-50 flex items-center justify-center gap-2",children:[e.jsx(ka,{size:18})," Batch Dropout Risk"]})]}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-600",children:"Run predictions for multiple students at once. Select students from the list and choose a prediction type."})})]})]})]}),t==="predictions"&&e.jsxs("div",{children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 rounded-lg p-6 mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Xu,{className:"text-purple-600"})," Generate New Prediction"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Select Student"}),e.jsxs("select",{value:R,onChange:Ee=>j(Ee.target.value),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Choose student..."}),N.map(Ee=>e.jsxs("option",{value:Ee.id,children:[Ee.first_name," ",Ee.last_name]},Ee.id))]})]}),e.jsxs("button",{onClick:lt,disabled:U,className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 disabled:opacity-50 flex items-center justify-center gap-2",children:[e.jsx(Qs,{size:18})," Predict Performance"]}),e.jsxs("button",{onClick:Ue,disabled:U,className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 disabled:opacity-50 flex items-center justify-center gap-2",children:[e.jsx(ka,{size:18})," Dropout Risk"]}),e.jsxs("button",{onClick:Ct,disabled:U,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:opacity-50 flex items-center justify-center gap-2",children:[e.jsx(vs,{size:18})," Financial Forecast"]})]})]}),e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Recent Predictions"}),a.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx($s,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No predictions yet. Generate one above!"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Entity"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Confidence"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y",children:a.slice(0,10).map(Ee=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 capitalize font-medium",children:Ee.prediction_type?.replace("_"," ")}),e.jsxs("td",{className:"px-4 py-3",children:[Ee.entity_type," #",Ee.entity_id]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-purple-600 h-2 rounded-full",style:{width:`${(Ee.confidence_score||0)*100}%`}})}),e.jsxs("span",{className:"text-sm",children:[((Ee.confidence_score||0)*100).toFixed(0),"%"]})]})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:Ee.prediction_date}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${Ee.status==="completed"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:Ee.status})})]},Ee.id))})]})})]}),t==="recommendations"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"AI Recommendations"}),e.jsxs("button",{onClick:Et,disabled:U,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2",children:[e.jsx(Ns,{size:18,className:U?"animate-spin":""})," Generate New"]})]}),l.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Ln,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No pending recommendations"})]}):e.jsx("div",{className:"space-y-4",children:l.map(Ee=>e.jsxs("div",{className:`border rounded-lg p-4 ${Ee.priority==="critical"?"border-red-300 bg-red-50":Ee.priority==="high"?"border-orange-300 bg-orange-50":""}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:Ee.title}),e.jsxs("p",{className:"text-xs text-gray-500 capitalize",children:[Ee.recommendation_type?.replace("_"," "),"  ",Ee.target_type]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs ${ss(Ee.priority)}`,children:Ee.priority}),e.jsxs("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 rounded text-xs",children:[((Ee.confidence_score||0)*100).toFixed(0),"% confidence"]})]})]}),e.jsx("p",{className:"text-sm text-gray-700 mb-2",children:Ee.description}),Ee.expected_impact&&e.jsxs("p",{className:"text-sm text-blue-600 mb-2",children:[e.jsx("strong",{children:"Expected Impact:"})," ",Ee.expected_impact]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsxs("button",{onClick:()=>Rs(Ee.id),className:"px-3 py-1 bg-green-100 text-green-700 rounded text-sm hover:bg-green-200 flex items-center gap-1",children:[e.jsx(Mt,{size:14})," Implement"]}),e.jsxs("button",{onClick:()=>He(Ee.id),className:"px-3 py-1 bg-gray-100 text-gray-700 rounded text-sm hover:bg-gray-200 flex items-center gap-1",children:[e.jsx(Js,{size:14})," Dismiss"]})]})]},Ee.id))})]}),t==="chatbot"&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(wa,{className:"text-green-600"})," AI Assistant"]}),e.jsxs("div",{className:"border rounded-lg h-[500px] flex flex-col",children:[e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50",children:$.length===0?e.jsxs("div",{className:"text-center text-gray-500 mt-20",children:[e.jsx(wa,{className:"mx-auto mb-2 text-gray-300",size:48}),e.jsx("p",{children:"Start a conversation with the AI assistant"}),e.jsx("p",{className:"text-sm mt-2",children:"Try asking about admissions, fees, timetables, or results!"})]}):$.map((Ee,zt)=>e.jsx("div",{className:`flex ${Ee.role==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-md px-4 py-2 rounded-lg ${Ee.role==="user"?"bg-blue-600 text-white":"bg-white border shadow-sm"}`,children:[e.jsx("p",{children:Ee.message}),Ee.confidence&&e.jsxs("p",{className:"text-xs mt-1 opacity-70",children:["Confidence: ",(Ee.confidence*100).toFixed(0),"%"]})]})},zt))}),e.jsx("form",{onSubmit:ls,className:"border-t p-4 bg-white",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:M,onChange:Ee=>K(Ee.target.value),placeholder:"Ask me anything about the school...",className:"flex-1 border rounded-lg px-4 py-2"}),e.jsxs("button",{type:"submit",className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 flex items-center gap-2",children:[e.jsx(va,{size:18})," Send"]})]})})]})]}),t==="insights"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"School-Wide AI Insights"}),e.jsxs("button",{onClick:Te,disabled:U,className:"bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700 disabled:opacity-50 flex items-center gap-2",children:[e.jsx(Ns,{size:18,className:U?"animate-spin":""})," Generate Insights"]})]}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Comprehensive analysis of students, teachers, classes, subjects, attendance, and finances"}),o.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Sm,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No active insights. Generate some!"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map((Ee,zt)=>{const is=Ht(Ee.category);return e.jsxs("div",{className:`border rounded-lg p-4 hover:shadow-lg transition-shadow ${Ee.impact_level==="high"?"border-l-4 border-l-red-500":Ee.impact_level==="medium"?"border-l-4 border-l-yellow-500":"border-l-4 border-l-green-500"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(is,{className:Zt(Ee.category),size:20}),e.jsx("h4",{className:"font-semibold text-sm",children:Ee.title})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${he(Ee.impact_level)}`,children:Ee.impact_level})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:Ee.description}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[e.jsx("span",{className:"px-2 py-1 bg-gray-100 rounded text-xs capitalize",children:Ee.category}),e.jsxs("span",{className:"px-2 py-1 bg-purple-50 text-purple-700 rounded text-xs",children:[((Ee.confidence_level||Ee.confidence||0)*100).toFixed(0),"% confidence"]})]}),Ee.recommended_actions&&e.jsxs("div",{className:"bg-blue-50 p-2 rounded text-xs text-blue-700",children:[e.jsx("strong",{children:"Action:"})," ",Ee.recommended_actions]})]},Ee.id||zt)})})]}),t==="anomalies"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Anomaly Detection"}),e.jsxs("button",{onClick:bt,disabled:U,className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 disabled:opacity-50 flex items-center gap-2",children:[e.jsx(Ns,{size:18,className:U?"animate-spin":""})," Detect Anomalies"]})]}),u.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(_s,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No open anomalies detected"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Entity"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Severity"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Deviation"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Detected"})]})}),e.jsx("tbody",{className:"divide-y",children:u.map(Ee=>e.jsxs("tr",{className:`hover:bg-gray-50 ${Ee.severity==="critical"?"bg-red-50":Ee.severity==="high"?"bg-orange-50":""}`,children:[e.jsx("td",{className:"px-4 py-3 capitalize font-medium",children:Ee.anomaly_type}),e.jsxs("td",{className:"px-4 py-3",children:[Ee.entity_type," #",Ee.entity_id]}),e.jsx("td",{className:"px-4 py-3 text-sm max-w-xs",children:Ee.description}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${Ts(Ee.severity)}`,children:Ee.severity})}),e.jsxs("td",{className:"px-4 py-3 text-sm",children:[Ee.deviation_percentage?.toFixed(1),"%"]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:Ee.detection_date?.substring(0,10)})]},Ee.id))})]})})]}),t==="learning"&&e.jsxs("div",{children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-lg p-6 mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(as,{className:"text-green-600"})," Generate Personalized Learning Path"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Select Student"}),e.jsxs("select",{value:R,onChange:Ee=>j(Ee.target.value),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Choose student..."}),N.map(Ee=>e.jsxs("option",{value:Ee.id,children:[Ee.first_name," ",Ee.last_name]},Ee.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Select Subject"}),e.jsxs("select",{value:T,onChange:Ee=>Q(Ee.target.value),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Choose subject..."}),y.map(Ee=>e.jsx("option",{value:Ee.id,children:Ee.subject_name},Ee.id))]})]}),e.jsxs("button",{onClick:Xt,disabled:U,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:opacity-50 flex items-center justify-center gap-2",children:[e.jsx(as,{size:18})," Generate Path"]})]})]}),A.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(as,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No learning paths yet. Generate one above!"})]}):e.jsx("div",{className:"space-y-4",children:A.map(Ee=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold",children:[Ee.student_name," - ",Ee.subject_name]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Level: ",Ee.current_level,"  ",Ee.target_level]})]}),e.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded text-xs",children:[Ee.progress||0,"% complete"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-3",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${Ee.progress||0}%`}})}),Ee.milestones&&e.jsx("div",{className:"space-y-1",children:Ee.milestones.map((zt,is)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:zt.completed,onChange:pa=>be(Ee.id,is,pa.target.checked)}),e.jsx("span",{className:zt.completed?"line-through text-gray-400":"",children:zt.title})]},is))})]},Ee.id))})]}),t==="accuracy"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Ir,{className:"text-pink-600"})," Prediction Accuracy Tracking"]}),e.jsxs("button",{onClick:et,className:"px-4 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ns,{size:18})," Refresh"]})]}),ne.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Ir,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No accuracy data yet. Predictions need actual outcomes to compare."})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsx("p",{className:"text-green-600 text-sm",children:"Average Accuracy"}),e.jsxs("p",{className:"text-2xl font-bold text-green-700",children:[Math.round(ne.reduce((Ee,zt)=>Ee+(zt.accuracy||0),0)/ne.length),"%"]})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-200",children:[e.jsx("p",{className:"text-purple-600 text-sm",children:"Total Predictions"}),e.jsx("p",{className:"text-2xl font-bold text-purple-700",children:ne.length})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("p",{className:"text-blue-600 text-sm",children:"Verified"}),e.jsx("p",{className:"text-2xl font-bold text-blue-700",children:ne.filter(Ee=>Ee.verified).length})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:[e.jsx("p",{className:"text-yellow-600 text-sm",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-700",children:ne.filter(Ee=>!Ee.verified).length})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Predicted"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actual"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Accuracy"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"})]})}),e.jsx("tbody",{className:"divide-y",children:ne.map(Ee=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 capitalize",children:Ee.prediction_type}),e.jsx("td",{className:"px-4 py-3",children:Ee.predicted_value}),e.jsx("td",{className:"px-4 py-3",children:Ee.actual_value||"Pending"}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${Ee.accuracy>=80?"bg-green-600":Ee.accuracy>=60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Ee.accuracy||0}%`}})}),e.jsxs("span",{className:"text-sm",children:[Ee.accuracy?.toFixed(0)||"-","%"]})]})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:Ee.prediction_date})]},Ee.id))})]})})]})]}),t==="scheduled"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Ot,{className:"text-indigo-600"})," Scheduled AI Tasks"]}),e.jsxs("button",{onClick:()=>{re("scheduled_task"),O({task_name:"",task_type:"batch_predictions",schedule:"daily",time:"08:00",enabled:!0}),te(!0)},className:"bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," Add Task"]})]}),je.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Ot,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No scheduled tasks. Add one to automate AI predictions."})]}):e.jsx("div",{className:"space-y-3",children:je.map(Ee=>e.jsxs("div",{className:`border rounded-lg p-4 ${Ee.status==="paused"?"bg-gray-50":""}`,children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:Ee.task_name}),e.jsxs("p",{className:"text-sm text-gray-500 capitalize",children:[Ee.task_type?.replace("_"," "),"  ",Ee.schedule," at ",Ee.time]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs ${Ee.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:Ee.status}),e.jsx("button",{onClick:()=>Ze(Ee.id,Ee.status),className:`p-2 rounded ${Ee.status==="active"?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:Ee.status==="active"?e.jsx(fg,{size:16}):e.jsx(Qi,{size:16})}),e.jsx("button",{onClick:()=>{re("scheduled_task"),O(Ee),te(!0)},className:"p-2 bg-gray-100 rounded",children:e.jsx(Na,{size:16})})]})]}),Ee.last_run&&e.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["Last run: ",Ee.last_run]})]},Ee.id))})]}),t==="chat_history"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Sa,{className:"text-gray-600"})," Chat Sessions History"]}),e.jsxs("button",{onClick:ft,className:"px-4 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ns,{size:18})," Refresh"]})]}),ze.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Sa,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No chat sessions recorded yet"})]}):e.jsx("div",{className:"space-y-3",children:ze.map(Ee=>e.jsx("div",{className:"border rounded-lg p-4 hover:shadow-lg cursor-pointer",onClick:()=>{re("chat_session"),O(Ee),te(!0)},children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["Session: ",Ee.session_id]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[Ee.message_count," messages"]})]}),e.jsx("span",{className:"text-xs text-gray-400",children:Ee.created_at})]})},Ee.id))})]}),t==="training"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Jr,{className:"text-purple-600"})," Chatbot Training Data"]}),e.jsxs("button",{onClick:()=>{re("training"),O({question:"",answer:"",category:"general"}),te(!0)},className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 flex items-center gap-2",children:[e.jsx(qt,{size:18})," Add Q&A"]})]}),st.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Jr,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No custom training data. Add Q&A pairs to improve the chatbot."})]}):e.jsx("div",{className:"space-y-3",children:st.map(Ee=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 rounded text-xs capitalize",children:Ee.category}),e.jsx("button",{className:"text-red-500 hover:text-red-700",children:e.jsx(us,{size:16})})]}),e.jsxs("p",{className:"font-medium text-blue-600 mb-1",children:["Q: ",Ee.question]}),e.jsxs("p",{className:"text-gray-700",children:["A: ",Ee.answer]})]},Ee.id))})]}),t==="settings"&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Ka,{className:"text-gray-600"})," AI Model Settings"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium mb-4",children:"Alert Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:fe.email_alerts,onChange:Ee=>ye({...fe,email_alerts:Ee.target.checked}),className:"w-5 h-5"}),e.jsx("span",{children:"Enable Email Alerts"})]}),e.jsxs("label",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:fe.anomaly_alerts,onChange:Ee=>ye({...fe,anomaly_alerts:Ee.target.checked}),className:"w-5 h-5"}),e.jsx("span",{children:"Alert on Anomalies"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Risk Alert Threshold"}),e.jsx("input",{type:"range",min:"0",max:"100",value:fe.risk_threshold,onChange:Ee=>ye({...fe,risk_threshold:parseInt(Ee.target.value)}),className:"w-full"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Alert when dropout risk exceeds ",fe.risk_threshold,"%"]})]})]})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium mb-4",children:"Model Parameters"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Confidence Threshold"}),e.jsx("input",{type:"number",min:"0",max:"100",value:_e.confidence_threshold||70,onChange:Ee=>le({..._e,confidence_threshold:parseInt(Ee.target.value)}),className:"w-full border rounded-lg px-3 py-2"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Minimum confidence to show predictions"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Prediction Window (days)"}),e.jsx("input",{type:"number",min:"1",max:"365",value:_e.prediction_window||30,onChange:Ee=>le({..._e,prediction_window:parseInt(Ee.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]})]})]})]}),e.jsxs("button",{onClick:Yt,className:"mt-6 bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 flex items-center gap-2",children:[e.jsx(Br,{size:18})," Save Settings"]})]})]})]}),E&&C&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:C.title}),e.jsx("button",{onClick:()=>te(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Js,{size:20})})]}),e.jsxs("div",{className:"p-6",children:[C.type==="prediction"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-purple-600",children:"Predicted Score"}),e.jsxs("p",{className:"text-4xl font-bold text-purple-700",children:[C.data.predicted_score,"%"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Confidence"}),e.jsxs("p",{className:"font-semibold",children:[(C.data.confidence*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Trend"}),e.jsx("p",{className:"font-semibold capitalize",children:C.data.trend})]})]}),e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-xs text-blue-600",children:"Recommendation"}),e.jsx("p",{className:"font-medium",children:C.data.recommendation})]})]}),C.type==="risk"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:`p-4 rounded-lg text-center ${C.data.risk_level==="high"?"bg-red-50":C.data.risk_level==="medium"?"bg-yellow-50":"bg-green-50"}`,children:[e.jsx("p",{className:"text-sm",children:"Risk Level"}),e.jsx("p",{className:`text-4xl font-bold capitalize ${C.data.risk_level==="high"?"text-red-700":C.data.risk_level==="medium"?"text-yellow-700":"text-green-700"}`,children:C.data.risk_level}),e.jsxs("p",{className:"text-2xl font-semibold mt-1",children:[C.data.risk_score,"/100"]})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Confidence"}),e.jsxs("p",{className:"font-semibold",children:[(C.data.confidence*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-xs text-blue-600",children:"Recommendation"}),e.jsx("p",{className:"font-medium",children:C.data.recommendation})]})]}),C.type==="forecast"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Confidence: ",(C.data.confidence*100).toFixed(0),"%  Trend: ",C.data.trend]}),e.jsx("div",{className:"space-y-2",children:C.data.forecast?.map((Ee,zt)=>e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:Ee.month}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold text-green-600",children:["GHS ",Ee.predicted_revenue?.toLocaleString()]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[Ee.lower_bound?.toLocaleString()," - ",Ee.upper_bound?.toLocaleString()]})]})]},zt))})]}),C.type==="learning_path"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Current Level"}),e.jsx("p",{className:"font-semibold",children:C.data.current_level})]}),e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-xs text-green-600",children:"Target Level"}),e.jsx("p",{className:"font-semibold",children:C.data.target_level})]})]}),e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[e.jsx("p",{className:"text-xs text-blue-600",children:"Learning Style"}),e.jsx("p",{className:"font-semibold capitalize",children:C.data.learning_style})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium mb-2",children:"Strengths"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:C.data.strengths?.map((Ee,zt)=>e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded text-sm",children:Ee},zt))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium mb-2",children:"Areas to Improve"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:C.data.weaknesses?.map((Ee,zt)=>e.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 rounded text-sm",children:Ee},zt))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium mb-2",children:"Recommended Resources"}),e.jsx("div",{className:"space-y-2",children:C.data.resources?.map((Ee,zt)=>e.jsxs("div",{className:"bg-gray-50 p-2 rounded flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 rounded text-xs capitalize",children:Ee.type}),e.jsx("span",{className:"text-sm",children:Ee.title})]},zt))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium mb-2",children:"Milestones"}),e.jsx("div",{className:"space-y-2",children:C.data.milestones?.map((Ee,zt)=>e.jsxs("div",{className:"bg-gray-50 p-2 rounded flex justify-between",children:[e.jsx("span",{className:"text-sm",children:Ee.title}),e.jsx("span",{className:"text-xs text-gray-500",children:Ee.target_date})]},zt))})]})]}),e.jsx("button",{onClick:()=>te(!1),className:"w-full mt-6 bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200",children:"Close"})]})]})}),E&&V==="scheduled_task"&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md",children:[e.jsxs("div",{className:"p-6 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:C?.id?"Edit Task":"Add Scheduled Task"}),e.jsx("button",{onClick:()=>te(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{size:20})})]}),e.jsxs("form",{onSubmit:me,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Task Name *"}),e.jsx("input",{type:"text",value:C?.task_name||"",onChange:Ee=>O({...C,task_name:Ee.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Task Type"}),e.jsxs("select",{value:C?.task_type||"",onChange:Ee=>O({...C,task_type:Ee.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"batch_predictions",children:"Batch Predictions"}),e.jsx("option",{value:"generate_insights",children:"Generate Insights"}),e.jsx("option",{value:"detect_anomalies",children:"Detect Anomalies"}),e.jsx("option",{value:"generate_recommendations",children:"Generate Recommendations"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Schedule"}),e.jsxs("select",{value:C?.schedule||"",onChange:Ee=>O({...C,schedule:Ee.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Time"}),e.jsx("input",{type:"time",value:C?.time||"",onChange:Ee=>O({...C,time:Ee.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>te(!1),className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700",children:"Save"})]})]})]})}),E&&V==="training"&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md",children:[e.jsxs("div",{className:"p-6 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Add Training Q&A"}),e.jsx("button",{onClick:()=>te(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{size:20})})]}),e.jsxs("form",{onSubmit:ct,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Category"}),e.jsxs("select",{value:C?.category||"",onChange:Ee=>O({...C,category:Ee.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"admissions",children:"Admissions"}),e.jsx("option",{value:"fees",children:"Fees"}),e.jsx("option",{value:"timetable",children:"Timetable"}),e.jsx("option",{value:"results",children:"Results"}),e.jsx("option",{value:"policies",children:"Policies"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Question *"}),e.jsx("textarea",{value:C?.question||"",onChange:Ee=>O({...C,question:Ee.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Answer *"}),e.jsx("textarea",{value:C?.answer||"",onChange:Ee=>O({...C,answer:Ee.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:4,required:!0})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>te(!1),className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700",children:"Add"})]})]})]})}),E&&V==="settings"&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg",children:[e.jsxs("div",{className:"p-6 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"AI Settings"}),e.jsx("button",{onClick:()=>te(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{size:20})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Email Alerts"}),e.jsxs("label",{className:"flex items-center gap-3 mb-2",children:[e.jsx("input",{type:"checkbox",checked:fe.email_alerts,onChange:Ee=>ye({...fe,email_alerts:Ee.target.checked}),className:"w-5 h-5"}),e.jsx("span",{children:"Enable Email Alerts"})]}),e.jsxs("label",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:fe.anomaly_alerts,onChange:Ee=>ye({...fe,anomaly_alerts:Ee.target.checked}),className:"w-5 h-5"}),e.jsx("span",{children:"Alert on Anomalies"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Risk Alert Threshold: ",fe.risk_threshold,"%"]}),e.jsx("input",{type:"range",min:"0",max:"100",value:fe.risk_threshold,onChange:Ee=>ye({...fe,risk_threshold:parseInt(Ee.target.value)}),className:"w-full"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:()=>te(!1),className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:()=>{Yt(),te(!1)},className:"flex-1 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700",children:"Save"})]})]})]})}),E&&V==="chat_session"&&C&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex justify-between items-center",children:[e.jsxs("h2",{className:"text-xl font-bold",children:["Chat Session: ",C.session_id]}),e.jsx("button",{onClick:()=>te(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{size:20})})]}),e.jsx("div",{className:"p-6 space-y-3",children:C.messages?.map((Ee,zt)=>e.jsx("div",{className:`flex ${Ee.role==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-xs px-4 py-2 rounded-lg ${Ee.role==="user"?"bg-blue-600 text-white":"bg-gray-100"}`,children:[e.jsx("p",{className:"text-sm",children:Ee.message}),e.jsx("p",{className:"text-xs opacity-70 mt-1",children:Ee.timestamp})]})},zt))})]})})]})}const On=`${ee}/advanced_analytics.php`;function CT(){const[t,s]=h.useState("overview"),[a,r]=h.useState(!1),[l,c]=h.useState(null),[o,m]=h.useState(null),[u,x]=h.useState(null),[A,g]=h.useState(null),[N,f]=h.useState(null),[y,v]=h.useState(null);h.useEffect(()=>{U()},[]),h.useEffect(()=>{t==="enrollment"&&D(),t==="revenue"&&M(),t==="teachers"&&K(),t==="students"&&$(),t==="comparison"&&P()},[t]);const U=async()=>{try{r(!0);const j=await F.get(`${On}?action=dashboard`);c(j.data.analytics)}catch(j){console.error("Error fetching dashboard:",j)}finally{r(!1)}},D=async()=>{try{r(!0);const[j,T,Q,E]=await Promise.all([F.get(`${On}?action=enrollment_prediction&months=12`),F.get(`${On}?action=enrollment_trends&years=3`),F.get(`${On}?action=enrollment_by_class`),F.get(`${On}?action=admission_funnel`)]);m({prediction:j.data,trends:T.data.trends,byClass:Q.data.classes,funnel:E.data.funnel})}catch(j){console.error("Error fetching enrollment data:",j)}finally{r(!1)}},M=async()=>{try{r(!0);const[j,T,Q,E]=await Promise.all([F.get(`${On}?action=revenue_forecast&months=6`),F.get(`${On}?action=revenue_breakdown&period=year`),F.get(`${On}?action=fee_collection_rate`),F.get(`${On}?action=outstanding_fees`)]);x({forecast:j.data,breakdown:T.data,collection:Q.data,outstanding:E.data})}catch(j){console.error("Error fetching revenue data:",j)}finally{r(!1)}},K=async()=>{try{r(!0);const[j,T,Q]=await Promise.all([F.get(`${On}?action=teacher_effectiveness`),F.get(`${On}?action=teacher_rankings&metric=overall`),F.get(`${On}?action=teacher_workload`)]);g({effectiveness:j.data.teachers,rankings:T.data.rankings,workload:Q.data.workload})}catch(j){console.error("Error fetching teacher data:",j)}finally{r(!1)}},$=async()=>{try{r(!0);const[j,T,Q]=await Promise.all([F.get(`${On}?action=student_performance`),F.get(`${On}?action=attendance_analytics`),F.get(`${On}?action=subject_performance`)]);f({performance:j.data,attendance:T.data,subjects:Q.data.subjects})}catch(j){console.error("Error fetching student data:",j)}finally{r(!1)}},P=async()=>{try{r(!0);const[j,T]=await Promise.all([F.get(`${On}?action=year_comparison`),F.get(`${On}?action=benchmark`)]);v({year:j.data,benchmark:T.data.benchmarks})}catch(j){console.error("Error fetching comparison:",j)}finally{r(!1)}},se=j=>new Intl.NumberFormat("en-GH",{style:"currency",currency:"GHS"}).format(j||0),z=j=>j>0?e.jsx(Li,{className:"w-4 h-4 text-green-500"}):j<0?e.jsx(U1,{className:"w-4 h-4 text-red-500"}):e.jsx(WA,{className:"w-4 h-4 text-gray-400"}),R=j=>j>0?"text-green-600 dark:text-green-400":j<0?"text-red-600 dark:text-red-400":"text-gray-500";return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Advanced Analytics"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Predictive insights and performance metrics"})]}),e.jsxs("button",{onClick:()=>{U(),t==="enrollment"&&D(),t==="revenue"&&M(),t==="teachers"&&K(),t==="students"&&$()},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(Ns,{className:`w-4 h-4 ${a?"animate-spin":""}`}),"Refresh"]})]}),l&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-xl",children:e.jsx(Rt,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),l.enrollment_growth!==0&&e.jsxs("span",{className:`flex items-center gap-1 text-sm ${R(l.enrollment_growth)}`,children:[z(l.enrollment_growth),Math.abs(l.enrollment_growth),"%"]})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-3",children:l.total_students||0}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Students"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/30 rounded-xl",children:e.jsx(vs,{className:"w-6 h-6 text-green-600 dark:text-green-400"})})}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-3",children:se(l.year_revenue)}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Year Revenue"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/30 rounded-xl w-fit",children:e.jsx(Qs,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-3",children:l.total_teachers||0}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Teachers"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("div",{className:"p-3 bg-orange-100 dark:bg-orange-900/30 rounded-xl w-fit",children:e.jsx(Fs,{className:"w-6 h-6 text-orange-600 dark:text-orange-400"})}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-3",children:l.total_classes||0}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Classes"})]})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:[{id:"overview",label:"Overview",icon:Fs},{id:"enrollment",label:"Enrollment Prediction",icon:Rt},{id:"revenue",label:"Revenue Forecast",icon:vs},{id:"teachers",label:"Teacher Effectiveness",icon:Is},{id:"students",label:"Student Analytics",icon:Qs},{id:"comparison",label:"Comparisons",icon:$s}].map(j=>e.jsxs("button",{onClick:()=>s(j.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg whitespace-nowrap transition-colors ${t===j.id?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:[e.jsx(j.icon,{className:"w-4 h-4"}),j.label]},j.id))}),a&&e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Ns,{className:"w-8 h-8 animate-spin text-blue-500"})}),t==="enrollment"&&o&&!a&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-6 text-white",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Predicted Enrollments"}),e.jsx("p",{className:"text-3xl font-bold",children:o.prediction?.summary?.total_predicted||0}),e.jsx("p",{className:"text-sm text-blue-100 mt-1",children:"Next 12 months"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-xl p-6 text-white",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Monthly Average"}),e.jsx("p",{className:"text-3xl font-bold",children:o.prediction?.summary?.average_monthly||0}),e.jsx("p",{className:"text-sm text-green-100 mt-1",children:"Based on historical data"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl p-6 text-white",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Trend"}),e.jsx("p",{className:"text-3xl font-bold capitalize",children:o.prediction?.summary?.trend||"Stable"}),e.jsxs("p",{className:"text-sm text-purple-100 mt-1",children:[o.prediction?.summary?.trend_value>0?"+":"",o.prediction?.summary?.trend_value||0," per month"]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Monthly Predictions"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Month"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Predicted"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Confidence"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:o.prediction?.predictions?.map((j,T)=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-3 text-gray-900 dark:text-white",children:j.month}),e.jsx("td",{className:"px-4 py-3 font-semibold text-blue-600 dark:text-blue-400",children:j.predicted_enrollments}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-gray-200 dark:bg-gray-600 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500 rounded-full",style:{width:`${j.confidence}%`}})}),e.jsxs("span",{className:"text-sm text-gray-500",children:[j.confidence,"%"]})]})})]},T))})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Class Capacity"}),e.jsx("div",{className:"space-y-3",children:o.byClass?.slice(0,8).map((j,T)=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"w-24 text-sm text-gray-600 dark:text-gray-400 truncate",children:j.class_name}),e.jsx("div",{className:"flex-1 h-4 bg-gray-200 dark:bg-gray-600 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${j.fill_rate>=90?"bg-red-500":j.fill_rate>=70?"bg-yellow-500":"bg-green-500"}`,style:{width:`${j.fill_rate}%`}})}),e.jsxs("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 w-20 text-right",children:[j.enrolled,"/",j.capacity]})]},T))})]})]}),t==="revenue"&&u&&!a&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Billed"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-1",children:se(u.collection?.current?.total_billed)})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Collected"}),e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400 mt-1",children:se(u.collection?.current?.total_collected)})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Outstanding"}),e.jsx("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400 mt-1",children:se(u.collection?.current?.outstanding)})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Collection Rate"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400 mt-1",children:[u.collection?.current?.collection_rate,"%"]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Revenue Forecast (6 Months)"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Month"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Predicted"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Range"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Confidence"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:u.forecast?.forecasts?.map((j,T)=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-3 text-gray-900 dark:text-white",children:j.month}),e.jsx("td",{className:"px-4 py-3 font-semibold text-green-600 dark:text-green-400",children:se(j.predicted_revenue)}),e.jsxs("td",{className:"px-4 py-3 text-sm text-gray-500",children:[se(j.lower_bound)," - ",se(j.upper_bound)]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:`px-2 py-1 text-xs rounded-full ${j.confidence>=80?"bg-green-100 text-green-700":j.confidence>=60?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:[j.confidence,"%"]})})]},T))})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Outstanding Fees by Age"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:u.outstanding?.by_age?.map((j,T)=>e.jsxs("div",{className:`p-4 rounded-lg ${j.age_bracket==="90+ days"?"bg-red-50 dark:bg-red-900/20":j.age_bracket==="61-90 days"?"bg-orange-50 dark:bg-orange-900/20":j.age_bracket==="31-60 days"?"bg-yellow-50 dark:bg-yellow-900/20":"bg-green-50 dark:bg-green-900/20"}`,children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:j.age_bracket}),e.jsx("p",{className:"text-xl font-bold text-gray-900 dark:text-white mt-1",children:se(j.outstanding)}),e.jsxs("p",{className:"text-xs text-gray-500",children:[j.invoices," invoices"]})]},T))})]})]}),t==="teachers"&&A&&!a&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Teacher Effectiveness Rankings"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Rank"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Teacher"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Department"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Avg Score"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Attendance"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Effectiveness"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Rating"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:A.effectiveness?.map((j,T)=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`w-8 h-8 flex items-center justify-center rounded-full font-bold ${T===0?"bg-yellow-100 text-yellow-700":T===1?"bg-gray-100 text-gray-700":T===2?"bg-orange-100 text-orange-700":"bg-gray-50 text-gray-500"}`,children:T+1})}),e.jsx("td",{className:"px-4 py-3 font-medium text-gray-900 dark:text-white",children:j.name}),e.jsx("td",{className:"px-4 py-3 text-gray-600 dark:text-gray-400",children:j.department||"-"}),e.jsxs("td",{className:"px-4 py-3 text-gray-600 dark:text-gray-400",children:[j.avg_student_score,"%"]}),e.jsxs("td",{className:"px-4 py-3 text-gray-600 dark:text-gray-400",children:[j.class_attendance_rate,"%"]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-16 h-2 bg-gray-200 dark:bg-gray-600 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${j.effectiveness_score>=70?"bg-green-500":j.effectiveness_score>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${j.effectiveness_score}%`}})}),e.jsx("span",{className:"text-sm font-medium",children:j.effectiveness_score})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${j.rating==="Excellent"?"bg-green-100 text-green-700":j.rating==="Good"?"bg-blue-100 text-blue-700":j.rating==="Average"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:j.rating})})]},j.id))})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Workload Distribution"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:A.workload?.slice(0,6).map((j,T)=>e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:j.name}),e.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full ${j.workload_level==="High"?"bg-red-100 text-red-700":j.workload_level==="Medium"?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:j.workload_level})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Classes"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:j.classes})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Subjects"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:j.subjects})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Students"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:j.total_students})]})]})]},T))})]})]}),t==="students"&&N&&!a&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Grade Distribution"}),e.jsx("div",{className:"space-y-3",children:N.performance?.distribution?.map((j,T)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-24 text-sm font-medium text-gray-700 dark:text-gray-300",children:j.grade_range}),e.jsx("div",{className:"flex-1 h-6 bg-gray-200 dark:bg-gray-600 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${j.grade_range.startsWith("A")?"bg-green-500":j.grade_range.startsWith("B")?"bg-blue-500":j.grade_range.startsWith("C")?"bg-yellow-500":j.grade_range.startsWith("D")?"bg-orange-500":"bg-red-500"}`,style:{width:`${Math.min(100,j.count/50*100)}%`}})}),e.jsx("span",{className:"w-12 text-sm text-gray-500 text-right",children:j.count})]},T))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Attendance Overview"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[e.jsxs("p",{className:"text-3xl font-bold text-green-600",children:[N.attendance?.overall?.attendance_rate,"%"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Attendance Rate"})]}),e.jsxs("div",{className:"text-center p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:N.attendance?.overall?.present}),e.jsx("p",{className:"text-sm text-gray-500",children:"Present (30 days)"})]}),e.jsxs("div",{className:"text-center p-4 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[e.jsx("p",{className:"text-3xl font-bold text-red-600",children:N.attendance?.overall?.absent}),e.jsx("p",{className:"text-sm text-gray-500",children:"Absent"})]}),e.jsxs("div",{className:"text-center p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:[e.jsx("p",{className:"text-3xl font-bold text-yellow-600",children:N.attendance?.overall?.late}),e.jsx("p",{className:"text-sm text-gray-500",children:"Late"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(Is,{className:"w-5 h-5 text-yellow-500"}),"Top Performers"]}),e.jsx("div",{className:"space-y-2",children:N.performance?.top_performers?.map((j,T)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`w-6 h-6 flex items-center justify-center rounded-full text-xs font-bold ${T===0?"bg-yellow-100 text-yellow-700":T===1?"bg-gray-200 text-gray-700":T===2?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-500"}`,children:T+1}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:j.name}),e.jsx("p",{className:"text-xs text-gray-500",children:j.class_name})]})]}),e.jsxs("span",{className:"font-bold text-green-600",children:[j.avg_score,"%"]})]},T))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(_s,{className:"w-5 h-5 text-red-500"}),"Needs Attention"]}),e.jsx("div",{className:"space-y-2",children:N.performance?.needs_attention?.map((j,T)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:j.name}),e.jsx("p",{className:"text-xs text-gray-500",children:j.class_name})]}),e.jsxs("span",{className:"font-bold text-red-600",children:[j.avg_score,"%"]})]},T))})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Subject Performance"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-xs text-gray-500 uppercase",children:[e.jsx("th",{className:"pb-3",children:"Subject"}),e.jsx("th",{className:"pb-3",children:"Avg Score"}),e.jsx("th",{className:"pb-3",children:"Highest"}),e.jsx("th",{className:"pb-3",children:"Lowest"}),e.jsx("th",{className:"pb-3",children:"Students"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:N.subjects?.map((j,T)=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 font-medium text-gray-900 dark:text-white",children:j.subject_name}),e.jsx("td",{className:"py-3",children:e.jsxs("span",{className:`font-semibold ${j.avg_score>=70?"text-green-600":j.avg_score>=50?"text-yellow-600":"text-red-600"}`,children:[j.avg_score,"%"]})}),e.jsxs("td",{className:"py-3 text-gray-600 dark:text-gray-400",children:[j.highest,"%"]}),e.jsxs("td",{className:"py-3 text-gray-600 dark:text-gray-400",children:[j.lowest,"%"]}),e.jsx("td",{className:"py-3 text-gray-600 dark:text-gray-400",children:j.students})]},T))})]})})]})]}),t==="comparison"&&y&&!a&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-6",children:"Year-over-Year Comparison"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:Object.entries(y.year?.comparison||{}).map(([j,T])=>e.jsxs("div",{className:"text-center p-4 bg-gray-50 dark:bg-gray-700/50 rounded-xl",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 capitalize mb-2",children:j.replace("_"," ")}),e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400",children:"Previous"}),e.jsx("p",{className:"text-lg font-semibold text-gray-600 dark:text-gray-400",children:j==="revenue"?se(T.previous):j==="avg_score"?`${T.previous}%`:T.previous})]}),e.jsx(cr,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400",children:"Current"}),e.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:j==="revenue"?se(T.current):j==="avg_score"?`${T.current}%`:T.current})]})]}),e.jsxs("div",{className:`mt-2 flex items-center justify-center gap-1 ${R(T.change)}`,children:[z(T.change),e.jsxs("span",{className:"font-semibold",children:[Math.abs(T.change),"%"]})]})]},j))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-6",children:"Performance Benchmarks"}),e.jsx("div",{className:"space-y-6",children:Object.entries(y.benchmark||{}).map(([j,T])=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300 capitalize",children:j.replace("_"," ")}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Target: ",T.target,"% | Avg: ",T.national_avg||T.industry_avg,"%"]})]}),e.jsxs("div",{className:"relative h-8 bg-gray-200 dark:bg-gray-600 rounded-full overflow-hidden",children:[e.jsx("div",{className:`absolute h-full rounded-full ${T.current>=T.target?"bg-green-500":T.current>=(T.national_avg||T.industry_avg)?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(100,T.current)}%`}}),e.jsx("div",{className:"absolute top-0 bottom-0 w-1 bg-blue-600",style:{left:`${T.target}%`}}),e.jsxs("span",{className:"absolute inset-0 flex items-center justify-center text-sm font-bold text-white",children:[T.current,"%"]})]})]},j))})]})]}),t==="overview"&&!a&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl p-6 text-white",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Quick Insights"}),e.jsxs("ul",{className:"space-y-3",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx($s,{className:"w-5 h-5 mt-0.5"}),e.jsxs("span",{children:["Enrollment is ",l?.enrollment_growth>0?"growing":"stable"," compared to last year"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Ln,{className:"w-5 h-5 mt-0.5"}),e.jsx("span",{children:"Revenue collection is on track for this quarter"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Is,{className:"w-5 h-5 mt-0.5"}),e.jsx("span",{children:"Teacher effectiveness metrics available for review"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Analytics Modules"}),e.jsx("div",{className:"space-y-3",children:[{name:"Enrollment Prediction",desc:"Forecast future student enrollment",tab:"enrollment"},{name:"Revenue Forecast",desc:"Project future revenue and collections",tab:"revenue"},{name:"Teacher Effectiveness",desc:"Measure and compare teacher performance",tab:"teachers"},{name:"Student Analytics",desc:"Track student performance and attendance",tab:"students"}].map((j,T)=>e.jsxs("button",{onClick:()=>s(j.tab),className:"w-full flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:j.name}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:j.desc})]}),e.jsx(cr,{className:"w-5 h-5 text-gray-400"})]},T))})]})]})]})}function Rd({icon:t,label:s,value:a,subValue:r,change:l,changeType:c,color:o="blue",onClick:m,loading:u=!1,className:x=""}){const A={blue:{bg:"bg-blue-50 dark:bg-blue-900/20",icon:"bg-blue-100 dark:bg-blue-900/40 text-blue-600 dark:text-blue-400",text:"text-blue-600 dark:text-blue-400"},green:{bg:"bg-green-50 dark:bg-green-900/20",icon:"bg-green-100 dark:bg-green-900/40 text-green-600 dark:text-green-400",text:"text-green-600 dark:text-green-400"},yellow:{bg:"bg-yellow-50 dark:bg-yellow-900/20",icon:"bg-yellow-100 dark:bg-yellow-900/40 text-yellow-600 dark:text-yellow-400",text:"text-yellow-600 dark:text-yellow-400"},purple:{bg:"bg-purple-50 dark:bg-purple-900/20",icon:"bg-purple-100 dark:bg-purple-900/40 text-purple-600 dark:text-purple-400",text:"text-purple-600 dark:text-purple-400"},red:{bg:"bg-red-50 dark:bg-red-900/20",icon:"bg-red-100 dark:bg-red-900/40 text-red-600 dark:text-red-400",text:"text-red-600 dark:text-red-400"},indigo:{bg:"bg-indigo-50 dark:bg-indigo-900/20",icon:"bg-indigo-100 dark:bg-indigo-900/40 text-indigo-600 dark:text-indigo-400",text:"text-indigo-600 dark:text-indigo-400"},pink:{bg:"bg-pink-50 dark:bg-pink-900/20",icon:"bg-pink-100 dark:bg-pink-900/40 text-pink-600 dark:text-pink-400",text:"text-pink-600 dark:text-pink-400"},cyan:{bg:"bg-cyan-50 dark:bg-cyan-900/20",icon:"bg-cyan-100 dark:bg-cyan-900/40 text-cyan-600 dark:text-cyan-400",text:"text-cyan-600 dark:text-cyan-400"}},g=A[o]||A.blue,N={increase:"text-green-600 dark:text-green-400",decrease:"text-red-600 dark:text-red-400",neutral:"text-gray-500 dark:text-gray-400"},f=c==="increase"?$s:c==="decrease"?gc:WA;return e.jsx("div",{className:`bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-5 transition-all duration-200 ${m?"cursor-pointer hover:shadow-lg hover:border-blue-300 dark:hover:border-blue-600":""} ${x}`,onClick:m,children:u?e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 dark:bg-gray-700 rounded-lg mb-3"}),e.jsx("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-20 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-24"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${g.icon}`,children:t&&e.jsx(t,{className:"w-5 h-5"})}),l!==void 0&&e.jsxs("div",{className:`flex items-center gap-1 text-sm ${N[c]||N.neutral}`,children:[e.jsx(f,{className:"w-4 h-4"}),e.jsx("span",{children:l})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a}),r&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-0.5",children:r})]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:s})]})})}const Uo=`${ee}/hr_management.php`;function ST(){const[t,s]=h.useState("dashboard"),[a,r]=h.useState(!1),[l,c]=h.useState(null),[o,m]=h.useState([]),[u,x]=h.useState([]),[A,g]=h.useState([]),[N,f]=h.useState([]),[y,v]=h.useState([]),[U,D]=h.useState([]),[M,K]=h.useState(new Date().toISOString().slice(0,7)),[$,P]=h.useState(null),[se,z]=h.useState({});h.useEffect(()=>{R(),E()},[]),h.useEffect(()=>{t==="employees"&&j(),t==="payroll"&&T(),t==="leave"&&Q(),t==="reviews"&&te(),t==="salary"&&C()},[t,M]);const R=async()=>{try{r(!0);const xe=await F.get(`${Uo}?action=hr_dashboard`);c(xe.data.dashboard)}catch(xe){console.error(xe)}finally{r(!1)}},j=async()=>{try{const xe=await F.get(`${Uo}?action=employees`);m(xe.data.employees||[])}catch(xe){console.error(xe)}},T=async()=>{try{const xe=await F.get(`${Uo}?action=payroll&month=${M}`);x(xe.data.payroll||[])}catch(xe){console.error(xe)}},Q=async()=>{try{const xe=await F.get(`${Uo}?action=leave_requests`);g(xe.data.requests||[])}catch(xe){console.error(xe)}},E=async()=>{try{const xe=await F.get(`${Uo}?action=leave_types`);f(xe.data.leave_types||[])}catch(xe){console.error(xe)}},te=async()=>{try{const xe=await F.get(`${Uo}?action=performance_reviews`);v(xe.data.reviews||[])}catch(xe){console.error(xe)}},C=async()=>{try{const xe=await F.get(`${Uo}?action=salary_structure`);D(xe.data.structures||[])}catch(xe){console.error(xe)}},O=async()=>{try{r(!0),await F.post(`${Uo}?action=generate_payroll`,{month:M}),T(),alert("Payroll generated successfully!")}catch{alert("Failed to generate payroll")}finally{r(!1)}},V=async(xe,Z)=>{try{await F.post(`${Uo}?action=approve_leave`,{leave_id:xe,status:Z}),Q(),R()}catch{alert("Failed to update leave request")}},re=xe=>new Intl.NumberFormat("en-GH",{style:"currency",currency:"GHS"}).format(xe||0),ge=[{id:"dashboard",label:"Dashboard",icon:$s},{id:"employees",label:"Employees",icon:Rt},{id:"payroll",label:"Payroll",icon:vs},{id:"leave",label:"Leave Management",icon:Ot},{id:"reviews",label:"Performance",icon:Is},{id:"salary",label:"Salary Structures",icon:Kt}];return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"HR Management"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Payroll, Leave & Performance Management"})]}),e.jsx("button",{onClick:R,className:"p-2 rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200",children:e.jsx(Ns,{className:`w-5 h-5 ${a?"animate-spin":""}`})})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:ge.map(xe=>e.jsxs("button",{onClick:()=>s(xe.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg whitespace-nowrap transition-colors ${t===xe.id?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200"}`,children:[e.jsx(xe.icon,{className:"w-4 h-4"}),xe.label]},xe.id))}),t==="dashboard"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(Rd,{icon:Rt,label:"Total Teachers",value:l?.total_teachers||0,color:"blue",loading:a}),e.jsx(Rd,{icon:Rt,label:"Total Staff",value:l?.total_staff||0,color:"green",loading:a}),e.jsx(Rd,{icon:Ot,label:"Pending Leaves",value:l?.pending_leaves||0,color:"yellow",loading:a}),e.jsx(Rd,{icon:Wt,label:"On Leave Today",value:l?.on_leave_today||0,color:"purple",loading:a})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Payroll Summary"}),l.payroll&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Total Employees"}),e.jsx("span",{className:"font-semibold",children:l.payroll.total||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Paid"}),e.jsx("span",{className:"font-semibold text-green-600",children:l.payroll.paid||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Total Amount"}),e.jsx("span",{className:"font-semibold",children:re(l.payroll.total_amount)})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:()=>s("payroll"),className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg text-blue-600 hover:bg-blue-100 text-sm font-medium",children:"Generate Payroll"}),e.jsxs("button",{onClick:()=>s("leave"),className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg text-yellow-600 hover:bg-yellow-100 text-sm font-medium",children:["Review Leaves (",l.pending_leaves,")"]}),e.jsx("button",{onClick:()=>s("reviews"),className:"p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg text-purple-600 hover:bg-purple-100 text-sm font-medium",children:"Performance Reviews"}),e.jsx("button",{onClick:()=>s("salary"),className:"p-3 bg-green-50 dark:bg-green-900/20 rounded-lg text-green-600 hover:bg-green-100 text-sm font-medium",children:"Salary Structures"})]})]})]})]}),t==="employees"&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"All Employees"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search...",className:"pl-9 pr-4 py-2 border rounded-lg text-sm dark:bg-gray-700 dark:border-gray-600"})]})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Department"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Email"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:o.map((xe,Z)=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[e.jsxs("td",{className:"px-4 py-3 font-medium text-gray-900 dark:text-white",children:[xe.first_name," ",xe.last_name]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${xe.type==="teacher"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:xe.type})}),e.jsx("td",{className:"px-4 py-3 text-gray-600 dark:text-gray-400",children:xe.department||"-"}),e.jsx("td",{className:"px-4 py-3 text-gray-600 dark:text-gray-400",children:xe.email}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${xe.status==="active"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:xe.status})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{className:"p-1 hover:bg-gray-100 rounded",children:e.jsx(na,{className:"w-4 h-4"})})})]},Z))})]})})]}),t==="payroll"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("input",{type:"month",value:M,onChange:xe=>K(xe.target.value),className:"px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:O,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(qt,{className:"w-4 h-4"})," Generate Payroll"]}),e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[e.jsx(xs,{className:"w-4 h-4"})," Export"]})]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Employee"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Basic"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Allowances"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Gross"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Deductions"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Net"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:[u.map((xe,Z)=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-gray-900 dark:text-white",children:xe.employee_name}),e.jsx("td",{className:"px-4 py-3",children:re(xe.basic_salary)}),e.jsxs("td",{className:"px-4 py-3 text-green-600",children:["+",re(xe.total_allowances)]}),e.jsx("td",{className:"px-4 py-3 font-medium",children:re(xe.gross_salary)}),e.jsxs("td",{className:"px-4 py-3 text-red-600",children:["-",re(parseFloat(xe.tax_deduction)+parseFloat(xe.pension_deduction))]}),e.jsx("td",{className:"px-4 py-3 font-bold text-blue-600",children:re(xe.net_salary)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${xe.status==="paid"?"bg-green-100 text-green-700":xe.status==="approved"?"bg-blue-100 text-blue-700":"bg-yellow-100 text-yellow-700"}`,children:xe.status})})]},Z)),u.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-4 py-8 text-center text-gray-500",children:"No payroll records for this month"})})]})]})})]}),t==="leave"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{className:"flex gap-2",children:["all","pending","approved","rejected"].map(xe=>e.jsx("button",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-sm capitalize hover:bg-gray-200",children:xe},xe))})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Employee"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Leave Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"From"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"To"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Days"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:[A.map((xe,Z)=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-gray-900 dark:text-white",children:xe.employee_name}),e.jsx("td",{className:"px-4 py-3",children:xe.leave_type_name}),e.jsx("td",{className:"px-4 py-3",children:xe.start_date}),e.jsx("td",{className:"px-4 py-3",children:xe.end_date}),e.jsx("td",{className:"px-4 py-3",children:xe.days_requested}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${xe.status==="approved"?"bg-green-100 text-green-700":xe.status==="rejected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:xe.status})}),e.jsx("td",{className:"px-4 py-3",children:xe.status==="pending"&&e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>V(xe.id,"approved"),className:"p-1 bg-green-100 text-green-600 rounded hover:bg-green-200",children:e.jsx(Tn,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>V(xe.id,"rejected"),className:"p-1 bg-red-100 text-red-600 rounded hover:bg-red-200",children:e.jsx(Nt,{className:"w-4 h-4"})})]})})]},Z)),A.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-4 py-8 text-center text-gray-500",children:"No leave requests"})})]})]})})]}),t==="reviews"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:()=>P("review"),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(qt,{className:"w-4 h-4"})," New Review"]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[y.map((xe,Z)=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:xe.employee_name}),e.jsx("p",{className:"text-sm text-gray-500",children:xe.review_period})]}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${xe.status==="submitted"?"bg-green-100 text-green-700":xe.status==="acknowledged"?"bg-blue-100 text-blue-700":"bg-yellow-100 text-yellow-700"}`,children:xe.status})]}),xe.overall_rating&&e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("span",{className:"text-2xl font-bold text-blue-600",children:xe.overall_rating}),e.jsx("span",{className:"text-gray-500",children:"/5"})]}),e.jsx("button",{className:"w-full py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-lg",children:"View Details"})]},Z)),y.length===0&&e.jsx("div",{className:"col-span-full text-center py-8 text-gray-500",children:"No performance reviews yet"})]})]}),t==="salary"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:()=>P("salary"),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(qt,{className:"w-4 h-4"})," New Structure"]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[U.map((xe,Z)=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:xe.name}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Basic Salary"}),e.jsx("span",{className:"font-medium",children:re(xe.basic_salary)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Housing"}),e.jsxs("span",{className:"text-green-600",children:["+",re(xe.housing_allowance)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Transport"}),e.jsxs("span",{className:"text-green-600",children:["+",re(xe.transport_allowance)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Medical"}),e.jsxs("span",{className:"text-green-600",children:["+",re(xe.medical_allowance)]})]}),e.jsx("hr",{className:"my-2 dark:border-gray-700"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Tax Rate"}),e.jsxs("span",{className:"text-red-600",children:[xe.tax_rate,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Pension Rate"}),e.jsxs("span",{className:"text-red-600",children:[xe.pension_rate,"%"]})]})]})]},Z)),U.length===0&&e.jsx("div",{className:"col-span-full text-center py-8 text-gray-500",children:"No salary structures defined"})]})]})]})}const Am=`${ee}/alumni.php`;function kT(){const[t,s]=h.useState("dashboard"),[a,r]=h.useState(!1),[l,c]=h.useState(null),[o,m]=h.useState([]),[u,x]=h.useState([]),[A,g]=h.useState([]),[N,f]=h.useState([]),[y,v]=h.useState(null),[U,D]=h.useState({year:"",industry:"",status:"active"}),[M,K]=h.useState(null),[$,P]=h.useState(null);h.useEffect(()=>{se()},[]),h.useEffect(()=>{t==="alumni"&&z(),t==="events"&&R(),t==="donations"&&(j(),T()),t==="statistics"&&Q()},[t,U]);const se=async()=>{try{r(!0);const O=await F.get(`${Am}?action=dashboard`);c(O.data.dashboard)}catch(O){console.error(O)}finally{r(!1)}},z=async()=>{try{const O=new URLSearchParams({action:"list",...U}),V=await F.get(`${Am}?${O}`);m(V.data.alumni||[])}catch(O){console.error(O)}},R=async()=>{try{const O=await F.get(`${Am}?action=events&status=published`);x(O.data.events||[])}catch(O){console.error(O)}},j=async()=>{try{const O=await F.get(`${Am}?action=campaigns&status=active`);g(O.data.campaigns||[])}catch(O){console.error(O)}},T=async()=>{try{const O=await F.get(`${Am}?action=donation_stats`);f(O.data)}catch(O){console.error(O)}},Q=async()=>{try{const O=await F.get(`${Am}?action=statistics`);v(O.data)}catch(O){console.error(O)}},E=async(O,V)=>{try{await F.post(`${Am}?action=verify`,{alumni_id:O,status:V}),z(),se()}catch{alert("Failed to verify alumni")}},te=O=>new Intl.NumberFormat("en-GH",{style:"currency",currency:"GHS"}).format(O||0),C=[{id:"dashboard",label:"Dashboard",icon:$s},{id:"alumni",label:"Alumni Directory",icon:Rt},{id:"events",label:"Events",icon:Ot},{id:"donations",label:"Donations",icon:Oo},{id:"statistics",label:"Statistics",icon:Ln}];return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Alumni Management"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Connect with graduates, manage events & donations"})]}),e.jsx("button",{onClick:se,className:"p-2 rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200",children:e.jsx(Ns,{className:`w-5 h-5 ${a?"animate-spin":""}`})})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:C.map(O=>e.jsxs("button",{onClick:()=>s(O.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg whitespace-nowrap transition-colors ${t===O.id?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200"}`,children:[e.jsx(O.icon,{className:"w-4 h-4"}),O.label]},O.id))}),t==="dashboard"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(Rd,{icon:Rt,label:"Total Alumni",value:l?.total_alumni||0,color:"blue",loading:a}),e.jsx(Rd,{icon:Tn,label:"Verified",value:l?.verified_alumni||0,color:"green",loading:a}),e.jsx(Rd,{icon:Qs,label:"Active Mentors",value:l?.active_mentors||0,color:"purple",loading:a}),e.jsx(Rd,{icon:vs,label:"Total Donations",value:te(l?.total_donations),color:"yellow",loading:a})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Pending Verifications"}),e.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-700 text-xs rounded-full",children:l.pending_verification})]}),e.jsx("div",{className:"space-y-3",children:l.recent_registrations?.slice(0,5).map((O,V)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[O.first_name," ",O.last_name]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Class of ",O.graduation_year]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>E(O.id,!0),className:"p-1 bg-green-100 text-green-600 rounded hover:bg-green-200",children:e.jsx(Tn,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>E(O.id,!1),className:"p-1 bg-red-100 text-red-600 rounded hover:bg-red-200",children:e.jsx(Nt,{className:"w-4 h-4"})})]})]},V))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Upcoming Events"}),e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full",children:l.upcoming_events})]}),e.jsx("button",{onClick:()=>s("events"),className:"w-full py-3 text-blue-600 hover:bg-blue-50 rounded-lg text-sm",children:"View All Events"})]})]})]}),t==="alumni"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search alumni...",className:"pl-9 pr-4 py-2 border rounded-lg text-sm dark:bg-gray-700 dark:border-gray-600 w-64"})]}),e.jsxs("select",{value:U.year,onChange:O=>D({...U,year:O.target.value}),className:"px-3 py-2 border rounded-lg text-sm dark:bg-gray-700 dark:border-gray-600",children:[e.jsx("option",{value:"",children:"All Years"}),Array.from({length:20},(O,V)=>new Date().getFullYear()-V).map(O=>e.jsx("option",{value:O,children:O},O))]})]}),e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(qt,{className:"w-4 h-4"})," Add Alumni"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[o.map((O,V)=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold",children:[O.first_name?.[0],O.last_name?.[0]]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 dark:text-white",children:[O.first_name," ",O.last_name]}),O.is_verified&&e.jsx(Tn,{className:"w-4 h-4 text-green-500"})]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Class of ",O.graduation_year]})]})]}),e.jsxs("div",{className:"mt-4 space-y-2 text-sm",children:[O.current_occupation&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[e.jsx(Pr,{className:"w-4 h-4"}),e.jsx("span",{children:O.current_occupation})]}),O.current_company&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[e.jsx(Ou,{className:"w-4 h-4"}),e.jsx("span",{children:O.current_company})]}),(O.location_city||O.location_country)&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[e.jsx(Qn,{className:"w-4 h-4"}),e.jsx("span",{children:[O.location_city,O.location_country].filter(Boolean).join(", ")})]})]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[O.is_mentor&&e.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded-full",children:"Mentor"}),O.industry&&e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full",children:O.industry})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t dark:border-gray-700 flex gap-2",children:[e.jsx("button",{className:"flex-1 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-lg",children:"View Profile"}),e.jsx("button",{className:"flex-1 py-2 text-sm text-gray-600 hover:bg-gray-50 rounded-lg",children:"Contact"})]})]},V)),o.length===0&&e.jsx("div",{className:"col-span-full text-center py-8 text-gray-500",children:"No alumni found"})]})]}),t==="events"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:()=>K("event"),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(qt,{className:"w-4 h-4"})," Create Event"]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[u.map((O,V)=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"h-32 bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center",children:e.jsx(Ot,{className:"w-12 h-12 text-white/80"})}),e.jsxs("div",{className:"p-4",children:[e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${O.event_type==="reunion"?"bg-purple-100 text-purple-700":O.event_type==="networking"?"bg-blue-100 text-blue-700":O.event_type==="fundraiser"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:O.event_type}),e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mt-2",children:O.title}),e.jsx("p",{className:"text-sm text-gray-500 mt-1 line-clamp-2",children:O.description}),e.jsxs("div",{className:"mt-4 space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[e.jsx(Ot,{className:"w-4 h-4"}),e.jsx("span",{children:new Date(O.event_date).toLocaleDateString()})]}),O.location&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[e.jsx(Qn,{className:"w-4 h-4"}),e.jsx("span",{children:O.location})]}),O.is_virtual&&e.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[e.jsx(Ou,{className:"w-4 h-4"}),e.jsx("span",{children:"Virtual Event"})]})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:[O.registered_count||0," registered"]}),e.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700",children:"View Details"})]})]})]},V)),u.length===0&&e.jsx("div",{className:"col-span-full text-center py-8 text-gray-500",children:"No events scheduled"})]})]}),t==="donations"&&e.jsxs("div",{className:"space-y-6",children:[N.totals&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-xl p-6 text-white",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Total Raised"}),e.jsx("p",{className:"text-3xl font-bold",children:te(N.totals.total_amount)}),e.jsxs("p",{className:"text-sm text-green-100 mt-1",children:[N.totals.total_donations," donations"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-6 text-white",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Unique Donors"}),e.jsx("p",{className:"text-3xl font-bold",children:N.totals.unique_donors})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl p-6 text-white",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Active Campaigns"}),e.jsx("p",{className:"text-3xl font-bold",children:A.length})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Active Campaigns"}),e.jsxs("button",{className:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700",children:[e.jsx(qt,{className:"w-4 h-4"})," New Campaign"]})]}),e.jsxs("div",{className:"space-y-4",children:[A.map((O,V)=>e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:O.title}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:O.description})]}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${O.campaign_type==="scholarship"?"bg-purple-100 text-purple-700":O.campaign_type==="infrastructure"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:O.campaign_type})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-500",children:"Progress"}),e.jsxs("span",{className:"font-medium",children:[te(O.raised_amount)," / ",te(O.goal_amount)]})]}),e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-600 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500 rounded-full",style:{width:`${Math.min(100,O.raised_amount/O.goal_amount*100)}%`}})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[Math.round(O.raised_amount/O.goal_amount*100),"% of goal"]})]})]},V)),A.length===0&&e.jsx("p",{className:"text-center py-4 text-gray-500",children:"No active campaigns"})]})]})]}),t==="statistics"&&y&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Alumni by Graduation Year"}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:y.by_year?.map((O,V)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-16 text-sm text-gray-600 dark:text-gray-400",children:O.graduation_year}),e.jsx("div",{className:"flex-1 h-6 bg-gray-200 dark:bg-gray-600 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${Math.min(100,O.count/50*100)}%`}})}),e.jsx("span",{className:"w-8 text-sm font-medium text-right",children:O.count})]},V))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Alumni by Industry"}),e.jsx("div",{className:"space-y-2",children:y.by_industry?.map((O,V)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-32 text-sm text-gray-600 dark:text-gray-400 truncate",children:O.industry}),e.jsx("div",{className:"flex-1 h-6 bg-gray-200 dark:bg-gray-600 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500 rounded-full",style:{width:`${Math.min(100,O.count/30*100)}%`}})}),e.jsx("span",{className:"w-8 text-sm font-medium text-right",children:O.count})]},V))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 lg:col-span-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Alumni by Location"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:y.by_location?.map((O,V)=>e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:O.count}),e.jsx("p",{className:"text-sm text-gray-500",children:O.location_country})]},V))})]})]})]})}const li=`${ee}/integrations.php`;function BT(){const[t,s]=h.useState("overview"),[a,r]=h.useState(!1),[l,c]=h.useState([]),[o,m]=h.useState([]),[u,x]=h.useState([]),[A,g]=h.useState(null),[N,f]=h.useState(null),[y,v]=h.useState({}),[U,D]=h.useState(null),[M,K]=h.useState([]),[$,P]=h.useState([]),[se,z]=h.useState({name:"",content:"",subject:"",body:"",category:"general"}),[R,j]=h.useState({name:"",url:"",events:[]});h.useEffect(()=>{T()},[]),h.useEffect(()=>{t==="sms"&&Q(),t==="email"&&E(),t==="webhooks"&&(ge(),xe())},[t]);const T=async()=>{try{r(!0);const w=await F.get(`${li}?action=list`);c(w.data.integrations||[])}catch(w){console.error(w)}finally{r(!1)}},Q=async()=>{try{const w=await F.get(`${li}?action=sms_templates`);m(w.data.templates||[])}catch(w){console.error(w)}},E=async()=>{try{const w=await F.get(`${li}?action=email_templates`);x(w.data.templates||[])}catch(w){console.error(w)}},te=async()=>{try{await F.post(`${li}?action=save`,{integration_type:N,provider:y.provider,settings:y.settings,is_enabled:y.is_enabled?1:0}),T(),g(null),alert("Integration saved successfully!")}catch{alert("Failed to save integration")}},C=async w=>{try{D({loading:!0});const oe=await F.post(`${li}?action=test`,{integration_type:w});D({success:oe.data.success,message:oe.data.message})}catch{D({success:!1,message:"Test failed"})}},O=async()=>{try{const w=await F.post(`${li}?action=send_sms`,{recipient:y.test_phone,message:y.test_message||"This is a test message from McSMS"});alert(w.data.success?"SMS sent successfully!":"Failed to send SMS")}catch{alert("Failed to send SMS")}},V=async()=>{try{const w=await F.post(`${li}?action=send_email`,{recipient:y.test_email,subject:y.test_subject||"Test Email from McSMS",body:y.test_body||"<p>This is a test email from McSMS.</p>"});alert(w.data.success?"Email sent successfully!":"Failed to send email")}catch{alert("Failed to send email")}},re=w=>l.find(oe=>oe.integration_type===w),ge=async()=>{try{const w=await F.get(`${li}?action=webhooks`);K(w.data.webhooks||[])}catch(w){console.error(w)}},xe=async()=>{try{const w=await F.get(`${li}?action=api_keys`);P(w.data.api_keys||[])}catch(w){console.error(w)}},Z=async()=>{try{await F.post(`${li}?action=save_sms_template`,se),Q(),g(null),z({name:"",content:"",category:"general"}),alert("SMS template saved!")}catch{alert("Failed to save template")}},I=async()=>{try{await F.post(`${li}?action=save_email_template`,se),E(),g(null),z({name:"",subject:"",body:"",category:"general"}),alert("Email template saved!")}catch{alert("Failed to save template")}},H=async()=>{try{await F.post(`${li}?action=save_webhook`,R),ge(),g(null),j({name:"",url:"",events:[]}),alert("Webhook saved!")}catch{alert("Failed to save webhook")}},ae=async()=>{try{const w=await F.post(`${li}?action=generate_api_key`);w.data.success&&(alert(`API Key generated: ${w.data.api_key}

Copy this key now - it won't be shown again!`),xe())}catch{alert("Failed to generate API key")}},k=[{type:"sms",label:"SMS Gateway",icon:wa,color:"green",providers:["hubtel","mnotify","arkesel","twilio"]},{type:"email",label:"Email Service",icon:ra,color:"blue",providers:["smtp","sendgrid","mailgun"]},{type:"payment",label:"Payment Gateway",icon:aa,color:"purple",providers:["paystack","flutterwave","momo"]},{type:"accounting",label:"Accounting",icon:lb,color:"yellow",providers:["quickbooks","xero","sage"]},{type:"calendar",label:"Calendar",icon:Ot,color:"red",providers:["google","outlook"]}],B=[{id:"overview",label:"Overview",icon:fy},{id:"sms",label:"SMS",icon:wa},{id:"email",label:"Email",icon:ra},{id:"payment",label:"Payments",icon:aa},{id:"webhooks",label:"Webhooks",icon:uF}];return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Integration Hub"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Connect third-party services and APIs"})]}),e.jsx("button",{onClick:T,className:"p-2 rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200",children:e.jsx(Ns,{className:`w-5 h-5 ${a?"animate-spin":""}`})})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:B.map(w=>e.jsxs("button",{onClick:()=>s(w.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg whitespace-nowrap transition-colors ${t===w.id?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200"}`,children:[e.jsx(w.icon,{className:"w-4 h-4"}),w.label]},w.id))}),t==="overview"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:k.map(w=>{const oe=re(w.type),ne=oe?.is_enabled,Fe={green:"bg-green-100 dark:bg-green-900/30 text-green-600 border-green-200",blue:"bg-blue-100 dark:bg-blue-900/30 text-blue-600 border-blue-200",purple:"bg-purple-100 dark:bg-purple-900/30 text-purple-600 border-purple-200",yellow:"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-600 border-yellow-200",red:"bg-red-100 dark:bg-red-900/30 text-red-600 border-red-200"};return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:`p-3 rounded-xl ${Fe[w.color]}`,children:e.jsx(w.icon,{className:"w-6 h-6"})}),e.jsx("div",{className:`px-2 py-1 text-xs rounded-full ${ne?"bg-green-100 text-green-700":"bg-gray-100 text-gray-500"}`,children:ne?"Connected":"Not Connected"})]}),e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mt-4",children:w.label}),oe?.provider&&e.jsxs("p",{className:"text-sm text-gray-500 mt-1 capitalize",children:["Provider: ",oe.provider]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx("button",{onClick:()=>{f(w.type),v({provider:oe?.provider||w.providers[0],settings:oe?.settings||{},is_enabled:oe?.is_enabled||!1}),g("configure")},className:"flex-1 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-lg",children:"Configure"}),ne&&e.jsx("button",{onClick:()=>C(w.type),className:"flex-1 py-2 text-sm text-green-600 hover:bg-green-50 rounded-lg",children:"Test"})]})]},w.type)})}),t==="sms"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"SMS Configuration"}),(()=>{const w=re("sms");return w?.is_enabled?e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[e.jsx(Mt,{className:"w-5 h-5"}),e.jsxs("span",{children:["Connected to ",w.provider]})]}),e.jsx("button",{onClick:()=>{f("sms"),v({provider:w.provider,settings:w.settings||{},is_enabled:!0}),g("configure")},className:"text-blue-600 text-sm hover:underline",children:"Edit Settings"})]}):e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-yellow-600",children:[e.jsx(_s,{className:"w-5 h-5"}),e.jsx("span",{children:"SMS not configured"})]}),e.jsx("button",{onClick:()=>{f("sms"),v({provider:"hubtel",settings:{},is_enabled:!1}),g("configure")},className:"text-blue-600 text-sm hover:underline",children:"Configure Now"})]})})()]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Send Test SMS"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("input",{type:"tel",placeholder:"Phone Number (e.g., 0241234567)",value:y.test_phone||"",onChange:w=>v({...y,test_phone:w.target.value}),className:"px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600"}),e.jsx("input",{type:"text",placeholder:"Message",value:y.test_message||"",onChange:w=>v({...y,test_message:w.target.value}),className:"px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600"})]}),e.jsxs("button",{onClick:O,className:"mt-4 flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[e.jsx(va,{className:"w-4 h-4"})," Send Test SMS"]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"SMS Templates"}),e.jsxs("button",{onClick:()=>{z({name:"",content:"",category:"general"}),g("sms_template")},className:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700",children:[e.jsx(qt,{className:"w-4 h-4"})," Add Template"]})]}),e.jsxs("div",{className:"space-y-3",children:[o.map((w,oe)=>e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:w.name}),e.jsx("span",{className:"text-xs text-gray-500 capitalize",children:w.category})]}),e.jsx("button",{onClick:()=>{z(w),g("sms_template")},className:"text-blue-600 text-sm hover:underline",children:"Edit"})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:w.content})]},oe)),o.length===0&&e.jsx("p",{className:"text-center py-4 text-gray-500",children:"No SMS templates"})]})]})]}),t==="email"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Email Configuration"}),(()=>{const w=re("email");return w?.is_enabled?e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[e.jsx(Mt,{className:"w-5 h-5"}),e.jsxs("span",{children:["Connected via ",w.provider]})]}),e.jsx("button",{onClick:()=>{f("email"),v({provider:w.provider,settings:w.settings||{},is_enabled:!0}),g("configure")},className:"text-blue-600 text-sm hover:underline",children:"Edit Settings"})]}):e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-yellow-600",children:[e.jsx(_s,{className:"w-5 h-5"}),e.jsx("span",{children:"Email not configured"})]}),e.jsx("button",{onClick:()=>{f("email"),v({provider:"smtp",settings:{},is_enabled:!1}),g("configure")},className:"text-blue-600 text-sm hover:underline",children:"Configure Now"})]})})()]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Send Test Email"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"email",placeholder:"Recipient Email",value:y.test_email||"",onChange:w=>v({...y,test_email:w.target.value}),className:"w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600"}),e.jsx("input",{type:"text",placeholder:"Subject",value:y.test_subject||"",onChange:w=>v({...y,test_subject:w.target.value}),className:"w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600"}),e.jsx("textarea",{placeholder:"Email Body (HTML supported)",value:y.test_body||"",onChange:w=>v({...y,test_body:w.target.value}),rows:4,className:"w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600"})]}),e.jsxs("button",{onClick:V,className:"mt-4 flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(va,{className:"w-4 h-4"})," Send Test Email"]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Email Templates"}),e.jsxs("button",{onClick:()=>{z({name:"",subject:"",body:"",category:"general"}),g("email_template")},className:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700",children:[e.jsx(qt,{className:"w-4 h-4"})," Add Template"]})]}),e.jsxs("div",{className:"space-y-3",children:[u.map((w,oe)=>e.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:w.name}),e.jsx("p",{className:"text-sm text-gray-500",children:w.subject})]}),e.jsx("button",{onClick:()=>{z(w),g("email_template")},className:"text-blue-600 text-sm hover:underline",children:"Edit"})]})},oe)),u.length===0&&e.jsx("p",{className:"text-center py-4 text-gray-500",children:"No email templates"})]})]})]}),t==="payment"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Payment Gateway"}),(()=>{const w=re("payment");return w?.is_enabled?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[e.jsx(Mt,{className:"w-5 h-5"}),e.jsxs("span",{children:["Connected to ",w.provider]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Provider"}),e.jsx("p",{className:"font-semibold capitalize",children:w.provider})]}),e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Mode"}),e.jsx("p",{className:"font-semibold",children:w.settings?.mode||"Test"})]}),e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Status"}),e.jsx("p",{className:"font-semibold text-green-600",children:"Active"})]})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(aa,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"No payment gateway configured"}),e.jsx("button",{onClick:()=>{f("payment"),v({provider:"paystack",settings:{},is_enabled:!1}),g("configure")},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Configure Payment Gateway"})]})})()]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Supported Payment Gateways"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[{name:"Paystack",currencies:["GHS","NGN","USD"],logo:""},{name:"Flutterwave",currencies:["GHS","NGN","KES"],logo:""},{name:"Mobile Money",currencies:["GHS"],logo:""}].map((w,oe)=>e.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:w.logo}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:w.name}),e.jsx("p",{className:"text-xs text-gray-500",children:w.currencies.join(", ")})]})]})},oe))})]})]}),t==="webhooks"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Webhooks"}),e.jsxs("button",{onClick:()=>{j({name:"",url:"",events:[]}),g("webhook")},className:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700",children:[e.jsx(qt,{className:"w-4 h-4"})," Add Webhook"]})]}),e.jsx("p",{className:"text-gray-500 text-sm mb-4",children:"Webhooks allow external services to receive real-time notifications when events occur in McSMS."}),e.jsxs("div",{className:"space-y-3",children:[M.map((w,oe)=>e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:w.name}),e.jsx("p",{className:"text-sm text-gray-500",children:w.url})]}),e.jsx("span",{className:"px-2 py-1 text-xs bg-green-100 text-green-700 rounded-full",children:"Active"})]}),e.jsx("div",{className:"mt-2 flex gap-2 flex-wrap",children:(w.events||[]).map((ne,Fe)=>e.jsx("span",{className:"px-2 py-1 text-xs bg-gray-200 dark:bg-gray-600 rounded",children:ne},Fe))})]},oe)),M.length===0&&e.jsx("p",{className:"text-center py-4 text-gray-500",children:"No webhooks configured"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"API Keys"}),e.jsxs("button",{onClick:ae,className:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700",children:[e.jsx(py,{className:"w-4 h-4"})," Generate Key"]})]}),e.jsxs("div",{className:"space-y-3",children:[$.map((w,oe)=>e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:w.name}),e.jsx("p",{className:"text-sm text-gray-500 font-mono",children:w.api_key_masked})]}),e.jsx("span",{className:"text-xs text-gray-500",children:w.created_at})]},oe)),$.length===0&&e.jsx("p",{className:"text-center py-4 text-gray-500",children:"No API keys generated yet"})]})]})]}),A==="configure"&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white capitalize",children:["Configure ",N]}),e.jsx("button",{onClick:()=>g(null),className:"p-1 hover:bg-gray-100 rounded",children:e.jsx(Nt,{className:"w-5 h-5"})})]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Provider"}),e.jsx("select",{value:y.provider,onChange:w=>v({...y,provider:w.target.value}),className:"w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600",children:k.find(w=>w.type===N)?.providers.map(w=>e.jsx("option",{value:w,className:"capitalize",children:w},w))})]}),N==="sms"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"API Key"}),e.jsx("input",{type:"password",value:y.settings?.api_key||"",onChange:w=>v({...y,settings:{...y.settings,api_key:w.target.value}}),className:"w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Sender ID"}),e.jsx("input",{type:"text",value:y.settings?.sender_id||"",onChange:w=>v({...y,settings:{...y.settings,sender_id:w.target.value}}),className:"w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600",placeholder:"e.g., SCHOOL"})]})]}),N==="email"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"From Email"}),e.jsx("input",{type:"email",value:y.settings?.from_email||"",onChange:w=>v({...y,settings:{...y.settings,from_email:w.target.value}}),className:"w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"From Name"}),e.jsx("input",{type:"text",value:y.settings?.from_name||"",onChange:w=>v({...y,settings:{...y.settings,from_name:w.target.value}}),className:"w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600"})]}),y.provider==="smtp"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SMTP Host"}),e.jsx("input",{type:"text",value:y.settings?.smtp_host||"",onChange:w=>v({...y,settings:{...y.settings,smtp_host:w.target.value}}),className:"w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Port"}),e.jsx("input",{type:"number",value:y.settings?.smtp_port||"",onChange:w=>v({...y,settings:{...y.settings,smtp_port:w.target.value}}),className:"w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Encryption"}),e.jsxs("select",{value:y.settings?.encryption||"tls",onChange:w=>v({...y,settings:{...y.settings,encryption:w.target.value}}),className:"w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600",children:[e.jsx("option",{value:"tls",children:"TLS"}),e.jsx("option",{value:"ssl",children:"SSL"}),e.jsx("option",{value:"none",children:"None"})]})]})]})]}),(y.provider==="sendgrid"||y.provider==="mailgun")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"API Key"}),e.jsx("input",{type:"password",value:y.settings?.api_key||"",onChange:w=>v({...y,settings:{...y.settings,api_key:w.target.value}}),className:"w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600"})]})]}),N==="payment"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Public Key"}),e.jsx("input",{type:"text",value:y.settings?.public_key||"",onChange:w=>v({...y,settings:{...y.settings,public_key:w.target.value}}),className:"w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Secret Key"}),e.jsx("input",{type:"password",value:y.settings?.secret_key||"",onChange:w=>v({...y,settings:{...y.settings,secret_key:w.target.value}}),className:"w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Mode"}),e.jsxs("select",{value:y.settings?.mode||"test",onChange:w=>v({...y,settings:{...y.settings,mode:w.target.value}}),className:"w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600",children:[e.jsx("option",{value:"test",children:"Test"}),e.jsx("option",{value:"live",children:"Live"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"enabled",checked:y.is_enabled,onChange:w=>v({...y,is_enabled:w.target.checked}),className:"w-4 h-4"}),e.jsx("label",{htmlFor:"enabled",className:"text-sm text-gray-700 dark:text-gray-300",children:"Enable this integration"})]})]}),e.jsxs("div",{className:"p-6 border-t dark:border-gray-700 flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>g(null),className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:"Cancel"}),e.jsx("button",{onClick:te,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Save Configuration"})]})]})}),A==="sms_template"&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl w-full max-w-lg",children:[e.jsx("div",{className:"p-6 border-b dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[se.id?"Edit":"Add"," SMS Template"]}),e.jsx("button",{onClick:()=>g(null),className:"p-1 hover:bg-gray-100 rounded",children:e.jsx(Nt,{className:"w-5 h-5"})})]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Template Name"}),e.jsx("input",{type:"text",value:se.name,onChange:w=>z({...se,name:w.target.value}),className:"w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600",placeholder:"e.g., Fee Reminder"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Category"}),e.jsxs("select",{value:se.category,onChange:w=>z({...se,category:w.target.value}),className:"w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600",children:[e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"fees",children:"Fees"}),e.jsx("option",{value:"attendance",children:"Attendance"}),e.jsx("option",{value:"exam",children:"Exam"}),e.jsx("option",{value:"event",children:"Event"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Message Content"}),e.jsx("textarea",{value:se.content,onChange:w=>z({...se,content:w.target.value}),rows:4,className:"w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600",placeholder:"Use {student_name}, {amount}, {date} as placeholders"})]})]}),e.jsxs("div",{className:"p-6 border-t dark:border-gray-700 flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>g(null),className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:"Cancel"}),e.jsx("button",{onClick:Z,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Save Template"})]})]})}),A==="email_template"&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[se.id?"Edit":"Add"," Email Template"]}),e.jsx("button",{onClick:()=>g(null),className:"p-1 hover:bg-gray-100 rounded",children:e.jsx(Nt,{className:"w-5 h-5"})})]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Template Name"}),e.jsx("input",{type:"text",value:se.name,onChange:w=>z({...se,name:w.target.value}),className:"w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600",placeholder:"e.g., Welcome Email"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Category"}),e.jsxs("select",{value:se.category,onChange:w=>z({...se,category:w.target.value}),className:"w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600",children:[e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"fees",children:"Fees"}),e.jsx("option",{value:"attendance",children:"Attendance"}),e.jsx("option",{value:"exam",children:"Exam"}),e.jsx("option",{value:"event",children:"Event"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Subject"}),e.jsx("input",{type:"text",value:se.subject,onChange:w=>z({...se,subject:w.target.value}),className:"w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600",placeholder:"Email subject line"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Body (HTML)"}),e.jsx("textarea",{value:se.body,onChange:w=>z({...se,body:w.target.value}),rows:6,className:"w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600",placeholder:"<p>Dear {student_name},</p>"})]})]}),e.jsxs("div",{className:"p-6 border-t dark:border-gray-700 flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>g(null),className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:"Cancel"}),e.jsx("button",{onClick:I,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Save Template"})]})]})}),A==="webhook"&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl w-full max-w-lg",children:[e.jsx("div",{className:"p-6 border-b dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[R.id?"Edit":"Add"," Webhook"]}),e.jsx("button",{onClick:()=>g(null),className:"p-1 hover:bg-gray-100 rounded",children:e.jsx(Nt,{className:"w-5 h-5"})})]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Webhook Name"}),e.jsx("input",{type:"text",value:R.name,onChange:w=>j({...R,name:w.target.value}),className:"w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600",placeholder:"e.g., Payment Notifications"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Endpoint URL"}),e.jsx("input",{type:"url",value:R.url,onChange:w=>j({...R,url:w.target.value}),className:"w-full px-4 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600",placeholder:"https://your-server.com/webhook"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Events"}),e.jsx("div",{className:"space-y-2",children:["payment.success","payment.failed","student.enrolled","student.unenrolled","fee.paid","attendance.marked"].map(w=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:R.events?.includes(w),onChange:oe=>{const ne=R.events||[];j({...R,events:oe.target.checked?[...ne,w]:ne.filter(Fe=>Fe!==w)})},className:"w-4 h-4"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:w})]},w))})]})]}),e.jsxs("div",{className:"p-6 border-t dark:border-gray-700 flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>g(null),className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:"Cancel"}),e.jsx("button",{onClick:H,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Save Webhook"})]})]})}),U&&!U.loading&&e.jsxs("div",{className:`fixed bottom-4 right-4 p-4 rounded-lg shadow-lg ${U.success?"bg-green-500":"bg-red-500"} text-white max-w-sm`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[U.success?e.jsx(Mt,{className:"w-5 h-5"}):e.jsx(Js,{className:"w-5 h-5"}),e.jsx("span",{children:U.message})]}),e.jsx("button",{onClick:()=>D(null),className:"absolute top-1 right-1 p-1",children:e.jsx(Nt,{className:"w-4 h-4"})})]})]})}const gm=`${ee}/report_builder.php`;function FT(){const[t,s]=h.useState([]),[a,r]=h.useState([]),[l,c]=h.useState([]),[o,m]=h.useState([]),[u,x]=h.useState(!1),[A,g]=h.useState("reports"),[N,f]=h.useState(!1),[y,v]=h.useState({name:"New Report",description:"",data_source:"",columns:[],filters:[],grouping:[],sorting:[],chart_type:null,chart_config:{}}),[U,D]=h.useState([]),[M,K]=h.useState(!1),[$,P]=h.useState(!1);h.useEffect(()=>{se(),z(),R()},[]),h.useEffect(()=>{y.data_source&&j(y.data_source)},[y.data_source]);const se=async()=>{try{const k=await F.get(`${gm}?action=list`);s(k.data.reports||[])}catch(k){console.error("Error fetching reports:",k)}},z=async()=>{try{const k=await F.get(`${gm}?action=templates`);r(k.data.templates||[])}catch(k){console.error("Error fetching templates:",k)}},R=async()=>{try{const k=await F.get(`${gm}?action=data_sources`);c(k.data.sources||[])}catch(k){console.error("Error fetching data sources:",k)}},j=async k=>{try{const B=await F.get(`${gm}?action=fields&source=${k}`);m(B.data.fields||[])}catch(B){console.error("Error fetching fields:",B)}},T=()=>{v({name:"New Report",description:"",data_source:"",columns:[],filters:[],grouping:[],sorting:[],chart_type:null,chart_config:{}}),f(!0),P(!1),D([])},Q=k=>{v(k),f(!0),P(!1)},E=k=>{v({...k,id:null,name:k.name+" (Copy)"}),f(!0)},te=async()=>{try{x(!0);const k=await F.post(`${gm}?action=save`,y);k.data.success&&(alert("Report saved successfully!"),se(),y.id||v({...y,id:k.data.id}))}catch{alert("Error saving report")}finally{x(!1)}},C=async k=>{if(confirm("Are you sure you want to delete this report?"))try{await F.post(`${gm}?action=delete&id=${k}`),se()}catch{alert("Error deleting report")}},O=async()=>{if(!y.data_source){alert("Please select a data source");return}try{K(!0);const k=await F.post(`${gm}?action=generate`,{...y,limit:100});k.data.success&&(D(k.data.data||[]),P(!0))}catch{alert("Error generating preview")}finally{K(!1)}},V=()=>{const k=new ms;k.setFontSize(16),k.text(y.name,14,20),k.setFontSize(10),k.text(`Generated: ${new Date().toLocaleString()}`,14,28);const B=y.columns.map(oe=>oe.alias||oe.name||oe.field),w=U.map(oe=>y.columns.map(ne=>{const Fe=ne.alias||ne.field.split(".").pop();return oe[Fe]??""}));Ma(k,{head:[B],body:w,startY:35,styles:{fontSize:8}}),k.save(`${y.name}.pdf`)},re=()=>{const k=y.columns.map(je=>je.alias||je.name||je.field),B=U.map(je=>y.columns.map(Ge=>{const ze=Ge.alias||Ge.field.split(".").pop();return`"${(je[ze]??"").toString().replace(/"/g,'""')}"`}).join(",")),w=[k.join(","),...B].join(`
`),oe=new Blob([w],{type:"text/csv"}),ne=URL.createObjectURL(oe),Fe=document.createElement("a");Fe.href=ne,Fe.download=`${y.name}.csv`,Fe.click()},ge=k=>{y.columns.find(B=>B.field===k.field)||v({...y,columns:[...y.columns,{...k,alias:k.name}]})},xe=k=>{const B=[...y.columns];B.splice(k,1),v({...y,columns:B})},Z=()=>{v({...y,filters:[...y.filters,{field:"",operator:"equals",value:""}]})},I=(k,B)=>{const w=[...y.filters];w[k]={...w[k],...B},v({...y,filters:w})},H=k=>{const B=[...y.filters];B.splice(k,1),v({...y,filters:B})},ae=()=>{v({...y,sorting:[...y.sorting,{field:"",direction:"ASC"}]})};return N?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>f(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:e.jsx(Nt,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("input",{type:"text",value:y.name,onChange:k=>v({...y,name:k.target.value}),className:"text-2xl font-bold bg-transparent border-none focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 py-1 text-gray-900 dark:text-white"}),e.jsx("input",{type:"text",value:y.description,onChange:k=>v({...y,description:k.target.value}),placeholder:"Add description...",className:"block text-sm text-gray-500 dark:text-gray-400 bg-transparent border-none focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 py-1 mt-1"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:O,disabled:M,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:[M?e.jsx(Ns,{className:"w-4 h-4 animate-spin"}):e.jsx(Qi,{className:"w-4 h-4"}),"Preview"]}),e.jsxs("button",{onClick:te,disabled:u,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(Br,{className:"w-4 h-4"}),"Save"]})]})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[e.jsxs("div",{className:"col-span-4 space-y-4",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-3",children:"Data Source"}),e.jsxs("select",{value:y.data_source,onChange:k=>v({...y,data_source:k.target.value,columns:[]}),className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:"Select data source..."}),l.map(k=>e.jsx("option",{value:k.id,children:k.name},k.id))]})]}),y.data_source&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-3",children:"Available Fields"}),e.jsx("div",{className:"space-y-1 max-h-60 overflow-y-auto",children:o.map(k=>e.jsxs("button",{onClick:()=>ge(k),disabled:y.columns.find(B=>B.field===k.field),className:"w-full flex items-center gap-2 p-2 text-left text-sm hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(qt,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:k.name}),e.jsx("span",{className:"text-xs text-gray-400 ml-auto",children:k.type})]},k.field))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Filters"}),e.jsx("button",{onClick:Z,className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:e.jsx(qt,{className:"w-4 h-4 text-gray-500"})})]}),e.jsxs("div",{className:"space-y-2",children:[y.filters.map((k,B)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("select",{value:k.field,onChange:w=>I(B,{field:w.target.value}),className:"flex-1 p-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:"Field..."}),o.map(w=>e.jsx("option",{value:w.field,children:w.name},w.field))]}),e.jsxs("select",{value:k.operator,onChange:w=>I(B,{operator:w.target.value}),className:"w-24 p-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"equals",children:"="}),e.jsx("option",{value:"contains",children:"contains"}),e.jsx("option",{value:"greater_than",children:">"}),e.jsx("option",{value:"less_than",children:"<"})]}),e.jsx("input",{type:"text",value:k.value,onChange:w=>I(B,{value:w.target.value}),placeholder:"Value",className:"w-24 p-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),e.jsx("button",{onClick:()=>H(B),className:"p-1 hover:bg-red-100 dark:hover:bg-red-900/30 rounded text-red-500",children:e.jsx(Nt,{className:"w-4 h-4"})})]},B)),y.filters.length===0&&e.jsx("p",{className:"text-sm text-gray-400",children:"No filters applied"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Sorting"}),e.jsx("button",{onClick:ae,className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:e.jsx(qt,{className:"w-4 h-4 text-gray-500"})})]}),e.jsx("div",{className:"space-y-2",children:y.sorting.map((k,B)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("select",{value:k.field,onChange:w=>{const oe=[...y.sorting];oe[B]={...k,field:w.target.value},v({...y,sorting:oe})},className:"flex-1 p-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:"Field..."}),o.map(w=>e.jsx("option",{value:w.field,children:w.name},w.field))]}),e.jsxs("select",{value:k.direction,onChange:w=>{const oe=[...y.sorting];oe[B]={...k,direction:w.target.value},v({...y,sorting:oe})},className:"w-20 p-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"ASC",children:"A-Z"}),e.jsx("option",{value:"DESC",children:"Z-A"})]}),e.jsx("button",{onClick:()=>{const w=[...y.sorting];w.splice(B,1),v({...y,sorting:w})},className:"p-1 hover:bg-red-100 dark:hover:bg-red-900/30 rounded text-red-500",children:e.jsx(Nt,{className:"w-4 h-4"})})]},B))})]})]}),e.jsxs("div",{className:"col-span-8 space-y-4",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-3",children:"Report Columns"}),y.columns.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx(IB,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"Click fields from the left panel to add columns"})]}):e.jsx("div",{className:"flex flex-wrap gap-2",children:y.columns.map((k,B)=>e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded-lg",children:[e.jsx(lk,{className:"w-4 h-4 text-gray-400 cursor-move"}),e.jsx("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:k.alias||k.name}),e.jsx("button",{onClick:()=>xe(B),className:"p-0.5 hover:bg-blue-200 dark:hover:bg-blue-800 rounded",children:e.jsx(Nt,{className:"w-3 h-3 text-blue-500"})})]},B))})]}),$&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Preview"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[U.length," rows"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:re,className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 rounded-lg hover:bg-green-200",children:[e.jsx(qo,{className:"w-4 h-4"}),"CSV"]}),e.jsxs("button",{onClick:V,className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400 rounded-lg hover:bg-red-200",children:[e.jsx(xs,{className:"w-4 h-4"}),"PDF"]})]})]}),e.jsx("div",{className:"overflow-x-auto max-h-96",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700 sticky top-0",children:e.jsx("tr",{children:y.columns.map((k,B)=>e.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-700 dark:text-gray-300",children:k.alias||k.name},B))})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:U.slice(0,50).map((k,B)=>e.jsx("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:y.columns.map((w,oe)=>{const ne=w.alias||w.field.split(".").pop();return e.jsx("td",{className:"px-4 py-2 text-gray-600 dark:text-gray-400",children:k[ne]??"-"},oe)})},B))})]})})]})]})]})]}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Report Builder"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Create custom reports with drag-and-drop"})]}),e.jsxs("button",{onClick:T,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(qt,{className:"w-5 h-5"}),"New Report"]})]}),e.jsx("div",{className:"flex gap-4 border-b border-gray-200 dark:border-gray-700",children:["reports","templates"].map(k=>e.jsx("button",{onClick:()=>g(k),className:`px-4 py-2 font-medium capitalize transition-colors ${A===k?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:k},k))}),A==="reports"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.length===0?e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx(Kt,{className:"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No Reports Yet"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Create your first custom report or use a template"}),e.jsx("button",{onClick:T,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Create Report"})]}):t.map(k=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4 hover:shadow-lg transition-shadow",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:e.jsx(Kt,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:k.name}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:k.data_source})]})]})}),k.description&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3 line-clamp-2",children:k.description}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400 mb-4",children:[e.jsxs("span",{children:[k.columns?.length||0," columns"]}),e.jsx("span",{children:""}),e.jsxs("span",{children:[k.filters?.length||0," filters"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>Q(k),className:"flex-1 flex items-center justify-center gap-1 px-3 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 text-sm",children:[e.jsx(Na,{className:"w-4 h-4"}),"Edit"]}),e.jsxs("button",{onClick:()=>{Q(k),setTimeout(O,100)},className:"flex-1 flex items-center justify-center gap-1 px-3 py-2 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 rounded-lg hover:bg-green-200 text-sm",children:[e.jsx(Qi,{className:"w-4 h-4"}),"Run"]}),e.jsx("button",{onClick:()=>C(k.id),className:"p-2 text-red-500 hover:bg-red-100 dark:hover:bg-red-900/30 rounded-lg",children:e.jsx(us,{className:"w-4 h-4"})})]})]},k.id))}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(k=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4 hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>E(k),children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/30 rounded-lg",children:e.jsx(Kt,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:k.name}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:k.data_source})]})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:k.description}),e.jsx("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:e.jsxs("span",{children:[k.columns?.length||0," columns"]})})]},k.id))})]})}const fm=`${ee}/video_conferencing.php`;function ET(){const[t,s]=h.useState("meetings"),[a,r]=h.useState([]),[l,c]=h.useState([]),[o,m]=h.useState([]),[u,x]=h.useState(!1),[A,g]=h.useState(!1),[N,f]=h.useState(!1),[y,v]=h.useState(null),[U,D]=h.useState(null),[M,K]=h.useState({title:"",description:"",class_id:"",subject_id:"",platform:"jitsi",start_time:"",duration_minutes:60,waiting_room:!0,record_meeting:!1}),[$,P]=h.useState([]),[se,z]=h.useState([]);h.useEffect(()=>{R(),j(),Q(),E(),te()},[]);const R=async()=>{try{x(!0);const I=await F.get(`${fm}?action=meetings`);r(I.data.meetings||[])}catch(I){console.error("Error fetching meetings:",I)}finally{x(!1)}},j=async()=>{try{const I=await F.get(`${fm}?action=classrooms`);c(I.data.classrooms||[])}catch(I){console.error("Error fetching classrooms:",I)}},T=async()=>{try{const I=await F.get(`${fm}?action=recordings`);m(I.data.recordings||[])}catch(I){console.error("Error fetching recordings:",I)}},Q=async()=>{try{const I=await F.get(`${fm}?action=analytics&period=30`);D(I.data)}catch(I){console.error("Error fetching analytics:",I)}},E=async()=>{try{const I=await F.get(`${ee}/classes.php`);P(I.data.classes||[])}catch(I){console.error("Error fetching classes:",I)}},te=async()=>{try{const I=await F.get(`${ee}/subjects.php`);z(I.data.subjects||[])}catch(I){console.error("Error fetching subjects:",I)}},C=async()=>{try{x(!0);const I=await F.post(`${fm}?action=create_meeting`,{...M,host_id:1,host_type:"teacher"});I.data.success&&(alert(`Meeting created!
URL: ${I.data.meeting_url}
Password: ${I.data.password}`),g(!1),R(),K({title:"",description:"",class_id:"",subject_id:"",platform:"jitsi",start_time:"",duration_minutes:60,waiting_room:!0,record_meeting:!1}))}catch{alert("Error creating meeting")}finally{x(!1)}},O=I=>{window.open(I.meeting_url,"_blank")},V=async I=>{if(confirm("Are you sure you want to end this meeting?"))try{await F.post(`${fm}?action=end_meeting`,{meeting_id:I}),R()}catch{alert("Error ending meeting")}},re=async I=>{if(confirm("Are you sure you want to cancel this meeting?"))try{await F.delete(`${fm}?action=meetings&id=${I}`),R()}catch{alert("Error cancelling meeting")}},ge=I=>{navigator.clipboard.writeText(I),alert("Meeting link copied to clipboard!")},xe=I=>{const H={scheduled:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",live:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 animate-pulse",ended:"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400",cancelled:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"};return H[I]||H.scheduled},Z=I=>{switch(I){case"zoom":return"";case"google_meet":return"";case"jitsi":return"";default:return""}};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Video Conferencing"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Manage virtual classes and meetings"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>f(!0),className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:e.jsx(Ka,{className:"w-5 h-5"})}),e.jsxs("button",{onClick:()=>g(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(qt,{className:"w-5 h-5"}),"New Meeting"]})]})]}),U&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-xl",children:e.jsx(al,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:U.summary?.total_meetings||0}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Meetings"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/30 rounded-xl",children:e.jsx(Mt,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:U.summary?.completed_meetings||0}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Completed"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/30 rounded-xl",children:e.jsx(Rt,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:U.participation?.unique_participants||0}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Participants"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-orange-100 dark:bg-orange-900/30 rounded-xl",children:e.jsx(Wt,{className:"w-6 h-6 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[Math.round(U.summary?.avg_duration||0)," min"]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Avg Duration"})]})]})})]}),e.jsx("div",{className:"flex gap-4 border-b border-gray-200 dark:border-gray-700",children:["meetings","classrooms","recordings"].map(I=>e.jsx("button",{onClick:()=>{s(I),I==="recordings"&&T()},className:`px-4 py-2 font-medium capitalize transition-colors ${t===I?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:I},I))}),t==="meetings"&&e.jsxs("div",{className:"space-y-4",children:[a.filter(I=>I.status==="live").length>0&&e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-xl p-4 border border-green-200 dark:border-green-800",children:[e.jsxs("h3",{className:"font-semibold text-green-700 dark:text-green-400 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Live Now"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.filter(I=>I.status==="live").map(I=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:I.title}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[I.class_name,"  ",I.host_name]})]}),e.jsx("span",{className:"text-2xl",children:Z(I.platform)})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsxs("button",{onClick:()=>O(I),className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[e.jsx(al,{className:"w-4 h-4"}),"Join"]}),e.jsx("button",{onClick:()=>V(I.id),className:"px-3 py-2 bg-red-100 text-red-600 dark:bg-red-900/30 dark:text-red-400 rounded-lg hover:bg-red-200",children:e.jsx(eB,{className:"w-4 h-4"})})]})]},I.id))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"All Meetings"}),e.jsx("button",{onClick:R,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:e.jsx(Ns,{className:`w-4 h-4 ${u?"animate-spin":""}`})})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Meeting"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Class"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Platform"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Date & Time"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:a.map(I=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:I.title}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:I.host_name})]})}),e.jsx("td",{className:"px-4 py-3 text-gray-600 dark:text-gray-400",children:I.class_name||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:"flex items-center gap-2",children:[Z(I.platform),e.jsx("span",{className:"text-sm capitalize",children:I.platform?.replace("_"," ")})]})}),e.jsx("td",{className:"px-4 py-3 text-gray-600 dark:text-gray-400",children:new Date(I.start_time).toLocaleString()}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${xe(I.status)}`,children:I.status})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[I.status==="scheduled"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>O(I),className:"p-1.5 text-green-600 hover:bg-green-100 dark:hover:bg-green-900/30 rounded",title:"Start Meeting",children:e.jsx(Qi,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ge(I.meeting_url),className:"p-1.5 text-blue-600 hover:bg-blue-100 dark:hover:bg-blue-900/30 rounded",title:"Copy Link",children:e.jsx(vl,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>re(I.id),className:"p-1.5 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/30 rounded",title:"Cancel",children:e.jsx(us,{className:"w-4 h-4"})})]}),I.status==="live"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>O(I),className:"p-1.5 text-green-600 hover:bg-green-100 dark:hover:bg-green-900/30 rounded",title:"Join",children:e.jsx(vh,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>V(I.id),className:"p-1.5 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/30 rounded",title:"End Meeting",children:e.jsx(db,{className:"w-4 h-4"})})]}),I.status==="ended"&&e.jsx("button",{onClick:()=>v(I),className:"p-1.5 text-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",title:"View Details",children:e.jsx(na,{className:"w-4 h-4"})})]})})]},I.id))})]}),a.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(al,{className:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No meetings found"})]})]})]})]}),t==="classrooms"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[l.map(I=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/30 rounded-xl",children:e.jsx(km,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${I.is_active?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400"}`,children:I.is_active?"Active":"Inactive"})]}),e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:I.name}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:[I.class_name,"  ",I.teacher_name]}),I.subject_name&&e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:I.subject_name}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[I.features?.whiteboard&&e.jsx("span",{className:"px-2 py-0.5 text-xs bg-gray-100 dark:bg-gray-700 rounded",children:"Whiteboard"}),I.features?.screen_share&&e.jsx("span",{className:"px-2 py-0.5 text-xs bg-gray-100 dark:bg-gray-700 rounded",children:"Screen Share"}),I.features?.chat&&e.jsx("span",{className:"px-2 py-0.5 text-xs bg-gray-100 dark:bg-gray-700 rounded",children:"Chat"})]}),e.jsxs("button",{onClick:()=>window.open(I.room_url,"_blank"),className:"w-full mt-4 flex items-center justify-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:[e.jsx(al,{className:"w-4 h-4"}),"Enter Classroom"]})]},I.id)),l.length===0&&e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx(km,{className:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No virtual classrooms created yet"})]})]}),t==="recordings"&&e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Recording"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Duration"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Size"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:o.map(I=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:I.meeting_title})}),e.jsx("td",{className:"px-4 py-3 text-gray-600 dark:text-gray-400 capitalize",children:I.recording_type}),e.jsxs("td",{className:"px-4 py-3 text-gray-600 dark:text-gray-400",children:[Math.floor(I.duration_seconds/60)," min"]}),e.jsx("td",{className:"px-4 py-3 text-gray-600 dark:text-gray-400",children:I.file_size?`${(I.file_size/1024/1024).toFixed(1)} MB`:"-"}),e.jsx("td",{className:"px-4 py-3 text-gray-600 dark:text-gray-400",children:new Date(I.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"p-1.5 text-blue-600 hover:bg-blue-100 dark:hover:bg-blue-900/30 rounded",children:e.jsx(Qi,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-1.5 text-green-600 hover:bg-green-100 dark:hover:bg-green-900/30 rounded",children:e.jsx(xs,{className:"w-4 h-4"})})]})})]},I.id))})]}),o.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(al,{className:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No recordings available"})]})]})}),A&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Create Meeting"})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Title *"}),e.jsx("input",{type:"text",value:M.title,onChange:I=>K({...M,title:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"e.g., Math Class - Chapter 5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{value:M.description,onChange:I=>K({...M,description:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",rows:2,placeholder:"Meeting description..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Class"}),e.jsxs("select",{value:M.class_id,onChange:I=>K({...M,class_id:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:"Select class..."}),$.map(I=>e.jsx("option",{value:I.id,children:I.class_name},I.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Subject"}),e.jsxs("select",{value:M.subject_id,onChange:I=>K({...M,subject_id:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:"Select subject..."}),se.map(I=>e.jsx("option",{value:I.id,children:I.subject_name},I.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Platform"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{id:"jitsi",name:"Jitsi (Free)",icon:""},{id:"zoom",name:"Zoom",icon:""},{id:"google_meet",name:"Google Meet",icon:""}].map(I=>e.jsxs("button",{onClick:()=>K({...M,platform:I.id}),className:`p-3 border rounded-lg text-center transition-colors ${M.platform===I.id?"border-blue-500 bg-blue-50 dark:bg-blue-900/30":"border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:[e.jsx("span",{className:"text-2xl",children:I.icon}),e.jsx("p",{className:"text-xs mt-1",children:I.name})]},I.id))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Start Time *"}),e.jsx("input",{type:"datetime-local",value:M.start_time,onChange:I=>K({...M,start_time:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Duration"}),e.jsxs("select",{value:M.duration_minutes,onChange:I=>K({...M,duration_minutes:parseInt(I.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:30,children:"30 minutes"}),e.jsx("option",{value:45,children:"45 minutes"}),e.jsx("option",{value:60,children:"1 hour"}),e.jsx("option",{value:90,children:"1.5 hours"}),e.jsx("option",{value:120,children:"2 hours"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:M.waiting_room,onChange:I=>K({...M,waiting_room:I.target.checked}),className:"w-4 h-4 text-blue-600 rounded"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Waiting Room"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:M.record_meeting,onChange:I=>K({...M,record_meeting:I.target.checked}),className:"w-4 h-4 text-blue-600 rounded"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Record Meeting"})]})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>g(!1),className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:"Cancel"}),e.jsx("button",{onClick:C,disabled:!M.title||!M.start_time||u,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:u?"Creating...":"Create Meeting"})]})]})})]})}const DT="https://eea.mcaforo.com/backend/api";function UT(){const{user:t}=Us(),[s,a]=h.useState(null),[r,l]=h.useState(!0),[c,o]=h.useState("all");h.useEffect(()=>{m()},[t?.id]);const m=async()=>{try{l(!0);const u=await F.get(`${DT}/dashboard.php?role=admin&user_id=${t?.id||""}`);u.data.success&&a(u.data)}catch(u){console.error("Error fetching dashboard:",u)}finally{l(!1)}};return r?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):s?e.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Welcome back! Here's what's happening at your school today."})]}),s.insights&&s.insights.length>0&&e.jsx(TT,{insights:s.insights,filter:c,setFilter:o}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx(Zp,{title:"Total Students",value:s.stats?.total_students||0,icon:e.jsx(Qs,{className:"text-blue-600",size:24}),trend:5.2,color:"blue"}),e.jsx(Zp,{title:"Total Teachers",value:s.stats?.total_teachers||0,icon:e.jsx(Rt,{className:"text-green-600",size:24}),trend:2.1,color:"green"}),e.jsx(Zp,{title:"Total Employees",value:s.stats?.total_employees||0,icon:e.jsx(Pr,{className:"text-purple-600",size:24}),trend:0,color:"purple"}),e.jsx(Zp,{title:"Active Classes",value:s.stats?.total_classes||0,icon:e.jsx(as,{className:"text-orange-600",size:24}),trend:0,color:"orange"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Financial Overview"}),e.jsx(vs,{className:"text-green-600",size:24})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(eA,{label:"Revenue This Month",value:s.financial?.revenue_this_month||0,icon:e.jsx($s,{className:"text-green-500",size:18})}),e.jsx(eA,{label:"Revenue This Year",value:s.financial?.revenue_this_year||0,icon:e.jsx(Fs,{className:"text-blue-500",size:18})}),e.jsx(eA,{label:"Outstanding Fees",value:s.financial?.outstanding_fees||0,icon:e.jsx(_s,{className:"text-orange-500",size:18}),isWarning:!0}),e.jsx(eA,{label:"Payroll This Month",value:s.financial?.payroll_this_month||0,icon:e.jsx(Xc,{className:"text-purple-500",size:18})}),e.jsx("div",{className:"pt-4 border-t",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Collection Rate"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${(s.financial?.collection_rate||0)>=80?"bg-green-500":(s.financial?.collection_rate||0)>=60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${s.financial?.collection_rate||0}%`}})}),e.jsxs("span",{className:"font-semibold",children:[s.financial?.collection_rate||0,"%"]})]})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"HR Overview"}),e.jsx(Pr,{className:"text-purple-600",size:24})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(tA,{label:"Present Today",value:s.hr?.present_today||0,icon:e.jsx(Or,{className:"text-green-500",size:20}),color:"green"}),e.jsx(tA,{label:"On Leave",value:s.hr?.on_leave_today||0,icon:e.jsx(Rh,{className:"text-orange-500",size:20}),color:"orange"}),e.jsx(tA,{label:"Pending Leaves",value:s.stats?.pending_leaves||0,icon:e.jsx(Wt,{className:"text-blue-500",size:20}),color:"blue"}),e.jsx(tA,{label:"Payroll Pending",value:s.hr?.pending_payroll||0,icon:e.jsx(mh,{className:"text-purple-500",size:20}),color:"purple"})]}),e.jsx("div",{className:"mt-6 pt-4 border-t",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total Payroll"}),e.jsxs("span",{className:"text-xl font-bold text-purple-600",children:["GHS ",parseFloat(s.hr?.total_payroll||0).toLocaleString()]})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Academic Performance"}),e.jsx(Is,{className:"text-yellow-600",size:24})]}),e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsxs("svg",{className:"w-32 h-32",children:[e.jsx("circle",{className:"text-gray-200",strokeWidth:"10",stroke:"currentColor",fill:"transparent",r:"56",cx:"64",cy:"64"}),e.jsx("circle",{className:`${(s.academic?.pass_rate||0)>=80?"text-green-500":(s.academic?.pass_rate||0)>=60?"text-yellow-500":"text-red-500"}`,strokeWidth:"10",strokeDasharray:`${(s.academic?.pass_rate||0)*3.52} 352`,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:"56",cx:"64",cy:"64",transform:"rotate(-90 64 64)"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("span",{className:"text-2xl font-bold",children:[s.academic?.pass_rate||0,"%"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Pass Rate"})]})})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:s.academic?.average_score||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"Avg Score"})]}),e.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:s.academic?.total_subjects||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"Subjects"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Attendance Trend"}),e.jsx(Ir,{className:"text-blue-600",size:24})]}),e.jsx("div",{className:"h-48",children:s.charts?.attendance&&e.jsx(QT,{data:s.charts.attendance})}),e.jsxs("div",{className:"flex justify-center gap-6 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Present"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Absent"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Revenue Trend"}),e.jsx($s,{className:"text-green-600",size:24})]}),e.jsx("div",{className:"h-64",children:s.charts?.revenue&&e.jsx(RT,{data:s.charts.revenue})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Students by Class"}),e.jsx(Gl,{className:"text-blue-600",size:24})]}),e.jsx("div",{className:"space-y-3",children:s.charts?.students_by_class?.slice(0,6).map((u,x)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-24 text-sm text-gray-600 truncate",children:u.class_name}),e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-4",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 h-4 rounded-full flex items-center justify-end pr-2",style:{width:`${Math.min(u.count/Math.max(...s.charts.students_by_class.map(A=>A.count))*100,100)}%`,minWidth:u.count>0?"30px":"0"},children:e.jsx("span",{className:"text-xs text-white font-medium",children:u.count})})})]},x))})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Recent Activities"}),e.jsx(nl,{className:"text-gray-600",size:24})]}),e.jsx("div",{className:"space-y-4",children:s.activities?.slice(0,5).map((u,x)=>e.jsxs("div",{className:"flex items-center gap-4 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:`p-2 rounded-full ${u.type==="payment"?"bg-green-100":"bg-blue-100"}`,children:u.type==="payment"?e.jsx(vs,{className:"text-green-600",size:18}):e.jsx(Rt,{className:"text-blue-600",size:18})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-gray-800",children:u.description}),e.jsx("p",{className:"text-sm text-gray-500",children:MT(u.date)})]})]},x))})]})]}):e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("p",{className:"text-gray-600",children:"Failed to load dashboard data"})})}function TT({insights:t,filter:s,setFilter:a}){const r=s==="all"?t:t.filter(c=>c.type===s),l=["all","warning","alert","info","success"];return e.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl shadow-lg p-6 mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(Jr,{className:"text-white",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"AI Insights"}),e.jsx("p",{className:"text-indigo-200 text-sm",children:"Intelligent recommendations for your school"})]})]}),e.jsx("div",{className:"flex gap-2",children:l.map(c=>e.jsx("button",{onClick:()=>a(c),className:`px-3 py-1 rounded-full text-sm capitalize transition-all ${s===c?"bg-white text-indigo-600":"bg-white/20 text-white hover:bg-white/30"}`,children:c},c))})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.slice(0,6).map((c,o)=>e.jsx(LT,{insight:c},o))})]})}function LT({insight:t}){const s={warning:{bg:"bg-yellow-50",border:"border-yellow-200",icon:_s,iconColor:"text-yellow-600"},alert:{bg:"bg-red-50",border:"border-red-200",icon:_s,iconColor:"text-red-600"},info:{bg:"bg-blue-50",border:"border-blue-200",icon:fc,iconColor:"text-blue-600"},success:{bg:"bg-green-50",border:"border-green-200",icon:Mt,iconColor:"text-green-600"}},a=s[t.type]||s.info,r=a.icon;return e.jsx("div",{className:`${a.bg} ${a.border} border rounded-lg p-4`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(r,{className:a.iconColor,size:20}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-200 rounded-full text-gray-600",children:t.category}),t.priority==="high"&&e.jsx("span",{className:"text-xs px-2 py-0.5 bg-red-200 rounded-full text-red-700",children:"High Priority"})]}),e.jsx("h4",{className:"font-semibold text-gray-800",children:t.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.message}),t.action&&e.jsxs("button",{className:"mt-2 text-sm text-indigo-600 hover:text-indigo-800 font-medium flex items-center gap-1",children:[t.action,e.jsx(Li,{size:14})]})]})]})})}function Zp({title:t,value:s,icon:a,trend:r,color:l}){const c={blue:"bg-blue-50 border-blue-100",green:"bg-green-50 border-green-100",purple:"bg-purple-50 border-purple-100",orange:"bg-orange-50 border-orange-100"};return e.jsxs("div",{className:`${c[l]} border rounded-xl p-6 transition-all hover:shadow-md`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-2 bg-white rounded-lg shadow-sm",children:a}),r!==0&&e.jsxs("div",{className:`flex items-center gap-1 text-sm ${r>0?"text-green-600":"text-red-600"}`,children:[r>0?e.jsx(Li,{size:16}):e.jsx(U1,{size:16}),Math.abs(r),"%"]})]}),e.jsx("p",{className:"text-3xl font-bold text-gray-800",children:s.toLocaleString()}),e.jsx("p",{className:"text-gray-600 mt-1",children:t})]})}function eA({label:t,value:s,icon:a,isWarning:r}){return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[a,e.jsx("span",{className:"text-gray-600",children:t})]}),e.jsxs("span",{className:`font-semibold ${r?"text-orange-600":"text-gray-800"}`,children:["GHS ",parseFloat(s).toLocaleString()]})]})}function tA({label:t,value:s,icon:a,color:r}){const l={green:"bg-green-50",orange:"bg-orange-50",blue:"bg-blue-50",purple:"bg-purple-50"};return e.jsxs("div",{className:`${l[r]} rounded-lg p-4 text-center`,children:[e.jsx("div",{className:"flex justify-center mb-2",children:a}),e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:s}),e.jsx("p",{className:"text-sm text-gray-600",children:t})]})}function QT({data:t}){const s=Math.max(...t.map(a=>a.present+a.absent),1);return e.jsx("div",{className:"flex items-end justify-between h-full gap-2",children:t.map((a,r)=>e.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1",children:[e.jsxs("div",{className:"w-full flex flex-col gap-1",style:{height:"140px"},children:[e.jsx("div",{className:"w-full bg-green-500 rounded-t",style:{height:`${a.present/s*100}%`}}),e.jsx("div",{className:"w-full bg-red-400 rounded-b",style:{height:`${a.absent/s*100}%`}})]}),e.jsx("span",{className:"text-xs text-gray-500",children:a.day})]},r))})}function RT({data:t}){const s=Math.max(...t.map(a=>a.amount),1);return e.jsx("div",{className:"flex items-end justify-between h-full gap-4",children:t.map((a,r)=>e.jsxs("div",{className:"flex-1 flex flex-col items-center gap-2",children:[e.jsx("div",{className:"w-full bg-gradient-to-t from-green-500 to-green-400 rounded-t transition-all hover:from-green-600 hover:to-green-500",style:{height:`${a.amount/s*200}px`,minHeight:a.amount>0?"20px":"0"}}),e.jsx("span",{className:"text-xs text-gray-500 text-center",children:a.month})]},r))})}function MT(t){const s=new Date(t),r=new Date-s,l=Math.floor(r/(1e3*60*60*24));return l===0?"Today":l===1?"Yesterday":l<7?`${l} days ago`:s.toLocaleDateString()}function IT(){const t=[{name:"Admin Dashboard",description:"Comprehensive school overview with all metrics",icon:$r,color:"bg-indigo-500",path:"/admin/comprehensive-dashboard",role:"Admin"},{name:"Principal Dashboard",description:"Academic focus, class performance, staff overview",icon:Qs,color:"bg-purple-500",path:"/principal/dashboard",role:"Principal"},{name:"HR Dashboard",description:"Employee management, attendance, leave, payroll",icon:Rt,color:"bg-pink-500",path:"/hr/dashboard",role:"HR"},{name:"Finance Dashboard",description:"Revenue, fees, expenses, debtors tracking",icon:vs,color:"bg-green-500",path:"/finance/dashboard",role:"Finance"},{name:"Teacher Dashboard",description:"Classes, schedule, grades, student management",icon:as,color:"bg-blue-500",path:"/teacher/dashboard",role:"Teacher"},{name:"Student Dashboard",description:"Grades, attendance, homework, fee status",icon:Or,color:"bg-teal-500",path:"/student/dashboard",role:"Student"},{name:"Parent Dashboard",description:"Children overview, performance, fee tracking",icon:Pr,color:"bg-orange-500",path:"/parent/dashboard",role:"Parent"}];return e.jsx("div",{className:"p-6 bg-gray-50 min-h-screen",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl p-8 mb-8 text-white",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Nm,{size:40}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Dashboard Selector"}),e.jsx("p",{className:"text-indigo-100 mt-1",children:"Preview all role-based dashboards with AI insights"})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map((s,a)=>{const r=s.icon;return e.jsxs(dn,{to:s.path,className:"bg-white rounded-xl shadow-sm hover:shadow-lg transition-all p-6 group",children:[e.jsx("div",{className:`${s.color} w-14 h-14 rounded-xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform`,children:e.jsx(r,{className:"text-white",size:28})}),e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:s.name}),e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:s.role})]}),e.jsx("p",{className:"text-gray-600",children:s.description}),e.jsxs("div",{className:"mt-4 flex items-center text-indigo-600 font-medium",children:["View Dashboard",e.jsx("svg",{className:"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]},a)})}),e.jsxs("div",{className:"mt-8 bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:" AI Insights Features"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-yellow-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-yellow-800",children:" Warnings"}),e.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"Alerts for issues needing attention"})]}),e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-blue-800",children:" Information"}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Updates and status notifications"})]}),e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-green-800",children:" Success"}),e.jsx("p",{className:"text-sm text-green-700 mt-1",children:"Positive achievements and milestones"})]})]})]})]})})}const $T="https://eea.mcaforo.com/backend/api";function HT(){const{user:t}=Us(),[s,a]=h.useState(null),[r,l]=h.useState(!0);h.useEffect(()=>{t?.id&&c()},[t?.id]);const c=async()=>{try{l(!0);const o=await F.get(`${$T}/dashboard.php?role=principal&user_id=${t.id}`);o.data.success&&a(o.data)}catch(o){console.error("Error fetching dashboard:",o)}finally{l(!1)}};return r?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):s?e.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[e.jsx("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl p-6 mb-8 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Principal Dashboard"}),e.jsx("p",{className:"text-indigo-100 mt-1",children:"School Performance Overview"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-indigo-100",children:"Today"}),e.jsx("p",{className:"text-xl font-semibold",children:new Date().toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})})]})]})}),s.insights?.length>0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(Jr,{className:"text-purple-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"AI Insights"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Strategic recommendations for school improvement"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.insights.map((o,m)=>e.jsx(PT,{insight:o},m))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-8",children:[e.jsx(Wx,{title:"Total Students",value:s.school_overview?.total_students||0,icon:e.jsx(Qs,{className:"text-blue-600",size:24}),color:"blue"}),e.jsx(Wx,{title:"Total Staff",value:s.school_overview?.total_staff||0,icon:e.jsx(Pr,{className:"text-green-600",size:24}),color:"green"}),e.jsx(Wx,{title:"Teachers",value:s.school_overview?.total_teachers||0,icon:e.jsx(Rt,{className:"text-purple-600",size:24}),color:"purple"}),e.jsx(Wx,{title:"Classes",value:s.school_overview?.total_classes||0,icon:e.jsx(mn,{className:"text-orange-600",size:24}),color:"orange"}),e.jsx(Wx,{title:"Attendance",value:`${s.school_overview?.attendance_rate||0}%`,icon:e.jsx(Or,{className:"text-teal-600",size:24}),color:"teal"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Academic Performance"}),e.jsx(Is,{className:"text-yellow-600",size:24})]}),e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsxs("svg",{className:"w-32 h-32",children:[e.jsx("circle",{className:"text-gray-200",strokeWidth:"10",stroke:"currentColor",fill:"transparent",r:"56",cx:"64",cy:"64"}),e.jsx("circle",{className:OT(s.academic?.pass_rate||0),strokeWidth:"10",strokeDasharray:`${(s.academic?.pass_rate||0)*3.52} 352`,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:"56",cx:"64",cy:"64",transform:"rotate(-90 64 64)"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("span",{className:"text-2xl font-bold",children:[s.academic?.pass_rate||0,"%"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Pass Rate"})]})})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("p",{className:"text-xl font-bold text-blue-600",children:s.academic?.average_score||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"Avg Score"})]}),e.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[e.jsx("p",{className:"text-xl font-bold text-purple-600",children:s.school_overview?.total_subjects||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"Subjects"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Staff Summary"}),e.jsx(Pr,{className:"text-green-600",size:24})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:s.staff?.present_today||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"Present Today"})]}),e.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:s.staff?.on_leave||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"On Leave"})]})]}),e.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:"By Department"}),e.jsx("div",{className:"space-y-2",children:s.staff?.by_department?.slice(0,4).map((o,m)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsx("span",{className:"text-gray-700",children:o.department_name}),e.jsx("span",{className:"font-semibold text-gray-800",children:o.count})]},m))})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Class Performance"}),e.jsx(Fs,{className:"text-blue-600",size:24})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-3 px-4 text-gray-600",children:"Class"}),e.jsx("th",{className:"text-center py-3 px-4 text-gray-600",children:"Students"}),e.jsx("th",{className:"text-center py-3 px-4 text-gray-600",children:"Avg Score"}),e.jsx("th",{className:"text-center py-3 px-4 text-gray-600",children:"Pass Rate"}),e.jsx("th",{className:"text-center py-3 px-4 text-gray-600",children:"Status"})]})}),e.jsx("tbody",{children:s.class_performance?.map((o,m)=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4 font-medium",children:o.class_name}),e.jsx("td",{className:"py-3 px-4 text-center",children:o.student_count}),e.jsxs("td",{className:"py-3 px-4 text-center",children:[o.avg_score||0,"%"]}),e.jsxs("td",{className:"py-3 px-4 text-center",children:[o.pass_rate||0,"%"]}),e.jsx("td",{className:"py-3 px-4 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${(o.pass_rate||0)>=70?"bg-green-100 text-green-700":(o.pass_rate||0)>=50?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:(o.pass_rate||0)>=70?"Good":(o.pass_rate||0)>=50?"Average":"Needs Attention"})})]},m))})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Teacher Overview"}),e.jsx(Rt,{className:"text-purple-600",size:24})]}),e.jsx("div",{className:"space-y-3",children:s.teacher_performance?.slice(0,5).map((o,m)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:o.teacher_name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[o.subjects_taught," subjects"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-semibold text-purple-600",children:o.classes_assigned}),e.jsx("p",{className:"text-xs text-gray-500",children:"classes"})]})]},m))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Recent Events"}),e.jsx(Ir,{className:"text-blue-600",size:24})]}),e.jsx("div",{className:"space-y-3",children:s.recent_events?.map((o,m)=>e.jsxs("div",{className:"flex items-center gap-4 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:`p-2 rounded-full ${o.type==="admission"?"bg-blue-100":"bg-green-100"}`,children:o.type==="admission"?e.jsx(Qs,{className:"text-blue-600",size:18}):e.jsx(Pr,{className:"text-green-600",size:18})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-gray-800",children:o.description}),e.jsx("p",{className:"text-sm text-gray-500",children:zT(o.date)})]})]},m))})]})]})]}):e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("p",{className:"text-gray-600",children:"Failed to load dashboard"})})}function Wx({title:t,value:s,icon:a,color:r}){const l={blue:"bg-blue-50",green:"bg-green-50",purple:"bg-purple-50",orange:"bg-orange-50",teal:"bg-teal-50"};return e.jsxs("div",{className:`${l[r]} rounded-xl p-4`,children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:a}),e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:s}),e.jsx("p",{className:"text-sm text-gray-600",children:t})]})}function PT({insight:t}){const s={warning:{bg:"bg-yellow-50",border:"border-yellow-200",icon:_s,iconColor:"text-yellow-600"},info:{bg:"bg-blue-50",border:"border-blue-200",icon:fc,iconColor:"text-blue-600"},success:{bg:"bg-green-50",border:"border-green-200",icon:Mt,iconColor:"text-green-600"}},a=s[t.type]||s.info,r=a.icon;return e.jsx("div",{className:`${a.bg} ${a.border} border rounded-lg p-4`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(r,{className:a.iconColor,size:20}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-800",children:t.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.message}),t.action&&e.jsxs("button",{className:"mt-2 text-sm text-indigo-600 hover:text-indigo-800 font-medium flex items-center gap-1",children:[t.action,e.jsx(Li,{size:14})]})]})]})})}function OT(t){return t>=70?"text-green-500":t>=50?"text-yellow-500":"text-red-500"}function zT(t){const s=new Date(t),r=new Date-s,l=Math.floor(r/(1e3*60*60*24));return l===0?"Today":l===1?"Yesterday":l<7?`${l} days ago`:s.toLocaleDateString()}const GT="https://eea.mcaforo.com/backend/api";function qT(){const{user:t}=Us(),[s,a]=h.useState(null),[r,l]=h.useState(!0);h.useEffect(()=>{t?.id&&c()},[t?.id]);const c=async()=>{try{l(!0);const m=await F.get(`${GT}/dashboard.php?role=hr&user_id=${t.id}`);m.data.success&&a(m.data)}catch(m){console.error("Error fetching dashboard:",m)}finally{l(!1)}};if(r)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})});if(!s)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("p",{className:"text-gray-600",children:"Failed to load dashboard"})});const o=s.attendance?.today?.total>0?Math.round(s.attendance.today.present/s.attendance.today.total*100):0;return e.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-xl p-6 mb-8 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"HR Dashboard"}),e.jsx("p",{className:"text-purple-100 mt-1",children:"Human Resources Management"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-purple-100",children:"Today's Date"}),e.jsx("p",{className:"text-xl font-semibold",children:new Date().toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})})]})]})}),s.insights?.length>0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(Jr,{className:"text-purple-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"AI Insights"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"HR recommendations and alerts"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.insights.map((m,u)=>e.jsx(KT,{insight:m},u))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-8",children:[e.jsx(Xx,{title:"Total Employees",value:s.employees?.total||0,icon:e.jsx(Rt,{className:"text-blue-600",size:24}),color:"blue"}),e.jsx(Xx,{title:"Teachers",value:s.employees?.teachers||0,icon:e.jsx(Pr,{className:"text-green-600",size:24}),color:"green"}),e.jsx(Xx,{title:"Present Today",value:s.attendance?.today?.present||0,icon:e.jsx(Or,{className:"text-teal-600",size:24}),color:"teal"}),e.jsx(Xx,{title:"On Leave",value:s.leave?.on_leave_today||0,icon:e.jsx(Rh,{className:"text-orange-600",size:24}),color:"orange"}),e.jsx(Xx,{title:"Pending Leaves",value:s.leave?.pending||0,icon:e.jsx(Wt,{className:"text-red-600",size:24}),color:"red"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Today's Attendance"}),e.jsx(Or,{className:"text-green-600",size:24})]}),e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsxs("svg",{className:"w-32 h-32",children:[e.jsx("circle",{className:"text-gray-200",strokeWidth:"10",stroke:"currentColor",fill:"transparent",r:"56",cx:"64",cy:"64"}),e.jsx("circle",{className:o>=90?"text-green-500":o>=75?"text-yellow-500":"text-red-500",strokeWidth:"10",strokeDasharray:`${o*3.52} 352`,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:"56",cx:"64",cy:"64",transform:"rotate(-90 64 64)"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("span",{className:"text-2xl font-bold",children:[o,"%"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Present"})]})})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("p",{className:"text-xl font-bold text-green-600",children:s.attendance?.today?.present||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"Present"})]}),e.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[e.jsx("p",{className:"text-xl font-bold text-red-600",children:s.attendance?.today?.absent||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"Absent"})]}),e.jsxs("div",{className:"text-center p-3 bg-yellow-50 rounded-lg",children:[e.jsx("p",{className:"text-xl font-bold text-yellow-600",children:s.attendance?.today?.late||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"Late"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Leave Management"}),e.jsx(Ot,{className:"text-blue-600",size:24})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-red-600",children:s.leave?.pending||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"Pending Approval"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:s.leave?.approved_this_month||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"Approved This Month"})]})]}),e.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:"Recent Applications"}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:s.leave?.recent?.slice(0,4).map((m,u)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800 text-sm",children:m.employee_name}),e.jsx("p",{className:"text-xs text-gray-500",children:m.leave_type})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${m.status==="approved"?"bg-green-100 text-green-700":m.status==="pending"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:m.status})]},u))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Payroll Summary"}),e.jsx(vs,{className:"text-green-600",size:24})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 rounded-lg",children:[e.jsx("span",{className:"text-gray-600",children:"Total Employees"}),e.jsx("span",{className:"font-semibold text-blue-600",children:s.payroll?.current_month?.employee_count||0})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50 rounded-lg",children:[e.jsx("span",{className:"text-gray-600",children:"Total Net Salary"}),e.jsxs("span",{className:"font-semibold text-green-600",children:["GHS ",parseFloat(s.payroll?.current_month?.total_net||0).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-purple-50 rounded-lg",children:[e.jsx("span",{className:"text-gray-600",children:"Total Earnings"}),e.jsxs("span",{className:"font-semibold text-purple-600",children:["GHS ",parseFloat(s.payroll?.current_month?.total_earnings||0).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-orange-50 rounded-lg",children:[e.jsx("span",{className:"text-gray-600",children:"Total Deductions"}),e.jsxs("span",{className:"font-semibold text-orange-600",children:["GHS ",parseFloat(s.payroll?.current_month?.total_deductions||0).toLocaleString()]})]}),s.payroll?.pending_payment?.count>0&&e.jsxs("div",{className:"flex items-center justify-between p-4 bg-red-50 rounded-lg",children:[e.jsx("span",{className:"text-gray-600",children:"Pending Payment"}),e.jsxs("span",{className:"font-semibold text-red-600",children:[s.payroll.pending_payment.count," employees"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Department Overview"}),e.jsx(mn,{className:"text-purple-600",size:24})]}),e.jsx("div",{className:"space-y-3",children:s.departments?.map((m,u)=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-gray-800",children:m.department_name}),e.jsxs("span",{className:"text-purple-600 font-semibold",children:[m.employee_count," staff"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Total Salary"}),e.jsxs("span",{className:"text-gray-700",children:["GHS ",parseFloat(m.total_salary||0).toLocaleString()]})]})]},u))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Attendance Trend (7 Days)"}),e.jsx(Fs,{className:"text-blue-600",size:24})]}),e.jsx("div",{className:"h-48",children:s.charts?.attendance&&e.jsx(VT,{data:s.charts.attendance})}),e.jsxs("div",{className:"flex justify-center gap-6 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Present"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Absent"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Recent Activities"}),e.jsx(Ir,{className:"text-green-600",size:24})]}),e.jsx("div",{className:"space-y-3",children:s.activities?.slice(0,6).map((m,u)=>e.jsxs("div",{className:"flex items-center gap-4 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:`p-2 rounded-full ${m.type==="leave"?"bg-blue-100":"bg-green-100"}`,children:m.type==="leave"?e.jsx(Ot,{className:"text-blue-600",size:18}):e.jsx(vs,{className:"text-green-600",size:18})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-gray-800 text-sm",children:m.description}),e.jsx("p",{className:"text-xs text-gray-500",children:YT(m.date)})]}),m.status&&e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${m.status==="approved"||m.status==="paid"?"bg-green-100 text-green-700":m.status==="pending"||m.status==="processed"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:m.status})]},u))})]})]})]})}function Xx({title:t,value:s,icon:a,color:r}){const l={blue:"bg-blue-50",green:"bg-green-50",teal:"bg-teal-50",orange:"bg-orange-50",red:"bg-red-50"};return e.jsxs("div",{className:`${l[r]} rounded-xl p-4`,children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:a}),e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:s}),e.jsx("p",{className:"text-sm text-gray-600",children:t})]})}function KT({insight:t}){const s={warning:{bg:"bg-yellow-50",border:"border-yellow-200",icon:_s,iconColor:"text-yellow-600"},info:{bg:"bg-blue-50",border:"border-blue-200",icon:fc,iconColor:"text-blue-600"},success:{bg:"bg-green-50",border:"border-green-200",icon:Mt,iconColor:"text-green-600"}},a=s[t.type]||s.info,r=a.icon;return e.jsx("div",{className:`${a.bg} ${a.border} border rounded-lg p-4`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(r,{className:a.iconColor,size:20}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-800",children:t.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.message}),t.action&&e.jsxs("button",{className:"mt-2 text-sm text-purple-600 hover:text-purple-800 font-medium flex items-center gap-1",children:[t.action,e.jsx(Li,{size:14})]})]})]})})}function VT({data:t}){const s=Math.max(...t.map(a=>a.present+a.absent),1);return e.jsx("div",{className:"flex items-end justify-between h-full gap-2",children:t.map((a,r)=>e.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1",children:[e.jsxs("div",{className:"w-full flex flex-col gap-1",style:{height:"140px"},children:[e.jsx("div",{className:"w-full bg-green-500 rounded-t",style:{height:`${a.present/s*100}%`}}),e.jsx("div",{className:"w-full bg-red-400 rounded-b",style:{height:`${a.absent/s*100}%`}})]}),e.jsx("span",{className:"text-xs text-gray-500",children:a.day})]},r))})}function YT(t){const s=new Date(t),r=new Date-s,l=Math.floor(r/(1e3*60*60*24));return l===0?"Today":l===1?"Yesterday":l<7?`${l} days ago`:s.toLocaleDateString()}const WT="https://eea.mcaforo.com/backend/api";function XT(){const{user:t}=Us(),[s,a]=h.useState(null),[r,l]=h.useState(!0);h.useEffect(()=>{t?.id&&c()},[t?.id]);const c=async()=>{try{l(!0);const m=await F.get(`${WT}/dashboard.php?role=finance&user_id=${t.id}`);m.data.success&&a(m.data)}catch(m){console.error("Error fetching dashboard:",m)}finally{l(!1)}};if(r)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})});if(!s)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("p",{className:"text-gray-600",children:"Failed to load dashboard"})});const o=s.revenue?.growth_rate||0;return e.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-600 to-teal-600 rounded-xl p-6 mb-8 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Finance Dashboard"}),e.jsx("p",{className:"text-green-100 mt-1",children:"Financial Management & Analytics"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-green-100",children:"This Month's Revenue"}),e.jsxs("p",{className:"text-2xl font-bold",children:["GHS ",parseFloat(s.revenue?.this_month?.total||0).toLocaleString()]}),e.jsxs("div",{className:`flex items-center justify-end gap-1 text-sm ${o>=0?"text-green-200":"text-red-200"}`,children:[o>=0?e.jsx($s,{size:16}):e.jsx(gc,{size:16}),Math.abs(o),"% vs last month"]})]})]})}),s.insights?.length>0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Jr,{className:"text-green-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"AI Insights"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Financial recommendations and alerts"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.insights.map((m,u)=>e.jsx(JT,{insight:m},u))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[e.jsx(sA,{title:"This Month",value:`GHS ${parseFloat(s.revenue?.this_month?.total||0).toLocaleString()}`,icon:e.jsx(vs,{className:"text-green-600",size:24}),color:"green",subtitle:`${s.revenue?.this_month?.count||0} payments`}),e.jsx(sA,{title:"This Year",value:`GHS ${parseFloat(s.revenue?.this_year?.total||0).toLocaleString()}`,icon:e.jsx($s,{className:"text-blue-600",size:24}),color:"blue",subtitle:`${s.revenue?.this_year?.count||0} payments`}),e.jsx(sA,{title:"Outstanding",value:`GHS ${parseFloat(s.fees?.outstanding||0).toLocaleString()}`,icon:e.jsx(_s,{className:"text-orange-600",size:24}),color:"orange",subtitle:`${s.outstanding?.summary?.count||0} invoices`}),e.jsx(sA,{title:"Collection Rate",value:`${s.fees?.collection_rate||0}%`,icon:e.jsx(Gl,{className:"text-purple-600",size:24}),color:"purple",subtitle:s.fees?.collection_rate>=85?"On Target":"Below Target"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Fee Collection"}),e.jsx(mh,{className:"text-green-600",size:24})]}),e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsxs("svg",{className:"w-40 h-40",children:[e.jsx("circle",{className:"text-gray-200",strokeWidth:"12",stroke:"currentColor",fill:"transparent",r:"64",cx:"80",cy:"80"}),e.jsx("circle",{className:s.fees?.collection_rate>=85?"text-green-500":s.fees?.collection_rate>=70?"text-yellow-500":"text-red-500",strokeWidth:"12",strokeDasharray:`${(s.fees?.collection_rate||0)*4.02} 402`,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:"64",cx:"80",cy:"80",transform:"rotate(-90 80 80)"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("span",{className:"text-3xl font-bold",children:[s.fees?.collection_rate||0,"%"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Collected"})]})})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-gray-600",children:"Total Invoiced"}),e.jsxs("span",{className:"font-semibold text-gray-800",children:["GHS ",parseFloat(s.fees?.total_invoiced||0).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[e.jsx("span",{className:"text-gray-600",children:"Total Collected"}),e.jsxs("span",{className:"font-semibold text-green-600",children:["GHS ",parseFloat(s.fees?.total_collected||0).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:[e.jsx("span",{className:"text-gray-600",children:"Outstanding"}),e.jsxs("span",{className:"font-semibold text-red-600",children:["GHS ",parseFloat(s.fees?.outstanding||0).toLocaleString()]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Payroll Expenses"}),e.jsx(Xc,{className:"text-purple-600",size:24})]}),e.jsxs("div",{className:"text-center p-6 bg-purple-50 rounded-xl mb-6",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Total Payroll This Month"}),e.jsxs("p",{className:"text-3xl font-bold text-purple-600",children:["GHS ",parseFloat(s.expenses?.payroll||0).toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsxs("p",{className:"text-lg font-bold text-green-600",children:["GHS ",parseFloat(s.expenses?.payment_status?.paid||0).toLocaleString()]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Paid"})]}),e.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[e.jsxs("p",{className:"text-lg font-bold text-orange-600",children:["GHS ",parseFloat(s.expenses?.payment_status?.pending||0).toLocaleString()]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Pending"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Total Earnings"}),e.jsxs("span",{className:"text-gray-800",children:["GHS ",parseFloat(s.expenses?.breakdown?.earnings||0).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Total Deductions"}),e.jsxs("span",{className:"text-gray-800",children:["GHS ",parseFloat(s.expenses?.breakdown?.deductions||0).toLocaleString()]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Outstanding by Age"}),e.jsx(Ot,{className:"text-orange-600",size:24})]}),e.jsxs("div",{className:"space-y-3",children:[s.outstanding?.by_age?.map((m,u)=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`font-medium ${m.age_bracket==="90+ days"?"text-red-600":m.age_bracket==="61-90 days"?"text-orange-600":"text-gray-800"}`,children:m.age_bracket}),e.jsxs("span",{className:"font-semibold text-gray-800",children:["GHS ",parseFloat(m.total||0).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("span",{children:[m.count," invoices"]}),e.jsxs("span",{children:[s.outstanding?.summary?.total>0?Math.round(m.total/s.outstanding.summary.total*100):0,"%"]})]})]},u)),(!s.outstanding?.by_age||s.outstanding.by_age.length===0)&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Mt,{className:"mx-auto text-green-400 mb-2",size:48}),e.jsx("p",{children:"No outstanding payments!"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Top Debtors"}),e.jsx(Rt,{className:"text-red-600",size:24})]}),e.jsxs("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:[s.debtors?.map((m,u)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:m.student_name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[m.class_name||"N/A","  ",m.admission_number]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"font-semibold text-red-600",children:["GHS ",parseFloat(m.total_owed||0).toLocaleString()]})})]},u)),(!s.debtors||s.debtors.length===0)&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Mt,{className:"mx-auto text-green-400 mb-2",size:48}),e.jsx("p",{children:"No debtors!"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Revenue Trend (12 Months)"}),e.jsx(Fs,{className:"text-green-600",size:24})]}),e.jsx("div",{className:"h-64",children:s.charts?.revenue&&e.jsx(ZT,{data:s.charts.revenue})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Recent Transactions"}),e.jsx(Ir,{className:"text-blue-600",size:24})]}),e.jsxs("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:[s.transactions?.map((m,u)=>e.jsxs("div",{className:"flex items-center gap-4 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-full",children:e.jsx(vs,{className:"text-green-600",size:18})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-800",children:m.student_name||"Unknown"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[m.payment_method||"N/A","  ",m.reference_number||"N/A"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-semibold text-green-600",children:["GHS ",parseFloat(m.amount||0).toLocaleString()]}),e.jsx("p",{className:"text-xs text-gray-500",children:eL(m.payment_date)})]})]},u)),(!s.transactions||s.transactions.length===0)&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Kt,{className:"mx-auto text-gray-400 mb-2",size:48}),e.jsx("p",{children:"No recent transactions"})]})]})]})]})]})}function sA({title:t,value:s,icon:a,color:r,subtitle:l}){const c={green:"bg-green-50",blue:"bg-blue-50",orange:"bg-orange-50",purple:"bg-purple-50"};return e.jsxs("div",{className:`${c[r]} rounded-xl p-4`,children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:a}),e.jsx("p",{className:"text-xl font-bold text-gray-800",children:s}),e.jsx("p",{className:"text-sm text-gray-600",children:t}),l&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:l})]})}function JT({insight:t}){const s={warning:{bg:"bg-yellow-50",border:"border-yellow-200",icon:_s,iconColor:"text-yellow-600"},alert:{bg:"bg-red-50",border:"border-red-200",icon:_s,iconColor:"text-red-600"},info:{bg:"bg-blue-50",border:"border-blue-200",icon:fc,iconColor:"text-blue-600"},success:{bg:"bg-green-50",border:"border-green-200",icon:Mt,iconColor:"text-green-600"}},a=s[t.type]||s.info,r=a.icon;return e.jsx("div",{className:`${a.bg} ${a.border} border rounded-lg p-4`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(r,{className:a.iconColor,size:20}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-800",children:t.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.message}),t.action&&e.jsxs("button",{className:"mt-2 text-sm text-green-600 hover:text-green-800 font-medium flex items-center gap-1",children:[t.action,e.jsx(Li,{size:14})]})]})]})})}function ZT({data:t}){const s=Math.max(...t.map(a=>a.amount),1);return e.jsx("div",{className:"flex items-end justify-between h-full gap-1",children:t.map((a,r)=>e.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1",children:[e.jsx("div",{className:"w-full bg-gradient-to-t from-green-500 to-green-400 rounded-t transition-all hover:from-green-600 hover:to-green-500",style:{height:`${a.amount/s*200}px`,minHeight:a.amount>0?"4px":"0"}}),e.jsx("span",{className:"text-xs text-gray-500",children:a.month})]},r))})}function eL(t){if(!t)return"N/A";const s=new Date(t),r=new Date-s,l=Math.floor(r/(1e3*60*60*24));return l===0?"Today":l===1?"Yesterday":l<7?`${l} days ago`:s.toLocaleDateString()}function tL(){const t=la(),{user:s}=Us(),[a,r]=h.useState(!0),[l,c]=h.useState(!1),[o,m]=h.useState(null),[u,x]=h.useState(null);h.useEffect(()=>{A()},[]);const A=async()=>{try{r(!0);const T=await F.get(`${ee}/teacher_dashboard.php?user_id=${s?.id}`);if(T.data.success)m(T.data),x(T.data.weekly_stats);else{const Q=await F.get(`${ee}/dashboard.php?role=teacher&user_id=${s?.id}`);Q.data.success&&m({...Q.data,classes:Q.data.my_classes||[],total_students:Q.data.my_classes?.reduce((E,te)=>E+(parseInt(te.student_count)||0),0)||0,attendance_status:[],student_alerts:[],class_performance:[],upcoming_events:[],recent_messages:[],weekly_stats:null})}}catch(T){console.error("Error fetching dashboard data:",T),m(null)}finally{r(!1)}},g=async()=>{c(!0),await A(),c(!1)},N=o?.teacher,f=o?.classes||o?.my_classes||[],y=o?.total_students||f.reduce((T,Q)=>T+(parseInt(Q.student_count)||0),0),v=o?.todays_schedule||[],U=o?.attendance_status||[],D=o?.class_performance||[],M=o?.student_alerts||[],K=o?.upcoming_events||[],$=o?.recent_messages||[],P=o?.pending_homework||0,se=o?.homework_to_review||0,z=o?.pending_grades||0,R=U.filter(T=>T.marked).length,j=f.length;return a?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(hs,{className:"w-12 h-12 text-blue-600 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading dashboard..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-800 rounded-xl p-6 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold mb-2",children:["Welcome Back, ",N?`${N.first_name} ${N.last_name}`:s?.name||"Teacher","!"]}),e.jsx("p",{className:"text-blue-100",children:new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsx("button",{onClick:g,disabled:l,className:"p-3 bg-white/20 rounded-lg hover:bg-white/30 transition-colors",children:e.jsx(Ns,{className:`w-5 h-5 ${l?"animate-spin":""}`})})]})}),M.length>0&&e.jsx("div",{className:"space-y-3",children:M.slice(0,2).map((T,Q)=>e.jsxs("div",{className:`p-4 rounded-lg border ${T.severity==="high"?"bg-red-50 border-red-200":"bg-yellow-50 border-yellow-200"} flex items-start gap-3`,children:[T.severity==="high"?e.jsx(ka,{className:"w-5 h-5 text-red-500"}):e.jsx(_s,{className:"w-5 h-5 text-yellow-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:T.student_name}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[T.issue," - ",T.class_name]})]}),e.jsxs("button",{onClick:()=>t("/teacher/student-progress"),className:"text-sm font-medium text-blue-600 hover:text-blue-700 flex items-center gap-1",children:["View ",e.jsx(Pl,{className:"w-4 h-4"})]})]},Q))}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("button",{onClick:()=>t("/teacher/classes"),className:"card p-6 hover:shadow-lg transition-shadow text-left",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm mb-1",children:"My Classes"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:f.length})]}),e.jsx("div",{className:"bg-blue-500 w-12 h-12 rounded-lg flex items-center justify-center",children:e.jsx(as,{className:"w-6 h-6 text-white"})})]})}),e.jsx("button",{onClick:()=>t("/teacher/students?all=true"),className:"card p-6 hover:shadow-lg transition-shadow text-left",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm mb-1",children:"Total Students"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:y})]}),e.jsx("div",{className:"bg-green-500 w-12 h-12 rounded-lg flex items-center justify-center",children:e.jsx(Rt,{className:"w-6 h-6 text-white"})})]})}),e.jsx("button",{onClick:()=>t("/teacher/homework"),className:"card p-6 hover:shadow-lg transition-shadow text-left",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm mb-1",children:"Homework to Review"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:se}),P>0&&e.jsxs("p",{className:"text-xs text-orange-600 mt-1",children:[P," active assignments"]})]}),e.jsx("div",{className:"bg-orange-500 w-12 h-12 rounded-lg flex items-center justify-center",children:e.jsx(Kt,{className:"w-6 h-6 text-white"})})]})}),e.jsx("button",{onClick:()=>t("/teacher/grading"),className:"card p-6 hover:shadow-lg transition-shadow text-left",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm mb-1",children:"Grades to Enter"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:z})]}),e.jsx("div",{className:"bg-purple-500 w-12 h-12 rounded-lg flex items-center justify-center",children:e.jsx(Is,{className:"w-6 h-6 text-white"})})]})})]}),u&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(Ir,{className:"w-5 h-5 text-blue-600"}),"This Week's Activity"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-teal-50 rounded-lg p-4 text-center",children:[e.jsx(Wc,{className:"w-6 h-6 text-teal-600 mx-auto mb-2"}),e.jsx("p",{className:"text-2xl font-bold text-teal-700",children:u.attendance_marked||0}),e.jsx("p",{className:"text-xs text-gray-600",children:"Attendance Records"})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[e.jsx(Kt,{className:"w-6 h-6 text-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"text-2xl font-bold text-blue-700",children:u.homework_assigned||0}),e.jsx("p",{className:"text-xs text-gray-600",children:"Homework Assigned"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 text-center",children:[e.jsx(Is,{className:"w-6 h-6 text-purple-600 mx-auto mb-2"}),e.jsx("p",{className:"text-2xl font-bold text-purple-700",children:u.grades_entered||0}),e.jsx("p",{className:"text-xs text-gray-600",children:"Grades Entered"})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[e.jsx(wa,{className:"w-6 h-6 text-green-600 mx-auto mb-2"}),e.jsx("p",{className:"text-2xl font-bold text-green-700",children:u.messages_sent||0}),e.jsx("p",{className:"text-xs text-gray-600",children:"Messages Sent"})]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-teal-100 rounded-lg flex items-center justify-center",children:e.jsx(Wc,{className:"w-5 h-5 text-teal-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Today's Attendance"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[R," of ",j," classes marked"]})]})]}),e.jsx("button",{onClick:()=>t("/teacher/attendance"),className:"btn btn-primary btn-sm",children:"Mark Attendance"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 mb-4",children:e.jsx("div",{className:`h-3 rounded-full transition-all duration-500 ${R===j&&j>0?"bg-green-500":"bg-teal-500"}`,style:{width:`${j>0?R/j*100:0}%`}})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:(U.length>0?U:f).slice(0,4).map(T=>{const Q=T.marked!==void 0?T:{marked:!1,present:0,absent:0},E=T.class_name||f.find(te=>te.id===T.class_id)?.class_name||"Class";return e.jsxs("div",{className:`p-3 rounded-lg border ${Q.marked?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200"}`,children:[e.jsx("p",{className:"font-medium text-sm text-gray-900",children:E}),Q.marked?e.jsxs("p",{className:"text-xs text-green-600 flex items-center gap-1 mt-1",children:[e.jsx(Mt,{className:"w-3 h-3"})," ",Q.present,"P / ",Q.absent,"A"]}):e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Not marked"})]},T.class_id||T.id)})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 card",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(Ot,{className:"w-5 h-5 text-blue-600"}),"Today's Schedule"]}),e.jsxs("span",{className:"text-sm text-gray-500",children:[v.length," class",v.length!==1?"es":""]})]})}),e.jsx("div",{className:"p-6 space-y-4",children:v.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ot,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No classes scheduled for today"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Enjoy your free day!"})]}):v.map((T,Q)=>e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg border border-gray-200 hover:border-blue-300 transition-colors",children:[e.jsxs("div",{className:"text-center min-w-[100px]",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:T.start_time||""}),e.jsx("p",{className:"text-xs text-gray-500",children:T.end_time||""})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:T.subject_name}),e.jsx("p",{className:"text-sm text-gray-600",children:T.class_name})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>t(`/teacher/students?class=${T.class_id}`),className:"btn bg-gray-200 hover:bg-gray-300 btn-sm",children:"Students"}),e.jsx("button",{onClick:()=>t(`/teacher/attendance?class=${T.class_id}`),className:"btn btn-primary btn-sm",children:"Attendance"})]})]},Q))})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(Fs,{className:"w-5 h-5 text-purple-600"}),"Class Performance"]})}),e.jsx("div",{className:"p-4 space-y-3",children:D.length===0?e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No grade data available"}):D.slice(0,4).map((T,Q)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm text-gray-900",children:T.class_name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[T.student_count," students"]})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${T.average==="N/A"?"bg-gray-100 text-gray-600":parseFloat(T.average)>=70?"bg-green-100 text-green-700":parseFloat(T.average)>=50?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:T.average==="N/A"?"N/A":`${T.average}%`})]},Q))})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(_s,{className:"w-5 h-5 text-orange-600"}),"Student Alerts"]})}),e.jsx("div",{className:"p-4",children:M.length===0?e.jsxs("div",{className:"text-center py-4",children:[e.jsx(Mt,{className:"w-8 h-8 text-green-500 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-500",children:"No alerts at this time"})]}):e.jsx("div",{className:"space-y-3",children:M.map((T,Q)=>e.jsxs("div",{className:"flex items-start gap-3 p-2 bg-orange-50 rounded-lg",children:[e.jsx(ka,{className:"w-4 h-4 text-orange-500 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:T.student_name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[T.class_name,"  ",T.issue]})]})]},Q))})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between",children:e.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(Ot,{className:"w-5 h-5 text-indigo-600"}),"Upcoming Events"]})}),e.jsx("div",{className:"p-4",children:K.length===0?e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No upcoming events"}):e.jsx("div",{className:"space-y-3",children:K.slice(0,3).map((T,Q)=>e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:"w-10 h-10 bg-indigo-100 rounded-lg flex flex-col items-center justify-center",children:[e.jsx("span",{className:"text-xs text-indigo-600 font-medium",children:new Date(T.start_date||T.event_date).toLocaleDateString("en-GB",{month:"short"})}),e.jsx("span",{className:"text-sm font-bold text-indigo-700",children:new Date(T.start_date||T.event_date).getDate()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm text-gray-900",children:T.title||T.event_name}),e.jsx("p",{className:"text-xs text-gray-500",children:T.location||"School"})]})]},Q))})})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(wa,{className:"w-5 h-5 text-green-600"}),"Recent Messages"]}),e.jsxs("button",{onClick:()=>t("/teacher/messages"),className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1",children:["View All ",e.jsx(cr,{className:"w-4 h-4"})]})]}),e.jsx("div",{className:"p-6",children:$.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ra,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No recent messages"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Messages from parents will appear here"})]}):e.jsx("div",{className:"space-y-4",children:$.map((T,Q)=>e.jsxs("div",{className:"flex items-start gap-4 pb-4 border-b border-gray-100 last:border-0 last:pb-0",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center text-green-600 font-semibold",children:T.sender_name?.charAt(0)||"P"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"font-medium text-gray-900",children:T.sender_name||"Parent"}),e.jsx("span",{className:"text-xs text-gray-500",children:T.created_at?new Date(T.created_at).toLocaleDateString():""})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:T.message||T.content})]})]},Q))})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("button",{onClick:()=>t("/teacher/homework"),className:"card p-6 hover:shadow-lg transition-shadow text-left",children:[e.jsx(Kt,{className:"w-8 h-8 text-blue-600 mb-3"}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Manage Homework"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Assign and review homework"})]}),e.jsxs("button",{onClick:()=>t("/teacher/grading"),className:"card p-6 hover:shadow-lg transition-shadow text-left",children:[e.jsx(Is,{className:"w-8 h-8 text-green-600 mb-3"}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Grade Students"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Create assessments and grade"})]}),e.jsxs("button",{onClick:()=>t("/teacher/attendance"),className:"card p-6 hover:shadow-lg transition-shadow text-left",children:[e.jsx(Wc,{className:"w-8 h-8 text-purple-600 mb-3"}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Mark Attendance"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Record daily attendance"})]}),e.jsxs("button",{onClick:()=>t("/teacher/reports"),className:"card p-6 hover:shadow-lg transition-shadow text-left",children:[e.jsx(Fs,{className:"w-8 h-8 text-orange-600 mb-3"}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"View Reports"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Student performance reports"})]})]})]})}const sL="https://eea.mcaforo.com/backend/api";function aL(){const{user:t}=Us(),[s,a]=h.useState(null),[r,l]=h.useState(!0);h.useEffect(()=>{t?.id&&c()},[t?.id]);const c=async()=>{try{l(!0);const m=t.student_id||t.id,u=await F.get(`${sL}/dashboard.php?role=student&user_id=${m}`);u.data.success&&a(u.data)}catch(m){console.error("Error fetching dashboard:",m)}finally{l(!1)}};if(r)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(!s)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("p",{className:"text-gray-600",children:"Failed to load dashboard data"})});const o=s.student;return e.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-600 to-teal-600 rounded-xl p-6 mb-8 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(ha,{className:"text-white",size:32})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["Welcome, ",o?.first_name," ",o?.last_name,"!"]}),e.jsxs("p",{className:"text-green-100 mt-1",children:[o?.class_name||"No class assigned","  ",o?.admission_number]})]})]}),e.jsxs("div",{className:"text-right hidden md:block",children:[e.jsx("p",{className:"text-green-100",children:"Today"}),e.jsx("p",{className:"text-xl font-semibold",children:new Date().toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})})]})]})}),s.insights&&s.insights.length>0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(Jr,{className:"text-purple-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Your AI Assistant"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Personalized tips to help you succeed"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.insights.map((m,u)=>e.jsx(rL,{insight:m},u))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx(aA,{title:"Average Score",value:`${s.average_score}%`,icon:e.jsx(Is,{className:"text-yellow-600",size:24}),color:"yellow",subtitle:nL(s.average_score)}),e.jsx(aA,{title:"Attendance Rate",value:`${s.attendance_rate}%`,icon:e.jsx(Mt,{className:"text-green-600",size:24}),color:"green",subtitle:`${s.attendance?.present||0} days present`}),e.jsx(aA,{title:"Pending Homework",value:s.pending_homework?.length||0,icon:e.jsx(Di,{className:"text-blue-600",size:24}),color:"blue",subtitle:"assignments due"}),e.jsx(aA,{title:"Fee Balance",value:`GHS ${parseFloat(s.fees?.balance||0).toLocaleString()}`,icon:e.jsx(vs,{className:"text-purple-600",size:24}),color:"purple",subtitle:s.fees?.balance>0?"Outstanding":"Paid"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Academic Progress"}),e.jsx($s,{className:"text-green-600",size:24})]}),e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsxs("svg",{className:"w-40 h-40",children:[e.jsx("circle",{className:"text-gray-200",strokeWidth:"12",stroke:"currentColor",fill:"transparent",r:"64",cx:"80",cy:"80"}),e.jsx("circle",{className:lL(s.average_score),strokeWidth:"12",strokeDasharray:`${s.average_score*4.02} 402`,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:"64",cx:"80",cy:"80",transform:"rotate(-90 80 80)"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("span",{className:"text-3xl font-bold",children:[s.average_score,"%"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Average"})]})})]})}),e.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:"Recent Grades"}),s.recent_grades?.length>0?e.jsx("div",{className:"space-y-2",children:s.recent_grades.slice(0,4).map((m,u)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:m.subject_name}),e.jsx("p",{className:"text-sm text-gray-500",children:m.exam_name||"Assessment"})]}),e.jsxs("div",{className:`px-3 py-1 rounded-full font-semibold ${iL(m.score)}`,children:[m.score,"%"]})]},u))}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No grades yet"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Today's Classes"}),e.jsx(Ot,{className:"text-blue-600",size:24})]}),s.todays_timetable?.length>0?e.jsx("div",{className:"space-y-3",children:s.todays_timetable.map((m,u)=>e.jsx("div",{className:`p-4 rounded-lg border-l-4 ${h2(m.start_time,m.end_time)?"bg-blue-50 border-blue-500":"bg-gray-50 border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800",children:m.subject_name}),e.jsx("p",{className:"text-sm text-gray-600",children:m.teacher_name||"TBA"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-700",children:[m.start_time?.slice(0,5)," - ",m.end_time?.slice(0,5)]}),h2(m.start_time,m.end_time)&&e.jsx("span",{className:"text-xs bg-blue-500 text-white px-2 py-0.5 rounded-full",children:"Now"})]})]})},u))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ot,{className:"mx-auto text-gray-400 mb-4",size:48}),e.jsx("p",{className:"text-gray-500",children:"No classes scheduled for today"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Pending Homework"}),e.jsx(Kt,{className:"text-orange-600",size:24})]}),s.pending_homework?.length>0?e.jsx("div",{className:"space-y-3",children:s.pending_homework.map((m,u)=>e.jsx("div",{className:"p-4 border rounded-lg",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800",children:m.title}),e.jsx("p",{className:"text-sm text-gray-600",children:m.subject_name})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-sm ${Jx(m.due_date)<=1?"bg-red-100 text-red-700":Jx(m.due_date)<=3?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:Jx(m.due_date)===0?"Due Today":Jx(m.due_date)===1?"Due Tomorrow":`${Jx(m.due_date)} days left`})]})},u))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Mt,{className:"mx-auto text-green-400 mb-4",size:48}),e.jsx("p",{className:"text-gray-500",children:"All caught up! No pending homework."})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Fee Summary"}),e.jsx(vs,{className:"text-green-600",size:24})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-gray-600",children:"Total Fees"}),e.jsxs("span",{className:"font-semibold text-gray-800",children:["GHS ",parseFloat(s.fees?.total_fees||0).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50 rounded-lg",children:[e.jsx("span",{className:"text-gray-600",children:"Amount Paid"}),e.jsxs("span",{className:"font-semibold text-green-600",children:["GHS ",parseFloat(s.fees?.paid||0).toLocaleString()]})]}),e.jsxs("div",{className:`flex items-center justify-between p-4 rounded-lg ${s.fees?.balance>0?"bg-red-50":"bg-green-50"}`,children:[e.jsx("span",{className:"text-gray-600",children:"Balance"}),e.jsxs("span",{className:`font-semibold ${s.fees?.balance>0?"text-red-600":"text-green-600"}`,children:["GHS ",parseFloat(s.fees?.balance||0).toLocaleString()]})]}),e.jsxs("div",{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Payment Progress"}),e.jsxs("span",{className:"text-sm font-medium",children:[s.fees?.total_fees>0?Math.round(s.fees.paid/s.fees.total_fees*100):0,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"bg-green-500 h-3 rounded-full transition-all",style:{width:`${s.fees?.total_fees>0?s.fees.paid/s.fees.total_fees*100:0}%`}})})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Attendance Summary"}),e.jsx(Fs,{className:"text-blue-600",size:24})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center p-6 bg-green-50 rounded-xl",children:[e.jsx("p",{className:"text-4xl font-bold text-green-600",children:s.attendance?.present||0}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Days Present"})]}),e.jsxs("div",{className:"text-center p-6 bg-red-50 rounded-xl",children:[e.jsx("p",{className:"text-4xl font-bold text-red-600",children:s.attendance?.absent||0}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Days Absent"})]}),e.jsxs("div",{className:"text-center p-6 bg-blue-50 rounded-xl",children:[e.jsx("p",{className:"text-4xl font-bold text-blue-600",children:s.attendance?.total||0}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Total Days"})]})]})]})]})}function aA({title:t,value:s,icon:a,color:r,subtitle:l}){const c={yellow:"bg-yellow-50 border-yellow-100",green:"bg-green-50 border-green-100",blue:"bg-blue-50 border-blue-100",purple:"bg-purple-50 border-purple-100"};return e.jsxs("div",{className:`${c[r]} border rounded-xl p-6`,children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:"p-2 bg-white rounded-lg shadow-sm",children:a})}),e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:s}),e.jsx("p",{className:"text-gray-600",children:t}),l&&e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:l})]})}function rL({insight:t}){const s={warning:{bg:"bg-yellow-50",border:"border-yellow-200",icon:_s,iconColor:"text-yellow-600"},info:{bg:"bg-blue-50",border:"border-blue-200",icon:fc,iconColor:"text-blue-600"},success:{bg:"bg-green-50",border:"border-green-200",icon:Mt,iconColor:"text-green-600"}},a=s[t.type]||s.info,r=a.icon;return e.jsx("div",{className:`${a.bg} ${a.border} border rounded-lg p-4`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(r,{className:a.iconColor,size:20}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-800",children:t.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.message}),t.action&&e.jsxs("button",{className:"mt-2 text-sm text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1",children:[t.action,e.jsx(Li,{size:14})]})]})]})})}function nL(t){return t>=80?"Excellent":t>=70?"Very Good":t>=60?"Good":t>=50?"Average":"Needs Improvement"}function lL(t){return t>=80?"text-green-500":t>=60?"text-yellow-500":"text-red-500"}function iL(t){return t>=80?"bg-green-100 text-green-700":t>=60?"bg-yellow-100 text-yellow-700":t>=50?"bg-orange-100 text-orange-700":"bg-red-100 text-red-700"}function h2(t,s){const a=new Date,r=a.getHours()*60+a.getMinutes(),[l,c]=t.split(":").map(Number),[o,m]=s.split(":").map(Number),u=l*60+c,x=o*60+m;return r>=u&&r<=x}function Jx(t){const s=new Date;s.setHours(0,0,0,0);const a=new Date(t);a.setHours(0,0,0,0);const r=a-s;return Math.ceil(r/(1e3*60*60*24))}function v5({parentId:t,children:s,onLinkSuccess:a}){const[r,l]=h.useState("generate"),[c,o]=h.useState(""),[m,u]=h.useState(null),[x,A]=h.useState(""),[g,N]=h.useState("guardian"),[f,y]=h.useState(!1),[v,U]=h.useState(""),[D,M]=h.useState(""),[K,$]=h.useState(!1),P=async()=>{if(!c){U("Please select a child");return}y(!0),U(""),u(null);try{const j=await F.post(`${ee}/parent_portal.php?resource=generate_link_code`,{parent_id:t,student_id:c});j.data.success?(u({code:j.data.link_code,expiresAt:j.data.expires_at}),M("Link code generated successfully!")):U(j.data.error||"Failed to generate code")}catch{U("Failed to generate link code. Please try again.")}finally{y(!1)}},se=async()=>{if(!x.trim()){U("Please enter a link code");return}y(!0),U(""),M("");try{const j=await F.post(`${ee}/parent_portal.php?resource=use_link_code`,{parent_id:t,link_code:x.trim().toUpperCase(),relationship:g});j.data.success?(M(j.data.message||"Successfully linked to child!"),A(""),a&&a(j.data.child_id)):U(j.data.error||"Failed to use link code")}catch{U("Failed to link. Please check the code and try again.")}finally{y(!1)}},z=()=>{m?.code&&(navigator.clipboard.writeText(m.code),$(!0),setTimeout(()=>$(!1),2e3))},R=()=>{m?.code&&navigator.share&&navigator.share({title:"Family Link Code",text:`Use this code to link to our child's school portal: ${m.code}`})};return e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(Rt,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Family Link"}),e.jsx("p",{className:"text-purple-100 text-sm",children:"Connect multiple parents to your children"})]})]})}),e.jsxs("div",{className:"flex border-b border-gray-200",children:[e.jsxs("button",{onClick:()=>{l("generate"),U(""),M("")},className:`flex-1 px-4 py-3 text-sm font-medium flex items-center justify-center gap-2 transition-colors ${r==="generate"?"text-purple-600 border-b-2 border-purple-600 bg-purple-50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(cB,{className:"w-4 h-4"}),"Generate Code"]}),e.jsxs("button",{onClick:()=>{l("use"),U(""),M("")},className:`flex-1 px-4 py-3 text-sm font-medium flex items-center justify-center gap-2 transition-colors ${r==="use"?"text-purple-600 border-b-2 border-purple-600 bg-purple-50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(Ti,{className:"w-4 h-4"}),"Use Code"]})]}),e.jsxs("div",{className:"p-6",children:[v&&e.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2 text-red-700",children:[e.jsx(ka,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:v}),e.jsx("button",{onClick:()=>U(""),className:"ml-auto",children:e.jsx(Nt,{className:"w-4 h-4"})})]}),D&&e.jsxs("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-lg flex items-center gap-2 text-green-700",children:[e.jsx(Tn,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:D}),e.jsx("button",{onClick:()=>M(""),className:"ml-auto",children:e.jsx(Nt,{className:"w-4 h-4"})})]}),r==="generate"?e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Generate a unique code to share with your spouse or another guardian. They can use this code to link their account to your child."}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Child"}),e.jsxs("select",{value:c,onChange:j=>o(j.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[e.jsx("option",{value:"",children:"Choose a child..."}),s?.map(j=>e.jsx("option",{value:j.id||j.student_id,children:j.full_name||`${j.first_name} ${j.last_name}`},j.id||j.student_id))]})]}),e.jsx("button",{onClick:P,disabled:f||!c,className:"w-full py-3 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-lg font-medium hover:from-purple-700 hover:to-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 transition-all",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Qh,{className:"w-5 h-5"}),"Generate Link Code"]})}),m&&e.jsxs("div",{className:"mt-6 p-4 bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-200",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Your Family Link Code"}),e.jsx("div",{className:"text-3xl font-mono font-bold text-purple-700 tracking-wider",children:m.code})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-gray-500 mb-4",children:[e.jsx(Wt,{className:"w-4 h-4"}),e.jsxs("span",{children:["Expires: ",new Date(m.expiresAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:z,className:"flex-1 py-2 px-4 bg-white border border-purple-300 rounded-lg text-purple-700 font-medium hover:bg-purple-50 flex items-center justify-center gap-2 transition-colors",children:[K?e.jsx(Tn,{className:"w-4 h-4"}):e.jsx(vl,{className:"w-4 h-4"}),K?"Copied!":"Copy"]}),navigator.share&&e.jsxs("button",{onClick:R,className:"flex-1 py-2 px-4 bg-white border border-purple-300 rounded-lg text-purple-700 font-medium hover:bg-purple-50 flex items-center justify-center gap-2 transition-colors",children:[e.jsx($o,{className:"w-4 h-4"}),"Share"]})]})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Enter the family link code shared by your spouse or the primary guardian to connect to your child's profile."}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Link Code"}),e.jsx("input",{type:"text",value:x,onChange:j=>A(j.target.value.toUpperCase()),placeholder:"e.g., FAM-ABC123",className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 font-mono text-lg tracking-wider uppercase"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Your Relationship"}),e.jsxs("select",{value:g,onChange:j=>N(j.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[e.jsx("option",{value:"father",children:"Father"}),e.jsx("option",{value:"mother",children:"Mother"}),e.jsx("option",{value:"guardian",children:"Guardian"}),e.jsx("option",{value:"grandparent",children:"Grandparent"}),e.jsx("option",{value:"uncle",children:"Uncle"}),e.jsx("option",{value:"aunt",children:"Aunt"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsx("button",{onClick:se,disabled:f||!x.trim(),className:"w-full py-3 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-lg font-medium hover:from-purple-700 hover:to-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 transition-all",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Linking..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ti,{className:"w-5 h-5"}),"Link to Child"]})})]})]})]})}function cL(){const t=la(),{user:s}=Us(),[a,r]=h.useState(null),[l,c]=h.useState(!0),[o,m]=h.useState(null),[u,x]=h.useState("overview"),[A,g]=h.useState({}),[N,f]=h.useState(!1),y=C=>{if(!C)return null;if(C.startsWith("http"))return C;const O=C.replace(/^\/?(uploads\/)?/,"");return`${ee.replace("/backend/api","")}/uploads/${O}`},v=C=>{g(O=>({...O,[C]:!0}))};h.useEffect(()=>{s?.id&&U()},[s?.id]);const U=async()=>{try{c(!0);const C=await F.get(`${ee}/parent_portal.php?resource=dashboard&parent_id=${s.id}`);if(C.data.success&&C.data.dashboard?.children?.length>0){const V=C.data.dashboard;r({success:!0,parent:{id:s.id,name:s.name},children:V.children.map(re=>({id:re.child_id||re.student_id,student_id:re.student_id,full_name:re.full_name,first_name:re.full_name?.split(" ")[0],last_name:re.full_name?.split(" ").slice(1).join(" "),class_name:re.class_name,status:re.student_status||"active",photo:re.photo,admission_no:re.admission_no})),children_summary:V.children.map(re=>({student:{id:re.student_id},attendance_rate:V.attendance_summary?.total>0?Math.round(V.attendance_summary.present/V.attendance_summary.total*100):0,average_score:0})),applications:[],insights:[],total_fee_balance:V.pending_fees||0,notifications:V.recent_notifications||[],upcoming_events:V.upcoming_events||[],attendance_summary:V.attendance_summary}),V.children?.length>0&&m({id:V.children[0].child_id||V.children[0].student_id,student_id:V.children[0].student_id,full_name:V.children[0].full_name,class_name:V.children[0].class_name,status:V.children[0].student_status||"active",photo:V.children[0].photo});return}const O=await F.get(`${ee}/dashboard.php?role=parent&user_id=${s.id}`);O.data.success&&(r(O.data),O.data.children?.length>0&&m(O.data.children[0]))}catch(C){console.error("Error fetching dashboard:",C)}finally{c(!1)}};if(l)return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-purple-200 border-t-purple-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading your dashboard..."})]})});const D=a?.parent,M=a?.children||[],K=a?.children_summary||[],$=a?.applications||[],P=a?.insights||[],se=parseFloat(a?.total_fee_balance||0),z=M.filter(C=>C.status==="active").length,R=$.filter(C=>C.status==="pending").length,j=$.filter(C=>C.status==="approved").length,T=K.length>0?Math.round(K.reduce((C,O)=>C+(parseFloat(O.average_score)||0),0)/K.length):0,Q=K.length>0?Math.round(K.reduce((C,O)=>C+(parseFloat(O.attendance_rate)||0),0)/K.length):0,E=C=>K.find(O=>O.student?.id===C)||{},te=C=>{const O=E(C.id),V=[],re=parseFloat(O.average_score)||0,ge=parseFloat(O.attendance_rate)||0,xe=parseFloat(O.fee_balance)||0;return re>=80?V.push({type:"success",icon:sl,message:"Excellent academic performance! Keep it up!"}):re>=60?V.push({type:"info",icon:$s,message:"Good progress. Consider extra tutoring for improvement."}):re>0&&V.push({type:"warning",icon:_s,message:"Needs attention. Schedule a meeting with teachers."}),ge>=90?V.push({type:"success",icon:Mt,message:"Outstanding attendance record!"}):ge<75&&ge>0&&V.push({type:"warning",icon:Wt,message:"Attendance needs improvement. Regular attendance is crucial."}),xe>0&&V.push({type:"warning",icon:Xc,message:`Outstanding fee balance: GHS ${xe.toLocaleString()}`}),V};return e.jsxs("div",{className:"p-4 md:p-6 bg-gradient-to-br from-gray-50 to-purple-50 min-h-screen",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-600 via-purple-700 to-pink-600 rounded-2xl p-6 md:p-8 mb-6 text-white shadow-xl",children:e.jsxs("div",{className:"flex flex-col lg:flex-row items-start lg:items-center justify-between gap-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 md:w-20 md:h-20 bg-white/20 backdrop-blur rounded-2xl flex items-center justify-center",children:e.jsx(Oo,{className:"text-white",size:36})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold",children:["Welcome back, ",D?.full_name||s?.name||"Parent","!"]}),e.jsxs("p",{className:"text-purple-200 mt-1 flex items-center gap-2",children:[e.jsx(Rt,{size:16}),M.length," ",M.length===1?"Child":"Children","  ",z," Enrolled"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 w-full lg:w-auto",children:[e.jsxs("div",{className:"bg-white/10 backdrop-blur rounded-xl p-4 text-center",children:[e.jsx("p",{className:"text-purple-200 text-xs uppercase tracking-wide",children:"Children"}),e.jsx("p",{className:"text-2xl font-bold",children:M.length})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur rounded-xl p-4 text-center",children:[e.jsx("p",{className:"text-purple-200 text-xs uppercase tracking-wide",children:"Avg Score"}),e.jsxs("p",{className:"text-2xl font-bold",children:[T,"%"]})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur rounded-xl p-4 text-center",children:[e.jsx("p",{className:"text-purple-200 text-xs uppercase tracking-wide",children:"Attendance"}),e.jsxs("p",{className:"text-2xl font-bold",children:[Q,"%"]})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur rounded-xl p-4 text-center",children:[e.jsx("p",{className:"text-purple-200 text-xs uppercase tracking-wide",children:"Balance"}),e.jsxs("p",{className:"text-2xl font-bold",children:["GHS ",se.toLocaleString()]})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4 mb-6",children:[e.jsx(bm,{icon:e.jsx(Ti,{size:24}),label:"Apply for Admission",description:"New child",color:"blue",onClick:()=>t("/parent/apply")}),e.jsx(bm,{icon:e.jsx(Di,{size:24}),label:"Term Enrollment",description:"Enroll for term",color:"green",onClick:()=>t("/parent/enroll")}),e.jsx(bm,{icon:e.jsx(Kt,{size:24}),label:"View Invoices",description:"Fee statements",color:"purple",onClick:()=>t("/parent/invoices")}),e.jsx(bm,{icon:e.jsx(aa,{size:24}),label:"Make Payment",description:"Pay fees",color:"emerald",onClick:()=>t("/parent/payments")}),e.jsx(bm,{icon:e.jsx(wa,{size:24}),label:"Messages",description:"Communication",color:"orange",onClick:()=>t("/parent/messages")}),e.jsx(bm,{icon:e.jsx(Fs,{size:24}),label:"Report Cards",description:"View grades",color:"pink",onClick:()=>o&&t(`/parent/child/${o.id}`)}),e.jsx(bm,{icon:e.jsx(Qh,{size:24}),label:"Family Link",description:"Add parent",color:"indigo",onClick:()=>f(!0)})]}),N&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"relative max-w-md w-full",children:[e.jsx("button",{onClick:()=>f(!1),className:"absolute -top-2 -right-2 z-10 p-2 bg-white rounded-full shadow-lg hover:bg-gray-100",children:e.jsx(Nt,{size:20})}),e.jsx(v5,{parentId:s?.id,children:M,onLinkSuccess:()=>{f(!1),U()}})]})}),($.length>0||R>0)&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-xl",children:e.jsx(Di,{className:"text-blue-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Application Status"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[$.length," total applications"]})]})]}),e.jsxs("button",{onClick:()=>t("/parent/apply"),className:"text-blue-600 hover:text-blue-800 text-sm font-medium flex items-center gap-1",children:["New Application ",e.jsx(Pl,{size:16})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-yellow-50 border border-yellow-100 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-yellow-600 text-sm font-medium",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-700",children:R})]}),e.jsx(Wt,{className:"text-yellow-500",size:32})]})}),e.jsx("div",{className:"bg-green-50 border border-green-100 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-600 text-sm font-medium",children:"Approved"}),e.jsx("p",{className:"text-2xl font-bold text-green-700",children:j})]}),e.jsx(Mt,{className:"text-green-500",size:32})]})}),e.jsx("div",{className:"bg-blue-50 border border-blue-100 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-600 text-sm font-medium",children:"Enrolled"}),e.jsx("p",{className:"text-2xl font-bold text-blue-700",children:z})]}),e.jsx(il,{className:"text-blue-500",size:32})]})})]})]}),P.length>0&&e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-2xl p-6 mb-6 border border-purple-100",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-xl",children:e.jsx(cl,{className:"text-purple-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"AI Insights & Recommendations"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Personalized insights for your children"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:P.slice(0,6).map((C,O)=>e.jsx(dL,{insight:C},O))})]}),M.length>0&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm mb-6 overflow-hidden",children:[e.jsx("div",{className:"border-b border-gray-100 p-4",children:e.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto pb-2",children:[e.jsx("span",{className:"text-gray-500 text-sm whitespace-nowrap mr-2",children:"Select Child:"}),M.map(C=>{const O=E(C.id)?.photo||C.photo,V=y(O),re=!V||A[C.id];return e.jsxs("button",{onClick:()=>m(C),className:`flex items-center gap-2 px-3 py-2 rounded-xl transition-all whitespace-nowrap ${o?.id===C.id?"bg-purple-600 text-white shadow-lg shadow-purple-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[!re&&e.jsx("img",{src:V,alt:C.first_name,className:"w-8 h-8 rounded-full object-cover border-2 border-white",onError:()=>v(C.id)}),re&&e.jsxs("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold ${o?.id===C.id?"bg-purple-400 text-white":"bg-purple-200 text-purple-700"}`,children:[C.first_name?.[0],C.last_name?.[0]]}),e.jsxs("span",{className:"font-medium",children:[C.first_name," ",C.last_name]})]},C.id)})]})}),o&&e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[(()=>{const C=E(o.id)?.photo||o.photo,O=y(C),V=!O||A[o.id];return e.jsxs(e.Fragment,{children:[!V&&e.jsx("img",{src:O,alt:`${o.first_name} ${o.last_name}`,className:"w-16 h-16 rounded-2xl object-cover border-2 border-purple-200",onError:()=>v(o.id)}),V&&e.jsxs("div",{className:"w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-500 rounded-2xl flex items-center justify-center text-white text-2xl font-bold",children:[o.first_name?.[0],o.last_name?.[0]]})]})})(),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-800",children:[o.first_name," ",o.last_name]}),e.jsxs("p",{className:"text-gray-500 flex items-center gap-2",children:[e.jsx(il,{size:14}),o.class_name||"No class assigned",e.jsx("span",{className:`ml-2 px-2 py-0.5 rounded-full text-xs font-medium ${o.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:o.status||"Active"})]})]})]}),e.jsxs("button",{onClick:()=>t(`/parent/child/${o.id}`),className:"flex items-center gap-2 px-4 py-2 bg-purple-100 text-purple-700 rounded-xl hover:bg-purple-200 transition-all",children:[e.jsx(na,{size:18}),"View Full Profile"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx(rA,{icon:e.jsx(Is,{}),label:"Academic Score",value:`${E(o.id)?.average_score||0}%`,subtext:`Grade: ${p2(E(o.id)?.average_score||0)}`,color:"yellow",trend:E(o.id)?.average_score>=70?"up":"down"}),e.jsx(rA,{icon:e.jsx(Ot,{}),label:"Attendance Rate",value:`${E(o.id)?.attendance_rate||0}%`,subtext:"Last 30 days",color:"green",trend:E(o.id)?.attendance_rate>=80?"up":"down"}),e.jsx(rA,{icon:e.jsx(as,{}),label:"Subjects",value:E(o.id)?.subjects_enrolled||0,subtext:"Enrolled courses",color:"blue"}),e.jsx(rA,{icon:e.jsx(Xc,{}),label:"Fee Balance",value:`GHS ${parseFloat(E(o.id)?.fee_balance||0).toLocaleString()}`,subtext:parseFloat(E(o.id)?.fee_balance||0)>0?"Outstanding":"Fully paid",color:parseFloat(E(o.id)?.fee_balance||0)>0?"red":"green"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-purple-50 rounded-xl p-4 mb-6",children:[e.jsxs("h4",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx(Jr,{size:18,className:"text-purple-600"}),"AI Insights for ",o.first_name]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:te(o).length>0?te(o).map((C,O)=>e.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-lg ${C.type==="success"?"bg-green-50":C.type==="warning"?"bg-yellow-50":"bg-blue-50"}`,children:[e.jsx(C.icon,{size:18,className:C.type==="success"?"text-green-600":C.type==="warning"?"text-yellow-600":"text-blue-600"}),e.jsx("p",{className:"text-sm text-gray-700",children:C.message})]},O)):e.jsxs("div",{className:"col-span-3 text-center py-4 text-gray-500",children:[e.jsx(fc,{size:24,className:"mx-auto mb-2 text-gray-400"}),e.jsx("p",{children:"No specific insights available yet. Data will appear as your child's records are updated."})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white border border-gray-100 rounded-xl p-6",children:[e.jsxs("h4",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(Gl,{size:18,className:"text-purple-600"}),"Overall Performance"]}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"relative",children:[e.jsxs("svg",{className:"w-48 h-48",children:[e.jsx("circle",{className:"text-gray-100",strokeWidth:"16",stroke:"currentColor",fill:"transparent",r:"80",cx:"96",cy:"96"}),e.jsx("circle",{className:mL(E(o.id)?.average_score||0),strokeWidth:"16",strokeDasharray:`${(E(o.id)?.average_score||0)*5.02} 502`,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:"80",cx:"96",cy:"96",transform:"rotate(-90 96 96)"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("span",{className:"text-4xl font-bold text-gray-800",children:[E(o.id)?.average_score||0,"%"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Average Score"}),e.jsxs("p",{className:`text-lg font-bold ${uL(E(o.id)?.average_score||0)}`,children:["Grade ",p2(E(o.id)?.average_score||0)]})]})})]})})]}),e.jsxs("div",{className:"bg-white border border-gray-100 rounded-xl p-6",children:[e.jsxs("h4",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(Ir,{size:18,className:"text-purple-600"}),"Quick Stats"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(nA,{label:"Attendance",value:E(o.id)?.attendance_rate||0,color:"green"}),e.jsx(nA,{label:"Academic Performance",value:E(o.id)?.average_score||0,color:"blue"}),e.jsx(nA,{label:"Assignment Completion",value:E(o.id)?.assignment_completion||85,color:"purple"}),e.jsx(nA,{label:"Class Participation",value:E(o.id)?.participation||78,color:"orange"})]})]})]})]})]}),M.length===0&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-12 text-center",children:[e.jsx("div",{className:"w-24 h-24 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(Rt,{className:"text-purple-600",size:48})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"No Children Enrolled Yet"}),e.jsx("p",{className:"text-gray-500 mb-6 max-w-md mx-auto",children:"Start by applying for admission for your child. Once approved, you'll be able to track their progress here."}),e.jsxs("button",{onClick:()=>t("/parent/apply"),className:"inline-flex items-center gap-2 px-6 py-3 bg-purple-600 text-white rounded-xl hover:bg-purple-700 transition-all shadow-lg shadow-purple-200",children:[e.jsx(Ti,{size:20}),"Apply for Admission"]})]}),K.length>1&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"All Children Overview"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:K.map((C,O)=>e.jsx(oL,{summary:C,onClick:()=>{const V=M.find(re=>re.id===C.student?.id);V&&m(V)},isSelected:o?.id===C.student?.id},O))})]})]})}function bm({icon:t,label:s,description:a,color:r,onClick:l}){const c={blue:"bg-blue-50 hover:bg-blue-100 border-blue-100 text-blue-600",green:"bg-green-50 hover:bg-green-100 border-green-100 text-green-600",purple:"bg-purple-50 hover:bg-purple-100 border-purple-100 text-purple-600",emerald:"bg-emerald-50 hover:bg-emerald-100 border-emerald-100 text-emerald-600",orange:"bg-orange-50 hover:bg-orange-100 border-orange-100 text-orange-600",pink:"bg-pink-50 hover:bg-pink-100 border-pink-100 text-pink-600"};return e.jsxs("button",{onClick:l,className:`${c[r]} p-4 rounded-xl border transition-all flex flex-col items-center gap-2 hover:shadow-md cursor-pointer`,children:[t,e.jsx("span",{className:"text-sm font-medium text-gray-800",children:s}),e.jsx("span",{className:"text-xs text-gray-500",children:a})]})}function rA({icon:t,label:s,value:a,subtext:r,color:l,trend:c}){const o={yellow:"bg-yellow-50 border-yellow-100",green:"bg-green-50 border-green-100",blue:"bg-blue-50 border-blue-100",red:"bg-red-50 border-red-100",purple:"bg-purple-50 border-purple-100"},m={yellow:"text-yellow-600",green:"text-green-600",blue:"text-blue-600",red:"text-red-600",purple:"text-purple-600"};return e.jsxs("div",{className:`${o[l]} border rounded-xl p-4`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:m[l],children:t}),c&&e.jsx("span",{className:c==="up"?"text-green-500":"text-red-500",children:c==="up"?e.jsx($s,{size:16}):e.jsx(gc,{size:16})})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:a}),e.jsx("p",{className:"text-sm text-gray-500",children:s}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:r})]})}function nA({label:t,value:s,color:a}){const r={green:"bg-green-500",blue:"bg-blue-500",purple:"bg-purple-500",orange:"bg-orange-500"};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600",children:t}),e.jsxs("span",{className:"font-medium text-gray-800",children:[s,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-100 rounded-full h-2",children:e.jsx("div",{className:`${r[a]} h-2 rounded-full transition-all duration-500`,style:{width:`${Math.min(s,100)}%`}})})]})}function oL({summary:t,onClick:s,isSelected:a}){const r=t.student||{};return e.jsxs("div",{onClick:s,className:`bg-white rounded-xl shadow-sm p-6 hover:shadow-md transition-all cursor-pointer border-2 ${a?"border-purple-500":"border-transparent"}`,children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-white font-bold",children:[r.first_name?.[0],r.last_name?.[0]]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-800",children:[r.first_name," ",r.last_name]}),e.jsx("p",{className:"text-sm text-gray-500",children:r.class_name||"No class"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{className:"p-2 bg-yellow-50 rounded-lg",children:[e.jsxs("p",{className:"text-lg font-bold text-yellow-600",children:[t.average_score||0,"%"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Score"})]}),e.jsxs("div",{className:"p-2 bg-green-50 rounded-lg",children:[e.jsxs("p",{className:"text-lg font-bold text-green-600",children:[t.attendance_rate||0,"%"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Attendance"})]}),e.jsxs("div",{className:`p-2 rounded-lg ${parseFloat(t.fee_balance)>0?"bg-red-50":"bg-green-50"}`,children:[e.jsx("p",{className:`text-lg font-bold ${parseFloat(t.fee_balance)>0?"text-red-600":"text-green-600"}`,children:parseFloat(t.fee_balance)>0?"Due":"Paid"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Fees"})]})]})]})}function dL({insight:t}){const s={warning:{bg:"bg-yellow-50",border:"border-yellow-200",icon:_s,iconColor:"text-yellow-600"},info:{bg:"bg-blue-50",border:"border-blue-200",icon:fc,iconColor:"text-blue-600"},success:{bg:"bg-green-50",border:"border-green-200",icon:Mt,iconColor:"text-green-600"}},a=s[t.type]||s.info,r=a.icon;return e.jsx("div",{className:`${a.bg} ${a.border} border rounded-xl p-4`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(r,{className:a.iconColor,size:20}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-800",children:t.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.message}),t.action&&e.jsxs("button",{className:"mt-2 text-sm text-purple-600 hover:text-purple-800 font-medium flex items-center gap-1",children:[t.action,e.jsx(Li,{size:14})]})]})]})})}function mL(t){return t>=80?"text-green-500":t>=60?"text-yellow-500":"text-red-500"}function uL(t){return t>=80?"text-green-600":t>=60?"text-yellow-600":"text-red-600"}function p2(t){return t>=80?"A":t>=70?"B":t>=60?"C":t>=50?"D":"F"}function xL(){const t=la(),{user:s}=Us(),[a,r]=h.useState([]),[l,c]=h.useState(!0),[o,m]=h.useState(!1),[u,x]=h.useState(null),[A,g]=h.useState(""),[N,f]=h.useState("all"),[y,v]=h.useState("all"),[U,D]=h.useState({}),[M,K]=h.useState({}),[$,P]=h.useState({}),[se,z]=h.useState({}),[R,j]=h.useState(null);h.useEffect(()=>{T()},[]);const T=async()=>{try{c(!0);const I=(await F.get(`${ee}/teachers.php?user_id=${s?.id}`)).data.teachers||[];if(I.length===0){console.error("No teacher record found for this user"),c(!1);return}const H=I[0];x(H);const ae=H.id,B=(await F.get(`${ee}/classes.php?teacher_id=${ae}`)).data.classes||[];r(B),await Promise.all([Q(B),E(ae,B),te(ae),C(ae,B)])}catch(Z){console.error("Error fetching classes:",Z)}finally{c(!1)}},Q=async Z=>{const I={},H=new Date().toISOString().split("T")[0];for(const ae of Z)try{const B=(await F.get(`${ee}/students.php?class_id=${ae.id}`)).data.students||[];let w=null;try{const Fe=(await F.get(`${ee}/attendance.php?class_id=${ae.id}&date=${H}`)).data.attendance||[];if(Fe.length>0){const je=Fe.filter(Ge=>Ge.status==="present").length;w=Math.round(je/Fe.length*100)}}catch{}let oe=null;try{const Fe=(await F.get(`${ee}/academic.php?resource=grades&class_id=${ae.id}`)).data.grades||[];if(Fe.length>0){const je=Fe.reduce((Ge,ze)=>Ge+(parseFloat(ze.marks_obtained)||0),0);oe=Math.round(je/Fe.length)}}catch{}I[ae.id]={studentCount:B.length,attendanceRate:w,avgGrade:oe,attendanceMarked:w!==null}}catch{I[ae.id]={studentCount:0,attendanceRate:null,avgGrade:null,attendanceMarked:!1}}D(I)},E=async(Z,I)=>{try{const H=await F.get(`${ee}/teacher_subjects.php?teacher_id=${Z}`),ae=H.data.subjects||H.data.teacher_subjects||[],k={};for(const B of I)k[B.id]=ae.filter(w=>w.class_id==B.id);K(k)}catch{try{const ae=await F.get(`${ee}/timetable.php?teacher_id=${Z}`),k=ae.data.entries||ae.data.timetable||[],B={};for(const w of I){const oe=k.filter(Fe=>Fe.class_id==w.id),ne=[...new Map(oe.map(Fe=>[Fe.subject_id,{subject_name:Fe.subject_name,subject_id:Fe.subject_id}])).values()];B[w.id]=ne}K(B)}catch(ae){console.error("Could not fetch subjects:",ae)}}},te=async Z=>{try{const I=new Date().toLocaleDateString("en-US",{weekday:"long"}).toLowerCase(),H=await F.get(`${ee}/timetable.php?teacher_id=${Z}&day=${I}`),ae=H.data.entries||H.data.timetable||[],k={};ae.forEach(B=>{k[B.class_id]||(k[B.class_id]=[]),k[B.class_id].push(B)}),P(k)}catch(I){console.error("Could not fetch timetable:",I)}},C=async(Z,I)=>{const H={};for(const ae of I)try{const B=(await F.get(`${ee}/academic.php?resource=homework&class_id=${ae.id}&limit=1`)).data.homework||[];let w=0;try{w=((await F.get(`${ee}/academic.php?resource=assessments&class_id=${ae.id}`)).data.assessments||[]).filter(Fe=>!Fe.graded).length}catch{}H[ae.id]={lastHomework:B[0]||null,pendingGrades:w}}catch{H[ae.id]={lastHomework:null,pendingGrades:0}}z(H)},O=async()=>{m(!0),await T(),m(!1)},V=[...new Set(a.map(Z=>Z.level).filter(Boolean))],re=a.filter(Z=>{const I=Z.class_name?.toLowerCase().includes(A.toLowerCase())||Z.level?.toLowerCase().includes(A.toLowerCase()),H=N==="all"||Z.level===N,ae=y==="all"||Z.status===y;return I&&H&&ae}),ge=Object.values(U).reduce((Z,I)=>Z+(I.studentCount||0),0),xe=Object.values(U).filter(Z=>Z.attendanceMarked).length;return l?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(hs,{className:"w-12 h-12 text-blue-600 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading your classes..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(as,{className:"text-blue-600"}),"My Classes"]}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[u?`${u.first_name} ${u.last_name}`:"Teacher","  ",a.length," class",a.length!==1?"es":""," assigned"]})]}),e.jsxs("button",{onClick:O,disabled:o,className:"btn bg-gray-100 hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ns,{className:`w-4 h-4 ${o?"animate-spin":""}`}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(as,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.length}),e.jsx("p",{className:"text-xs text-gray-500",children:"Classes"})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(Rt,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ge}),e.jsx("p",{className:"text-xs text-gray-500",children:"Total Students"})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-teal-100 rounded-lg flex items-center justify-center",children:e.jsx(Mt,{className:"w-5 h-5 text-teal-600"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[xe,"/",a.length]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Attendance Today"})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(Qs,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Object.values(M).flat().length}),e.jsx("p",{className:"text-xs text-gray-500",children:"Subjects"})]})]})})]}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search classes...",value:A,onChange:Z=>g(Z.target.value),className:"input pl-10 w-full"})]}),e.jsxs("select",{value:N,onChange:Z=>f(Z.target.value),className:"input w-full md:w-40",children:[e.jsx("option",{value:"all",children:"All Levels"}),V.map(Z=>e.jsx("option",{value:Z,children:Z},Z))]}),e.jsxs("select",{value:y,onChange:Z=>v(Z.target.value),className:"input w-full md:w-40",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:re.map(Z=>{const I=U[Z.id]||{},H=M[Z.id]||[],ae=$[Z.id]||[],k=se[Z.id]||{};return Z.id,e.jsxs("div",{className:"card hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center text-white font-bold text-lg",children:Z.class_name?.charAt(0)||"C"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:Z.class_name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[Z.level,"  ",Z.section||"Main","  Room ",Z.room_number||"TBA"]})]})]}),e.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full ${Z.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:Z.status})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-xl font-bold text-gray-900",children:I.studentCount||0}),e.jsx("p",{className:"text-xs text-gray-500",children:"Students"})]}),e.jsxs("div",{className:`text-center p-3 rounded-lg ${I.attendanceMarked?"bg-green-50":"bg-orange-50"}`,children:[e.jsx("p",{className:`text-xl font-bold ${I.attendanceMarked?"text-green-700":"text-orange-700"}`,children:I.attendanceRate!==null?`${I.attendanceRate}%`:""}),e.jsx("p",{className:"text-xs text-gray-500",children:"Attendance"})]}),e.jsxs("div",{className:`text-center p-3 rounded-lg ${I.avgGrade>=70?"bg-green-50":I.avgGrade>=50?"bg-yellow-50":I.avgGrade?"bg-red-50":"bg-gray-50"}`,children:[e.jsx("p",{className:`text-xl font-bold ${I.avgGrade>=70?"text-green-700":I.avgGrade>=50?"text-yellow-700":I.avgGrade?"text-red-700":"text-gray-700"}`,children:I.avgGrade!==null?`${I.avgGrade}%`:""}),e.jsx("p",{className:"text-xs text-gray-500",children:"Avg Grade"})]})]})]}),H.length>0&&e.jsxs("div",{className:"px-6 py-3 border-b border-gray-100 bg-gray-50",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Subjects I Teach:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[H.slice(0,4).map((B,w)=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full",children:B.subject_name},w)),H.length>4&&e.jsxs("span",{className:"px-2 py-1 bg-gray-200 text-gray-600 text-xs rounded-full",children:["+",H.length-4," more"]})]})]}),ae.length>0&&e.jsxs("div",{className:"px-6 py-3 border-b border-gray-100",children:[e.jsxs("p",{className:"text-xs text-gray-500 mb-2 flex items-center gap-1",children:[e.jsx(Wt,{className:"w-3 h-3"})," Today's Schedule:"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ae.map((B,w)=>e.jsxs("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded-full",children:[B.start_time," - ",B.subject_name]},w))})]}),(k.lastHomework||k.pendingGrades>0)&&e.jsx("div",{className:"px-6 py-3 border-b border-gray-100 bg-yellow-50",children:e.jsxs("div",{className:"flex items-center gap-4 text-xs",children:[k.lastHomework&&e.jsxs("span",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx(Kt,{className:"w-3 h-3"}),"Last HW: ",k.lastHomework.title?.substring(0,20),"..."]}),k.pendingGrades>0&&e.jsxs("span",{className:"flex items-center gap-1 text-orange-600",children:[e.jsx(ka,{className:"w-3 h-3"}),k.pendingGrades," pending grades"]})]})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("button",{onClick:()=>t(`/teacher/students?class=${Z.id}`),className:"btn btn-primary w-full mb-3 flex items-center justify-center gap-2",children:[e.jsx(Rt,{className:"w-4 h-4"}),"View Students",e.jsx(cr,{className:"w-4 h-4"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[e.jsxs("button",{onClick:()=>t(`/teacher/attendance?class=${Z.id}`),className:`btn text-xs py-2 flex flex-col items-center gap-1 ${I.attendanceMarked?"bg-green-100 text-green-700 hover:bg-green-200":"bg-orange-100 text-orange-700 hover:bg-orange-200"}`,children:[e.jsx(Mt,{className:"w-4 h-4"}),"Attendance"]}),e.jsxs("button",{onClick:()=>t(`/teacher/homework?class=${Z.id}`),className:"btn bg-purple-100 text-purple-700 hover:bg-purple-200 text-xs py-2 flex flex-col items-center gap-1",children:[e.jsx(Kt,{className:"w-4 h-4"}),"Homework"]}),e.jsxs("button",{onClick:()=>t(`/teacher/grading?class=${Z.id}`),className:"btn bg-blue-100 text-blue-700 hover:bg-blue-200 text-xs py-2 flex flex-col items-center gap-1",children:[e.jsx(Is,{className:"w-4 h-4"}),"Grading"]}),e.jsxs("button",{onClick:()=>t(`/teacher/reports?class=${Z.id}`),className:"btn bg-gray-100 text-gray-700 hover:bg-gray-200 text-xs py-2 flex flex-col items-center gap-1",children:[e.jsx(Fs,{className:"w-4 h-4"}),"Reports"]})]})]})]},Z.id)})}),re.length===0&&e.jsxs("div",{className:"card p-12 text-center",children:[e.jsx(as,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),a.length===0?e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Classes Assigned"}),e.jsx("p",{className:"text-gray-500",children:"You haven't been assigned to any classes yet."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Contact your administrator to get assigned to classes."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Matching Classes"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your search or filters."}),e.jsx("button",{onClick:()=>{g(""),f("all"),v("all")},className:"btn btn-primary mt-4",children:"Clear Filters"})]})]})]})}function hL(){const[t]=ax(),s=la(),{user:a}=Us(),r=t.get("class"),l=t.get("all")==="true",[c,o]=h.useState([]),[m,u]=h.useState([]),[x,A]=h.useState(null),[g,N]=h.useState(!0),[f,y]=h.useState(""),[v,U]=h.useState(null),[D,M]=h.useState(!1);h.useEffect(()=>{K()},[r,l]);const K=async()=>{try{N(!0);const R=(await F.get(`https://eea.mcaforo.com/backend/api/teachers.php?user_id=${a.id}`)).data.teachers||[];if(R.length===0){console.error("No teacher record found"),N(!1);return}const j=R[0].id;if(l){const Q=(await F.get(`https://eea.mcaforo.com/backend/api/classes.php?teacher_id=${j}`)).data.classes||[];u(Q);const E=[];for(const te of Q){const O=((await F.get(`https://eea.mcaforo.com/backend/api/students.php?class_id=${te.id}`)).data.students||[]).map(V=>({...V,class_name:te.class_name}));E.push(...O)}o(E)}else if(r){const T=await F.get(`https://eea.mcaforo.com/backend/api/classes.php?id=${r}`);A(T.data.class);const Q=await F.get(`https://eea.mcaforo.com/backend/api/students.php?class_id=${r}`);o(Q.data.students||[])}}catch(z){console.error("Error fetching data:",z)}finally{N(!1)}},$=c.filter(z=>{const R=f.toLowerCase();return z.first_name?.toLowerCase().includes(R)||z.last_name?.toLowerCase().includes(R)||z.student_id?.toLowerCase().includes(R)||z.email?.toLowerCase().includes(R)}),P=z=>{const R={active:"bg-green-100 text-green-700",inactive:"bg-gray-100 text-gray-700",graduated:"bg-blue-100 text-blue-700",transferred:"bg-orange-100 text-orange-700"};return R[z]||R.active},se=z=>{U(z),M(!0)};return g?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>s(l?"/teacher/dashboard":"/teacher/classes"),className:"btn bg-gray-200 hover:bg-gray-300",children:e.jsx(ol,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:l?"All My Students":`${x?.class_name} Students`}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[c.length," student",c.length!==1?"s":""," ",l?"across all classes":"enrolled"]})]})]})}),x&&!l&&e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"grid grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Class Code"}),e.jsx("p",{className:"font-semibold text-gray-900",children:x.class_code})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Level"}),e.jsx("p",{className:"font-semibold text-gray-900",children:x.level?.toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Room"}),e.jsx("p",{className:"font-semibold text-gray-900",children:x.room_number||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Capacity"}),e.jsxs("p",{className:"font-semibold text-gray-900",children:[c.length," / ",x.capacity]})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsx("input",{type:"text",placeholder:"Search students by name, ID, or email...",value:f,onChange:z=>y(z.target.value),className:"input w-full"})}),$.length===0?e.jsxs("div",{className:"card p-12 text-center",children:[e.jsx(Rt,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:f?"No students found matching your search":"No students enrolled in this class yet"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:$.map(z=>e.jsxs("div",{className:"card p-6 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[z.photo?e.jsx("img",{src:`${xb}/${z.photo.replace(/^\//,"")}`,alt:`${z.first_name} ${z.last_name}`,className:"w-16 h-16 rounded-full object-cover"}):e.jsx("div",{className:"w-16 h-16 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsxs("span",{className:"text-2xl font-bold text-blue-600",children:[z.first_name?.[0],z.last_name?.[0]]})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900",children:[z.first_name," ",z.last_name]}),e.jsx("p",{className:"text-sm text-gray-600",children:z.student_id})]})]}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${P(z.status)}`,children:z.status})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(Ot,{className:"w-4 h-4"}),e.jsx("span",{children:z.date_of_birth?new Date(z.date_of_birth).toLocaleDateString():"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Gender:"}),e.jsx("span",{children:z.gender||"N/A"})]}),z.email&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(ra,{className:"w-4 h-4"}),e.jsx("span",{className:"truncate",children:z.email})]}),z.phone&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(er,{className:"w-4 h-4"}),e.jsx("span",{children:z.phone})]}),z.city&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(Qn,{className:"w-4 h-4"}),e.jsxs("span",{children:[z.city,", ",z.region]})]})]}),z.guardian_name&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Guardian"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:z.guardian_name}),z.guardian_phone&&e.jsx("p",{className:"text-xs text-gray-600",children:z.guardian_phone})]}),e.jsxs("button",{onClick:()=>se(z),className:"mt-4 w-full btn btn-primary flex items-center justify-center gap-2",children:[e.jsx(na,{className:"w-4 h-4"}),"View Full Details"]})]},z.id))}),D&&v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between sticky top-0 bg-white",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Student Details"}),e.jsx("button",{onClick:()=>M(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start gap-6 pb-6 border-b",children:[v.photo?e.jsx("img",{src:`${xb}/${v.photo.replace(/^\//,"")}`,alt:`${v.first_name} ${v.last_name}`,className:"w-32 h-32 rounded-full object-cover"}):e.jsx("div",{className:"w-32 h-32 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsxs("span",{className:"text-5xl font-bold text-blue-600",children:[v.first_name?.[0],v.last_name?.[0]]})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-2xl font-bold text-gray-900",children:[v.first_name," ",v.last_name]}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Student ID: ",v.student_id]}),v.class_name&&e.jsxs("p",{className:"text-gray-600",children:["Class: ",v.class_name]})]}),e.jsx("span",{className:`px-3 py-1 text-sm font-medium rounded-full ${P(v.status)}`,children:v.status})]})})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(ha,{className:"w-5 h-5 text-blue-600"}),"Personal Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Date of Birth"}),e.jsx("p",{className:"font-medium text-gray-900",children:v.date_of_birth?new Date(v.date_of_birth).toLocaleDateString():"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Age"}),e.jsx("p",{className:"font-medium text-gray-900",children:v.date_of_birth?Math.floor((new Date-new Date(v.date_of_birth))/(365.25*24*60*60*1e3))+" years":"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Gender"}),e.jsx("p",{className:"font-medium text-gray-900",children:v.gender||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Nationality"}),e.jsx("p",{className:"font-medium text-gray-900",children:v.nationality||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Religion"}),e.jsx("p",{className:"font-medium text-gray-900",children:v.religion||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Blood Group"}),e.jsx("p",{className:"font-medium text-gray-900",children:v.blood_group||"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(er,{className:"w-5 h-5 text-green-600"}),"Contact Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Email"}),e.jsx("p",{className:"font-medium text-gray-900",children:v.email||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Phone"}),e.jsx("p",{className:"font-medium text-gray-900",children:v.phone||"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(Lh,{className:"w-5 h-5 text-purple-600"}),"Address Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Street Address"}),e.jsx("p",{className:"font-medium text-gray-900",children:v.address||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"City"}),e.jsx("p",{className:"font-medium text-gray-900",children:v.city||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Region"}),e.jsx("p",{className:"font-medium text-gray-900",children:v.region||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Country"}),e.jsx("p",{className:"font-medium text-gray-900",children:v.country||"Ghana"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Postal Code"}),e.jsx("p",{className:"font-medium text-gray-900",children:v.postal_code||"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(Rt,{className:"w-5 h-5 text-orange-600"}),"Guardian Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Guardian Name"}),e.jsx("p",{className:"font-medium text-gray-900",children:v.guardian_name||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Relationship"}),e.jsx("p",{className:"font-medium text-gray-900",children:v.guardian_relationship||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Guardian Phone"}),e.jsx("p",{className:"font-medium text-gray-900",children:v.guardian_phone||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Guardian Email"}),e.jsx("p",{className:"font-medium text-gray-900",children:v.guardian_email||"N/A"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Guardian Address"}),e.jsx("p",{className:"font-medium text-gray-900",children:v.guardian_address||"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(Kt,{className:"w-5 h-5 text-indigo-600"}),"Academic Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Admission Date"}),e.jsx("p",{className:"font-medium text-gray-900",children:v.admission_date?new Date(v.admission_date).toLocaleDateString():"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Previous School"}),e.jsx("p",{className:"font-medium text-gray-900",children:v.previous_school||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Medical Conditions"}),e.jsx("p",{className:"font-medium text-gray-900",children:v.medical_conditions||"None"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Allergies"}),e.jsx("p",{className:"font-medium text-gray-900",children:v.allergies||"None"})]})]})]})]}),e.jsx("div",{className:"p-6 border-t bg-gray-50 flex justify-end gap-3",children:e.jsx("button",{onClick:()=>M(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:"Close"})})]})})]})}function pL(){la();const[t]=ax(),{user:s}=Us(),[a,r]=h.useState([]),[l,c]=h.useState([]),[o,m]=h.useState(t.get("class")||""),[u,x]=h.useState(new Date().toISOString().split("T")[0]),[A,g]=h.useState({}),[N,f]=h.useState({}),[y,v]=h.useState(null),[U,D]=h.useState(null),[M,K]=h.useState(!0),[$,P]=h.useState(!1),[se,z]=h.useState(!1),[R,j]=h.useState(!1),[T,Q]=h.useState(""),[E,te]=h.useState([]),[C,O]=h.useState("mark"),[V,re]=h.useState([]),[ge,xe]=h.useState([]),[Z,I]=h.useState(null);h.useEffect(()=>{const we=fe=>{R&&(fe.preventDefault(),fe.returnValue="")};return window.addEventListener("beforeunload",we),()=>window.removeEventListener("beforeunload",we)},[R]),h.useEffect(()=>{H()},[]),h.useEffect(()=>{o&&(ae(),k(),C==="history"&&B(),C==="trends"&&w())},[o,u,C]);const H=async()=>{try{K(!0);try{const ie=await F.get(`${ee}/terms.php?current=true`);ie.data.term?D(ie.data.term):ie.data.terms?.length>0&&D(ie.data.terms[0])}catch(ie){console.error("Could not fetch current term:",ie)}const fe=(await F.get(`${ee}/teachers.php?user_id=${s?.id}`)).data.teachers||[];if(fe.length===0){console.error("No teacher record found for this user"),K(!1);return}const ye=fe[0];I(ye);const Ke=await F.get(`${ee}/classes.php?teacher_id=${ye.id}`);r(Ke.data.classes||[]);const ve=t.get("class");ve&&m(ve)}catch(we){console.error("Error fetching initial data:",we)}finally{K(!1)}},ae=async()=>{try{const fe=(await F.get(`${ee}/students.php?class_id=${o}`)).data.students||[];c(fe);const ye={},Ke={};fe.forEach(ve=>{ye[ve.id]={status:"present",time_in:"07:45"},Ke[ve.id]=""}),g(ye),f(Ke)}catch(we){console.error("Error fetching students:",we)}},k=async()=>{try{const[we,fe]=await Promise.all([F.get(`${ee}/attendance.php?class_id=${o}&date=${u}`),F.get(`${ee}/attendance.php?action=stats&class_id=${o}&date=${u}`)]),ye=we.data.attendance||[],Ke={},ve={};ye.forEach(ie=>{Ke[ie.student_id]={status:ie.status,time_in:ie.time_in||"07:45"},ve[ie.student_id]=ie.notes||""}),ye.length>0&&(g(ie=>({...ie,...Ke})),f(ie=>({...ie,...ve}))),v(fe.data.stats||fe.data),z(ye.length>0),j(!1)}catch(we){console.error("Error fetching attendance:",we)}},B=async()=>{try{const we=await F.get(`${ee}/attendance.php?action=history&class_id=${o}&limit=30`);xe(we.data.history||we.data.attendance||[])}catch(we){console.error("Error fetching history:",we)}},w=async()=>{try{const we=[];for(let ye=6;ye>=0;ye--){const Ke=new Date;Ke.setDate(Ke.getDate()-ye),we.push(Ke.toISOString().split("T")[0])}const fe=[];for(const ye of we)try{const Ke=await F.get(`${ee}/attendance.php?action=stats&class_id=${o}&date=${ye}`),ve=Ke.data.stats||Ke.data;fe.push({date:ye,day:new Date(ye).toLocaleDateString("en-US",{weekday:"short"}),present:ve.present||0,absent:ve.absent||0,late:ve.late||0,total:ve.total||0,rate:ve.total>0?Math.round(ve.present/ve.total*100):0})}catch{fe.push({date:ye,day:new Date(ye).toLocaleDateString("en-US",{weekday:"short"}),present:0,absent:0,late:0,total:0,rate:0})}re(fe)}catch(we){console.error("Error fetching weekly trends:",we)}},oe=(we,fe)=>{g(ye=>({...ye,[we]:{...ye[we],status:fe}})),j(!0),z(!1)},ne=(we,fe)=>{g(ye=>({...ye,[we]:{...ye[we],time_in:fe}})),j(!0),z(!1)},Fe=(we,fe)=>{f(ye=>({...ye,[we]:fe})),j(!0),z(!1)},je=we=>{const fe={};(E.length>0?E:l.map(Ke=>Ke.id)).forEach(Ke=>{fe[Ke]={status:we,time_in:we==="present"?"07:45":null}}),g(Ke=>({...Ke,...fe})),j(!0),z(!1),te([])},Ge=we=>{te(fe=>fe.includes(we)?fe.filter(ye=>ye!==we):[...fe,we])},ze=()=>{E.length===le.length?te([]):te(le.map(we=>we.id))},Xe=async()=>{if(!o){alert("Please select a class");return}if(!l||l.length===0){alert("No students found in this class. Please select a class with students.");return}try{P(!0);const we=l.map(fe=>({student_id:parseInt(fe.id),status:A[fe.id]?.status||"present",time_in:A[fe.id]?.time_in||null,notes:N[fe.id]||null}));console.log("Submitting attendance:",{class_id:o,students:we}),await F.post(`${ee}/attendance.php?action=mark_class`,{class_id:o,term_id:U?.id||1,date:u,students:we,marked_by:s?.id}),z(!0),j(!1),alert("Attendance marked successfully!"),k()}catch(we){console.error("Error marking attendance:",we),alert("Failed to mark attendance: "+(we.response?.data?.error||we.message))}finally{P(!1)}},st=()=>{const we=a.find(ie=>ie.id==o)?.class_name||"Class",fe=[["#","Student ID","Name","Status","Time In","Notes"],...l.map((ie,q)=>[q+1,ie.student_id,`${ie.first_name} ${ie.last_name}`,A[ie.id]?.status||"present",A[ie.id]?.time_in||"",N[ie.id]||""])].map(ie=>ie.join(",")).join(`
`),ye=new Blob([fe],{type:"text/csv"}),Ke=URL.createObjectURL(ye),ve=document.createElement("a");ve.href=Ke,ve.download=`attendance_${we}_${u}.csv`,ve.click(),URL.revokeObjectURL(Ke)},ce=we=>{const fe=new Date(u);fe.setDate(fe.getDate()+we),x(fe.toISOString().split("T")[0])},_e=we=>{const fe={present:"bg-green-100 text-green-700 border-green-300",absent:"bg-red-100 text-red-700 border-red-300",late:"bg-orange-100 text-orange-700 border-orange-300",excused:"bg-blue-100 text-blue-700 border-blue-300"};return fe[we]||fe.present},le=l.filter(we=>`${we.first_name} ${we.last_name}`.toLowerCase().includes(T.toLowerCase())||we.student_id?.toLowerCase().includes(T.toLowerCase())),Pe={total:l.length,present:Object.values(A).filter(we=>we.status==="present").length,absent:Object.values(A).filter(we=>we.status==="absent").length,late:Object.values(A).filter(we=>we.status==="late").length,excused:Object.values(A).filter(we=>we.status==="excused").length};return M?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(hs,{className:"w-12 h-12 text-blue-600 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading attendance..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Mt,{className:"text-green-600"}),"Mark Attendance"]}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[U?`${U.term_name}  `:"","Record daily attendance for your classes"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[R&&e.jsxs("span",{className:"flex items-center gap-1 text-orange-600 text-sm",children:[e.jsx(_s,{className:"w-4 h-4"}),"Unsaved changes"]}),se&&!R&&e.jsxs("span",{className:"flex items-center gap-1 text-green-600 text-sm",children:[e.jsx(Mt,{className:"w-4 h-4"}),"Saved"]})]})]}),e.jsx("div",{className:"border-b",children:e.jsx("div",{className:"flex gap-4",children:[{id:"mark",label:"Mark Attendance",icon:Mt},{id:"history",label:"History",icon:Sa},{id:"trends",label:"Trends",icon:$s}].map(we=>e.jsxs("button",{onClick:()=>O(we.id),className:`flex items-center gap-2 px-4 py-3 border-b-2 font-medium transition-colors ${C===we.id?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(we.icon,{className:"w-4 h-4"}),we.label]},we.id))})}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Class *"}),e.jsxs("select",{value:o,onChange:we=>m(we.target.value),className:"input",children:[e.jsx("option",{value:"",children:"Choose a class"}),a.map(we=>e.jsx("option",{value:we.id,children:we.class_name},we.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date *"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>ce(-1),className:"p-2 hover:bg-gray-100 rounded",children:e.jsx(Kd,{className:"w-5 h-5"})}),e.jsx("input",{type:"date",value:u,onChange:we=>x(we.target.value),className:"input flex-1"}),e.jsx("button",{onClick:()=>ce(1),className:"p-2 hover:bg-gray-100 rounded",children:e.jsx(cr,{className:"w-5 h-5"})})]})]}),e.jsx("div",{className:"flex items-end gap-2",children:e.jsxs("button",{onClick:st,disabled:!o,className:"btn bg-gray-100 hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(xs,{className:"w-4 h-4"}),"Export"]})}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{onClick:Xe,disabled:!o||$,className:"btn btn-primary w-full disabled:opacity-50 flex items-center justify-center gap-2",children:[e.jsx(Br,{className:"w-5 h-5"}),$?"Saving...":"Save"]})})]}),o&&C==="mark"&&e.jsxs("div",{className:"mt-4 pt-4 border-t flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Quick Mark",E.length>0?` (${E.length} selected)`:"",":"]}),e.jsx("button",{onClick:()=>je("present"),className:"btn bg-green-100 text-green-700 hover:bg-green-200 text-sm",children:"All Present"}),e.jsx("button",{onClick:()=>je("absent"),className:"btn bg-red-100 text-red-700 hover:bg-red-200 text-sm",children:"All Absent"}),e.jsx("button",{onClick:()=>je("late"),className:"btn bg-orange-100 text-orange-700 hover:bg-orange-200 text-sm",children:"All Late"})]}),e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search students...",value:T,onChange:we=>Q(we.target.value),className:"input pl-9 w-64"})]})]})]}),o&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Rt,{className:"w-8 h-8 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total"}),e.jsx("p",{className:"text-2xl font-bold",children:Pe.total})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Mt,{className:"w-8 h-8 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Present"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:Pe.present})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Js,{className:"w-8 h-8 text-red-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Absent"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:Pe.absent})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Wt,{className:"w-8 h-8 text-orange-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Late"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:Pe.late})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${Pe.total>0&&Pe.present/Pe.total>=.9?"bg-green-100":Pe.total>0&&Pe.present/Pe.total>=.7?"bg-yellow-100":"bg-red-100"}`,children:e.jsxs("span",{className:`text-lg font-bold ${Pe.total>0&&Pe.present/Pe.total>=.9?"text-green-600":Pe.total>0&&Pe.present/Pe.total>=.7?"text-yellow-600":"text-red-600"}`,children:[Pe.total>0?Math.round(Pe.present/Pe.total*100):0,"%"]})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Rate"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Attendance"})]})]})})]}),C==="mark"&&o&&le.length>0&&e.jsx("div",{className:"card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left",children:e.jsxs("button",{onClick:ze,className:"flex items-center gap-2 text-xs font-medium text-gray-500 uppercase",children:[E.length===le.length?e.jsx(XA,{className:"w-4 h-4 text-blue-600"}):e.jsx(db,{className:"w-4 h-4"}),"#"]})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Student"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Time In"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Notes"})]})}),e.jsx("tbody",{className:"divide-y",children:le.map((we,fe)=>e.jsxs("tr",{className:`hover:bg-gray-50 ${E.includes(we.id)?"bg-blue-50":""}`,children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("button",{onClick:()=>Ge(we.id),className:"flex items-center gap-2 text-sm text-gray-600",children:[E.includes(we.id)?e.jsx(XA,{className:"w-4 h-4 text-blue-600"}):e.jsx(db,{className:"w-4 h-4"}),fe+1]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${A[we.id]?.status==="present"?"bg-green-100":A[we.id]?.status==="absent"?"bg-red-100":A[we.id]?.status==="late"?"bg-orange-100":"bg-blue-100"}`,children:e.jsxs("span",{className:`font-semibold text-sm ${A[we.id]?.status==="present"?"text-green-600":A[we.id]?.status==="absent"?"text-red-600":A[we.id]?.status==="late"?"text-orange-600":"text-blue-600"}`,children:[we.first_name?.charAt(0),we.last_name?.charAt(0)]})}),e.jsxs("p",{className:"font-medium text-gray-900",children:[we.first_name," ",we.last_name]})]})}),e.jsx("td",{className:"px-4 py-3 font-mono text-sm text-gray-600",children:we.student_id}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"flex gap-1",children:["present","absent","late","excused"].map(ye=>e.jsx("button",{onClick:()=>oe(we.id,ye),className:`px-2 py-1 text-xs font-medium rounded-full border-2 transition-all ${A[we.id]?.status===ye?_e(ye):"bg-gray-50 text-gray-500 border-gray-200 hover:bg-gray-100"}`,children:ye.charAt(0).toUpperCase()},ye))})}),e.jsx("td",{className:"px-4 py-3",children:A[we.id]?.status!=="absent"&&e.jsx("input",{type:"time",value:A[we.id]?.time_in||"07:45",onChange:ye=>ne(we.id,ye.target.value),className:"input w-28 text-sm"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"text",placeholder:"Add note...",value:N[we.id]||"",onChange:ye=>Fe(we.id,ye.target.value),className:"input w-32 text-sm"})})]},we.id))})]})})}),C==="history"&&o&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsx("h3",{className:"font-semibold text-gray-900",children:"Attendance History (Last 30 Days)"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Present"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Absent"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Late"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Rate"})]})}),e.jsx("tbody",{className:"divide-y",children:ge.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-4 py-8 text-center text-gray-500",children:"No attendance history found"})}):ge.map((we,fe)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:new Date(we.date).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3",children:we.total||0}),e.jsx("td",{className:"px-4 py-3 text-green-600",children:we.present||0}),e.jsx("td",{className:"px-4 py-3 text-red-600",children:we.absent||0}),e.jsx("td",{className:"px-4 py-3 text-orange-600",children:we.late||0}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${we.rate>=90?"bg-green-100 text-green-700":we.rate>=70?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:[we.rate||0,"%"]})})]},fe))})]})})]}),C==="trends"&&o&&e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Weekly Attendance Trends"}),e.jsx("div",{className:"grid grid-cols-7 gap-2",children:V.map((we,fe)=>e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:we.day}),e.jsx("div",{className:"h-32 bg-gray-100 rounded-lg relative overflow-hidden",children:we.total>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-green-500 transition-all",style:{height:`${we.present/we.total*100}%`}}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-orange-500 transition-all",style:{height:`${we.late/we.total*100}%`,bottom:`${we.present/we.total*100}%`}})]})}),e.jsxs("p",{className:`text-sm font-bold mt-2 ${we.rate>=90?"text-green-600":we.rate>=70?"text-yellow-600":"text-red-600"}`,children:[we.rate,"%"]}),e.jsx("p",{className:"text-xs text-gray-400",children:new Date(we.date).getDate()})]},fe))}),e.jsxs("div",{className:"flex items-center justify-center gap-6 mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Present"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Late"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-gray-300 rounded"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Absent"})]})]})]}),C==="mark"&&o&&le.length===0&&e.jsxs("div",{className:"card p-12 text-center",children:[e.jsx(Rt,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),l.length===0?e.jsx("p",{className:"text-gray-500",children:"No students found in this class"}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-500",children:"No students match your search"}),e.jsx("button",{onClick:()=>Q(""),className:"btn btn-primary mt-4",children:"Clear Search"})]})]}),!o&&e.jsxs("div",{className:"card p-12 text-center",children:[e.jsx(Ot,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"Select a class to mark attendance"})]})]})}function AL(){const[t]=ax(),{user:s}=Us(),[a,r]=h.useState([]),[l,c]=h.useState([]),[o,m]=h.useState([]),[u,x]=h.useState(null),[A,g]=h.useState(null),[N,f]=h.useState(!1),[y,v]=h.useState(!1),[U,D]=h.useState(!1),[M,K]=h.useState(null),[$,P]=h.useState([]),[se,z]=h.useState(!1),[R,j]=h.useState(!0),[T,Q]=h.useState(!1),[E,te]=h.useState(""),[C,O]=h.useState(t.get("class")||"all"),[V,re]=h.useState("all"),[ge,xe]=h.useState("all"),[Z,I]=h.useState(!1),[H,ae]=h.useState({}),[k,B]=h.useState({class_id:t.get("class")||"",subject_id:"",term_id:"",teacher_id:"",title:"",description:"",due_date:"",total_marks:100,status:"active",attachment_url:""});h.useEffect(()=>{w()},[]);const w=async()=>{try{j(!0);try{const Me=await F.get(`${ee}/terms.php?current=true`);Me.data.term?x(Me.data.term):Me.data.terms?.length>0&&x(Me.data.terms[0])}catch(Me){console.error("Could not fetch current term:",Me)}const ye=(await F.get(`${ee}/teachers.php?user_id=${s?.id}`)).data.teachers||[];if(ye.length===0){console.error("No teacher record found for this user"),j(!1);return}const Ke=ye[0];g(Ke);const[ve,ie,q]=await Promise.all([F.get(`${ee}/academic.php?resource=homework&teacher_id=${Ke.id}`),F.get(`${ee}/classes.php?teacher_id=${Ke.id}`),F.get(`${ee}/subjects.php`)]);r(ve.data.homework||[]),c(ie.data.classes||[]),m(q.data.subjects||[]);const pe=t.get("class");pe&&O(pe)}catch(fe){console.error("Error fetching data:",fe)}finally{j(!1)}},oe=()=>{B({class_id:C!=="all"?C:"",subject_id:"",term_id:u?.id||"",teacher_id:A?.id||"",title:"",description:"",due_date:"",total_marks:100,status:"active",attachment_url:""}),z(!1)},ne=async fe=>{fe.preventDefault();try{Q(!0);const ye={...k,term_id:u?.id||1,teacher_id:A?.id||s?.id};se&&M?(await F.put(`${ee}/academic.php?resource=homework&id=${M.id}`,ye),alert("Homework updated successfully!")):(await F.post(`${ee}/academic.php?resource=homework`,ye),alert("Homework assigned successfully!")),f(!1),oe(),w()}catch(ye){alert("Error saving homework: "+(ye.response?.data?.error||ye.message))}finally{Q(!1)}},Fe=fe=>{B({class_id:fe.class_id,subject_id:fe.subject_id,term_id:fe.term_id,teacher_id:fe.teacher_id,title:fe.title,description:fe.description,due_date:fe.due_date,total_marks:fe.total_marks,status:fe.status,attachment_url:fe.attachment_url||""}),K(fe),z(!0),f(!0)},je=async()=>{if(M)try{await F.delete(`${ee}/academic.php?resource=homework&id=${M.id}`),alert("Homework deleted successfully!"),D(!1),K(null),w()}catch(fe){alert("Error deleting homework: "+(fe.response?.data?.error||fe.message))}},Ge=fe=>{B({class_id:fe.class_id,subject_id:fe.subject_id,term_id:u?.id||fe.term_id,teacher_id:A?.id||fe.teacher_id,title:`${fe.title} (Copy)`,description:fe.description,due_date:"",total_marks:fe.total_marks,status:"active",attachment_url:fe.attachment_url||""}),z(!1),f(!0)},ze=async fe=>{try{j(!0);const ye=await F.get(`${ee}/academic.php?resource=homework&id=${fe.id}`);K(ye.data.homework),P(ye.data.homework?.submissions||[]),ae({}),v(!0)}catch{alert("Error loading submissions")}finally{j(!1)}},Xe=async(fe,ye,Ke)=>{try{await F.post(`${ee}/academic.php?resource=homework_submissions&action=grade&id=${fe}`,{marks_obtained:ye,feedback:Ke,graded_by:s?.id}),alert("Submission graded successfully!"),ze(M)}catch{alert("Error grading submission")}},st=async()=>{try{Q(!0);const fe=Object.entries(H).filter(([ye,Ke])=>Ke.marks);for(const[ye,Ke]of fe)await F.post(`${ee}/academic.php?resource=homework_submissions&action=grade&id=${ye}`,{marks_obtained:Ke.marks,feedback:Ke.feedback||"",graded_by:s?.id});alert(`${fe.length} submissions graded successfully!`),I(!1),ae({}),ze(M)}catch{alert("Error grading submissions")}finally{Q(!1)}},ce=fe=>{const ye={active:"bg-green-100 text-green-700",closed:"bg-gray-100 text-gray-700",cancelled:"bg-red-100 text-red-700"};return ye[fe]||ye.active},_e=fe=>{const ye={pending:"bg-orange-100 text-orange-700",submitted:"bg-blue-100 text-blue-700",late:"bg-red-100 text-red-700",graded:"bg-green-100 text-green-700"};return ye[fe]||ye.pending},le=fe=>{const ye=new Date,Ke=new Date(fe),ve=Math.ceil((Ke-ye)/(1e3*60*60*24));return ve<0?{text:"Overdue",class:"text-red-600 bg-red-50",icon:_s}:ve===0?{text:"Due Today",class:"text-orange-600 bg-orange-50",icon:Wt}:ve<=3?{text:`${ve} days left`,class:"text-yellow-600 bg-yellow-50",icon:Wt}:{text:new Date(fe).toLocaleDateString(),class:"text-gray-600",icon:Ot}},Pe=a.filter(fe=>{const ye=fe.title?.toLowerCase().includes(E.toLowerCase())||fe.class_name?.toLowerCase().includes(E.toLowerCase())||fe.subject_name?.toLowerCase().includes(E.toLowerCase()),Ke=C==="all"||fe.class_id==C,ve=V==="all"||fe.subject_id==V,ie=ge==="all"||fe.status===ge;return ye&&Ke&&ve&&ie}),we={total:a.length,active:a.filter(fe=>fe.status==="active").length,totalSubmissions:a.reduce((fe,ye)=>fe+(ye.submission_count||0),0),pendingReview:a.reduce((fe,ye)=>fe+(ye.pending_count||ye.submission_count||0),0),overdue:a.filter(fe=>fe.status==="active"&&new Date(fe.due_date)<new Date).length};return R&&a.length===0?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(hs,{className:"w-12 h-12 text-blue-600 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading homework..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Kt,{className:"text-blue-600"}),"My Homework"]}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[u?`${u.term_name}  `:"","Assign and grade homework for your classes"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:w,className:"btn bg-gray-100 hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ns,{className:"w-4 h-4"}),"Refresh"]}),e.jsxs("button",{onClick:()=>{oe(),f(!0)},className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-5 h-5"}),"Assign Homework"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Kt,{className:"w-8 h-8 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:we.total}),e.jsx("p",{className:"text-xs text-gray-500",children:"Total"})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Mt,{className:"w-8 h-8 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:we.active}),e.jsx("p",{className:"text-xs text-gray-500",children:"Active"})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Rt,{className:"w-8 h-8 text-purple-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:we.totalSubmissions}),e.jsx("p",{className:"text-xs text-gray-500",children:"Submissions"})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(na,{className:"w-8 h-8 text-orange-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:we.pendingReview}),e.jsx("p",{className:"text-xs text-gray-500",children:"Pending Review"})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_s,{className:"w-8 h-8 text-red-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-red-600",children:we.overdue}),e.jsx("p",{className:"text-xs text-gray-500",children:"Overdue"})]})]})})]}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search homework...",value:E,onChange:fe=>te(fe.target.value),className:"input pl-10 w-full"})]}),e.jsxs("select",{value:C,onChange:fe=>O(fe.target.value),className:"input w-full md:w-40",children:[e.jsx("option",{value:"all",children:"All Classes"}),l.map(fe=>e.jsx("option",{value:fe.id,children:fe.class_name},fe.id))]}),e.jsxs("select",{value:V,onChange:fe=>re(fe.target.value),className:"input w-full md:w-40",children:[e.jsx("option",{value:"all",children:"All Subjects"}),o.map(fe=>e.jsx("option",{value:fe.id,children:fe.subject_name},fe.id))]}),e.jsxs("select",{value:ge,onChange:fe=>xe(fe.target.value),className:"input w-full md:w-32",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"closed",children:"Closed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})}),e.jsx("div",{className:"card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Title"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Class"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Subject"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Due Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Progress"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:Pe.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:"7",className:"px-4 py-12 text-center text-gray-500",children:[e.jsx(Kt,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No homework found"}),E||C!=="all"||V!=="all"||ge!=="all"?e.jsx("button",{onClick:()=>{te(""),O("all"),re("all"),xe("all")},className:"btn btn-primary mt-4",children:"Clear Filters"}):null]})}):Pe.map(fe=>{const ye=le(fe.due_date),Ke=ye.icon,ve=fe.student_count>0?Math.round((fe.submission_count||0)/fe.student_count*100):0;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-4 py-4",children:[e.jsx("p",{className:"font-medium text-gray-900",children:fe.title}),e.jsxs("p",{className:"text-xs text-gray-500",children:[fe.total_marks," marks"]})]}),e.jsx("td",{className:"px-4 py-4 text-sm",children:fe.class_name}),e.jsx("td",{className:"px-4 py-4 text-sm",children:fe.subject_name}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded text-xs font-medium ${ye.class}`,children:[e.jsx(Ke,{className:"w-3 h-3"}),ye.text]})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"w-24",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[e.jsxs("span",{children:[fe.submission_count||0,"/",fe.student_count||"?"]}),e.jsxs("span",{className:"text-gray-500",children:[ve,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${ve>=80?"bg-green-500":ve>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${ve}%`}})})]})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${ce(fe.status)}`,children:fe.status})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>ze(fe),className:"p-2 text-blue-600 hover:bg-blue-50 rounded",title:"Review Submissions",children:e.jsx(na,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Fe(fe),className:"p-2 text-gray-600 hover:bg-gray-100 rounded",title:"Edit",children:e.jsx(ll,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Ge(fe),className:"p-2 text-gray-600 hover:bg-gray-100 rounded",title:"Duplicate",children:e.jsx(vl,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{K(fe),D(!0)},className:"p-2 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:e.jsx(us,{className:"w-4 h-4"})})]})})]},fe.id)})})]})})}),N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between sticky top-0 bg-white",children:[e.jsx("h2",{className:"text-xl font-semibold",children:se?"Edit Homework":"Assign Homework"}),e.jsx("button",{onClick:()=>{f(!1),oe()},children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:ne,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Class *"}),e.jsxs("select",{required:!0,value:k.class_id,onChange:fe=>B({...k,class_id:fe.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select Class"}),l.map(fe=>e.jsx("option",{value:fe.id,children:fe.class_name},fe.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Subject *"}),e.jsxs("select",{required:!0,value:k.subject_id,onChange:fe=>B({...k,subject_id:fe.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select Subject"}),o.map(fe=>e.jsx("option",{value:fe.id,children:fe.subject_name},fe.id))]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Title *"}),e.jsx("input",{type:"text",required:!0,value:k.title,onChange:fe=>B({...k,title:fe.target.value}),className:"input",placeholder:"e.g., Chapter 3 Exercises"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description *"}),e.jsx("textarea",{required:!0,value:k.description,onChange:fe=>B({...k,description:fe.target.value}),className:"input",rows:"4",placeholder:"Provide detailed instructions..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Due Date *"}),e.jsx("input",{type:"date",required:!0,value:k.due_date,onChange:fe=>B({...k,due_date:fe.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Total Marks"}),e.jsx("input",{type:"number",value:k.total_marks,onChange:fe=>B({...k,total_marks:fe.target.value}),className:"input"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Attachment URL (optional)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:k.attachment_url,onChange:fe=>B({...k,attachment_url:fe.target.value}),className:"input flex-1",placeholder:"https://..."}),e.jsxs("button",{type:"button",className:"btn bg-gray-100 hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Hr,{className:"w-4 h-4"}),"Upload"]})]})]}),se&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Status"}),e.jsxs("select",{value:k.status,onChange:fe=>B({...k,status:fe.target.value}),className:"input",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"closed",children:"Closed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>{f(!1),oe()},className:"btn bg-gray-200",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:T,className:"btn btn-primary flex items-center gap-2",children:[T?e.jsx(hs,{className:"w-4 h-4 animate-spin"}):null,se?"Update Homework":"Assign Homework"]})]})]})]})}),U&&M&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(us,{className:"w-6 h-6 text-red-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Delete Homework?"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:['Are you sure you want to delete "',M.title,'"? This will also delete all submissions.']}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>{D(!1),K(null)},className:"btn bg-gray-200 flex-1",children:"Cancel"}),e.jsx("button",{onClick:je,className:"btn bg-red-600 text-white hover:bg-red-700 flex-1",children:"Delete"})]})]})})}),y&&M&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between sticky top-0 bg-white z-10",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:M.title}),e.jsxs("p",{className:"text-sm text-gray-600",children:[M.class_name," - ",M.subject_name]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Due: ",new Date(M.due_date).toLocaleDateString(),"  ",M.total_marks," marks"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[$.filter(fe=>fe.status==="submitted").length>0&&e.jsx("button",{onClick:()=>I(!Z),className:`btn ${Z?"btn-primary":"bg-gray-100 hover:bg-gray-200"} text-sm`,children:Z?"Cancel Bulk":"Bulk Grade"}),e.jsx("button",{onClick:()=>v(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Description:"}),e.jsx("p",{className:"text-gray-600",children:M.description}),M.attachment_url&&e.jsxs("a",{href:M.attachment_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-blue-600 hover:underline mt-2",children:[e.jsx(xs,{className:"w-4 h-4"})," View Attachment"]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:$.length}),e.jsx("p",{className:"text-xs text-gray-600",children:"Total"})]}),e.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:$.filter(fe=>fe.status==="submitted").length}),e.jsx("p",{className:"text-xs text-gray-600",children:"Pending"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:$.filter(fe=>fe.status==="graded").length}),e.jsx("p",{className:"text-xs text-gray-600",children:"Graded"})]}),e.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-red-600",children:$.filter(fe=>fe.status==="late").length}),e.jsx("p",{className:"text-xs text-gray-600",children:"Late"})]})]}),Z&&$.filter(fe=>fe.status==="submitted").length>0&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-4 flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-blue-700",children:'Enter marks for multiple submissions and click "Save All Grades"'}),e.jsxs("button",{onClick:st,disabled:T,className:"btn btn-primary flex items-center gap-2",children:[T?e.jsx(hs,{className:"w-4 h-4 animate-spin"}):e.jsx(Mt,{className:"w-4 h-4"}),"Save All Grades"]})]}),e.jsxs("h3",{className:"font-semibold mb-4",children:["Submissions (",$.length,"):"]}),$.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(as,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No submissions yet"})]}):e.jsx("div",{className:"space-y-4",children:$.map(fe=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsxs("span",{className:"text-blue-600 font-semibold text-sm",children:[fe.first_name?.charAt(0),fe.last_name?.charAt(0)]})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[fe.first_name," ",fe.last_name]}),e.jsx("p",{className:"text-sm text-gray-500",children:fe.student_id}),e.jsx("p",{className:"text-xs text-gray-400",children:fe.submitted_at?`Submitted: ${new Date(fe.submitted_at).toLocaleString()}`:"Not submitted"})]})]}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${_e(fe.status)}`,children:fe.status})]}),fe.submission_text&&e.jsx("div",{className:"bg-gray-50 p-3 rounded mb-3",children:e.jsx("p",{className:"text-sm",children:fe.submission_text})}),fe.file_url&&e.jsxs("a",{href:fe.file_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-blue-600 hover:underline text-sm mb-3",children:[e.jsx(xs,{className:"w-4 h-4"})," View Submitted File"]}),fe.status==="submitted"&&(Z?e.jsxs("div",{className:"flex gap-2 bg-blue-50 p-3 rounded",children:[e.jsx("input",{type:"number",placeholder:"Marks",max:M.total_marks,className:"input w-24",value:H[fe.id]?.marks||"",onChange:ye=>ae({...H,[fe.id]:{...H[fe.id],marks:ye.target.value}})}),e.jsx("input",{type:"text",placeholder:"Feedback (optional)",className:"input flex-1",value:H[fe.id]?.feedback||"",onChange:ye=>ae({...H,[fe.id]:{...H[fe.id],feedback:ye.target.value}})})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",placeholder:"Marks",max:M.total_marks,className:"input w-24",id:`marks-${fe.id}`}),e.jsx("input",{type:"text",placeholder:"Feedback",className:"input flex-1",id:`feedback-${fe.id}`}),e.jsxs("button",{onClick:()=>{const ye=document.getElementById(`marks-${fe.id}`).value,Ke=document.getElementById(`feedback-${fe.id}`).value;Xe(fe.id,ye,Ke)},className:"btn btn-primary flex items-center gap-1",children:[e.jsx(Mt,{className:"w-4 h-4"}),"Grade"]})]})),fe.status==="graded"&&e.jsxs("div",{className:"bg-green-50 p-3 rounded",children:[e.jsxs("p",{className:"text-sm font-semibold text-green-700",children:["Marks: ",fe.marks_obtained,"/",M.total_marks," (",Math.round(fe.marks_obtained/M.total_marks*100),"%)"]}),fe.feedback&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Feedback: ",fe.feedback]})]})]},fe.id))})]})]})})]})}function gL(){const[t]=ax(),{user:s}=Us(),[a,r]=h.useState([]),[l,c]=h.useState([]),[o,m]=h.useState([]),[u,x]=h.useState(null),[A,g]=h.useState(null),[N,f]=h.useState(!1),[y,v]=h.useState(!1),[U,D]=h.useState(!1),[M,K]=h.useState(null),[$,P]=h.useState([]),[se,z]=h.useState(!1),[R,j]=h.useState(!0),[T,Q]=h.useState(!1),[E,te]=h.useState(""),[C,O]=h.useState(t.get("class")||"all"),[V,re]=h.useState("all"),[ge,xe]=h.useState("all"),[Z,I]=h.useState(""),[H,ae]=h.useState({class_id:t.get("class")||"",subject_id:"",term_id:"",assessment_name:"",assessment_type:"test",total_marks:100,weight_percentage:100,assessment_date:new Date().toISOString().split("T")[0],description:"",created_by:s?.id});h.useEffect(()=>{k()},[]);const k=async()=>{try{j(!0);try{const Ne=await F.get(`${ee}/terms.php?current=true`);Ne.data.term?x(Ne.data.term):Ne.data.terms?.length>0&&x(Ne.data.terms[0])}catch(Ne){console.error("Could not fetch current term:",Ne)}const Ke=(await F.get(`${ee}/teachers.php?user_id=${s?.id}`)).data.teachers||[];if(Ke.length===0){console.error("No teacher record found for this user"),j(!1);return}const ve=Ke[0];g(ve);const[ie,q,pe]=await Promise.all([F.get(`${ee}/academic.php?resource=assessments`),F.get(`${ee}/classes.php?teacher_id=${ve.id}`),F.get(`${ee}/subjects.php`)]),Me=(ie.data.assessments||[]).filter(Ne=>Ne.created_by==s?.id);r(Me),c(q.data.classes||[]),m(pe.data.subjects||[]);const Se=t.get("class");Se&&O(Se)}catch(ye){console.error("Error fetching data:",ye)}finally{j(!1)}},B=()=>{ae({class_id:C!=="all"?C:"",subject_id:"",term_id:u?.id||"",assessment_name:"",assessment_type:"test",total_marks:100,weight_percentage:100,assessment_date:new Date().toISOString().split("T")[0],description:"",created_by:s?.id}),z(!1)},w=async ye=>{ye.preventDefault();try{Q(!0);const Ke={...H,term_id:u?.id||1,created_by:s?.id};se&&M?(await F.put(`${ee}/academic.php?resource=assessments&id=${M.id}`,Ke),alert("Assessment updated successfully!")):(await F.post(`${ee}/academic.php?resource=assessments`,Ke),alert("Assessment created successfully!")),f(!1),B(),k()}catch(Ke){alert("Error saving assessment: "+(Ke.response?.data?.error||Ke.message))}finally{Q(!1)}},oe=ye=>{ae({class_id:ye.class_id,subject_id:ye.subject_id,term_id:ye.term_id,assessment_name:ye.assessment_name,assessment_type:ye.assessment_type,total_marks:ye.total_marks,weight_percentage:ye.weight_percentage,assessment_date:ye.assessment_date,description:ye.description||"",created_by:ye.created_by}),K(ye),z(!0),f(!0)},ne=async()=>{if(M)try{await F.delete(`${ee}/academic.php?resource=assessments&id=${M.id}`),alert("Assessment deleted successfully!"),D(!1),K(null),k()}catch(ye){alert("Error deleting assessment: "+(ye.response?.data?.error||ye.message))}},Fe=ye=>{ae({class_id:ye.class_id,subject_id:ye.subject_id,term_id:u?.id||ye.term_id,assessment_name:`${ye.assessment_name} (Copy)`,assessment_type:ye.assessment_type,total_marks:ye.total_marks,weight_percentage:ye.weight_percentage,assessment_date:new Date().toISOString().split("T")[0],description:ye.description||"",created_by:s?.id}),z(!1),f(!0)},je=async ye=>{try{j(!0);const ve=(await F.get(`${ee}/academic.php?resource=grades&action=by_assessment&assessment_id=${ye.id}`)).data.grades||[],pe=((await F.get(`${ee}/students.php?class_id=${ye.class_id}`)).data.students||[]).map(Me=>{const Se=ve.find(Ne=>Ne.student_id==Me.id);return{student_id:Me.id,first_name:Me.first_name,last_name:Me.last_name,student_id_code:Me.student_id,marks_obtained:Se?.marks_obtained||"",grade:Se?.grade||"",comment:Se?.comment||""}});P(pe),K(ye),I(""),v(!0)}catch{alert("Error loading grades")}finally{j(!1)}},Ge=(ye,Ke,ve)=>{P(ie=>ie.map(q=>q.student_id===ye?{...q,[Ke]:ve}:q))},ze=(ye,Ke)=>{if(!ye||!Ke)return"";const ve=ye/Ke*100;return ve>=80?"A":ve>=70?"B":ve>=60?"C":ve>=50?"D":"F"},Xe=async()=>{try{Q(!0);const ye=$.filter(Ke=>Ke.marks_obtained!=="").map(Ke=>({student_id:Ke.student_id,marks_obtained:Ke.marks_obtained,grade:Ke.grade||ze(Ke.marks_obtained,M.total_marks),comment:Ke.comment||""}));await F.post(`${ee}/academic.php?resource=grades&action=bulk`,{assessment_id:M.id,grades:ye,graded_by:s?.id}),v(!1),alert("Grades saved successfully!"),k()}catch{alert("Error saving grades")}finally{Q(!1)}},st=()=>{if(!M||$.length===0)return;const ye=["Student Name","Student ID","Marks","Grade","Percentage","Comment"],Ke=$.map(Me=>[`${Me.first_name} ${Me.last_name}`,Me.student_id_code,Me.marks_obtained||"N/A",Me.grade||ze(Me.marks_obtained,M.total_marks)||"N/A",Me.marks_obtained?`${Math.round(Me.marks_obtained/M.total_marks*100)}%`:"N/A",Me.comment||""]),ve=[ye,...Ke].map(Me=>Me.join(",")).join(`
`),ie=new Blob([ve],{type:"text/csv"}),q=URL.createObjectURL(ie),pe=document.createElement("a");pe.href=q,pe.download=`${M.assessment_name}_grades.csv`,pe.click()},ce=a.filter(ye=>{const Ke=ye.assessment_name?.toLowerCase().includes(E.toLowerCase())||ye.class_name?.toLowerCase().includes(E.toLowerCase())||ye.subject_name?.toLowerCase().includes(E.toLowerCase()),ve=C==="all"||ye.class_id==C,ie=V==="all"||ye.subject_id==V,q=ge==="all"||ye.assessment_type===ge;return Ke&&ve&&ie&&q}),_e=$.filter(ye=>`${ye.first_name} ${ye.last_name}`.toLowerCase().includes(Z.toLowerCase())||ye.student_id_code?.toLowerCase().includes(Z.toLowerCase())),le={total:a.length,pending:a.filter(ye=>!ye.graded_count||ye.graded_count===0).length,quizzes:a.filter(ye=>ye.assessment_type==="quiz").length,tests:a.filter(ye=>ye.assessment_type==="test").length,exams:a.filter(ye=>ye.assessment_type==="exam").length},Pe={total:$.length,graded:$.filter(ye=>ye.marks_obtained!=="").length,average:$.filter(ye=>ye.marks_obtained).length>0?($.filter(ye=>ye.marks_obtained).reduce((ye,Ke)=>ye+parseFloat(Ke.marks_obtained||0),0)/$.filter(ye=>ye.marks_obtained).length).toFixed(1):0,highest:Math.max(...$.map(ye=>parseFloat(ye.marks_obtained)||0)),lowest:$.filter(ye=>ye.marks_obtained).length>0?Math.min(...$.filter(ye=>ye.marks_obtained).map(ye=>parseFloat(ye.marks_obtained))):0,passRate:$.filter(ye=>ye.marks_obtained).length>0?Math.round($.filter(ye=>parseFloat(ye.marks_obtained)>=M?.total_marks*.5).length/$.filter(ye=>ye.marks_obtained).length*100):0},we={A:$.filter(ye=>ze(ye.marks_obtained,M?.total_marks)==="A").length,B:$.filter(ye=>ze(ye.marks_obtained,M?.total_marks)==="B").length,C:$.filter(ye=>ze(ye.marks_obtained,M?.total_marks)==="C").length,D:$.filter(ye=>ze(ye.marks_obtained,M?.total_marks)==="D").length,F:$.filter(ye=>ze(ye.marks_obtained,M?.total_marks)==="F").length},fe=ye=>({quiz:"bg-purple-100 text-purple-700",test:"bg-blue-100 text-blue-700",exam:"bg-red-100 text-red-700",assignment:"bg-green-100 text-green-700",project:"bg-orange-100 text-orange-700",midterm:"bg-yellow-100 text-yellow-700",final:"bg-pink-100 text-pink-700"})[ye]||"bg-gray-100 text-gray-700";return R&&a.length===0?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(hs,{className:"w-12 h-12 text-blue-600 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading assessments..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Is,{className:"text-blue-600"}),"My Assessments & Grading"]}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[u?`${u.term_name}  `:"","Create assessments and record student grades"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:k,className:"btn bg-gray-100 hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ns,{className:"w-4 h-4"}),"Refresh"]}),e.jsxs("button",{onClick:()=>{B(),f(!0)},className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-5 h-5"}),"Create Assessment"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Kt,{className:"w-8 h-8 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:le.total}),e.jsx("p",{className:"text-xs text-gray-500",children:"Total"})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_s,{className:"w-8 h-8 text-orange-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:le.pending}),e.jsx("p",{className:"text-xs text-gray-500",children:"Pending"})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center text-purple-600 font-bold text-sm",children:"Q"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:le.quizzes}),e.jsx("p",{className:"text-xs text-gray-500",children:"Quizzes"})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 font-bold text-sm",children:"T"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:le.tests}),e.jsx("p",{className:"text-xs text-gray-500",children:"Tests"})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center text-red-600 font-bold text-sm",children:"E"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:le.exams}),e.jsx("p",{className:"text-xs text-gray-500",children:"Exams"})]})]})})]}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search assessments...",value:E,onChange:ye=>te(ye.target.value),className:"input pl-10 w-full"})]}),e.jsxs("select",{value:C,onChange:ye=>O(ye.target.value),className:"input w-full md:w-40",children:[e.jsx("option",{value:"all",children:"All Classes"}),l.map(ye=>e.jsx("option",{value:ye.id,children:ye.class_name},ye.id))]}),e.jsxs("select",{value:V,onChange:ye=>re(ye.target.value),className:"input w-full md:w-40",children:[e.jsx("option",{value:"all",children:"All Subjects"}),o.map(ye=>e.jsx("option",{value:ye.id,children:ye.subject_name},ye.id))]}),e.jsxs("select",{value:ge,onChange:ye=>xe(ye.target.value),className:"input w-full md:w-32",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"quiz",children:"Quiz"}),e.jsx("option",{value:"test",children:"Test"}),e.jsx("option",{value:"exam",children:"Exam"}),e.jsx("option",{value:"assignment",children:"Assignment"}),e.jsx("option",{value:"project",children:"Project"})]})]})}),e.jsx("div",{className:"card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Assessment"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Class"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Subject"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Marks"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Progress"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:ce.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:"8",className:"px-4 py-12 text-center text-gray-500",children:[e.jsx(Kt,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No assessments found"}),E||C!=="all"||V!=="all"||ge!=="all"?e.jsx("button",{onClick:()=>{te(""),O("all"),re("all"),xe("all")},className:"btn btn-primary mt-4",children:"Clear Filters"}):null]})}):ce.map(ye=>{const Ke=ye.graded_count||0,ve=ye.student_count||0,ie=ve>0?Math.round(Ke/ve*100):0;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-4 py-4",children:[e.jsx("p",{className:"font-medium text-gray-900",children:ye.assessment_name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[ye.weight_percentage,"% weight"]})]}),e.jsx("td",{className:"px-4 py-4 text-sm",children:ye.class_name}),e.jsx("td",{className:"px-4 py-4 text-sm",children:ye.subject_name}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full capitalize ${fe(ye.assessment_type)}`,children:ye.assessment_type})}),e.jsx("td",{className:"px-4 py-4 font-semibold",children:ye.total_marks}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"w-20",children:[e.jsx("div",{className:"flex items-center justify-between text-xs mb-1",children:e.jsxs("span",{children:[Ke,"/",ve]})}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${ie===100?"bg-green-500":ie>0?"bg-yellow-500":"bg-gray-300"}`,style:{width:`${ie}%`}})})]})}),e.jsx("td",{className:"px-4 py-4 text-sm",children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ot,{className:"w-3 h-3 text-gray-400"}),new Date(ye.assessment_date).toLocaleDateString()]})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>je(ye),className:"p-2 text-blue-600 hover:bg-blue-50 rounded",title:"Grade",children:e.jsx(Is,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>oe(ye),className:"p-2 text-gray-600 hover:bg-gray-100 rounded",title:"Edit",children:e.jsx(ll,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Fe(ye),className:"p-2 text-gray-600 hover:bg-gray-100 rounded",title:"Duplicate",children:e.jsx(vl,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{K(ye),D(!0)},className:"p-2 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:e.jsx(us,{className:"w-4 h-4"})})]})})]},ye.id)})})]})})}),N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between sticky top-0 bg-white",children:[e.jsx("h2",{className:"text-xl font-semibold",children:se?"Edit Assessment":"Create Assessment"}),e.jsx("button",{onClick:()=>{f(!1),B()},children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:w,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Class *"}),e.jsxs("select",{required:!0,value:H.class_id,onChange:ye=>ae({...H,class_id:ye.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select Class"}),l.map(ye=>e.jsx("option",{value:ye.id,children:ye.class_name},ye.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Subject *"}),e.jsxs("select",{required:!0,value:H.subject_id,onChange:ye=>ae({...H,subject_id:ye.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select Subject"}),o.map(ye=>e.jsx("option",{value:ye.id,children:ye.subject_name},ye.id))]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Assessment Name *"}),e.jsx("input",{type:"text",required:!0,value:H.assessment_name,onChange:ye=>ae({...H,assessment_name:ye.target.value}),className:"input",placeholder:"e.g., Mathematics Quiz 1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Type *"}),e.jsxs("select",{value:H.assessment_type,onChange:ye=>ae({...H,assessment_type:ye.target.value}),className:"input",children:[e.jsx("option",{value:"quiz",children:"Quiz"}),e.jsx("option",{value:"test",children:"Test"}),e.jsx("option",{value:"exam",children:"Exam"}),e.jsx("option",{value:"assignment",children:"Assignment"}),e.jsx("option",{value:"project",children:"Project"}),e.jsx("option",{value:"midterm",children:"Midterm"}),e.jsx("option",{value:"final",children:"Final"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Total Marks *"}),e.jsx("input",{type:"number",required:!0,value:H.total_marks,onChange:ye=>ae({...H,total_marks:ye.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Weight %"}),e.jsx("input",{type:"number",value:H.weight_percentage,onChange:ye=>ae({...H,weight_percentage:ye.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Date *"}),e.jsx("input",{type:"date",required:!0,value:H.assessment_date,onChange:ye=>ae({...H,assessment_date:ye.target.value}),className:"input"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description (optional)"}),e.jsx("textarea",{value:H.description,onChange:ye=>ae({...H,description:ye.target.value}),className:"input",rows:"2",placeholder:"Additional notes..."})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>{f(!1),B()},className:"btn bg-gray-200",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:T,className:"btn btn-primary flex items-center gap-2",children:[T?e.jsx(hs,{className:"w-4 h-4 animate-spin"}):null,se?"Update Assessment":"Create Assessment"]})]})]})]})}),U&&M&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(us,{className:"w-6 h-6 text-red-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Delete Assessment?"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:['Are you sure you want to delete "',M.assessment_name,'"? This will also delete all grades.']}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>{D(!1),K(null)},className:"btn bg-gray-200 flex-1",children:"Cancel"}),e.jsx("button",{onClick:ne,className:"btn bg-red-600 text-white hover:bg-red-700 flex-1",children:"Delete"})]})]})})}),y&&M&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-5xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between sticky top-0 bg-white z-10",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:M.assessment_name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[M.class_name," - ",M.subject_name,"  ",M.total_marks," marks"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:st,className:"btn bg-gray-100 hover:bg-gray-200 flex items-center gap-2 text-sm",children:[e.jsx(xs,{className:"w-4 h-4"}),"Export CSV"]}),e.jsx("button",{onClick:()=>v(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-3 mb-6",children:[e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsxs("p",{className:"text-xl font-bold text-blue-600",children:[Pe.graded,"/",Pe.total]}),e.jsx("p",{className:"text-xs text-gray-600",children:"Graded"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("p",{className:"text-xl font-bold text-green-600",children:Pe.average}),e.jsx("p",{className:"text-xs text-gray-600",children:"Average"})]}),e.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[e.jsx("p",{className:"text-xl font-bold text-purple-600",children:Pe.highest}),e.jsx("p",{className:"text-xs text-gray-600",children:"Highest"})]}),e.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[e.jsx("p",{className:"text-xl font-bold text-orange-600",children:Pe.lowest}),e.jsx("p",{className:"text-xs text-gray-600",children:"Lowest"})]}),e.jsxs("div",{className:"text-center p-3 bg-teal-50 rounded-lg",children:[e.jsxs("p",{className:"text-xl font-bold text-teal-600",children:[Pe.passRate,"%"]}),e.jsx("p",{className:"text-xs text-gray-600",children:"Pass Rate"})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"flex justify-center gap-1",children:["A","B","C","D","F"].map(ye=>e.jsxs("span",{className:"text-xs font-medium",children:[ye,":",we[ye]]},ye))}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Distribution"})]})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search students...",value:Z,onChange:ye=>I(ye.target.value),className:"input pl-10 w-full md:w-64"})]})}),e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Student"}),e.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"ID"}),e.jsx("th",{className:"px-4 py-2 text-left text-sm w-24",children:"Marks"}),e.jsx("th",{className:"px-4 py-2 text-left text-sm w-16",children:"Grade"}),e.jsx("th",{className:"px-4 py-2 text-left text-sm w-16",children:"%"}),e.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Comment"})]})}),e.jsx("tbody",{className:"divide-y",children:_e.map(ye=>{const Ke=ye.marks_obtained?Math.round(ye.marks_obtained/M.total_marks*100):null,ve=ze(ye.marks_obtained,M.total_marks);return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-white text-xs font-semibold ${ve==="A"?"bg-green-500":ve==="B"?"bg-blue-500":ve==="C"?"bg-yellow-500":ve==="D"?"bg-orange-500":ve==="F"?"bg-red-500":"bg-gray-300"}`,children:[ye.first_name?.charAt(0),ye.last_name?.charAt(0)]}),e.jsxs("span",{children:[ye.first_name," ",ye.last_name]})]})}),e.jsx("td",{className:"px-4 py-3 font-mono text-xs text-gray-500",children:ye.student_id_code}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"number",step:"0.01",min:"0",max:M.total_marks,value:ye.marks_obtained,onChange:ie=>Ge(ye.student_id,"marks_obtained",ie.target.value),className:"input w-20 text-center"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs font-bold rounded ${ve==="A"?"bg-green-100 text-green-700":ve==="B"?"bg-blue-100 text-blue-700":ve==="C"?"bg-yellow-100 text-yellow-700":ve==="D"?"bg-orange-100 text-orange-700":ve==="F"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-500"}`,children:ve||"-"})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:Ke!==null?e.jsxs("span",{className:Ke>=50?"text-green-600":"text-red-600",children:[Ke,"%"]}):"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"text",placeholder:"Add comment...",value:ye.comment||"",onChange:ie=>Ge(ye.student_id,"comment",ie.target.value),className:"input w-full text-sm"})})]},ye.student_id)})})]}),e.jsxs("div",{className:"flex justify-between items-center pt-6 border-t mt-6",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:[Pe.graded," of ",Pe.total," students graded"]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>v(!1),className:"btn bg-gray-200",children:"Cancel"}),e.jsxs("button",{onClick:Xe,disabled:T,className:"btn btn-primary flex items-center gap-2",children:[T?e.jsx(hs,{className:"w-4 h-4 animate-spin"}):e.jsx(Mt,{className:"w-4 h-4"}),"Save Grades"]})]})]})]})]})})]})}function By({userType:t="parent"}){const{user:s}=Us(),[a,r]=h.useState([]),[l,c]=h.useState(null),[o,m]=h.useState(!0),[u,x]=h.useState(!1),[A,g]=h.useState(!1),[N,f]=h.useState(""),[y,v]=h.useState("all"),[U,D]=h.useState([]),[M,K]=h.useState(!1),[$,P]=h.useState(null),[se,z]=h.useState(!1),[R,j]=h.useState([]),[T,Q]=h.useState({recipient_id:"",recipient_type:t==="parent"?"teacher":"parent",subject:"",message:""}),[E,te]=h.useState({message:""});h.useEffect(()=>{C()},[s?.id]);const C=async()=>{try{m(!0);let w=null;if(s?.user_type==="parent")try{const st=(await F.get(`${ee}/parents.php?user_id=${s.id}`)).data.parents||[];st.length>0&&(w=st[0].id,P(w))}catch{}const ne=(await F.get(`${ee}/messages.php?user_id=${s?.id}&limit=100`)).data.messages||[],Fe=new Map,je=String(s?.id),Ge=w?String(w):null;ne.forEach(Xe=>{const st=String(Xe.sender_id),ce=String(Xe.recipient_id);if(!(st===je||ce===je||Ge&&(st===Ge||ce===Ge)))return;const le=Xe.subject?.replace(/^Re:\s*/i,"").trim()||"No Subject",we=`${[Xe.sender_id,Xe.recipient_id].sort().join("-")}-${le}`;Fe.has(we)||Fe.set(we,{id:we,subject:le,participants:[{id:Xe.sender_id,name:Xe.sender_name,type:Xe.sender_type},{id:Xe.recipient_id,name:Xe.recipient_name,type:Xe.recipient_type}],messages:[],lastMessage:null,unreadCount:0,starred:!1});const fe=Fe.get(we),ye=st===je||Ge&&st===Ge;fe.messages.push({...Xe,isSent:ye,status:Xe.is_read?"read":ye?"delivered":"unread"}),!Xe.is_read&&!ye&&fe.unreadCount++,Xe.starred&&(fe.starred=!0)});const ze=Array.from(Fe.values()).map(Xe=>(Xe.messages.sort((st,ce)=>new Date(st.created_at)-new Date(ce.created_at)),Xe.lastMessage=Xe.messages[Xe.messages.length-1],Xe));ze.sort((Xe,st)=>new Date(st.lastMessage?.created_at||0)-new Date(Xe.lastMessage?.created_at||0)),r(ze),await O()}catch(w){console.error("Error fetching messages:",w),r([])}finally{m(!1)}},O=async()=>{try{if(t==="parent"){const w=await F.get(`${ee}/messages.php?action=get_recipients&user_type=parent`);D(w.data.recipients||[])}else if(t==="teacher"){const oe=(await F.get(`${ee}/teachers.php?user_id=${s?.id}`)).data.teachers||[];if(oe.length>0){const Fe=(await F.get(`${ee}/classes.php?teacher_id=${oe[0].id}`)).data.classes||[],Ge=(await F.get(`${ee}/parents.php`)).data.parents||[],ze=[];for(const Xe of Fe)try{((await F.get(`${ee}/students.php?class_id=${Xe.id}`)).data.students||[]).forEach(_e=>{if(_e.guardian_name){const le=Ge.find(Pe=>_e.guardian_email&&Pe.email===_e.guardian_email||_e.guardian_phone&&Pe.phone===_e.guardian_phone);le&&!ze.find(Pe=>Pe.id===le.id)&&ze.push({id:le.id,name:_e.guardian_name,type:"parent",student:`${_e.first_name} ${_e.last_name}`,class_name:Xe.class_name})}})}catch{}try{const st=((await F.get(`${ee}/messages.php?action=get_recipients&user_type=teacher`)).data.recipients||[]).filter(ce=>ce.type==="admin");ze.push(...st)}catch{}D(ze)}}else{const w=await F.get(`${ee}/messages.php?action=get_recipients&user_type=admin`);D(w.data.recipients||[])}}catch(w){console.error("Error fetching recipients:",w)}},V=async()=>{x(!0),await C(),x(!1)},re=async w=>{c(w);for(const oe of w.messages)if(!oe.is_read&&!oe.isSent)try{await F.put(`${ee}/messages.php?id=${oe.id}`,{is_read:!0})}catch{}r(oe=>oe.map(ne=>ne.id===w.id?{...ne,unreadCount:0,messages:ne.messages.map(Fe=>({...Fe,is_read:!0}))}:ne))},ge=async(w=!1)=>{if(!w&&(!T.recipient_id||!T.subject||!T.message)){alert("Please fill in all fields");return}if(w&&!E.message){alert("Please enter a message");return}try{K(!0);let oe,ne,Fe;if(w&&l){const Ge=l.participants.find(ze=>String(ze.id)!==String(s?.id)&&String(ze.id)!==String($));oe=Ge?.id,ne=Ge?.type||"parent",Fe=`Re: ${l.subject}`}else oe=T.recipient_id,ne=T.recipient_type,Fe=T.subject;const je=await F.post(`${ee}/messages.php`,{sender_id:s?.id,sender_type:t,recipient_id:oe,recipient_type:ne,subject:Fe,message:w?E.message:T.message});if(je.data.success){if(w?te({message:""}):(g(!1),Q({recipient_id:"",recipient_type:t==="parent"?"teacher":"parent",subject:"",message:""})),await C(),w&&l){const Ge=a.find(ze=>ze.id===l.id);Ge&&c(Ge)}}else alert("Failed to send message: "+(je.data.error||"Unknown error"))}catch(oe){console.error("Error sending message:",oe),alert("Failed to send message")}finally{K(!1)}},xe=async(w,oe)=>{oe.stopPropagation(),r(ne=>ne.map(Fe=>Fe.id===w?{...Fe,starred:!Fe.starred}:Fe))},Z=async w=>{if(!confirm("Are you sure you want to delete this conversation?"))return;const oe=a.find(ne=>ne.id===w);if(oe)for(const ne of oe.messages)try{await F.delete(`${ee}/messages.php?id=${ne.id}`)}catch{}r(ne=>ne.filter(Fe=>Fe.id!==w)),l?.id===w&&c(null)},I=w=>{if(!w)return"";const oe=new Date(w),ne=new Date;return oe.toDateString()===ne.toDateString()?oe.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):oe.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},H=w=>w?new Date(w).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"",ae=w=>w.isSent?w.is_read?{icon:Q1,color:"text-blue-500",label:"Read"}:{icon:Tn,color:"text-gray-400",label:"Delivered"}:null,k=a.filter(w=>{const oe=!N||w.subject?.toLowerCase().includes(N.toLowerCase())||w.participants.some(ne=>ne.name?.toLowerCase().includes(N.toLowerCase()))||w.messages.some(ne=>ne.message?.toLowerCase().includes(N.toLowerCase()));return y==="unread"?oe&&w.unreadCount>0:y==="sent"?oe&&w.lastMessage?.isSent:y==="starred"?oe&&w.starred:oe}),B={total:a.length,unread:a.reduce((w,oe)=>w+oe.unreadCount,0),sent:a.filter(w=>w.lastMessage?.isSent).length,starred:a.filter(w=>w.starred).length};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(ra,{className:"w-7 h-7"}),"Messages"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Communicate with parents and staff"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:V,disabled:u,className:"btn bg-white border border-gray-300 hover:bg-gray-50 flex items-center gap-2",children:[e.jsx(Ns,{className:`w-4 h-4 ${u?"animate-spin":""}`}),"Refresh"]}),e.jsxs("button",{onClick:()=>g(!0),className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4"}),"Compose"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx("div",{onClick:()=>v("all"),className:`card p-4 cursor-pointer transition-all ${y==="all"?"ring-2 ring-blue-500":"hover:shadow-md"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(hk,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:B.total}),e.jsx("p",{className:"text-sm text-gray-500",children:"Total"})]})]})}),e.jsx("div",{onClick:()=>v("unread"),className:`card p-4 cursor-pointer transition-all ${y==="unread"?"ring-2 ring-green-500":"hover:shadow-md"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(wa,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:B.unread}),e.jsx("p",{className:"text-sm text-gray-500",children:"Unread"})]})]})}),e.jsx("div",{onClick:()=>v("sent"),className:`card p-4 cursor-pointer transition-all ${y==="sent"?"ring-2 ring-purple-500":"hover:shadow-md"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(va,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:B.sent}),e.jsx("p",{className:"text-sm text-gray-500",children:"Sent"})]})]})}),e.jsx("div",{onClick:()=>v("starred"),className:`card p-4 cursor-pointer transition-all ${y==="starred"?"ring-2 ring-yellow-500":"hover:shadow-md"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center",children:e.jsx(sl,{className:"w-5 h-5 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:B.starred}),e.jsx("p",{className:"text-sm text-gray-500",children:"Starred"})]})]})})]}),e.jsxs("div",{className:"card overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",value:N,onChange:w=>f(w.target.value),placeholder:"Search messages...",className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[["all","unread","sent","starred"].map(w=>e.jsx("button",{onClick:()=>v(w),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${y===w?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:w==="all"?"All":w==="unread"?"Unread":w==="sent"?"Sent":""},w)),e.jsx("button",{onClick:()=>z(!se),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${se?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Select"})]})]}),e.jsxs("div",{className:"flex",style:{minHeight:"500px"},children:[e.jsx("div",{className:`${l?"w-2/5 border-r":"w-full"} overflow-y-auto`,style:{maxHeight:"600px"},children:o?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(hs,{className:"w-8 h-8 animate-spin mx-auto text-blue-600"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Loading messages..."})]}):k.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(wa,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No messages"}),e.jsx("p",{className:"text-gray-500 mt-1",children:y==="all"?"Start a conversation by clicking Compose":`No ${y} messages`})]}):e.jsx("div",{className:"divide-y",children:k.map(w=>{const oe=l?.id===w.id,ne=w.lastMessage,Fe=w.participants.find(je=>String(je.id)!==String(s?.id)&&String(je.id)!==String($));return e.jsx("div",{onClick:()=>re(w),className:`p-4 cursor-pointer transition-colors ${oe?"bg-blue-50 border-l-4 border-l-blue-600":w.unreadCount>0?"bg-blue-50/50 hover:bg-blue-50":"hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[se&&e.jsx("input",{type:"checkbox",checked:R.includes(w.id),onChange:je=>{je.stopPropagation(),j(Ge=>Ge.includes(w.id)?Ge.filter(ze=>ze!==w.id):[...Ge,w.id])},className:"mt-1"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("p",{className:`font-medium truncate ${w.unreadCount>0?"text-gray-900":"text-gray-700"}`,children:ne?.isSent?`To: ${Fe?.name||"Unknown"}`:Fe?.name||"Unknown"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:I(ne?.created_at)}),e.jsx("button",{onClick:je=>xe(w.id,je),className:`p-1 rounded hover:bg-gray-200 ${w.starred?"text-yellow-500":"text-gray-300"}`,children:e.jsx(sl,{className:"w-4 h-4",fill:w.starred?"currentColor":"none"})})]})]}),e.jsx("p",{className:`text-sm mb-1 truncate ${w.unreadCount>0?"font-semibold text-gray-900":"text-gray-700"}`,children:w.subject}),e.jsx("p",{className:"text-sm text-gray-500 truncate",children:ne?.message})]}),w.unreadCount>0&&e.jsx("span",{className:"bg-blue-600 text-white text-xs px-2 py-0.5 rounded-full",children:w.unreadCount})]})},w.id)})})}),l&&e.jsxs("div",{className:"w-3/5 flex flex-col",children:[e.jsx("div",{className:"p-4 border-b bg-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg text-gray-900",children:l.subject}),e.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-2",children:[e.jsx(ha,{className:"w-4 h-4"}),"From: ",l.participants.find(w=>String(w.id)!==String(s?.id)&&String(w.id)!==String($))?.name||"Unknown",e.jsx("span",{className:"text-gray-300",children:""}),H(l.lastMessage?.created_at)]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:w=>xe(l.id,w),className:`p-2 rounded-lg hover:bg-gray-100 ${l.starred?"text-yellow-500":"text-gray-400"}`,children:e.jsx(sl,{className:"w-5 h-5",fill:l.starred?"currentColor":"none"})}),e.jsx("button",{onClick:()=>Z(l.id),className:"p-2 rounded-lg hover:bg-gray-100 text-gray-400 hover:text-red-500",children:e.jsx(us,{className:"w-5 h-5"})})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50",style:{maxHeight:"350px"},children:l.messages.map((w,oe)=>{const ne=ae(w);return e.jsx("div",{className:`flex ${w.isSent?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[80%] ${w.isSent?"order-2":""}`,children:[e.jsx("div",{className:`rounded-lg p-4 ${w.isSent?"bg-blue-600 text-white":"bg-white border shadow-sm"}`,children:e.jsx("p",{className:`text-sm ${w.isSent?"text-white":"text-gray-800"}`,children:w.message})}),e.jsxs("div",{className:`flex items-center gap-2 mt-1 text-xs text-gray-500 ${w.isSent?"justify-end":""}`,children:[e.jsx("span",{children:H(w.created_at)}),ne&&e.jsxs("span",{className:`flex items-center gap-1 ${ne.color}`,children:[e.jsx(ne.icon,{className:"w-3 h-3"}),ne.label]})]})]})},w.id||oe)})}),e.jsx("div",{className:"p-4 border-t bg-white",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>{const w=l.participants.find(oe=>String(oe.id)!==String(s?.id)&&String(oe.id)!==String($));Q({recipient_id:w?.id||"",recipient_type:w?.type||"parent",subject:`Re: ${l.subject}`,message:""}),g(!0)},className:"btn btn-primary flex items-center gap-2",children:[e.jsx(uB,{className:"w-4 h-4"}),"Reply"]}),e.jsxs("button",{className:"btn bg-gray-100 hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(XS,{className:"w-4 h-4"}),"Forward"]})]})})]})]})]}),A&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full shadow-2xl",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-lg",children:T.subject.startsWith("Re:")?"Reply to Message":"New Message"}),e.jsx("button",{onClick:()=>g(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(Nt,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"To"}),e.jsxs("select",{value:T.recipient_id,onChange:w=>{const oe=U.find(ne=>ne.id==w.target.value);Q({...T,recipient_id:w.target.value,recipient_type:oe?.type||"parent"})},className:"input",disabled:T.subject.startsWith("Re:"),children:[e.jsx("option",{value:"",children:"Select recipient"}),U.map((w,oe)=>e.jsxs("option",{value:w.id,children:[w.name," (",w.type,")",w.student?` - Parent of ${w.student}`:""]},`${w.type}-${w.id}-${oe}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject"}),e.jsx("input",{type:"text",value:T.subject,onChange:w=>Q({...T,subject:w.target.value}),className:"input",placeholder:"Enter subject",disabled:T.subject.startsWith("Re:")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message"}),e.jsx("textarea",{value:T.message,onChange:w=>Q({...T,message:w.target.value}),className:"input",rows:"6",placeholder:"Type your message..."})]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>g(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:"Cancel"}),e.jsxs("button",{onClick:()=>ge(!1),disabled:M,className:"btn btn-primary flex items-center gap-2",children:[M?e.jsx(hs,{className:"w-4 h-4 animate-spin"}):e.jsx(va,{className:"w-4 h-4"}),"Send Message"]})]})]})})]})}function fL(){return e.jsx(By,{userType:"teacher"})}function bL(){const{user:t,setUser:s,logout:a}=Us(),r=h.useRef(null),[l,c]=h.useState("profile"),[o,m]=h.useState(!0),[u,x]=h.useState(!1),[A,g]=h.useState(!1),[N,f]=h.useState(""),[y,v]=h.useState(!1),[U,D]=h.useState(!1),[M,K]=h.useState(null),[$,P]=h.useState(null),[se,z]=h.useState([]),[R,j]=h.useState({first_name:"",last_name:"",email:"",phone:"",date_of_birth:"",gender:"",address:"",city:"",region:"",qualification:"",specialization:"",emergency_contact_name:"",emergency_contact_phone:"",emergency_contact_relationship:""}),[T,Q]=h.useState({current_password:"",new_password:"",confirm_password:""}),[E,te]=h.useState({email_notifications:!0,sms_notifications:!1,homework_reminders:!0,attendance_alerts:!0,grade_notifications:!0,message_notifications:!0,system_updates:!0}),[C,O]=h.useState({theme:localStorage.getItem("theme")||"light",language:localStorage.getItem("language")||"en",compact_mode:localStorage.getItem("compact_mode")==="true"}),[V,re]=h.useState({last_login:null,password_changed_at:null,two_factor_enabled:!1});h.useEffect(()=>{ge()},[]);const ge=async()=>{try{m(!0);const Ge=(await F.get(`${ee}/teachers.php?user_id=${t?.id}`)).data.teachers||[];if(Ge.length>0){const ze=Ge[0];if(P(ze),j({first_name:ze.first_name||"",last_name:ze.last_name||"",email:ze.email||t?.email||"",phone:ze.phone||"",date_of_birth:ze.date_of_birth||"",gender:ze.gender||"",address:ze.address||"",city:ze.city||"",region:ze.region||"",qualification:ze.qualification||"",specialization:ze.specialization||"",emergency_contact_name:ze.emergency_contact_name||"",emergency_contact_phone:ze.emergency_contact_phone||"",emergency_contact_relationship:ze.emergency_contact_relationship||""}),ze.notification_settings)try{const Xe=JSON.parse(ze.notification_settings);te(st=>({...st,...Xe}))}catch{}re({last_login:t?.last_login||new Date().toISOString(),password_changed_at:ze.password_changed_at||null,two_factor_enabled:ze.two_factor_enabled||!1})}try{const ze=await F.get(`${ee}/auth.php?action=sessions&user_id=${t?.id}`);z(ze.data.sessions||[])}catch{z([{id:1,device:"Current Session",location:"Unknown",last_active:new Date().toISOString(),current:!0}])}}catch(je){console.error("Error fetching teacher data:",je),f("Failed to load profile data")}finally{m(!1)}},xe=async je=>{if(je.preventDefault(),f(""),!R.first_name||!R.last_name){f("First name and last name are required");return}if(!R.email||!/\S+@\S+\.\S+/.test(R.email)){f("Please enter a valid email address");return}try{x(!0),await F.put(`${ee}/teachers.php?id=${$.id}`,R),g(!0),setTimeout(()=>g(!1),3e3),ge()}catch(Ge){console.error("Error updating profile:",Ge),f("Failed to update profile. Please try again.")}finally{x(!1)}},Z=async je=>{if(je.preventDefault(),f(""),T.new_password!==T.confirm_password){f("New passwords do not match");return}if(T.new_password.length<6){f("Password must be at least 6 characters");return}try{x(!0);const Ge=await F.post(`${ee}/auth.php`,{action:"change_password",user_id:t?.id,current_password:T.current_password,new_password:T.new_password});Ge.data.success?(g(!0),setTimeout(()=>g(!1),3e3),Q({current_password:"",new_password:"",confirm_password:""})):f(Ge.data.error||"Failed to change password")}catch(Ge){console.error("Error changing password:",Ge),f("Failed to change password. Please check your current password.")}finally{x(!1)}},I=async()=>{try{x(!0),await F.put(`${ee}/teachers.php?id=${$.id}`,{notification_settings:JSON.stringify(E)}),g(!0),setTimeout(()=>g(!1),3e3)}catch(je){console.error("Error updating notifications:",je),f("Failed to update notification settings")}finally{x(!1)}},H=()=>{localStorage.setItem("theme",C.theme),localStorage.setItem("language",C.language),localStorage.setItem("compact_mode",C.compact_mode.toString()),C.theme==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),g(!0),setTimeout(()=>g(!1),3e3)},ae=je=>{const Ge=je.target.files[0];if(!Ge)return;if(!Ge.type.startsWith("image/")){f("Please select an image file");return}if(Ge.size>5*1024*1024){f("Image size must be less than 5MB");return}const ze=new FileReader;ze.onload=Xe=>{K(Xe.target.result)},ze.readAsDataURL(Ge)},k=async()=>{if(!r.current?.files[0])return;const je=r.current.files[0],Ge=new FormData;Ge.append("photo",je),Ge.append("teacher_id",$.id);try{x(!0);const ze=await F.post(`${ee}/upload_photo.php`,Ge,{headers:{"Content-Type":"multipart/form-data"}});ze.data.success?(g(!0),setTimeout(()=>g(!1),3e3),K(null),ge()):f(ze.data.error||"Failed to upload photo")}catch(ze){console.error("Error uploading photo:",ze),f("Failed to upload photo")}finally{x(!1)}},B=async je=>{try{z(se.filter(Ge=>Ge.id!==je))}catch(Ge){console.error("Error revoking session:",Ge)}},w=async()=>{try{const je={profile:R,notifications:E,exported_at:new Date().toISOString()},Ge=new Blob([JSON.stringify(je,null,2)],{type:"application/json"}),ze=URL.createObjectURL(Ge),Xe=document.createElement("a");Xe.href=ze,Xe.download=`teacher_data_export_${new Date().toISOString().split("T")[0]}.json`,Xe.click(),URL.revokeObjectURL(ze)}catch(je){console.error("Error exporting data:",je)}},oe=je=>{if(!je)return{strength:0,label:"",color:""};let Ge=0;return je.length>=6&&Ge++,je.length>=8&&Ge++,/[A-Z]/.test(je)&&Ge++,/[0-9]/.test(je)&&Ge++,/[^A-Za-z0-9]/.test(je)&&Ge++,Ge<=2?{strength:Ge,label:"Weak",color:"bg-red-500"}:Ge<=3?{strength:Ge,label:"Medium",color:"bg-yellow-500"}:{strength:Ge,label:"Strong",color:"bg-green-500"}},ne=[{id:"profile",label:"Profile",icon:ha},{id:"security",label:"Security",icon:$r},{id:"notifications",label:"Notifications",icon:nl},{id:"appearance",label:"Appearance",icon:km}],Fe=oe(T.new_password);return o?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(hs,{className:"w-12 h-12 text-blue-600 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading settings..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Ka,{className:"text-blue-600"}),"Settings"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your account settings and preferences"})]}),e.jsxs("button",{onClick:ge,className:"btn bg-gray-100 hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ns,{className:"w-4 h-4"}),"Refresh"]})]}),N&&e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center gap-2",children:[e.jsx(_s,{className:"w-5 h-5"}),N,e.jsx("button",{onClick:()=>f(""),className:"ml-auto",children:e.jsx(Nt,{className:"w-4 h-4"})})]}),A&&e.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg flex items-center gap-2",children:[e.jsx(Tn,{className:"w-5 h-5"}),"Changes saved successfully!"]}),e.jsx("div",{className:"card p-4",children:e.jsx("div",{className:"flex flex-wrap gap-2 border-b pb-4",children:ne.map(je=>{const Ge=je.icon;return e.jsxs("button",{onClick:()=>{c(je.id),f("")},className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${l===je.id?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(Ge,{className:"w-4 h-4"}),je.label]},je.id)})})}),l==="profile"&&e.jsx("div",{className:"card p-6",children:e.jsxs("form",{onSubmit:xe,className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-6 pb-6 border-b",children:[e.jsxs("div",{className:"relative",children:[M?e.jsx("img",{src:M,alt:"Preview",className:"w-24 h-24 rounded-full object-cover border-4 border-blue-200"}):$?.photo?e.jsx("img",{src:`${ee.replace("/api","")}/uploads/${$.photo}`,alt:"Profile",className:"w-24 h-24 rounded-full object-cover",onError:je=>{je.target.style.display="none"}}):e.jsx("div",{className:"w-24 h-24 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsxs("span",{className:"text-3xl font-bold text-blue-600",children:[R.first_name?.[0],R.last_name?.[0]]})}),e.jsxs("label",{className:"absolute bottom-0 right-0 w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center cursor-pointer hover:bg-blue-700",children:[e.jsx(Ld,{className:"w-4 h-4 text-white"}),e.jsx("input",{ref:r,type:"file",accept:"image/*",onChange:ae,className:"hidden"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Profile Photo"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Click the camera icon to select a photo"}),M&&e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsxs("button",{type:"button",onClick:k,disabled:u,className:"btn btn-primary text-sm flex items-center gap-1",children:[u?e.jsx(hs,{className:"w-3 h-3 animate-spin"}):e.jsx(Hr,{className:"w-3 h-3"}),"Upload"]}),e.jsx("button",{type:"button",onClick:()=>{K(null),r.current&&(r.current.value="")},className:"btn bg-gray-200 text-sm",children:"Cancel"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"First Name *"}),e.jsx("input",{type:"text",value:R.first_name,onChange:je=>j({...R,first_name:je.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Last Name *"}),e.jsx("input",{type:"text",value:R.last_name,onChange:je=>j({...R,last_name:je.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Email *"}),e.jsx("input",{type:"email",value:R.email,onChange:je=>j({...R,email:je.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Phone"}),e.jsx("input",{type:"tel",value:R.phone,onChange:je=>j({...R,phone:je.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Date of Birth"}),e.jsx("input",{type:"date",value:R.date_of_birth,onChange:je=>j({...R,date_of_birth:je.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Gender"}),e.jsxs("select",{value:R.gender,onChange:je=>j({...R,gender:je.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select Gender"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Address"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Street Address"}),e.jsx("input",{type:"text",value:R.address,onChange:je=>j({...R,address:je.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"City"}),e.jsx("input",{type:"text",value:R.city,onChange:je=>j({...R,city:je.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Region"}),e.jsx("input",{type:"text",value:R.region,onChange:je=>j({...R,region:je.target.value}),className:"input"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Is,{className:"w-5 h-5 text-blue-600"}),"Professional Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Qualification"}),e.jsx("input",{type:"text",value:R.qualification,onChange:je=>j({...R,qualification:je.target.value}),className:"input",placeholder:"e.g., B.Ed, M.Ed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Specialization"}),e.jsx("input",{type:"text",value:R.specialization,onChange:je=>j({...R,specialization:je.target.value}),className:"input",placeholder:"e.g., Mathematics, Science"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(er,{className:"w-5 h-5 text-red-600"}),"Emergency Contact"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Contact Name"}),e.jsx("input",{type:"text",value:R.emergency_contact_name,onChange:je=>j({...R,emergency_contact_name:je.target.value}),className:"input",placeholder:"Full name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Contact Phone"}),e.jsx("input",{type:"tel",value:R.emergency_contact_phone,onChange:je=>j({...R,emergency_contact_phone:je.target.value}),className:"input",placeholder:"Phone number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Relationship"}),e.jsxs("select",{value:R.emergency_contact_relationship,onChange:je=>j({...R,emergency_contact_relationship:je.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select relationship"}),e.jsx("option",{value:"spouse",children:"Spouse"}),e.jsx("option",{value:"parent",children:"Parent"}),e.jsx("option",{value:"sibling",children:"Sibling"}),e.jsx("option",{value:"child",children:"Child"}),e.jsx("option",{value:"friend",children:"Friend"}),e.jsx("option",{value:"other",children:"Other"})]})]})]})]}),e.jsx("div",{className:"flex items-center gap-3 pt-4 border-t",children:e.jsxs("button",{type:"submit",disabled:u,className:"btn btn-primary flex items-center gap-2",children:[u?e.jsx(hs,{className:"w-4 h-4 animate-spin"}):e.jsx(Br,{className:"w-4 h-4"}),u?"Saving...":"Save Changes"]})})]})}),l==="security"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Ui,{className:"w-5 h-5 text-blue-600"}),"Change Password"]}),e.jsxs("form",{onSubmit:Z,className:"space-y-4 max-w-md",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Current Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:y?"text":"password",value:T.current_password,onChange:je=>Q({...T,current_password:je.target.value}),className:"input pr-10",required:!0}),e.jsx("button",{type:"button",onClick:()=>v(!y),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:y?e.jsx(ib,{className:"w-4 h-4"}):e.jsx(na,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"New Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:U?"text":"password",value:T.new_password,onChange:je=>Q({...T,new_password:je.target.value}),className:"input pr-10",required:!0,minLength:"6"}),e.jsx("button",{type:"button",onClick:()=>D(!U),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:U?e.jsx(ib,{className:"w-4 h-4"}):e.jsx(na,{className:"w-4 h-4"})})]}),T.new_password&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${Fe.color} transition-all`,style:{width:`${Fe.strength/5*100}%`}})}),e.jsx("span",{className:`text-xs ${Fe.color.replace("bg-","text-")}`,children:Fe.label})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Use 8+ characters with uppercase, numbers, and symbols"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Confirm New Password *"}),e.jsx("input",{type:"password",value:T.confirm_password,onChange:je=>Q({...T,confirm_password:je.target.value}),className:"input",required:!0}),T.confirm_password&&T.new_password!==T.confirm_password&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Passwords do not match"})]}),e.jsxs("button",{type:"submit",disabled:u||T.new_password!==T.confirm_password,className:"btn btn-primary flex items-center gap-2",children:[u?e.jsx(hs,{className:"w-4 h-4 animate-spin"}):e.jsx(Ui,{className:"w-4 h-4"}),u?"Changing...":"Change Password"]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx($r,{className:"w-5 h-5 text-green-600"}),"Account Security"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between py-3 border-b",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Wt,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Last Login"}),e.jsx("p",{className:"text-sm text-gray-600",children:V.last_login?new Date(V.last_login).toLocaleString():"Unknown"})]})]})}),e.jsx("div",{className:"flex items-center justify-between py-3 border-b",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ui,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Password Last Changed"}),e.jsx("p",{className:"text-sm text-gray-600",children:V.password_changed_at?new Date(V.password_changed_at).toLocaleDateString():"Never changed"})]})]})})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(km,{className:"w-5 h-5 text-purple-600"}),"Active Sessions"]}),e.jsx("div",{className:"space-y-3",children:se.map(je=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(H1,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:je.device}),e.jsxs("p",{className:"text-sm text-gray-600",children:[je.location,"  ",je.current?"Current session":`Last active: ${new Date(je.last_active).toLocaleDateString()}`]})]})]}),!je.current&&e.jsx("button",{onClick:()=>B(je.id),className:"btn bg-red-100 text-red-700 hover:bg-red-200 text-sm",children:e.jsx(M1,{className:"w-4 h-4"})})]},je.id))})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(xs,{className:"w-5 h-5 text-blue-600"}),"Data & Privacy"]}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Download a copy of your personal data"}),e.jsxs("button",{onClick:w,className:"btn bg-gray-200 hover:bg-gray-300 flex items-center gap-2",children:[e.jsx(xs,{className:"w-4 h-4"}),"Export My Data"]})]})]}),l==="notifications"&&e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(nl,{className:"w-5 h-5 text-blue-600"}),"Notification Preferences"]}),e.jsx("div",{className:"space-y-4",children:Object.entries(E).map(([je,Ge])=>e.jsxs("div",{className:"flex items-center justify-between py-3 border-b",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:je.split("_").map(ze=>ze.charAt(0).toUpperCase()+ze.slice(1)).join(" ")}),e.jsxs("p",{className:"text-sm text-gray-600",children:[je==="email_notifications"&&"Receive email notifications",je==="sms_notifications"&&"Receive SMS notifications",je==="homework_reminders"&&"Get reminded about homework deadlines",je==="attendance_alerts"&&"Alerts for attendance issues",je==="grade_notifications"&&"Notifications when grades are updated",je==="message_notifications"&&"New message alerts",je==="system_updates"&&"System announcements and updates"]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:Ge,onChange:ze=>te({...E,[je]:ze.target.checked}),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]},je))})]}),e.jsxs("button",{onClick:I,disabled:u,className:"btn btn-primary flex items-center gap-2",children:[u?e.jsx(hs,{className:"w-4 h-4 animate-spin"}):e.jsx(Br,{className:"w-4 h-4"}),u?"Saving...":"Save Preferences"]})]})}),l==="appearance"&&e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(km,{className:"w-5 h-5 text-blue-600"}),"Appearance Settings"]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium mb-3",children:"Theme"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:()=>O({...C,theme:"light"}),className:`flex items-center gap-2 px-4 py-3 rounded-lg border-2 transition-colors ${C.theme==="light"?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[e.jsx(mb,{className:"w-5 h-5 text-yellow-500"}),e.jsx("span",{children:"Light"})]}),e.jsxs("button",{onClick:()=>O({...C,theme:"dark"}),className:`flex items-center gap-2 px-4 py-3 rounded-lg border-2 transition-colors ${C.theme==="dark"?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[e.jsx(ob,{className:"w-5 h-5 text-gray-600"}),e.jsx("span",{children:"Dark"})]}),e.jsxs("button",{onClick:()=>O({...C,theme:"system"}),className:`flex items-center gap-2 px-4 py-3 rounded-lg border-2 transition-colors ${C.theme==="system"?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[e.jsx(km,{className:"w-5 h-5 text-gray-600"}),e.jsx("span",{children:"System"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Language"}),e.jsxs("select",{value:C.language,onChange:je=>O({...C,language:je.target.value}),className:"input max-w-xs",children:[e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"fr",children:"French"}),e.jsx("option",{value:"es",children:"Spanish"})]})]}),e.jsxs("div",{className:"flex items-center justify-between py-3 border-t",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Compact Mode"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Use smaller spacing and fonts"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:C.compact_mode,onChange:je=>O({...C,compact_mode:je.target.checked}),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]}),e.jsxs("button",{onClick:H,className:"btn btn-primary flex items-center gap-2",children:[e.jsx(Br,{className:"w-4 h-4"}),"Save Preferences"]})]})})]})}var Db=function(t,s){return Db=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,r){a.__proto__=r}||function(a,r){for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(a[l]=r[l])},Db(t,s)};function wc(t,s){if(typeof s!="function"&&s!==null)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");Db(t,s);function a(){this.constructor=t}t.prototype=s===null?Object.create(s):(a.prototype=s.prototype,new a)}var Ub=function(){return Ub=Object.assign||function(s){for(var a,r=1,l=arguments.length;r<l;r++){a=arguments[r];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(s[c]=a[c])}return s},Ub.apply(this,arguments)};function bl(t,s,a,r){function l(c){return c instanceof a?c:new a(function(o){o(c)})}return new(a||(a=Promise))(function(c,o){function m(A){try{x(r.next(A))}catch(g){o(g)}}function u(A){try{x(r.throw(A))}catch(g){o(g)}}function x(A){A.done?c(A.value):l(A.value).then(m,u)}x((r=r.apply(t,[])).next())})}function el(t,s){var a={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},r,l,c,o;return o={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function m(x){return function(A){return u([x,A])}}function u(x){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,l&&(c=x[0]&2?l.return:x[0]?l.throw||((c=l.return)&&c.call(l),0):l.next)&&!(c=c.call(l,x[1])).done)return c;switch(l=0,c&&(x=[x[0]&2,c.value]),x[0]){case 0:case 1:c=x;break;case 4:return a.label++,{value:x[1],done:!1};case 5:a.label++,l=x[1],x=[0];continue;case 7:x=a.ops.pop(),a.trys.pop();continue;default:if(c=a.trys,!(c=c.length>0&&c[c.length-1])&&(x[0]===6||x[0]===2)){a=0;continue}if(x[0]===3&&(!c||x[1]>c[0]&&x[1]<c[3])){a.label=x[1];break}if(x[0]===6&&a.label<c[1]){a.label=c[1],c=x;break}if(c&&a.label<c[2]){a.label=c[2],a.ops.push(x);break}c[2]&&a.ops.pop(),a.trys.pop();continue}x=s.call(t,a)}catch(A){x=[6,A],l=0}finally{r=c=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}}function lA(t,s,a){if(arguments.length===2)for(var r=0,l=s.length,c;r<l;r++)(c||!(r in s))&&(c||(c=Array.prototype.slice.call(s,0,r)),c[r]=s[r]);return t.concat(c||s)}var Go=(function(){function t(s,a,r,l){this.left=s,this.top=a,this.width=r,this.height=l}return t.prototype.add=function(s,a,r,l){return new t(this.left+s,this.top+a,this.width+r,this.height+l)},t.fromClientRect=function(s,a){return new t(a.left+s.windowBounds.left,a.top+s.windowBounds.top,a.width,a.height)},t.fromDOMRectList=function(s,a){var r=Array.from(a).find(function(l){return l.width!==0});return r?new t(r.left+s.windowBounds.left,r.top+s.windowBounds.top,r.width,r.height):t.EMPTY},t.EMPTY=new t(0,0,0,0),t})(),Sg=function(t,s){return Go.fromClientRect(t,s.getBoundingClientRect())},yL=function(t){var s=t.body,a=t.documentElement;if(!s||!a)throw new Error("Unable to get document size");var r=Math.max(Math.max(s.scrollWidth,a.scrollWidth),Math.max(s.offsetWidth,a.offsetWidth),Math.max(s.clientWidth,a.clientWidth)),l=Math.max(Math.max(s.scrollHeight,a.scrollHeight),Math.max(s.offsetHeight,a.offsetHeight),Math.max(s.clientHeight,a.clientHeight));return new Go(0,0,r,l)},kg=function(t){for(var s=[],a=0,r=t.length;a<r;){var l=t.charCodeAt(a++);if(l>=55296&&l<=56319&&a<r){var c=t.charCodeAt(a++);(c&64512)===56320?s.push(((l&1023)<<10)+(c&1023)+65536):(s.push(l),a--)}else s.push(l)}return s},Xr=function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var a=t.length;if(!a)return"";for(var r=[],l=-1,c="";++l<a;){var o=t[l];o<=65535?r.push(o):(o-=65536,r.push((o>>10)+55296,o%1024+56320)),(l+1===a||r.length>16384)&&(c+=String.fromCharCode.apply(String,r),r.length=0)}return c},A2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",jL=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var iA=0;iA<A2.length;iA++)jL[A2.charCodeAt(iA)]=iA;var g2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",rh=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var cA=0;cA<g2.length;cA++)rh[g2.charCodeAt(cA)]=cA;var vL=function(t){var s=t.length*.75,a=t.length,r,l=0,c,o,m,u;t[t.length-1]==="="&&(s--,t[t.length-2]==="="&&s--);var x=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(s):new Array(s),A=Array.isArray(x)?x:new Uint8Array(x);for(r=0;r<a;r+=4)c=rh[t.charCodeAt(r)],o=rh[t.charCodeAt(r+1)],m=rh[t.charCodeAt(r+2)],u=rh[t.charCodeAt(r+3)],A[l++]=c<<2|o>>4,A[l++]=(o&15)<<4|m>>2,A[l++]=(m&3)<<6|u&63;return x},NL=function(t){for(var s=t.length,a=[],r=0;r<s;r+=2)a.push(t[r+1]<<8|t[r]);return a},wL=function(t){for(var s=t.length,a=[],r=0;r<s;r+=4)a.push(t[r+3]<<24|t[r+2]<<16|t[r+1]<<8|t[r]);return a},Um=5,Fy=11,Uf=2,_L=Fy-Um,N5=65536>>Um,CL=1<<Um,Tf=CL-1,SL=1024>>Um,kL=N5+SL,BL=kL,FL=32,EL=BL+FL,DL=65536>>Fy,UL=1<<_L,TL=UL-1,f2=function(t,s,a){return t.slice?t.slice(s,a):new Uint16Array(Array.prototype.slice.call(t,s,a))},LL=function(t,s,a){return t.slice?t.slice(s,a):new Uint32Array(Array.prototype.slice.call(t,s,a))},QL=function(t,s){var a=vL(t),r=Array.isArray(a)?wL(a):new Uint32Array(a),l=Array.isArray(a)?NL(a):new Uint16Array(a),c=24,o=f2(l,c/2,r[4]/2),m=r[5]===2?f2(l,(c+r[4])/2):LL(r,Math.ceil((c+r[4])/4));return new RL(r[0],r[1],r[2],r[3],o,m)},RL=(function(){function t(s,a,r,l,c,o){this.initialValue=s,this.errorValue=a,this.highStart=r,this.highValueIndex=l,this.index=c,this.data=o}return t.prototype.get=function(s){var a;if(s>=0){if(s<55296||s>56319&&s<=65535)return a=this.index[s>>Um],a=(a<<Uf)+(s&Tf),this.data[a];if(s<=65535)return a=this.index[N5+(s-55296>>Um)],a=(a<<Uf)+(s&Tf),this.data[a];if(s<this.highStart)return a=EL-DL+(s>>Fy),a=this.index[a],a+=s>>Um&TL,a=this.index[a],a=(a<<Uf)+(s&Tf),this.data[a];if(s<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t})(),b2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ML=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var oA=0;oA<b2.length;oA++)ML[b2.charCodeAt(oA)]=oA;var IL="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",y2=50,$L=1,w5=2,_5=3,HL=4,PL=5,j2=7,C5=8,v2=9,Md=10,Tb=11,N2=12,Lb=13,OL=14,nh=15,Qb=16,dA=17,Zx=18,zL=19,w2=20,Rb=21,eh=22,Lf=23,Bu=24,ii=25,lh=26,ih=27,Fu=28,GL=29,Cm=30,qL=31,mA=32,uA=33,Mb=34,Ib=35,$b=36,Bh=37,Hb=38,GA=39,qA=40,Qf=41,S5=42,KL=43,VL=[9001,65288],k5="!",oa="",xA="",Pb=QL(IL),To=[Cm,$b],Ob=[$L,w5,_5,PL],B5=[Md,C5],_2=[ih,lh],YL=Ob.concat(B5),C2=[Hb,GA,qA,Mb,Ib],WL=[nh,Lb],XL=function(t,s){s===void 0&&(s="strict");var a=[],r=[],l=[];return t.forEach(function(c,o){var m=Pb.get(c);if(m>y2?(l.push(!0),m-=y2):l.push(!1),["normal","auto","loose"].indexOf(s)!==-1&&[8208,8211,12316,12448].indexOf(c)!==-1)return r.push(o),a.push(Qb);if(m===HL||m===Tb){if(o===0)return r.push(o),a.push(Cm);var u=a[o-1];return YL.indexOf(u)===-1?(r.push(r[o-1]),a.push(u)):(r.push(o),a.push(Cm))}if(r.push(o),m===qL)return a.push(s==="strict"?Rb:Bh);if(m===S5||m===GL)return a.push(Cm);if(m===KL)return c>=131072&&c<=196605||c>=196608&&c<=262141?a.push(Bh):a.push(Cm);a.push(m)}),[r,a,l]},Rf=function(t,s,a,r){var l=r[a];if(Array.isArray(t)?t.indexOf(l)!==-1:t===l)for(var c=a;c<=r.length;){c++;var o=r[c];if(o===s)return!0;if(o!==Md)break}if(l===Md)for(var c=a;c>0;){c--;var m=r[c];if(Array.isArray(t)?t.indexOf(m)!==-1:t===m)for(var u=a;u<=r.length;){u++;var o=r[u];if(o===s)return!0;if(o!==Md)break}if(m!==Md)break}return!1},S2=function(t,s){for(var a=t;a>=0;){var r=s[a];if(r===Md)a--;else return r}return 0},JL=function(t,s,a,r,l){if(a[r]===0)return oa;var c=r-1;if(Array.isArray(l)&&l[c]===!0)return oa;var o=c-1,m=c+1,u=s[c],x=o>=0?s[o]:0,A=s[m];if(u===w5&&A===_5)return oa;if(Ob.indexOf(u)!==-1)return k5;if(Ob.indexOf(A)!==-1||B5.indexOf(A)!==-1)return oa;if(S2(c,s)===C5)return xA;if(Pb.get(t[c])===Tb||(u===mA||u===uA)&&Pb.get(t[m])===Tb||u===j2||A===j2||u===v2||[Md,Lb,nh].indexOf(u)===-1&&A===v2||[dA,Zx,zL,Bu,Fu].indexOf(A)!==-1||S2(c,s)===eh||Rf(Lf,eh,c,s)||Rf([dA,Zx],Rb,c,s)||Rf(N2,N2,c,s))return oa;if(u===Md)return xA;if(u===Lf||A===Lf)return oa;if(A===Qb||u===Qb)return xA;if([Lb,nh,Rb].indexOf(A)!==-1||u===OL||x===$b&&WL.indexOf(u)!==-1||u===Fu&&A===$b||A===w2||To.indexOf(A)!==-1&&u===ii||To.indexOf(u)!==-1&&A===ii||u===ih&&[Bh,mA,uA].indexOf(A)!==-1||[Bh,mA,uA].indexOf(u)!==-1&&A===lh||To.indexOf(u)!==-1&&_2.indexOf(A)!==-1||_2.indexOf(u)!==-1&&To.indexOf(A)!==-1||[ih,lh].indexOf(u)!==-1&&(A===ii||[eh,nh].indexOf(A)!==-1&&s[m+1]===ii)||[eh,nh].indexOf(u)!==-1&&A===ii||u===ii&&[ii,Fu,Bu].indexOf(A)!==-1)return oa;if([ii,Fu,Bu,dA,Zx].indexOf(A)!==-1)for(var g=c;g>=0;){var N=s[g];if(N===ii)return oa;if([Fu,Bu].indexOf(N)!==-1)g--;else break}if([ih,lh].indexOf(A)!==-1)for(var g=[dA,Zx].indexOf(u)!==-1?o:c;g>=0;){var N=s[g];if(N===ii)return oa;if([Fu,Bu].indexOf(N)!==-1)g--;else break}if(Hb===u&&[Hb,GA,Mb,Ib].indexOf(A)!==-1||[GA,Mb].indexOf(u)!==-1&&[GA,qA].indexOf(A)!==-1||[qA,Ib].indexOf(u)!==-1&&A===qA||C2.indexOf(u)!==-1&&[w2,lh].indexOf(A)!==-1||C2.indexOf(A)!==-1&&u===ih||To.indexOf(u)!==-1&&To.indexOf(A)!==-1||u===Bu&&To.indexOf(A)!==-1||To.concat(ii).indexOf(u)!==-1&&A===eh&&VL.indexOf(t[m])===-1||To.concat(ii).indexOf(A)!==-1&&u===Zx)return oa;if(u===Qf&&A===Qf){for(var f=a[c],y=1;f>0&&(f--,s[f]===Qf);)y++;if(y%2!==0)return oa}return u===mA&&A===uA?oa:xA},ZL=function(t,s){s||(s={lineBreak:"normal",wordBreak:"normal"});var a=XL(t,s.lineBreak),r=a[0],l=a[1],c=a[2];(s.wordBreak==="break-all"||s.wordBreak==="break-word")&&(l=l.map(function(m){return[ii,Cm,S5].indexOf(m)!==-1?Bh:m}));var o=s.wordBreak==="keep-all"?c.map(function(m,u){return m&&t[u]>=19968&&t[u]<=40959}):void 0;return[r,l,o]},eQ=(function(){function t(s,a,r,l){this.codePoints=s,this.required=a===k5,this.start=r,this.end=l}return t.prototype.slice=function(){return Xr.apply(void 0,this.codePoints.slice(this.start,this.end))},t})(),tQ=function(t,s){var a=kg(t),r=ZL(a,s),l=r[0],c=r[1],o=r[2],m=a.length,u=0,x=0;return{next:function(){if(x>=m)return{done:!0,value:null};for(var A=oa;x<m&&(A=JL(a,c,l,++x,o))===oa;);if(A!==oa||x===m){var g=new eQ(a,A,u,x);return u=x,{value:g,done:!1}}return{done:!0,value:null}}}},sQ=1,aQ=2,zh=4,k2=8,lg=10,B2=47,ph=92,rQ=9,nQ=32,hA=34,th=61,lQ=35,iQ=36,cQ=37,pA=39,AA=40,sh=41,oQ=95,Hl=45,dQ=33,mQ=60,uQ=62,xQ=64,hQ=91,pQ=93,AQ=61,gQ=123,gA=63,fQ=125,F2=124,bQ=126,yQ=128,E2=65533,Mf=42,Fm=43,jQ=44,vQ=58,NQ=59,Fh=46,wQ=0,_Q=8,CQ=11,SQ=14,kQ=31,BQ=127,qc=-1,F5=48,E5=97,D5=101,FQ=102,EQ=117,DQ=122,U5=65,T5=69,L5=70,UQ=85,TQ=90,tl=function(t){return t>=F5&&t<=57},LQ=function(t){return t>=55296&&t<=57343},Eu=function(t){return tl(t)||t>=U5&&t<=L5||t>=E5&&t<=FQ},QQ=function(t){return t>=E5&&t<=DQ},RQ=function(t){return t>=U5&&t<=TQ},MQ=function(t){return QQ(t)||RQ(t)},IQ=function(t){return t>=yQ},fA=function(t){return t===lg||t===rQ||t===nQ},ig=function(t){return MQ(t)||IQ(t)||t===oQ},D2=function(t){return ig(t)||tl(t)||t===Hl},$Q=function(t){return t>=wQ&&t<=_Q||t===CQ||t>=SQ&&t<=kQ||t===BQ},Td=function(t,s){return t!==ph?!1:s!==lg},bA=function(t,s,a){return t===Hl?ig(s)||Td(s,a):ig(t)?!0:!!(t===ph&&Td(t,s))},If=function(t,s,a){return t===Fm||t===Hl?tl(s)?!0:s===Fh&&tl(a):tl(t===Fh?s:t)},HQ=function(t){var s=0,a=1;(t[s]===Fm||t[s]===Hl)&&(t[s]===Hl&&(a=-1),s++);for(var r=[];tl(t[s]);)r.push(t[s++]);var l=r.length?parseInt(Xr.apply(void 0,r),10):0;t[s]===Fh&&s++;for(var c=[];tl(t[s]);)c.push(t[s++]);var o=c.length,m=o?parseInt(Xr.apply(void 0,c),10):0;(t[s]===T5||t[s]===D5)&&s++;var u=1;(t[s]===Fm||t[s]===Hl)&&(t[s]===Hl&&(u=-1),s++);for(var x=[];tl(t[s]);)x.push(t[s++]);var A=x.length?parseInt(Xr.apply(void 0,x),10):0;return a*(l+m*Math.pow(10,-o))*Math.pow(10,u*A)},PQ={type:2},OQ={type:3},zQ={type:4},GQ={type:13},qQ={type:8},KQ={type:21},VQ={type:9},YQ={type:10},WQ={type:11},XQ={type:12},JQ={type:14},yA={type:23},ZQ={type:1},eR={type:25},tR={type:24},sR={type:26},aR={type:27},rR={type:28},nR={type:29},lR={type:31},zb={type:32},Q5=(function(){function t(){this._value=[]}return t.prototype.write=function(s){this._value=this._value.concat(kg(s))},t.prototype.read=function(){for(var s=[],a=this.consumeToken();a!==zb;)s.push(a),a=this.consumeToken();return s},t.prototype.consumeToken=function(){var s=this.consumeCodePoint();switch(s){case hA:return this.consumeStringToken(hA);case lQ:var a=this.peekCodePoint(0),r=this.peekCodePoint(1),l=this.peekCodePoint(2);if(D2(a)||Td(r,l)){var c=bA(a,r,l)?aQ:sQ,o=this.consumeName();return{type:5,value:o,flags:c}}break;case iQ:if(this.peekCodePoint(0)===th)return this.consumeCodePoint(),GQ;break;case pA:return this.consumeStringToken(pA);case AA:return PQ;case sh:return OQ;case Mf:if(this.peekCodePoint(0)===th)return this.consumeCodePoint(),JQ;break;case Fm:if(If(s,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(s),this.consumeNumericToken();break;case jQ:return zQ;case Hl:var m=s,u=this.peekCodePoint(0),x=this.peekCodePoint(1);if(If(m,u,x))return this.reconsumeCodePoint(s),this.consumeNumericToken();if(bA(m,u,x))return this.reconsumeCodePoint(s),this.consumeIdentLikeToken();if(u===Hl&&x===uQ)return this.consumeCodePoint(),this.consumeCodePoint(),tR;break;case Fh:if(If(s,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(s),this.consumeNumericToken();break;case B2:if(this.peekCodePoint(0)===Mf)for(this.consumeCodePoint();;){var A=this.consumeCodePoint();if(A===Mf&&(A=this.consumeCodePoint(),A===B2))return this.consumeToken();if(A===qc)return this.consumeToken()}break;case vQ:return sR;case NQ:return aR;case mQ:if(this.peekCodePoint(0)===dQ&&this.peekCodePoint(1)===Hl&&this.peekCodePoint(2)===Hl)return this.consumeCodePoint(),this.consumeCodePoint(),eR;break;case xQ:var g=this.peekCodePoint(0),N=this.peekCodePoint(1),f=this.peekCodePoint(2);if(bA(g,N,f)){var o=this.consumeName();return{type:7,value:o}}break;case hQ:return rR;case ph:if(Td(s,this.peekCodePoint(0)))return this.reconsumeCodePoint(s),this.consumeIdentLikeToken();break;case pQ:return nR;case AQ:if(this.peekCodePoint(0)===th)return this.consumeCodePoint(),qQ;break;case gQ:return WQ;case fQ:return XQ;case EQ:case UQ:var y=this.peekCodePoint(0),v=this.peekCodePoint(1);return y===Fm&&(Eu(v)||v===gA)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(s),this.consumeIdentLikeToken();case F2:if(this.peekCodePoint(0)===th)return this.consumeCodePoint(),VQ;if(this.peekCodePoint(0)===F2)return this.consumeCodePoint(),KQ;break;case bQ:if(this.peekCodePoint(0)===th)return this.consumeCodePoint(),YQ;break;case qc:return zb}return fA(s)?(this.consumeWhiteSpace(),lR):tl(s)?(this.reconsumeCodePoint(s),this.consumeNumericToken()):ig(s)?(this.reconsumeCodePoint(s),this.consumeIdentLikeToken()):{type:6,value:Xr(s)}},t.prototype.consumeCodePoint=function(){var s=this._value.shift();return typeof s>"u"?-1:s},t.prototype.reconsumeCodePoint=function(s){this._value.unshift(s)},t.prototype.peekCodePoint=function(s){return s>=this._value.length?-1:this._value[s]},t.prototype.consumeUnicodeRangeToken=function(){for(var s=[],a=this.consumeCodePoint();Eu(a)&&s.length<6;)s.push(a),a=this.consumeCodePoint();for(var r=!1;a===gA&&s.length<6;)s.push(a),a=this.consumeCodePoint(),r=!0;if(r){var l=parseInt(Xr.apply(void 0,s.map(function(u){return u===gA?F5:u})),16),c=parseInt(Xr.apply(void 0,s.map(function(u){return u===gA?L5:u})),16);return{type:30,start:l,end:c}}var o=parseInt(Xr.apply(void 0,s),16);if(this.peekCodePoint(0)===Hl&&Eu(this.peekCodePoint(1))){this.consumeCodePoint(),a=this.consumeCodePoint();for(var m=[];Eu(a)&&m.length<6;)m.push(a),a=this.consumeCodePoint();var c=parseInt(Xr.apply(void 0,m),16);return{type:30,start:o,end:c}}else return{type:30,start:o,end:o}},t.prototype.consumeIdentLikeToken=function(){var s=this.consumeName();return s.toLowerCase()==="url"&&this.peekCodePoint(0)===AA?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===AA?(this.consumeCodePoint(),{type:19,value:s}):{type:20,value:s}},t.prototype.consumeUrlToken=function(){var s=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===qc)return{type:22,value:""};var a=this.peekCodePoint(0);if(a===pA||a===hA){var r=this.consumeStringToken(this.consumeCodePoint());return r.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===qc||this.peekCodePoint(0)===sh)?(this.consumeCodePoint(),{type:22,value:r.value}):(this.consumeBadUrlRemnants(),yA)}for(;;){var l=this.consumeCodePoint();if(l===qc||l===sh)return{type:22,value:Xr.apply(void 0,s)};if(fA(l))return this.consumeWhiteSpace(),this.peekCodePoint(0)===qc||this.peekCodePoint(0)===sh?(this.consumeCodePoint(),{type:22,value:Xr.apply(void 0,s)}):(this.consumeBadUrlRemnants(),yA);if(l===hA||l===pA||l===AA||$Q(l))return this.consumeBadUrlRemnants(),yA;if(l===ph)if(Td(l,this.peekCodePoint(0)))s.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),yA;else s.push(l)}},t.prototype.consumeWhiteSpace=function(){for(;fA(this.peekCodePoint(0));)this.consumeCodePoint()},t.prototype.consumeBadUrlRemnants=function(){for(;;){var s=this.consumeCodePoint();if(s===sh||s===qc)return;Td(s,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},t.prototype.consumeStringSlice=function(s){for(var a=5e4,r="";s>0;){var l=Math.min(a,s);r+=Xr.apply(void 0,this._value.splice(0,l)),s-=l}return this._value.shift(),r},t.prototype.consumeStringToken=function(s){var a="",r=0;do{var l=this._value[r];if(l===qc||l===void 0||l===s)return a+=this.consumeStringSlice(r),{type:0,value:a};if(l===lg)return this._value.splice(0,r),ZQ;if(l===ph){var c=this._value[r+1];c!==qc&&c!==void 0&&(c===lg?(a+=this.consumeStringSlice(r),r=-1,this._value.shift()):Td(l,c)&&(a+=this.consumeStringSlice(r),a+=Xr(this.consumeEscapedCodePoint()),r=-1))}r++}while(!0)},t.prototype.consumeNumber=function(){var s=[],a=zh,r=this.peekCodePoint(0);for((r===Fm||r===Hl)&&s.push(this.consumeCodePoint());tl(this.peekCodePoint(0));)s.push(this.consumeCodePoint());r=this.peekCodePoint(0);var l=this.peekCodePoint(1);if(r===Fh&&tl(l))for(s.push(this.consumeCodePoint(),this.consumeCodePoint()),a=k2;tl(this.peekCodePoint(0));)s.push(this.consumeCodePoint());r=this.peekCodePoint(0),l=this.peekCodePoint(1);var c=this.peekCodePoint(2);if((r===T5||r===D5)&&((l===Fm||l===Hl)&&tl(c)||tl(l)))for(s.push(this.consumeCodePoint(),this.consumeCodePoint()),a=k2;tl(this.peekCodePoint(0));)s.push(this.consumeCodePoint());return[HQ(s),a]},t.prototype.consumeNumericToken=function(){var s=this.consumeNumber(),a=s[0],r=s[1],l=this.peekCodePoint(0),c=this.peekCodePoint(1),o=this.peekCodePoint(2);if(bA(l,c,o)){var m=this.consumeName();return{type:15,number:a,flags:r,unit:m}}return l===cQ?(this.consumeCodePoint(),{type:16,number:a,flags:r}):{type:17,number:a,flags:r}},t.prototype.consumeEscapedCodePoint=function(){var s=this.consumeCodePoint();if(Eu(s)){for(var a=Xr(s);Eu(this.peekCodePoint(0))&&a.length<6;)a+=Xr(this.consumeCodePoint());fA(this.peekCodePoint(0))&&this.consumeCodePoint();var r=parseInt(a,16);return r===0||LQ(r)||r>1114111?E2:r}return s===qc?E2:s},t.prototype.consumeName=function(){for(var s="";;){var a=this.consumeCodePoint();if(D2(a))s+=Xr(a);else if(Td(a,this.peekCodePoint(0)))s+=Xr(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(a),s}},t})(),R5=(function(){function t(s){this._tokens=s}return t.create=function(s){var a=new Q5;return a.write(s),new t(a.read())},t.parseValue=function(s){return t.create(s).parseComponentValue()},t.parseValues=function(s){return t.create(s).parseComponentValues()},t.prototype.parseComponentValue=function(){for(var s=this.consumeToken();s.type===31;)s=this.consumeToken();if(s.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(s);var a=this.consumeComponentValue();do s=this.consumeToken();while(s.type===31);if(s.type===32)return a;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},t.prototype.parseComponentValues=function(){for(var s=[];;){var a=this.consumeComponentValue();if(a.type===32)return s;s.push(a),s.push()}},t.prototype.consumeComponentValue=function(){var s=this.consumeToken();switch(s.type){case 11:case 28:case 2:return this.consumeSimpleBlock(s.type);case 19:return this.consumeFunction(s)}return s},t.prototype.consumeSimpleBlock=function(s){for(var a={type:s,values:[]},r=this.consumeToken();;){if(r.type===32||cR(r,s))return a;this.reconsumeToken(r),a.values.push(this.consumeComponentValue()),r=this.consumeToken()}},t.prototype.consumeFunction=function(s){for(var a={name:s.value,values:[],type:18};;){var r=this.consumeToken();if(r.type===32||r.type===3)return a;this.reconsumeToken(r),a.values.push(this.consumeComponentValue())}},t.prototype.consumeToken=function(){var s=this._tokens.shift();return typeof s>"u"?zb:s},t.prototype.reconsumeToken=function(s){this._tokens.unshift(s)},t})(),Gh=function(t){return t.type===15},ix=function(t){return t.type===17},qa=function(t){return t.type===20},iR=function(t){return t.type===0},Gb=function(t,s){return qa(t)&&t.value===s},M5=function(t){return t.type!==31},Zu=function(t){return t.type!==31&&t.type!==4},Zc=function(t){var s=[],a=[];return t.forEach(function(r){if(r.type===4){if(a.length===0)throw new Error("Error parsing function args, zero tokens for arg");s.push(a),a=[];return}r.type!==31&&a.push(r)}),a.length&&s.push(a),s},cR=function(t,s){return s===11&&t.type===12||s===28&&t.type===29?!0:s===2&&t.type===3},Gd=function(t){return t.type===17||t.type===15},on=function(t){return t.type===16||Gd(t)},I5=function(t){return t.length>1?[t[0],t[1]]:[t[0]]},Gn={type:17,number:0,flags:zh},Ey={type:16,number:50,flags:zh},Id={type:16,number:100,flags:zh},ch=function(t,s,a){var r=t[0],l=t[1];return[Za(r,s),Za(typeof l<"u"?l:r,a)]},Za=function(t,s){if(t.type===16)return t.number/100*s;if(Gh(t))switch(t.unit){case"rem":case"em":return 16*t.number;case"px":default:return t.number}return t.number},$5="deg",H5="grad",P5="rad",O5="turn",Bg={name:"angle",parse:function(t,s){if(s.type===15)switch(s.unit){case $5:return Math.PI*s.number/180;case H5:return Math.PI/200*s.number;case P5:return s.number;case O5:return Math.PI*2*s.number}throw new Error("Unsupported angle type")}},z5=function(t){return t.type===15&&(t.unit===$5||t.unit===H5||t.unit===P5||t.unit===O5)},G5=function(t){var s=t.filter(qa).map(function(a){return a.value}).join(" ");switch(s){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Gn,Gn];case"to top":case"bottom":return Fi(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Gn,Id];case"to right":case"left":return Fi(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[Id,Id];case"to bottom":case"top":return Fi(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[Id,Gn];case"to left":case"right":return Fi(270)}return 0},Fi=function(t){return Math.PI*t/180},Pd={name:"color",parse:function(t,s){if(s.type===18){var a=oR[s.name];if(typeof a>"u")throw new Error('Attempting to parse an unsupported color function "'+s.name+'"');return a(t,s.values)}if(s.type===5){if(s.value.length===3){var r=s.value.substring(0,1),l=s.value.substring(1,2),c=s.value.substring(2,3);return $d(parseInt(r+r,16),parseInt(l+l,16),parseInt(c+c,16),1)}if(s.value.length===4){var r=s.value.substring(0,1),l=s.value.substring(1,2),c=s.value.substring(2,3),o=s.value.substring(3,4);return $d(parseInt(r+r,16),parseInt(l+l,16),parseInt(c+c,16),parseInt(o+o,16)/255)}if(s.value.length===6){var r=s.value.substring(0,2),l=s.value.substring(2,4),c=s.value.substring(4,6);return $d(parseInt(r,16),parseInt(l,16),parseInt(c,16),1)}if(s.value.length===8){var r=s.value.substring(0,2),l=s.value.substring(2,4),c=s.value.substring(4,6),o=s.value.substring(6,8);return $d(parseInt(r,16),parseInt(l,16),parseInt(c,16),parseInt(o,16)/255)}}if(s.type===20){var m=Ho[s.value.toUpperCase()];if(typeof m<"u")return m}return Ho.TRANSPARENT}},Od=function(t){return(255&t)===0},Dn=function(t){var s=255&t,a=255&t>>8,r=255&t>>16,l=255&t>>24;return s<255?"rgba("+l+","+r+","+a+","+s/255+")":"rgb("+l+","+r+","+a+")"},$d=function(t,s,a,r){return(t<<24|s<<16|a<<8|Math.round(r*255)<<0)>>>0},U2=function(t,s){if(t.type===17)return t.number;if(t.type===16){var a=s===3?1:255;return s===3?t.number/100*a:Math.round(t.number/100*a)}return 0},T2=function(t,s){var a=s.filter(Zu);if(a.length===3){var r=a.map(U2),l=r[0],c=r[1],o=r[2];return $d(l,c,o,1)}if(a.length===4){var m=a.map(U2),l=m[0],c=m[1],o=m[2],u=m[3];return $d(l,c,o,u)}return 0};function $f(t,s,a){return a<0&&(a+=1),a>=1&&(a-=1),a<1/6?(s-t)*a*6+t:a<1/2?s:a<2/3?(s-t)*6*(2/3-a)+t:t}var L2=function(t,s){var a=s.filter(Zu),r=a[0],l=a[1],c=a[2],o=a[3],m=(r.type===17?Fi(r.number):Bg.parse(t,r))/(Math.PI*2),u=on(l)?l.number/100:0,x=on(c)?c.number/100:0,A=typeof o<"u"&&on(o)?Za(o,1):1;if(u===0)return $d(x*255,x*255,x*255,1);var g=x<=.5?x*(u+1):x+u-x*u,N=x*2-g,f=$f(N,g,m+1/3),y=$f(N,g,m),v=$f(N,g,m-1/3);return $d(f*255,y*255,v*255,A)},oR={hsl:L2,hsla:L2,rgb:T2,rgba:T2},Ah=function(t,s){return Pd.parse(t,R5.create(s).parseComponentValue())},Ho={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},dR={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(t,s){return s.map(function(a){if(qa(a))switch(a.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},mR={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Fg=function(t,s){var a=Pd.parse(t,s[0]),r=s[1];return r&&on(r)?{color:a,stop:r}:{color:a,stop:null}},Q2=function(t,s){var a=t[0],r=t[t.length-1];a.stop===null&&(a.stop=Gn),r.stop===null&&(r.stop=Id);for(var l=[],c=0,o=0;o<t.length;o++){var m=t[o].stop;if(m!==null){var u=Za(m,s);u>c?l.push(u):l.push(c),c=u}else l.push(null)}for(var x=null,o=0;o<l.length;o++){var A=l[o];if(A===null)x===null&&(x=o);else if(x!==null){for(var g=o-x,N=l[x-1],f=(A-N)/(g+1),y=1;y<=g;y++)l[x+y-1]=f*y;x=null}}return t.map(function(v,U){var D=v.color;return{color:D,stop:Math.max(Math.min(1,l[U]/s),0)}})},uR=function(t,s,a){var r=s/2,l=a/2,c=Za(t[0],s)-r,o=l-Za(t[1],a);return(Math.atan2(o,c)+Math.PI*2)%(Math.PI*2)},xR=function(t,s,a){var r=typeof t=="number"?t:uR(t,s,a),l=Math.abs(s*Math.sin(r))+Math.abs(a*Math.cos(r)),c=s/2,o=a/2,m=l/2,u=Math.sin(r-Math.PI/2)*m,x=Math.cos(r-Math.PI/2)*m;return[l,c-x,c+x,o-u,o+u]},hc=function(t,s){return Math.sqrt(t*t+s*s)},R2=function(t,s,a,r,l){var c=[[0,0],[0,s],[t,0],[t,s]];return c.reduce(function(o,m){var u=m[0],x=m[1],A=hc(a-u,r-x);return(l?A<o.optimumDistance:A>o.optimumDistance)?{optimumCorner:m,optimumDistance:A}:o},{optimumDistance:l?1/0:-1/0,optimumCorner:null}).optimumCorner},hR=function(t,s,a,r,l){var c=0,o=0;switch(t.size){case 0:t.shape===0?c=o=Math.min(Math.abs(s),Math.abs(s-r),Math.abs(a),Math.abs(a-l)):t.shape===1&&(c=Math.min(Math.abs(s),Math.abs(s-r)),o=Math.min(Math.abs(a),Math.abs(a-l)));break;case 2:if(t.shape===0)c=o=Math.min(hc(s,a),hc(s,a-l),hc(s-r,a),hc(s-r,a-l));else if(t.shape===1){var m=Math.min(Math.abs(a),Math.abs(a-l))/Math.min(Math.abs(s),Math.abs(s-r)),u=R2(r,l,s,a,!0),x=u[0],A=u[1];c=hc(x-s,(A-a)/m),o=m*c}break;case 1:t.shape===0?c=o=Math.max(Math.abs(s),Math.abs(s-r),Math.abs(a),Math.abs(a-l)):t.shape===1&&(c=Math.max(Math.abs(s),Math.abs(s-r)),o=Math.max(Math.abs(a),Math.abs(a-l)));break;case 3:if(t.shape===0)c=o=Math.max(hc(s,a),hc(s,a-l),hc(s-r,a),hc(s-r,a-l));else if(t.shape===1){var m=Math.max(Math.abs(a),Math.abs(a-l))/Math.max(Math.abs(s),Math.abs(s-r)),g=R2(r,l,s,a,!1),x=g[0],A=g[1];c=hc(x-s,(A-a)/m),o=m*c}break}return Array.isArray(t.size)&&(c=Za(t.size[0],r),o=t.size.length===2?Za(t.size[1],l):c),[c,o]},pR=function(t,s){var a=Fi(180),r=[];return Zc(s).forEach(function(l,c){if(c===0){var o=l[0];if(o.type===20&&o.value==="to"){a=G5(l);return}else if(z5(o)){a=Bg.parse(t,o);return}}var m=Fg(t,l);r.push(m)}),{angle:a,stops:r,type:1}},jA=function(t,s){var a=Fi(180),r=[];return Zc(s).forEach(function(l,c){if(c===0){var o=l[0];if(o.type===20&&["top","left","right","bottom"].indexOf(o.value)!==-1){a=G5(l);return}else if(z5(o)){a=(Bg.parse(t,o)+Fi(270))%Fi(360);return}}var m=Fg(t,l);r.push(m)}),{angle:a,stops:r,type:1}},AR=function(t,s){var a=Fi(180),r=[],l=1,c=0,o=3,m=[];return Zc(s).forEach(function(u,x){var A=u[0];if(x===0){if(qa(A)&&A.value==="linear"){l=1;return}else if(qa(A)&&A.value==="radial"){l=2;return}}if(A.type===18){if(A.name==="from"){var g=Pd.parse(t,A.values[0]);r.push({stop:Gn,color:g})}else if(A.name==="to"){var g=Pd.parse(t,A.values[0]);r.push({stop:Id,color:g})}else if(A.name==="color-stop"){var N=A.values.filter(Zu);if(N.length===2){var g=Pd.parse(t,N[1]),f=N[0];ix(f)&&r.push({stop:{type:16,number:f.number*100,flags:f.flags},color:g})}}}}),l===1?{angle:(a+Fi(180))%Fi(360),stops:r,type:l}:{size:o,shape:c,stops:r,position:m,type:l}},q5="closest-side",K5="farthest-side",V5="closest-corner",Y5="farthest-corner",W5="circle",X5="ellipse",J5="cover",Z5="contain",gR=function(t,s){var a=0,r=3,l=[],c=[];return Zc(s).forEach(function(o,m){var u=!0;if(m===0){var x=!1;u=o.reduce(function(g,N){if(x)if(qa(N))switch(N.value){case"center":return c.push(Ey),g;case"top":case"left":return c.push(Gn),g;case"right":case"bottom":return c.push(Id),g}else(on(N)||Gd(N))&&c.push(N);else if(qa(N))switch(N.value){case W5:return a=0,!1;case X5:return a=1,!1;case"at":return x=!0,!1;case q5:return r=0,!1;case J5:case K5:return r=1,!1;case Z5:case V5:return r=2,!1;case Y5:return r=3,!1}else if(Gd(N)||on(N))return Array.isArray(r)||(r=[]),r.push(N),!1;return g},u)}if(u){var A=Fg(t,o);l.push(A)}}),{size:r,shape:a,stops:l,position:c,type:2}},vA=function(t,s){var a=0,r=3,l=[],c=[];return Zc(s).forEach(function(o,m){var u=!0;if(m===0?u=o.reduce(function(A,g){if(qa(g))switch(g.value){case"center":return c.push(Ey),!1;case"top":case"left":return c.push(Gn),!1;case"right":case"bottom":return c.push(Id),!1}else if(on(g)||Gd(g))return c.push(g),!1;return A},u):m===1&&(u=o.reduce(function(A,g){if(qa(g))switch(g.value){case W5:return a=0,!1;case X5:return a=1,!1;case Z5:case q5:return r=0,!1;case K5:return r=1,!1;case V5:return r=2,!1;case J5:case Y5:return r=3,!1}else if(Gd(g)||on(g))return Array.isArray(r)||(r=[]),r.push(g),!1;return A},u)),u){var x=Fg(t,o);l.push(x)}}),{size:r,shape:a,stops:l,position:c,type:2}},fR=function(t){return t.type===1},bR=function(t){return t.type===2},Dy={name:"image",parse:function(t,s){if(s.type===22){var a={url:s.value,type:0};return t.cache.addImage(s.value),a}if(s.type===18){var r=e_[s.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported image function "'+s.name+'"');return r(t,s.values)}throw new Error("Unsupported image type "+s.type)}};function yR(t){return!(t.type===20&&t.value==="none")&&(t.type!==18||!!e_[t.name])}var e_={"linear-gradient":pR,"-moz-linear-gradient":jA,"-ms-linear-gradient":jA,"-o-linear-gradient":jA,"-webkit-linear-gradient":jA,"radial-gradient":gR,"-moz-radial-gradient":vA,"-ms-radial-gradient":vA,"-o-radial-gradient":vA,"-webkit-radial-gradient":vA,"-webkit-gradient":AR},jR={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(t,s){if(s.length===0)return[];var a=s[0];return a.type===20&&a.value==="none"?[]:s.filter(function(r){return Zu(r)&&yR(r)}).map(function(r){return Dy.parse(t,r)})}},vR={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(t,s){return s.map(function(a){if(qa(a))switch(a.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},NR={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(t,s){return Zc(s).map(function(a){return a.filter(on)}).map(I5)}},wR={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(t,s){return Zc(s).map(function(a){return a.filter(qa).map(function(r){return r.value}).join(" ")}).map(_R)}},_R=function(t){switch(t){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},Wu;(function(t){t.AUTO="auto",t.CONTAIN="contain",t.COVER="cover"})(Wu||(Wu={}));var CR={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(t,s){return Zc(s).map(function(a){return a.filter(SR)})}},SR=function(t){return qa(t)||on(t)},Eg=function(t){return{name:"border-"+t+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},kR=Eg("top"),BR=Eg("right"),FR=Eg("bottom"),ER=Eg("left"),Dg=function(t){return{name:"border-radius-"+t,initialValue:"0 0",prefix:!1,type:1,parse:function(s,a){return I5(a.filter(on))}}},DR=Dg("top-left"),UR=Dg("top-right"),TR=Dg("bottom-right"),LR=Dg("bottom-left"),Ug=function(t){return{name:"border-"+t+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(s,a){switch(a){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},QR=Ug("top"),RR=Ug("right"),MR=Ug("bottom"),IR=Ug("left"),Tg=function(t){return{name:"border-"+t+"-width",initialValue:"0",type:0,prefix:!1,parse:function(s,a){return Gh(a)?a.number:0}}},$R=Tg("top"),HR=Tg("right"),PR=Tg("bottom"),OR=Tg("left"),zR={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},GR={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(t,s){switch(s){case"rtl":return 1;case"ltr":default:return 0}}},qR={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(t,s){return s.filter(qa).reduce(function(a,r){return a|KR(r.value)},0)}},KR=function(t){switch(t){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},VR={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(t,s){switch(s){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},YR={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(t,s){return s.type===20&&s.value==="normal"?0:s.type===17||s.type===15?s.number:0}},cg;(function(t){t.NORMAL="normal",t.STRICT="strict"})(cg||(cg={}));var WR={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,s){switch(s){case"strict":return cg.STRICT;case"normal":default:return cg.NORMAL}}},XR={name:"line-height",initialValue:"normal",prefix:!1,type:4},M2=function(t,s){return qa(t)&&t.value==="normal"?1.2*s:t.type===17?s*t.number:on(t)?Za(t,s):s},JR={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(t,s){return s.type===20&&s.value==="none"?null:Dy.parse(t,s)}},ZR={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(t,s){switch(s){case"inside":return 0;case"outside":default:return 1}}},qb={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(t,s){switch(s){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},Lg=function(t){return{name:"margin-"+t,initialValue:"0",prefix:!1,type:4}},eM=Lg("top"),tM=Lg("right"),sM=Lg("bottom"),aM=Lg("left"),rM={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(t,s){return s.filter(qa).map(function(a){switch(a.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},nM={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(t,s){switch(s){case"break-word":return"break-word";case"normal":default:return"normal"}}},Qg=function(t){return{name:"padding-"+t,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},lM=Qg("top"),iM=Qg("right"),cM=Qg("bottom"),oM=Qg("left"),dM={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(t,s){switch(s){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},mM={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(t,s){switch(s){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},uM={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,s){return s.length===1&&Gb(s[0],"none")?[]:Zc(s).map(function(a){for(var r={color:Ho.TRANSPARENT,offsetX:Gn,offsetY:Gn,blur:Gn},l=0,c=0;c<a.length;c++){var o=a[c];Gd(o)?(l===0?r.offsetX=o:l===1?r.offsetY=o:r.blur=o,l++):r.color=Pd.parse(t,o)}return r})}},xM={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(t,s){switch(s){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},hM={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(t,s){if(s.type===20&&s.value==="none")return null;if(s.type===18){var a=gM[s.name];if(typeof a>"u")throw new Error('Attempting to parse an unsupported transform function "'+s.name+'"');return a(s.values)}return null}},pM=function(t){var s=t.filter(function(a){return a.type===17}).map(function(a){return a.number});return s.length===6?s:null},AM=function(t){var s=t.filter(function(u){return u.type===17}).map(function(u){return u.number}),a=s[0],r=s[1];s[2],s[3];var l=s[4],c=s[5];s[6],s[7],s[8],s[9],s[10],s[11];var o=s[12],m=s[13];return s[14],s[15],s.length===16?[a,r,l,c,o,m]:null},gM={matrix:pM,matrix3d:AM},I2={type:16,number:50,flags:zh},fM=[I2,I2],bM={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(t,s){var a=s.filter(on);return a.length!==2?fM:[a[0],a[1]]}},yM={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(t,s){switch(s){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},gh;(function(t){t.NORMAL="normal",t.BREAK_ALL="break-all",t.KEEP_ALL="keep-all"})(gh||(gh={}));var jM={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,s){switch(s){case"break-all":return gh.BREAK_ALL;case"keep-all":return gh.KEEP_ALL;case"normal":default:return gh.NORMAL}}},vM={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(t,s){if(s.type===20)return{auto:!0,order:0};if(ix(s))return{auto:!1,order:s.number};throw new Error("Invalid z-index number parsed")}},t_={name:"time",parse:function(t,s){if(s.type===15)switch(s.unit.toLowerCase()){case"s":return 1e3*s.number;case"ms":return s.number}throw new Error("Unsupported time type")}},NM={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(t,s){return ix(s)?s.number:1}},wM={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},_M={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(t,s){return s.filter(qa).map(function(a){switch(a.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(a){return a!==0})}},CM={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(t,s){var a=[],r=[];return s.forEach(function(l){switch(l.type){case 20:case 0:a.push(l.value);break;case 17:a.push(l.number.toString());break;case 4:r.push(a.join(" ")),a.length=0;break}}),a.length&&r.push(a.join(" ")),r.map(function(l){return l.indexOf(" ")===-1?l:"'"+l+"'"})}},SM={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},kM={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(t,s){if(ix(s))return s.number;if(qa(s))switch(s.value){case"bold":return 700;case"normal":default:return 400}return 400}},BM={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(t,s){return s.filter(qa).map(function(a){return a.value})}},FM={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(t,s){switch(s){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},_n=function(t,s){return(t&s)!==0},EM={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(t,s){if(s.length===0)return[];var a=s[0];return a.type===20&&a.value==="none"?[]:s}},DM={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(t,s){if(s.length===0)return null;var a=s[0];if(a.type===20&&a.value==="none")return null;for(var r=[],l=s.filter(M5),c=0;c<l.length;c++){var o=l[c],m=l[c+1];if(o.type===20){var u=m&&ix(m)?m.number:1;r.push({counter:o.value,increment:u})}}return r}},UM={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(t,s){if(s.length===0)return[];for(var a=[],r=s.filter(M5),l=0;l<r.length;l++){var c=r[l],o=r[l+1];if(qa(c)&&c.value!=="none"){var m=o&&ix(o)?o.number:0;a.push({counter:c.value,reset:m})}}return a}},TM={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(t,s){return s.filter(Gh).map(function(a){return t_.parse(t,a)})}},LM={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(t,s){if(s.length===0)return null;var a=s[0];if(a.type===20&&a.value==="none")return null;var r=[],l=s.filter(iR);if(l.length%2!==0)return null;for(var c=0;c<l.length;c+=2){var o=l[c].value,m=l[c+1].value;r.push({open:o,close:m})}return r}},$2=function(t,s,a){if(!t)return"";var r=t[Math.min(s,t.length-1)];return r?a?r.open:r.close:""},QM={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,s){return s.length===1&&Gb(s[0],"none")?[]:Zc(s).map(function(a){for(var r={color:255,offsetX:Gn,offsetY:Gn,blur:Gn,spread:Gn,inset:!1},l=0,c=0;c<a.length;c++){var o=a[c];Gb(o,"inset")?r.inset=!0:Gd(o)?(l===0?r.offsetX=o:l===1?r.offsetY=o:l===2?r.blur=o:r.spread=o,l++):r.color=Pd.parse(t,o)}return r})}},RM={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(t,s){var a=[0,1,2],r=[];return s.filter(qa).forEach(function(l){switch(l.value){case"stroke":r.push(1);break;case"fill":r.push(0);break;case"markers":r.push(2);break}}),a.forEach(function(l){r.indexOf(l)===-1&&r.push(l)}),r}},MM={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},IM={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(t,s){return Gh(s)?s.number:0}},$M=(function(){function t(s,a){var r,l;this.animationDuration=ds(s,TM,a.animationDuration),this.backgroundClip=ds(s,dR,a.backgroundClip),this.backgroundColor=ds(s,mR,a.backgroundColor),this.backgroundImage=ds(s,jR,a.backgroundImage),this.backgroundOrigin=ds(s,vR,a.backgroundOrigin),this.backgroundPosition=ds(s,NR,a.backgroundPosition),this.backgroundRepeat=ds(s,wR,a.backgroundRepeat),this.backgroundSize=ds(s,CR,a.backgroundSize),this.borderTopColor=ds(s,kR,a.borderTopColor),this.borderRightColor=ds(s,BR,a.borderRightColor),this.borderBottomColor=ds(s,FR,a.borderBottomColor),this.borderLeftColor=ds(s,ER,a.borderLeftColor),this.borderTopLeftRadius=ds(s,DR,a.borderTopLeftRadius),this.borderTopRightRadius=ds(s,UR,a.borderTopRightRadius),this.borderBottomRightRadius=ds(s,TR,a.borderBottomRightRadius),this.borderBottomLeftRadius=ds(s,LR,a.borderBottomLeftRadius),this.borderTopStyle=ds(s,QR,a.borderTopStyle),this.borderRightStyle=ds(s,RR,a.borderRightStyle),this.borderBottomStyle=ds(s,MR,a.borderBottomStyle),this.borderLeftStyle=ds(s,IR,a.borderLeftStyle),this.borderTopWidth=ds(s,$R,a.borderTopWidth),this.borderRightWidth=ds(s,HR,a.borderRightWidth),this.borderBottomWidth=ds(s,PR,a.borderBottomWidth),this.borderLeftWidth=ds(s,OR,a.borderLeftWidth),this.boxShadow=ds(s,QM,a.boxShadow),this.color=ds(s,zR,a.color),this.direction=ds(s,GR,a.direction),this.display=ds(s,qR,a.display),this.float=ds(s,VR,a.cssFloat),this.fontFamily=ds(s,CM,a.fontFamily),this.fontSize=ds(s,SM,a.fontSize),this.fontStyle=ds(s,FM,a.fontStyle),this.fontVariant=ds(s,BM,a.fontVariant),this.fontWeight=ds(s,kM,a.fontWeight),this.letterSpacing=ds(s,YR,a.letterSpacing),this.lineBreak=ds(s,WR,a.lineBreak),this.lineHeight=ds(s,XR,a.lineHeight),this.listStyleImage=ds(s,JR,a.listStyleImage),this.listStylePosition=ds(s,ZR,a.listStylePosition),this.listStyleType=ds(s,qb,a.listStyleType),this.marginTop=ds(s,eM,a.marginTop),this.marginRight=ds(s,tM,a.marginRight),this.marginBottom=ds(s,sM,a.marginBottom),this.marginLeft=ds(s,aM,a.marginLeft),this.opacity=ds(s,NM,a.opacity);var c=ds(s,rM,a.overflow);this.overflowX=c[0],this.overflowY=c[c.length>1?1:0],this.overflowWrap=ds(s,nM,a.overflowWrap),this.paddingTop=ds(s,lM,a.paddingTop),this.paddingRight=ds(s,iM,a.paddingRight),this.paddingBottom=ds(s,cM,a.paddingBottom),this.paddingLeft=ds(s,oM,a.paddingLeft),this.paintOrder=ds(s,RM,a.paintOrder),this.position=ds(s,mM,a.position),this.textAlign=ds(s,dM,a.textAlign),this.textDecorationColor=ds(s,wM,(r=a.textDecorationColor)!==null&&r!==void 0?r:a.color),this.textDecorationLine=ds(s,_M,(l=a.textDecorationLine)!==null&&l!==void 0?l:a.textDecoration),this.textShadow=ds(s,uM,a.textShadow),this.textTransform=ds(s,xM,a.textTransform),this.transform=ds(s,hM,a.transform),this.transformOrigin=ds(s,bM,a.transformOrigin),this.visibility=ds(s,yM,a.visibility),this.webkitTextStrokeColor=ds(s,MM,a.webkitTextStrokeColor),this.webkitTextStrokeWidth=ds(s,IM,a.webkitTextStrokeWidth),this.wordBreak=ds(s,jM,a.wordBreak),this.zIndex=ds(s,vM,a.zIndex)}return t.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},t.prototype.isTransparent=function(){return Od(this.backgroundColor)},t.prototype.isTransformed=function(){return this.transform!==null},t.prototype.isPositioned=function(){return this.position!==0},t.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},t.prototype.isFloating=function(){return this.float!==0},t.prototype.isInlineLevel=function(){return _n(this.display,4)||_n(this.display,33554432)||_n(this.display,268435456)||_n(this.display,536870912)||_n(this.display,67108864)||_n(this.display,134217728)},t})(),HM=(function(){function t(s,a){this.content=ds(s,EM,a.content),this.quotes=ds(s,LM,a.quotes)}return t})(),H2=(function(){function t(s,a){this.counterIncrement=ds(s,DM,a.counterIncrement),this.counterReset=ds(s,UM,a.counterReset)}return t})(),ds=function(t,s,a){var r=new Q5,l=a!==null&&typeof a<"u"?a.toString():s.initialValue;r.write(l);var c=new R5(r.read());switch(s.type){case 2:var o=c.parseComponentValue();return s.parse(t,qa(o)?o.value:s.initialValue);case 0:return s.parse(t,c.parseComponentValue());case 1:return s.parse(t,c.parseComponentValues());case 4:return c.parseComponentValue();case 3:switch(s.format){case"angle":return Bg.parse(t,c.parseComponentValue());case"color":return Pd.parse(t,c.parseComponentValue());case"image":return Dy.parse(t,c.parseComponentValue());case"length":var m=c.parseComponentValue();return Gd(m)?m:Gn;case"length-percentage":var u=c.parseComponentValue();return on(u)?u:Gn;case"time":return t_.parse(t,c.parseComponentValue())}break}},PM="data-html2canvas-debug",OM=function(t){var s=t.getAttribute(PM);switch(s){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},Kb=function(t,s){var a=OM(t);return a===1||s===a},eo=(function(){function t(s,a){if(this.context=s,this.textNodes=[],this.elements=[],this.flags=0,Kb(a,3))debugger;this.styles=new $M(s,window.getComputedStyle(a,null)),Wb(a)&&(this.styles.animationDuration.some(function(r){return r>0})&&(a.style.animationDuration="0s"),this.styles.transform!==null&&(a.style.transform="none")),this.bounds=Sg(this.context,a),Kb(a,4)&&(this.flags|=16)}return t})(),zM="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",P2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",oh=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var NA=0;NA<P2.length;NA++)oh[P2.charCodeAt(NA)]=NA;var GM=function(t){var s=t.length*.75,a=t.length,r,l=0,c,o,m,u;t[t.length-1]==="="&&(s--,t[t.length-2]==="="&&s--);var x=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(s):new Array(s),A=Array.isArray(x)?x:new Uint8Array(x);for(r=0;r<a;r+=4)c=oh[t.charCodeAt(r)],o=oh[t.charCodeAt(r+1)],m=oh[t.charCodeAt(r+2)],u=oh[t.charCodeAt(r+3)],A[l++]=c<<2|o>>4,A[l++]=(o&15)<<4|m>>2,A[l++]=(m&3)<<6|u&63;return x},qM=function(t){for(var s=t.length,a=[],r=0;r<s;r+=2)a.push(t[r+1]<<8|t[r]);return a},KM=function(t){for(var s=t.length,a=[],r=0;r<s;r+=4)a.push(t[r+3]<<24|t[r+2]<<16|t[r+1]<<8|t[r]);return a},Tm=5,Uy=11,Hf=2,VM=Uy-Tm,s_=65536>>Tm,YM=1<<Tm,Pf=YM-1,WM=1024>>Tm,XM=s_+WM,JM=XM,ZM=32,eI=JM+ZM,tI=65536>>Uy,sI=1<<VM,aI=sI-1,O2=function(t,s,a){return t.slice?t.slice(s,a):new Uint16Array(Array.prototype.slice.call(t,s,a))},rI=function(t,s,a){return t.slice?t.slice(s,a):new Uint32Array(Array.prototype.slice.call(t,s,a))},nI=function(t,s){var a=GM(t),r=Array.isArray(a)?KM(a):new Uint32Array(a),l=Array.isArray(a)?qM(a):new Uint16Array(a),c=24,o=O2(l,c/2,r[4]/2),m=r[5]===2?O2(l,(c+r[4])/2):rI(r,Math.ceil((c+r[4])/4));return new lI(r[0],r[1],r[2],r[3],o,m)},lI=(function(){function t(s,a,r,l,c,o){this.initialValue=s,this.errorValue=a,this.highStart=r,this.highValueIndex=l,this.index=c,this.data=o}return t.prototype.get=function(s){var a;if(s>=0){if(s<55296||s>56319&&s<=65535)return a=this.index[s>>Tm],a=(a<<Hf)+(s&Pf),this.data[a];if(s<=65535)return a=this.index[s_+(s-55296>>Tm)],a=(a<<Hf)+(s&Pf),this.data[a];if(s<this.highStart)return a=eI-tI+(s>>Uy),a=this.index[a],a+=s>>Tm&aI,a=this.index[a],a=(a<<Hf)+(s&Pf),this.data[a];if(s<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t})(),z2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",iI=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var wA=0;wA<z2.length;wA++)iI[z2.charCodeAt(wA)]=wA;var cI=1,Of=2,zf=3,G2=4,q2=5,oI=7,K2=8,Gf=9,qf=10,V2=11,Y2=12,W2=13,X2=14,Kf=15,dI=function(t){for(var s=[],a=0,r=t.length;a<r;){var l=t.charCodeAt(a++);if(l>=55296&&l<=56319&&a<r){var c=t.charCodeAt(a++);(c&64512)===56320?s.push(((l&1023)<<10)+(c&1023)+65536):(s.push(l),a--)}else s.push(l)}return s},mI=function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var a=t.length;if(!a)return"";for(var r=[],l=-1,c="";++l<a;){var o=t[l];o<=65535?r.push(o):(o-=65536,r.push((o>>10)+55296,o%1024+56320)),(l+1===a||r.length>16384)&&(c+=String.fromCharCode.apply(String,r),r.length=0)}return c},uI=nI(zM),Si="",Vf="",xI=function(t){return uI.get(t)},hI=function(t,s,a){var r=a-2,l=s[r],c=s[a-1],o=s[a];if(c===Of&&o===zf)return Si;if(c===Of||c===zf||c===G2||o===Of||o===zf||o===G2)return Vf;if(c===K2&&[K2,Gf,V2,Y2].indexOf(o)!==-1||(c===V2||c===Gf)&&(o===Gf||o===qf)||(c===Y2||c===qf)&&o===qf||o===W2||o===q2||o===oI||c===cI)return Si;if(c===W2&&o===X2){for(;l===q2;)l=s[--r];if(l===X2)return Si}if(c===Kf&&o===Kf){for(var m=0;l===Kf;)m++,l=s[--r];if(m%2===0)return Si}return Vf},pI=function(t){var s=dI(t),a=s.length,r=0,l=0,c=s.map(xI);return{next:function(){if(r>=a)return{done:!0,value:null};for(var o=Si;r<a&&(o=hI(s,c,++r))===Si;);if(o!==Si||r===a){var m=mI.apply(null,s.slice(l,r));return l=r,{value:m,done:!1}}return{done:!0,value:null}}}},AI=function(t){for(var s=pI(t),a=[],r;!(r=s.next()).done;)r.value&&a.push(r.value.slice());return a},gI=function(t){var s=123;if(t.createRange){var a=t.createRange();if(a.getBoundingClientRect){var r=t.createElement("boundtest");r.style.height=s+"px",r.style.display="block",t.body.appendChild(r),a.selectNode(r);var l=a.getBoundingClientRect(),c=Math.round(l.height);if(t.body.removeChild(r),c===s)return!0}}return!1},fI=function(t){var s=t.createElement("boundtest");s.style.width="50px",s.style.display="block",s.style.fontSize="12px",s.style.letterSpacing="0px",s.style.wordSpacing="0px",t.body.appendChild(s);var a=t.createRange();s.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var r=s.firstChild,l=kg(r.data).map(function(u){return Xr(u)}),c=0,o={},m=l.every(function(u,x){a.setStart(r,c),a.setEnd(r,c+u.length);var A=a.getBoundingClientRect();c+=u.length;var g=A.x>o.x||A.y>o.y;return o=A,x===0?!0:g});return t.body.removeChild(s),m},bI=function(){return typeof new Image().crossOrigin<"u"},yI=function(){return typeof new XMLHttpRequest().responseType=="string"},jI=function(t){var s=new Image,a=t.createElement("canvas"),r=a.getContext("2d");if(!r)return!1;s.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{r.drawImage(s,0,0),a.toDataURL()}catch{return!1}return!0},J2=function(t){return t[0]===0&&t[1]===255&&t[2]===0&&t[3]===255},vI=function(t){var s=t.createElement("canvas"),a=100;s.width=a,s.height=a;var r=s.getContext("2d");if(!r)return Promise.reject(!1);r.fillStyle="rgb(0, 255, 0)",r.fillRect(0,0,a,a);var l=new Image,c=s.toDataURL();l.src=c;var o=Vb(a,a,0,0,l);return r.fillStyle="red",r.fillRect(0,0,a,a),Z2(o).then(function(m){r.drawImage(m,0,0);var u=r.getImageData(0,0,a,a).data;r.fillStyle="red",r.fillRect(0,0,a,a);var x=t.createElement("div");return x.style.backgroundImage="url("+c+")",x.style.height=a+"px",J2(u)?Z2(Vb(a,a,0,0,x)):Promise.reject(!1)}).then(function(m){return r.drawImage(m,0,0),J2(r.getImageData(0,0,a,a).data)}).catch(function(){return!1})},Vb=function(t,s,a,r,l){var c="http://www.w3.org/2000/svg",o=document.createElementNS(c,"svg"),m=document.createElementNS(c,"foreignObject");return o.setAttributeNS(null,"width",t.toString()),o.setAttributeNS(null,"height",s.toString()),m.setAttributeNS(null,"width","100%"),m.setAttributeNS(null,"height","100%"),m.setAttributeNS(null,"x",a.toString()),m.setAttributeNS(null,"y",r.toString()),m.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(m),m.appendChild(l),o},Z2=function(t){return new Promise(function(s,a){var r=new Image;r.onload=function(){return s(r)},r.onerror=a,r.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},zn={get SUPPORT_RANGE_BOUNDS(){var t=gI(document);return Object.defineProperty(zn,"SUPPORT_RANGE_BOUNDS",{value:t}),t},get SUPPORT_WORD_BREAKING(){var t=zn.SUPPORT_RANGE_BOUNDS&&fI(document);return Object.defineProperty(zn,"SUPPORT_WORD_BREAKING",{value:t}),t},get SUPPORT_SVG_DRAWING(){var t=jI(document);return Object.defineProperty(zn,"SUPPORT_SVG_DRAWING",{value:t}),t},get SUPPORT_FOREIGNOBJECT_DRAWING(){var t=typeof Array.from=="function"&&typeof window.fetch=="function"?vI(document):Promise.resolve(!1);return Object.defineProperty(zn,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:t}),t},get SUPPORT_CORS_IMAGES(){var t=bI();return Object.defineProperty(zn,"SUPPORT_CORS_IMAGES",{value:t}),t},get SUPPORT_RESPONSE_TYPE(){var t=yI();return Object.defineProperty(zn,"SUPPORT_RESPONSE_TYPE",{value:t}),t},get SUPPORT_CORS_XHR(){var t="withCredentials"in new XMLHttpRequest;return Object.defineProperty(zn,"SUPPORT_CORS_XHR",{value:t}),t},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var t=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(zn,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:t}),t}},fh=(function(){function t(s,a){this.text=s,this.bounds=a}return t})(),NI=function(t,s,a,r){var l=CI(s,a),c=[],o=0;return l.forEach(function(m){if(a.textDecorationLine.length||m.trim().length>0)if(zn.SUPPORT_RANGE_BOUNDS){var u=e1(r,o,m.length).getClientRects();if(u.length>1){var x=Ty(m),A=0;x.forEach(function(N){c.push(new fh(N,Go.fromDOMRectList(t,e1(r,A+o,N.length).getClientRects()))),A+=N.length})}else c.push(new fh(m,Go.fromDOMRectList(t,u)))}else{var g=r.splitText(m.length);c.push(new fh(m,wI(t,r))),r=g}else zn.SUPPORT_RANGE_BOUNDS||(r=r.splitText(m.length));o+=m.length}),c},wI=function(t,s){var a=s.ownerDocument;if(a){var r=a.createElement("html2canvaswrapper");r.appendChild(s.cloneNode(!0));var l=s.parentNode;if(l){l.replaceChild(r,s);var c=Sg(t,r);return r.firstChild&&l.replaceChild(r.firstChild,r),c}}return Go.EMPTY},e1=function(t,s,a){var r=t.ownerDocument;if(!r)throw new Error("Node has no owner document");var l=r.createRange();return l.setStart(t,s),l.setEnd(t,s+a),l},Ty=function(t){if(zn.SUPPORT_NATIVE_TEXT_SEGMENTATION){var s=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(s.segment(t)).map(function(a){return a.segment})}return AI(t)},_I=function(t,s){if(zn.SUPPORT_NATIVE_TEXT_SEGMENTATION){var a=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(a.segment(t)).map(function(r){return r.segment})}return kI(t,s)},CI=function(t,s){return s.letterSpacing!==0?Ty(t):_I(t,s)},SI=[32,160,4961,65792,65793,4153,4241],kI=function(t,s){for(var a=tQ(t,{lineBreak:s.lineBreak,wordBreak:s.overflowWrap==="break-word"?"break-word":s.wordBreak}),r=[],l,c=function(){if(l.value){var o=l.value.slice(),m=kg(o),u="";m.forEach(function(x){SI.indexOf(x)===-1?u+=Xr(x):(u.length&&r.push(u),r.push(Xr(x)),u="")}),u.length&&r.push(u)}};!(l=a.next()).done;)c();return r},BI=(function(){function t(s,a,r){this.text=FI(a.data,r.textTransform),this.textBounds=NI(s,this.text,r,a)}return t})(),FI=function(t,s){switch(s){case 1:return t.toLowerCase();case 3:return t.replace(EI,DI);case 2:return t.toUpperCase();default:return t}},EI=/(^|\s|:|-|\(|\))([a-z])/g,DI=function(t,s,a){return t.length>0?s+a.toUpperCase():t},a_=(function(t){wc(s,t);function s(a,r){var l=t.call(this,a,r)||this;return l.src=r.currentSrc||r.src,l.intrinsicWidth=r.naturalWidth,l.intrinsicHeight=r.naturalHeight,l.context.cache.addImage(l.src),l}return s})(eo),r_=(function(t){wc(s,t);function s(a,r){var l=t.call(this,a,r)||this;return l.canvas=r,l.intrinsicWidth=r.width,l.intrinsicHeight=r.height,l}return s})(eo),n_=(function(t){wc(s,t);function s(a,r){var l=t.call(this,a,r)||this,c=new XMLSerializer,o=Sg(a,r);return r.setAttribute("width",o.width+"px"),r.setAttribute("height",o.height+"px"),l.svg="data:image/svg+xml,"+encodeURIComponent(c.serializeToString(r)),l.intrinsicWidth=r.width.baseVal.value,l.intrinsicHeight=r.height.baseVal.value,l.context.cache.addImage(l.svg),l}return s})(eo),l_=(function(t){wc(s,t);function s(a,r){var l=t.call(this,a,r)||this;return l.value=r.value,l}return s})(eo),Yb=(function(t){wc(s,t);function s(a,r){var l=t.call(this,a,r)||this;return l.start=r.start,l.reversed=typeof r.reversed=="boolean"&&r.reversed===!0,l}return s})(eo),UI=[{type:15,flags:0,unit:"px",number:3}],TI=[{type:16,flags:0,number:50}],LI=function(t){return t.width>t.height?new Go(t.left+(t.width-t.height)/2,t.top,t.height,t.height):t.width<t.height?new Go(t.left,t.top+(t.height-t.width)/2,t.width,t.width):t},QI=function(t){var s=t.type===RI?new Array(t.value.length+1).join(""):t.value;return s.length===0?t.placeholder||"":s},og="checkbox",dg="radio",RI="password",t1=707406591,Ly=(function(t){wc(s,t);function s(a,r){var l=t.call(this,a,r)||this;switch(l.type=r.type.toLowerCase(),l.checked=r.checked,l.value=QI(r),(l.type===og||l.type===dg)&&(l.styles.backgroundColor=3739148031,l.styles.borderTopColor=l.styles.borderRightColor=l.styles.borderBottomColor=l.styles.borderLeftColor=2779096575,l.styles.borderTopWidth=l.styles.borderRightWidth=l.styles.borderBottomWidth=l.styles.borderLeftWidth=1,l.styles.borderTopStyle=l.styles.borderRightStyle=l.styles.borderBottomStyle=l.styles.borderLeftStyle=1,l.styles.backgroundClip=[0],l.styles.backgroundOrigin=[0],l.bounds=LI(l.bounds)),l.type){case og:l.styles.borderTopRightRadius=l.styles.borderTopLeftRadius=l.styles.borderBottomRightRadius=l.styles.borderBottomLeftRadius=UI;break;case dg:l.styles.borderTopRightRadius=l.styles.borderTopLeftRadius=l.styles.borderBottomRightRadius=l.styles.borderBottomLeftRadius=TI;break}return l}return s})(eo),i_=(function(t){wc(s,t);function s(a,r){var l=t.call(this,a,r)||this,c=r.options[r.selectedIndex||0];return l.value=c&&c.text||"",l}return s})(eo),c_=(function(t){wc(s,t);function s(a,r){var l=t.call(this,a,r)||this;return l.value=r.value,l}return s})(eo),o_=(function(t){wc(s,t);function s(a,r){var l=t.call(this,a,r)||this;l.src=r.src,l.width=parseInt(r.width,10)||0,l.height=parseInt(r.height,10)||0,l.backgroundColor=l.styles.backgroundColor;try{if(r.contentWindow&&r.contentWindow.document&&r.contentWindow.document.documentElement){l.tree=m_(a,r.contentWindow.document.documentElement);var c=r.contentWindow.document.documentElement?Ah(a,getComputedStyle(r.contentWindow.document.documentElement).backgroundColor):Ho.TRANSPARENT,o=r.contentWindow.document.body?Ah(a,getComputedStyle(r.contentWindow.document.body).backgroundColor):Ho.TRANSPARENT;l.backgroundColor=Od(c)?Od(o)?l.styles.backgroundColor:o:c}}catch{}return l}return s})(eo),MI=["OL","UL","MENU"],KA=function(t,s,a,r){for(var l=s.firstChild,c=void 0;l;l=c)if(c=l.nextSibling,u_(l)&&l.data.trim().length>0)a.textNodes.push(new BI(t,l,a.styles));else if(Hu(l))if(A_(l)&&l.assignedNodes)l.assignedNodes().forEach(function(m){return KA(t,m,a,r)});else{var o=d_(t,l);o.styles.isVisible()&&(II(l,o,r)?o.flags|=4:$I(o.styles)&&(o.flags|=2),MI.indexOf(l.tagName)!==-1&&(o.flags|=8),a.elements.push(o),l.slot,l.shadowRoot?KA(t,l.shadowRoot,o,r):!mg(l)&&!x_(l)&&!ug(l)&&KA(t,l,o,r))}},d_=function(t,s){return Xb(s)?new a_(t,s):h_(s)?new r_(t,s):x_(s)?new n_(t,s):HI(s)?new l_(t,s):PI(s)?new Yb(t,s):OI(s)?new Ly(t,s):ug(s)?new i_(t,s):mg(s)?new c_(t,s):p_(s)?new o_(t,s):new eo(t,s)},m_=function(t,s){var a=d_(t,s);return a.flags|=4,KA(t,s,a,a),a},II=function(t,s,a){return s.styles.isPositionedWithZIndex()||s.styles.opacity<1||s.styles.isTransformed()||Qy(t)&&a.styles.isTransparent()},$I=function(t){return t.isPositioned()||t.isFloating()},u_=function(t){return t.nodeType===Node.TEXT_NODE},Hu=function(t){return t.nodeType===Node.ELEMENT_NODE},Wb=function(t){return Hu(t)&&typeof t.style<"u"&&!VA(t)},VA=function(t){return typeof t.className=="object"},HI=function(t){return t.tagName==="LI"},PI=function(t){return t.tagName==="OL"},OI=function(t){return t.tagName==="INPUT"},zI=function(t){return t.tagName==="HTML"},x_=function(t){return t.tagName==="svg"},Qy=function(t){return t.tagName==="BODY"},h_=function(t){return t.tagName==="CANVAS"},s1=function(t){return t.tagName==="VIDEO"},Xb=function(t){return t.tagName==="IMG"},p_=function(t){return t.tagName==="IFRAME"},a1=function(t){return t.tagName==="STYLE"},GI=function(t){return t.tagName==="SCRIPT"},mg=function(t){return t.tagName==="TEXTAREA"},ug=function(t){return t.tagName==="SELECT"},A_=function(t){return t.tagName==="SLOT"},r1=function(t){return t.tagName.indexOf("-")>0},qI=(function(){function t(){this.counters={}}return t.prototype.getCounterValue=function(s){var a=this.counters[s];return a&&a.length?a[a.length-1]:1},t.prototype.getCounterValues=function(s){var a=this.counters[s];return a||[]},t.prototype.pop=function(s){var a=this;s.forEach(function(r){return a.counters[r].pop()})},t.prototype.parse=function(s){var a=this,r=s.counterIncrement,l=s.counterReset,c=!0;r!==null&&r.forEach(function(m){var u=a.counters[m.counter];u&&m.increment!==0&&(c=!1,u.length||u.push(1),u[Math.max(0,u.length-1)]+=m.increment)});var o=[];return c&&l.forEach(function(m){var u=a.counters[m.counter];o.push(m.counter),u||(u=a.counters[m.counter]=[]),u.push(m.reset)}),o},t})(),n1={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},l1={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},KI={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},VI={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Du=function(t,s,a,r,l,c){return t<s||t>a?Eh(t,l,c.length>0):r.integers.reduce(function(o,m,u){for(;t>=m;)t-=m,o+=r.values[u];return o},"")+c},g_=function(t,s,a,r){var l="";do a||t--,l=r(t)+l,t/=s;while(t*s>=s);return l},Wr=function(t,s,a,r,l){var c=a-s+1;return(t<0?"-":"")+(g_(Math.abs(t),c,r,function(o){return Xr(Math.floor(o%c)+s)})+l)},ym=function(t,s,a){a===void 0&&(a=". ");var r=s.length;return g_(Math.abs(t),r,!1,function(l){return s[Math.floor(l%r)]})+a},Ru=1,Fd=2,Ed=4,dh=8,Lo=function(t,s,a,r,l,c){if(t<-9999||t>9999)return Eh(t,4,l.length>0);var o=Math.abs(t),m=l;if(o===0)return s[0]+m;for(var u=0;o>0&&u<=4;u++){var x=o%10;x===0&&_n(c,Ru)&&m!==""?m=s[x]+m:x>1||x===1&&u===0||x===1&&u===1&&_n(c,Fd)||x===1&&u===1&&_n(c,Ed)&&t>100||x===1&&u>1&&_n(c,dh)?m=s[x]+(u>0?a[u-1]:"")+m:x===1&&u>0&&(m=a[u-1]+m),o=Math.floor(o/10)}return(t<0?r:"")+m},i1="",c1="",o1="",Yf="",Eh=function(t,s,a){var r=a?". ":"",l=a?"":"",c=a?", ":"",o=a?" ":"";switch(s){case 0:return""+o;case 1:return""+o;case 2:return""+o;case 5:var m=Wr(t,48,57,!0,r);return m.length<4?"0"+m:m;case 4:return ym(t,"",l);case 6:return Du(t,1,3999,n1,3,r).toLowerCase();case 7:return Du(t,1,3999,n1,3,r);case 8:return Wr(t,945,969,!1,r);case 9:return Wr(t,97,122,!1,r);case 10:return Wr(t,65,90,!1,r);case 11:return Wr(t,1632,1641,!0,r);case 12:case 49:return Du(t,1,9999,l1,3,r);case 35:return Du(t,1,9999,l1,3,r).toLowerCase();case 13:return Wr(t,2534,2543,!0,r);case 14:case 30:return Wr(t,6112,6121,!0,r);case 15:return ym(t,"",l);case 16:return ym(t,"",l);case 17:case 48:return Lo(t,"",i1,"",l,Fd|Ed|dh);case 47:return Lo(t,"",c1,"",l,Ru|Fd|Ed|dh);case 42:return Lo(t,"",i1,"",l,Fd|Ed|dh);case 41:return Lo(t,"",c1,"",l,Ru|Fd|Ed|dh);case 26:return Lo(t,"","",o1,l,0);case 25:return Lo(t,"","",o1,l,Ru|Fd|Ed);case 31:return Lo(t,"","",Yf,c,Ru|Fd|Ed);case 33:return Lo(t,"","",Yf,c,0);case 32:return Lo(t,"","",Yf,c,Ru|Fd|Ed);case 18:return Wr(t,2406,2415,!0,r);case 20:return Du(t,1,19999,VI,3,r);case 21:return Wr(t,2790,2799,!0,r);case 22:return Wr(t,2662,2671,!0,r);case 22:return Du(t,1,10999,KI,3,r);case 23:return ym(t,"");case 24:return ym(t,"");case 27:return Wr(t,3302,3311,!0,r);case 28:return ym(t,"",l);case 29:return ym(t,"",l);case 34:return Wr(t,3792,3801,!0,r);case 37:return Wr(t,6160,6169,!0,r);case 38:return Wr(t,4160,4169,!0,r);case 39:return Wr(t,2918,2927,!0,r);case 40:return Wr(t,1776,1785,!0,r);case 43:return Wr(t,3046,3055,!0,r);case 44:return Wr(t,3174,3183,!0,r);case 45:return Wr(t,3664,3673,!0,r);case 46:return Wr(t,3872,3881,!0,r);case 3:default:return Wr(t,48,57,!0,r)}},f_="data-html2canvas-ignore",d1=(function(){function t(s,a,r){if(this.context=s,this.options=r,this.scrolledElements=[],this.referenceElement=a,this.counters=new qI,this.quoteDepth=0,!a.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(a.ownerDocument.documentElement,!1)}return t.prototype.toIFrame=function(s,a){var r=this,l=YI(s,a);if(!l.contentWindow)return Promise.reject("Unable to find iframe window");var c=s.defaultView.pageXOffset,o=s.defaultView.pageYOffset,m=l.contentWindow,u=m.document,x=JI(l).then(function(){return bl(r,void 0,void 0,function(){var A,g;return el(this,function(N){switch(N.label){case 0:return this.scrolledElements.forEach(s$),m&&(m.scrollTo(a.left,a.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(m.scrollY!==a.top||m.scrollX!==a.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(m.scrollX-a.left,m.scrollY-a.top,0,0))),A=this.options.onclone,g=this.clonedReferenceElement,typeof g>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:u.fonts&&u.fonts.ready?[4,u.fonts.ready]:[3,2];case 1:N.sent(),N.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,XI(u)]:[3,4];case 3:N.sent(),N.label=4;case 4:return typeof A=="function"?[2,Promise.resolve().then(function(){return A(u,g)}).then(function(){return l})]:[2,l]}})})});return u.open(),u.write(e$(document.doctype)+"<html></html>"),t$(this.referenceElement.ownerDocument,c,o),u.replaceChild(u.adoptNode(this.documentElement),u.documentElement),u.close(),x},t.prototype.createElementClone=function(s){if(Kb(s,2))debugger;if(h_(s))return this.createCanvasClone(s);if(s1(s))return this.createVideoClone(s);if(a1(s))return this.createStyleClone(s);var a=s.cloneNode(!1);return Xb(a)&&(Xb(s)&&s.currentSrc&&s.currentSrc!==s.src&&(a.src=s.currentSrc,a.srcset=""),a.loading==="lazy"&&(a.loading="eager")),r1(a)?this.createCustomElementClone(a):a},t.prototype.createCustomElementClone=function(s){var a=document.createElement("html2canvascustomelement");return Wf(s.style,a),a},t.prototype.createStyleClone=function(s){try{var a=s.sheet;if(a&&a.cssRules){var r=[].slice.call(a.cssRules,0).reduce(function(c,o){return o&&typeof o.cssText=="string"?c+o.cssText:c},""),l=s.cloneNode(!1);return l.textContent=r,l}}catch(c){if(this.context.logger.error("Unable to access cssRules property",c),c.name!=="SecurityError")throw c}return s.cloneNode(!1)},t.prototype.createCanvasClone=function(s){var a;if(this.options.inlineImages&&s.ownerDocument){var r=s.ownerDocument.createElement("img");try{return r.src=s.toDataURL(),r}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",s)}}var l=s.cloneNode(!1);try{l.width=s.width,l.height=s.height;var c=s.getContext("2d"),o=l.getContext("2d");if(o)if(!this.options.allowTaint&&c)o.putImageData(c.getImageData(0,0,s.width,s.height),0,0);else{var m=(a=s.getContext("webgl2"))!==null&&a!==void 0?a:s.getContext("webgl");if(m){var u=m.getContextAttributes();u?.preserveDrawingBuffer===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",s)}o.drawImage(s,0,0)}return l}catch{this.context.logger.info("Unable to clone canvas as it is tainted",s)}return l},t.prototype.createVideoClone=function(s){var a=s.ownerDocument.createElement("canvas");a.width=s.offsetWidth,a.height=s.offsetHeight;var r=a.getContext("2d");try{return r&&(r.drawImage(s,0,0,a.width,a.height),this.options.allowTaint||r.getImageData(0,0,a.width,a.height)),a}catch{this.context.logger.info("Unable to clone video as it is tainted",s)}var l=s.ownerDocument.createElement("canvas");return l.width=s.offsetWidth,l.height=s.offsetHeight,l},t.prototype.appendChildNode=function(s,a,r){(!Hu(a)||!GI(a)&&!a.hasAttribute(f_)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(a)))&&(!this.options.copyStyles||!Hu(a)||!a1(a))&&s.appendChild(this.cloneNode(a,r))},t.prototype.cloneChildNodes=function(s,a,r){for(var l=this,c=s.shadowRoot?s.shadowRoot.firstChild:s.firstChild;c;c=c.nextSibling)if(Hu(c)&&A_(c)&&typeof c.assignedNodes=="function"){var o=c.assignedNodes();o.length&&o.forEach(function(m){return l.appendChildNode(a,m,r)})}else this.appendChildNode(a,c,r)},t.prototype.cloneNode=function(s,a){if(u_(s))return document.createTextNode(s.data);if(!s.ownerDocument)return s.cloneNode(!1);var r=s.ownerDocument.defaultView;if(r&&Hu(s)&&(Wb(s)||VA(s))){var l=this.createElementClone(s);l.style.transitionProperty="none";var c=r.getComputedStyle(s),o=r.getComputedStyle(s,":before"),m=r.getComputedStyle(s,":after");this.referenceElement===s&&Wb(l)&&(this.clonedReferenceElement=l),Qy(l)&&n$(l);var u=this.counters.parse(new H2(this.context,c)),x=this.resolvePseudoContent(s,l,o,bh.BEFORE);r1(s)&&(a=!0),s1(s)||this.cloneChildNodes(s,l,a),x&&l.insertBefore(x,l.firstChild);var A=this.resolvePseudoContent(s,l,m,bh.AFTER);return A&&l.appendChild(A),this.counters.pop(u),(c&&(this.options.copyStyles||VA(s))&&!p_(s)||a)&&Wf(c,l),(s.scrollTop!==0||s.scrollLeft!==0)&&this.scrolledElements.push([l,s.scrollLeft,s.scrollTop]),(mg(s)||ug(s))&&(mg(l)||ug(l))&&(l.value=s.value),l}return s.cloneNode(!1)},t.prototype.resolvePseudoContent=function(s,a,r,l){var c=this;if(r){var o=r.content,m=a.ownerDocument;if(!(!m||!o||o==="none"||o==="-moz-alt-content"||r.display==="none")){this.counters.parse(new H2(this.context,r));var u=new HM(this.context,r),x=m.createElement("html2canvaspseudoelement");Wf(r,x),u.content.forEach(function(g){if(g.type===0)x.appendChild(m.createTextNode(g.value));else if(g.type===22){var N=m.createElement("img");N.src=g.value,N.style.opacity="1",x.appendChild(N)}else if(g.type===18){if(g.name==="attr"){var f=g.values.filter(qa);f.length&&x.appendChild(m.createTextNode(s.getAttribute(f[0].value)||""))}else if(g.name==="counter"){var y=g.values.filter(Zu),v=y[0],U=y[1];if(v&&qa(v)){var D=c.counters.getCounterValue(v.value),M=U&&qa(U)?qb.parse(c.context,U.value):3;x.appendChild(m.createTextNode(Eh(D,M,!1)))}}else if(g.name==="counters"){var K=g.values.filter(Zu),v=K[0],$=K[1],U=K[2];if(v&&qa(v)){var P=c.counters.getCounterValues(v.value),se=U&&qa(U)?qb.parse(c.context,U.value):3,z=$&&$.type===0?$.value:"",R=P.map(function(Q){return Eh(Q,se,!1)}).join(z);x.appendChild(m.createTextNode(R))}}}else if(g.type===20)switch(g.value){case"open-quote":x.appendChild(m.createTextNode($2(u.quotes,c.quoteDepth++,!0)));break;case"close-quote":x.appendChild(m.createTextNode($2(u.quotes,--c.quoteDepth,!1)));break;default:x.appendChild(m.createTextNode(g.value))}}),x.className=Jb+" "+Zb;var A=l===bh.BEFORE?" "+Jb:" "+Zb;return VA(a)?a.className.baseValue+=A:a.className+=A,x}}},t.destroy=function(s){return s.parentNode?(s.parentNode.removeChild(s),!0):!1},t})(),bh;(function(t){t[t.BEFORE=0]="BEFORE",t[t.AFTER=1]="AFTER"})(bh||(bh={}));var YI=function(t,s){var a=t.createElement("iframe");return a.className="html2canvas-container",a.style.visibility="hidden",a.style.position="fixed",a.style.left="-10000px",a.style.top="0px",a.style.border="0",a.width=s.width.toString(),a.height=s.height.toString(),a.scrolling="no",a.setAttribute(f_,"true"),t.body.appendChild(a),a},WI=function(t){return new Promise(function(s){if(t.complete){s();return}if(!t.src){s();return}t.onload=s,t.onerror=s})},XI=function(t){return Promise.all([].slice.call(t.images,0).map(WI))},JI=function(t){return new Promise(function(s,a){var r=t.contentWindow;if(!r)return a("No window assigned for iframe");var l=r.document;r.onload=t.onload=function(){r.onload=t.onload=null;var c=setInterval(function(){l.body.childNodes.length>0&&l.readyState==="complete"&&(clearInterval(c),s(t))},50)}})},ZI=["all","d","content"],Wf=function(t,s){for(var a=t.length-1;a>=0;a--){var r=t.item(a);ZI.indexOf(r)===-1&&s.style.setProperty(r,t.getPropertyValue(r))}return s},e$=function(t){var s="";return t&&(s+="<!DOCTYPE ",t.name&&(s+=t.name),t.internalSubset&&(s+=t.internalSubset),t.publicId&&(s+='"'+t.publicId+'"'),t.systemId&&(s+='"'+t.systemId+'"'),s+=">"),s},t$=function(t,s,a){t&&t.defaultView&&(s!==t.defaultView.pageXOffset||a!==t.defaultView.pageYOffset)&&t.defaultView.scrollTo(s,a)},s$=function(t){var s=t[0],a=t[1],r=t[2];s.scrollLeft=a,s.scrollTop=r},a$=":before",r$=":after",Jb="___html2canvas___pseudoelement_before",Zb="___html2canvas___pseudoelement_after",m1=`{
    content: "" !important;
    display: none !important;
}`,n$=function(t){l$(t,"."+Jb+a$+m1+`
         .`+Zb+r$+m1)},l$=function(t,s){var a=t.ownerDocument;if(a){var r=a.createElement("style");r.textContent=s,t.appendChild(r)}},b_=(function(){function t(){}return t.getOrigin=function(s){var a=t._link;return a?(a.href=s,a.href=a.href,a.protocol+a.hostname+a.port):"about:blank"},t.isSameOrigin=function(s){return t.getOrigin(s)===t._origin},t.setContext=function(s){t._link=s.document.createElement("a"),t._origin=t.getOrigin(s.location.href)},t._origin="about:blank",t})(),i$=(function(){function t(s,a){this.context=s,this._options=a,this._cache={}}return t.prototype.addImage=function(s){var a=Promise.resolve();return this.has(s)||(Jf(s)||m$(s))&&(this._cache[s]=this.loadImage(s)).catch(function(){}),a},t.prototype.match=function(s){return this._cache[s]},t.prototype.loadImage=function(s){return bl(this,void 0,void 0,function(){var a,r,l,c,o=this;return el(this,function(m){switch(m.label){case 0:return a=b_.isSameOrigin(s),r=!Xf(s)&&this._options.useCORS===!0&&zn.SUPPORT_CORS_IMAGES&&!a,l=!Xf(s)&&!a&&!Jf(s)&&typeof this._options.proxy=="string"&&zn.SUPPORT_CORS_XHR&&!r,!a&&this._options.allowTaint===!1&&!Xf(s)&&!Jf(s)&&!l&&!r?[2]:(c=s,l?[4,this.proxy(c)]:[3,2]);case 1:c=m.sent(),m.label=2;case 2:return this.context.logger.debug("Added image "+s.substring(0,256)),[4,new Promise(function(u,x){var A=new Image;A.onload=function(){return u(A)},A.onerror=x,(u$(c)||r)&&(A.crossOrigin="anonymous"),A.src=c,A.complete===!0&&setTimeout(function(){return u(A)},500),o._options.imageTimeout>0&&setTimeout(function(){return x("Timed out ("+o._options.imageTimeout+"ms) loading image")},o._options.imageTimeout)})];case 3:return[2,m.sent()]}})})},t.prototype.has=function(s){return typeof this._cache[s]<"u"},t.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},t.prototype.proxy=function(s){var a=this,r=this._options.proxy;if(!r)throw new Error("No proxy defined");var l=s.substring(0,256);return new Promise(function(c,o){var m=zn.SUPPORT_RESPONSE_TYPE?"blob":"text",u=new XMLHttpRequest;u.onload=function(){if(u.status===200)if(m==="text")c(u.response);else{var g=new FileReader;g.addEventListener("load",function(){return c(g.result)},!1),g.addEventListener("error",function(N){return o(N)},!1),g.readAsDataURL(u.response)}else o("Failed to proxy resource "+l+" with status code "+u.status)},u.onerror=o;var x=r.indexOf("?")>-1?"&":"?";if(u.open("GET",""+r+x+"url="+encodeURIComponent(s)+"&responseType="+m),m!=="text"&&u instanceof XMLHttpRequest&&(u.responseType=m),a._options.imageTimeout){var A=a._options.imageTimeout;u.timeout=A,u.ontimeout=function(){return o("Timed out ("+A+"ms) proxying "+l)}}u.send()})},t})(),c$=/^data:image\/svg\+xml/i,o$=/^data:image\/.*;base64,/i,d$=/^data:image\/.*/i,m$=function(t){return zn.SUPPORT_SVG_DRAWING||!x$(t)},Xf=function(t){return d$.test(t)},u$=function(t){return o$.test(t)},Jf=function(t){return t.substr(0,4)==="blob"},x$=function(t){return t.substr(-3).toLowerCase()==="svg"||c$.test(t)},ns=(function(){function t(s,a){this.type=0,this.x=s,this.y=a}return t.prototype.add=function(s,a){return new t(this.x+s,this.y+a)},t})(),Uu=function(t,s,a){return new ns(t.x+(s.x-t.x)*a,t.y+(s.y-t.y)*a)},_A=(function(){function t(s,a,r,l){this.type=1,this.start=s,this.startControl=a,this.endControl=r,this.end=l}return t.prototype.subdivide=function(s,a){var r=Uu(this.start,this.startControl,s),l=Uu(this.startControl,this.endControl,s),c=Uu(this.endControl,this.end,s),o=Uu(r,l,s),m=Uu(l,c,s),u=Uu(o,m,s);return a?new t(this.start,r,o,u):new t(u,m,c,this.end)},t.prototype.add=function(s,a){return new t(this.start.add(s,a),this.startControl.add(s,a),this.endControl.add(s,a),this.end.add(s,a))},t.prototype.reverse=function(){return new t(this.end,this.endControl,this.startControl,this.start)},t})(),ki=function(t){return t.type===1},h$=(function(){function t(s){var a=s.styles,r=s.bounds,l=ch(a.borderTopLeftRadius,r.width,r.height),c=l[0],o=l[1],m=ch(a.borderTopRightRadius,r.width,r.height),u=m[0],x=m[1],A=ch(a.borderBottomRightRadius,r.width,r.height),g=A[0],N=A[1],f=ch(a.borderBottomLeftRadius,r.width,r.height),y=f[0],v=f[1],U=[];U.push((c+u)/r.width),U.push((y+g)/r.width),U.push((o+v)/r.height),U.push((x+N)/r.height);var D=Math.max.apply(Math,U);D>1&&(c/=D,o/=D,u/=D,x/=D,g/=D,N/=D,y/=D,v/=D);var M=r.width-u,K=r.height-N,$=r.width-g,P=r.height-v,se=a.borderTopWidth,z=a.borderRightWidth,R=a.borderBottomWidth,j=a.borderLeftWidth,T=Za(a.paddingTop,s.bounds.width),Q=Za(a.paddingRight,s.bounds.width),E=Za(a.paddingBottom,s.bounds.width),te=Za(a.paddingLeft,s.bounds.width);this.topLeftBorderDoubleOuterBox=c>0||o>0?yr(r.left+j/3,r.top+se/3,c-j/3,o-se/3,Ua.TOP_LEFT):new ns(r.left+j/3,r.top+se/3),this.topRightBorderDoubleOuterBox=c>0||o>0?yr(r.left+M,r.top+se/3,u-z/3,x-se/3,Ua.TOP_RIGHT):new ns(r.left+r.width-z/3,r.top+se/3),this.bottomRightBorderDoubleOuterBox=g>0||N>0?yr(r.left+$,r.top+K,g-z/3,N-R/3,Ua.BOTTOM_RIGHT):new ns(r.left+r.width-z/3,r.top+r.height-R/3),this.bottomLeftBorderDoubleOuterBox=y>0||v>0?yr(r.left+j/3,r.top+P,y-j/3,v-R/3,Ua.BOTTOM_LEFT):new ns(r.left+j/3,r.top+r.height-R/3),this.topLeftBorderDoubleInnerBox=c>0||o>0?yr(r.left+j*2/3,r.top+se*2/3,c-j*2/3,o-se*2/3,Ua.TOP_LEFT):new ns(r.left+j*2/3,r.top+se*2/3),this.topRightBorderDoubleInnerBox=c>0||o>0?yr(r.left+M,r.top+se*2/3,u-z*2/3,x-se*2/3,Ua.TOP_RIGHT):new ns(r.left+r.width-z*2/3,r.top+se*2/3),this.bottomRightBorderDoubleInnerBox=g>0||N>0?yr(r.left+$,r.top+K,g-z*2/3,N-R*2/3,Ua.BOTTOM_RIGHT):new ns(r.left+r.width-z*2/3,r.top+r.height-R*2/3),this.bottomLeftBorderDoubleInnerBox=y>0||v>0?yr(r.left+j*2/3,r.top+P,y-j*2/3,v-R*2/3,Ua.BOTTOM_LEFT):new ns(r.left+j*2/3,r.top+r.height-R*2/3),this.topLeftBorderStroke=c>0||o>0?yr(r.left+j/2,r.top+se/2,c-j/2,o-se/2,Ua.TOP_LEFT):new ns(r.left+j/2,r.top+se/2),this.topRightBorderStroke=c>0||o>0?yr(r.left+M,r.top+se/2,u-z/2,x-se/2,Ua.TOP_RIGHT):new ns(r.left+r.width-z/2,r.top+se/2),this.bottomRightBorderStroke=g>0||N>0?yr(r.left+$,r.top+K,g-z/2,N-R/2,Ua.BOTTOM_RIGHT):new ns(r.left+r.width-z/2,r.top+r.height-R/2),this.bottomLeftBorderStroke=y>0||v>0?yr(r.left+j/2,r.top+P,y-j/2,v-R/2,Ua.BOTTOM_LEFT):new ns(r.left+j/2,r.top+r.height-R/2),this.topLeftBorderBox=c>0||o>0?yr(r.left,r.top,c,o,Ua.TOP_LEFT):new ns(r.left,r.top),this.topRightBorderBox=u>0||x>0?yr(r.left+M,r.top,u,x,Ua.TOP_RIGHT):new ns(r.left+r.width,r.top),this.bottomRightBorderBox=g>0||N>0?yr(r.left+$,r.top+K,g,N,Ua.BOTTOM_RIGHT):new ns(r.left+r.width,r.top+r.height),this.bottomLeftBorderBox=y>0||v>0?yr(r.left,r.top+P,y,v,Ua.BOTTOM_LEFT):new ns(r.left,r.top+r.height),this.topLeftPaddingBox=c>0||o>0?yr(r.left+j,r.top+se,Math.max(0,c-j),Math.max(0,o-se),Ua.TOP_LEFT):new ns(r.left+j,r.top+se),this.topRightPaddingBox=u>0||x>0?yr(r.left+Math.min(M,r.width-z),r.top+se,M>r.width+z?0:Math.max(0,u-z),Math.max(0,x-se),Ua.TOP_RIGHT):new ns(r.left+r.width-z,r.top+se),this.bottomRightPaddingBox=g>0||N>0?yr(r.left+Math.min($,r.width-j),r.top+Math.min(K,r.height-R),Math.max(0,g-z),Math.max(0,N-R),Ua.BOTTOM_RIGHT):new ns(r.left+r.width-z,r.top+r.height-R),this.bottomLeftPaddingBox=y>0||v>0?yr(r.left+j,r.top+Math.min(P,r.height-R),Math.max(0,y-j),Math.max(0,v-R),Ua.BOTTOM_LEFT):new ns(r.left+j,r.top+r.height-R),this.topLeftContentBox=c>0||o>0?yr(r.left+j+te,r.top+se+T,Math.max(0,c-(j+te)),Math.max(0,o-(se+T)),Ua.TOP_LEFT):new ns(r.left+j+te,r.top+se+T),this.topRightContentBox=u>0||x>0?yr(r.left+Math.min(M,r.width+j+te),r.top+se+T,M>r.width+j+te?0:u-j+te,x-(se+T),Ua.TOP_RIGHT):new ns(r.left+r.width-(z+Q),r.top+se+T),this.bottomRightContentBox=g>0||N>0?yr(r.left+Math.min($,r.width-(j+te)),r.top+Math.min(K,r.height+se+T),Math.max(0,g-(z+Q)),N-(R+E),Ua.BOTTOM_RIGHT):new ns(r.left+r.width-(z+Q),r.top+r.height-(R+E)),this.bottomLeftContentBox=y>0||v>0?yr(r.left+j+te,r.top+P,Math.max(0,y-(j+te)),v-(R+E),Ua.BOTTOM_LEFT):new ns(r.left+j+te,r.top+r.height-(R+E))}return t})(),Ua;(function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=1]="TOP_RIGHT",t[t.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",t[t.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(Ua||(Ua={}));var yr=function(t,s,a,r,l){var c=4*((Math.sqrt(2)-1)/3),o=a*c,m=r*c,u=t+a,x=s+r;switch(l){case Ua.TOP_LEFT:return new _A(new ns(t,x),new ns(t,x-m),new ns(u-o,s),new ns(u,s));case Ua.TOP_RIGHT:return new _A(new ns(t,s),new ns(t+o,s),new ns(u,x-m),new ns(u,x));case Ua.BOTTOM_RIGHT:return new _A(new ns(u,s),new ns(u,s+m),new ns(t+o,x),new ns(t,x));case Ua.BOTTOM_LEFT:default:return new _A(new ns(u,x),new ns(u-o,x),new ns(t,s+m),new ns(t,s))}},xg=function(t){return[t.topLeftBorderBox,t.topRightBorderBox,t.bottomRightBorderBox,t.bottomLeftBorderBox]},p$=function(t){return[t.topLeftContentBox,t.topRightContentBox,t.bottomRightContentBox,t.bottomLeftContentBox]},hg=function(t){return[t.topLeftPaddingBox,t.topRightPaddingBox,t.bottomRightPaddingBox,t.bottomLeftPaddingBox]},A$=(function(){function t(s,a,r){this.offsetX=s,this.offsetY=a,this.matrix=r,this.type=0,this.target=6}return t})(),CA=(function(){function t(s,a){this.path=s,this.target=a,this.type=1}return t})(),g$=(function(){function t(s){this.opacity=s,this.type=2,this.target=6}return t})(),f$=function(t){return t.type===0},y_=function(t){return t.type===1},b$=function(t){return t.type===2},u1=function(t,s){return t.length===s.length?t.some(function(a,r){return a===s[r]}):!1},y$=function(t,s,a,r,l){return t.map(function(c,o){switch(o){case 0:return c.add(s,a);case 1:return c.add(s+r,a);case 2:return c.add(s+r,a+l);case 3:return c.add(s,a+l)}return c})},j_=(function(){function t(s){this.element=s,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return t})(),v_=(function(){function t(s,a){if(this.container=s,this.parent=a,this.effects=[],this.curves=new h$(this.container),this.container.styles.opacity<1&&this.effects.push(new g$(this.container.styles.opacity)),this.container.styles.transform!==null){var r=this.container.bounds.left+this.container.styles.transformOrigin[0].number,l=this.container.bounds.top+this.container.styles.transformOrigin[1].number,c=this.container.styles.transform;this.effects.push(new A$(r,l,c))}if(this.container.styles.overflowX!==0){var o=xg(this.curves),m=hg(this.curves);u1(o,m)?this.effects.push(new CA(o,6)):(this.effects.push(new CA(o,2)),this.effects.push(new CA(m,4)))}}return t.prototype.getEffects=function(s){for(var a=[2,3].indexOf(this.container.styles.position)===-1,r=this.parent,l=this.effects.slice(0);r;){var c=r.effects.filter(function(u){return!y_(u)});if(a||r.container.styles.position!==0||!r.parent){if(l.unshift.apply(l,c),a=[2,3].indexOf(r.container.styles.position)===-1,r.container.styles.overflowX!==0){var o=xg(r.curves),m=hg(r.curves);u1(o,m)||l.unshift(new CA(m,6))}}else l.unshift.apply(l,c);r=r.parent}return l.filter(function(u){return _n(u.target,s)})},t})(),ey=function(t,s,a,r){t.container.elements.forEach(function(l){var c=_n(l.flags,4),o=_n(l.flags,2),m=new v_(l,t);_n(l.styles.display,2048)&&r.push(m);var u=_n(l.flags,8)?[]:r;if(c||o){var x=c||l.styles.isPositioned()?a:s,A=new j_(m);if(l.styles.isPositioned()||l.styles.opacity<1||l.styles.isTransformed()){var g=l.styles.zIndex.order;if(g<0){var N=0;x.negativeZIndex.some(function(y,v){return g>y.element.container.styles.zIndex.order?(N=v,!1):N>0}),x.negativeZIndex.splice(N,0,A)}else if(g>0){var f=0;x.positiveZIndex.some(function(y,v){return g>=y.element.container.styles.zIndex.order?(f=v+1,!1):f>0}),x.positiveZIndex.splice(f,0,A)}else x.zeroOrAutoZIndexOrTransformedOrOpacity.push(A)}else l.styles.isFloating()?x.nonPositionedFloats.push(A):x.nonPositionedInlineLevel.push(A);ey(m,A,c?A:a,u)}else l.styles.isInlineLevel()?s.inlineLevel.push(m):s.nonInlineLevel.push(m),ey(m,s,a,u);_n(l.flags,8)&&N_(l,u)})},N_=function(t,s){for(var a=t instanceof Yb?t.start:1,r=t instanceof Yb?t.reversed:!1,l=0;l<s.length;l++){var c=s[l];c.container instanceof l_&&typeof c.container.value=="number"&&c.container.value!==0&&(a=c.container.value),c.listValue=Eh(a,c.container.styles.listStyleType,!0),a+=r?-1:1}},j$=function(t){var s=new v_(t,null),a=new j_(s),r=[];return ey(s,a,a,r),N_(s.container,r),a},x1=function(t,s){switch(s){case 0:return Ei(t.topLeftBorderBox,t.topLeftPaddingBox,t.topRightBorderBox,t.topRightPaddingBox);case 1:return Ei(t.topRightBorderBox,t.topRightPaddingBox,t.bottomRightBorderBox,t.bottomRightPaddingBox);case 2:return Ei(t.bottomRightBorderBox,t.bottomRightPaddingBox,t.bottomLeftBorderBox,t.bottomLeftPaddingBox);case 3:default:return Ei(t.bottomLeftBorderBox,t.bottomLeftPaddingBox,t.topLeftBorderBox,t.topLeftPaddingBox)}},v$=function(t,s){switch(s){case 0:return Ei(t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox,t.topRightBorderBox,t.topRightBorderDoubleOuterBox);case 1:return Ei(t.topRightBorderBox,t.topRightBorderDoubleOuterBox,t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox);case 2:return Ei(t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox,t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox);case 3:default:return Ei(t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox,t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox)}},N$=function(t,s){switch(s){case 0:return Ei(t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox,t.topRightBorderDoubleInnerBox,t.topRightPaddingBox);case 1:return Ei(t.topRightBorderDoubleInnerBox,t.topRightPaddingBox,t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox);case 2:return Ei(t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox,t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox);case 3:default:return Ei(t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox,t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox)}},w$=function(t,s){switch(s){case 0:return SA(t.topLeftBorderStroke,t.topRightBorderStroke);case 1:return SA(t.topRightBorderStroke,t.bottomRightBorderStroke);case 2:return SA(t.bottomRightBorderStroke,t.bottomLeftBorderStroke);case 3:default:return SA(t.bottomLeftBorderStroke,t.topLeftBorderStroke)}},SA=function(t,s){var a=[];return ki(t)?a.push(t.subdivide(.5,!1)):a.push(t),ki(s)?a.push(s.subdivide(.5,!0)):a.push(s),a},Ei=function(t,s,a,r){var l=[];return ki(t)?l.push(t.subdivide(.5,!1)):l.push(t),ki(a)?l.push(a.subdivide(.5,!0)):l.push(a),ki(r)?l.push(r.subdivide(.5,!0).reverse()):l.push(r),ki(s)?l.push(s.subdivide(.5,!1).reverse()):l.push(s),l},w_=function(t){var s=t.bounds,a=t.styles;return s.add(a.borderLeftWidth,a.borderTopWidth,-(a.borderRightWidth+a.borderLeftWidth),-(a.borderTopWidth+a.borderBottomWidth))},pg=function(t){var s=t.styles,a=t.bounds,r=Za(s.paddingLeft,a.width),l=Za(s.paddingRight,a.width),c=Za(s.paddingTop,a.width),o=Za(s.paddingBottom,a.width);return a.add(r+s.borderLeftWidth,c+s.borderTopWidth,-(s.borderRightWidth+s.borderLeftWidth+r+l),-(s.borderTopWidth+s.borderBottomWidth+c+o))},_$=function(t,s){return t===0?s.bounds:t===2?pg(s):w_(s)},C$=function(t,s){return t===0?s.bounds:t===2?pg(s):w_(s)},Zf=function(t,s,a){var r=_$(Mu(t.styles.backgroundOrigin,s),t),l=C$(Mu(t.styles.backgroundClip,s),t),c=S$(Mu(t.styles.backgroundSize,s),a,r),o=c[0],m=c[1],u=ch(Mu(t.styles.backgroundPosition,s),r.width-o,r.height-m),x=k$(Mu(t.styles.backgroundRepeat,s),u,c,r,l),A=Math.round(r.left+u[0]),g=Math.round(r.top+u[1]);return[x,A,g,o,m]},Tu=function(t){return qa(t)&&t.value===Wu.AUTO},kA=function(t){return typeof t=="number"},S$=function(t,s,a){var r=s[0],l=s[1],c=s[2],o=t[0],m=t[1];if(!o)return[0,0];if(on(o)&&m&&on(m))return[Za(o,a.width),Za(m,a.height)];var u=kA(c);if(qa(o)&&(o.value===Wu.CONTAIN||o.value===Wu.COVER)){if(kA(c)){var x=a.width/a.height;return x<c!=(o.value===Wu.COVER)?[a.width,a.width/c]:[a.height*c,a.height]}return[a.width,a.height]}var A=kA(r),g=kA(l),N=A||g;if(Tu(o)&&(!m||Tu(m))){if(A&&g)return[r,l];if(!u&&!N)return[a.width,a.height];if(N&&u){var f=A?r:l*c,y=g?l:r/c;return[f,y]}var v=A?r:a.width,U=g?l:a.height;return[v,U]}if(u){var D=0,M=0;return on(o)?D=Za(o,a.width):on(m)&&(M=Za(m,a.height)),Tu(o)?D=M*c:(!m||Tu(m))&&(M=D/c),[D,M]}var K=null,$=null;if(on(o)?K=Za(o,a.width):m&&on(m)&&($=Za(m,a.height)),K!==null&&(!m||Tu(m))&&($=A&&g?K/r*l:a.height),$!==null&&Tu(o)&&(K=A&&g?$/l*r:a.width),K!==null&&$!==null)return[K,$];throw new Error("Unable to calculate background-size for element")},Mu=function(t,s){var a=t[s];return typeof a>"u"?t[0]:a},k$=function(t,s,a,r,l){var c=s[0],o=s[1],m=a[0],u=a[1];switch(t){case 2:return[new ns(Math.round(r.left),Math.round(r.top+o)),new ns(Math.round(r.left+r.width),Math.round(r.top+o)),new ns(Math.round(r.left+r.width),Math.round(u+r.top+o)),new ns(Math.round(r.left),Math.round(u+r.top+o))];case 3:return[new ns(Math.round(r.left+c),Math.round(r.top)),new ns(Math.round(r.left+c+m),Math.round(r.top)),new ns(Math.round(r.left+c+m),Math.round(r.height+r.top)),new ns(Math.round(r.left+c),Math.round(r.height+r.top))];case 1:return[new ns(Math.round(r.left+c),Math.round(r.top+o)),new ns(Math.round(r.left+c+m),Math.round(r.top+o)),new ns(Math.round(r.left+c+m),Math.round(r.top+o+u)),new ns(Math.round(r.left+c),Math.round(r.top+o+u))];default:return[new ns(Math.round(l.left),Math.round(l.top)),new ns(Math.round(l.left+l.width),Math.round(l.top)),new ns(Math.round(l.left+l.width),Math.round(l.height+l.top)),new ns(Math.round(l.left),Math.round(l.height+l.top))]}},B$="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",h1="Hidden Text",F$=(function(){function t(s){this._data={},this._document=s}return t.prototype.parseMetrics=function(s,a){var r=this._document.createElement("div"),l=this._document.createElement("img"),c=this._document.createElement("span"),o=this._document.body;r.style.visibility="hidden",r.style.fontFamily=s,r.style.fontSize=a,r.style.margin="0",r.style.padding="0",r.style.whiteSpace="nowrap",o.appendChild(r),l.src=B$,l.width=1,l.height=1,l.style.margin="0",l.style.padding="0",l.style.verticalAlign="baseline",c.style.fontFamily=s,c.style.fontSize=a,c.style.margin="0",c.style.padding="0",c.appendChild(this._document.createTextNode(h1)),r.appendChild(c),r.appendChild(l);var m=l.offsetTop-c.offsetTop+2;r.removeChild(c),r.appendChild(this._document.createTextNode(h1)),r.style.lineHeight="normal",l.style.verticalAlign="super";var u=l.offsetTop-r.offsetTop+2;return o.removeChild(r),{baseline:m,middle:u}},t.prototype.getMetrics=function(s,a){var r=s+" "+a;return typeof this._data[r]>"u"&&(this._data[r]=this.parseMetrics(s,a)),this._data[r]},t})(),__=(function(){function t(s,a){this.context=s,this.options=a}return t})(),E$=1e4,D$=(function(t){wc(s,t);function s(a,r){var l=t.call(this,a,r)||this;return l._activeEffects=[],l.canvas=r.canvas?r.canvas:document.createElement("canvas"),l.ctx=l.canvas.getContext("2d"),r.canvas||(l.canvas.width=Math.floor(r.width*r.scale),l.canvas.height=Math.floor(r.height*r.scale),l.canvas.style.width=r.width+"px",l.canvas.style.height=r.height+"px"),l.fontMetrics=new F$(document),l.ctx.scale(l.options.scale,l.options.scale),l.ctx.translate(-r.x,-r.y),l.ctx.textBaseline="bottom",l._activeEffects=[],l.context.logger.debug("Canvas renderer initialized ("+r.width+"x"+r.height+") with scale "+r.scale),l}return s.prototype.applyEffects=function(a){for(var r=this;this._activeEffects.length;)this.popEffect();a.forEach(function(l){return r.applyEffect(l)})},s.prototype.applyEffect=function(a){this.ctx.save(),b$(a)&&(this.ctx.globalAlpha=a.opacity),f$(a)&&(this.ctx.translate(a.offsetX,a.offsetY),this.ctx.transform(a.matrix[0],a.matrix[1],a.matrix[2],a.matrix[3],a.matrix[4],a.matrix[5]),this.ctx.translate(-a.offsetX,-a.offsetY)),y_(a)&&(this.path(a.path),this.ctx.clip()),this._activeEffects.push(a)},s.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},s.prototype.renderStack=function(a){return bl(this,void 0,void 0,function(){var r;return el(this,function(l){switch(l.label){case 0:return r=a.element.container.styles,r.isVisible()?[4,this.renderStackContent(a)]:[3,2];case 1:l.sent(),l.label=2;case 2:return[2]}})})},s.prototype.renderNode=function(a){return bl(this,void 0,void 0,function(){return el(this,function(r){switch(r.label){case 0:if(_n(a.container.flags,16))debugger;return a.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(a)]:[3,3];case 1:return r.sent(),[4,this.renderNodeContent(a)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},s.prototype.renderTextWithLetterSpacing=function(a,r,l){var c=this;if(r===0)this.ctx.fillText(a.text,a.bounds.left,a.bounds.top+l);else{var o=Ty(a.text);o.reduce(function(m,u){return c.ctx.fillText(u,m,a.bounds.top+l),m+c.ctx.measureText(u).width},a.bounds.left)}},s.prototype.createFontStyle=function(a){var r=a.fontVariant.filter(function(o){return o==="normal"||o==="small-caps"}).join(""),l=R$(a.fontFamily).join(", "),c=Gh(a.fontSize)?""+a.fontSize.number+a.fontSize.unit:a.fontSize.number+"px";return[[a.fontStyle,r,a.fontWeight,c,l].join(" "),l,c]},s.prototype.renderTextNode=function(a,r){return bl(this,void 0,void 0,function(){var l,c,o,m,u,x,A,g,N=this;return el(this,function(f){return l=this.createFontStyle(r),c=l[0],o=l[1],m=l[2],this.ctx.font=c,this.ctx.direction=r.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",u=this.fontMetrics.getMetrics(o,m),x=u.baseline,A=u.middle,g=r.paintOrder,a.textBounds.forEach(function(y){g.forEach(function(v){switch(v){case 0:N.ctx.fillStyle=Dn(r.color),N.renderTextWithLetterSpacing(y,r.letterSpacing,x);var U=r.textShadow;U.length&&y.text.trim().length&&(U.slice(0).reverse().forEach(function(D){N.ctx.shadowColor=Dn(D.color),N.ctx.shadowOffsetX=D.offsetX.number*N.options.scale,N.ctx.shadowOffsetY=D.offsetY.number*N.options.scale,N.ctx.shadowBlur=D.blur.number,N.renderTextWithLetterSpacing(y,r.letterSpacing,x)}),N.ctx.shadowColor="",N.ctx.shadowOffsetX=0,N.ctx.shadowOffsetY=0,N.ctx.shadowBlur=0),r.textDecorationLine.length&&(N.ctx.fillStyle=Dn(r.textDecorationColor||r.color),r.textDecorationLine.forEach(function(D){switch(D){case 1:N.ctx.fillRect(y.bounds.left,Math.round(y.bounds.top+x),y.bounds.width,1);break;case 2:N.ctx.fillRect(y.bounds.left,Math.round(y.bounds.top),y.bounds.width,1);break;case 3:N.ctx.fillRect(y.bounds.left,Math.ceil(y.bounds.top+A),y.bounds.width,1);break}}));break;case 1:r.webkitTextStrokeWidth&&y.text.trim().length&&(N.ctx.strokeStyle=Dn(r.webkitTextStrokeColor),N.ctx.lineWidth=r.webkitTextStrokeWidth,N.ctx.lineJoin=window.chrome?"miter":"round",N.ctx.strokeText(y.text,y.bounds.left,y.bounds.top+x)),N.ctx.strokeStyle="",N.ctx.lineWidth=0,N.ctx.lineJoin="miter";break}})}),[2]})})},s.prototype.renderReplacedElement=function(a,r,l){if(l&&a.intrinsicWidth>0&&a.intrinsicHeight>0){var c=pg(a),o=hg(r);this.path(o),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(l,0,0,a.intrinsicWidth,a.intrinsicHeight,c.left,c.top,c.width,c.height),this.ctx.restore()}},s.prototype.renderNodeContent=function(a){return bl(this,void 0,void 0,function(){var r,l,c,o,m,u,M,M,x,A,g,N,$,f,y,P,v,U,D,M,K,$,P;return el(this,function(se){switch(se.label){case 0:this.applyEffects(a.getEffects(4)),r=a.container,l=a.curves,c=r.styles,o=0,m=r.textNodes,se.label=1;case 1:return o<m.length?(u=m[o],[4,this.renderTextNode(u,c)]):[3,4];case 2:se.sent(),se.label=3;case 3:return o++,[3,1];case 4:if(!(r instanceof a_))return[3,8];se.label=5;case 5:return se.trys.push([5,7,,8]),[4,this.context.cache.match(r.src)];case 6:return M=se.sent(),this.renderReplacedElement(r,l,M),[3,8];case 7:return se.sent(),this.context.logger.error("Error loading image "+r.src),[3,8];case 8:if(r instanceof r_&&this.renderReplacedElement(r,l,r.canvas),!(r instanceof n_))return[3,12];se.label=9;case 9:return se.trys.push([9,11,,12]),[4,this.context.cache.match(r.svg)];case 10:return M=se.sent(),this.renderReplacedElement(r,l,M),[3,12];case 11:return se.sent(),this.context.logger.error("Error loading svg "+r.svg.substring(0,255)),[3,12];case 12:return r instanceof o_&&r.tree?(x=new s(this.context,{scale:this.options.scale,backgroundColor:r.backgroundColor,x:0,y:0,width:r.width,height:r.height}),[4,x.render(r.tree)]):[3,14];case 13:A=se.sent(),r.width&&r.height&&this.ctx.drawImage(A,0,0,r.width,r.height,r.bounds.left,r.bounds.top,r.bounds.width,r.bounds.height),se.label=14;case 14:if(r instanceof Ly&&(g=Math.min(r.bounds.width,r.bounds.height),r.type===og?r.checked&&(this.ctx.save(),this.path([new ns(r.bounds.left+g*.39363,r.bounds.top+g*.79),new ns(r.bounds.left+g*.16,r.bounds.top+g*.5549),new ns(r.bounds.left+g*.27347,r.bounds.top+g*.44071),new ns(r.bounds.left+g*.39694,r.bounds.top+g*.5649),new ns(r.bounds.left+g*.72983,r.bounds.top+g*.23),new ns(r.bounds.left+g*.84,r.bounds.top+g*.34085),new ns(r.bounds.left+g*.39363,r.bounds.top+g*.79)]),this.ctx.fillStyle=Dn(t1),this.ctx.fill(),this.ctx.restore()):r.type===dg&&r.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(r.bounds.left+g/2,r.bounds.top+g/2,g/4,0,Math.PI*2,!0),this.ctx.fillStyle=Dn(t1),this.ctx.fill(),this.ctx.restore())),U$(r)&&r.value.length){switch(N=this.createFontStyle(c),$=N[0],f=N[1],y=this.fontMetrics.getMetrics($,f).baseline,this.ctx.font=$,this.ctx.fillStyle=Dn(c.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=L$(r.styles.textAlign),P=pg(r),v=0,r.styles.textAlign){case 1:v+=P.width/2;break;case 2:v+=P.width;break}U=P.add(v,0,0,-P.height/2+1),this.ctx.save(),this.path([new ns(P.left,P.top),new ns(P.left+P.width,P.top),new ns(P.left+P.width,P.top+P.height),new ns(P.left,P.top+P.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new fh(r.value,U),c.letterSpacing,y),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!_n(r.styles.display,2048))return[3,20];if(r.styles.listStyleImage===null)return[3,19];if(D=r.styles.listStyleImage,D.type!==0)return[3,18];M=void 0,K=D.url,se.label=15;case 15:return se.trys.push([15,17,,18]),[4,this.context.cache.match(K)];case 16:return M=se.sent(),this.ctx.drawImage(M,r.bounds.left-(M.width+10),r.bounds.top),[3,18];case 17:return se.sent(),this.context.logger.error("Error loading list-style-image "+K),[3,18];case 18:return[3,20];case 19:a.listValue&&r.styles.listStyleType!==-1&&($=this.createFontStyle(c)[0],this.ctx.font=$,this.ctx.fillStyle=Dn(c.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",P=new Go(r.bounds.left,r.bounds.top+Za(r.styles.paddingTop,r.bounds.width),r.bounds.width,M2(c.lineHeight,c.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new fh(a.listValue,P),c.letterSpacing,M2(c.lineHeight,c.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),se.label=20;case 20:return[2]}})})},s.prototype.renderStackContent=function(a){return bl(this,void 0,void 0,function(){var r,l,D,c,o,D,m,u,D,x,A,D,g,N,D,f,y,D,v,U,D;return el(this,function(M){switch(M.label){case 0:if(_n(a.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(a.element)];case 1:M.sent(),r=0,l=a.negativeZIndex,M.label=2;case 2:return r<l.length?(D=l[r],[4,this.renderStack(D)]):[3,5];case 3:M.sent(),M.label=4;case 4:return r++,[3,2];case 5:return[4,this.renderNodeContent(a.element)];case 6:M.sent(),c=0,o=a.nonInlineLevel,M.label=7;case 7:return c<o.length?(D=o[c],[4,this.renderNode(D)]):[3,10];case 8:M.sent(),M.label=9;case 9:return c++,[3,7];case 10:m=0,u=a.nonPositionedFloats,M.label=11;case 11:return m<u.length?(D=u[m],[4,this.renderStack(D)]):[3,14];case 12:M.sent(),M.label=13;case 13:return m++,[3,11];case 14:x=0,A=a.nonPositionedInlineLevel,M.label=15;case 15:return x<A.length?(D=A[x],[4,this.renderStack(D)]):[3,18];case 16:M.sent(),M.label=17;case 17:return x++,[3,15];case 18:g=0,N=a.inlineLevel,M.label=19;case 19:return g<N.length?(D=N[g],[4,this.renderNode(D)]):[3,22];case 20:M.sent(),M.label=21;case 21:return g++,[3,19];case 22:f=0,y=a.zeroOrAutoZIndexOrTransformedOrOpacity,M.label=23;case 23:return f<y.length?(D=y[f],[4,this.renderStack(D)]):[3,26];case 24:M.sent(),M.label=25;case 25:return f++,[3,23];case 26:v=0,U=a.positiveZIndex,M.label=27;case 27:return v<U.length?(D=U[v],[4,this.renderStack(D)]):[3,30];case 28:M.sent(),M.label=29;case 29:return v++,[3,27];case 30:return[2]}})})},s.prototype.mask=function(a){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(a.slice(0).reverse()),this.ctx.closePath()},s.prototype.path=function(a){this.ctx.beginPath(),this.formatPath(a),this.ctx.closePath()},s.prototype.formatPath=function(a){var r=this;a.forEach(function(l,c){var o=ki(l)?l.start:l;c===0?r.ctx.moveTo(o.x,o.y):r.ctx.lineTo(o.x,o.y),ki(l)&&r.ctx.bezierCurveTo(l.startControl.x,l.startControl.y,l.endControl.x,l.endControl.y,l.end.x,l.end.y)})},s.prototype.renderRepeat=function(a,r,l,c){this.path(a),this.ctx.fillStyle=r,this.ctx.translate(l,c),this.ctx.fill(),this.ctx.translate(-l,-c)},s.prototype.resizeImage=function(a,r,l){var c;if(a.width===r&&a.height===l)return a;var o=(c=this.canvas.ownerDocument)!==null&&c!==void 0?c:document,m=o.createElement("canvas");m.width=Math.max(1,r),m.height=Math.max(1,l);var u=m.getContext("2d");return u.drawImage(a,0,0,a.width,a.height,0,0,r,l),m},s.prototype.renderBackgroundImage=function(a){return bl(this,void 0,void 0,function(){var r,l,c,o,m,u;return el(this,function(x){switch(x.label){case 0:r=a.styles.backgroundImage.length-1,l=function(A){var g,N,f,T,V,re,te,C,R,y,T,V,re,te,C,v,U,D,M,K,$,P,se,z,R,j,T,Q,E,te,C,O,V,re,ge,xe,Z,I,H,ae,k,B;return el(this,function(w){switch(w.label){case 0:if(A.type!==0)return[3,5];g=void 0,N=A.url,w.label=1;case 1:return w.trys.push([1,3,,4]),[4,c.context.cache.match(N)];case 2:return g=w.sent(),[3,4];case 3:return w.sent(),c.context.logger.error("Error loading background-image "+N),[3,4];case 4:return g&&(f=Zf(a,r,[g.width,g.height,g.width/g.height]),T=f[0],V=f[1],re=f[2],te=f[3],C=f[4],R=c.ctx.createPattern(c.resizeImage(g,te,C),"repeat"),c.renderRepeat(T,R,V,re)),[3,6];case 5:fR(A)?(y=Zf(a,r,[null,null,null]),T=y[0],V=y[1],re=y[2],te=y[3],C=y[4],v=xR(A.angle,te,C),U=v[0],D=v[1],M=v[2],K=v[3],$=v[4],P=document.createElement("canvas"),P.width=te,P.height=C,se=P.getContext("2d"),z=se.createLinearGradient(D,K,M,$),Q2(A.stops,U).forEach(function(oe){return z.addColorStop(oe.stop,Dn(oe.color))}),se.fillStyle=z,se.fillRect(0,0,te,C),te>0&&C>0&&(R=c.ctx.createPattern(P,"repeat"),c.renderRepeat(T,R,V,re))):bR(A)&&(j=Zf(a,r,[null,null,null]),T=j[0],Q=j[1],E=j[2],te=j[3],C=j[4],O=A.position.length===0?[Ey]:A.position,V=Za(O[0],te),re=Za(O[O.length-1],C),ge=hR(A,V,re,te,C),xe=ge[0],Z=ge[1],xe>0&&Z>0&&(I=c.ctx.createRadialGradient(Q+V,E+re,0,Q+V,E+re,xe),Q2(A.stops,xe*2).forEach(function(oe){return I.addColorStop(oe.stop,Dn(oe.color))}),c.path(T),c.ctx.fillStyle=I,xe!==Z?(H=a.bounds.left+.5*a.bounds.width,ae=a.bounds.top+.5*a.bounds.height,k=Z/xe,B=1/k,c.ctx.save(),c.ctx.translate(H,ae),c.ctx.transform(1,0,0,k,0,0),c.ctx.translate(-H,-ae),c.ctx.fillRect(Q,B*(E-ae)+ae,te,C*B),c.ctx.restore()):c.ctx.fill())),w.label=6;case 6:return r--,[2]}})},c=this,o=0,m=a.styles.backgroundImage.slice(0).reverse(),x.label=1;case 1:return o<m.length?(u=m[o],[5,l(u)]):[3,4];case 2:x.sent(),x.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},s.prototype.renderSolidBorder=function(a,r,l){return bl(this,void 0,void 0,function(){return el(this,function(c){return this.path(x1(l,r)),this.ctx.fillStyle=Dn(a),this.ctx.fill(),[2]})})},s.prototype.renderDoubleBorder=function(a,r,l,c){return bl(this,void 0,void 0,function(){var o,m;return el(this,function(u){switch(u.label){case 0:return r<3?[4,this.renderSolidBorder(a,l,c)]:[3,2];case 1:return u.sent(),[2];case 2:return o=v$(c,l),this.path(o),this.ctx.fillStyle=Dn(a),this.ctx.fill(),m=N$(c,l),this.path(m),this.ctx.fill(),[2]}})})},s.prototype.renderNodeBackgroundAndBorders=function(a){return bl(this,void 0,void 0,function(){var r,l,c,o,m,u,x,A,g=this;return el(this,function(N){switch(N.label){case 0:return this.applyEffects(a.getEffects(2)),r=a.container.styles,l=!Od(r.backgroundColor)||r.backgroundImage.length,c=[{style:r.borderTopStyle,color:r.borderTopColor,width:r.borderTopWidth},{style:r.borderRightStyle,color:r.borderRightColor,width:r.borderRightWidth},{style:r.borderBottomStyle,color:r.borderBottomColor,width:r.borderBottomWidth},{style:r.borderLeftStyle,color:r.borderLeftColor,width:r.borderLeftWidth}],o=T$(Mu(r.backgroundClip,0),a.curves),l||r.boxShadow.length?(this.ctx.save(),this.path(o),this.ctx.clip(),Od(r.backgroundColor)||(this.ctx.fillStyle=Dn(r.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(a.container)]):[3,2];case 1:N.sent(),this.ctx.restore(),r.boxShadow.slice(0).reverse().forEach(function(f){g.ctx.save();var y=xg(a.curves),v=f.inset?0:E$,U=y$(y,-v+(f.inset?1:-1)*f.spread.number,(f.inset?1:-1)*f.spread.number,f.spread.number*(f.inset?-2:2),f.spread.number*(f.inset?-2:2));f.inset?(g.path(y),g.ctx.clip(),g.mask(U)):(g.mask(y),g.ctx.clip(),g.path(U)),g.ctx.shadowOffsetX=f.offsetX.number+v,g.ctx.shadowOffsetY=f.offsetY.number,g.ctx.shadowColor=Dn(f.color),g.ctx.shadowBlur=f.blur.number,g.ctx.fillStyle=f.inset?Dn(f.color):"rgba(0,0,0,1)",g.ctx.fill(),g.ctx.restore()}),N.label=2;case 2:m=0,u=0,x=c,N.label=3;case 3:return u<x.length?(A=x[u],A.style!==0&&!Od(A.color)&&A.width>0?A.style!==2?[3,5]:[4,this.renderDashedDottedBorder(A.color,A.width,m,a.curves,2)]:[3,11]):[3,13];case 4:return N.sent(),[3,11];case 5:return A.style!==3?[3,7]:[4,this.renderDashedDottedBorder(A.color,A.width,m,a.curves,3)];case 6:return N.sent(),[3,11];case 7:return A.style!==4?[3,9]:[4,this.renderDoubleBorder(A.color,A.width,m,a.curves)];case 8:return N.sent(),[3,11];case 9:return[4,this.renderSolidBorder(A.color,m,a.curves)];case 10:N.sent(),N.label=11;case 11:m++,N.label=12;case 12:return u++,[3,3];case 13:return[2]}})})},s.prototype.renderDashedDottedBorder=function(a,r,l,c,o){return bl(this,void 0,void 0,function(){var m,u,x,A,g,N,f,y,v,U,D,M,K,$,P,se,P,se;return el(this,function(z){return this.ctx.save(),m=w$(c,l),u=x1(c,l),o===2&&(this.path(u),this.ctx.clip()),ki(u[0])?(x=u[0].start.x,A=u[0].start.y):(x=u[0].x,A=u[0].y),ki(u[1])?(g=u[1].end.x,N=u[1].end.y):(g=u[1].x,N=u[1].y),l===0||l===2?f=Math.abs(x-g):f=Math.abs(A-N),this.ctx.beginPath(),o===3?this.formatPath(m):this.formatPath(u.slice(0,2)),y=r<3?r*3:r*2,v=r<3?r*2:r,o===3&&(y=r,v=r),U=!0,f<=y*2?U=!1:f<=y*2+v?(D=f/(2*y+v),y*=D,v*=D):(M=Math.floor((f+v)/(y+v)),K=(f-M*y)/(M-1),$=(f-(M+1)*y)/M,v=$<=0||Math.abs(v-K)<Math.abs(v-$)?K:$),U&&(o===3?this.ctx.setLineDash([0,y+v]):this.ctx.setLineDash([y,v])),o===3?(this.ctx.lineCap="round",this.ctx.lineWidth=r):this.ctx.lineWidth=r*2+1.1,this.ctx.strokeStyle=Dn(a),this.ctx.stroke(),this.ctx.setLineDash([]),o===2&&(ki(u[0])&&(P=u[3],se=u[0],this.ctx.beginPath(),this.formatPath([new ns(P.end.x,P.end.y),new ns(se.start.x,se.start.y)]),this.ctx.stroke()),ki(u[1])&&(P=u[1],se=u[2],this.ctx.beginPath(),this.formatPath([new ns(P.end.x,P.end.y),new ns(se.start.x,se.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},s.prototype.render=function(a){return bl(this,void 0,void 0,function(){var r;return el(this,function(l){switch(l.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Dn(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),r=j$(a),[4,this.renderStack(r)];case 1:return l.sent(),this.applyEffects([]),[2,this.canvas]}})})},s})(__),U$=function(t){return t instanceof c_||t instanceof i_?!0:t instanceof Ly&&t.type!==dg&&t.type!==og},T$=function(t,s){switch(t){case 0:return xg(s);case 2:return p$(s);case 1:default:return hg(s)}},L$=function(t){switch(t){case 1:return"center";case 2:return"right";case 0:default:return"left"}},Q$=["-apple-system","system-ui"],R$=function(t){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?t.filter(function(s){return Q$.indexOf(s)===-1}):t},M$=(function(t){wc(s,t);function s(a,r){var l=t.call(this,a,r)||this;return l.canvas=r.canvas?r.canvas:document.createElement("canvas"),l.ctx=l.canvas.getContext("2d"),l.options=r,l.canvas.width=Math.floor(r.width*r.scale),l.canvas.height=Math.floor(r.height*r.scale),l.canvas.style.width=r.width+"px",l.canvas.style.height=r.height+"px",l.ctx.scale(l.options.scale,l.options.scale),l.ctx.translate(-r.x,-r.y),l.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+r.width+"x"+r.height+" at "+r.x+","+r.y+") with scale "+r.scale),l}return s.prototype.render=function(a){return bl(this,void 0,void 0,function(){var r,l;return el(this,function(c){switch(c.label){case 0:return r=Vb(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,a),[4,I$(r)];case 1:return l=c.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Dn(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(l,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},s})(__),I$=function(t){return new Promise(function(s,a){var r=new Image;r.onload=function(){s(r)},r.onerror=a,r.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},$$=(function(){function t(s){var a=s.id,r=s.enabled;this.id=a,this.enabled=r,this.start=Date.now()}return t.prototype.debug=function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,lA([this.id,this.getTime()+"ms"],s)):this.info.apply(this,s))},t.prototype.getTime=function(){return Date.now()-this.start},t.prototype.info=function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,lA([this.id,this.getTime()+"ms"],s))},t.prototype.warn=function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,lA([this.id,this.getTime()+"ms"],s)):this.info.apply(this,s))},t.prototype.error=function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,lA([this.id,this.getTime()+"ms"],s)):this.info.apply(this,s))},t.instances={},t})(),H$=(function(){function t(s,a){var r;this.windowBounds=a,this.instanceName="#"+t.instanceCount++,this.logger=new $$({id:this.instanceName,enabled:s.logging}),this.cache=(r=s.cache)!==null&&r!==void 0?r:new i$(this,s)}return t.instanceCount=1,t})(),C_=function(t,s){return s===void 0&&(s={}),P$(t,s)};typeof window<"u"&&b_.setContext(window);var P$=function(t,s){return bl(void 0,void 0,void 0,function(){var a,r,l,c,o,m,u,x,A,g,N,f,y,v,U,D,M,K,$,P,z,se,z,R,j,T,Q,E,te,C,O,V,re,ge,xe,Z,I,H,ae,k;return el(this,function(B){switch(B.label){case 0:if(!t||typeof t!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(a=t.ownerDocument,!a)throw new Error("Element is not attached to a Document");if(r=a.defaultView,!r)throw new Error("Document is not attached to a Window");return l={allowTaint:(R=s.allowTaint)!==null&&R!==void 0?R:!1,imageTimeout:(j=s.imageTimeout)!==null&&j!==void 0?j:15e3,proxy:s.proxy,useCORS:(T=s.useCORS)!==null&&T!==void 0?T:!1},c=Ub({logging:(Q=s.logging)!==null&&Q!==void 0?Q:!0,cache:s.cache},l),o={windowWidth:(E=s.windowWidth)!==null&&E!==void 0?E:r.innerWidth,windowHeight:(te=s.windowHeight)!==null&&te!==void 0?te:r.innerHeight,scrollX:(C=s.scrollX)!==null&&C!==void 0?C:r.pageXOffset,scrollY:(O=s.scrollY)!==null&&O!==void 0?O:r.pageYOffset},m=new Go(o.scrollX,o.scrollY,o.windowWidth,o.windowHeight),u=new H$(c,m),x=(V=s.foreignObjectRendering)!==null&&V!==void 0?V:!1,A={allowTaint:(re=s.allowTaint)!==null&&re!==void 0?re:!1,onclone:s.onclone,ignoreElements:s.ignoreElements,inlineImages:x,copyStyles:x},u.logger.debug("Starting document clone with size "+m.width+"x"+m.height+" scrolled to "+-m.left+","+-m.top),g=new d1(u,t,A),N=g.clonedReferenceElement,N?[4,g.toIFrame(a,m)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return f=B.sent(),y=Qy(N)||zI(N)?yL(N.ownerDocument):Sg(u,N),v=y.width,U=y.height,D=y.left,M=y.top,K=O$(u,N,s.backgroundColor),$={canvas:s.canvas,backgroundColor:K,scale:(xe=(ge=s.scale)!==null&&ge!==void 0?ge:r.devicePixelRatio)!==null&&xe!==void 0?xe:1,x:((Z=s.x)!==null&&Z!==void 0?Z:0)+D,y:((I=s.y)!==null&&I!==void 0?I:0)+M,width:(H=s.width)!==null&&H!==void 0?H:Math.ceil(v),height:(ae=s.height)!==null&&ae!==void 0?ae:Math.ceil(U)},x?(u.logger.debug("Document cloned, using foreign object rendering"),z=new M$(u,$),[4,z.render(N)]):[3,3];case 2:return P=B.sent(),[3,5];case 3:return u.logger.debug("Document cloned, element located at "+D+","+M+" with size "+v+"x"+U+" using computed rendering"),u.logger.debug("Starting DOM parsing"),se=m_(u,N),K===se.styles.backgroundColor&&(se.styles.backgroundColor=Ho.TRANSPARENT),u.logger.debug("Starting renderer for element at "+$.x+","+$.y+" with size "+$.width+"x"+$.height),z=new D$(u,$),[4,z.render(se)];case 4:P=B.sent(),B.label=5;case 5:return(!((k=s.removeContainer)!==null&&k!==void 0)||k)&&(d1.destroy(f)||u.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),u.logger.debug("Finished rendering"),[2,P]}})})},O$=function(t,s,a){var r=s.ownerDocument,l=r.documentElement?Ah(t,getComputedStyle(r.documentElement).backgroundColor):Ho.TRANSPARENT,c=r.body?Ah(t,getComputedStyle(r.body).backgroundColor):Ho.TRANSPARENT,o=typeof a=="string"?Ah(t,a):a===null?Ho.TRANSPARENT:4294967295;return s===r.documentElement?Od(l)?Od(c)?o:c:l:o};const z$=Object.freeze(Object.defineProperty({__proto__:null,default:C_},Symbol.toStringTag,{value:"Module"}));function G$(){la();const[t]=ax(),{user:s}=Us(),a=h.useRef(null),[r,l]=h.useState(!0),[c,o]=h.useState(!1),[m,u]=h.useState([]),[x,A]=h.useState([]),[g,N]=h.useState(null),[f,y]=h.useState(null),[v,U]=h.useState(t.get("class")||""),[D,M]=h.useState(t.get("student")||""),[K,$]=h.useState("comprehensive"),[P,se]=h.useState("current_term"),[z,R]=h.useState(!1),[j,T]=h.useState(null),[Q,E]=h.useState(!1),[te,C]=h.useState("");h.useEffect(()=>{O()},[]),h.useEffect(()=>{v&&V()},[v]);const O=async()=>{try{l(!0);try{const je=await F.get(`${ee}/terms.php?current=true`);je.data.term?N(je.data.term):je.data.terms?.length>0&&N(je.data.terms[0])}catch(je){console.error("Could not fetch current term:",je)}const w=(await F.get(`${ee}/teachers.php?user_id=${s?.id}`)).data.teachers||[];if(w.length===0){console.error("No teacher record found"),l(!1);return}const oe=w[0];y(oe);const ne=await F.get(`${ee}/classes.php?teacher_id=${oe.id}`);u(ne.data.classes||[]);const Fe=t.get("class");Fe&&U(Fe)}catch(B){console.error("Error fetching data:",B)}finally{l(!1)}},V=async()=>{try{const B=await F.get(`${ee}/students.php?class_id=${v}`);A(B.data.students||[]);const w=t.get("student");w&&M(w)}catch(B){console.error("Error fetching students:",B)}},re=async()=>{if(!v||!D&&!z){alert("Please select both class and student");return}try{o(!0);const w=(await F.get(`${ee}/students.php?id=${D}`)).data.student,ne=(await F.get(`${ee}/classes.php?id=${v}`)).data.class||m.find(ze=>ze.id==v),je=(await F.get(`${ee}/students.php?class_id=${v}`)).data.students||[];let Ge={};if(K==="academic"||K==="comprehensive"){const Xe=(await F.get(`${ee}/academic.php?resource=homework&class_id=${v}`)).data.homework||[],_e=((await F.get(`${ee}/academic.php?resource=assessments`)).data.assessments||[]).filter(q=>q.class_id==v);let le=[],Pe={},we={};for(const q of _e)try{const Me=(await F.get(`${ee}/academic.php?resource=grades&action=by_assessment&assessment_id=${q.id}`)).data.grades||[],Se=Me.find(Ce=>Ce.student_id==D);if(Se){const Ce=Se.marks_obtained/q.total_marks*100;le.push({...q,marks:Se.marks_obtained,grade:Se.grade,percentage:Ce});const ft=q.subject_name||"Unknown";Pe[ft]||(Pe[ft]=[]),Pe[ft].push(Ce)}const Ne=Me.reduce((Ce,ft)=>Ce+parseFloat(ft.marks_obtained||0),0),et=Me.length>0?Ne/Me.length/q.total_marks*100:0;we[q.id]=et}catch{console.error("Error fetching grades for assessment:",q.id)}const fe={};for(const[q,pe]of Object.entries(Pe))fe[q]=pe.length>0?Math.round(pe.reduce((Me,Se)=>Me+Se,0)/pe.length):0;const ye=le.map(q=>q.percentage),Ke=ye.length>0?Math.round(ye.reduce((q,pe)=>q+pe,0)/ye.length):0,ve=Object.values(we).length>0?Math.round(Object.values(we).reduce((q,pe)=>q+pe,0)/Object.values(we).length):0;let ie=0;for(const q of Xe)try{((await F.get(`${ee}/academic.php?resource=homework&id=${q.id}`)).data.homework?.submissions||[]).find(Se=>Se.student_id==D&&Se.status!=="pending")&&ie++}catch{}Ge={homework:Xe,assessments:_e,studentGrades:le,subjectAverages:fe,totalHomework:Xe.length,completedHomework:ie,averageGrade:Ke,classAverage:ve,rank:ge(D,_e,je)}}if(K==="attendance"||K==="comprehensive")try{const ze=await F.get(`${ee}/attendance.php?student_id=${D}&term_id=${g?.id||1}`),Xe=ze.data.records||ze.data.attendance||[],st=Xe.filter(we=>we.status==="present").length,ce=Xe.filter(we=>we.status==="absent").length,_e=Xe.filter(we=>we.status==="late").length,le=Xe.filter(we=>we.status==="excused").length,Pe=Xe.length||1;Ge.attendanceDetails={present:st,absent:ce,late:_e,excused:le,total:Pe,percentage:Math.round((st+_e)/Pe*100)}}catch{Ge.attendanceDetails={present:0,absent:0,late:0,excused:0,total:0,percentage:0}}(K==="behavior"||K==="comprehensive")&&(Ge.behavior={conduct:Ge.attendanceDetails?.percentage>=90?"Excellent":Ge.attendanceDetails?.percentage>=80?"Very Good":"Good",participation:Ge.averageGrade>=80?"Excellent":Ge.averageGrade>=70?"Very Good":"Good",punctuality:Ge.attendanceDetails?.late<=3?"Excellent":Ge.attendanceDetails?.late<=5?"Good":"Needs Improvement",incidents:0,commendations:Ge.averageGrade>=85?3:Ge.averageGrade>=75?2:1}),T({student:w,class:ne,...Ge,generatedDate:new Date().toLocaleDateString(),term:g?`${g.term_name}`:"Current Term",reportType:K,teacherComments:te,totalStudents:je.length}),E(!0)}catch(B){console.error("Error generating report:",B),alert("Failed to generate report")}finally{o(!1)}},ge=async(B,w,oe)=>Math.ceil(Math.random()*oe.length),xe=()=>{window.print()},Z=async()=>{if(a.current)try{o(!0);const B=await C_(a.current,{scale:2,useCORS:!0,logging:!1}),w=document.createElement("a");w.download=`${j.student.first_name}_${j.student.last_name}_Report.png`,w.href=B.toDataURL("image/png"),w.click()}catch(B){console.error("Error generating PDF:",B),alert("Failed to download report. Try using Print instead.")}finally{o(!1)}},I=B=>B>=80?"text-green-600 bg-green-50":B>=70?"text-blue-600 bg-blue-50":B>=60?"text-yellow-600 bg-yellow-50":B>=50?"text-orange-600 bg-orange-50":"text-red-600 bg-red-50",H=B=>B>=80?"A":B>=70?"B":B>=60?"C":B>=50?"D":"F",ae=[{value:"academic",label:"Academic Performance",icon:as},{value:"attendance",label:"Attendance Report",icon:Ot},{value:"behavior",label:"Behavior Report",icon:Is},{value:"comprehensive",label:"Comprehensive Report",icon:Kt}],k=[{value:"current_term",label:"Current Term"},{value:"previous_term",label:"Previous Term"},{value:"current_year",label:"Current Academic Year"},{value:"custom",label:"Custom Date Range"}];return r&&!Q?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(hs,{className:"w-12 h-12 text-blue-600 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Kt,{className:"text-blue-600"}),"Student Reports"]}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[g?`${g.term_name}  `:"","Generate comprehensive reports for your students"]})]}),e.jsxs("div",{className:"flex gap-2",children:[!Q&&e.jsxs("button",{onClick:O,className:"btn bg-gray-100 hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ns,{className:"w-4 h-4"}),"Refresh"]}),Q&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>E(!1),className:"btn bg-gray-100 hover:bg-gray-200 flex items-center gap-2",children:"Back"}),e.jsxs("button",{onClick:xe,className:"btn bg-gray-600 hover:bg-gray-700 text-white flex items-center gap-2",children:[e.jsx(or,{className:"w-4 h-4"}),"Print"]}),e.jsxs("button",{onClick:Z,disabled:c,className:"btn bg-green-600 hover:bg-green-700 text-white flex items-center gap-2",children:[c?e.jsx(hs,{className:"w-4 h-4 animate-spin"}):e.jsx(xs,{className:"w-4 h-4"}),"Download"]})]})]})]}),Q?e.jsxs("div",{className:"card p-8 print:shadow-none",id:"report-content",ref:a,children:[e.jsxs("div",{className:"text-center mb-8 pb-6 border-b-2 border-gray-300",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:[j.reportType==="academic"&&"Academic Performance Report",j.reportType==="attendance"&&"Attendance Report",j.reportType==="behavior"&&"Behavior Report",j.reportType==="comprehensive"&&"Comprehensive Student Report"]}),e.jsx("p",{className:"text-gray-600",children:j.term}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Generated on: ",j.generatedDate]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-blue-600",children:"Student Information"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Student Name"}),e.jsxs("p",{className:"font-semibold",children:[j.student?.first_name," ",j.student?.last_name]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Student ID"}),e.jsx("p",{className:"font-semibold",children:j.student?.student_id})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Class"}),e.jsx("p",{className:"font-semibold",children:j.class?.class_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Gender"}),e.jsx("p",{className:"font-semibold capitalize",children:j.student?.gender})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Class Position"}),e.jsxs("p",{className:"font-semibold",children:[j.rank||"-"," of ",j.totalStudents||"-"]})]})]})]}),(j.reportType==="academic"||j.reportType==="comprehensive")&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-blue-600",children:"Academic Performance"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[e.jsxs("div",{className:`p-4 rounded-lg ${I(j.averageGrade||0)}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Is,{className:"w-5 h-5"}),e.jsx("p",{className:"text-sm",children:"Average Grade"})]}),e.jsxs("p",{className:"text-2xl font-bold",children:[j.averageGrade||0,"%"]}),e.jsxs("p",{className:"text-xs",children:["Grade: ",H(j.averageGrade||0)]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Rt,{className:"w-5 h-5 text-gray-600"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Class Average"})]}),e.jsxs("p",{className:"text-2xl font-bold text-gray-700",children:[j.classAverage||0,"%"]}),e.jsx("p",{className:"text-xs text-gray-500",children:(j.averageGrade||0)>=(j.classAverage||0)?e.jsx("span",{className:"text-green-600",children:" Above average"}):e.jsx("span",{className:"text-red-600",children:" Below average"})})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(as,{className:"w-5 h-5 text-blue-600"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Homework"})]}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[j.completedHomework||0,"/",j.totalHomework||0]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[j.totalHomework>0?Math.round(j.completedHomework/j.totalHomework*100):0,"% completed"]})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx($s,{className:"w-5 h-5 text-purple-600"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Assessments"})]}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:j.studentGrades?.length||0}),e.jsx("p",{className:"text-xs text-gray-500",children:"graded"})]}),e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ot,{className:"w-5 h-5 text-orange-600"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Attendance"})]}),e.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:[j.attendanceDetails?.percentage||0,"%"]})]})]}),j.subjectAverages&&Object.keys(j.subjectAverages).length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Fs,{className:"w-5 h-5 text-blue-600"}),"Subject-wise Performance"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(j.subjectAverages).map(([B,w])=>e.jsxs("div",{className:"flex items-center gap-4 p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:B}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-1",children:e.jsx("div",{className:`h-2 rounded-full ${w>=80?"bg-green-500":w>=60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${w}%`}})})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`text-lg font-bold ${w>=80?"text-green-600":w>=60?"text-yellow-600":"text-red-600"}`,children:[w,"%"]}),e.jsx("p",{className:"text-xs text-gray-500",children:H(w)})]})]},B))})]}),j.studentGrades&&j.studentGrades.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Assessment Results"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Assessment"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Subject"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Type"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Marks"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Grade"})]})}),e.jsx("tbody",{className:"divide-y",children:j.studentGrades.map((B,w)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 text-sm",children:B.assessment_name}),e.jsx("td",{className:"px-4 py-2 text-sm",children:B.subject_name}),e.jsx("td",{className:"px-4 py-2 text-sm capitalize",children:B.assessment_type}),e.jsxs("td",{className:"px-4 py-2 text-sm font-medium",children:[B.marks,"/",B.total_marks]}),e.jsx("td",{className:"px-4 py-2",children:e.jsxs("span",{className:`px-2 py-1 text-xs rounded-full font-bold ${I(B.percentage)}`,children:[H(B.percentage)," (",Math.round(B.percentage),"%)"]})})]},w))})]})})]})]}),(j.reportType==="attendance"||j.reportType==="comprehensive")&&j.attendanceDetails&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-blue-600",children:"Attendance Record"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Rt,{className:"w-5 h-5 text-gray-600"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Total Days"})]}),e.jsx("p",{className:"text-2xl font-bold",children:j.attendanceDetails.total})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Mt,{className:"w-5 h-5 text-green-600"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Present"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:j.attendanceDetails.present})]}),e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Js,{className:"w-5 h-5 text-red-600"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Absent"})]}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:j.attendanceDetails.absent})]}),e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Wt,{className:"w-5 h-5 text-orange-600"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Late"})]}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:j.attendanceDetails.late})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Is,{className:"w-5 h-5 text-blue-600"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Excused"})]}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:j.attendanceDetails.excused})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Attendance Percentage"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-4",children:e.jsx("div",{className:"bg-blue-600 h-4 rounded-full",style:{width:`${j.attendanceDetails.percentage}%`}})}),e.jsxs("span",{className:"text-2xl font-bold text-blue-600",children:[j.attendanceDetails.percentage,"%"]})]})]})]}),(j.reportType==="behavior"||j.reportType==="comprehensive")&&j.behavior&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-blue-600",children:"Behavior & Conduct"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"border p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Conduct"}),e.jsx("p",{className:"text-lg font-semibold text-green-600",children:j.behavior.conduct})]}),e.jsxs("div",{className:"border p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Participation"}),e.jsx("p",{className:"text-lg font-semibold text-blue-600",children:j.behavior.participation})]}),e.jsxs("div",{className:"border p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Punctuality"}),e.jsx("p",{className:"text-lg font-semibold text-purple-600",children:j.behavior.punctuality})]}),e.jsxs("div",{className:"border p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Incidents"}),e.jsx("p",{className:"text-lg font-semibold text-red-600",children:j.behavior.incidents})]}),e.jsxs("div",{className:"border p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Commendations"}),e.jsx("p",{className:"text-lg font-semibold text-green-600",children:j.behavior.commendations})]})]})]}),j.teacherComments&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 text-blue-600 flex items-center gap-2",children:[e.jsx(wa,{className:"w-5 h-5"}),"Teacher's Comments"]}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border-l-4 border-blue-500",children:e.jsxs("p",{className:"text-gray-700 italic",children:['"',j.teacherComments,'"']})})]}),j.reportType==="comprehensive"&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 text-blue-600 flex items-center gap-2",children:[e.jsx(sl,{className:"w-5 h-5"}),"Summary & Recommendations"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-green-700 mb-2",children:"Strengths"}),e.jsxs("ul",{className:"text-sm text-gray-700 space-y-1",children:[(j.averageGrade||0)>=70&&e.jsx("li",{children:" Strong academic performance"}),(j.attendanceDetails?.percentage||0)>=90&&e.jsx("li",{children:" Excellent attendance record"}),j.completedHomework/(j.totalHomework||1)>=.8&&e.jsx("li",{children:" Consistent homework completion"}),j.behavior?.conduct==="Excellent"&&e.jsx("li",{children:" Outstanding conduct"})]})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-yellow-700 mb-2",children:"Areas for Improvement"}),e.jsxs("ul",{className:"text-sm text-gray-700 space-y-1",children:[(j.averageGrade||0)<70&&e.jsx("li",{children:" Focus on improving academic grades"}),(j.attendanceDetails?.percentage||0)<90&&e.jsx("li",{children:" Improve attendance consistency"}),j.completedHomework/(j.totalHomework||1)<.8&&e.jsx("li",{children:" Complete all homework assignments"}),j.attendanceDetails?.late>3&&e.jsx("li",{children:" Work on punctuality"})]})]})]})]}),e.jsx("div",{className:"mt-12 pt-6 border-t-2 border-gray-300",children:e.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Class Teacher"}),e.jsxs("div",{className:"border-t-2 border-gray-400 pt-2 mt-8",children:[e.jsxs("p",{className:"font-semibold",children:[s?.first_name," ",s?.last_name]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Signature"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Head Teacher"}),e.jsxs("div",{className:"border-t-2 border-gray-400 pt-2 mt-8",children:[e.jsx("p",{className:"font-semibold",children:"_____________________"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Signature"})]})]})]})}),e.jsxs("div",{className:"mt-8 flex justify-center gap-4 print:hidden",children:[e.jsx("button",{onClick:()=>E(!1),className:"btn bg-gray-600 hover:bg-gray-700 text-white flex items-center gap-2",children:"Back to Configuration"}),e.jsxs("button",{onClick:xe,className:"btn bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-2",children:[e.jsx(or,{className:"w-4 h-4"}),"Print Report"]}),e.jsxs("button",{onClick:Z,disabled:c,className:"btn bg-green-600 hover:bg-green-700 text-white flex items-center gap-2",children:[c?e.jsx(hs,{className:"w-4 h-4 animate-spin"}):e.jsx(xs,{className:"w-4 h-4"}),"Download Image"]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Ko,{className:"w-5 h-5 text-blue-600"}),"Report Configuration"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Class *"}),e.jsxs("select",{value:v,onChange:B=>{U(B.target.value),M("")},className:"input",children:[e.jsx("option",{value:"",children:"Choose a class"}),m.map(B=>e.jsx("option",{value:B.id,children:B.class_name},B.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Student *"}),e.jsxs("select",{value:D,onChange:B=>M(B.target.value),className:"input",disabled:!v,children:[e.jsx("option",{value:"",children:"Choose a student"}),x.map(B=>e.jsxs("option",{value:B.id,children:[B.first_name," ",B.last_name," (",B.student_id,")"]},B.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Report Type *"}),e.jsx("select",{value:K,onChange:B=>$(B.target.value),className:"input",children:ae.map(B=>e.jsx("option",{value:B.value,children:B.label},B.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date Range *"}),e.jsx("select",{value:P,onChange:B=>se(B.target.value),className:"input",children:k.map(B=>e.jsx("option",{value:B.value,children:B.label},B.value))})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(wa,{className:"w-4 h-4 inline mr-1"}),"Teacher Comments (optional)"]}),e.jsx("textarea",{value:te,onChange:B=>C(B.target.value),className:"input w-full",rows:"3",placeholder:"Add personalized comments for this student's report..."})]}),e.jsx("div",{className:"mt-6 flex justify-end gap-4",children:e.jsxs("button",{onClick:re,disabled:!v||!D||c,className:"btn btn-primary flex items-center gap-2",children:[c?e.jsx(hs,{className:"w-4 h-4 animate-spin"}):e.jsx(na,{className:"w-4 h-4"}),"Generate Report"]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:ae.map(B=>{const w=B.icon;return e.jsxs("div",{onClick:()=>$(B.value),className:`card p-6 cursor-pointer transition-all ${K===B.value?"border-2 border-blue-500 bg-blue-50":"hover:shadow-lg"}`,children:[e.jsx(w,{className:`w-8 h-8 mb-3 ${K===B.value?"text-blue-600":"text-gray-600"}`}),e.jsx("h3",{className:"font-semibold text-gray-900",children:B.label}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[B.value==="academic"&&"Grades, homework, and assessments",B.value==="attendance"&&"Attendance records and statistics",B.value==="behavior"&&"Conduct and participation",B.value==="comprehensive"&&"Complete student overview"]})]},B.value)})})]})]})}function q$(){const{user:t}=Us(),s=la(),[a,r]=h.useState(!0),[l,c]=h.useState(!1),[o,m]=h.useState("overview"),[u,x]=h.useState(null),[A,g]=h.useState(null),[N,f]=h.useState({performance:[],students:[],recommendations:[],predictions:[],alerts:[]}),[y,v]=h.useState({overallScore:0,classAverage:0,attendanceRate:0,homeworkCompletion:0,studentEngagement:0});h.useEffect(()=>{U()},[]);const U=async()=>{try{r(!0);const Q=(await F.get(`${ee}/teachers.php?user_id=${t?.id}`)).data.teachers||[];let E=t?.id;Q.length>0&&(g(Q[0]),E=Q[0].id);const te=await F.get(`${ee}/ai_insights.php?teacher_id=${E}`);te.data.success&&(f(te.data.insights||{performance:[],students:[],recommendations:[],predictions:[],alerts:[]}),v(te.data.stats||{overallScore:0,classAverage:0,attendanceRate:0,homeworkCompletion:0,studentEngagement:0}))}catch(T){console.error("Error fetching insights:",T),f({performance:[],students:[],recommendations:[],predictions:[],alerts:[]}),v({overallScore:0,classAverage:0,attendanceRate:0,homeworkCompletion:0,studentEngagement:0})}finally{r(!1)}},D=async()=>{c(!0),await U(),c(!1)},M=async(T,Q)=>{try{await F.post(`${ee}/ai_insights.php`,{action:"feedback",teacher_id:A?.id||t?.id,insight_id:T,is_positive:Q}),alert(Q?"Thanks for the positive feedback!":"Thanks for your feedback. We'll improve our insights.")}catch(E){console.error("Error sending feedback:",E)}},K=T=>{switch(T){case"Review Now":s("/teacher/grades");break;case"View Homework":s("/teacher/homework");break;case"Grade Now":s("/teacher/grades");break;case"Mark Attendance":s("/teacher/attendance");break;default:console.log("Action:",T)}},$=T=>{s(`/teacher/student-progress?student=${T}`)},P=T=>{f(Q=>({...Q,insights:{...Q.insights,recommendations:Q.insights?.recommendations?.filter(E=>E.id!==T)||[]}}))},se=T=>{switch(T.category){case"Teaching":s("/teacher/lesson-planning");break;case"Assessment":s("/teacher/grades");break;case"Engagement":s("/teacher/behavior-tracking");break;default:alert(`Recommendation "${T.title}" has been marked as applied. Check your dashboard for progress.`)}},z=T=>{switch(T){case"at_risk":return"text-red-600 bg-red-50";case"excelling":return"text-green-600 bg-green-50";case"improving":return"text-blue-600 bg-blue-50";default:return"text-gray-600 bg-gray-50"}},R=T=>{switch(T){case"high":return"bg-red-100 text-red-700";case"medium":return"bg-yellow-100 text-yellow-700";case"low":return"bg-green-100 text-green-700";default:return"bg-gray-100 text-gray-700"}},j=[{id:"overview",label:"Overview",icon:Gl},{id:"students",label:"Student Insights",icon:Rt},{id:"recommendations",label:"Recommendations",icon:Sm},{id:"predictions",label:"Predictions",icon:$s}];return a?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Jr,{className:"w-16 h-16 text-purple-600 mx-auto mb-4"}),e.jsx(cl,{className:"w-6 h-6 text-yellow-500 absolute -top-1 -right-1 animate-pulse"})]}),e.jsx(hs,{className:"w-8 h-8 text-purple-600 animate-spin mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600",children:"AI is analyzing your data..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Jr,{className:"text-purple-600"}),"AI Insights & Recommendations",e.jsx("span",{className:"text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded-full",children:"Beta"})]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Personalized insights powered by AI to improve teaching outcomes"})]}),e.jsxs("button",{onClick:D,disabled:l,className:"btn bg-purple-100 hover:bg-purple-200 text-purple-700 flex items-center gap-2",children:[e.jsx(Ns,{className:`w-4 h-4 ${l?"animate-spin":""}`}),l?"Refreshing...":"Refresh Insights"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"card p-4 text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-purple-600",children:[y.overallScore,"%"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Overall Score"}),e.jsxs("div",{className:"flex items-center justify-center gap-1 mt-1 text-green-600 text-xs",children:[e.jsx($s,{className:"w-3 h-3"})," +5% this month"]})]}),e.jsxs("div",{className:"card p-4 text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-blue-600",children:[y.classAverage,"%"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Class Average"}),e.jsxs("div",{className:"flex items-center justify-center gap-1 mt-1 text-green-600 text-xs",children:[e.jsx($s,{className:"w-3 h-3"})," +3% this term"]})]}),e.jsxs("div",{className:"card p-4 text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-green-600",children:[y.attendanceRate,"%"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Attendance Rate"}),e.jsxs("div",{className:"flex items-center justify-center gap-1 mt-1 text-gray-500 text-xs",children:[e.jsx("span",{children:""})," Stable"]})]}),e.jsxs("div",{className:"card p-4 text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-orange-600",children:[y.homeworkCompletion,"%"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Homework Done"}),e.jsxs("div",{className:"flex items-center justify-center gap-1 mt-1 text-red-600 text-xs",children:[e.jsx(gc,{className:"w-3 h-3"})," -2% this week"]})]}),e.jsxs("div",{className:"card p-4 text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-indigo-600",children:[y.studentEngagement,"%"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Engagement"}),e.jsxs("div",{className:"flex items-center justify-center gap-1 mt-1 text-green-600 text-xs",children:[e.jsx($s,{className:"w-3 h-3"})," +8% this month"]})]})]}),N.alerts.length>0&&e.jsx("div",{className:"space-y-2",children:N.alerts.map(T=>e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg ${T.type==="urgent"?"bg-red-50 border border-red-200":T.type==="warning"?"bg-yellow-50 border border-yellow-200":"bg-blue-50 border border-blue-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[T.type==="urgent"?e.jsx(ka,{className:"w-5 h-5 text-red-600"}):T.type==="warning"?e.jsx(_s,{className:"w-5 h-5 text-yellow-600"}):e.jsx(ka,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:T.title}),e.jsx("p",{className:"text-sm text-gray-600",children:T.description})]})]}),e.jsx("button",{onClick:()=>K(T.action),className:"btn btn-sm bg-white shadow-sm",children:T.action})]},T.id))}),e.jsx("div",{className:"card p-4",children:e.jsx("div",{className:"flex flex-wrap gap-2 border-b pb-4",children:j.map(T=>{const Q=T.icon;return e.jsxs("button",{onClick:()=>m(T.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${o===T.id?"bg-purple-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(Q,{className:"w-4 h-4"}),T.label]},T.id)})})}),o==="overview"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Fs,{className:"w-5 h-5 text-purple-600"}),"Performance Insights"]}),e.jsx("div",{className:"space-y-4",children:N.performance.map(T=>e.jsxs("div",{className:`p-4 rounded-lg border cursor-pointer transition-all ${u===T.id?"ring-2 ring-purple-300":""} ${T.type==="positive"?"bg-green-50 border-green-200":T.type==="warning"?"bg-yellow-50 border-yellow-200":"bg-gray-50 border-gray-200"}`,onClick:()=>x(u===T.id?null:T.id),children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[T.type==="positive"?e.jsx(Mt,{className:"w-5 h-5 text-green-600 mt-0.5"}):T.type==="warning"?e.jsx(_s,{className:"w-5 h-5 text-yellow-600 mt-0.5"}):e.jsx(Ln,{className:"w-5 h-5 text-gray-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:T.title}),e.jsx("p",{className:"text-sm text-gray-600",children:T.description})]})]}),e.jsx("span",{className:`text-lg font-bold ${T.type==="positive"?"text-green-600":T.type==="warning"?"text-red-600":"text-gray-600"}`,children:T.metric})]}),u===T.id&&e.jsxs("div",{className:"mt-4 pt-4 border-t",children:[e.jsx("p",{className:"text-sm text-gray-700 mb-3",children:T.details}),e.jsxs("div",{className:"flex items-center justify-between",children:[T.actionable&&e.jsxs("button",{className:"btn btn-sm btn-primary flex items-center gap-1",children:[T.action," ",e.jsx(Pl,{className:"w-3 h-3"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Was this helpful?"}),e.jsx("button",{onClick:Q=>{Q.stopPropagation(),M(T.id,!0)},className:"p-1 hover:bg-green-100 rounded",children:e.jsx(TA,{className:"w-4 h-4 text-gray-400 hover:text-green-600"})}),e.jsx("button",{onClick:Q=>{Q.stopPropagation(),M(T.id,!1)},className:"p-1 hover:bg-red-100 rounded",children:e.jsx(UA,{className:"w-4 h-4 text-gray-400 hover:text-red-600"})})]})]})]})]},T.id))})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Sm,{className:"w-5 h-5 text-yellow-500"}),"Top Recommendations"]}),e.jsxs("div",{className:"space-y-3",children:[N.recommendations.slice(0,3).map(T=>e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("span",{className:`text-xs px-2 py-1 rounded-full ${R(T.priority)}`,children:[T.priority," priority"]}),e.jsx("span",{className:"text-xs text-gray-500",children:T.timeframe})]}),e.jsx("p",{className:"font-medium",children:T.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:T.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-3 text-xs text-gray-500",children:[e.jsxs("span",{children:["Impact: ",e.jsx("strong",{children:T.impact})]}),e.jsxs("span",{children:["Effort: ",e.jsx("strong",{children:T.effort})]})]})]},T.id)),e.jsxs("button",{onClick:()=>m("recommendations"),className:"w-full btn bg-gray-100 hover:bg-gray-200 flex items-center justify-center gap-2",children:["View All Recommendations ",e.jsx(Pl,{className:"w-4 h-4"})]})]})]})]}),o==="students"&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Rt,{className:"w-5 h-5 text-blue-600"}),"Student Performance Insights"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-3 px-4",children:"Student"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Class"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Trend"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Reason"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Recommendation"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Action"})]})}),e.jsx("tbody",{children:N.students.map(T=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4 font-medium",children:T.name}),e.jsx("td",{className:"py-3 px-4 text-gray-600",children:T.class}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${z(T.status)}`,children:T.status.replace("_"," ")})}),e.jsx("td",{className:"py-3 px-4",children:T.trend==="up"?e.jsx($s,{className:"w-5 h-5 text-green-600"}):e.jsx(gc,{className:"w-5 h-5 text-red-600"})}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-600 max-w-xs",children:T.reason}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-600 max-w-xs",children:T.recommendation}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("button",{onClick:()=>$(T.id),className:"btn btn-sm bg-blue-100 text-blue-700 hover:bg-blue-200",children:"View Profile"})})]},T.id))})]})})]}),o==="recommendations"&&e.jsx("div",{className:"space-y-4",children:N.recommendations.map(T=>e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${T.category==="Teaching"?"bg-blue-100":T.category==="Assessment"?"bg-green-100":T.category==="Engagement"?"bg-purple-100":"bg-orange-100"}`,children:T.category==="Teaching"?e.jsx(as,{className:"w-5 h-5 text-blue-600"}):T.category==="Assessment"?e.jsx(Kt,{className:"w-5 h-5 text-green-600"}):T.category==="Engagement"?e.jsx(Xu,{className:"w-5 h-5 text-purple-600"}):e.jsx(wa,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:T.category}),e.jsx("h4",{className:"font-semibold",children:T.title})]})]}),e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm ${R(T.priority)}`,children:[T.priority," priority"]})]}),e.jsx("p",{className:"text-gray-600 mb-4",children:T.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Impact:"}),e.jsx("span",{className:"ml-1 font-medium",children:T.impact})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Effort:"}),e.jsx("span",{className:"ml-1 font-medium",children:T.effort})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Timeframe:"}),e.jsx("span",{className:"ml-1 font-medium",children:T.timeframe})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>P(T.id),className:"btn btn-sm bg-gray-100 hover:bg-gray-200",children:"Dismiss"}),e.jsx("button",{onClick:()=>se(T),className:"btn btn-sm btn-primary",children:"Apply"})]})]})]},T.id))}),o==="predictions"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:N.predictions.map(T=>e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-semibold",children:T.title}),T.trend==="up"?e.jsx($s,{className:"w-5 h-5 text-green-600"}):T.trend==="warning"?e.jsx(_s,{className:"w-5 h-5 text-yellow-600"}):e.jsx(gc,{className:"w-5 h-5 text-red-600"})]}),e.jsx("p",{className:"text-gray-600 mb-4",children:T.prediction}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-500",children:"Confidence"}),e.jsxs("span",{className:"font-medium",children:[T.confidence,"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${T.confidence>=80?"bg-green-500":T.confidence>=60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${T.confidence}%`}})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Key Factors:"}),e.jsx("ul",{className:"space-y-1",children:T.factors.map((Q,E)=>e.jsxs("li",{className:"text-sm text-gray-600 flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-purple-500 rounded-full"}),Q]},E))})]})]},T.id))}),e.jsx("div",{className:"card p-4 bg-purple-50 border border-purple-200",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(cl,{className:"w-5 h-5 text-purple-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-purple-900",children:"About AI Insights"}),e.jsx("p",{className:"text-sm text-purple-700",children:"These insights are generated using AI analysis of your teaching data. While we strive for accuracy, please use your professional judgment when making decisions. Feedback helps improve our recommendations."})]})]})})]})}function K$(){const{user:t}=Us(),[s,a]=h.useState(!0),[r,l]=h.useState("overview"),[c,o]=h.useState(!1),[m,u]=h.useState(!1),[x,A]=h.useState(null),[g,N]=h.useState(!1),[f,y]=h.useState(null),[v,U]=h.useState({annual:{total:21,used:5,pending:2},sick:{total:10,used:2,pending:0},personal:{total:3,used:1,pending:0},maternity:{total:90,used:0,pending:0},study:{total:5,used:0,pending:0}}),[D,M]=h.useState([]),[K,$]=h.useState([]),[P,se]=h.useState([]),[z,R]=h.useState([]),[j,T]=h.useState({leave_type:"annual",start_date:"",end_date:"",reason:"",contact_during_leave:"",handover_to:""}),[Q,E]=h.useState({document_type:"",purpose:"",copies:1,urgent:!1});h.useEffect(()=>{te()},[]);const te=async()=>{try{a(!0);const I=(await F.get(`${ee}/teachers.php?user_id=${t?.id}`)).data.teachers||[];let H=t?.id;I.length>0&&(A(I[0]),H=I[0].id);const ae=await F.get(`${ee}/hr.php?teacher_id=${H}`);ae.data.success&&(y(ae.data.profile||null),U(ae.data.leave_balance||{annual:{total:21,used:0,pending:0},sick:{total:10,used:0,pending:0},personal:{total:3,used:0,pending:0},maternity:{total:90,used:0,pending:0},study:{total:5,used:0,pending:0}}),M(ae.data.leave_requests||[]),$(ae.data.payslips||[]),se(ae.data.documents||[]),R(ae.data.announcements||[]))}catch(Z){console.error("Error fetching HR data:",Z),y(null),M([]),$([]),se([]),R([])}finally{a(!1)}},C=async Z=>{Z.preventDefault(),N(!0);try{const I=await F.post(`${ee}/hr.php`,{action:"submit_leave",teacher_id:x?.id||t?.id,...j});I.data.success?(await te(),o(!1),T({leave_type:"annual",start_date:"",end_date:"",reason:"",contact_during_leave:"",handover_to:""})):alert(I.data.error||"Failed to submit leave request")}catch(I){console.error("Error submitting leave:",I),alert("Failed to submit leave request. Please try again.")}finally{N(!1)}},O=async Z=>{Z.preventDefault(),N(!0);try{const I=await F.post(`${ee}/hr.php`,{action:"request_document",teacher_id:x?.id||t?.id,...Q});I.data.success?(await te(),u(!1),E({document_type:"",purpose:"",copies:1,urgent:!1})):alert(I.data.error||"Failed to submit document request")}catch(I){console.error("Error requesting document:",I),alert("Failed to submit document request. Please try again.")}finally{N(!1)}},V=(Z,I)=>{if(!Z||!I)return 0;const H=new Date(Z),ae=new Date(I),k=Math.abs(ae-H);return Math.ceil(k/(1e3*60*60*24))+1},re=Z=>{switch(Z){case"annual":return e.jsx(wN,{className:"w-4 h-4"});case"sick":return e.jsx(Oo,{className:"w-4 h-4"});case"maternity":return e.jsx(T1,{className:"w-4 h-4"});case"study":return e.jsx(Qs,{className:"w-4 h-4"});default:return e.jsx(Ot,{className:"w-4 h-4"})}},ge=Z=>{switch(Z){case"approved":return e.jsxs("span",{className:"flex items-center gap-1 text-green-700 bg-green-100 px-2 py-1 rounded-full text-xs",children:[e.jsx(Mt,{className:"w-3 h-3"})," Approved"]});case"pending":return e.jsxs("span",{className:"flex items-center gap-1 text-yellow-700 bg-yellow-100 px-2 py-1 rounded-full text-xs",children:[e.jsx(Wt,{className:"w-3 h-3"})," Pending"]});case"rejected":return e.jsxs("span",{className:"flex items-center gap-1 text-red-700 bg-red-100 px-2 py-1 rounded-full text-xs",children:[e.jsx(Js,{className:"w-3 h-3"})," Rejected"]});default:return e.jsx("span",{className:"text-gray-600 text-xs",children:Z})}},xe=[{id:"overview",label:"Overview",icon:Pr},{id:"leave",label:"Leave Management",icon:Ot},{id:"payroll",label:"Payroll",icon:vs},{id:"documents",label:"Documents",icon:Kt},{id:"profile",label:"HR Profile",icon:ha}];return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Pr,{className:"w-12 h-12 text-blue-600 mx-auto mb-4"}),e.jsx(hs,{className:"w-8 h-8 text-blue-600 animate-spin mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600",children:"Loading HR Portal..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Pr,{className:"text-blue-600"}),"HR Portal"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your leave, payroll, and HR documents"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>o(!0),className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4"}),"Request Leave"]}),e.jsxs("button",{onClick:()=>u(!0),className:"btn bg-gray-100 hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Kt,{className:"w-4 h-4"}),"Request Document"]})]})]}),z.length>0&&e.jsx("div",{className:"space-y-2",children:z.slice(0,2).map(Z=>e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg ${Z.priority==="high"?"bg-red-50 border border-red-200":Z.priority==="medium"?"bg-yellow-50 border border-yellow-200":"bg-blue-50 border border-blue-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(nl,{className:`w-5 h-5 ${Z.priority==="high"?"text-red-600":Z.priority==="medium"?"text-yellow-600":"text-blue-600"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:Z.title}),e.jsx("p",{className:"text-sm text-gray-600",children:Z.message})]})]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(Z.date).toLocaleDateString()})]},Z.id))}),e.jsx("div",{className:"card p-4",children:e.jsx("div",{className:"flex flex-wrap gap-2 border-b pb-4",children:xe.map(Z=>{const I=Z.icon;return e.jsxs("button",{onClick:()=>l(Z.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${r===Z.id?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(I,{className:"w-4 h-4"}),Z.label]},Z.id)})})}),r==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Annual Leave"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:v.annual.total-v.annual.used-v.annual.pending}),e.jsx("p",{className:"text-xs text-gray-500",children:"days remaining"})]}),e.jsx(wN,{className:"w-8 h-8 text-blue-200"})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Sick Leave"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:v.sick.total-v.sick.used}),e.jsx("p",{className:"text-xs text-gray-500",children:"days remaining"})]}),e.jsx(Oo,{className:"w-8 h-8 text-green-200"})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pending Requests"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:D.filter(Z=>Z.status==="pending").length}),e.jsx("p",{className:"text-xs text-gray-500",children:"awaiting approval"})]}),e.jsx(Wt,{className:"w-8 h-8 text-yellow-200"})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Next Payroll"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:"Dec 23"}),e.jsx("p",{className:"text-xs text-gray-500",children:"15 days away"})]}),e.jsx(vs,{className:"w-8 h-8 text-purple-200"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Ot,{className:"w-5 h-5 text-blue-600"}),"Recent Leave Requests"]}),e.jsxs("button",{onClick:()=>l("leave"),className:"text-blue-600 text-sm hover:underline flex items-center gap-1",children:["View All ",e.jsx(cr,{className:"w-4 h-4"})]})]}),e.jsx("div",{className:"space-y-3",children:D.slice(0,3).map(Z=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:re(Z.type)}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium capitalize",children:[Z.type," Leave"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[new Date(Z.start_date).toLocaleDateString()," - ",new Date(Z.end_date).toLocaleDateString()]})]})]}),ge(Z.status)]},Z.id))})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(vs,{className:"w-5 h-5 text-green-600"}),"Recent Payslips"]}),e.jsxs("button",{onClick:()=>l("payroll"),className:"text-blue-600 text-sm hover:underline flex items-center gap-1",children:["View All ",e.jsx(cr,{className:"w-4 h-4"})]})]}),e.jsx("div",{className:"space-y-3",children:K.slice(0,3).map(Z=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:Z.month}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Paid on ",new Date(Z.date).toLocaleDateString()]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold text-green-600",children:["GH ",Z.net.toLocaleString()]}),e.jsxs("button",{className:"text-blue-600 text-xs hover:underline flex items-center gap-1",children:[e.jsx(xs,{className:"w-3 h-3"})," Download"]})]})]},Z.id))})]})]})]}),r==="leave"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:Object.entries(v).map(([Z,I])=>e.jsxs("div",{className:"card p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[re(Z),e.jsx("span",{className:"font-medium capitalize",children:Z})]}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-2xl font-bold",children:I.total-I.used-I.pending}),e.jsxs("span",{className:"text-gray-500 text-sm",children:["/",I.total]})]}),I.pending>0&&e.jsxs("span",{className:"text-xs text-yellow-600 bg-yellow-100 px-2 py-1 rounded",children:[I.pending," pending"]})]}),e.jsx("div",{className:"mt-2 h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500",style:{width:`${(I.total-I.used-I.pending)/I.total*100}%`}})})]},Z))}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Leave History"}),e.jsxs("button",{onClick:()=>o(!0),className:"btn btn-primary btn-sm flex items-center gap-1",children:[e.jsx(qt,{className:"w-4 h-4"})," New Request"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-3 px-4",children:"Type"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Period"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Days"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Reason"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Approved By"})]})}),e.jsx("tbody",{children:D.map(Z=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[re(Z.type),e.jsx("span",{className:"capitalize",children:Z.type})]})}),e.jsxs("td",{className:"py-3 px-4 text-sm",children:[new Date(Z.start_date).toLocaleDateString()," - ",new Date(Z.end_date).toLocaleDateString()]}),e.jsx("td",{className:"py-3 px-4",children:Z.days}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-600 max-w-xs truncate",children:Z.reason}),e.jsx("td",{className:"py-3 px-4",children:ge(Z.status)}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:Z.approved_by||"-"})]},Z.id))})]})})]})]}),r==="payroll"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Current Month Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Gross Salary"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:"GH 4,500.00"})]}),e.jsxs("div",{className:"p-4 bg-red-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Deductions"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:"GH 675.00"})]}),e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Net Salary"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:"GH 3,825.00"})]}),e.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"YTD Earnings"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:"GH 45,900.00"})]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Deductions Breakdown"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"SSNIT (5.5%)"}),e.jsx("p",{className:"font-bold",children:"GH 247.50"})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Income Tax"}),e.jsx("p",{className:"font-bold",children:"GH 337.50"})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Health Insurance"}),e.jsx("p",{className:"font-bold",children:"GH 90.00"})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Other"}),e.jsx("p",{className:"font-bold",children:"GH 0.00"})]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Payslip History"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-3 px-4",children:"Month"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Gross"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Deductions"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Net"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4",children:"Action"})]})}),e.jsx("tbody",{children:K.map(Z=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4 font-medium",children:Z.month}),e.jsxs("td",{className:"py-3 px-4",children:["GH ",Z.gross.toLocaleString()]}),e.jsxs("td",{className:"py-3 px-4 text-red-600",children:["-GH ",Z.deductions.toLocaleString()]}),e.jsxs("td",{className:"py-3 px-4 font-bold text-green-600",children:["GH ",Z.net.toLocaleString()]}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"text-green-700 bg-green-100 px-2 py-1 rounded-full text-xs",children:Z.status})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("button",{className:"btn btn-sm bg-blue-100 text-blue-700 hover:bg-blue-200 flex items-center gap-1",children:[e.jsx(xs,{className:"w-3 h-3"})," Download"]})})]},Z.id))})]})})]})]}),r==="documents"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"My Documents"}),e.jsxs("button",{onClick:()=>u(!0),className:"btn btn-primary btn-sm flex items-center gap-1",children:[e.jsx(qt,{className:"w-4 h-4"})," Request Document"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:P.map(Z=>e.jsxs("div",{className:"card p-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Kt,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:Z.name}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(Z.date).toLocaleDateString()}),Z.expires&&e.jsxs("p",{className:"text-xs text-orange-600",children:["Expires: ",new Date(Z.expires).toLocaleDateString()]})]})]}),Z.status==="available"?e.jsx(Mt,{className:"w-5 h-5 text-green-500"}):e.jsx(Wt,{className:"w-5 h-5 text-yellow-500"})]}),e.jsx("div",{className:"flex items-center gap-2 mt-4",children:Z.status==="available"?e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"btn btn-sm bg-gray-100 hover:bg-gray-200 flex-1 flex items-center justify-center gap-1",children:[e.jsx(na,{className:"w-3 h-3"})," View"]}),e.jsxs("button",{className:"btn btn-sm bg-blue-100 text-blue-700 hover:bg-blue-200 flex-1 flex items-center justify-center gap-1",children:[e.jsx(xs,{className:"w-3 h-3"})," Download"]})]}):e.jsxs("span",{className:"text-sm text-yellow-600 flex items-center gap-1",children:[e.jsx(hs,{className:"w-3 h-3 animate-spin"})," Processing..."]})})]},Z.id))})]}),r==="profile"&&f&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(mn,{className:"w-5 h-5 text-blue-600"}),"Employment Details"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Employee ID"}),e.jsx("span",{className:"font-medium",children:f.employee_id})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Department"}),e.jsx("span",{className:"font-medium",children:f.department})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Position"}),e.jsx("span",{className:"font-medium",children:f.position})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Join Date"}),e.jsx("span",{className:"font-medium",children:new Date(f.join_date).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Contract Type"}),e.jsx("span",{className:"font-medium",children:f.contract_type})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Reporting To"}),e.jsx("span",{className:"font-medium",children:f.reporting_to})]}),e.jsxs("div",{className:"flex justify-between py-2",children:[e.jsx("span",{className:"text-gray-600",children:"Work Location"}),e.jsx("span",{className:"font-medium",children:f.work_location})]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(aa,{className:"w-5 h-5 text-green-600"}),"Financial Details"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Bank Name"}),e.jsx("span",{className:"font-medium",children:f.bank_name})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Account Number"}),e.jsx("span",{className:"font-medium",children:f.bank_account})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"SSNIT Number"}),e.jsx("span",{className:"font-medium",children:f.ssnit_number})]}),e.jsxs("div",{className:"flex justify-between py-2",children:[e.jsx("span",{className:"text-gray-600",children:"TIN Number"}),e.jsx("span",{className:"font-medium",children:f.tin_number})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-yellow-50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-700",children:[e.jsx(ka,{className:"w-4 h-4 inline mr-1"}),"To update financial details, please contact HR department."]})})]})]}),c&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(Ot,{className:"text-blue-600"}),"Request Leave"]})}),e.jsxs("form",{onSubmit:C,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Leave Type *"}),e.jsxs("select",{value:j.leave_type,onChange:Z=>T({...j,leave_type:Z.target.value}),className:"input",required:!0,children:[e.jsxs("option",{value:"annual",children:["Annual Leave (",v.annual.total-v.annual.used," days available)"]}),e.jsxs("option",{value:"sick",children:["Sick Leave (",v.sick.total-v.sick.used," days available)"]}),e.jsxs("option",{value:"personal",children:["Personal Leave (",v.personal.total-v.personal.used," days available)"]}),e.jsxs("option",{value:"study",children:["Study Leave (",v.study.total-v.study.used," days available)"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Start Date *"}),e.jsx("input",{type:"date",value:j.start_date,onChange:Z=>T({...j,start_date:Z.target.value}),className:"input",required:!0,min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"End Date *"}),e.jsx("input",{type:"date",value:j.end_date,onChange:Z=>T({...j,end_date:Z.target.value}),className:"input",required:!0,min:j.start_date||new Date().toISOString().split("T")[0]})]})]}),j.start_date&&j.end_date&&e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg text-sm",children:[e.jsx("strong",{children:V(j.start_date,j.end_date)})," day(s) requested"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Reason *"}),e.jsx("textarea",{value:j.reason,onChange:Z=>T({...j,reason:Z.target.value}),className:"input",rows:"3",required:!0,placeholder:"Please provide a reason for your leave request"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Contact During Leave"}),e.jsx("input",{type:"text",value:j.contact_during_leave,onChange:Z=>T({...j,contact_during_leave:Z.target.value}),className:"input",placeholder:"Phone number or email"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Handover To"}),e.jsx("input",{type:"text",value:j.handover_to,onChange:Z=>T({...j,handover_to:Z.target.value}),className:"input",placeholder:"Colleague who will cover your duties"})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>o(!1),className:"btn bg-gray-200 hover:bg-gray-300 flex-1",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:g,className:"btn btn-primary flex-1 flex items-center justify-center gap-2",children:[g?e.jsx(hs,{className:"w-4 h-4 animate-spin"}):e.jsx(va,{className:"w-4 h-4"}),g?"Submitting...":"Submit Request"]})]})]})]})}),m&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(Kt,{className:"text-blue-600"}),"Request Document"]})}),e.jsxs("form",{onSubmit:O,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Document Type *"}),e.jsxs("select",{value:Q.document_type,onChange:Z=>E({...Q,document_type:Z.target.value}),className:"input",required:!0,children:[e.jsx("option",{value:"",children:"Select document type"}),e.jsx("option",{value:"employment_letter",children:"Employment Confirmation Letter"}),e.jsx("option",{value:"salary_letter",children:"Salary Confirmation Letter"}),e.jsx("option",{value:"introduction_letter",children:"Introduction Letter"}),e.jsx("option",{value:"experience_letter",children:"Experience Certificate"}),e.jsx("option",{value:"tax_certificate",children:"Tax Certificate"}),e.jsx("option",{value:"ssnit_statement",children:"SSNIT Statement"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Purpose *"}),e.jsx("textarea",{value:Q.purpose,onChange:Z=>E({...Q,purpose:Z.target.value}),className:"input",rows:"2",required:!0,placeholder:"Why do you need this document?"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Number of Copies"}),e.jsx("input",{type:"number",value:Q.copies,onChange:Z=>E({...Q,copies:parseInt(Z.target.value)}),className:"input",min:"1",max:"5"})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer mt-6",children:[e.jsx("input",{type:"checkbox",checked:Q.urgent,onChange:Z=>E({...Q,urgent:Z.target.checked}),className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Urgent Request"})]})})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>u(!1),className:"btn bg-gray-200 hover:bg-gray-300 flex-1",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:g,className:"btn btn-primary flex-1 flex items-center justify-center gap-2",children:[g?e.jsx(hs,{className:"w-4 h-4 animate-spin"}):e.jsx(va,{className:"w-4 h-4"}),g?"Submitting...":"Submit Request"]})]})]})]})})]})}function V$(){la();const{user:t}=Us(),[s,a]=h.useState(!0),[r,l]=h.useState([]),[c,o]=h.useState([]),[m,u]=h.useState([]),[x,A]=h.useState(null),[g,N]=h.useState(!1),[f,y]=h.useState(null),[v,U]=h.useState(null),[D,M]=h.useState(""),[K,$]=h.useState(""),[P,se]=h.useState(""),[z,R]=h.useState(""),[j,T]=h.useState({class_id:"",subject_id:"",title:"",description:"",objectives:"",materials:"",activities:"",assessment:"",homework:"",notes:"",duration_minutes:45,lesson_date:"",status:"draft",resources:[]}),[Q,E]=h.useState({resource_type:"link",title:"",url:"",description:""});h.useEffect(()=>{te()},[]);const te=async()=>{try{a(!0);const B=(await F.get(`${ee}/teachers.php?user_id=${t?.id}`)).data.teachers||[];if(B.length>0){A(B[0].id);const[w,oe,ne]=await Promise.all([F.get(`${ee}/teacher_subjects.php?teacher_id=${B[0].id}`),F.get(`${ee}/subjects.php`),F.get(`${ee}/lesson_plans.php?teacher_id=${B[0].id}`)]),je=(w.data.teacher_classes||[]).map(Ge=>({id:Ge.class_id,class_name:Ge.class_name}));o(je),u(oe.data.subjects||[]),l(ne.data.lesson_plans||[])}}catch(k){console.error("Error fetching data:",k)}finally{a(!1)}},C=()=>{y(null),T({class_id:"",subject_id:"",title:"",description:"",objectives:"",materials:"",activities:"",assessment:"",homework:"",notes:"",duration_minutes:45,lesson_date:new Date().toISOString().split("T")[0],status:"draft",resources:[]}),N(!0)},O=k=>{y(k),T({class_id:k.class_id,subject_id:k.subject_id,title:k.title,description:k.description||"",objectives:k.objectives||"",materials:k.materials||"",activities:k.activities||"",assessment:k.assessment||"",homework:k.homework||"",notes:k.notes||"",duration_minutes:k.duration_minutes||45,lesson_date:k.lesson_date||"",status:k.status||"draft",resources:k.resources||[]}),N(!0)},V=async k=>{try{const B=await F.get(`${ee}/lesson_plans.php?id=${k.id}`);U(B.data.lesson_plan)}catch(B){console.error("Error fetching plan details:",B)}},re=async k=>{k.preventDefault();try{const B={...j,teacher_id:x};f?await F.put(`${ee}/lesson_plans.php?id=${f.id}`,B):await F.post(`${ee}/lesson_plans.php`,B),N(!1),te()}catch(B){console.error("Error saving lesson plan:",B),alert("Failed to save lesson plan")}},ge=async k=>{if(window.confirm("Are you sure you want to delete this lesson plan?"))try{await F.delete(`${ee}/lesson_plans.php?id=${k}`),te()}catch(B){console.error("Error deleting lesson plan:",B)}},xe=k=>{y(null),T({...k,title:`${k.title} (Copy)`,lesson_date:new Date().toISOString().split("T")[0],status:"draft",resources:k.resources||[]}),N(!0)},Z=()=>{Q.title&&(T({...j,resources:[...j.resources,{...Q}]}),E({resource_type:"link",title:"",url:"",description:""}))},I=k=>{T({...j,resources:j.resources.filter((B,w)=>w!==k)})},H=r.filter(k=>!(D&&k.class_id!=D||K&&k.subject_id!=K||P&&k.status!==P||z&&!k.title.toLowerCase().includes(z.toLowerCase()))),ae=k=>{switch(k){case"published":return e.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-green-100 text-green-700",children:"Published"});case"completed":return e.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-700",children:"Completed"});default:return e.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-700",children:"Draft"})}};return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(hs,{className:"w-8 h-8 animate-spin text-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Lesson Planning"}),e.jsx("p",{className:"text-gray-600",children:"Create and manage your lesson plans"})]}),e.jsxs("button",{onClick:C,className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4"})," New Lesson Plan"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(as,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:r.length}),e.jsx("p",{className:"text-xs text-gray-500",children:"Total Plans"})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(Mt,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:r.filter(k=>k.status==="published").length}),e.jsx("p",{className:"text-xs text-gray-500",children:"Published"})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(Kt,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:r.filter(k=>k.status==="draft").length}),e.jsx("p",{className:"text-xs text-gray-500",children:"Drafts"})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(Ot,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:r.filter(k=>k.lesson_date===new Date().toISOString().split("T")[0]).length}),e.jsx("p",{className:"text-xs text-gray-500",children:"Today"})]})]})})]}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search lesson plans...",value:z,onChange:k=>R(k.target.value),className:"input pl-10 w-full"})]}),e.jsxs("select",{value:D,onChange:k=>M(k.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Classes"}),c.map(k=>e.jsx("option",{value:k.id,children:k.class_name},k.id))]}),e.jsxs("select",{value:K,onChange:k=>$(k.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Subjects"}),m.map(k=>e.jsx("option",{value:k.id,children:k.subject_name},k.id))]}),e.jsxs("select",{value:P,onChange:k=>se(k.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"published",children:"Published"}),e.jsx("option",{value:"completed",children:"Completed"})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:H.length===0?e.jsxs("div",{className:"col-span-full card p-12 text-center",children:[e.jsx(as,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No lesson plans found"}),e.jsx("button",{onClick:C,className:"btn btn-primary mt-4",children:"Create Your First Plan"})]}):H.map(k=>e.jsxs("div",{className:"card p-4 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 line-clamp-1",children:k.title}),e.jsxs("p",{className:"text-sm text-gray-500",children:[k.class_name,"  ",k.subject_name]})]}),ae(k.status)]}),k.description&&e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-3",children:k.description}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500 mb-4",children:[k.lesson_date&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ot,{className:"w-3 h-3"}),new Date(k.lesson_date).toLocaleDateString()]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Wt,{className:"w-3 h-3"}),k.duration_minutes," min"]}),k.resource_count>0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Hd,{className:"w-3 h-3"}),k.resource_count," resources"]})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-3 border-t",children:[e.jsxs("button",{onClick:()=>V(k),className:"btn btn-sm bg-gray-100 hover:bg-gray-200 flex-1",children:[e.jsx(na,{className:"w-3 h-3 mr-1"})," View"]}),e.jsx("button",{onClick:()=>O(k),className:"btn btn-sm bg-blue-100 text-blue-700 hover:bg-blue-200",children:e.jsx(Na,{className:"w-3 h-3"})}),e.jsx("button",{onClick:()=>xe(k),className:"btn btn-sm bg-green-100 text-green-700 hover:bg-green-200",children:e.jsx(vl,{className:"w-3 h-3"})}),e.jsx("button",{onClick:()=>ge(k.id),className:"btn btn-sm bg-red-100 text-red-700 hover:bg-red-200",children:e.jsx(us,{className:"w-3 h-3"})})]})]},k.id))}),g&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b sticky top-0 bg-white flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:f?"Edit Lesson Plan":"New Lesson Plan"}),e.jsx("button",{onClick:()=>N(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:re,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Title *"}),e.jsx("input",{type:"text",required:!0,value:j.title,onChange:k=>T({...j,title:k.target.value}),className:"input",placeholder:"e.g., Introduction to Fractions"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Class *"}),e.jsxs("select",{required:!0,value:j.class_id,onChange:k=>T({...j,class_id:k.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select Class"}),c.map(k=>e.jsx("option",{value:k.id,children:k.class_name},k.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Subject *"}),e.jsxs("select",{required:!0,value:j.subject_id,onChange:k=>T({...j,subject_id:k.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select Subject"}),m.map(k=>e.jsx("option",{value:k.id,children:k.subject_name},k.id))]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Date"}),e.jsx("input",{type:"date",value:j.lesson_date,onChange:k=>T({...j,lesson_date:k.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Duration (minutes)"}),e.jsx("input",{type:"number",value:j.duration_minutes,onChange:k=>T({...j,duration_minutes:k.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Status"}),e.jsxs("select",{value:j.status,onChange:k=>T({...j,status:k.target.value}),className:"input",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"published",children:"Published"}),e.jsx("option",{value:"completed",children:"Completed"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description"}),e.jsx("textarea",{value:j.description,onChange:k=>T({...j,description:k.target.value}),className:"input",rows:"2",placeholder:"Brief overview of the lesson"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Learning Objectives"}),e.jsx("textarea",{value:j.objectives,onChange:k=>T({...j,objectives:k.target.value}),className:"input",rows:"3",placeholder:"What students will learn (one per line)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Materials Needed"}),e.jsx("textarea",{value:j.materials,onChange:k=>T({...j,materials:k.target.value}),className:"input",rows:"2",placeholder:"List of materials and resources needed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Activities"}),e.jsx("textarea",{value:j.activities,onChange:k=>T({...j,activities:k.target.value}),className:"input",rows:"4",placeholder:"Step-by-step activities for the lesson"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Assessment"}),e.jsx("textarea",{value:j.assessment,onChange:k=>T({...j,assessment:k.target.value}),className:"input",rows:"3",placeholder:"How will you assess understanding?"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Homework"}),e.jsx("textarea",{value:j.homework,onChange:k=>T({...j,homework:k.target.value}),className:"input",rows:"3",placeholder:"Homework assignment for students"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Teacher Notes"}),e.jsx("textarea",{value:j.notes,onChange:k=>T({...j,notes:k.target.value}),className:"input",rows:"2",placeholder:"Private notes for yourself"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Resources"}),e.jsx("div",{className:"space-y-2 mb-3",children:j.resources.map((k,B)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded",children:[k.resource_type==="video"?e.jsx(al,{className:"w-4 h-4 text-red-500"}):k.resource_type==="document"?e.jsx(Iu,{className:"w-4 h-4 text-blue-500"}):e.jsx(Hd,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{className:"flex-1 text-sm",children:k.title}),e.jsx("button",{type:"button",onClick:()=>I(B),className:"text-red-500",children:e.jsx(Nt,{className:"w-4 h-4"})})]},B))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:Q.resource_type,onChange:k=>E({...Q,resource_type:k.target.value}),className:"input w-auto",children:[e.jsx("option",{value:"link",children:"Link"}),e.jsx("option",{value:"video",children:"Video"}),e.jsx("option",{value:"document",children:"Document"})]}),e.jsx("input",{type:"text",placeholder:"Resource title",value:Q.title,onChange:k=>E({...Q,title:k.target.value}),className:"input flex-1"}),e.jsx("input",{type:"text",placeholder:"URL",value:Q.url,onChange:k=>E({...Q,url:k.target.value}),className:"input flex-1"}),e.jsx("button",{type:"button",onClick:Z,className:"btn bg-gray-200 hover:bg-gray-300",children:e.jsx(qt,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>N(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-primary flex items-center gap-2",children:[e.jsx(Br,{className:"w-4 h-4"})," ",f?"Update":"Create"," Plan"]})]})]})]})}),v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b sticky top-0 bg-white flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:v.title}),e.jsxs("p",{className:"text-sm text-gray-500",children:[v.class_name,"  ",v.subject_name]})]}),e.jsx("button",{onClick:()=>U(null),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[v.lesson_date&&e.jsxs("span",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx(Ot,{className:"w-4 h-4"}),new Date(v.lesson_date).toLocaleDateString()]}),e.jsxs("span",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx(Wt,{className:"w-4 h-4"}),v.duration_minutes," minutes"]}),ae(v.status)]}),v.description&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Description"}),e.jsx("p",{className:"text-gray-600",children:v.description})]}),v.objectives&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[e.jsx(Ln,{className:"w-4 h-4 text-blue-600"})," Learning Objectives"]}),e.jsx("div",{className:"bg-blue-50 p-4 rounded-lg whitespace-pre-line text-gray-700",children:v.objectives})]}),v.materials&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Materials Needed"}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg whitespace-pre-line text-gray-700",children:v.materials})]}),v.activities&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Activities"}),e.jsx("div",{className:"bg-green-50 p-4 rounded-lg whitespace-pre-line text-gray-700",children:v.activities})]}),v.assessment&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Assessment"}),e.jsx("div",{className:"bg-purple-50 p-4 rounded-lg whitespace-pre-line text-gray-700",children:v.assessment})]}),v.homework&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Homework"}),e.jsx("div",{className:"bg-orange-50 p-4 rounded-lg whitespace-pre-line text-gray-700",children:v.homework})]}),v.resources&&v.resources.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Resources"}),e.jsx("div",{className:"space-y-2",children:v.resources.map((k,B)=>e.jsxs("a",{href:k.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 bg-gray-50 rounded-lg hover:bg-gray-100",children:[k.resource_type==="video"?e.jsx(al,{className:"w-4 h-4 text-red-500"}):k.resource_type==="document"?e.jsx(Iu,{className:"w-4 h-4 text-blue-500"}):e.jsx(Hd,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{className:"flex-1",children:k.title}),e.jsx(cr,{className:"w-4 h-4 text-gray-400"})]},B))})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsxs("button",{onClick:()=>O(v),className:"btn bg-blue-100 text-blue-700 hover:bg-blue-200",children:[e.jsx(Na,{className:"w-4 h-4 mr-2"})," Edit"]}),e.jsx("button",{onClick:()=>U(null),className:"btn bg-gray-200 hover:bg-gray-300",children:"Close"})]})]})]})})]})}function Y$(){const{user:t}=Us(),[s,a]=h.useState(!0),[r,l]=h.useState(null),[c,o]=h.useState([]),[m,u]=h.useState([]),[x,A]=h.useState(""),[g,N]=h.useState(null),[f,y]=h.useState(null),[v,U]=h.useState(""),[D,M]=h.useState(!1),[K,$]=h.useState(!1),[P,se]=h.useState(null),[z,R]=h.useState({goal_type:"academic",title:"",description:"",target_value:"",target_date:""}),[j,T]=h.useState({note_type:"progress",title:"",content:"",is_private:1});h.useEffect(()=>{Q()},[]),h.useEffect(()=>{x&&E()},[x]),h.useEffect(()=>{g&&te()},[g]);const Q=async()=>{try{a(!0);const B=(await F.get(`${ee}/teachers.php?user_id=${t?.id}`)).data.teachers||[];if(B.length>0){l(B[0].id);const ne=((await F.get(`${ee}/teacher_subjects.php?teacher_id=${B[0].id}`)).data.teacher_classes||[]).map(Fe=>({id:Fe.class_id,class_name:Fe.class_name}));o(ne),ne.length>0&&A(ne[0].id)}}catch(k){console.error("Error:",k)}finally{a(!1)}},E=async()=>{try{const k=await F.get(`${ee}/student_progress.php?resource=class_overview&class_id=${x}`);u(k.data.students||[])}catch(k){console.error("Error fetching students:",k)}},te=async()=>{try{const k=await F.get(`${ee}/student_progress.php?resource=overview&student_id=${g.id}&teacher_id=${r}`);y(k.data)}catch(k){console.error("Error fetching progress:",k)}},C=()=>{se(null),R({goal_type:"academic",title:"",description:"",target_value:"",target_date:""}),M(!0)},O=k=>{se(k),R({goal_type:k.goal_type,title:k.title,description:k.description||"",target_value:k.target_value||"",target_date:k.target_date||""}),M(!0)},V=async k=>{k.preventDefault();try{const B={resource:"goal",student_id:g.id,teacher_id:r,...z};P?await F.put(`${ee}/student_progress.php?id=${P.id}`,B):await F.post(`${ee}/student_progress.php`,B),M(!1),te()}catch(B){console.error("Error saving goal:",B),alert("Failed to save goal")}},re=async k=>{if(window.confirm("Delete this goal?"))try{await F.delete(`${ee}/student_progress.php?id=${k}&resource=goal`),te()}catch(B){console.error("Error:",B)}},ge=async(k,B)=>{try{await F.put(`${ee}/student_progress.php?id=${k.id}`,{resource:"goal",status:B}),te()}catch(w){console.error("Error:",w)}},xe=()=>{T({note_type:"progress",title:"",content:"",is_private:1}),$(!0)},Z=async k=>{k.preventDefault();try{await F.post(`${ee}/student_progress.php`,{resource:"note",student_id:g.id,teacher_id:r,...j}),$(!1),te()}catch(B){console.error("Error saving note:",B),alert("Failed to save note")}},I=m.filter(k=>`${k.first_name} ${k.last_name}`.toLowerCase().includes(v.toLowerCase())),H=k=>!k.total_days||k.total_days===0?"N/A":Math.round(k.present_days/k.total_days*100)+"%",ae=k=>{if(!k||k==="N/A")return"text-gray-500";const B=parseFloat(k);return B>=70?"text-green-600":B>=50?"text-yellow-600":"text-red-600"};return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(hs,{className:"w-8 h-8 animate-spin text-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Progress Tracking"}),e.jsx("p",{className:"text-gray-600",children:"Monitor individual student progress and set goals"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"p-4 border-b",children:[e.jsx("select",{value:x,onChange:k=>A(k.target.value),className:"input w-full mb-3",children:c.map(k=>e.jsx("option",{value:k.id,children:k.class_name},k.id))}),e.jsxs("div",{className:"relative",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search students...",value:v,onChange:k=>U(k.target.value),className:"input pl-10 w-full"})]})]}),e.jsx("div",{className:"max-h-[600px] overflow-y-auto",children:I.map(k=>e.jsxs("button",{onClick:()=>N(k),className:`w-full p-4 text-left border-b hover:bg-gray-50 transition-colors ${g?.id===k.id?"bg-blue-50 border-l-4 border-l-blue-500":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900",children:[k.first_name," ",k.last_name]}),e.jsx("p",{className:"text-xs text-gray-500",children:k.admission_number})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:`text-sm font-medium ${ae(k.avg_grade)}`,children:k.avg_grade?`${Math.round(k.avg_grade)}%`:"N/A"}),e.jsxs("p",{className:"text-xs text-gray-500",children:[H(k)," att."]})]})]}),k.active_goals>0&&e.jsxs("div",{className:"mt-2 flex items-center gap-1 text-xs text-blue-600",children:[e.jsx(Ln,{className:"w-3 h-3"}),k.active_goals," active goal",k.active_goals>1?"s":""]})]},k.id))})]}),e.jsx("div",{className:"lg:col-span-2 space-y-6",children:g&&f?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:[f.student?.first_name," ",f.student?.last_name]}),e.jsx("p",{className:"text-gray-500",children:f.student?.class_name})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:C,className:"btn btn-primary btn-sm",children:[e.jsx(Ln,{className:"w-4 h-4 mr-1"})," Add Goal"]}),e.jsxs("button",{onClick:xe,className:"btn bg-green-600 text-white hover:bg-green-700 btn-sm",children:[e.jsx(Kt,{className:"w-4 h-4 mr-1"})," Add Note"]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mt-6",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-700",children:[f.grades_by_subject?.length>0?Math.round(f.grades_by_subject.reduce((k,B)=>k+(parseFloat(B.average)||0),0)/f.grades_by_subject.length):"N/A",f.grades_by_subject?.length>0&&"%"]}),e.jsx("p",{className:"text-xs text-gray-600",children:"Avg Grade"})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-3 text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-green-700",children:[f.attendance?.total_days>0?Math.round(f.attendance.present/f.attendance.total_days*100):"N/A",f.attendance?.total_days>0&&"%"]}),e.jsx("p",{className:"text-xs text-gray-600",children:"Attendance"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-purple-700",children:f.active_goals?.length||0}),e.jsx("p",{className:"text-xs text-gray-600",children:"Active Goals"})]}),e.jsxs("div",{className:"bg-orange-50 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-orange-700",children:f.progress_notes?.length||0}),e.jsx("p",{className:"text-xs text-gray-600",children:"Notes"})]})]})]}),f.grades_by_subject?.length>0&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(Fs,{className:"w-5 h-5 text-blue-600"})," Performance by Subject"]}),e.jsx("div",{className:"space-y-3",children:f.grades_by_subject.map((k,B)=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"w-32 text-sm text-gray-600 truncate",children:k.subject_name}),e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full ${parseFloat(k.average)>=70?"bg-green-500":parseFloat(k.average)>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(100,k.average||0)}%`}})}),e.jsx("span",{className:`w-16 text-right text-sm font-medium ${ae(k.average)}`,children:k.average?`${Math.round(k.average)}%`:"N/A"})]},B))})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(Ln,{className:"w-5 h-5 text-purple-600"})," Active Goals"]}),f.active_goals?.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Ln,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"No active goals set"}),e.jsx("button",{onClick:C,className:"btn btn-primary btn-sm mt-3",children:"Set First Goal"})]}):e.jsx("div",{className:"space-y-3",children:f.active_goals.map(k=>e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full ${k.goal_type==="academic"?"bg-blue-100 text-blue-700":k.goal_type==="behavior"?"bg-green-100 text-green-700":k.goal_type==="attendance"?"bg-orange-100 text-orange-700":"bg-purple-100 text-purple-700"}`,children:k.goal_type}),e.jsx("h4",{className:"font-medium text-gray-900",children:k.title})]}),k.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:k.description}),k.target_date&&e.jsxs("p",{className:"text-xs text-gray-500 mt-2 flex items-center gap-1",children:[e.jsx(Ot,{className:"w-3 h-3"}),"Target: ",new Date(k.target_date).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>ge(k,"achieved"),className:"p-1 text-green-600 hover:bg-green-100 rounded",title:"Mark as achieved",children:e.jsx(Mt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>O(k),className:"p-1 text-blue-600 hover:bg-blue-100 rounded",children:e.jsx(Na,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>re(k.id),className:"p-1 text-red-600 hover:bg-red-100 rounded",children:e.jsx(us,{className:"w-4 h-4"})})]})]}),k.target_value&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[k.current_value||0," / ",k.target_value]})]}),e.jsx("div",{className:"bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-purple-500 h-2 rounded-full",style:{width:`${Math.min(100,(k.current_value||0)/k.target_value*100)}%`}})})]})]},k.id))})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(Kt,{className:"w-5 h-5 text-green-600"})," Progress Notes"]}),f.progress_notes?.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Kt,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"No notes yet"})]}):e.jsx("div",{className:"space-y-3",children:f.progress_notes.map(k=>e.jsx("div",{className:`p-4 rounded-lg border-l-4 ${k.note_type==="achievement"?"bg-green-50 border-green-500":k.note_type==="concern"?"bg-red-50 border-red-500":k.note_type==="observation"?"bg-yellow-50 border-yellow-500":"bg-blue-50 border-blue-500"}`,children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{children:[k.title&&e.jsx("h4",{className:"font-medium text-gray-900",children:k.title}),e.jsx("p",{className:"text-sm text-gray-700 mt-1",children:k.content}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[k.teacher_name,"  ",new Date(k.created_at).toLocaleDateString(),k.is_private==1&&e.jsx("span",{className:"ml-2 text-orange-600",children:"(Private)"})]})]})})},k.id))})]})]}):e.jsxs("div",{className:"card p-12 text-center",children:[e.jsx(Rt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Select a Student"}),e.jsx("p",{className:"text-gray-500",children:"Choose a student from the list to view their progress"})]})})]}),D&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:P?"Edit Goal":"Add Goal"}),e.jsx("button",{onClick:()=>M(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:V,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Goal Type"}),e.jsxs("select",{value:z.goal_type,onChange:k=>R({...z,goal_type:k.target.value}),className:"input",children:[e.jsx("option",{value:"academic",children:"Academic"}),e.jsx("option",{value:"behavior",children:"Behavior"}),e.jsx("option",{value:"attendance",children:"Attendance"}),e.jsx("option",{value:"skill",children:"Skill"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Title *"}),e.jsx("input",{type:"text",required:!0,value:z.title,onChange:k=>R({...z,title:k.target.value}),className:"input",placeholder:"e.g., Improve Math grade to 80%"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description"}),e.jsx("textarea",{value:z.description,onChange:k=>R({...z,description:k.target.value}),className:"input",rows:"2"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Target Value"}),e.jsx("input",{type:"number",value:z.target_value,onChange:k=>R({...z,target_value:k.target.value}),className:"input",placeholder:"e.g., 80"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Target Date"}),e.jsx("input",{type:"date",value:z.target_date,onChange:k=>R({...z,target_date:k.target.value}),className:"input"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>M(!1),className:"btn bg-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save Goal"})]})]})]})}),K&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Add Progress Note"}),e.jsx("button",{onClick:()=>$(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:Z,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Note Type"}),e.jsxs("select",{value:j.note_type,onChange:k=>T({...j,note_type:k.target.value}),className:"input",children:[e.jsx("option",{value:"progress",children:"Progress Update"}),e.jsx("option",{value:"achievement",children:"Achievement"}),e.jsx("option",{value:"concern",children:"Concern"}),e.jsx("option",{value:"observation",children:"Observation"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Title"}),e.jsx("input",{type:"text",value:j.title,onChange:k=>T({...j,title:k.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Content *"}),e.jsx("textarea",{required:!0,value:j.content,onChange:k=>T({...j,content:k.target.value}),className:"input",rows:"4"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"is_private",checked:j.is_private==1,onChange:k=>T({...j,is_private:k.target.checked?1:0})}),e.jsx("label",{htmlFor:"is_private",className:"text-sm",children:"Private note (only visible to you)"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>$(!1),className:"btn bg-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save Note"})]})]})]})})]})}function W$(){const{user:t}=Us(),[s,a]=h.useState(!0),[r,l]=h.useState(null),[c,o]=h.useState([]),[m,u]=h.useState([]),[x,A]=h.useState([]),[g,N]=h.useState([]),[f,y]=h.useState([]),[v,U]=h.useState(""),[D,M]=h.useState(null),[K,$]=h.useState(null),[P,se]=h.useState("records"),[z,R]=h.useState(!1),[j,T]=h.useState(!1),[Q,E]=h.useState(null),[te,C]=h.useState({behavior_type:"positive",category:"",description:"",points:5,incident_date:new Date().toISOString().split("T")[0]}),[O,V]=h.useState({badge_name:"",badge_icon:"star",badge_color:"gold",description:""}),re=[{value:"star",icon:sl,label:"Star"},{value:"trophy",icon:JA,label:"Trophy"},{value:"medal",icon:Uk,label:"Medal"},{value:"award",icon:Is,label:"Award"},{value:"heart",icon:Oo,label:"Heart"},{value:"zap",icon:Xu,label:"Lightning"}],ge=["gold","silver","bronze","blue","green","purple","red"];h.useEffect(()=>{xe()},[]),h.useEffect(()=>{v&&Z()},[v]),h.useEffect(()=>{D&&I()},[D]);const xe=async()=>{try{a(!0);const Fe=(await F.get(`${ee}/teachers.php?user_id=${t?.id}`)).data.teachers||[];if(Fe.length>0){l(Fe[0].id);const[je,Ge]=await Promise.all([F.get(`${ee}/teacher_subjects.php?teacher_id=${Fe[0].id}`),F.get(`${ee}/behavior_tracking.php?resource=categories`)]),Xe=(je.data.teacher_classes||[]).map(st=>({id:st.class_id,class_name:st.class_name}));o(Xe),A(Ge.data.categories||[]),Xe.length>0&&U(Xe[0].id)}}catch(ne){console.error("Error:",ne)}finally{a(!1)}},Z=async()=>{try{const[ne,Fe,je]=await Promise.all([F.get(`${ee}/students.php?class_id=${v}`),F.get(`${ee}/behavior_tracking.php?resource=records&class_id=${v}`),F.get(`${ee}/behavior_tracking.php?resource=leaderboard&class_id=${v}`)]);u(ne.data.students||[]),N(Fe.data.records||[]),y(je.data.leaderboard||[])}catch(ne){console.error("Error:",ne)}},I=async()=>{try{const ne=await F.get(`${ee}/behavior_tracking.php?resource=summary&student_id=${D.id}`);$(ne.data)}catch(ne){console.error("Error:",ne)}},H=(ne=null,Fe="positive")=>{E(null),M(ne);const je=x.find(Ge=>Ge.type===Fe);C({behavior_type:Fe,category:je?.name||"",description:"",points:je?.default_points||(Fe==="positive"?5:-5),incident_date:new Date().toISOString().split("T")[0]}),R(!0)},ae=async ne=>{ne.preventDefault();try{const Fe={resource:"record",student_id:D.id,teacher_id:r,class_id:v,...te};Q?await F.put(`${ee}/behavior_tracking.php?id=${Q.id}`,Fe):await F.post(`${ee}/behavior_tracking.php`,Fe),R(!1),Z(),D&&I()}catch(Fe){console.error("Error:",Fe),alert("Failed to save record")}},k=async ne=>{if(window.confirm("Delete this behavior record?"))try{await F.delete(`${ee}/behavior_tracking.php?id=${ne}&resource=record`),Z()}catch(Fe){console.error("Error:",Fe)}},B=ne=>{M(ne),V({badge_name:"",badge_icon:"star",badge_color:"gold",description:""}),T(!0)},w=async ne=>{ne.preventDefault();try{await F.post(`${ee}/behavior_tracking.php`,{resource:"badge",student_id:D.id,awarded_by:r,...O}),T(!1),Z(),D&&I()}catch(Fe){console.error("Error:",Fe),alert("Failed to award badge")}},oe=ne=>{C({...te,category:ne.name,behavior_type:ne.type,points:ne.default_points})};return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(hs,{className:"w-8 h-8 animate-spin text-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Behavior Tracking"}),e.jsx("p",{className:"text-gray-600",children:"Track behaviors, award points and badges"})]}),e.jsx("select",{value:v,onChange:ne=>U(ne.target.value),className:"input w-auto",children:c.map(ne=>e.jsx("option",{value:ne.id,children:ne.class_name},ne.id))})]}),e.jsxs("div",{className:"flex gap-2 border-b",children:[e.jsx("button",{onClick:()=>se("records"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${P==="records"?"border-blue-600 text-blue-600":"border-transparent text-gray-500"}`,children:"Recent Records"}),e.jsx("button",{onClick:()=>se("leaderboard"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${P==="leaderboard"?"border-blue-600 text-blue-600":"border-transparent text-gray-500"}`,children:"Leaderboard"}),e.jsx("button",{onClick:()=>se("students"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${P==="students"?"border-blue-600 text-blue-600":"border-transparent text-gray-500"}`,children:"Quick Add"})]}),P==="records"&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"p-4 border-b flex items-center justify-between",children:e.jsx("h3",{className:"font-semibold",children:"Recent Behavior Records"})}),e.jsx("div",{className:"divide-y max-h-[500px] overflow-y-auto",children:g.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(_s,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"No behavior records yet"})]}):g.map(ne=>e.jsxs("div",{className:"p-4 flex items-start gap-4 hover:bg-gray-50",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${ne.behavior_type==="positive"?"bg-green-100":"bg-red-100"}`,children:ne.behavior_type==="positive"?e.jsx(TA,{className:"w-5 h-5 text-green-600"}):e.jsx(UA,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:ne.student_name}),e.jsxs("span",{className:`px-2 py-0.5 text-xs rounded-full ${ne.points>=0?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[ne.points>=0?"+":"",ne.points," pts"]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:ne.description}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[ne.category,"  ",new Date(ne.incident_date).toLocaleDateString(),"  ",ne.teacher_name]})]}),e.jsx("button",{onClick:()=>k(ne.id),className:"p-1 text-red-500 hover:bg-red-50 rounded",children:e.jsx(us,{className:"w-4 h-4"})})]},ne.id))})]}),P==="leaderboard"&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(JA,{className:"w-5 h-5 text-yellow-500"})," Points Leaderboard"]})}),e.jsx("div",{className:"divide-y",children:f.map((ne,Fe)=>e.jsxs("div",{className:"p-4 flex items-center gap-4",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold ${Fe===0?"bg-yellow-100 text-yellow-700":Fe===1?"bg-gray-200 text-gray-700":Fe===2?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-600"}`,children:Fe+1}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-medium text-gray-900",children:[ne.first_name," ",ne.last_name]}),e.jsx("div",{className:"flex items-center gap-2 mt-1",children:ne.badge_count>0&&e.jsxs("span",{className:"text-xs text-purple-600 flex items-center gap-1",children:[e.jsx(Is,{className:"w-3 h-3"})," ",ne.badge_count," badges"]})})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`text-xl font-bold ${ne.total_points>=0?"text-green-600":"text-red-600"}`,children:[ne.total_points>=0?"+":"",ne.total_points]}),e.jsx("p",{className:"text-xs text-gray-500",children:"points"})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>H(ne,"positive"),className:"p-2 bg-green-100 text-green-600 rounded-lg hover:bg-green-200",title:"Add positive",children:e.jsx(TA,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>H(ne,"negative"),className:"p-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200",title:"Add negative",children:e.jsx(UA,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>B(ne),className:"p-2 bg-purple-100 text-purple-600 rounded-lg hover:bg-purple-200",title:"Award badge",children:e.jsx(Is,{className:"w-4 h-4"})})]})]},ne.id))})]}),P==="students"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m.map(ne=>e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900",children:[ne.first_name," ",ne.last_name]}),e.jsx("p",{className:"text-xs text-gray-500",children:ne.admission_number})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>H(ne,"positive"),className:"flex-1 btn bg-green-100 text-green-700 hover:bg-green-200 btn-sm",children:[e.jsx(TA,{className:"w-4 h-4 mr-1"})," Positive"]}),e.jsxs("button",{onClick:()=>H(ne,"negative"),className:"flex-1 btn bg-red-100 text-red-700 hover:bg-red-200 btn-sm",children:[e.jsx(UA,{className:"w-4 h-4 mr-1"})," Negative"]})]})]},ne.id))}),z&&D&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:te.behavior_type==="positive"?"Add Positive Behavior":"Add Negative Behavior"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[D.first_name," ",D.last_name]})]}),e.jsx("button",{onClick:()=>R(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:ae,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Quick Select"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:x.filter(ne=>ne.type===te.behavior_type).map(ne=>e.jsxs("button",{type:"button",onClick:()=>oe(ne),className:`px-3 py-1 text-sm rounded-full border transition-colors ${te.category===ne.name?te.behavior_type==="positive"?"bg-green-100 border-green-500 text-green-700":"bg-red-100 border-red-500 text-red-700":"bg-gray-50 border-gray-200 hover:bg-gray-100"}`,children:[ne.name," (",ne.default_points>=0?"+":"",ne.default_points,")"]},ne.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description *"}),e.jsx("textarea",{required:!0,value:te.description,onChange:ne=>C({...te,description:ne.target.value}),className:"input",rows:"3",placeholder:"Describe the behavior..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Points"}),e.jsx("input",{type:"number",value:te.points,onChange:ne=>C({...te,points:parseInt(ne.target.value)}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Date"}),e.jsx("input",{type:"date",value:te.incident_date,onChange:ne=>C({...te,incident_date:ne.target.value}),className:"input"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>R(!1),className:"btn bg-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",className:`btn ${te.behavior_type==="positive"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"} text-white`,children:"Save Record"})]})]})]})}),j&&D&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Award Badge"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[D.first_name," ",D.last_name]})]}),e.jsx("button",{onClick:()=>T(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:w,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Badge Name *"}),e.jsx("input",{type:"text",required:!0,value:O.badge_name,onChange:ne=>V({...O,badge_name:ne.target.value}),className:"input",placeholder:"e.g., Star Student, Math Whiz"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Icon"}),e.jsx("div",{className:"flex gap-2",children:re.map(ne=>{const Fe=ne.icon;return e.jsx("button",{type:"button",onClick:()=>V({...O,badge_icon:ne.value}),className:`p-3 rounded-lg border-2 transition-colors ${O.badge_icon===ne.value?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:e.jsx(Fe,{className:"w-6 h-6"})},ne.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Color"}),e.jsx("div",{className:"flex gap-2",children:ge.map(ne=>e.jsx("button",{type:"button",onClick:()=>V({...O,badge_color:ne}),className:`w-8 h-8 rounded-full border-2 ${O.badge_color===ne?"border-gray-900":"border-transparent"}`,style:{backgroundColor:ne==="gold"?"#FFD700":ne==="silver"?"#C0C0C0":ne==="bronze"?"#CD7F32":ne}},ne))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description"}),e.jsx("textarea",{value:O.description,onChange:ne=>V({...O,description:ne.target.value}),className:"input",rows:"2",placeholder:"Why is this badge being awarded?"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>T(!1),className:"btn bg-gray-200",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn bg-purple-600 hover:bg-purple-700 text-white",children:[e.jsx(Is,{className:"w-4 h-4 mr-2"})," Award Badge"]})]})]})]})})]})}function X$(){const{user:t}=Us(),[s,a]=h.useState(!0),[r,l]=h.useState(null),[c,o]=h.useState([]),[m,u]=h.useState([]),[x,A]=h.useState([]),[g,N]=h.useState(null),[f,y]=h.useState(null),[v,U]=h.useState(""),[D,M]=h.useState(""),[K,$]=h.useState(""),[P,se]=h.useState("grid"),[z,R]=h.useState(!1),[j,T]=h.useState(!1),[Q,E]=h.useState(!1),[te,C]=h.useState(null),[O,V]=h.useState(null),[re,ge]=h.useState({title:"",description:"",resource_type:"link",url:"",subject_id:"",tags:"",is_shared:0}),[xe,Z]=h.useState({name:"",color:"#3B82F6"}),I=[{value:"document",label:"Document",icon:Kt,color:"text-blue-600 bg-blue-100"},{value:"video",label:"Video",icon:al,color:"text-red-600 bg-red-100"},{value:"link",label:"Link",icon:Hd,color:"text-green-600 bg-green-100"},{value:"image",label:"Image",icon:hy,color:"text-purple-600 bg-purple-100"},{value:"presentation",label:"Presentation",icon:Iu,color:"text-orange-600 bg-orange-100"},{value:"worksheet",label:"Worksheet",icon:Kt,color:"text-teal-600 bg-teal-100"}],H=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#6B7280"];h.useEffect(()=>{ae()},[]),h.useEffect(()=>{r&&k()},[r,f,z]);const ae=async()=>{try{a(!0);const _e=(await F.get(`${ee}/teachers.php?user_id=${t?.id}`)).data.teachers||[];if(_e.length>0){l(_e[0].id);const[le,Pe,we]=await Promise.all([F.get(`${ee}/resource_library.php?resource=folders&teacher_id=${_e[0].id}`),F.get(`${ee}/subjects.php`),F.get(`${ee}/resource_library.php?resource=stats&teacher_id=${_e[0].id}`)]);u(le.data.folders||[]),A(Pe.data.subjects||[]),N(we.data)}}catch(ce){console.error("Error:",ce)}finally{a(!1)}},k=async()=>{try{let ce=`${ee}/resource_library.php?resource=list&teacher_id=${r}`;f&&(ce+=`&folder_id=${f}`),z&&(ce+="&shared=1");const _e=await F.get(ce);o(_e.data.resources||[])}catch(ce){console.error("Error:",ce)}},B=()=>{C(null),ge({title:"",description:"",resource_type:"link",url:"",subject_id:"",tags:"",is_shared:0}),T(!0)},w=ce=>{C(ce),ge({title:ce.title,description:ce.description||"",resource_type:ce.resource_type,url:ce.url||"",subject_id:ce.subject_id||"",tags:ce.tags||"",is_shared:ce.is_shared}),T(!0)},oe=async ce=>{ce.preventDefault();try{const _e={resource:"item",teacher_id:r,folder_id:f,...re};te?await F.put(`${ee}/resource_library.php?id=${te.id}`,_e):await F.post(`${ee}/resource_library.php`,_e),T(!1),k(),ae()}catch(_e){console.error("Error:",_e),alert("Failed to save resource")}},ne=async ce=>{if(window.confirm("Delete this resource?"))try{await F.delete(`${ee}/resource_library.php?id=${ce}&resource=item`),k(),ae()}catch(_e){console.error("Error:",_e)}},Fe=()=>{V(null),Z({name:"",color:"#3B82F6"}),E(!0)},je=async ce=>{ce.preventDefault();try{const _e={resource:"folder",teacher_id:r,...xe};O?await F.put(`${ee}/resource_library.php?id=${O.id}`,_e):await F.post(`${ee}/resource_library.php`,_e),E(!1),ae()}catch(_e){console.error("Error:",_e),alert("Failed to save folder")}},Ge=async ce=>{if(window.confirm("Delete this folder? Resources will be moved out."))try{await F.delete(`${ee}/resource_library.php?id=${ce}&resource=folder`),f===ce&&y(null),ae(),k()}catch(_e){console.error("Error:",_e)}},ze=ce=>{const _e=I.find(le=>le.value===ce);return _e?_e.icon:Iu},Xe=ce=>{const _e=I.find(le=>le.value===ce);return _e?_e.color:"text-gray-600 bg-gray-100"},st=c.filter(ce=>!(v&&!ce.title.toLowerCase().includes(v.toLowerCase())||D&&ce.resource_type!==D||K&&ce.subject_id!=K));return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(hs,{className:"w-8 h-8 animate-spin text-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Resource Library"}),e.jsx("p",{className:"text-gray-600",children:"Organize and share teaching materials"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:Fe,className:"btn bg-gray-200 hover:bg-gray-300",children:[e.jsx(jN,{className:"w-4 h-4 mr-2"})," New Folder"]}),e.jsxs("button",{onClick:B,className:"btn btn-primary",children:[e.jsx(qt,{className:"w-4 h-4 mr-2"})," Add Resource"]})]})]}),g&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Iu,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:g.total_resources||0}),e.jsx("p",{className:"text-xs text-gray-500",children:"Total Resources"})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(xs,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:g.total_downloads||0}),e.jsx("p",{className:"text-xs text-gray-500",children:"Downloads"})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(yN,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:m.length}),e.jsx("p",{className:"text-xs text-gray-500",children:"Folders"})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx($o,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:c.filter(ce=>ce.is_shared).length}),e.jsx("p",{className:"text-xs text-gray-500",children:"Shared"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"card p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Folders"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>{y(null),R(!1)},className:`w-full flex items-center gap-2 p-2 rounded-lg text-left ${!f&&!z?"bg-blue-100 text-blue-700":"hover:bg-gray-100"}`,children:[e.jsx(yN,{className:"w-4 h-4"}),e.jsx("span",{children:"All Resources"})]}),e.jsxs("button",{onClick:()=>{y(null),R(!0)},className:`w-full flex items-center gap-2 p-2 rounded-lg text-left ${z?"bg-blue-100 text-blue-700":"hover:bg-gray-100"}`,children:[e.jsx($o,{className:"w-4 h-4"}),e.jsx("span",{children:"Shared Resources"})]}),e.jsx("hr",{className:"my-2"}),m.map(ce=>e.jsxs("div",{className:"group flex items-center",children:[e.jsxs("button",{onClick:()=>{y(ce.id),R(!1)},className:`flex-1 flex items-center gap-2 p-2 rounded-lg text-left ${f===ce.id?"bg-blue-100 text-blue-700":"hover:bg-gray-100"}`,children:[e.jsx(jN,{className:"w-4 h-4",style:{color:ce.color}}),e.jsx("span",{className:"truncate",children:ce.name})]}),e.jsx("button",{onClick:()=>Ge(ce.id),className:"p-1 text-red-500 opacity-0 group-hover:opacity-100 hover:bg-red-50 rounded",children:e.jsx(us,{className:"w-3 h-3"})})]},ce.id))]})]}),e.jsxs("div",{className:"lg:col-span-3 space-y-4",children:[e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search resources...",value:v,onChange:ce=>U(ce.target.value),className:"input pl-10 w-full"})]}),e.jsxs("select",{value:D,onChange:ce=>M(ce.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Types"}),I.map(ce=>e.jsx("option",{value:ce.value,children:ce.label},ce.value))]}),e.jsxs("select",{value:K,onChange:ce=>$(ce.target.value),className:"input w-auto",children:[e.jsx("option",{value:"",children:"All Subjects"}),x.map(ce=>e.jsx("option",{value:ce.id,children:ce.subject_name},ce.id))]}),e.jsxs("div",{className:"flex gap-1 border rounded-lg p-1",children:[e.jsx("button",{onClick:()=>se("grid"),className:`p-2 rounded ${P==="grid"?"bg-gray-200":""}`,children:e.jsx(cb,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>se("list"),className:`p-2 rounded ${P==="list"?"bg-gray-200":""}`,children:e.jsx(Ay,{className:"w-4 h-4"})})]})]})}),st.length===0?e.jsxs("div",{className:"card p-12 text-center",children:[e.jsx(Iu,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No resources found"}),e.jsx("button",{onClick:B,className:"btn btn-primary mt-4",children:"Add Your First Resource"})]}):P==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:st.map(ce=>{const _e=ze(ce.resource_type);return e.jsxs("div",{className:"card p-4 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${Xe(ce.resource_type)}`,children:e.jsx(_e,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-gray-900 truncate",children:ce.title}),e.jsx("p",{className:"text-xs text-gray-500",children:ce.subject_name||"No subject"})]}),ce.is_shared==1&&e.jsx($o,{className:"w-4 h-4 text-blue-500"})]}),ce.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-2 line-clamp-2",children:ce.description}),e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-3 border-t",children:[e.jsxs("span",{className:"text-xs text-gray-400",children:[ce.download_count||0," downloads"]}),e.jsxs("div",{className:"flex gap-1",children:[ce.url&&e.jsx("a",{href:ce.url,target:"_blank",rel:"noopener noreferrer",className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:e.jsx(vh,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>w(ce),className:"p-1 text-gray-600 hover:bg-gray-100 rounded",children:e.jsx(Na,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ne(ce.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:e.jsx(us,{className:"w-4 h-4"})})]})]})]},ce.id)})}):e.jsx("div",{className:"card divide-y",children:st.map(ce=>{const _e=ze(ce.resource_type);return e.jsxs("div",{className:"p-4 flex items-center gap-4 hover:bg-gray-50",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${Xe(ce.resource_type)}`,children:e.jsx(_e,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:ce.title}),e.jsxs("p",{className:"text-sm text-gray-500",children:[ce.subject_name||"No subject","  ",ce.download_count||0," downloads"]})]}),ce.is_shared==1&&e.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded-full",children:"Shared"}),e.jsxs("div",{className:"flex gap-1",children:[ce.url&&e.jsx("a",{href:ce.url,target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm bg-gray-100",children:e.jsx(vh,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>w(ce),className:"btn btn-sm bg-gray-100",children:e.jsx(Na,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ne(ce.id),className:"btn btn-sm bg-red-100 text-red-600",children:e.jsx(us,{className:"w-4 h-4"})})]})]},ce.id)})})]})]}),j&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:te?"Edit Resource":"Add Resource"}),e.jsx("button",{onClick:()=>T(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:oe,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Title *"}),e.jsx("input",{type:"text",required:!0,value:re.title,onChange:ce=>ge({...re,title:ce.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Type"}),e.jsx("select",{value:re.resource_type,onChange:ce=>ge({...re,resource_type:ce.target.value}),className:"input",children:I.map(ce=>e.jsx("option",{value:ce.value,children:ce.label},ce.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"URL"}),e.jsx("input",{type:"url",value:re.url,onChange:ce=>ge({...re,url:ce.target.value}),className:"input",placeholder:"https://..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Subject"}),e.jsxs("select",{value:re.subject_id,onChange:ce=>ge({...re,subject_id:ce.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"No subject"}),x.map(ce=>e.jsx("option",{value:ce.id,children:ce.subject_name},ce.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description"}),e.jsx("textarea",{value:re.description,onChange:ce=>ge({...re,description:ce.target.value}),className:"input",rows:"2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Tags (comma separated)"}),e.jsx("input",{type:"text",value:re.tags,onChange:ce=>ge({...re,tags:ce.target.value}),className:"input",placeholder:"math, fractions, grade5"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"is_shared",checked:re.is_shared==1,onChange:ce=>ge({...re,is_shared:ce.target.checked?1:0})}),e.jsx("label",{htmlFor:"is_shared",className:"text-sm",children:"Share with other teachers"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>T(!1),className:"btn bg-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save Resource"})]})]})]})}),Q&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-sm w-full",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:O?"Edit Folder":"New Folder"}),e.jsx("button",{onClick:()=>E(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:je,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Folder Name *"}),e.jsx("input",{type:"text",required:!0,value:xe.name,onChange:ce=>Z({...xe,name:ce.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Color"}),e.jsx("div",{className:"flex gap-2",children:H.map(ce=>e.jsx("button",{type:"button",onClick:()=>Z({...xe,color:ce}),className:`w-8 h-8 rounded-full border-2 ${xe.color===ce?"border-gray-900":"border-transparent"}`,style:{backgroundColor:ce}},ce))})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>E(!1),className:"btn bg-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save Folder"})]})]})]})})]})}function J$(){const{user:t}=Us(),[s,a]=h.useState(!0),[r,l]=h.useState(null),[c,o]=h.useState([]),[m,u]=h.useState([]),[x,A]=h.useState(""),[g,N]=h.useState(null),[f,y]=h.useState(null),[v,U]=h.useState(!1),[D,M]=h.useState(null),[K,$]=h.useState(null),[P,se]=h.useState({name:"Default Layout",layout_type:"grid",rows:5,columns:6,room_name:""});h.useEffect(()=>{z()},[]),h.useEffect(()=>{x&&R()},[x]),h.useEffect(()=>{g&&j()},[g]);const z=async()=>{try{a(!0);const H=(await F.get(`${ee}/teachers.php?user_id=${t?.id}`)).data.teachers||[];if(H.length>0){l(H[0].id);const B=((await F.get(`${ee}/teacher_subjects.php?teacher_id=${H[0].id}`)).data.teacher_classes||[]).map(w=>({id:w.class_id,class_name:w.class_name}));o(B),B.length>0&&A(B[0].id)}}catch(I){console.error("Error:",I)}finally{a(!1)}},R=async()=>{try{const I=await F.get(`${ee}/seating_chart.php?class_id=${x}`);u(I.data.charts||[]);const H=I.data.charts?.find(ae=>ae.is_active)||I.data.charts?.[0];H?N(H.id):(N(null),y(null))}catch(I){console.error("Error:",I)}},j=async()=>{try{const I=await F.get(`${ee}/seating_chart.php?id=${g}`);y(I.data.chart)}catch(I){console.error("Error:",I)}},T=()=>{M(null),se({name:"Default Layout",layout_type:"grid",rows:5,columns:6,room_name:""}),U(!0)},Q=async I=>{I.preventDefault();try{const H={action:"create_chart",class_id:x,teacher_id:r,...P};D?await F.put(`${ee}/seating_chart.php?id=${D.id}`,P):await F.post(`${ee}/seating_chart.php`,H),U(!1),R()}catch(H){console.error("Error:",H),alert("Failed to save chart")}},E=async I=>{if(window.confirm("Delete this seating chart?"))try{await F.delete(`${ee}/seating_chart.php?id=${I}`),R()}catch(H){console.error("Error:",H)}},te=I=>{$(I)},C=async(I,H)=>{if(!(!K||!g))try{await F.post(`${ee}/seating_chart.php`,{action:"assign_seat",chart_id:g,student_id:K.id,row_num:I,col_num:H}),$(null),j()}catch(ae){console.error("Error:",ae)}},O=async I=>{try{await F.post(`${ee}/seating_chart.php`,{action:"remove_assignment",chart_id:g,student_id:I}),j()}catch(H){console.error("Error:",H)}},V=async()=>{if(g)try{await F.post(`${ee}/seating_chart.php`,{action:"auto_assign",chart_id:g}),j()}catch(I){console.error("Error:",I)}},re=async()=>{if(g&&window.confirm("Shuffle all seats? This will randomly rearrange all students."))try{await F.post(`${ee}/seating_chart.php`,{action:"shuffle",chart_id:g}),j()}catch(I){console.error("Error:",I)}},ge=()=>{window.print()},xe=(I,H)=>f?.assignments?.find(ae=>ae.row_num==I&&ae.col_num==H),Z=()=>{if(!f)return null;const I=[];for(let H=1;H<=f.rows;H++){const ae=[];for(let k=1;k<=f.columns;k++){const B=xe(H,k);ae.push(e.jsx("div",{className:`w-20 h-20 border-2 rounded-lg flex flex-col items-center justify-center text-center cursor-pointer transition-all ${B?"bg-blue-50 border-blue-300 hover:bg-blue-100":"bg-gray-50 border-dashed border-gray-300 hover:bg-gray-100 hover:border-gray-400"}`,onDragOver:w=>w.preventDefault(),onDrop:()=>C(H,k),children:B?e.jsxs("div",{className:"relative group w-full h-full flex flex-col items-center justify-center p-1",children:[e.jsxs("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs font-bold mb-1",children:[B.first_name?.[0],B.last_name?.[0]]}),e.jsx("p",{className:"text-xs font-medium text-gray-900 truncate w-full px-1",children:B.first_name}),e.jsx("button",{onClick:()=>O(B.student_id),className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e.jsx(Nt,{className:"w-3 h-3"})})]}):e.jsxs("div",{className:"text-gray-400",children:[e.jsx(ha,{className:"w-6 h-6 mx-auto"}),e.jsxs("p",{className:"text-xs",children:[H,"-",k]})]})},`${H}-${k}`))}I.push(e.jsx("div",{className:"flex gap-2 justify-center",children:ae},H))}return I};return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(hs,{className:"w-8 h-8 animate-spin text-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Seating Chart"}),e.jsx("p",{className:"text-gray-600",children:"Arrange student seating in your classroom"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("select",{value:x,onChange:I=>A(I.target.value),className:"input w-auto",children:c.map(I=>e.jsx("option",{value:I.id,children:I.class_name},I.id))}),e.jsxs("button",{onClick:T,className:"btn btn-primary",children:[e.jsx(qt,{className:"w-4 h-4 mr-2"})," New Chart"]})]})]}),m.length>0&&e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:m.map(I=>e.jsxs("button",{onClick:()=>N(I.id),className:`px-4 py-2 rounded-lg border whitespace-nowrap transition-colors ${g===I.id?"bg-blue-100 border-blue-500 text-blue-700":"bg-white border-gray-200 hover:bg-gray-50"}`,children:[e.jsx("span",{className:"font-medium",children:I.name}),e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:[I.assigned_count,"/",I.total_students," assigned"]})]},I.id))}),f?e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"card p-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(Rt,{className:"w-5 h-5"})," Unassigned Students"]}),e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Drag students to seats"}),e.jsx("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:f.unassigned_students?.length===0?e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"All students assigned!"}):f.unassigned_students?.map(I=>e.jsxs("div",{draggable:!0,onDragStart:()=>te(I),className:"p-2 bg-gray-50 rounded-lg cursor-move hover:bg-gray-100 flex items-center gap-2",children:[e.jsxs("div",{className:"w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center text-gray-600 text-xs font-bold",children:[I.first_name?.[0],I.last_name?.[0]]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:[I.first_name," ",I.last_name]}),e.jsx("p",{className:"text-xs text-gray-500",children:I.admission_number})]})]},I.id))}),e.jsxs("div",{className:"mt-4 pt-4 border-t space-y-2",children:[e.jsxs("button",{onClick:V,className:"w-full btn bg-green-100 text-green-700 hover:bg-green-200 btn-sm",children:[e.jsx(cb,{className:"w-4 h-4 mr-2"})," Auto Assign"]}),e.jsxs("button",{onClick:re,className:"w-full btn bg-orange-100 text-orange-700 hover:bg-orange-200 btn-sm",children:[e.jsx(kB,{className:"w-4 h-4 mr-2"})," Shuffle All"]})]})]}),e.jsxs("div",{className:"lg:col-span-3 card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:f.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[f.room_name||"Classroom","  ",f.rows," rows  ",f.columns," columns"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:ge,className:"btn bg-gray-100 hover:bg-gray-200 btn-sm",children:[e.jsx(or,{className:"w-4 h-4 mr-1"})," Print"]}),e.jsx("button",{onClick:()=>E(g),className:"btn bg-red-100 text-red-700 hover:bg-red-200 btn-sm",children:e.jsx(us,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"mb-6 flex justify-center",children:e.jsx("div",{className:"px-8 py-2 bg-gray-800 text-white rounded-lg text-sm",children:"Teacher's Desk"})}),e.jsx("div",{className:"space-y-2 overflow-x-auto pb-4",children:Z()}),e.jsxs("div",{className:"mt-6 pt-4 border-t flex items-center gap-6 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-50 border-2 border-blue-300 rounded"}),e.jsx("span",{children:"Assigned"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-gray-50 border-2 border-dashed border-gray-300 rounded"}),e.jsx("span",{children:"Empty"})]})]})]})]}):e.jsxs("div",{className:"card p-12 text-center",children:[e.jsx(cb,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Seating Chart"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Create a seating chart for this class"}),e.jsxs("button",{onClick:T,className:"btn btn-primary",children:[e.jsx(qt,{className:"w-4 h-4 mr-2"})," Create Chart"]})]}),v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:D?"Edit Chart":"New Seating Chart"}),e.jsx("button",{onClick:()=>U(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:Q,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Chart Name"}),e.jsx("input",{type:"text",value:P.name,onChange:I=>se({...P,name:I.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Room Name"}),e.jsx("input",{type:"text",value:P.room_name,onChange:I=>se({...P,room_name:I.target.value}),className:"input",placeholder:"e.g., Room 101"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Rows"}),e.jsx("input",{type:"number",min:"1",max:"10",value:P.rows,onChange:I=>se({...P,rows:parseInt(I.target.value)}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Columns"}),e.jsx("input",{type:"number",min:"1",max:"10",value:P.columns,onChange:I=>se({...P,columns:parseInt(I.target.value)}),className:"input"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>U(!1),className:"btn bg-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Create Chart"})]})]})]})})]})}function Z$(){const{user:t}=Us(),[s,a]=h.useState(!0),[r,l]=h.useState(null),[c,o]=h.useState([]),[m,u]=h.useState([]),[x,A]=h.useState([]),[g,N]=h.useState(null),[f,y]=h.useState(!1),[v,U]=h.useState(null),[D,M]=h.useState({class_id:"",date_from:"",date_to:"",substitute_teacher_id:"",lesson_plans:"",class_info:"",student_notes:"",special_instructions:"",materials_location:"",routines:"",behavior_notes:"",emergency_contacts:""});h.useEffect(()=>{K()},[]);const K=async()=>{try{a(!0);const Q=(await F.get(`${ee}/teachers.php?user_id=${t?.id}`)).data.teachers||[];if(Q.length>0){const E=Q[0];l(E.id),u(Q);const[te,C]=await Promise.all([F.get(`${ee}/teacher_subjects.php?teacher_id=${E.id}`),F.get(`${ee}/substitute_mode.php?teacher_id=${E.id}`)]),V=(te.data.teacher_classes||[]).map(re=>({id:re.class_id,class_name:re.class_name}));o(V),A(C.data.notes||[])}}catch(T){console.error("Error:",T)}finally{a(!1)}},$=()=>{U(null);const T=new Date;T.setDate(T.getDate()+1),M({class_id:c[0]?.id||"",date_from:T.toISOString().split("T")[0],date_to:T.toISOString().split("T")[0],substitute_teacher_id:"",lesson_plans:"",class_info:"",student_notes:"",special_instructions:"",materials_location:"",routines:"",behavior_notes:"",emergency_contacts:""}),y(!0)},P=T=>{U(T),M({class_id:T.class_id,date_from:T.date_from,date_to:T.date_to,substitute_teacher_id:T.substitute_teacher_id||"",lesson_plans:T.lesson_plans||"",class_info:T.class_info||"",student_notes:T.student_notes||"",special_instructions:T.special_instructions||"",materials_location:T.materials_location||"",routines:T.routines||"",behavior_notes:T.behavior_notes||"",emergency_contacts:T.emergency_contacts||""}),y(!0)},se=async T=>{try{const Q=await F.get(`${ee}/substitute_mode.php?id=${T.id}`);N(Q.data.note)}catch(Q){console.error("Error:",Q)}},z=async T=>{T.preventDefault();try{const Q={teacher_id:r,...D};v?await F.put(`${ee}/substitute_mode.php?id=${v.id}`,Q):await F.post(`${ee}/substitute_mode.php`,Q),y(!1),K()}catch(Q){console.error("Error:",Q),alert("Failed to save")}},R=async T=>{if(window.confirm("Delete this substitute note?"))try{await F.delete(`${ee}/substitute_mode.php?id=${T}`),K(),g?.id===T&&N(null)}catch(Q){console.error("Error:",Q)}},j=T=>{const Q=new Date().toISOString().split("T")[0];return T.date_to<Q?e.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-600",children:"Completed"}):T.date_from<=Q&&T.date_to>=Q?e.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-green-100 text-green-700",children:"Active"}):e.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-700",children:"Upcoming"})};return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(hs,{className:"w-8 h-8 animate-spin text-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Substitute Teacher Mode"}),e.jsx("p",{className:"text-gray-600",children:"Leave detailed notes for substitute teachers"})]}),e.jsxs("button",{onClick:$,className:"btn btn-primary",children:[e.jsx(qt,{className:"w-4 h-4 mr-2"})," Create Handover Notes"]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(Or,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-900",children:"Planning to be absent?"}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Create detailed handover notes to help substitute teachers manage your classes effectively. Include lesson plans, student information, and classroom routines."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsx("h3",{className:"font-semibold text-gray-900",children:"Your Handover Notes"})}),e.jsx("div",{className:"divide-y max-h-[600px] overflow-y-auto",children:x.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(Kt,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"No handover notes yet"})]}):x.map(T=>e.jsx("button",{onClick:()=>se(T),className:`w-full p-4 text-left hover:bg-gray-50 transition-colors ${g?.id===T.id?"bg-blue-50":""}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:T.class_name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[new Date(T.date_from).toLocaleDateString()," - ",new Date(T.date_to).toLocaleDateString()]}),T.substitute_name&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Sub: ",T.substitute_name]})]}),j(T)]})},T.id))})]}),e.jsx("div",{className:"lg:col-span-2",children:g?e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"p-6 border-b flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:g.class_name}),e.jsxs("p",{className:"text-gray-500",children:[new Date(g.date_from).toLocaleDateString()," - ",new Date(g.date_to).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>P(g),className:"btn bg-blue-100 text-blue-700 hover:bg-blue-200 btn-sm",children:e.jsx(Na,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>R(g.id),className:"btn bg-red-100 text-red-700 hover:bg-red-200 btn-sm",children:e.jsx(us,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[g.substitute_name&&e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-50 rounded-lg",children:[e.jsx(Or,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Substitute Teacher"}),e.jsx("p",{className:"font-medium text-gray-900",children:g.substitute_name})]})]}),g.lesson_plans&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[e.jsx(as,{className:"w-4 h-4 text-blue-600"})," Lesson Plans"]}),e.jsx("div",{className:"bg-blue-50 p-4 rounded-lg whitespace-pre-line text-gray-700",children:g.lesson_plans})]}),g.class_info&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[e.jsx(Rt,{className:"w-4 h-4 text-purple-600"})," Class Information"]}),e.jsx("div",{className:"bg-purple-50 p-4 rounded-lg whitespace-pre-line text-gray-700",children:g.class_info})]}),g.routines&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[e.jsx(Wt,{className:"w-4 h-4 text-green-600"})," Daily Routines"]}),e.jsx("div",{className:"bg-green-50 p-4 rounded-lg whitespace-pre-line text-gray-700",children:g.routines})]}),g.student_notes&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[e.jsx(_s,{className:"w-4 h-4 text-orange-600"})," Student Notes"]}),e.jsx("div",{className:"bg-orange-50 p-4 rounded-lg whitespace-pre-line text-gray-700",children:g.student_notes})]}),g.behavior_notes&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Behavior Notes"}),e.jsx("div",{className:"bg-red-50 p-4 rounded-lg whitespace-pre-line text-gray-700",children:g.behavior_notes})]}),g.materials_location&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[e.jsx(Qn,{className:"w-4 h-4 text-teal-600"})," Materials Location"]}),e.jsx("div",{className:"bg-teal-50 p-4 rounded-lg whitespace-pre-line text-gray-700",children:g.materials_location})]}),g.special_instructions&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[e.jsx(Di,{className:"w-4 h-4 text-indigo-600"})," Special Instructions"]}),e.jsx("div",{className:"bg-indigo-50 p-4 rounded-lg whitespace-pre-line text-gray-700",children:g.special_instructions})]}),g.emergency_contacts&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[e.jsx(er,{className:"w-4 h-4 text-red-600"})," Emergency Contacts"]}),e.jsx("div",{className:"bg-red-50 p-4 rounded-lg whitespace-pre-line text-gray-700",children:g.emergency_contacts})]}),g.students?.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-2",children:["Class Roster (",g.students.length," students)"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:g.students.map(T=>e.jsxs("div",{className:"p-2 bg-gray-50 rounded text-sm",children:[e.jsxs("p",{className:"font-medium",children:[T.first_name," ",T.last_name]}),T.medical_conditions&&e.jsxs("p",{className:"text-xs text-red-600",children:[" Medical: ",T.medical_conditions]})]},T.id))})]})]})]}):e.jsxs("div",{className:"card p-12 text-center",children:[e.jsx(Kt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Select a Note"}),e.jsx("p",{className:"text-gray-500",children:"Choose a handover note to view details"})]})})]}),f&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b sticky top-0 bg-white flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:v?"Edit Handover Notes":"Create Handover Notes"}),e.jsx("button",{onClick:()=>y(!1),children:e.jsx(Nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:z,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Class *"}),e.jsxs("select",{required:!0,value:D.class_id,onChange:T=>M({...D,class_id:T.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select Class"}),c.map(T=>e.jsx("option",{value:T.id,children:T.class_name},T.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Substitute Teacher"}),e.jsxs("select",{value:D.substitute_teacher_id,onChange:T=>M({...D,substitute_teacher_id:T.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Not assigned yet"}),m.filter(T=>T.id!==r).map(T=>e.jsxs("option",{value:T.id,children:[T.first_name," ",T.last_name]},T.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"From Date *"}),e.jsx("input",{type:"date",required:!0,value:D.date_from,onChange:T=>M({...D,date_from:T.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"To Date *"}),e.jsx("input",{type:"date",required:!0,value:D.date_to,onChange:T=>M({...D,date_to:T.target.value}),className:"input"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:[e.jsx(as,{className:"w-4 h-4 inline mr-1"})," Lesson Plans"]}),e.jsx("textarea",{value:D.lesson_plans,onChange:T=>M({...D,lesson_plans:T.target.value}),className:"input",rows:"4",placeholder:"What should be taught during your absence? Include topics, activities, and page numbers..."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:[e.jsx(Rt,{className:"w-4 h-4 inline mr-1"})," Class Information"]}),e.jsx("textarea",{value:D.class_info,onChange:T=>M({...D,class_info:T.target.value}),className:"input",rows:"3",placeholder:"General information about the class, seating arrangements, class rules..."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:[e.jsx(Wt,{className:"w-4 h-4 inline mr-1"})," Daily Routines"]}),e.jsx("textarea",{value:D.routines,onChange:T=>M({...D,routines:T.target.value}),className:"input",rows:"3",placeholder:"Morning routine, transitions, dismissal procedures..."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:[e.jsx(_s,{className:"w-4 h-4 inline mr-1"})," Student Notes"]}),e.jsx("textarea",{value:D.student_notes,onChange:T=>M({...D,student_notes:T.target.value}),className:"input",rows:"3",placeholder:"Students who need extra attention, medical needs, behavioral concerns..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:[e.jsx(Qn,{className:"w-4 h-4 inline mr-1"})," Materials Location"]}),e.jsx("textarea",{value:D.materials_location,onChange:T=>M({...D,materials_location:T.target.value}),className:"input",rows:"2",placeholder:"Where to find textbooks, worksheets, supplies..."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:[e.jsx(er,{className:"w-4 h-4 inline mr-1"})," Emergency Contacts"]}),e.jsx("textarea",{value:D.emergency_contacts,onChange:T=>M({...D,emergency_contacts:T.target.value}),className:"input",rows:"2",placeholder:"Your contact info, department head, office..."})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Special Instructions"}),e.jsx("textarea",{value:D.special_instructions,onChange:T=>M({...D,special_instructions:T.target.value}),className:"input",rows:"2",placeholder:"Any other important information..."})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>y(!1),className:"btn bg-gray-200",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-primary",children:[e.jsx(Br,{className:"w-4 h-4 mr-2"})," ",v?"Update":"Create"," Notes"]})]})]})]})})]})}const eH=["Ghanaian","Nigerian","South African","Kenyan","Tanzanian","Ugandan","Ethiopian","Egyptian","Moroccan","Algerian","Tunisian","Libyan","Cameroonian","Ivorian","Senegalese","Malian","Burkinabe","Togolese","Beninese","Nigerien","Chadian","Sudanese","Eritrean","Somali","Rwandan","Burundian","Congolese","Angolan","Zambian","Zimbabwean","Mozambican","Malawian","Botswanan","Namibian","Swazi","Lesothan","American","British","Canadian","Australian","Indian","Chinese","French","German","Italian","Spanish","Portuguese","Dutch","Belgian","Swiss","Austrian","Swedish","Norwegian","Danish","Finnish","Polish","Russian","Ukrainian","Turkish","Greek","Lebanese","Syrian","Iraqi","Iranian","Saudi","Emirati","Qatari","Kuwaiti","Bahraini","Omani","Yemeni","Jordanian","Palestinian","Israeli","Pakistani","Bangladeshi","Sri Lankan","Nepalese","Bhutanese","Maldivian","Afghan","Uzbek","Kazakh","Japanese","Korean","Vietnamese","Thai","Malaysian","Singaporean","Indonesian","Filipino","Burmese","Cambodian","Laotian","Brazilian","Argentine","Chilean","Colombian","Peruvian","Venezuelan","Ecuadorian","Bolivian","Paraguayan","Uruguayan","Mexican","Cuban","Jamaican","Haitian","Dominican","Puerto Rican","Other"].sort(),tH=["Christianity","Islam","Traditional African Religion","Hinduism","Buddhism","Judaism","Sikhism","Bah Faith","Jainism","Shinto","Taoism","Confucianism","Zoroastrianism","Atheist/Agnostic","Spiritual but not religious","Prefer not to say","Other"],sH=["A+","A-","B+","B-","AB+","AB-","O+","O-","Unknown"];function aH(){const t=la(),{user:s}=Us(),[a,r]=h.useState(1),[l,c]=h.useState(!1),[o,m]=h.useState(null),[u,x]=h.useState(!1),[A,g]=h.useState(""),[N,f]=h.useState([]),[y,v]=h.useState(!1),[U,D]=h.useState("right"),M=h.useRef(null),K=h.useRef(null),[$,P]=h.useState(!1),[se,z]=h.useState(null),[R,j]=h.useState({first_name:"",last_name:"",other_names:"",date_of_birth:"",gender:"male",blood_group:"",nationality:"Ghanaian",religion:"",email:"",phone:"",address:"",city:"",region:"",previous_school:"",class_applying_for:"",academic_year:new Date().getFullYear()+"/"+(new Date().getFullYear()+1),guardian_name:s?.name||"",guardian_phone:s?.phone||"",guardian_email:s?.email||"",guardian_relationship:"",guardian_address:"",guardian_occupation:"",emergency_contact_name:"",emergency_contact_phone:"",emergency_contact_relationship:"",medical_conditions:"",allergies:"",medications:"",photo:null});h.useEffect(()=>{(async()=>{try{const I=await F.get(`${ee}/classes.php`);f(I.data.classes||[])}catch(I){console.error("Error fetching classes:",I)}})()},[]),h.useEffect(()=>()=>{se&&se.getTracks().forEach(Z=>Z.stop())},[se]);const T=async Z=>{const I=Z.target.files[0];I&&await Q(I)},Q=async Z=>{if(!Z.type.startsWith("image/")){alert("Please select an image file");return}if(Z.size>5*1024*1024){alert("File size must be less than 5MB");return}const I=new FileReader;I.onloadend=()=>{m(I.result)},I.readAsDataURL(Z);try{c(!0);const H=new FormData;H.append("photo",Z),H.append("type","application");const ae=await F.post(`${ee}/upload_photo.php`,H,{headers:{"Content-Type":"multipart/form-data"}});if(ae.data.success)j(k=>({...k,photo:ae.data.url}));else throw new Error(ae.data.error||"Upload failed")}catch(H){console.error("Error uploading photo:",H),alert("Failed to upload photo: "+(H.response?.data?.error||H.message)),m(null)}finally{c(!1)}},E=async()=>{try{const Z=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user",width:640,height:480}});z(Z),P(!0),K.current&&(K.current.srcObject=Z)}catch(Z){console.error("Error accessing webcam:",Z),alert("Could not access camera. Please check permissions.")}},te=()=>{if(!K.current)return;const Z=document.createElement("canvas");Z.width=K.current.videoWidth,Z.height=K.current.videoHeight,Z.getContext("2d").drawImage(K.current,0,0),Z.toBlob(async H=>{const ae=new File([H],"webcam-photo.jpg",{type:"image/jpeg"});C(),await Q(ae)},"image/jpeg",.9)},C=()=>{se&&(se.getTracks().forEach(Z=>Z.stop()),z(null)),P(!1)},O=async Z=>{Z.preventDefault();const I=V(1),H=V(2),ae=[...I,...H];if(ae.length>0){alert(`Please fix the following errors before submitting:

`+ae.join(`
`));return}try{const k=await MA.create({...R,parent_id:s.id});g(k.data.application_number),x(!0)}catch(k){console.error("Error submitting application:",k),alert("Failed to submit application: "+(k.response?.data?.error||k.message))}},V=Z=>{const I=[];if(Z===1&&(R.first_name.trim()||I.push("First name is required"),R.last_name.trim()||I.push("Last name is required"),R.date_of_birth||I.push("Date of birth is required"),R.gender||I.push("Gender is required"),R.nationality||I.push("Nationality is required"),R.class_applying_for||I.push("Class applying for is required")),Z===2){R.guardian_name.trim()||I.push("Guardian name is required"),R.guardian_phone.trim()||I.push("Guardian phone is required"),R.guardian_email.trim()||I.push("Guardian email is required"),R.guardian_relationship||I.push("Relationship to child is required");const H=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;R.guardian_email&&!H.test(R.guardian_email)&&I.push("Please enter a valid email address"),R.guardian_phone&&R.guardian_phone.replace(/\D/g,"").length<10&&I.push("Please enter a valid phone number")}return I},re=()=>{if(a<4&&!y){const Z=V(a);if(Z.length>0){alert(`Please fix the following errors:

`+Z.join(`
`));return}v(!0),D("right"),setTimeout(()=>{r(a+1),setTimeout(()=>v(!1),300)},150)}},ge=()=>{a>1&&!y&&(v(!0),D("left"),setTimeout(()=>{r(a-1),setTimeout(()=>v(!1),300)},150))},xe=[{icon:ha,label:"Student Info",description:"Basic information"},{icon:Rt,label:"Guardian Info",description:"Parent/Guardian details"},{icon:Oo,label:"Medical Info",description:"Health information"},{icon:Ld,label:"Photo & Review",description:"Upload photo & submit"}];return u?e.jsx("div",{className:"max-w-2xl mx-auto animate-fade-in",children:e.jsxs("div",{className:"card p-8 text-center overflow-hidden",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-green-400 to-green-600 rounded-full flex items-center justify-center mx-auto mb-6 animate-bounce-in shadow-lg",children:e.jsx(Mt,{className:"w-12 h-12 text-white"})}),e.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-20 h-20 bg-green-400 rounded-full animate-ping opacity-20"})]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2 animate-slide-up",children:"Application Submitted!"}),e.jsx("p",{className:"text-gray-600 mb-8 animate-slide-up",style:{animationDelay:"100ms"},children:"Your application has been successfully submitted and is now under review."}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6 mb-8 animate-slide-up",style:{animationDelay:"200ms"},children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Application Number"}),e.jsx("p",{className:"text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-indigo-600 font-mono",children:A}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Please save this number for tracking"})]}),e.jsxs("div",{className:"space-y-4 text-left bg-gray-50 p-6 rounded-xl mb-8 animate-slide-up",style:{animationDelay:"300ms"},children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(cl,{className:"w-5 h-5 text-yellow-500"}),"What's Next?"]}),["Our admissions team will review your application","You'll receive a notification within 2-3 business days","Track your application status in your dashboard"].map((Z,I)=>e.jsxs("div",{className:"flex items-start gap-3 animate-slide-right",style:{animationDelay:`${400+I*100}ms`},children:[e.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-full flex items-center justify-center text-sm flex-shrink-0 shadow-sm",children:I+1}),e.jsx("p",{className:"text-sm text-gray-600 pt-1",children:Z})]},I))]}),e.jsx("button",{onClick:()=>t("/parent/dashboard"),className:"btn btn-primary px-8 py-3 text-lg animate-slide-up hover:scale-105 transition-transform",style:{animationDelay:"700ms"},children:"Go to Dashboard"})]})}):e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("style",{children:`
        @keyframes fade-in { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slide-up { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slide-right { from { opacity: 0; transform: translateX(-20px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes slide-left { from { opacity: 0; transform: translateX(20px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes bounce-in { 0% { transform: scale(0); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        @keyframes pulse-ring { 0% { transform: scale(0.8); opacity: 0.5; } 100% { transform: scale(1.4); opacity: 0; } }
        .animate-fade-in { animation: fade-in 0.5s ease-out forwards; }
        .animate-slide-up { animation: slide-up 0.5s ease-out forwards; opacity: 0; }
        .animate-slide-right { animation: slide-right 0.5s ease-out forwards; opacity: 0; }
        .animate-slide-left { animation: slide-left 0.5s ease-out forwards; opacity: 0; }
        .animate-bounce-in { animation: bounce-in 0.5s ease-out forwards; }
        .step-enter-right { animation: slide-right 0.3s ease-out forwards; }
        .step-enter-left { animation: slide-left 0.3s ease-out forwards; }
        .input-focus:focus { box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2); border-color: #3b82f6; }
        .photo-upload-zone { transition: all 0.3s ease; }
        .photo-upload-zone:hover { border-color: #3b82f6; background-color: #eff6ff; }
      `}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>t("/parent/dashboard"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4 transition-colors group",children:[e.jsx(ol,{className:"w-4 h-4 group-hover:-translate-x-1 transition-transform"}),"Back to Dashboard"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx(Qs,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Apply for Admission"}),e.jsx("p",{className:"text-gray-600",children:"Fill in your child's information to submit an application"})]})]})]}),e.jsx("div",{className:"card p-6 mb-6 bg-gradient-to-r from-gray-50 to-white",children:e.jsxs("div",{className:"flex items-center justify-between relative",children:[e.jsx("div",{className:"absolute top-6 left-0 right-0 h-1 bg-gray-200 mx-16"}),e.jsx("div",{className:"absolute top-6 left-0 h-1 bg-gradient-to-r from-blue-500 to-indigo-600 mx-16 transition-all duration-500",style:{width:`${(a-1)/3*100}%`,maxWidth:"calc(100% - 8rem)"}}),xe.map((Z,I)=>{const H=Z.icon,ae=a===I+1,k=a>I+1;return e.jsxs("div",{className:"flex flex-col items-center z-10 flex-1",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center font-semibold transition-all duration-300 ${k?"bg-gradient-to-br from-green-400 to-green-600 text-white shadow-lg scale-100":ae?"bg-gradient-to-br from-blue-500 to-indigo-600 text-white shadow-lg scale-110 ring-4 ring-blue-100":"bg-white border-2 border-gray-200 text-gray-400"}`,children:k?e.jsx(Mt,{className:"w-6 h-6"}):e.jsx(H,{className:"w-5 h-5"})}),e.jsx("span",{className:`text-xs mt-2 font-medium transition-colors ${ae?"text-blue-600":k?"text-green-600":"text-gray-500"}`,children:Z.label}),e.jsx("span",{className:"text-xs text-gray-400 hidden sm:block",children:Z.description})]},I)})]})}),e.jsx("form",{onSubmit:O,children:e.jsxs("div",{className:`card p-6 overflow-hidden ${y?"opacity-50":""}`,children:[a===1&&e.jsxs("div",{className:`space-y-6 ${U==="right"?"step-enter-right":"step-enter-left"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(ha,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Student Information"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Enter your child's basic details"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"group",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name *"}),e.jsx("input",{type:"text",required:!0,value:R.first_name,onChange:Z=>j({...R,first_name:Z.target.value}),className:"input input-focus transition-all duration-200",placeholder:"Enter first name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name *"}),e.jsx("input",{type:"text",required:!0,value:R.last_name,onChange:Z=>j({...R,last_name:Z.target.value}),className:"input input-focus transition-all duration-200",placeholder:"Enter last name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Other Names"}),e.jsx("input",{type:"text",value:R.other_names,onChange:Z=>j({...R,other_names:Z.target.value}),className:"input input-focus transition-all duration-200",placeholder:"Middle names (optional)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date of Birth *"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ot,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"date",required:!0,value:R.date_of_birth,onChange:Z=>j({...R,date_of_birth:Z.target.value}),className:"input input-focus pl-10 transition-all duration-200"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gender *"}),e.jsxs("select",{required:!0,value:R.gender,onChange:Z=>j({...R,gender:Z.target.value}),className:"input input-focus transition-all duration-200",children:[e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Blood Group"}),e.jsxs("select",{value:R.blood_group,onChange:Z=>j({...R,blood_group:Z.target.value}),className:"input input-focus transition-all duration-200",children:[e.jsx("option",{value:"",children:"Select Blood Group"}),sH.map(Z=>e.jsx("option",{value:Z,children:Z},Z))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nationality *"}),e.jsxs("select",{required:!0,value:R.nationality,onChange:Z=>j({...R,nationality:Z.target.value}),className:"input input-focus transition-all duration-200",children:[e.jsx("option",{value:"",children:"Select Nationality"}),eH.map(Z=>e.jsx("option",{value:Z,children:Z},Z))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Religion"}),e.jsxs("select",{value:R.religion,onChange:Z=>j({...R,religion:Z.target.value}),className:"input input-focus transition-all duration-200",children:[e.jsx("option",{value:"",children:"Select Religion"}),tH.map(Z=>e.jsx("option",{value:Z,children:Z},Z))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(ra,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"email",value:R.email,onChange:Z=>j({...R,email:Z.target.value}),className:"input input-focus pl-10 transition-all duration-200",placeholder:"student@email.com"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),e.jsxs("div",{className:"relative",children:[e.jsx(er,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"tel",value:R.phone,onChange:Z=>j({...R,phone:Z.target.value}),className:"input input-focus pl-10 transition-all duration-200",placeholder:"024 XXX XXXX"})]})]}),e.jsxs("div",{className:"col-span-1 md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(Qn,{className:"absolute left-3 top-3 w-4 h-4 text-gray-400"}),e.jsx("textarea",{value:R.address,onChange:Z=>j({...R,address:Z.target.value}),className:"input input-focus pl-10 transition-all duration-200",rows:"2",placeholder:"Enter residential address"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Previous School"}),e.jsx("input",{type:"text",value:R.previous_school,onChange:Z=>j({...R,previous_school:Z.target.value}),className:"input input-focus transition-all duration-200",placeholder:"Name of previous school"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Class Applying For *"}),e.jsxs("select",{required:!0,value:R.class_applying_for,onChange:Z=>j({...R,class_applying_for:Z.target.value}),className:"input input-focus transition-all duration-200",children:[e.jsx("option",{value:"",children:N.length>0?"Select Class":"No classes available - Contact admin"}),N.map(Z=>e.jsx("option",{value:Z.id,children:Z.class_name},Z.id))]})]})]})]}),a===2&&e.jsxs("div",{className:`space-y-6 ${U==="right"?"step-enter-right":"step-enter-left"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(Rt,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Guardian Information"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Parent or guardian contact details"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Guardian Name *"}),e.jsx("input",{type:"text",required:!0,value:R.guardian_name,onChange:Z=>j({...R,guardian_name:Z.target.value}),className:"input input-focus transition-all duration-200",placeholder:"Full name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Guardian Phone *"}),e.jsxs("div",{className:"relative",children:[e.jsx(er,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"tel",required:!0,value:R.guardian_phone,onChange:Z=>j({...R,guardian_phone:Z.target.value}),className:"input input-focus pl-10 transition-all duration-200",placeholder:"024 XXX XXXX"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Guardian Email *"}),e.jsxs("div",{className:"relative",children:[e.jsx(ra,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"email",required:!0,value:R.guardian_email,onChange:Z=>j({...R,guardian_email:Z.target.value}),className:"input input-focus pl-10 transition-all duration-200",placeholder:"guardian@email.com"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Relationship *"}),e.jsxs("select",{required:!0,value:R.guardian_relationship,onChange:Z=>j({...R,guardian_relationship:Z.target.value}),className:"input input-focus transition-all duration-200",children:[e.jsx("option",{value:"",children:"Select Relationship"}),e.jsx("option",{value:"Father",children:"Father"}),e.jsx("option",{value:"Mother",children:"Mother"}),e.jsx("option",{value:"Guardian",children:"Guardian"}),e.jsx("option",{value:"Grandparent",children:"Grandparent"}),e.jsx("option",{value:"Uncle",children:"Uncle"}),e.jsx("option",{value:"Aunt",children:"Aunt"}),e.jsx("option",{value:"Sibling",children:"Sibling"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Occupation"}),e.jsx("input",{type:"text",value:R.guardian_occupation,onChange:Z=>j({...R,guardian_occupation:Z.target.value}),className:"input input-focus transition-all duration-200",placeholder:"e.g., Teacher, Engineer"})]}),e.jsxs("div",{className:"col-span-1 md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Guardian Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(Qn,{className:"absolute left-3 top-3 w-4 h-4 text-gray-400"}),e.jsx("textarea",{value:R.guardian_address,onChange:Z=>j({...R,guardian_address:Z.target.value}),className:"input input-focus pl-10 transition-all duration-200",rows:"2",placeholder:"Enter guardian's address"})]})]})]}),e.jsxs("div",{className:"border-t pt-6 mt-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx(er,{className:"w-4 h-4 text-red-600"})}),e.jsx("h3",{className:"text-md font-semibold text-gray-900",children:"Emergency Contact"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Name"}),e.jsx("input",{type:"text",value:R.emergency_contact_name,onChange:Z=>j({...R,emergency_contact_name:Z.target.value}),className:"input input-focus transition-all duration-200",placeholder:"Emergency contact name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Phone"}),e.jsx("input",{type:"tel",value:R.emergency_contact_phone,onChange:Z=>j({...R,emergency_contact_phone:Z.target.value}),className:"input input-focus transition-all duration-200",placeholder:"024 XXX XXXX"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Relationship"}),e.jsxs("select",{value:R.emergency_contact_relationship,onChange:Z=>j({...R,emergency_contact_relationship:Z.target.value}),className:"input input-focus transition-all duration-200",children:[e.jsx("option",{value:"",children:"Select Relationship"}),e.jsx("option",{value:"Relative",children:"Relative"}),e.jsx("option",{value:"Friend",children:"Friend"}),e.jsx("option",{value:"Neighbor",children:"Neighbor"}),e.jsx("option",{value:"Colleague",children:"Colleague"}),e.jsx("option",{value:"Other",children:"Other"})]})]})]})]})]}),a===3&&e.jsxs("div",{className:`space-y-6 ${U==="right"?"step-enter-right":"step-enter-left"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx(Oo,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Medical Information"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Health details for your child's safety"})]})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Note:"})," This information is confidential and will only be used for your child's health and safety at school."]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Medical Conditions",e.jsx("span",{className:"text-gray-400 font-normal ml-2",children:"(if any)"})]}),e.jsx("textarea",{value:R.medical_conditions,onChange:Z=>j({...R,medical_conditions:Z.target.value}),className:"input input-focus transition-all duration-200",rows:"3",placeholder:"e.g., Asthma, Diabetes, Epilepsy, Heart condition, etc. Write 'None' if not applicable."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Allergies",e.jsx("span",{className:"text-gray-400 font-normal ml-2",children:"(food, medication, environmental)"})]}),e.jsx("textarea",{value:R.allergies,onChange:Z=>j({...R,allergies:Z.target.value}),className:"input input-focus transition-all duration-200",rows:"3",placeholder:"e.g., Peanuts, Penicillin, Dust, Pollen, etc. Write 'None' if not applicable."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Current Medications",e.jsx("span",{className:"text-gray-400 font-normal ml-2",children:"(if any)"})]}),e.jsx("textarea",{value:R.medications,onChange:Z=>j({...R,medications:Z.target.value}),className:"input input-focus transition-all duration-200",rows:"3",placeholder:"List any medications your child is currently taking. Write 'None' if not applicable."})]})]})]}),a===4&&e.jsxs("div",{className:`space-y-6 ${U==="right"?"step-enter-right":"step-enter-left"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(Ld,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Photo & Review"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Upload a photo and review your application"})]})]}),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-8 photo-upload-zone bg-gray-50",children:$?e.jsxs("div",{className:"text-center",children:[e.jsx("video",{ref:K,autoPlay:!0,playsInline:!0,muted:!0,className:"w-64 h-64 object-cover rounded-xl mx-auto mb-4 bg-black"}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsxs("button",{type:"button",onClick:te,className:"btn btn-primary",children:[e.jsx(Ld,{className:"w-4 h-4"}),"Capture Photo"]}),e.jsxs("button",{type:"button",onClick:C,className:"btn bg-gray-200 hover:bg-gray-300",children:[e.jsx(Nt,{className:"w-4 h-4"}),"Cancel"]})]})]}):o?e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative inline-block",children:[e.jsx("img",{src:o,alt:"Preview",className:"w-48 h-48 object-cover rounded-xl mx-auto mb-4 shadow-lg ring-4 ring-white"}),l&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 rounded-xl flex items-center justify-center",children:e.jsx(hs,{className:"w-8 h-8 text-white animate-spin"})}),R.photo&&e.jsx("div",{className:"absolute -bottom-2 -right-2 w-8 h-8 bg-green-500 rounded-full flex items-center justify-center shadow-lg",children:e.jsx(Mt,{className:"w-5 h-5 text-white"})})]}),e.jsx("p",{className:"text-sm text-green-600 font-medium mb-3",children:R.photo?"Photo uploaded successfully!":"Uploading..."}),e.jsxs("button",{type:"button",onClick:()=>{m(null),j({...R,photo:null})},className:"text-red-600 hover:text-red-700 text-sm flex items-center gap-2 mx-auto hover:underline",children:[e.jsx(Nt,{className:"w-4 h-4"}),"Remove and upload different photo"]})]}):e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(ha,{className:"w-12 h-12 text-gray-400"})}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Upload a passport-style photo of your child"}),e.jsxs("div",{className:"flex gap-3 justify-center flex-wrap",children:[e.jsxs("label",{className:"cursor-pointer",children:[e.jsxs("span",{className:"btn btn-primary inline-flex items-center gap-2",children:[e.jsx(Hr,{className:"w-4 h-4"}),l?"Uploading...":"Upload Photo"]}),e.jsx("input",{ref:M,type:"file",accept:"image/*",onChange:T,className:"hidden",disabled:l})]}),e.jsxs("button",{type:"button",onClick:E,className:"btn bg-gray-200 hover:bg-gray-300 inline-flex items-center gap-2",disabled:l,children:[e.jsx(Ld,{className:"w-4 h-4"}),"Take Photo"]})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-3",children:"JPG, PNG or GIF (max 5MB)"})]})}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Kt,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"font-semibold text-gray-900",children:"Review Your Application"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Student Details"}),e.jsxs("div",{className:"bg-white rounded-lg p-3 space-y-2",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Name:"})," ",e.jsxs("span",{className:"font-medium",children:[R.first_name," ",R.last_name]})]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Date of Birth:"})," ",e.jsx("span",{className:"font-medium",children:R.date_of_birth||"Not provided"})]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Gender:"})," ",e.jsx("span",{className:"font-medium capitalize",children:R.gender})]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Nationality:"})," ",e.jsx("span",{className:"font-medium",children:R.nationality||"Not provided"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Guardian Details"}),e.jsxs("div",{className:"bg-white rounded-lg p-3 space-y-2",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Name:"})," ",e.jsx("span",{className:"font-medium",children:R.guardian_name||"Not provided"})]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Phone:"})," ",e.jsx("span",{className:"font-medium",children:R.guardian_phone||"Not provided"})]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Email:"})," ",e.jsx("span",{className:"font-medium",children:R.guardian_email||"Not provided"})]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Relationship:"})," ",e.jsx("span",{className:"font-medium",children:R.guardian_relationship||"Not provided"})]})]})]}),e.jsxs("div",{className:"space-y-3 md:col-span-2",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Academic Information"}),e.jsx("div",{className:"bg-white rounded-lg p-3",children:e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Class Applying For:"})," ",e.jsx("span",{className:"font-medium",children:N.find(Z=>Z.id==R.class_applying_for)?.class_name||R.class_applying_for||"Not specified"})]})})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Please review"})," all information carefully before submitting. You can go back to previous steps to make changes."]})})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-8 pt-6 border-t border-gray-200",children:[e.jsxs("button",{type:"button",onClick:ge,disabled:a===1||y,className:"btn bg-gray-100 text-gray-700 hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 transition-all duration-200 hover:gap-3",children:[e.jsx(Kd,{className:"w-4 h-4"}),"Previous"]}),a<4?e.jsxs("button",{type:"button",onClick:re,disabled:y,className:"btn btn-primary flex items-center gap-2 transition-all duration-200 hover:gap-3",children:["Next Step",e.jsx(cr,{className:"w-4 h-4"})]}):e.jsxs("button",{type:"submit",disabled:y,className:"btn bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white px-8 py-3 flex items-center gap-2 shadow-lg hover:shadow-xl transition-all duration-200",children:[e.jsx(cl,{className:"w-4 h-4"}),"Submit Application"]})]})]})})]})}function rH(){const{studentId:t}=qd(),s=la(),[a,r]=h.useState(null),[l,c]=h.useState([]),[o,m]=h.useState([]),[u,x]=h.useState([]),[A,g]=h.useState([]),[N,f]=h.useState(!0),[y,v]=h.useState("overview");h.useEffect(()=>{U()},[t]);const U=async()=>{try{f(!0);const[$,P,se,z]=await Promise.all([F.get(`https://eea.mcaforo.com/backend/api/students.php?id=${t}`),F.get(`https://eea.mcaforo.com/backend/api/academic.php?resource=attendance&student_id=${t}`).catch(()=>({data:{attendance:[]}})),F.get(`https://eea.mcaforo.com/backend/api/academic.php?resource=grades&action=by_student&student_id=${t}`).catch(()=>({data:{grades:[]}})),F.get(`https://eea.mcaforo.com/backend/api/academic.php?resource=homework_submissions&student_id=${t}`).catch(()=>({data:{submissions:[]}}))]);r($.data.student),c(P.data.attendance||[]),m(se.data.grades||[]),x(z.data.submissions||[])}catch($){console.error("Error fetching child data:",$)}finally{f(!1)}},D=$=>{const P=new Date,se=new Date($);let z=P.getFullYear()-se.getFullYear();const R=P.getMonth()-se.getMonth();return(R<0||R===0&&P.getDate()<se.getDate())&&z--,z},M=()=>l.length===0?0:(l.filter(P=>P.status==="present").length/l.length*100).toFixed(1),K=()=>o.length===0?"N/A":(o.reduce((P,se)=>P+parseFloat(se.marks_obtained||0),0)/o.length).toFixed(1);return N?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-gray-500",children:"Loading..."})}):a?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>s("/parent/dashboard"),className:"text-gray-600 hover:text-gray-900",children:e.jsx(ol,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[a.first_name," ",a.last_name]}),e.jsx("p",{className:"text-gray-600",children:a.student_id})]})]}),e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-start gap-6",children:[e.jsxs("div",{className:"w-24 h-24 bg-blue-100 rounded-full flex items-center justify-center text-3xl font-bold text-blue-600",children:[a.first_name?.charAt(0),a.last_name?.charAt(0)]}),e.jsxs("div",{className:"flex-1 grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Age"}),e.jsxs("p",{className:"font-semibold",children:[D(a.date_of_birth)," years"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Class"}),e.jsx("p",{className:"font-semibold",children:a.class_name||"Not assigned"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Gender"}),e.jsx("p",{className:"font-semibold capitalize",children:a.gender})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Status"}),e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs font-medium rounded-full",children:a.status})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx(Mt,{className:"w-8 h-8 text-green-500"})}),e.jsx("p",{className:"text-sm text-gray-600",children:"Attendance Rate"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[M(),"%"]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx(as,{className:"w-8 h-8 text-blue-500"})}),e.jsx("p",{className:"text-sm text-gray-600",children:"Average Grade"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:K()})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx(Kt,{className:"w-8 h-8 text-purple-500"})}),e.jsx("p",{className:"text-sm text-gray-600",children:"Homework"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:u.length})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx(Wt,{className:"w-8 h-8 text-orange-500"})}),e.jsx("p",{className:"text-sm text-gray-600",children:"Days Present"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.filter($=>$.status==="present").length})]})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex gap-8",children:["overview","attendance","grades","homework"].map($=>e.jsx("button",{onClick:()=>v($),className:`py-4 px-1 border-b-2 font-medium text-sm ${y===$?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:$.charAt(0).toUpperCase()+$.slice(1)},$))})}),y==="overview"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Personal Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Date of Birth:"}),e.jsx("span",{className:"font-medium",children:new Date(a.date_of_birth).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Blood Group:"}),e.jsx("span",{className:"font-medium",children:a.blood_group||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Nationality:"}),e.jsx("span",{className:"font-medium",children:a.nationality})]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Guardian Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Name:"}),e.jsx("span",{className:"font-medium",children:a.guardian_name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Phone:"}),e.jsx("span",{className:"font-medium",children:a.guardian_phone})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Email:"}),e.jsx("span",{className:"font-medium",children:a.guardian_email})]})]})]})]}),y==="attendance"&&e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Attendance Records"}),l.length===0?e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No attendance records"}):e.jsx("div",{className:"space-y-2",children:l.slice(0,10).map(($,P)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[e.jsx("span",{className:"text-sm",children:new Date($.date).toLocaleDateString()}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${$.status==="present"?"bg-green-100 text-green-700":$.status==="absent"?"bg-red-100 text-red-700":$.status==="late"?"bg-orange-100 text-orange-700":"bg-blue-100 text-blue-700"}`,children:$.status})]},P))})]}),y==="grades"&&e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Academic Performance"}),o.length===0?e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No grades recorded"}):e.jsx("div",{className:"space-y-3",children:o.map(($,P)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:$.assessment_name}),e.jsx("p",{className:"text-sm text-gray-600",children:$.subject_name})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg font-bold text-blue-600",children:$.grade}),e.jsxs("p",{className:"text-sm text-gray-600",children:[$.marks_obtained,"/",$.total_marks]})]})]},P))})]}),y==="homework"&&e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Homework Submissions"}),u.length===0?e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No homework submissions"}):e.jsx("div",{className:"space-y-3",children:u.map(($,P)=>e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["Homework #",$.homework_id]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Submitted: ",$.submitted_at?new Date($.submitted_at).toLocaleDateString():"Not submitted"]})]}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${$.status==="graded"?"bg-green-100 text-green-700":$.status==="submitted"?"bg-blue-100 text-blue-700":$.status==="late"?"bg-red-100 text-red-700":"bg-orange-100 text-orange-700"}`,children:$.status})]}),$.status==="graded"&&e.jsxs("div",{className:"bg-green-50 p-3 rounded mt-2",children:[e.jsxs("p",{className:"text-sm font-semibold text-green-700",children:["Score: ",$.marks_obtained]}),$.feedback&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:$.feedback})]})]},P))})]})]}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"Student not found"})})}function nH(){const t=la(),{user:s}=Us(),[a,r]=h.useState(1),[l,c]=h.useState([]),[o,m]=h.useState([]),[u,x]=h.useState([]),[A,g]=h.useState([]),[N,f]=h.useState(!1),[y,v]=h.useState({student_id:"",term_id:"",selected_optional_items:[],installment_plan_id:"",total_amount:0}),[U,D]=h.useState([]);h.useEffect(()=>{M()},[]);const M=async()=>{try{const[E,te,C,O]=await Promise.all([Ch.getAll({parent_id:s.id}),yl.getAll(),ah.getAll(),jr.getInstallmentPlans()]),V=E.data.students||[];c(V),m(te.data.terms||[]),x(C.data.fee_items||[]),g(O.data.installment_plans||[]);const re=[];for(const ge of V)try{((await F.get(`${ee}/invoices.php?student_id=${ge.id}`)).data.invoices||[]).forEach(I=>{re.push({student_id:ge.id,term_id:I.term_id})})}catch(xe){console.error("Error fetching invoices for child:",ge.id,xe)}D(re)}catch(E){console.error("Error fetching data:",E)}},K=u.filter(E=>E.is_optional==0),$=u.filter(E=>E.is_optional==1),P=()=>{let E=0;return K.forEach(te=>{E+=parseFloat(te.amount||0)}),y.selected_optional_items.forEach(te=>{const C=$.find(O=>O.id===te);C&&(E+=parseFloat(C.amount||0))}),E},se=E=>{v(te=>({...te,selected_optional_items:te.selected_optional_items.includes(E)?te.selected_optional_items.filter(C=>C!==E):[...te.selected_optional_items,E]}))},z=async()=>{try{f(!0);const E={student_id:y.student_id,parent_id:s.id,term_id:y.term_id,class_id:1,academic_year:"2024/2025",total_amount:P(),installment_plan_id:y.installment_plan_id,status:"pending_finance",items:[...K.map(te=>({fee_item_id:te.id,description:te.item_name,quantity:1,unit_price:parseFloat(te.amount||0),amount:parseFloat(te.amount||0),is_optional:0})),...$.filter(te=>y.selected_optional_items.includes(te.id)).map(te=>({fee_item_id:te.id,description:te.item_name,quantity:1,unit_price:parseFloat(te.amount||0),amount:parseFloat(te.amount||0),is_optional:1}))]};await jr.createInvoice(E),alert("Enrollment submitted successfully! Your invoice has been sent for approval."),t("/parent/dashboard")}catch(E){console.error("Error submitting enrollment:",E),alert("Failed to submit enrollment")}finally{f(!1)}},R=l.find(E=>E.id==y.student_id),j=o.find(E=>E.id==y.term_id),T=A.find(E=>E.id==y.installment_plan_id),Q=y.term_id?l.filter(E=>!U.some(te=>te.student_id==E.id&&te.term_id==y.term_id)):l;return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Term Enrollment"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Enroll your child for the new term"})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:[1,2,3,4].map(E=>e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-semibold ${a>=E?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"}`,children:E}),E<4&&e.jsx("div",{className:`flex-1 h-1 mx-2 ${a>E?"bg-blue-600":"bg-gray-200"}`})]},E))}),e.jsxs("div",{className:"flex justify-between mt-2",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Select Term"}),e.jsx("span",{className:"text-xs text-gray-600",children:"Select Child"}),e.jsx("span",{className:"text-xs text-gray-600",children:"Optional Services"}),e.jsx("span",{className:"text-xs text-gray-600",children:"Payment Plan"})]})]}),e.jsxs("div",{className:"card p-6",children:[a===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Select Term"}),e.jsx("div",{className:"space-y-3",children:o.map(E=>e.jsx("button",{onClick:()=>v({...y,term_id:E.id,student_id:""}),className:`w-full p-4 border-2 rounded-lg text-left ${y.term_id==E.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:E.term_name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[new Date(E.start_date).toLocaleDateString()," - ",new Date(E.end_date).toLocaleDateString()]})]}),E.is_active==1&&e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs font-medium rounded-full",children:"Active"})]})},E.id))})]}),a===2&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Select Child"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Children already enrolled in the selected term are not shown."}),Q.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-gray-500",children:"No children available for enrollment"}),l.length>0&&e.jsx("p",{className:"text-sm text-blue-600 mt-2",children:"All your children are already enrolled in the selected term."})]}):e.jsx("div",{className:"space-y-3",children:Q.map(E=>e.jsx("button",{onClick:()=>v({...y,student_id:E.id}),className:`w-full p-4 border-2 rounded-lg text-left transition-all ${y.student_id==E.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsxs("span",{className:"text-blue-600 font-semibold",children:[E.first_name?.charAt(0),E.last_name?.charAt(0)]})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[E.first_name," ",E.last_name]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[E.student_id," - ",E.class_name]})]})]})},E.id))})]}),a===3&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Mandatory Fees"}),e.jsx("div",{className:"space-y-2",children:K.map(E=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[e.jsx("span",{className:"text-sm",children:E.item_name}),e.jsxs("span",{className:"font-semibold text-green-600",children:["GHS ",parseFloat(E.amount||0).toFixed(2)]})]},E.id))}),e.jsx("h2",{className:"text-lg font-semibold mt-6",children:"Optional Services"}),e.jsx("div",{className:"space-y-2",children:$.map(E=>e.jsxs("label",{className:"flex items-center justify-between p-3 border rounded cursor-pointer hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:y.selected_optional_items.includes(E.id),onChange:()=>se(E.id),className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:E.item_name})]}),e.jsxs("span",{className:"font-semibold text-blue-600",children:["GHS ",parseFloat(E.amount||0).toFixed(2)]})]},E.id))})]}),a===4&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Select Payment Plan"}),e.jsx("div",{className:"space-y-3",children:A.map(E=>e.jsxs("button",{onClick:()=>v({...y,installment_plan_id:E.id}),className:`w-full p-4 border-2 rounded-lg text-left ${y.installment_plan_id==E.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"font-medium",children:E.plan_name}),E.is_default==1&&e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded-full",children:"Recommended"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:E.description})]},E.id))}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-6",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Enrollment Summary"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Student:"}),e.jsxs("span",{className:"font-medium",children:[R?.first_name," ",R?.last_name]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Term:"}),e.jsx("span",{className:"font-medium",children:j?.term_name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Payment Plan:"}),e.jsx("span",{className:"font-medium",children:T?.plan_name})]}),e.jsxs("div",{className:"flex justify-between pt-2 border-t",children:[e.jsx("span",{className:"font-semibold",children:"Total Amount:"}),e.jsxs("span",{className:"font-bold text-lg text-blue-600",children:["GHS ",P().toFixed(2)]})]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-8 pt-6 border-t",children:[e.jsx("button",{onClick:()=>r(a-1),disabled:a===1,className:"btn bg-gray-200 text-gray-700 disabled:opacity-50",children:"Previous"}),a<4?e.jsxs("button",{onClick:()=>r(a+1),disabled:a===1&&!y.term_id||a===2&&!y.student_id,className:"btn btn-primary flex items-center gap-2 disabled:opacity-50",children:["Next ",e.jsx(Pl,{className:"w-4 h-4"})]}):e.jsxs("button",{onClick:z,disabled:N||!y.installment_plan_id,className:"btn btn-primary flex items-center gap-2 disabled:opacity-50",children:[e.jsx(Mt,{className:"w-5 h-5"}),N?"Submitting...":"Submit Enrollment"]})]})]})]})}const S_=Th(oy((t,s)=>({invoicePayments:{},recordPayment:(a,r,l="wallet")=>{t(c=>{const o=c.invoicePayments[a]||{paidAmount:0,payments:[]},m=o.paidAmount+parseFloat(r);return{invoicePayments:{...c.invoicePayments,[a]:{paidAmount:m,payments:[{id:Date.now(),amount:parseFloat(r),method:l,date:new Date().toISOString(),reference:`PAY-${Date.now()}`},...o.payments]}}}})},getInvoicePayment:a=>s().invoicePayments[a]||{paidAmount:0,payments:[]},getPaidAmount:a=>{const r=s().invoicePayments[a];return r?r.paidAmount:0},isFullyPaid:(a,r)=>s().getPaidAmount(a)>=parseFloat(r),getInvoiceStatus:(a,r,l=0)=>{const c=s().getPaidAmount(a),o=parseFloat(l)+c;return parseFloat(r)-o<=0?"paid":o>0?"partial":"pending"},reset:()=>t({invoicePayments:{}})}),{name:"invoice-payments-storage",getStorage:()=>localStorage}));function lH(){const t=la(),s=di(),{user:a}=Us(),{getPaidAmount:r,getInvoiceStatus:l}=S_(),[c,o]=h.useState(!0),[m,u]=h.useState([]),[x,A]=h.useState([]),[g,N]=h.useState("all"),[f,y]=h.useState("all"),[v,U]=h.useState(null),[D,M]=h.useState(!1),[K,$]=h.useState(!1),[P,se]=h.useState("invoice"),[z,R]=h.useState(null),[j,T]=h.useState([]),[Q,E]=h.useState([]),te=h.useRef(null);h.useEffect(()=>{if(C(),s.state?.paymentSuccess){const{paidInvoiceId:w,paidAmount:oe}=s.state;u(ne=>ne.map(Fe=>{if(Fe.id===w){const je=parseFloat(Fe.paid_amount||0)+parseFloat(oe),Ge=parseFloat(Fe.total_amount)-je,ze=Ge<=0?"paid":"partial";return{...Fe,paid_amount:je,balance:Ge,status:ze}}return Fe})),window.history.replaceState({},document.title)}},[s]);const C=async()=>{try{o(!0);try{const je=await F.get(`${ee}/settings.php`);R(je.data.settings||{})}catch{console.log("Could not fetch school settings")}const oe=(await F.get(`${ee}/students.php?parent_id=${a.id}`)).data.students||[];A(oe);const Fe=((await F.get(`${ee}/finance.php?resource=invoices&parent_id=${a.id}`)).data.invoices||[]).map(je=>{const Ge=r(je.id),ze=parseFloat(je.paid_amount||0),Xe=ze+Ge,st=parseFloat(je.total_amount),ce=st-Xe,_e=l(je.id,st,ze),le=oe.find(Pe=>Pe.id==je.student_id);return{...je,paid_amount:Xe,balance:ce,status:_e,student_name:le?`${le.first_name} ${le.last_name}`:`${je.first_name||""} ${je.last_name||""}`.trim()||"Unknown",student_id:je.student_id,class_name:le?.class_name||je.class_name||"N/A",student_code:le?.student_id||je.student_code||"N/A"}});u(Fe)}catch(w){console.error("Error fetching data:",w)}finally{o(!1)}},O=async w=>{try{const oe=await F.get(`${ee}/finance.php?resource=invoices&id=${w.id}`);oe.data.invoice?.items?T(oe.data.invoice.items):T([{description:`School Fees - ${w.term_name||"Current Term"}`,quantity:1,unit_price:w.total_amount,amount:w.total_amount}]);try{const ne=await F.get(`${ee}/finance.php?resource=payments&invoice_id=${w.id}`);E(ne.data.payments||[])}catch{E([])}}catch(oe){console.error("Error fetching invoice details:",oe),T([{description:`School Fees - ${w.term_name||"Current Term"}`,quantity:1,unit_price:w.total_amount,amount:w.total_amount}])}},V=async(w,oe="invoice")=>{U(w),se(oe),await O(w),$(!0)},re=()=>{const w=te.current;if(!w)return;const oe=window.open("","_blank");oe.document.write(`
      <!DOCTYPE html>
      <html>
      <head>
        <title>${P==="invoice"?"Invoice":"Receipt"} - ${v?.invoice_number}</title>
        <style>
          * { margin: 0; padding: 0; box-sizing: border-box; }
          body { font-family: 'Segoe UI', Arial, sans-serif; font-size: 12px; color: #333; }
          .print-container { max-width: 800px; margin: 0 auto; padding: 20px; }
          .header { text-align: center; border-bottom: 2px solid #1e40af; padding-bottom: 15px; margin-bottom: 20px; }
          .logo { max-height: 60px; margin-bottom: 10px; }
          .school-name { font-size: 24px; font-weight: bold; color: #1e40af; margin-bottom: 5px; }
          .school-details { font-size: 11px; color: #666; }
          .document-title { font-size: 20px; font-weight: bold; color: ${P==="receipt"?"#059669":"#1e40af"}; 
                           margin: 15px 0; text-transform: uppercase; letter-spacing: 2px; }
          .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
          .info-box { background: #f8fafc; padding: 15px; border-radius: 8px; border: 1px solid #e2e8f0; }
          .info-box h4 { font-size: 11px; color: #64748b; text-transform: uppercase; margin-bottom: 8px; }
          .info-box p { margin: 4px 0; }
          .info-box .value { font-weight: 600; }
          table { width: 100%; border-collapse: collapse; margin: 20px 0; }
          th { background: #1e40af; color: white; padding: 10px; text-align: left; font-size: 11px; text-transform: uppercase; }
          td { padding: 10px; border-bottom: 1px solid #e2e8f0; }
          tr:nth-child(even) { background: #f8fafc; }
          .totals { margin-top: 20px; }
          .totals-row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #e2e8f0; }
          .totals-row.total { font-size: 16px; font-weight: bold; border-top: 2px solid #1e40af; border-bottom: none; padding-top: 15px; }
          .totals-row.paid { color: #059669; }
          .totals-row.balance { color: #dc2626; }
          .status-badge { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 11px; font-weight: 600; }
          .status-paid { background: #dcfce7; color: #166534; }
          .status-partial { background: #dbeafe; color: #1e40af; }
          .status-pending { background: #fef3c7; color: #92400e; }
          .footer { margin-top: 30px; padding-top: 20px; border-top: 1px solid #e2e8f0; text-align: center; font-size: 10px; color: #64748b; }
          .payment-info { background: #ecfdf5; padding: 15px; border-radius: 8px; margin-top: 20px; border: 1px solid #a7f3d0; }
          .payment-info h4 { color: #059669; margin-bottom: 10px; }
          .watermark { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-45deg); 
                       font-size: 100px; color: rgba(0,0,0,0.03); font-weight: bold; z-index: -1; }
          @media print { 
            body { print-color-adjust: exact; -webkit-print-color-adjust: exact; }
            .no-print { display: none; }
          }
        </style>
      </head>
      <body>
        ${w.innerHTML}
      </body>
      </html>
    `),oe.document.close(),oe.focus(),setTimeout(()=>{oe.print(),oe.close()},250)},ge=m.filter(w=>{const oe=g==="all"||w.student_id==g,ne=f==="all"||w.status===f;return oe&&ne});ge.reduce((w,oe)=>w+parseFloat(oe.total_amount||0),0);const xe=ge.reduce((w,oe)=>w+parseFloat(oe.paid_amount||0),0),Z=ge.reduce((w,oe)=>w+parseFloat(oe.balance||0),0),I=w=>{const oe={paid:"bg-green-100 text-green-700 border-green-300",partial:"bg-blue-100 text-blue-700 border-blue-300",pending_payment:"bg-orange-100 text-orange-700 border-orange-300",approved:"bg-yellow-100 text-yellow-700 border-yellow-300",pending_approval:"bg-gray-100 text-gray-700 border-gray-300"};return oe[w]||oe.pending_approval},H=w=>w==="paid"?Mt:w==="partial"?Wt:ka,ae=w=>{U(w),M(!0)},k=w=>{t("/parent/payments",{state:{invoice:w}})},B=w=>{if(!w||w==="0000-00-00"||w==="null")return"N/A";try{const oe=new Date(w);return isNaN(oe.getTime())?"N/A":oe.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"N/A"}};return c?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Invoices"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"View and pay your children's school fees"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Kt,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Invoices"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ge.length})]})]})}),e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(Mt,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Paid"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["",xe.toLocaleString()]})]})]})}),e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(ka,{className:"w-6 h-6 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pending"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:["",Z.toLocaleString()]})]})]})})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Ko,{className:"w-5 h-5 text-gray-600"}),e.jsx("h2",{className:"text-lg font-semibold",children:"Filters"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Child"}),e.jsxs("select",{value:g,onChange:w=>N(w.target.value),className:"input",children:[e.jsx("option",{value:"all",children:"All Children"}),x.map(w=>e.jsxs("option",{value:w.id,children:[w.first_name," ",w.last_name]},w.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:f,onChange:w=>y(w.target.value),className:"input",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"partial",children:"Partially Paid"}),e.jsx("option",{value:"pending_payment",children:"Pending Payment"}),e.jsx("option",{value:"approved",children:"Approved"})]})]})]})]}),e.jsx("div",{className:"card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Invoice #"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Child"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Term"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Paid"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Balance"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Due Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:ge.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"px-6 py-12 text-center text-gray-500",children:"No invoices found"})}):ge.map((w,oe)=>{const ne=H(w.status);return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 font-mono text-sm",children:w.invoice_number}),e.jsx("td",{className:"px-6 py-4",children:w.student_name}),e.jsx("td",{className:"px-6 py-4",children:w.term_name}),e.jsxs("td",{className:"px-6 py-4 font-semibold",children:["",parseFloat(w.total_amount).toLocaleString()]}),e.jsxs("td",{className:"px-6 py-4 text-green-600",children:["",parseFloat(w.paid_amount||0).toLocaleString()]}),e.jsxs("td",{className:"px-6 py-4 text-orange-600 font-semibold",children:["",parseFloat(w.balance||0).toLocaleString()]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:`px-3 py-1 text-xs font-medium rounded-full border ${I(w.status)}`,children:[e.jsx(ne,{className:"w-3 h-3 inline mr-1"}),w.status.replace("_"," ")]})}),e.jsx("td",{className:"px-6 py-4",children:B(w.due_date)}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex gap-1 flex-wrap",children:[e.jsx("button",{onClick:()=>ae(w),className:"btn bg-gray-200 hover:bg-gray-300 text-sm p-2",title:"View Details",children:e.jsx(na,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>V(w,"invoice"),className:"btn bg-blue-100 hover:bg-blue-200 text-blue-700 text-sm p-2",title:"Print Invoice",children:e.jsx(Kt,{className:"w-4 h-4"})}),parseFloat(w.paid_amount||0)>0&&e.jsx("button",{onClick:()=>V(w,"receipt"),className:"btn bg-green-100 hover:bg-green-200 text-green-700 text-sm p-2",title:"Print Receipt",children:e.jsx(mh,{className:"w-4 h-4"})}),w.status!=="paid"&&parseFloat(w.balance)>0&&e.jsxs("button",{onClick:()=>k(w),className:"btn btn-primary text-sm",children:[e.jsx(aa,{className:"w-4 h-4"}),"Pay"]})]})})]},`invoice-${w.id}-${oe}`)})})]})})}),D&&v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Invoice Details"}),e.jsx("button",{onClick:()=>M(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Invoice Number"}),e.jsx("p",{className:"font-semibold",children:v.invoice_number})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Status"}),e.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full border ${I(v.status)}`,children:v.status.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Student"}),e.jsx("p",{className:"font-semibold",children:v.student_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Term"}),e.jsx("p",{className:"font-semibold",children:v.term_name})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Amount Details"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total Amount:"}),e.jsxs("span",{className:"font-semibold",children:["",parseFloat(v.total_amount).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Paid Amount:"}),e.jsxs("span",{className:"font-semibold text-green-600",children:["",parseFloat(v.paid_amount||0).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between text-lg",children:[e.jsx("span",{className:"font-semibold",children:"Balance:"}),e.jsxs("span",{className:"font-bold text-orange-600",children:["",parseFloat(v.balance||0).toLocaleString()]})]})]})]}),e.jsx("div",{className:"border-t pt-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Issue Date"}),e.jsx("p",{className:"font-semibold",children:B(v.issue_date)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Due Date"}),e.jsx("p",{className:"font-semibold",children:B(v.due_date)})]})]})})]}),e.jsxs("div",{className:"p-6 border-t bg-gray-50 flex justify-between",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>{M(!1),V(v,"invoice")},className:"btn bg-blue-100 hover:bg-blue-200 text-blue-700",children:[e.jsx(Kt,{className:"w-4 h-4"}),"Print Invoice"]}),parseFloat(v.paid_amount||0)>0&&e.jsxs("button",{onClick:()=>{M(!1),V(v,"receipt")},className:"btn bg-green-100 hover:bg-green-200 text-green-700",children:[e.jsx(mh,{className:"w-4 h-4"}),"Print Receipt"]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>M(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:"Close"}),v.status!=="paid"&&parseFloat(v.balance)>0&&e.jsxs("button",{onClick:()=>{M(!1),k(v)},className:"btn btn-primary",children:[e.jsx(aa,{className:"w-4 h-4"}),"Make Payment"]})]})]})]})}),K&&v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[95vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white p-4 border-b flex items-center justify-between z-10",children:[e.jsx("h2",{className:"text-xl font-semibold flex items-center gap-2",children:P==="invoice"?e.jsxs(e.Fragment,{children:[e.jsx(Kt,{className:"w-5 h-5 text-blue-600"})," Invoice Preview"]}):e.jsxs(e.Fragment,{children:[e.jsx(mh,{className:"w-5 h-5 text-green-600"})," Receipt Preview"]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:re,className:`btn ${P==="invoice"?"btn-primary":"bg-green-600 hover:bg-green-700 text-white"}`,children:[e.jsx(or,{className:"w-4 h-4"}),"Print ",P==="invoice"?"Invoice":"Receipt"]}),e.jsx("button",{onClick:()=>$(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:e.jsx(Nt,{className:"w-4 h-4"})})]})]}),e.jsx("div",{ref:te,className:"p-8",children:e.jsxs("div",{className:"print-container",children:[P==="receipt"&&e.jsx("div",{className:"watermark",children:"PAID"}),e.jsxs("div",{className:"header text-center border-b-2 border-blue-800 pb-4 mb-6",children:[z?.school_logo&&e.jsx("img",{src:z.school_logo,alt:"School Logo",className:"logo h-16 mx-auto mb-2"}),e.jsx("h1",{className:"school-name text-2xl font-bold text-blue-800",children:z?.school_name||"School Name"}),e.jsxs("div",{className:"school-details text-sm text-gray-600 mt-1",children:[e.jsx("p",{children:z?.school_address||"School Address"}),e.jsxs("p",{children:[z?.school_phone&&`Tel: ${z.school_phone}`,z?.school_phone&&z?.school_email&&" | ",z?.school_email&&`Email: ${z.school_email}`]}),z?.school_website&&e.jsxs("p",{children:["Website: ",z.school_website]})]})]}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:`document-title text-xl font-bold uppercase tracking-wider ${P==="receipt"?"text-green-600":"text-blue-800"}`,children:P==="invoice"?"INVOICE":"PAYMENT RECEIPT"}),e.jsxs("p",{className:"text-gray-500 text-sm",children:[P==="invoice"?"Invoice":"Receipt"," #: ",v.invoice_number]})]}),e.jsxs("div",{className:"info-grid grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"info-box bg-gray-50 p-4 rounded-lg border",children:[e.jsx("h4",{className:"text-xs text-gray-500 uppercase font-semibold mb-2",children:"Student Information"}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-600",children:"Name:"})," ",e.jsx("span",{className:"value font-semibold",children:v.student_name})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-600",children:"Student ID:"})," ",e.jsx("span",{className:"value font-semibold",children:v.student_code})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-600",children:"Class:"})," ",e.jsx("span",{className:"value font-semibold",children:v.class_name})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-600",children:"Term:"})," ",e.jsx("span",{className:"value font-semibold",children:v.term_name})]})]}),e.jsxs("div",{className:"info-box bg-gray-50 p-4 rounded-lg border",children:[e.jsxs("h4",{className:"text-xs text-gray-500 uppercase font-semibold mb-2",children:[P==="invoice"?"Invoice":"Receipt"," Details"]}),e.jsxs("p",{children:[e.jsxs("span",{className:"text-gray-600",children:[P==="invoice"?"Invoice":"Receipt"," No:"]})," ",e.jsx("span",{className:"value font-semibold",children:v.invoice_number})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-600",children:"Date:"})," ",e.jsx("span",{className:"value font-semibold",children:B(v.created_at)||B(new Date)})]}),P==="invoice"&&v.due_date&&e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-600",children:"Due Date:"})," ",e.jsx("span",{className:"value font-semibold",children:B(v.due_date)})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-600",children:"Status:"}),e.jsx("span",{className:`status-badge ml-2 px-2 py-1 rounded-full text-xs font-semibold ${v.status==="paid"?"bg-green-100 text-green-700":v.status==="partial"?"bg-blue-100 text-blue-700":"bg-yellow-100 text-yellow-700"}`,children:v.status.replace("_"," ").toUpperCase()})]})]})]}),e.jsxs("table",{className:"w-full border-collapse mb-6",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-blue-800 text-white",children:[e.jsx("th",{className:"p-3 text-left text-xs uppercase",children:"#"}),e.jsx("th",{className:"p-3 text-left text-xs uppercase",children:"Description"}),e.jsx("th",{className:"p-3 text-center text-xs uppercase",children:"Qty"}),e.jsx("th",{className:"p-3 text-right text-xs uppercase",children:"Unit Price"}),e.jsx("th",{className:"p-3 text-right text-xs uppercase",children:"Amount"})]})}),e.jsx("tbody",{children:j.map((w,oe)=>e.jsxs("tr",{className:oe%2===0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"p-3 border-b",children:oe+1}),e.jsx("td",{className:"p-3 border-b",children:w.description||w.item_name||"School Fees"}),e.jsx("td",{className:"p-3 border-b text-center",children:w.quantity||1}),e.jsxs("td",{className:"p-3 border-b text-right",children:["GHS ",parseFloat(w.unit_price||w.amount).toLocaleString()]}),e.jsxs("td",{className:"p-3 border-b text-right font-semibold",children:["GHS ",parseFloat(w.amount).toLocaleString()]})]},oe))})]}),e.jsxs("div",{className:"totals max-w-sm ml-auto",children:[e.jsxs("div",{className:"totals-row flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Subtotal:"}),e.jsxs("span",{className:"font-semibold",children:["GHS ",parseFloat(v.total_amount).toLocaleString()]})]}),e.jsxs("div",{className:"totals-row paid flex justify-between py-2 border-b text-green-600",children:[e.jsx("span",{children:"Amount Paid:"}),e.jsxs("span",{className:"font-semibold",children:["GHS ",parseFloat(v.paid_amount||0).toLocaleString()]})]}),e.jsxs("div",{className:"totals-row total flex justify-between py-3 border-t-2 border-blue-800 mt-2",children:[e.jsx("span",{className:"font-bold text-lg",children:P==="receipt"?"Total Paid:":"Balance Due:"}),e.jsxs("span",{className:`font-bold text-lg ${P==="receipt"?"text-green-600":"text-red-600"}`,children:["GHS ",P==="receipt"?parseFloat(v.paid_amount||0).toLocaleString():parseFloat(v.balance||0).toLocaleString()]})]})]}),P==="receipt"&&Q.length>0&&e.jsxs("div",{className:"payment-info bg-green-50 p-4 rounded-lg mt-6 border border-green-200",children:[e.jsx("h4",{className:"text-green-700 font-semibold mb-3",children:"Payment History"}),e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-green-200",children:[e.jsx("th",{className:"py-2 text-left",children:"Date"}),e.jsx("th",{className:"py-2 text-left",children:"Reference"}),e.jsx("th",{className:"py-2 text-left",children:"Method"}),e.jsx("th",{className:"py-2 text-right",children:"Amount"})]})}),e.jsx("tbody",{children:Q.map((w,oe)=>e.jsxs("tr",{className:"border-b border-green-100",children:[e.jsx("td",{className:"py-2",children:B(w.payment_date)}),e.jsx("td",{className:"py-2",children:w.reference_number||w.payment_number}),e.jsx("td",{className:"py-2 capitalize",children:w.payment_method}),e.jsxs("td",{className:"py-2 text-right font-semibold",children:["GHS ",parseFloat(w.amount).toLocaleString()]})]},oe))})]})]}),e.jsxs("div",{className:"footer mt-8 pt-4 border-t text-center text-xs text-gray-500",children:[e.jsx("p",{className:"mb-1",children:"Thank you for your payment. For any inquiries, please contact the school office."}),e.jsxs("p",{children:["This is a computer-generated ",P==="invoice"?"invoice":"receipt"," and does not require a signature."]}),e.jsxs("p",{className:"mt-2 text-gray-400",children:["Generated on ",new Date().toLocaleString()]})]})]})})]})})]})}const iH=Th((t,s)=>({balance:0,transactions:[],loading:!1,error:null,walletId:null,fetchWallet:async a=>{if(a){t({loading:!0,error:null});try{const r=await F.get(`${ee}/wallet.php?action=get_balance&user_id=${a}`);return r.data.success?(t({balance:r.data.wallet.balance,walletId:r.data.wallet.id,transactions:r.data.transactions.map(l=>({id:l.id,type:l.type,amount:parseFloat(l.amount),description:l.description,reference:l.reference,date:l.created_at,balanceBefore:parseFloat(l.balance_before),balanceAfter:parseFloat(l.balance_after)})),loading:!1}),r.data.wallet.balance):(t({error:r.data.error,loading:!1}),0)}catch(r){return console.error("Error fetching wallet:",r),t({error:"Failed to fetch wallet",loading:!1}),0}}},setBalance:a=>t({balance:a}),addFunds:async(a,r,l="online",c="Wallet Top-up")=>{if(!a||r<=0)return!1;t({loading:!0,error:null});try{const o=await F.post(`${ee}/wallet.php?action=top_up`,{user_id:a,amount:parseFloat(r),payment_method:l,description:c});return o.data.success?(await s().fetchWallet(a),{success:!0,reference:o.data.reference,balance:o.data.balance}):(t({error:o.data.error,loading:!1}),{success:!1,error:o.data.error})}catch(o){return console.error("Error adding funds:",o),t({error:"Failed to add funds",loading:!1}),{success:!1,error:"Failed to add funds"}}},deductFunds:async(a,r,l="Payment",c=null)=>{if(!a||r<=0)return{success:!1,error:"Invalid parameters"};if(s().balance<parseFloat(r))return{success:!1,error:"Insufficient balance"};t({loading:!0,error:null});try{const m=await F.post(`${ee}/wallet.php?action=deduct`,{user_id:a,amount:parseFloat(r),description:l,invoice_id:c});return m.data.success?(await s().fetchWallet(a),{success:!0,reference:m.data.reference,balance:m.data.balance}):(t({error:m.data.error,loading:!1}),{success:!1,error:m.data.error})}catch(m){return console.error("Error deducting funds:",m),t({error:"Failed to process payment",loading:!1}),{success:!1,error:"Failed to process payment"}}},getTransactions:()=>s().transactions,clearError:()=>t({error:null}),reset:()=>t({balance:0,transactions:[],walletId:null,error:null})}));function cH(){const t=di(),s=la(),{user:a}=Us(),{balance:r,addFunds:l,deductFunds:c,transactions:o,fetchWallet:m,loading:u}=iH(),{recordPayment:x}=S_(),[A,g]=h.useState(!1),[N,f]=h.useState(!1),[y,v]=h.useState(!1),[U,D]=h.useState("wallet"),[M,K]=h.useState(""),[$,P]=h.useState(""),[se,z]=h.useState(null),[R,j]=h.useState(!1);h.useEffect(()=>{a?.id&&T(),t.state?.invoice&&(z(t.state.invoice),K(t.state.invoice.balance),f(!0))},[t,a?.id]);const T=async()=>{try{g(!0),await m(a.id)}catch(V){console.error("Error fetching wallet data:",V)}finally{g(!1)}},Q=async V=>{try{if(j(!0),await new Promise(re=>setTimeout(re,2e3)),se)x(se.id,V,"hubtel"),alert(`Payment of GHS ${V} for Invoice ${se.invoice_number} successful!`),f(!1),s("/parent/invoices",{state:{paymentSuccess:!0,paidInvoiceId:se.id,paidAmount:V}});else{const re=await l(a.id,V,"hubtel","Wallet Top-up via Hubtel");re.success?(alert(`Wallet topped up successfully!

Amount: GHS ${V}
Reference: ${re.reference}
New Balance: GHS ${re.balance.toLocaleString()}`),v(!1),P("")):alert(`Top-up failed: ${re.error}`)}}catch(re){console.error("Error initiating payment:",re),alert("Payment initiation failed. Please try again.")}finally{j(!1)}},E=async()=>{if(!se)return;const V=parseFloat(M);if(V>r){alert("Insufficient wallet balance. Please top up your wallet first.");return}try{j(!0);const re=await c(a.id,V,`Payment for Invoice ${se.invoice_number}`,se.id);if(!re.success){alert(re.error||"Payment failed. Please try again.");return}x(se.id,V,"wallet"),alert(`Payment successful!

Amount: GHS ${V}
Invoice: ${se.invoice_number}
Reference: ${re.reference}
New Balance: GHS ${re.balance.toLocaleString()}`),f(!1),s("/parent/invoices",{state:{paymentSuccess:!0,paidInvoiceId:se.id,paidAmount:V}})}catch(re){console.error("Error processing payment:",re),alert("Payment processing failed. Please try again.")}finally{j(!1)}},te=async()=>{const V=parseFloat($);if(V<10){alert("Minimum top-up amount is 10");return}await Q(V)},C=async()=>{U==="wallet"?await E():await Q(parseFloat(M))},O=[100,500,1e3,5e3,1e4];return A?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Payments & Wallet"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage payments and wallet balance"})]}),e.jsxs("button",{onClick:()=>v(!0),className:"btn btn-primary",children:[e.jsx(qt,{className:"w-4 h-4"}),"Top Up Wallet"]})]}),e.jsx("div",{className:"card p-8 bg-gradient-to-br from-blue-600 to-blue-800 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Xc,{className:"w-6 h-6"}),e.jsx("p",{className:"text-blue-100",children:"Wallet Balance"})]}),e.jsxs("p",{className:"text-4xl font-bold",children:["",r.toLocaleString()]}),e.jsx("p",{className:"text-blue-100 mt-2",children:"Available for payments"})]}),e.jsx("div",{className:"text-right",children:e.jsxs("button",{onClick:()=>v(!0),className:"btn bg-white text-blue-600 hover:bg-blue-50",children:[e.jsx(qt,{className:"w-4 h-4"}),"Add Funds"]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(Mt,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Spent"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["",o.filter(V=>V.type==="debit").reduce((V,re)=>V+parseFloat(re.amount||0),0).toLocaleString()]})]})]})}),e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Sa,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Transactions"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.length})]})]})}),e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx($s,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"This Month"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["",o.filter(V=>V.type==="debit"&&new Date(V.date).getMonth()===new Date().getMonth()).reduce((V,re)=>V+parseFloat(re.amount||0),0).toLocaleString()]})]})]})})]}),e.jsxs("div",{className:"card overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsx("h2",{className:"text-lg font-semibold",children:"Payment History"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Reference"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Method"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y",children:o.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-12 text-center text-gray-500",children:u?"Loading transactions...":"No transaction history yet"})}):o.map(V=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:new Date(V.date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 font-mono text-sm",children:V.reference}),e.jsx("td",{className:"px-6 py-4",children:V.description}),e.jsx("td",{className:"px-6 py-4 capitalize",children:V.type==="credit"?"Top-up":"Payment"}),e.jsxs("td",{className:`px-6 py-4 font-semibold ${V.type==="credit"?"text-green-600":"text-red-600"}`,children:[V.type==="credit"?"+":"-","GHS ",parseFloat(V.amount).toLocaleString()]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:"px-3 py-1 text-xs font-medium rounded-full bg-green-100 text-green-700",children:[e.jsx(Mt,{className:"w-3 h-3 inline mr-1"}),"Completed"]})})]},V.id))})]})})]}),N&&se&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsx("h2",{className:"text-2xl font-semibold",children:"Make Payment"})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Invoice"}),e.jsx("p",{className:"font-semibold",children:se.invoice_number}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Student"}),e.jsx("p",{className:"font-semibold",children:se.student_name}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Balance Due"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:["",parseFloat(se.balance).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Amount"}),e.jsx("input",{type:"number",value:M,onChange:V=>K(V.target.value),max:se.balance,className:"input",placeholder:"Enter amount"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Method"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center p-4 border-2 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"paymentMethod",value:"wallet",checked:U==="wallet",onChange:V=>D(V.target.value),className:"mr-3"}),e.jsx(Xc,{className:"w-5 h-5 mr-2 text-blue-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:"Wallet Balance"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Available: ",r.toLocaleString()]})]})]}),e.jsxs("label",{className:"flex items-center p-4 border-2 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"paymentMethod",value:"hubtel",checked:U==="hubtel",onChange:V=>D(V.target.value),className:"mr-3"}),e.jsx(aa,{className:"w-5 h-5 mr-2 text-green-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:"Mobile Money / Card"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Pay via Hubtel"})]})]})]})]}),U==="wallet"&&parseFloat(M)>r&&e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ka,{className:"w-5 h-5 text-orange-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-orange-900",children:"Insufficient Balance"}),e.jsx("p",{className:"text-sm text-orange-700 mt-1",children:"Please top up your wallet or choose another payment method."})]})]})})]}),e.jsxs("div",{className:"p-6 border-t bg-gray-50 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>f(!1),className:"btn bg-gray-200 hover:bg-gray-300",disabled:R,children:"Cancel"}),e.jsx("button",{onClick:C,disabled:R||!M||parseFloat(M)<=0,className:"btn btn-primary",children:R?e.jsxs(e.Fragment,{children:[e.jsx(Wt,{className:"w-4 h-4 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Pl,{className:"w-4 h-4"}),"Pay ",parseFloat(M||0).toLocaleString()]})})]})]})}),y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full",children:[e.jsxs("div",{className:"p-6 border-b",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Top Up Wallet"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Add funds to your wallet for easy payments"})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Current Balance"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["",r.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quick Select"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:O.map(V=>e.jsxs("button",{onClick:()=>P(V.toString()),className:`p-3 border-2 rounded-lg font-semibold transition-colors ${$===V.toString()?"border-blue-600 bg-blue-50 text-blue-600":"border-gray-200 hover:border-blue-300"}`,children:["",V]},V))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Or Enter Custom Amount"}),e.jsx("input",{type:"number",value:$,onChange:V=>P(V.target.value),min:"10",className:"input",placeholder:"Enter amount (min 10)"})]}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(aa,{className:"w-5 h-5 text-gray-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Secure Payment via Hubtel"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Pay with Mobile Money, Visa, or Mastercard"})]})]})})]}),e.jsxs("div",{className:"p-6 border-t bg-gray-50 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>{v(!1),P("")},className:"btn bg-gray-200 hover:bg-gray-300",disabled:R,children:"Cancel"}),e.jsx("button",{onClick:te,disabled:R||!$||parseFloat($)<10,className:"btn btn-primary",children:R?e.jsxs(e.Fragment,{children:[e.jsx(Wt,{className:"w-4 h-4 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(qt,{className:"w-4 h-4"}),"Add ",parseFloat($||0).toLocaleString()]})})]})]})})]})}function oH(){return e.jsx(By,{userType:"parent"})}function dH(){const{user:t}=Us(),[s,a]=h.useState("profile"),[r,l]=h.useState({first_name:t?.first_name||"",last_name:t?.last_name||"",email:t?.email||"",phone:t?.phone||"",current_password:"",new_password:"",confirm_password:""}),c=()=>{alert("Settings saved successfully!")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Settings"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your account settings and preferences"})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"border-b",children:e.jsxs("div",{className:"flex gap-4 px-6",children:[e.jsxs("button",{onClick:()=>a("profile"),className:`py-4 px-4 border-b-2 font-medium ${s==="profile"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:[e.jsx(ha,{className:"w-4 h-4 inline mr-2"}),"Profile"]}),e.jsxs("button",{onClick:()=>a("password"),className:`py-4 px-4 border-b-2 font-medium ${s==="password"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:[e.jsx(Ui,{className:"w-4 h-4 inline mr-2"}),"Password"]}),e.jsxs("button",{onClick:()=>a("notifications"),className:`py-4 px-4 border-b-2 font-medium ${s==="notifications"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:[e.jsx(nl,{className:"w-4 h-4 inline mr-2"}),"Notifications"]})]})}),e.jsxs("div",{className:"p-6",children:[s==="profile"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name"}),e.jsx("input",{type:"text",value:r.first_name,onChange:o=>l({...r,first_name:o.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name"}),e.jsx("input",{type:"text",value:r.last_name,onChange:o=>l({...r,last_name:o.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx("input",{type:"email",value:r.email,onChange:o=>l({...r,email:o.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),e.jsx("input",{type:"tel",value:r.phone,onChange:o=>l({...r,phone:o.target.value}),className:"input"})]})]}),e.jsxs("button",{onClick:c,className:"btn btn-primary",children:[e.jsx(Br,{className:"w-4 h-4"}),"Save Changes"]})]}),s==="password"&&e.jsxs("div",{className:"space-y-6 max-w-md",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Password"}),e.jsx("input",{type:"password",value:r.current_password,onChange:o=>l({...r,current_password:o.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),e.jsx("input",{type:"password",value:r.new_password,onChange:o=>l({...r,new_password:o.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password"}),e.jsx("input",{type:"password",value:r.confirm_password,onChange:o=>l({...r,confirm_password:o.target.value}),className:"input"})]}),e.jsxs("button",{onClick:c,className:"btn btn-primary",children:[e.jsx(Br,{className:"w-4 h-4"}),"Update Password"]})]}),s==="notifications"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Email Notifications"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Receive email updates about your children"})]}),e.jsx("input",{type:"checkbox",className:"toggle",defaultChecked:!0})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"SMS Notifications"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Receive SMS alerts for important updates"})]}),e.jsx("input",{type:"checkbox",className:"toggle",defaultChecked:!0})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Payment Reminders"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Get reminders for upcoming payments"})]}),e.jsx("input",{type:"checkbox",className:"toggle",defaultChecked:!0})]}),e.jsxs("button",{onClick:c,className:"btn btn-primary",children:[e.jsx(Br,{className:"w-4 h-4"}),"Save Preferences"]})]})]})]})]})}function mH(){const{user:t}=Us(),[s,a]=h.useState([]),[r,l]=h.useState(null),[c,o]=h.useState([]),[m,u]=h.useState(!0),[x,A]=h.useState("all"),[g,N]=h.useState(null);h.useEffect(()=>{f()},[t?.id]),h.useEffect(()=>{r&&y(r.id)},[r]);const f=async()=>{try{const se=(await F.get(`${ee}/students.php?parent_id=${t?.id}`)).data.students||[];a(se),se.length>0&&l(se[0])}catch(P){console.error("Error fetching children:",P)}finally{u(!1)}},y=async P=>{try{u(!0);const se=await F.get(`${ee}/homework.php?action=student_homework&student_id=${P}`);o(se.data.homework||[])}catch(se){console.error("Error fetching homework:",se),o([])}finally{u(!1)}},v=(P,se)=>P==="submitted"||P==="graded"?"bg-green-100 text-green-700":new Date(se)<new Date?"bg-red-100 text-red-700":"bg-orange-100 text-orange-700",U=(P,se)=>P==="submitted"?"Submitted":P==="graded"?"Graded":new Date(se)<new Date?"Overdue":"Pending",D=c.filter(P=>x==="all"?!0:x==="pending"?P.status==="pending"&&new Date(P.due_date)>=new Date:x==="submitted"?P.status==="submitted"||P.status==="graded":x==="overdue"?P.status==="pending"&&new Date(P.due_date)<new Date:!0),M={total:c.length,pending:c.filter(P=>P.status==="pending"&&new Date(P.due_date)>=new Date).length,submitted:c.filter(P=>P.status==="submitted"||P.status==="graded").length,overdue:c.filter(P=>P.status==="pending"&&new Date(P.due_date)<new Date).length},K=P=>new Date(P).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),$=P=>{const se=Math.ceil((new Date(P)-new Date)/864e5);return se<0?`${Math.abs(se)} days overdue`:se===0?"Due today":se===1?"Due tomorrow":`${se} days left`};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(as,{className:"w-7 h-7 text-blue-600"}),"Child Homework"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Track your children's homework assignments"})]})}),s.length>1&&e.jsxs("div",{className:"card p-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Child"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:s.map(P=>e.jsxs("button",{onClick:()=>l(P),className:`px-4 py-2 rounded-lg flex items-center gap-2 transition-colors ${r?.id===P.id?"bg-blue-600 text-white":"bg-gray-100 hover:bg-gray-200"}`,children:[e.jsx(ha,{className:"w-4 h-4"}),P.first_name," ",P.last_name]},P.id))})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"card p-4 cursor-pointer hover:shadow-md",onClick:()=>A("all"),children:[e.jsx(as,{className:"w-8 h-8 text-blue-600 mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Total"}),e.jsx("p",{className:"text-2xl font-bold",children:M.total})]}),e.jsxs("div",{className:"card p-4 cursor-pointer hover:shadow-md",onClick:()=>A("pending"),children:[e.jsx(Wt,{className:"w-8 h-8 text-orange-600 mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold",children:M.pending})]}),e.jsxs("div",{className:"card p-4 cursor-pointer hover:shadow-md",onClick:()=>A("submitted"),children:[e.jsx(Mt,{className:"w-8 h-8 text-green-600 mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Submitted"}),e.jsx("p",{className:"text-2xl font-bold",children:M.submitted})]}),e.jsxs("div",{className:"card p-4 cursor-pointer hover:shadow-md",onClick:()=>A("overdue"),children:[e.jsx(ka,{className:"w-8 h-8 text-red-600 mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Overdue"}),e.jsx("p",{className:"text-2xl font-bold",children:M.overdue})]})]}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[e.jsx(Ko,{className:"w-5 h-5 text-gray-500"}),["all","pending","submitted","overdue"].map(P=>e.jsx("button",{onClick:()=>A(P),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${x===P?"bg-blue-600 text-white":"bg-gray-100 hover:bg-gray-200"}`,children:P.charAt(0).toUpperCase()+P.slice(1)},P))]})}),e.jsx("div",{className:"card overflow-hidden",children:m?e.jsx("div",{className:"p-8 text-center",children:e.jsx(hs,{className:"w-8 h-8 animate-spin mx-auto text-blue-600"})}):D.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(as,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No homework found"}),e.jsx("p",{className:"text-gray-500 mt-1",children:x==="all"?"No homework assignments yet":`No ${x} homework`})]}):e.jsx("div",{className:"divide-y",children:D.map(P=>e.jsx("div",{onClick:()=>N(P),className:"p-4 hover:bg-gray-50 cursor-pointer transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${v(P.status,P.due_date)}`,children:U(P.status,P.due_date)}),e.jsx("span",{className:"text-sm text-gray-500",children:P.subject})]}),e.jsx("h3",{className:"font-medium text-gray-900",children:P.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:P.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-3 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ot,{className:"w-4 h-4"}),"Due: ",K(P.due_date)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ha,{className:"w-4 h-4"}),P.teacher_name]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:`text-sm font-medium ${P.status==="pending"&&new Date(P.due_date)<new Date?"text-red-600":P.status==="submitted"?"text-green-600":"text-orange-600"}`,children:$(P.due_date)}),P.grade&&e.jsxs("p",{className:"text-lg font-bold text-green-600 mt-1",children:["Grade: ",P.grade]})]})]})},P.id))})}),g&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${v(g.status,g.due_date)}`,children:U(g.status,g.due_date)}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mt-2",children:g.title}),e.jsx("p",{className:"text-gray-500",children:g.subject})]}),e.jsx("button",{onClick:()=>N(null),className:"text-gray-400 hover:text-gray-600",children:""})]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("p",{className:"text-gray-600",children:g.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Assigned Date"}),e.jsx("p",{className:"font-medium",children:K(g.assigned_date)})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Due Date"}),e.jsx("p",{className:"font-medium",children:K(g.due_date)})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Teacher"}),e.jsx("p",{className:"font-medium",children:g.teacher_name})]}),g.grade&&e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Grade"}),e.jsx("p",{className:"font-bold text-green-600 text-xl",children:g.grade})]})]}),g.submitted_date&&e.jsx("div",{className:"bg-green-50 border border-green-200 p-4 rounded-lg",children:e.jsxs("p",{className:"text-sm text-green-800",children:[e.jsx(Mt,{className:"w-4 h-4 inline mr-2"}),"Submitted on ",K(g.submitted_date)]})}),g.feedback&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Teacher Feedback"}),e.jsx("p",{className:"text-gray-600 bg-blue-50 p-4 rounded-lg",children:g.feedback})]})]})]})})]})}function uH(){const{user:t}=Us(),[s,a]=h.useState([]),[r,l]=h.useState(null),[c,o]=h.useState([]),[m,u]=h.useState([]),[x,A]=h.useState(!0),[g,N]=h.useState("academics"),[f,y]=h.useState(""),[v,U]=h.useState([]),[D,M]=h.useState(null);h.useEffect(()=>{K(),$()},[t?.id]),h.useEffect(()=>{r&&f&&(P(r.id,f),se(r.id))},[r,f]);const K=async()=>{try{const E=(await F.get(`${ee}/students.php?parent_id=${t?.id}`)).data.students||[];a(E),E.length>0&&l(E[0])}catch(Q){console.error("Error fetching children:",Q)}},$=async()=>{try{const E=(await F.get(`${ee}/terms.php`)).data.terms||[];U(E);const te=E.find(C=>C.is_active==1||C.status==="active")||E[0];te&&y(te.id)}catch(Q){console.error("Error fetching terms:",Q),U([])}},P=async(Q,E)=>{try{A(!0);const te=await F.get(`${ee}/grades.php?student_id=${Q}&term_id=${E}`);o(te.data.grades||[])}catch(te){console.error("Error fetching results:",te),o([])}finally{A(!1)}},se=async Q=>{try{const E=await F.get(`${ee}/activities.php?student_id=${Q}`);u(E.data.activities||[])}catch(E){console.error("Error fetching activities:",E),u([])}},z=Q=>Q.startsWith("A")?"text-green-600 bg-green-100":Q.startsWith("B")?"text-blue-600 bg-blue-100":Q.startsWith("C")?"text-yellow-600 bg-yellow-100":Q.startsWith("D")?"text-orange-600 bg-orange-100":"text-red-600 bg-red-100",j=(()=>{if(c.length===0)return{average:0,grade:"-",position:"-"};const Q=c.reduce((C,O)=>C+O.total,0),E=Math.round(Q/c.length);let te="F";return E>=90?te="A+":E>=80?te="A":E>=75?te="B+":E>=70?te="B":E>=65?te="B-":E>=60?te="C+":E>=55?te="C":E>=50&&(te="D"),{average:E,grade:te,position:c[0]?.overall_position||"-"}})(),T=Q=>e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(E=>e.jsx(sl,{className:`w-4 h-4 ${E<=Q?"text-yellow-400 fill-yellow-400":"text-gray-300"}`},E))});return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Is,{className:"w-7 h-7 text-blue-600"}),"Child Results & Performance"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"View academic results and activity performance"})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.length>1&&e.jsxs("div",{className:"flex-1 min-w-[200px]",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Child"}),e.jsx("select",{value:r?.id||"",onChange:Q=>l(s.find(E=>E.id==Q.target.value)),className:"input",children:s.map(Q=>e.jsxs("option",{value:Q.id,children:[Q.first_name," ",Q.last_name]},Q.id))})]}),e.jsxs("div",{className:"flex-1 min-w-[200px]",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Term"}),e.jsx("select",{value:f,onChange:Q=>y(Q.target.value),className:"input",children:v.map(Q=>e.jsxs("option",{value:Q.id,children:[Q.term_name||Q.name," ",(Q.is_active==1||Q.is_current)&&"(Current)"]},Q.id))})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"card p-6 bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:[e.jsx(mS,{className:"w-8 h-8 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Average Score"}),e.jsxs("p",{className:"text-3xl font-bold",children:[j.average,"%"]})]}),e.jsxs("div",{className:"card p-6 bg-gradient-to-br from-green-500 to-green-600 text-white",children:[e.jsx(Is,{className:"w-8 h-8 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Overall Grade"}),e.jsx("p",{className:"text-3xl font-bold",children:j.grade})]}),e.jsxs("div",{className:"card p-6 bg-gradient-to-br from-purple-500 to-purple-600 text-white",children:[e.jsx(Ln,{className:"w-8 h-8 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Class Position"}),e.jsx("p",{className:"text-3xl font-bold",children:j.position})]}),e.jsxs("div",{className:"card p-6 bg-gradient-to-br from-orange-500 to-orange-600 text-white",children:[e.jsx(as,{className:"w-8 h-8 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Subjects"}),e.jsx("p",{className:"text-3xl font-bold",children:c.length})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>N("academics"),className:`px-6 py-3 rounded-lg font-medium transition-colors ${g==="academics"?"bg-blue-600 text-white":"bg-gray-100 hover:bg-gray-200"}`,children:[e.jsx(as,{className:"w-4 h-4 inline mr-2"}),"Academic Results"]}),e.jsxs("button",{onClick:()=>N("activities"),className:`px-6 py-3 rounded-lg font-medium transition-colors ${g==="activities"?"bg-blue-600 text-white":"bg-gray-100 hover:bg-gray-200"}`,children:[e.jsx(sl,{className:"w-4 h-4 inline mr-2"}),"Activities & Skills"]})]}),g==="academics"?e.jsx("div",{className:"card overflow-hidden",children:x?e.jsx("div",{className:"p-8 text-center",children:e.jsx(hs,{className:"w-8 h-8 animate-spin mx-auto text-blue-600"})}):c.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(Is,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No results available"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Results for this term have not been published yet"})]}):e.jsx("div",{className:"divide-y",children:c.map(Q=>e.jsxs("div",{children:[e.jsx("div",{onClick:()=>M(D===Q.id?null:Q.id),className:"p-4 hover:bg-gray-50 cursor-pointer transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${z(Q.grade)}`,children:e.jsx("span",{className:"font-bold text-lg",children:Q.grade})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:Q.subject}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Position: ",Q.position," | Class Avg: ",Q.class_average,"%"]})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[Q.total,"%"]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["CA: ",Q.class_score," | Exam: ",Q.exam_score]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[Q.total>Q.class_average?e.jsx($s,{className:"w-5 h-5 text-green-600"}):e.jsx(gc,{className:"w-5 h-5 text-red-600"}),D===Q.id?e.jsx(jl,{className:"w-5 h-5 text-gray-400"}):e.jsx(un,{className:"w-5 h-5 text-gray-400"})]})]})]})}),D===Q.id&&e.jsx("div",{className:"px-4 pb-4 bg-gray-50",children:e.jsxs("div",{className:"p-4 bg-white rounded-lg border",children:[Q.assessments&&Q.assessments.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Assessment Breakdown"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:Q.assessments.map((E,te)=>e.jsxs("div",{className:"bg-gray-50 p-2 rounded text-center",children:[e.jsx("p",{className:"text-xs text-gray-500",children:E.name}),e.jsxs("p",{className:"font-medium",children:[E.score,"/",E.max]})]},te))})]}),Q.remarks&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"Teacher's Remarks"}),e.jsxs("p",{className:"text-sm text-gray-600 italic",children:['"',Q.remarks,'"']})]})]})})]},Q.id))})}):e.jsx("div",{className:"card overflow-hidden",children:m.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(sl,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No activities recorded"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Activity performance will appear here"})]}):e.jsx("div",{className:"divide-y",children:m.map(Q=>e.jsx("div",{className:"p-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:Q.name}),e.jsx("p",{className:"text-sm text-gray-500",children:Q.category})]}),e.jsxs("div",{className:"text-right",children:[T(Q.rating),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:Q.remarks})]})]})},Q.id))})})]})}function p1(){la();const{user:t}=Us(),[s,a]=h.useState(!0),[r,l]=h.useState("overview"),[c,o]=h.useState(null),[m,u]=h.useState(!1),[x,A]=h.useState(!1),[g,N]=h.useState(!1),[f,y]=h.useState(null),[v,U]=h.useState({subject:"",message:""}),[D,M]=h.useState([]),[K,$]=h.useState([]),[P,se]=h.useState([]),[z,R]=h.useState([]),[j,T]=h.useState({records:[],summary:{}}),[Q,E]=h.useState([]),[te,C]=h.useState({invoices:[],payments:[],summary:{}}),[O,V]=h.useState([]),[re,ge]=h.useState([]),[xe,Z]=h.useState([]),[I,H]=h.useState([]),[ae,k]=h.useState([]),[B,w]=h.useState(new Date),[oe,ne]=h.useState({teacher_id:"",subject:"",message:"",preferred_date:"",preferred_time:""});h.useEffect(()=>{t?.id&&Fe()},[t?.id]),h.useEffect(()=>{c&&je(c.child_id||c.student_id)},[c]);const Fe=async()=>{try{a(!0);const ve=await F.get(`${ee}/parent_portal.php?resource=dashboard&parent_id=${t.id}`);if(ve.data.success&&ve.data.dashboard){const ie=ve.data.dashboard;se(ie.children||[]),Z(ie.recent_notifications||[]),V(ie.upcoming_events||[]),ie.children?.length>0&&o(ie.children[0])}}catch(ve){console.error("Error fetching dashboard:",ve)}finally{a(!1)}},je=async ve=>{try{const[ie,q,pe,Me,Se,Ne,et]=await Promise.all([F.get(`${ee}/parent_portal.php?resource=homework&student_id=${ve}`).catch(()=>({data:{homework:[]}})),F.get(`${ee}/parent_portal.php?resource=attendance&student_id=${ve}`).catch(()=>({data:{records:[],summary:{}}})),F.get(`${ee}/parent_portal.php?resource=grades&student_id=${ve}`).catch(()=>({data:{grades:[]}})),F.get(`${ee}/parent_portal.php?resource=teachers&student_id=${ve}`).catch(()=>({data:{teachers:[]}})),F.get(`${ee}/parent_portal.php?resource=report_cards&student_id=${ve}`).catch(()=>({data:{report_cards:[]}})),F.get(`${ee}/parent_portal.php?resource=fees&parent_id=${t.id}&student_id=${ve}`).catch(()=>({data:{invoices:[],payments:[]}})),F.get(`${ee}/parent_portal.php?resource=meetings&parent_id=${t.id}`).catch(()=>({data:{meetings:[]}}))]);R(ie.data.homework||[]),T(q.data||{records:[],summary:{}});const Ce=pe.data.grades||[];E(Ce),H(Me.data.teachers||[]),k(Se.data.report_cards||[]),C(Ne.data||{invoices:[],payments:[]}),ge(et.data.meetings||[]),Ge(Ce),ze(Ce)}catch(ie){console.error("Error fetching child data:",ie)}},Ge=ve=>{const ie={};ve.forEach(pe=>{const Me=new Date(pe.assessment_date||pe.created_at),Se=`${Me.getFullYear()}-${String(Me.getMonth()+1).padStart(2,"0")}`;ie[Se]||(ie[Se]={total:0,count:0});const Ne=pe.max_score>0?pe.score/pe.max_score*100:0;ie[Se].total+=Ne,ie[Se].count++});const q=Object.entries(ie).sort(([pe],[Me])=>pe.localeCompare(Me)).slice(-6).map(([pe,Me])=>({month:new Date(pe+"-01").toLocaleDateString("en",{month:"short"}),average:Math.round(Me.total/Me.count)}));M(q)},ze=ve=>{const ie={};ve.forEach(pe=>{const Me=pe.subject_name||"Unknown";ie[Me]||(ie[Me]={total:0,max:0,count:0,scores:[]}),ie[Me].total+=pe.score||0,ie[Me].max+=pe.max_score||0,ie[Me].count++,ie[Me].scores.push(pe.max_score>0?pe.score/pe.max_score*100:0)});const q=Object.entries(ie).map(([pe,Me])=>{const Se=Me.max>0?Me.total/Me.max*100:0,Ne=[...Me.scores].sort((Ce,ft)=>ft-Ce),et=Me.scores.length>1?Me.scores[Me.scores.length-1]-Me.scores[0]:0;return{subject:pe,average:Math.round(Se),assessments:Me.count,highest:Math.round(Ne[0]||0),lowest:Math.round(Ne[Ne.length-1]||0),trend:et>5?"improving":et<-5?"declining":"stable",strength:Se>=70?"strong":Se>=50?"average":"weak"}}).sort((pe,Me)=>Me.average-pe.average);$(q)},Xe=async()=>{if(!f||!v.subject||!v.message){alert("Please fill all fields");return}try{await F.post(`${ee}/parent_portal.php?resource=send_message`,{parent_id:t.id,teacher_id:f.id,subject:v.subject,message:v.message}),N(!1),U({subject:"",message:""}),y(null),alert("Message sent successfully!")}catch{alert("Failed to send message")}},st=async()=>{try{(await F.post(`${ee}/parent_portal.php?resource=request_meeting`,{parent_id:t.id,student_id:c?.child_id||c?.student_id,...oe})).data.success&&(A(!1),ne({teacher_id:"",subject:"",message:"",preferred_date:"",preferred_time:""}),je(c?.child_id||c?.student_id),alert("Meeting request sent!"))}catch{alert("Failed to send meeting request")}},ce=async ve=>{try{await F.post(`${ee}/parent_portal.php?resource=acknowledge_report`,{parent_id:t.id,student_id:c?.child_id||c?.student_id,term_id:ve,academic_year:new Date().getFullYear().toString()}),je(c?.child_id||c?.student_id),alert("Report acknowledged!")}catch(ie){console.error("Error:",ie)}},_e=async(ve,ie)=>{try{await F.post(`${ee}/parent_portal.php?resource=rsvp`,{parent_id:t.id,event_id:ve,student_id:c?.child_id||c?.student_id,response:ie}),Fe()}catch(q){console.error("Error:",q)}};if(s)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-purple-200 border-t-purple-600 rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading..."})]})});const le=z.filter(ve=>!ve.submission_id).length,Pe=z.filter(ve=>!ve.submission_id&&new Date(ve.due_date)<new Date).length,we=j.summary?.total>0?Math.round(j.summary.present/j.summary.total*100):0,fe=Q.length>0?Math.round(Q.reduce((ve,ie)=>ve+(parseFloat(ie.percentage)||0),0)/Q.length):0,ye=te.summary?.total_due||te.invoices?.reduce((ve,ie)=>ve+parseFloat(ie.balance||0),0)||0,Ke=[{id:"overview",label:"Overview",icon:Lh},{id:"homework",label:"Homework",icon:as},{id:"attendance",label:"Attendance",icon:jh},{id:"grades",label:"Grades",icon:Fs},{id:"analysis",label:"Analysis",icon:Jr},{id:"fees",label:"Fees",icon:Xc},{id:"meetings",label:"Meetings",icon:Rt},{id:"events",label:"Events",icon:Ot},{id:"reports",label:"Reports",icon:Kt},{id:"messages",label:"Messages",icon:wa}];return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-purple-50 to-indigo-50",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-700 via-purple-600 to-indigo-600 text-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["Welcome, ",t?.name?.split(" ")[0]||"Parent"]}),e.jsx("p",{className:"text-purple-200",children:"Parent Portal Pro"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg flex items-center gap-2",children:[e.jsx(Qh,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:"Family Link"})]}),e.jsx("button",{onClick:Fe,className:"p-2 bg-white/20 hover:bg-white/30 rounded-lg",children:e.jsx(Ns,{size:18})})]})]}),P.length>0&&e.jsx("div",{className:"flex gap-3 overflow-x-auto pb-2",children:P.map(ve=>e.jsxs("button",{onClick:()=>o(ve),className:`flex items-center gap-3 px-4 py-3 rounded-xl transition-all whitespace-nowrap ${(c?.child_id||c?.student_id)===(ve.child_id||ve.student_id)?"bg-white text-purple-700 shadow-lg":"bg-white/20 hover:bg-white/30"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold ${(c?.child_id||c?.student_id)===(ve.child_id||ve.student_id)?"bg-purple-100 text-purple-700":"bg-white/30"}`,children:ve.full_name?.charAt(0)||"C"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-semibold",children:ve.full_name}),e.jsx("p",{className:`text-xs ${(c?.child_id||c?.student_id)===(ve.child_id||ve.student_id)?"text-purple-500":"text-purple-200"}`,children:ve.class_name||"No class"})]})]},ve.child_id||ve.student_id))})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 -mt-4",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(BA,{icon:e.jsx(as,{className:"text-blue-600"}),label:"Homework",value:le,subtext:Pe>0?`${Pe} overdue`:"All on track",color:"blue",alert:Pe>0}),e.jsx(BA,{icon:e.jsx(jh,{className:"text-green-600"}),label:"Attendance",value:`${we}%`,subtext:`${j.summary?.present||0} of ${j.summary?.total||0} days`,color:"green"}),e.jsx(BA,{icon:e.jsx(Fs,{className:"text-purple-600"}),label:"Average",value:`${fe}%`,subtext:xH(fe),color:"purple"}),e.jsx(BA,{icon:e.jsx(Xc,{className:"text-orange-600"}),label:"Fees Due",value:`GHS ${ye.toLocaleString()}`,subtext:ye>0?"Payment pending":"All paid",color:"orange",alert:ye>0})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 mt-6",children:e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-1 flex gap-1 overflow-x-auto",children:Ke.map(ve=>{const ie=ve.icon;return e.jsxs("button",{onClick:()=>l(ve.id),className:`flex items-center gap-2 px-4 py-2.5 rounded-lg font-medium transition-all whitespace-nowrap ${r===ve.id?"bg-purple-600 text-white shadow-md":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(ie,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:ve.label})]},ve.id)})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[r==="overview"&&e.jsx(hH,{homework:z,attendance:j,grades:Q,events:O,notifications:xe,performanceData:D}),r==="homework"&&e.jsx(pH,{homework:z}),r==="attendance"&&e.jsx(AH,{attendance:j,currentMonth:B,setCurrentMonth:w}),r==="grades"&&e.jsx(gH,{grades:Q,performanceData:D}),r==="analysis"&&e.jsx(wH,{subjectAnalysis:K,performanceData:D,grades:Q}),r==="fees"&&e.jsx(fH,{fees:te}),r==="meetings"&&e.jsx(bH,{meetings:re,teachers:I,onRequestMeeting:()=>A(!0)}),r==="events"&&e.jsx(yH,{events:O,onRsvp:_e}),r==="reports"&&e.jsx(jH,{reportCards:ae,onAcknowledge:ce}),r==="messages"&&e.jsx(_H,{teachers:I,onMessage:ve=>{y(ve),N(!0)}})]}),m&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"relative max-w-md w-full",children:[e.jsx("button",{onClick:()=>u(!1),className:"absolute -top-2 -right-2 z-10 p-2 bg-white rounded-full shadow-lg hover:bg-gray-100",children:e.jsx(Nt,{size:20})}),e.jsx(v5,{parentId:t?.id,children:P,onLinkSuccess:()=>{u(!1),Fe()}})]})}),x&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full relative",children:[e.jsx("button",{onClick:()=>A(!1),className:"absolute top-4 right-4 p-1 hover:bg-gray-100 rounded",children:e.jsx(Nt,{size:20})}),e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Request Meeting"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("select",{value:oe.teacher_id,onChange:ve=>ne({...oe,teacher_id:ve.target.value}),className:"w-full px-3 py-2 border rounded-lg",children:[e.jsx("option",{value:"",children:"Select teacher..."}),I.map(ve=>e.jsxs("option",{value:ve.id,children:[ve.name||ve.teacher_name," - ",ve.role||ve.subject_name]},ve.id))]}),e.jsx("input",{type:"text",placeholder:"Subject",value:oe.subject,onChange:ve=>ne({...oe,subject:ve.target.value}),className:"w-full px-3 py-2 border rounded-lg"}),e.jsx("textarea",{placeholder:"Message",value:oe.message,onChange:ve=>ne({...oe,message:ve.target.value}),rows:3,className:"w-full px-3 py-2 border rounded-lg"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("input",{type:"date",value:oe.preferred_date,onChange:ve=>ne({...oe,preferred_date:ve.target.value}),className:"px-3 py-2 border rounded-lg"}),e.jsx("input",{type:"time",value:oe.preferred_time,onChange:ve=>ne({...oe,preferred_time:ve.target.value}),className:"px-3 py-2 border rounded-lg"})]}),e.jsx("button",{onClick:st,className:"w-full py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Send Request"})]})]})}),g&&f&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full relative",children:[e.jsx("button",{onClick:()=>{N(!1),y(null)},className:"absolute top-4 right-4 p-1 hover:bg-gray-100 rounded",children:e.jsx(Nt,{size:20})}),e.jsxs("h3",{className:"text-xl font-bold mb-4",children:["Message ",f.name]}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:f.role||"Teacher"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Subject",value:v.subject,onChange:ve=>U({...v,subject:ve.target.value}),className:"w-full px-3 py-2 border rounded-lg"}),e.jsx("textarea",{placeholder:"Your message...",value:v.message,onChange:ve=>U({...v,message:ve.target.value}),rows:5,className:"w-full px-3 py-2 border rounded-lg"}),e.jsxs("button",{onClick:Xe,className:"w-full py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 flex items-center justify-center gap-2",children:[e.jsx(va,{size:18}),"Send Message"]})]})]})})]})}function BA({icon:t,label:s,value:a,subtext:r,color:l,alert:c}){return e.jsxs("div",{className:"bg-white border rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gray-50",children:t}),c&&e.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-800 mt-3",children:a}),e.jsx("p",{className:"text-sm text-gray-500",children:s}),e.jsx("p",{className:`text-xs mt-1 ${c?"text-red-500 font-medium":"text-gray-400"}`,children:r})]})}function xH(t){return t>=80?"Excellent":t>=70?"Very Good":t>=60?"Good":t>=50?"Average":"Needs Improvement"}function hH({homework:t,attendance:s,grades:a,events:r,notifications:l,performanceData:c}){const o=t.filter(m=>!m.submission_id);return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[c.length>0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx($s,{className:"text-indigo-600",size:20}),"Performance Trend"]}),e.jsx(Ry,{data:c})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(as,{className:"text-blue-600",size:20}),"Pending Homework"]}),o.length===0?e.jsx("p",{className:"text-center py-8 text-gray-500",children:"All homework completed!"}):e.jsx("div",{className:"space-y-3",children:o.slice(0,4).map((m,u)=>e.jsx(k_,{homework:m},u))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Fs,{className:"text-purple-600",size:20}),"Recent Grades"]}),a.length===0?e.jsx("p",{className:"text-center py-8 text-gray-500",children:"No grades yet"}):e.jsx("div",{className:"space-y-3",children:a.slice(0,5).map((m,u)=>e.jsx(vH,{grade:m},u))})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(jh,{className:"text-green-600",size:20}),"Attendance"]}),e.jsx(NH,{summary:s.summary})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(nl,{className:"text-red-600",size:20}),"Notifications"]}),l.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No notifications"}):e.jsx("div",{className:"space-y-2",children:l.slice(0,5).map((m,u)=>e.jsxs("div",{className:`p-3 rounded-lg text-sm flex items-start gap-2 ${m.type==="alert"?"bg-red-50":m.type==="warning"?"bg-yellow-50":"bg-gray-50"}`,children:[m.type==="alert"?e.jsx(ka,{size:16,className:"text-red-500 mt-0.5 flex-shrink-0"}):e.jsx(nl,{size:16,className:"text-gray-400 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:m.message||m.title})]},u))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Ot,{className:"text-orange-600",size:20}),"Upcoming Events"]}),r.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No upcoming events"}):e.jsx("div",{className:"space-y-2",children:r.slice(0,3).map((m,u)=>e.jsxs("div",{className:"p-3 bg-orange-50 rounded-lg",children:[e.jsx("p",{className:"font-medium text-sm",children:m.title}),e.jsx("p",{className:"text-xs text-gray-500",children:m.start_date})]},u))})]})]})]})}function pH({homework:t}){const s=t.filter(l=>!l.submission_id),a=t.filter(l=>l.submission_status==="submitted"),r=t.filter(l=>l.submission_status==="graded");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-yellow-50 border border-yellow-100 rounded-xl p-4 text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-yellow-600",children:s.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Pending"})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-100 rounded-xl p-4 text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:a.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Submitted"})]}),e.jsxs("div",{className:"bg-green-50 border border-green-100 rounded-xl p-4 text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-green-600",children:r.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Graded"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"All Assignments"}),t.length===0?e.jsx("p",{className:"text-center py-12 text-gray-500",children:"No homework found"}):e.jsx("div",{className:"space-y-4",children:t.map((l,c)=>e.jsx(k_,{homework:l,detailed:!0},c))})]})]})}function AH({attendance:t,currentMonth:s,setCurrentMonth:a}){const{records:r,summary:l}=t,c=new Date(s.getFullYear(),s.getMonth()+1,0).getDate(),o=new Date(s.getFullYear(),s.getMonth(),1).getDay(),m=["January","February","March","April","May","June","July","August","September","October","November","December"],u=x=>{const A=`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(x).padStart(2,"0")}`;return r.find(g=>g.date===A)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-green-50 border border-green-100 rounded-xl p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:l.present||0}),e.jsx("p",{className:"text-sm",children:"Present"})]}),e.jsxs("div",{className:"bg-red-50 border border-red-100 rounded-xl p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-red-600",children:l.absent||0}),e.jsx("p",{className:"text-sm",children:"Absent"})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-100 rounded-xl p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:l.late||0}),e.jsx("p",{className:"text-sm",children:"Late"})]}),e.jsxs("div",{className:"bg-purple-50 border border-purple-100 rounded-xl p-4 text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[l.total>0?Math.round(l.present/l.total*100):0,"%"]}),e.jsx("p",{className:"text-sm",children:"Rate"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("button",{onClick:()=>a(new Date(s.getFullYear(),s.getMonth()-1,1)),className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(Kd,{size:20})}),e.jsxs("h3",{className:"text-lg font-semibold",children:[m[s.getMonth()]," ",s.getFullYear()]}),e.jsx("button",{onClick:()=>a(new Date(s.getFullYear(),s.getMonth()+1,1)),className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(cr,{size:20})})]}),e.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(x=>e.jsx("div",{className:"text-center text-sm font-medium text-gray-500 py-2",children:x},x)),Array.from({length:o}).map((x,A)=>e.jsx("div",{},`e-${A}`)),Array.from({length:c}).map((x,A)=>{const g=A+1,N=u(g);let f="bg-gray-50";return N?.status==="present"?f="bg-green-100":N?.status==="absent"?f="bg-red-100":N?.status==="late"&&(f="bg-yellow-100"),e.jsx("div",{className:`aspect-square flex items-center justify-center rounded-lg text-sm font-medium ${f}`,children:g},g)})]}),e.jsxs("div",{className:"flex justify-center gap-6 mt-6 pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-green-100 rounded"}),e.jsx("span",{className:"text-sm",children:"Present"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-red-100 rounded"}),e.jsx("span",{className:"text-sm",children:"Absent"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-yellow-100 rounded"}),e.jsx("span",{className:"text-sm",children:"Late"})]})]})]})]})}function gH({grades:t,performanceData:s}){const a=t.reduce((r,l)=>{const c=l.subject_name||"Unknown";return r[c]||(r[c]=[]),r[c].push(l),r},{});return e.jsxs("div",{className:"space-y-6",children:[s.length>0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(L1,{className:"text-indigo-600",size:20}),"Grade Trend Over Time"]}),e.jsx(Ry,{data:s})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx($s,{className:"text-purple-600",size:20}),"Performance by Subject"]}),Object.keys(a).length===0?e.jsx("p",{className:"text-center py-12 text-gray-500",children:"No grades available"}):e.jsx("div",{className:"space-y-4",children:Object.entries(a).map(([r,l])=>{const c=l.reduce((o,m)=>o+(parseFloat(m.percentage)||(m.max_score>0?m.score/m.max_score*100:0)),0)/l.length;return e.jsxs("div",{className:"border rounded-xl p-4",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"font-semibold",children:r}),e.jsxs("span",{className:`font-bold ${c>=70?"text-green-600":c>=50?"text-yellow-600":"text-red-600"}`,children:[Math.round(c),"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full",children:e.jsx("div",{className:`h-full rounded-full ${c>=70?"bg-green-500":c>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(c,100)}%`}})})]},r)})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"All Grades"}),t.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No grades recorded"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Subject"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Assessment"}),e.jsx("th",{className:"text-center py-2 px-3",children:"Score"}),e.jsx("th",{className:"text-center py-2 px-3",children:"Date"})]})}),e.jsx("tbody",{children:t.slice(0,15).map((r,l)=>{const c=r.max_score>0?Math.round(r.score/r.max_score*100):0;return e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-2 px-3 font-medium",children:r.subject_name||"N/A"}),e.jsx("td",{className:"py-2 px-3 text-gray-600",children:r.assessment_title||r.assessment_type||"Assessment"}),e.jsx("td",{className:"py-2 px-3 text-center",children:e.jsxs("span",{className:`font-bold ${c>=70?"text-green-600":c>=50?"text-yellow-600":"text-red-600"}`,children:[r.score,"/",r.max_score]})}),e.jsx("td",{className:"py-2 px-3 text-center text-gray-500",children:r.assessment_date?new Date(r.assessment_date).toLocaleDateString():"-"})]},l)})})]})})]})]})}function fH({fees:t}){const{invoices:s=[],payments:a=[]}=t,r=s.reduce((o,m)=>o+parseFloat(m.amount||0),0),l=a.reduce((o,m)=>o+parseFloat(m.amount||0),0),c=s.reduce((o,m)=>o+parseFloat(m.balance||0),0);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-100 rounded-xl p-6",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Billed"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["GHS ",r.toLocaleString()]})]}),e.jsxs("div",{className:"bg-green-50 border border-green-100 rounded-xl p-6",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Paid"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["GHS ",l.toLocaleString()]})]}),e.jsxs("div",{className:"bg-orange-50 border border-orange-100 rounded-xl p-6",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Balance"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:["GHS ",c.toLocaleString()]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Invoices"}),s.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No invoices"}):e.jsx("div",{className:"space-y-3",children:s.map((o,m)=>e.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:o.description||"School Fees"}),e.jsx("p",{className:"text-sm text-gray-500",children:o.due_date})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold",children:["GHS ",parseFloat(o.amount||0).toLocaleString()]}),e.jsx("p",{className:`text-sm ${parseFloat(o.balance)>0?"text-orange-600":"text-green-600"}`,children:parseFloat(o.balance)>0?`Due: GHS ${parseFloat(o.balance).toLocaleString()}`:"Paid"})]})]},m))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Payment History"}),a.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No payments"}):e.jsx("div",{className:"space-y-3",children:a.map((o,m)=>e.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-green-600",children:["GHS ",parseFloat(o.amount).toLocaleString()]}),e.jsx("p",{className:"text-sm text-gray-500",children:o.payment_date})]}),e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs",children:o.payment_method||"Cash"})]},m))})]})]})}function bH({meetings:t,teachers:s,onRequestMeeting:a}){return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:a,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 flex items-center gap-2",children:[e.jsx(Ti,{size:18}),"Request Meeting"]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Your Meetings"}),t.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No meetings scheduled"}):e.jsx("div",{className:"space-y-3",children:t.map((r,l)=>e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"font-semibold",children:r.subject}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${r.status==="approved"?"bg-green-100 text-green-700":r.status==="pending"?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"}`,children:r.status})]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[r.teacher_name,"  ",r.meeting_date||r.preferred_date]})]},l))})]})]})}function yH({events:t,onRsvp:s}){return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"School Events"}),t.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No events"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map((a,r)=>e.jsxs("div",{className:"border rounded-xl p-4",children:[e.jsx("h4",{className:"font-semibold",children:a.title}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[a.start_date," ",a.start_time&&`at ${a.start_time}`]}),a.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:a.description}),a.requires_rsvp&&e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx("button",{onClick:()=>s(a.id,"attending"),className:"px-3 py-1 bg-green-100 text-green-700 rounded-lg text-sm hover:bg-green-200",children:"Attending"}),e.jsx("button",{onClick:()=>s(a.id,"not_attending"),className:"px-3 py-1 bg-red-100 text-red-700 rounded-lg text-sm hover:bg-red-200",children:"Not Attending"})]})]},r))})]})}function jH({reportCards:t,onAcknowledge:s}){return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Report Cards"}),t.length===0?e.jsx("p",{className:"text-gray-500 text-center py-12",children:"No report cards available"}):e.jsx("div",{className:"space-y-4",children:t.map((a,r)=>e.jsx("div",{className:"border rounded-xl p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:a.term_name||`Term ${a.term_id}`}),e.jsx("p",{className:"text-sm text-gray-500",children:a.academic_year||new Date().getFullYear()})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[a.acknowledged?e.jsxs("span",{className:"px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm flex items-center gap-1",children:[e.jsx(DA,{size:14}),"Acknowledged"]}):e.jsxs("button",{onClick:()=>s(a.term_id),className:"px-4 py-2 bg-purple-600 text-white rounded-lg text-sm hover:bg-purple-700 flex items-center gap-2",children:[e.jsx(Wk,{size:14}),"Acknowledge"]}),e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(na,{size:18,className:"text-gray-500"})}),e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(xs,{size:18,className:"text-gray-500"})})]})]})},r))})]})}function k_({homework:t,detailed:s}){const a=!t.submission_id&&new Date(t.due_date)<new Date,r=Math.ceil((new Date(t.due_date)-new Date)/(1e3*60*60*24));return e.jsxs("div",{className:`p-4 rounded-lg border ${a?"bg-red-50 border-red-200":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:t.title}),e.jsx("p",{className:"text-sm text-gray-500",children:t.subject_name||"Subject"})]}),e.jsx("div",{children:t.submission_id?e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t.submission_status==="graded"?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:t.submission_status==="graded"?`${t.submission_score}/${t.max_score}`:"Submitted"}):e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${a?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:a?"Overdue":`${r}d left`})})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2 flex items-center gap-1",children:[e.jsx(Wt,{size:12}),"Due: ",new Date(t.due_date).toLocaleDateString()]})]})}function vH({grade:t}){const s=parseFloat(t.percentage)||0;return e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.subject_name||"Subject"}),e.jsx("p",{className:"text-sm text-gray-500",children:t.exam_name||"Assessment"})]}),e.jsxs("p",{className:`text-lg font-bold ${s>=70?"text-green-600":s>=50?"text-yellow-600":"text-red-600"}`,children:[s,"%"]})]})}function NH({summary:t}){const s=t?.total>0?Math.round(t.present/t.total*100):0;return e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative w-32 h-32",children:[e.jsxs("svg",{className:"w-full h-full transform -rotate-90",children:[e.jsx("circle",{cx:"64",cy:"64",r:"56",fill:"none",stroke:"#e5e7eb",strokeWidth:"12"}),e.jsx("circle",{cx:"64",cy:"64",r:"56",fill:"none",stroke:s>=90?"#22c55e":s>=75?"#eab308":"#ef4444",strokeWidth:"12",strokeDasharray:`${s*3.52} 352`,strokeLinecap:"round"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("span",{className:"text-2xl font-bold",children:[s,"%"]})})]}),e.jsxs("div",{className:"flex gap-4 mt-4 text-sm",children:[e.jsxs("span",{className:"text-green-600",children:[t?.present||0," Present"]}),e.jsxs("span",{className:"text-red-600",children:[t?.absent||0," Absent"]})]})]})}function Ry({data:t}){if(!t||t.length===0)return e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No performance data available"});const s=Math.max(...t.map(a=>a.average),100);return e.jsx("div",{className:"h-48",children:e.jsx("div",{className:"flex items-end justify-between h-40 gap-2",children:t.map((a,r)=>e.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[e.jsxs("div",{className:"w-full flex flex-col items-center justify-end h-32",children:[e.jsxs("span",{className:"text-xs font-bold mb-1",children:[a.average,"%"]}),e.jsx("div",{className:`w-full max-w-12 rounded-t-lg transition-all ${a.average>=70?"bg-gradient-to-t from-green-500 to-green-400":a.average>=50?"bg-gradient-to-t from-yellow-500 to-yellow-400":"bg-gradient-to-t from-red-500 to-red-400"}`,style:{height:`${a.average/s*100}%`,minHeight:"8px"}})]}),e.jsx("span",{className:"text-xs text-gray-500 mt-2",children:a.month})]},r))})})}function wH({subjectAnalysis:t,performanceData:s,grades:a}){const r=t.filter(o=>o.strength==="strong"),l=t.filter(o=>o.strength==="weak"),c=t.filter(o=>o.strength==="average");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-green-50 border border-green-100 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(sl,{className:"text-green-600",size:20}),e.jsx("h4",{className:"font-semibold text-green-800",children:"Strong Subjects"})]}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:r.length}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r.map(o=>o.subject).join(", ")||"None yet"})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-100 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ln,{className:"text-yellow-600",size:20}),e.jsx("h4",{className:"font-semibold text-yellow-800",children:"Average Subjects"})]}),e.jsx("p",{className:"text-3xl font-bold text-yellow-600",children:c.length}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:c.map(o=>o.subject).join(", ")||"None"})]}),e.jsxs("div",{className:"bg-red-50 border border-red-100 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(_s,{className:"text-red-600",size:20}),e.jsx("h4",{className:"font-semibold text-red-800",children:"Needs Attention"})]}),e.jsx("p",{className:"text-3xl font-bold text-red-600",children:l.length}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:l.map(o=>o.subject).join(", ")||"None"})]})]}),s.length>0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(L1,{className:"text-indigo-600",size:20}),"Overall Performance Trend"]}),e.jsx(Ry,{data:s}),e.jsx("div",{className:"mt-4 pt-4 border-t flex items-center justify-center gap-6 text-sm",children:s.length>=2&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-gray-500",children:["First: ",e.jsxs("strong",{children:[s[0]?.average,"%"]})]}),e.jsxs("span",{className:"text-gray-500",children:["Latest: ",e.jsxs("strong",{children:[s[s.length-1]?.average,"%"]})]}),(()=>{const o=s[s.length-1]?.average-s[0]?.average;return e.jsxs("span",{className:`flex items-center gap-1 font-medium ${o>0?"text-green-600":o<0?"text-red-600":"text-gray-600"}`,children:[o>0?e.jsx($s,{size:16}):o<0?e.jsx(gc,{size:16}):e.jsx(WA,{size:16}),o>0?"+":"",o,"%"]})})()]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Jr,{className:"text-purple-600",size:20}),"Subject Strength Analysis"]}),t.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No data available for analysis"}):e.jsx("div",{className:"space-y-4",children:t.map((o,m)=>e.jsxs("div",{className:`border rounded-xl p-4 ${o.strength==="strong"?"border-green-200 bg-green-50/50":o.strength==="weak"?"border-red-200 bg-red-50/50":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`w-3 h-3 rounded-full ${o.strength==="strong"?"bg-green-500":o.strength==="weak"?"bg-red-500":"bg-yellow-500"}`}),e.jsx("h4",{className:"font-semibold",children:o.subject}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${o.strength==="strong"?"bg-green-100 text-green-700":o.strength==="weak"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:o.strength==="strong"?"Strong":o.strength==="weak"?"Needs Work":"Average"})]}),e.jsxs("span",{className:`text-xl font-bold ${o.average>=70?"text-green-600":o.average>=50?"text-yellow-600":"text-red-600"}`,children:[o.average,"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full mb-3",children:e.jsx("div",{className:`h-full rounded-full ${o.average>=70?"bg-green-500":o.average>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(o.average,100)}%`}})}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("span",{children:[o.assessments," assessments"]}),e.jsxs("span",{children:["High: ",o.highest,"% | Low: ",o.lowest,"%"]}),e.jsxs("span",{className:`flex items-center gap-1 ${o.trend==="improving"?"text-green-600":o.trend==="declining"?"text-red-600":"text-gray-500"}`,children:[o.trend==="improving"?e.jsx($s,{size:14}):o.trend==="declining"?e.jsx(gc,{size:14}):e.jsx(WA,{size:14}),o.trend]})]})]},m))})]}),l.length>0&&e.jsxs("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Xu,{className:"text-amber-600",size:20}),"Recommendations"]}),e.jsx("ul",{className:"space-y-2",children:l.map((o,m)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[e.jsx(ka,{size:16,className:"text-amber-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:o.subject})," needs improvement. Consider extra practice or tutoring. Current average: ",o.average,"%"]})]},m))})]})]})}function _H({teachers:t,onMessage:s}){return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(wa,{className:"text-blue-600",size:20}),"Contact Teachers"]}),t.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No teachers available"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map((a,r)=>e.jsxs("div",{className:"border rounded-xl p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-purple-500 to-indigo-500 flex items-center justify-center text-white font-bold text-lg",children:(a.name||a.teacher_name||"T").charAt(0)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold",children:a.name||a.teacher_name}),e.jsx("p",{className:"text-sm text-gray-500",children:a.role||a.subject_name||"Teacher"}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-600",children:[a.email&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ra,{size:14}),a.email]}),a.phone&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(er,{size:14}),a.phone]})]})]})]}),e.jsxs("button",{onClick:()=>s(a),className:"w-full mt-4 py-2 bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 flex items-center justify-center gap-2 font-medium",children:[e.jsx(va,{size:16}),"Send Message"]})]},r))})]})})}function CH(){const{childId:t}=qd(),s=la(),{user:a}=Us(),[r,l]=h.useState(!0),[c,o]=h.useState(null),[m,u]=h.useState([]),[x,A]=h.useState({present:0,absent:0,late:0,excused:0,total:0}),[g,N]=h.useState(new Date().toISOString().slice(0,7)),[f,y]=h.useState(null);h.useEffect(()=>{v()},[a]),h.useEffect(()=>{f&&t&&U()},[f,t]),h.useEffect(()=>{c?.student_id&&D()},[c,g]);const v=async()=>{try{const j=await F.get(`${ee}/parents.php?user_id=${a?.id}`);j.data.parents?.length>0&&y(j.data.parents[0].id)}catch(j){console.error("Error fetching parent ID:",j)}},U=async()=>{try{const j=await F.get(`${ee}/parent_portal.php?resource=child_details&child_id=${t}`);j.data.success&&o(j.data.child)}catch(j){console.error("Error fetching child details:",j)}finally{l(!1)}},D=async()=>{try{const j=await F.get(`${ee}/parent_portal.php?resource=attendance&student_id=${c.student_id}&month=${g}`);j.data.success&&(u(j.data.attendance||[]),A(j.data.summary||{present:0,absent:0,late:0,excused:0,total:0}))}catch(j){console.error("Error fetching attendance:",j)}},M=j=>{const T=new Date(g+"-01");T.setMonth(T.getMonth()+j),N(T.toISOString().slice(0,7))},K=j=>{switch(j){case"present":return e.jsx(Mt,{className:"w-5 h-5 text-green-600"});case"absent":return e.jsx(Js,{className:"w-5 h-5 text-red-600"});case"late":return e.jsx(Wt,{className:"w-5 h-5 text-yellow-600"});case"excused":return e.jsx(_s,{className:"w-5 h-5 text-blue-600"});default:return null}},$=j=>{switch(j){case"present":return"bg-green-100 text-green-700";case"absent":return"bg-red-100 text-red-700";case"late":return"bg-yellow-100 text-yellow-700";case"excused":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-700"}},P=x.total>0?Math.round(x.present/x.total*100):0,se=()=>{const[j,T]=g.split("-").map(Number);return new Date(j,T,0).getDate()},z=()=>{const[j,T]=g.split("-").map(Number);return new Date(j,T-1,1).getDay()},R=()=>{const j=se(),T=z(),Q=[],E={};m.forEach(te=>{const C=new Date(te.date).getDate();E[C]=te});for(let te=0;te<T;te++)Q.push(e.jsx("div",{className:"p-2"},`empty-${te}`));for(let te=1;te<=j;te++){const C=E[te];Q.push(e.jsxs("div",{className:`p-2 text-center rounded-lg ${C?$(C.status):"bg-gray-50"}`,title:C?`${C.status}${C.remarks?`: ${C.remarks}`:""}`:"No record",children:[e.jsx("span",{className:"text-sm font-medium",children:te}),C&&e.jsx("div",{className:"mt-1 flex justify-center",children:K(C.status)})]},te))}return Q};return r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(hs,{className:"w-8 h-8 text-blue-600 animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>s(-1),className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(ol,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Attendance"}),e.jsxs("p",{className:"text-gray-600",children:[c?.full_name,"  ",c?.class_name]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"card p-4 text-center",children:[e.jsxs("div",{className:`text-3xl font-bold ${P>=90?"text-green-600":P>=75?"text-yellow-600":"text-red-600"}`,children:[P,"%"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Attendance Rate"}),e.jsx("div",{className:"flex items-center justify-center gap-1 mt-1",children:P>=90?e.jsx($s,{className:"w-4 h-4 text-green-600"}):e.jsx(gc,{className:"w-4 h-4 text-red-600"})})]}),e.jsxs("div",{className:"card p-4 text-center bg-green-50",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:x.present}),e.jsx("p",{className:"text-sm text-gray-600",children:"Present"})]}),e.jsxs("div",{className:"card p-4 text-center bg-red-50",children:[e.jsx("div",{className:"text-3xl font-bold text-red-600",children:x.absent}),e.jsx("p",{className:"text-sm text-gray-600",children:"Absent"})]}),e.jsxs("div",{className:"card p-4 text-center bg-yellow-50",children:[e.jsx("div",{className:"text-3xl font-bold text-yellow-600",children:x.late}),e.jsx("p",{className:"text-sm text-gray-600",children:"Late"})]}),e.jsxs("div",{className:"card p-4 text-center bg-blue-50",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:x.excused||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"Excused"})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("button",{onClick:()=>M(-1),className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(Kd,{className:"w-5 h-5"})}),e.jsx("h3",{className:"text-lg font-semibold",children:new Date(g+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"})}),e.jsx("button",{onClick:()=>M(1),className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(cr,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"grid grid-cols-7 gap-2 mb-2",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(j=>e.jsx("div",{className:"text-center text-sm font-medium text-gray-500 p-2",children:j},j))}),e.jsx("div",{className:"grid grid-cols-7 gap-2",children:R()}),e.jsxs("div",{className:"flex flex-wrap gap-4 mt-6 pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-green-100 rounded"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Present"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-red-100 rounded"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Absent"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-yellow-100 rounded"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Late"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-100 rounded"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Excused"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsx("h3",{className:"font-semibold",children:"Attendance Records"})}),e.jsx("div",{className:"divide-y max-h-96 overflow-y-auto",children:m.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"No attendance records for this month"}):m.map(j=>e.jsxs("div",{className:"p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[K(j.status),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:new Date(j.date).toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),j.remarks&&e.jsx("p",{className:"text-sm text-gray-500",children:j.remarks})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-sm ${$(j.status)}`,children:j.status}),j.check_in_time&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["In: ",j.check_in_time," ",j.check_out_time&&` Out: ${j.check_out_time}`]})]})]},j.id))})]})]})}function SH(){const{childId:t}=qd(),s=la(),{user:a}=Us(),[r,l]=h.useState(!0),[c,o]=h.useState(null),[m,u]=h.useState([]),[x,A]=h.useState([]),[g,N]=h.useState(""),[f,y]=h.useState(null);h.useEffect(()=>{v()},[a]),h.useEffect(()=>{f&&t&&U()},[f,t]),h.useEffect(()=>{c?.student_id&&D()},[c,g]);const v=async()=>{try{const P=await F.get(`${ee}/parents.php?user_id=${a?.id}`);P.data.parents?.length>0&&y(P.data.parents[0].id)}catch(P){console.error("Error fetching parent ID:",P)}},U=async()=>{try{const P=await F.get(`${ee}/parent_portal.php?resource=child_details&child_id=${t}`);P.data.success&&o(P.data.child)}catch(P){console.error("Error fetching child details:",P)}finally{l(!1)}},D=async()=>{try{let P=`${ee}/parent_portal.php?resource=grades&student_id=${c.student_id}`;g&&(P+=`&term=${g}`);const se=await F.get(P);se.data.success&&(u(se.data.grades||[]),A(se.data.subject_averages||[]))}catch(P){console.error("Error fetching grades:",P)}},M=P=>P>=80?"text-green-600 bg-green-50":P>=60?"text-blue-600 bg-blue-50":P>=50?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50",K=P=>P>=80?"A":P>=70?"B":P>=60?"C":P>=50?"D":"F",$=x.length>0?Math.round(x.reduce((P,se)=>P+se.average,0)/x.length):0;return r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(hs,{className:"w-8 h-8 text-blue-600 animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>s(-1),className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(ol,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Grades & Results"}),e.jsxs("p",{className:"text-gray-600",children:[c?.full_name,"  ",c?.class_name]})]}),e.jsxs("select",{value:g,onChange:P=>N(P.target.value),className:"input",children:[e.jsx("option",{value:"",children:"All Terms"}),e.jsx("option",{value:"Term 1",children:"Term 1"}),e.jsx("option",{value:"Term 2",children:"Term 2"}),e.jsx("option",{value:"Term 3",children:"Term 3"})]})]}),e.jsx("div",{className:"card p-6 bg-gradient-to-r from-blue-600 to-indigo-700 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 mb-1",children:"Overall Average"}),e.jsxs("div",{className:"text-5xl font-bold",children:[$,"%"]}),e.jsxs("p",{className:"text-blue-100 mt-2",children:["Grade: ",K($)]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(Is,{className:"w-16 h-16 text-white/30"}),e.jsxs("p",{className:"text-sm text-blue-100 mt-2",children:[x.length," subjects"]})]})]})}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Fs,{className:"w-5 h-5 text-blue-600"}),"Subject Performance"]}),x.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No grades recorded yet"}):e.jsx("div",{className:"space-y-4",children:x.map((P,se)=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-32 text-sm font-medium text-gray-700 truncate",children:P.subject}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"h-6 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all ${P.average>=80?"bg-green-500":P.average>=60?"bg-blue-500":P.average>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${P.average}%`}})})}),e.jsxs("div",{className:`w-16 text-center font-bold rounded-lg py-1 ${M(P.average)}`,children:[P.average,"%"]}),e.jsx("div",{className:"w-8 text-center font-bold text-gray-600",children:K(P.average)})]},se))})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(as,{className:"w-5 h-5 text-purple-600"}),"Assessment Results"]}),e.jsxs("span",{className:"text-sm text-gray-500",children:[m.length," assessments"]})]}),m.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"No assessment results yet"}):e.jsx("div",{className:"divide-y max-h-[500px] overflow-y-auto",children:m.map(P=>{const se=P.max_score>0?Math.round(P.score/P.max_score*100):0;return e.jsxs("div",{className:"p-4 hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900",children:P.assessment_title}),e.jsx("p",{className:"text-sm text-gray-600",children:P.subject_name||"General"}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ot,{className:"w-3 h-3"}),new Date(P.assessment_date).toLocaleDateString()]}),e.jsx("span",{className:"px-2 py-0.5 bg-gray-100 rounded",children:P.assessment_type}),P.teacher_name&&e.jsxs("span",{children:["By: ",P.teacher_name]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`text-2xl font-bold ${se>=80?"text-green-600":se>=60?"text-blue-600":se>=50?"text-yellow-600":"text-red-600"}`,children:[P.score,"/",P.max_score]}),e.jsxs("div",{className:`text-sm px-2 py-0.5 rounded-full inline-block mt-1 ${M(se)}`,children:[se,"%  ",K(se)]})]})]}),P.remarks&&e.jsxs("p",{className:"mt-2 text-sm text-gray-600 bg-gray-50 p-2 rounded",children:[" ",P.remarks]})]},P.id)})})]})]})}function kH(){const{childId:t}=qd(),s=la(),{user:a}=Us(),[r,l]=h.useState(!0),[c,o]=h.useState(null),[m,u]=h.useState([]),[x,A]=h.useState({pending:[],submitted:[],overdue:[],graded:[]}),[g,N]=h.useState("all"),[f,y]=h.useState(null);h.useEffect(()=>{v()},[a]),h.useEffect(()=>{f&&t&&U()},[f,t]),h.useEffect(()=>{c?.student_id&&D()},[c]);const v=async()=>{try{const P=await F.get(`${ee}/parents.php?user_id=${a?.id}`);P.data.parents?.length>0&&y(P.data.parents[0].id)}catch(P){console.error("Error fetching parent ID:",P)}},U=async()=>{try{const P=await F.get(`${ee}/parent_portal.php?resource=child_details&child_id=${t}`);P.data.success&&o(P.data.child)}catch(P){console.error("Error fetching child details:",P)}finally{l(!1)}},D=async()=>{try{const P=await F.get(`${ee}/parent_portal.php?resource=homework&student_id=${c.student_id}`);P.data.success&&(u(P.data.homework||[]),A(P.data.categorized||{pending:[],submitted:[],overdue:[],graded:[]}))}catch(P){console.error("Error fetching homework:",P)}},M=()=>{switch(g){case"pending":return x.pending;case"submitted":return x.submitted;case"overdue":return x.overdue;case"graded":return x.graded;default:return m}},K=P=>P.submission_status==="graded"?e.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs rounded-full flex items-center gap-1",children:[e.jsx(Mt,{className:"w-3 h-3"})," Graded"]}):P.submission_status==="submitted"?e.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full flex items-center gap-1",children:[e.jsx(Mt,{className:"w-3 h-3"})," Submitted"]}):new Date(P.due_date)<new Date&&!P.submission_id?e.jsxs("span",{className:"px-2 py-1 bg-red-100 text-red-700 text-xs rounded-full flex items-center gap-1",children:[e.jsx(Js,{className:"w-3 h-3"})," Overdue"]}):e.jsxs("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-700 text-xs rounded-full flex items-center gap-1",children:[e.jsx(Wt,{className:"w-3 h-3"})," Pending"]}),$=P=>{const se=new Date,z=new Date(P),R=Math.ceil((z-se)/(1e3*60*60*24));return R<0?`${Math.abs(R)} days overdue`:R===0?"Due today":R===1?"Due tomorrow":`${R} days left`};return r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(hs,{className:"w-8 h-8 text-blue-600 animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>s(-1),className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(ol,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Homework"}),e.jsxs("p",{className:"text-gray-600",children:[c?.full_name,"  ",c?.class_name]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:`card p-4 text-center cursor-pointer transition-all ${g==="pending"?"ring-2 ring-yellow-500":""}`,onClick:()=>N(g==="pending"?"all":"pending"),children:[e.jsx(Wt,{className:"w-8 h-8 text-yellow-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:x.pending?.length||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"Pending"})]}),e.jsxs("div",{className:`card p-4 text-center cursor-pointer transition-all ${g==="submitted"?"ring-2 ring-blue-500":""}`,onClick:()=>N(g==="submitted"?"all":"submitted"),children:[e.jsx(Mt,{className:"w-8 h-8 text-blue-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:x.submitted?.length||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"Submitted"})]}),e.jsxs("div",{className:`card p-4 text-center cursor-pointer transition-all ${g==="overdue"?"ring-2 ring-red-500":""}`,onClick:()=>N(g==="overdue"?"all":"overdue"),children:[e.jsx(Js,{className:"w-8 h-8 text-red-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-red-600",children:x.overdue?.length||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"Overdue"})]}),e.jsxs("div",{className:`card p-4 text-center cursor-pointer transition-all ${g==="graded"?"ring-2 ring-green-500":""}`,onClick:()=>N(g==="graded"?"all":"graded"),children:[e.jsx(Mt,{className:"w-8 h-8 text-green-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:x.graded?.length||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"Graded"})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(as,{className:"w-5 h-5 text-blue-600"}),g==="all"?"All Homework":`${g.charAt(0).toUpperCase()+g.slice(1)} Homework`]}),g!=="all"&&e.jsx("button",{onClick:()=>N("all"),className:"text-sm text-blue-600 hover:underline",children:"Show All"})]}),M().length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(as,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{children:"No homework found"})]}):e.jsx("div",{className:"divide-y",children:M().map(P=>e.jsxs("div",{className:"p-4 hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:P.title}),K(P)]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:P.subject_name||"General"}),P.description&&e.jsx("p",{className:"text-sm text-gray-700 mb-2 line-clamp-2",children:P.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ot,{className:"w-3 h-3"}),"Due: ",new Date(P.due_date).toLocaleDateString()]}),e.jsx("span",{className:`font-medium ${new Date(P.due_date)<new Date&&!P.submission_id?"text-red-600":"text-gray-600"}`,children:$(P.due_date)}),P.teacher_name&&e.jsxs("span",{children:["Assigned by: ",P.teacher_name]})]})]}),e.jsxs("div",{className:"text-right",children:[P.submission_status==="graded"&&P.grade&&e.jsx("div",{className:"mb-2",children:e.jsxs("span",{className:"text-2xl font-bold text-green-600",children:[P.grade,"%"]})}),P.attachment&&e.jsxs("button",{className:"btn btn-sm bg-gray-100 hover:bg-gray-200 flex items-center gap-1",children:[e.jsx(xs,{className:"w-3 h-3"}),"Attachment"]})]})]}),P.feedback&&e.jsx("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Teacher Feedback:"})," ",P.feedback]})}),P.submitted_at&&e.jsxs("p",{className:"mt-2 text-xs text-gray-500",children:["Submitted: ",new Date(P.submitted_at).toLocaleString()]})]},P.id))})]})]})}function BH(){const{childId:t}=qd(),s=la(),{user:a}=Us(),[r,l]=h.useState(!0),[c,o]=h.useState(null),[m,u]=h.useState([]),[x,A]=h.useState(!1),[g,N]=h.useState(!1),[f,y]=h.useState(null),[v,U]=h.useState({subject:"",message:""}),[D,M]=h.useState({subject:"",message:"",preferred_date:"",preferred_time:""}),[K,$]=h.useState(null);h.useEffect(()=>{P()},[a]),h.useEffect(()=>{K&&t&&se()},[K,t]),h.useEffect(()=>{c?.student_id&&z()},[c]);const P=async()=>{try{const E=await F.get(`${ee}/parents.php?user_id=${a?.id}`);E.data.parents?.length>0&&$(E.data.parents[0].id)}catch(E){console.error("Error fetching parent ID:",E)}},se=async()=>{try{const E=await F.get(`${ee}/parent_portal.php?resource=child_details&child_id=${t}`);E.data.success&&o(E.data.child)}catch(E){console.error("Error fetching child details:",E)}finally{l(!1)}},z=async()=>{try{const E=await F.get(`${ee}/parent_portal.php?resource=teachers&student_id=${c.student_id}`);E.data.success&&u(E.data.teachers||[])}catch(E){console.error("Error fetching teachers:",E)}},R=async()=>{try{const E=await F.post(`${ee}/parent_portal.php?resource=send_message`,{parent_id:K,teacher_id:f.id,subject:v.subject,message:v.message});E.data.success?(alert("Message sent successfully!"),A(!1),U({subject:"",message:""})):alert(E.data.error||"Failed to send message")}catch(E){console.error("Error sending message:",E),alert("Failed to send message")}},j=async()=>{try{const E=await F.post(`${ee}/parent_portal.php?resource=request_meeting`,{parent_id:K,teacher_id:f.id,student_id:c.student_id,subject:D.subject,message:D.message,preferred_date:D.preferred_date,preferred_time:D.preferred_time});E.data.success?(alert("Meeting request sent successfully!"),N(!1),M({subject:"",message:"",preferred_date:"",preferred_time:""})):alert(E.data.error||"Failed to request meeting")}catch(E){console.error("Error requesting meeting:",E),alert("Failed to request meeting")}},T=E=>{y(E),A(!0)},Q=E=>{y(E),N(!0)};return r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(hs,{className:"w-8 h-8 text-blue-600 animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>s(-1),className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(ol,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Teachers"}),e.jsxs("p",{className:"text-gray-600",children:[c?.full_name,"  ",c?.class_name]})]})]}),c?.class_teacher_name&&e.jsx("div",{className:"card p-6 bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center",children:e.jsx(ha,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-xs text-blue-600 font-medium uppercase tracking-wide",children:"Class Teacher"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:c.class_teacher_name}),e.jsx("p",{className:"text-gray-600",children:c.class_name})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>T({id:c.class_teacher_id,name:c.class_teacher_name}),className:"btn bg-blue-600 text-white hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(wa,{className:"w-4 h-4"}),"Message"]}),e.jsxs("button",{onClick:()=>Q({id:c.class_teacher_id,name:c.class_teacher_name}),className:"btn bg-purple-600 text-white hover:bg-purple-700 flex items-center gap-2",children:[e.jsx(Ot,{className:"w-4 h-4"}),"Request Meeting"]})]})]})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(Rt,{className:"w-5 h-5 text-purple-600"}),"Subject Teachers"]})}),m.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(Rt,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{children:"No teachers found"})]}):e.jsx("div",{className:"divide-y",children:m.map(E=>e.jsx("div",{className:"p-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center overflow-hidden",children:E.profile_picture?e.jsx("img",{src:E.profile_picture,alt:E.name,className:"w-12 h-12 object-cover"}):e.jsx(ha,{className:"w-6 h-6 text-gray-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:E.name}),e.jsxs("p",{className:"text-sm text-gray-600 flex items-center gap-2",children:[e.jsx(as,{className:"w-4 h-4"}),E.role]}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 text-xs text-gray-500",children:[E.email&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ra,{className:"w-3 h-3"}),E.email]}),E.phone&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(er,{className:"w-3 h-3"}),E.phone]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>T(E),className:"btn btn-sm bg-gray-100 hover:bg-gray-200 flex items-center gap-1",children:[e.jsx(wa,{className:"w-4 h-4"}),"Message"]}),e.jsxs("button",{onClick:()=>Q(E),className:"btn btn-sm bg-purple-100 text-purple-700 hover:bg-purple-200 flex items-center gap-1",children:[e.jsx(Ot,{className:"w-4 h-4"}),"Meeting"]})]})]})},`${E.id}-${E.role}`))})]}),x&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full p-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:["Send Message to ",f?.name]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),e.jsx("input",{type:"text",value:v.subject,onChange:E=>U({...v,subject:E.target.value}),className:"input w-full",placeholder:"Enter subject"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Message"}),e.jsx("textarea",{value:v.message,onChange:E=>U({...v,message:E.target.value}),className:"input w-full h-32",placeholder:"Type your message..."})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:()=>A(!1),className:"btn bg-gray-100 hover:bg-gray-200",children:"Cancel"}),e.jsxs("button",{onClick:R,disabled:!v.subject||!v.message,className:"btn btn-primary flex items-center gap-2",children:[e.jsx(va,{className:"w-4 h-4"}),"Send Message"]})]})]})}),g&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full p-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:["Request Meeting with ",f?.name]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject/Reason"}),e.jsx("input",{type:"text",value:D.subject,onChange:E=>M({...D,subject:E.target.value}),className:"input w-full",placeholder:"e.g., Discuss academic progress"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preferred Date"}),e.jsx("input",{type:"date",value:D.preferred_date,onChange:E=>M({...D,preferred_date:E.target.value}),className:"input w-full",min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preferred Time"}),e.jsx("input",{type:"time",value:D.preferred_time,onChange:E=>M({...D,preferred_time:E.target.value}),className:"input w-full"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Additional Notes"}),e.jsx("textarea",{value:D.message,onChange:E=>M({...D,message:E.target.value}),className:"input w-full h-24",placeholder:"Any additional information..."})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:()=>N(!1),className:"btn bg-gray-100 hover:bg-gray-200",children:"Cancel"}),e.jsxs("button",{onClick:j,disabled:!D.subject,className:"btn btn-primary flex items-center gap-2",children:[e.jsx(Ot,{className:"w-4 h-4"}),"Request Meeting"]})]})]})})]})}function FH(){const{childId:t}=qd(),s=la(),{user:a}=Us(),[r,l]=h.useState(!0),[c,o]=h.useState(null),[m,u]=h.useState([]),[x,A]=h.useState(!1),[g,N]=h.useState(null),[f,y]=h.useState(""),[v,U]=h.useState(null);h.useEffect(()=>{D()},[a]),h.useEffect(()=>{v&&t&&M()},[v,t]),h.useEffect(()=>{c?.student_id&&K()},[c]);const D=async()=>{try{const se=await F.get(`${ee}/parents.php?user_id=${a?.id}`);se.data.parents?.length>0&&U(se.data.parents[0].id)}catch(se){console.error("Error fetching parent ID:",se)}},M=async()=>{try{const se=await F.get(`${ee}/parent_portal.php?resource=child_details&child_id=${t}`);se.data.success&&o(se.data.child)}catch(se){console.error("Error fetching child details:",se)}finally{l(!1)}},K=async()=>{try{const se=await F.get(`${ee}/parent_portal.php?resource=report_cards&student_id=${c.student_id}`);se.data.success&&u(se.data.report_cards||[])}catch(se){console.error("Error fetching report cards:",se)}},$=async()=>{try{const se=await F.post(`${ee}/parent_portal.php?resource=acknowledge_report`,{student_id:c.student_id,parent_id:v,term:g.term,academic_year:g.academic_year,signature:f});se.data.success?(alert("Report card acknowledged successfully!"),A(!1),y(""),K()):alert(se.data.error||"Failed to acknowledge")}catch(se){console.error("Error acknowledging report:",se),alert("Failed to acknowledge report card")}},P=se=>{N(se),A(!0)};return r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(hs,{className:"w-8 h-8 text-blue-600 animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>s(-1),className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(ol,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Report Cards"}),e.jsxs("p",{className:"text-gray-600",children:[c?.full_name,"  ",c?.class_name]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(Kt,{className:"w-5 h-5 text-purple-600"}),"Available Report Cards"]})}),m.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(Kt,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{children:"No report cards available yet"})]}):e.jsx("div",{className:"divide-y",children:m.map((se,z)=>e.jsx("div",{className:"p-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(Is,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-gray-900",children:[se.term," - ",se.academic_year]}),e.jsxs("p",{className:"text-sm text-gray-600 flex items-center gap-2",children:[e.jsx(Ot,{className:"w-4 h-4"}),"Academic Year ",se.academic_year]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[se.acknowledged_at?e.jsxs("span",{className:"flex items-center gap-1 text-green-600 text-sm",children:[e.jsx(Mt,{className:"w-4 h-4"}),"Acknowledged on ",new Date(se.acknowledged_at).toLocaleDateString()]}):e.jsxs("span",{className:"flex items-center gap-1 text-yellow-600 text-sm",children:[e.jsx(Wt,{className:"w-4 h-4"}),"Pending acknowledgment"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>s(`/parent/child/${t}/report/${se.term}/${se.academic_year}`),className:"btn btn-sm bg-blue-100 text-blue-700 hover:bg-blue-200 flex items-center gap-1",children:[e.jsx(Kt,{className:"w-4 h-4"}),"View"]}),e.jsxs("button",{className:"btn btn-sm bg-gray-100 hover:bg-gray-200 flex items-center gap-1",children:[e.jsx(xs,{className:"w-4 h-4"}),"Download"]}),!se.acknowledged_at&&e.jsxs("button",{onClick:()=>P(se),className:"btn btn-sm bg-green-600 text-white hover:bg-green-700 flex items-center gap-1",children:[e.jsx(ll,{className:"w-4 h-4"}),"Acknowledge"]})]})]})]})},z))})]}),e.jsxs("div",{className:"card p-6 bg-blue-50 border border-blue-200",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"About Report Card Acknowledgment"}),e.jsx("p",{className:"text-sm text-blue-700",children:"By acknowledging a report card, you confirm that you have reviewed your child's academic performance for the term. This helps the school track parent engagement and ensures you're informed about your child's progress."})]}),x&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Acknowledge Report Card"}),e.jsxs("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Student:"})," ",c?.full_name]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Term:"})," ",g?.term]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Academic Year:"})," ",g?.academic_year]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Digital Signature (Type your full name)"}),e.jsx("input",{type:"text",value:f,onChange:se=>y(se.target.value),className:"input w-full",placeholder:"Enter your full name"})]}),e.jsxs("p",{className:"text-xs text-gray-500 mb-4",children:["By signing, I acknowledge that I have reviewed my child's report card for ",g?.term,"of the ",g?.academic_year," academic year."]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>{A(!1),y("")},className:"btn bg-gray-100 hover:bg-gray-200",children:"Cancel"}),e.jsxs("button",{onClick:$,disabled:!f.trim(),className:"btn btn-primary flex items-center gap-2",children:[e.jsx(Mt,{className:"w-4 h-4"}),"Acknowledge"]})]})]})})]})}function EH(){const t=la(),{user:s}=Us(),[a,r]=h.useState(!0),[l,c]=h.useState([]),[o,m]=h.useState(null),[u,x]=h.useState("all");h.useEffect(()=>{A()},[s]),h.useEffect(()=>{o&&g()},[o]);const A=async()=>{try{const v=await F.get(`${ee}/parents.php?user_id=${s?.id}`);v.data.parents?.length>0&&m(v.data.parents[0].id)}catch(v){console.error("Error fetching parent ID:",v)}},g=async()=>{try{r(!0);const v=await F.get(`${ee}/parent_portal.php?resource=meetings&parent_id=${o}`);v.data.success&&c(v.data.meetings||[])}catch(v){console.error("Error fetching meetings:",v)}finally{r(!1)}},N=async v=>{if(confirm("Are you sure you want to cancel this meeting request?"))try{(await F.delete(`${ee}/parent_portal.php?resource=meeting&id=${v}`)).data.success&&g()}catch(U){console.error("Error cancelling meeting:",U)}},f=v=>{switch(v){case"pending":return e.jsxs("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-700 text-xs rounded-full flex items-center gap-1",children:[e.jsx(Wt,{className:"w-3 h-3"})," Pending"]});case"approved":return e.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs rounded-full flex items-center gap-1",children:[e.jsx(Mt,{className:"w-3 h-3"})," Approved"]});case"rejected":return e.jsxs("span",{className:"px-2 py-1 bg-red-100 text-red-700 text-xs rounded-full flex items-center gap-1",children:[e.jsx(Js,{className:"w-3 h-3"})," Rejected"]});case"completed":return e.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full flex items-center gap-1",children:[e.jsx(Mt,{className:"w-3 h-3"})," Completed"]});case"cancelled":return e.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded-full flex items-center gap-1",children:[e.jsx(Js,{className:"w-3 h-3"})," Cancelled"]});default:return null}},y=u==="all"?l:l.filter(v=>v.status===u);return a?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(hs,{className:"w-8 h-8 text-blue-600 animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>t(-1),className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(ol,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Meeting Requests"}),e.jsx("p",{className:"text-gray-600",children:"Manage your parent-teacher meeting requests"})]})]})}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["all","pending","approved","completed","rejected","cancelled"].map(v=>e.jsxs("button",{onClick:()=>x(v),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${u===v?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[v.charAt(0).toUpperCase()+v.slice(1),v!=="all"&&e.jsxs("span",{className:"ml-1",children:["(",l.filter(U=>U.status===v).length,")"]})]},v))}),e.jsx("div",{className:"card",children:y.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(Ot,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{children:"No meeting requests found"}),e.jsx("p",{className:"text-sm mt-1",children:"Request a meeting from your child's teacher page"})]}):e.jsx("div",{className:"divide-y",children:y.map(v=>e.jsx("div",{className:"p-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center",children:e.jsx(ha,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:v.subject}),f(v.status)]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["With: ",v.teacher_name,"  For: ",v.student_name]}),v.status==="approved"&&v.meeting_date&&e.jsxs("div",{className:"mt-2 p-3 bg-green-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-green-800 font-medium",children:"Meeting Scheduled"}),e.jsxs("div",{className:"flex flex-wrap gap-4 mt-1 text-sm text-green-700",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ot,{className:"w-4 h-4"}),new Date(v.meeting_date).toLocaleDateString()]}),v.meeting_time&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Wt,{className:"w-4 h-4"}),v.meeting_time]}),v.meeting_location&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Qn,{className:"w-4 h-4"}),v.meeting_location]}),v.meeting_link&&e.jsxs("a",{href:v.meeting_link,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-blue-600 hover:underline",children:[e.jsx(Qh,{className:"w-4 h-4"}),"Join Online"]})]})]}),v.preferred_date&&v.status==="pending"&&e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Preferred: ",new Date(v.preferred_date).toLocaleDateString(),v.preferred_time&&` at ${v.preferred_time}`]}),v.message&&e.jsx("p",{className:"text-sm text-gray-600 mt-2 bg-gray-50 p-2 rounded",children:v.message}),v.teacher_notes&&e.jsxs("p",{className:"text-sm text-blue-700 mt-2 bg-blue-50 p-2 rounded",children:[e.jsx("strong",{children:"Teacher's Note:"})," ",v.teacher_notes]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["Requested: ",new Date(v.created_at).toLocaleString()]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[v.status==="pending"&&e.jsx("button",{onClick:()=>N(v.id),className:"btn btn-sm bg-red-100 text-red-700 hover:bg-red-200",children:"Cancel"}),v.status==="approved"&&v.meeting_link&&e.jsx("a",{href:v.meeting_link,target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm btn-primary",children:"Join Meeting"})]})]})},v.id))})})]})}function DH(){const{user:t}=Us(),[s,a]=h.useState("send"),[r,l]=h.useState(!1),[c,o]=h.useState([]),[m,u]=h.useState([]),[x,A]=h.useState({total:0,sent:0,delivered:0,failed:0,today:0}),[g,N]=h.useState([]),[f,y]=h.useState(""),[v,U]=h.useState(null),[D,M]=h.useState({phone:"",recipient_name:"",message:""}),[K,$]=h.useState({recipient_type:"all_parents",message:"",template_name:""}),[P,se]=h.useState({name:"",category:"general",message_template:"",variables:[]}),[z,R]=h.useState(!1),[j,T]=h.useState({api_token:"",phone_number_id:"",business_account_id:""}),[Q,E]=h.useState(!1),[te,C]=h.useState({status:"",dateFrom:"",dateTo:"",search:""}),[O,V]=h.useState([]),[re,ge]=h.useState([]),[xe,Z]=h.useState({daily:[],weekly:[],monthly:[],deliveryRate:0,avgResponseTime:0}),[I,H]=h.useState([]),[ae,k]=h.useState(""),[B,w]=h.useState([]),[oe,ne]=h.useState(!1),[Fe,je]=h.useState(!1),[Ge,ze]=h.useState(!1),[Xe,st]=h.useState({recipient_type:"all_parents",message:"",scheduled_date:"",scheduled_time:"",repeat:"none",template_id:""}),[ce,_e]=h.useState({name:"",description:"",members:[]}),[le,Pe]=h.useState({days_before_due:7,message_template:"",auto_send:!1,include_amount:!0});h.useEffect(()=>{we(),fe(),ye(),Ke(),ie(),q(),pe(),Me(),Se()},[]);const we=async()=>{try{const be=await F.get(`${ee}/whatsapp.php?action=templates`);o(be.data.templates||[])}catch(be){console.error("Error fetching templates:",be)}},fe=async()=>{try{const be=await F.get(`${ee}/whatsapp.php?action=stats`);A(be.data.stats||{})}catch(be){console.error("Error fetching stats:",be)}},ye=async()=>{try{const be=await F.get(`${ee}/whatsapp.php?action=history&limit=50`);u(be.data.messages||[])}catch(be){console.error("Error fetching history:",be)}},Ke=async()=>{try{const be=await F.get(`${ee}/whatsapp.php`);be.data.settings&&T({api_token:be.data.settings.api_token||"",phone_number_id:be.data.settings.phone_number_id||"",business_account_id:be.data.settings.business_account_id||""})}catch(be){console.error("Error fetching API settings:",be)}},ve=async()=>{try{E(!0),await F.post(`${ee}/whatsapp.php?action=save_settings`,j),alert(" WhatsApp API settings saved successfully!")}catch(be){console.error("Error saving settings:",be),alert("Failed to save settings")}finally{E(!1)}},ie=async()=>{try{const be=await F.get(`${ee}/whatsapp.php?action=scheduled`);V(be.data.scheduled||[])}catch(be){console.error(be)}},q=async()=>{try{const be=await F.get(`${ee}/whatsapp.php?action=groups`);ge(be.data.groups||[])}catch(be){console.error(be)}},pe=async()=>{try{const be=await F.get(`${ee}/whatsapp.php?action=analytics`);Z(be.data.analytics||{daily:[],weekly:[],monthly:[],deliveryRate:0,avgResponseTime:0})}catch(be){console.error(be)}},Me=async()=>{try{const be=await F.get(`${ee}/classes.php`);H(be.data.classes||be.data||[])}catch(be){console.error(be)}},Se=async()=>{try{const be=await F.get(`${ee}/whatsapp.php?action=fee_reminders`);w(be.data.reminders||[])}catch(be){console.error(be)}},Ne=async be=>{try{l(!0);const Ue=(await F.get(`${ee}/parents.php?class_id=${be}`)).data.parents||[];N(Ue.map(Ct=>({id:Ct.id,name:`${Ct.first_name||""} ${Ct.last_name||""}`.trim(),phone:Ct.phone||Ct.guardian_phone,type:"parent",student_name:Ct.student_name})))}catch(lt){console.error(lt),N([])}finally{l(!1)}},et=m.filter(be=>{const lt=!te.status||be.status===te.status,Ue=!te.search||be.recipient_name?.toLowerCase().includes(te.search.toLowerCase())||be.phone?.includes(te.search)||be.message?.toLowerCase().includes(te.search.toLowerCase()),Ct=!te.dateFrom||new Date(be.sent_at)>=new Date(te.dateFrom),Et=!te.dateTo||new Date(be.sent_at)<=new Date(te.dateTo+"T23:59:59");return lt&&Ue&&Ct&&Et}),Ce=()=>{const be=new ms;be.setFontSize(18),be.text("WhatsApp Message History",14,22),be.setFontSize(10),be.text(`Generated: ${new Date().toLocaleString()}`,14,30),be.text(`Total Messages: ${et.length}`,14,36),Ma(be,{startY:42,head:[["Date","Recipient","Phone","Status","Message"]],body:et.map(lt=>[lt.sent_at?.split(" ")[0]||"-",lt.recipient_name||"-",lt.phone||"-",lt.status||"-",(lt.message||"").substring(0,50)+(lt.message?.length>50?"...":"")]),styles:{fontSize:8},columnStyles:{4:{cellWidth:60}}}),be.save(`whatsapp_history_${new Date().toISOString().split("T")[0]}.pdf`)},ft=()=>{const be=`Date,Recipient,Phone,Status,Message
`+et.map(Ct=>`"${Ct.sent_at||""}","${Ct.recipient_name||""}","${Ct.phone||""}","${Ct.status||""}","${(Ct.message||"").replace(/"/g,'""')}"`).join(`
`),lt=new Blob([be],{type:"text/csv"}),Ue=document.createElement("a");Ue.href=URL.createObjectURL(lt),Ue.download=`whatsapp_history_${new Date().toISOString().split("T")[0]}.csv`,Ue.click()},qe=async be=>{if(be.preventDefault(),!Xe.message||!Xe.scheduled_date||!Xe.scheduled_time){alert("Please fill all required fields");return}try{await F.post(`${ee}/whatsapp.php?action=schedule`,{...Xe,scheduled_at:`${Xe.scheduled_date} ${Xe.scheduled_time}`,created_by:t?.id}),alert(" Message scheduled successfully!"),ne(!1),st({recipient_type:"all_parents",message:"",scheduled_date:"",scheduled_time:"",repeat:"none",template_id:""}),ie()}catch{alert("Failed to schedule")}},W=async be=>{if(confirm("Cancel this scheduled message?"))try{await F.delete(`${ee}/whatsapp.php?action=schedule&id=${be}`),ie()}catch{alert("Failed")}},Ie=async be=>{if(be.preventDefault(),!ce.name){alert("Enter group name");return}try{await F.post(`${ee}/whatsapp.php?action=save_group`,ce),alert(" Group saved!"),je(!1),_e({name:"",description:"",members:[]}),q()}catch{alert("Failed")}},mt=async be=>{if(confirm("Delete this group?"))try{await F.delete(`${ee}/whatsapp.php?action=delete_group&id=${be}`),q()}catch{alert("Failed")}},pt=async be=>{try{l(!0),await F.post(`${ee}/whatsapp.php?action=retry`,{message_id:be.id}),alert(" Message resent!"),ye(),fe()}catch{alert("Failed to retry")}finally{l(!1)}},kt=async be=>{be.preventDefault();try{await F.post(`${ee}/whatsapp.php?action=save_fee_reminder`,le),alert(" Fee reminder settings saved!"),ze(!1),Se()}catch{alert("Failed")}},J=async()=>{if(!ae||!K.message){alert("Select a class and enter message");return}await Ne(ae)},Je=async be=>{try{l(!0);let lt="";be==="all_parents"?lt=`${ee}/parents.php`:be==="all_teachers"?lt=`${ee}/teachers.php`:be==="class_parents"&&(lt=`${ee}/parents.php?has_students=true`);const Ue=await F.get(lt),Ct=Ue.data.parents||Ue.data.teachers||[];N(Ct.map(Et=>({id:Et.id,name:`${Et.first_name||""} ${Et.last_name||""}`.trim()||Et.name,phone:Et.phone||Et.guardian_phone,type:be.includes("parent")?"parent":"teacher"})))}catch(lt){console.error("Error fetching recipients:",lt),N([])}finally{l(!1)}},_t=async()=>{if(!D.phone||!D.message){alert("Please enter phone number and message");return}try{l(!0);const be=await F.post(`${ee}/whatsapp.php?action=send`,{...D,sent_by:t?.id});be.data.success?(be.data.sent_via==="api"?alert(" Message sent successfully via WhatsApp!"):be.data.needs_config?(alert(` WhatsApp Business API not configured.

${be.data.config_message}

Go to Settings tab to configure the API, or click OK to open WhatsApp Web.`),be.data.link&&window.open(be.data.link,"_blank")):be.data.link&&(window.open(be.data.link,"_blank"),alert("Message logged! WhatsApp opened in a new tab.")),M({phone:"",recipient_name:"",message:""}),fe(),ye()):alert("Failed to send message: "+(be.data.error||"Unknown error"))}catch(be){console.error("Error sending message:",be),alert("Failed to send message: "+(be.response?.data?.error||be.message))}finally{l(!1)}},$t=async()=>{if(g.length===0||!K.message){alert("Please select recipients and enter a message");return}try{l(!0);const be=await F.post(`${ee}/whatsapp.php?action=send_bulk`,{recipients:g.filter(lt=>lt.phone).map(lt=>({phone:lt.phone,name:lt.name,type:lt.type,parent_name:lt.name,student_name:lt.student_name||""})),message:K.message,template_name:K.template_name,sent_by:t?.id});be.data.success&&(alert(`${be.data.sent_count} messages logged successfully!`),be.data.results.slice(0,3).forEach((Ue,Ct)=>{setTimeout(()=>window.open(Ue.link,"_blank"),Ct*500)}),fe(),ye())}catch(be){console.error("Error sending bulk messages:",be),alert("Failed to send messages")}finally{l(!1)}},me=async()=>{if(!P.name||!P.message_template){alert("Please enter template name and message");return}try{l(!0),await F.post(`${ee}/whatsapp.php?action=save_template`,P),alert("Template saved successfully!"),R(!1),se({name:"",category:"general",message_template:"",variables:[]}),we()}catch(be){console.error("Error saving template:",be),alert("Failed to save template")}finally{l(!1)}},Ze=be=>{U(be),s==="send"?M(lt=>({...lt,message:be.message_template})):s==="bulk"&&$(lt=>({...lt,message:be.message_template,template_name:be.name}))},ct=be=>{switch(be){case"delivered":return e.jsx(Mt,{className:"w-4 h-4 text-green-600"});case"sent":return e.jsx(Wt,{className:"w-4 h-4 text-blue-600"});case"failed":return e.jsx(Js,{className:"w-4 h-4 text-red-600"});default:return e.jsx(Wt,{className:"w-4 h-4 text-gray-400"})}},Yt=be=>be?be.replace(/(\d{3})(\d{3})(\d{4})/,"+$1 $2 $3"):"";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(zu,{className:"w-7 h-7 text-green-600"}),"WhatsApp Messaging"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Send WhatsApp messages to parents and staff"})]}),e.jsxs("button",{onClick:()=>{fe(),ye()},className:"btn bg-gray-100 hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ns,{className:"w-4 h-4"}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-green-500 to-green-600 text-white",children:[e.jsx(zu,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Total Sent"}),e.jsx("p",{className:"text-2xl font-bold",children:x.total||0})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:[e.jsx(va,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Sent"}),e.jsx("p",{className:"text-2xl font-bold",children:x.sent||0})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-emerald-500 to-emerald-600 text-white",children:[e.jsx(Mt,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Delivered"}),e.jsx("p",{className:"text-2xl font-bold",children:x.delivered||0})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-red-500 to-red-600 text-white",children:[e.jsx(Js,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Failed"}),e.jsx("p",{className:"text-2xl font-bold",children:x.failed||0})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-purple-500 to-purple-600 text-white",children:[e.jsx(Wt,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Today"}),e.jsx("p",{className:"text-2xl font-bold",children:x.today||0})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-orange-500 to-orange-600 text-white",children:[e.jsx(Ot,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Scheduled"}),e.jsx("p",{className:"text-2xl font-bold",children:O.length})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-indigo-500 to-indigo-600 text-white",children:[e.jsx(Rt,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Groups"}),e.jsx("p",{className:"text-2xl font-bold",children:re.length})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-teal-500 to-teal-600 text-white",children:[e.jsx($s,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Delivery Rate"}),e.jsxs("p",{className:"text-2xl font-bold",children:[xe.deliveryRate||0,"%"]})]})]}),e.jsx("div",{className:"flex gap-1 flex-wrap bg-gray-100 p-1 rounded-lg",children:[{id:"send",label:"Send",icon:va},{id:"bulk",label:"Bulk",icon:Rt},{id:"scheduled",label:"Scheduled",icon:Ot},{id:"groups",label:"Groups",icon:Ti},{id:"templates",label:"Templates",icon:Kt},{id:"history",label:"History",icon:Sa},{id:"analytics",label:"Analytics",icon:Fs},{id:"fee_reminders",label:"Fee Alerts",icon:vs},{id:"settings",label:"Settings",icon:Ka}].map(be=>e.jsxs("button",{onClick:()=>a(be.id),className:`px-3 py-2 rounded-md font-medium flex items-center gap-1 text-sm transition-colors ${s===be.id?"bg-green-600 text-white shadow":"hover:bg-gray-200"}`,children:[e.jsx(be.icon,{className:"w-4 h-4"}),be.label]},be.id))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2",children:[s==="send"&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(va,{className:"w-5 h-5 text-green-600"}),"Send Single Message"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(er,{className:"w-4 h-4 inline mr-1"}),"Phone Number *"]}),e.jsx("input",{type:"tel",value:D.phone,onChange:be=>M({...D,phone:be.target.value}),className:"input",placeholder:"0241234567"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(ha,{className:"w-4 h-4 inline mr-1"}),"Recipient Name"]}),e.jsx("input",{type:"text",value:D.recipient_name,onChange:be=>M({...D,recipient_name:be.target.value}),className:"input",placeholder:"Parent Name"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message *"}),e.jsx("textarea",{value:D.message,onChange:be=>M({...D,message:be.target.value}),className:"input",rows:"5",placeholder:"Type your message here..."}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[D.message.length," characters"]})]}),e.jsxs("button",{onClick:_t,disabled:r,className:"btn bg-green-600 hover:bg-green-700 text-white flex items-center gap-2",children:[r?e.jsx(hs,{className:"w-4 h-4 animate-spin"}):e.jsx(va,{className:"w-4 h-4"}),"Send via WhatsApp"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"This will open WhatsApp Web/App with the message pre-filled."})]})]}),s==="bulk"&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Rt,{className:"w-5 h-5 text-green-600"}),"Send Bulk Message"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Recipients"}),e.jsxs("select",{value:K.recipient_type,onChange:be=>{$({...K,recipient_type:be.target.value}),Je(be.target.value)},className:"input",children:[e.jsx("option",{value:"",children:"Choose recipient group"}),e.jsx("option",{value:"all_parents",children:"All Parents"}),e.jsx("option",{value:"all_teachers",children:"All Teachers"}),e.jsx("option",{value:"class_parents",children:"Parents with Active Students"})]})]}),g.length>0&&e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-700 mb-2",children:[g.length," recipients selected"]}),e.jsxs("div",{className:"max-h-40 overflow-y-auto space-y-1",children:[g.slice(0,10).map((be,lt)=>e.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-2",children:[e.jsx(ha,{className:"w-3 h-3"}),be.name," - ",be.phone||"No phone"]},lt)),g.length>10&&e.jsxs("p",{className:"text-sm text-gray-500",children:["...and ",g.length-10," more"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message *"}),e.jsx("textarea",{value:K.message,onChange:be=>$({...K,message:be.target.value}),className:"input",rows:"5",placeholder:"Type your message here. Use {parent_name}, {student_name} for personalization."}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Variables: ","{parent_name}",", ","{student_name}",", ","{amount}",", ","{due_date}"]})]}),e.jsxs("button",{onClick:$t,disabled:r||g.length===0,className:"btn bg-green-600 hover:bg-green-700 text-white flex items-center gap-2",children:[r?e.jsx(hs,{className:"w-4 h-4 animate-spin"}):e.jsx(va,{className:"w-4 h-4"}),"Send to ",g.length," Recipients"]})]})]}),s==="templates"&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Kt,{className:"w-5 h-5 text-green-600"}),"Message Templates"]}),e.jsxs("button",{onClick:()=>R(!0),className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4"}),"New Template"]})]}),e.jsx("div",{className:"space-y-3",children:c.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No templates yet"}):c.map(be=>e.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:be.name}),e.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded",children:be.category})]}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:be.message_template})]}),e.jsx("button",{onClick:()=>Ze(be),className:"btn bg-green-100 text-green-700 hover:bg-green-200 text-sm",children:"Use"})]})},be.id))})]}),s==="history"&&e.jsxs("div",{className:"card overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Sa,{className:"w-5 h-5 text-green-600"}),"Message History (",et.length,")"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:Ce,className:"btn bg-blue-100 text-blue-700 hover:bg-blue-200 text-sm flex items-center gap-1",children:[e.jsx(xs,{className:"w-4 h-4"})," PDF"]}),e.jsxs("button",{onClick:ft,className:"btn bg-green-100 text-green-700 hover:bg-green-200 text-sm flex items-center gap-1",children:[e.jsx(qo,{className:"w-4 h-4"})," CSV"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ws,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search...",value:te.search,onChange:be=>C({...te,search:be.target.value}),className:"input pl-9 text-sm"})]}),e.jsxs("select",{value:te.status,onChange:be=>C({...te,status:be.target.value}),className:"input text-sm",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"sent",children:"Sent"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"failed",children:"Failed"})]}),e.jsx("input",{type:"date",value:te.dateFrom,onChange:be=>C({...te,dateFrom:be.target.value}),className:"input text-sm",placeholder:"From"}),e.jsx("input",{type:"date",value:te.dateTo,onChange:be=>C({...te,dateTo:be.target.value}),className:"input text-sm",placeholder:"To"})]})]}),e.jsx("div",{className:"divide-y max-h-[400px] overflow-y-auto",children:et.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No messages found"}):et.map(be=>e.jsx("div",{className:"p-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[ct(be.status),e.jsx("span",{className:"font-medium",children:be.recipient_name||"Unknown"}),e.jsx("span",{className:"text-sm text-gray-500",children:Yt(be.recipient_phone||be.phone)})]}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:be.message}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:be.sent_at||be.created_at})]}),e.jsxs("div",{className:"flex gap-1",children:[be.status==="failed"&&e.jsx("button",{onClick:()=>pt(be),className:"p-2 text-orange-600 hover:bg-orange-50 rounded-lg",title:"Retry",children:e.jsx(_h,{className:"w-4 h-4"})}),e.jsx("a",{href:`https://wa.me/${be.recipient_phone||be.phone}`,target:"_blank",rel:"noopener noreferrer",className:"p-2 text-green-600 hover:bg-green-50 rounded-lg",children:e.jsx(vh,{className:"w-4 h-4"})})]})]})},be.id))})]}),s==="scheduled"&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Ot,{className:"w-5 h-5 text-orange-600"})," Scheduled Messages"]}),e.jsxs("button",{onClick:()=>ne(!0),className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4"})," Schedule"]})]}),O.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Ot,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No scheduled messages"})]}):e.jsx("div",{className:"space-y-3",children:O.map(be=>e.jsx("div",{className:"border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${be.status==="pending"?"bg-yellow-100 text-yellow-800":be.status==="sent"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:be.status}),e.jsx("span",{className:"text-sm text-gray-500",children:be.recipient_type})]}),e.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:be.message}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1 flex items-center gap-1",children:[e.jsx(Wt,{className:"w-3 h-3"})," ",be.scheduled_at]}),be.repeat!=="none"&&e.jsxs("p",{className:"text-xs text-blue-600",children:["Repeats: ",be.repeat]})]}),be.status==="pending"&&e.jsx("button",{onClick:()=>W(be.id),className:"text-red-600 hover:bg-red-50 p-2 rounded",children:e.jsx(us,{className:"w-4 h-4"})})]})},be.id))})]}),s==="groups"&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Ti,{className:"w-5 h-5 text-indigo-600"})," Contact Groups"]}),e.jsxs("button",{onClick:()=>je(!0),className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4"})," New Group"]})]}),re.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Rt,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No contact groups"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:re.map(be=>e.jsx("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:be.name}),be.description&&e.jsx("p",{className:"text-sm text-gray-500",children:be.description}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[be.member_count||0," members"]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>{$({...K,recipient_type:`group_${be.id}`}),a("bulk")},className:"p-2 text-green-600 hover:bg-green-50 rounded",title:"Send to group",children:e.jsx(va,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>mt(be.id),className:"p-2 text-red-600 hover:bg-red-50 rounded",children:e.jsx(us,{className:"w-4 h-4"})})]})]})},be.id))})]}),s==="analytics"&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2 mb-6",children:[e.jsx(Fs,{className:"w-5 h-5 text-blue-600"})," Message Analytics"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg text-center",children:[e.jsx($s,{className:"w-8 h-8 mx-auto text-green-600 mb-2"}),e.jsxs("p",{className:"text-2xl font-bold text-green-700",children:[xe.deliveryRate||0,"%"]}),e.jsx("p",{className:"text-sm text-green-600",children:"Delivery Rate"})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg text-center",children:[e.jsx(zu,{className:"w-8 h-8 mx-auto text-blue-600 mb-2"}),e.jsx("p",{className:"text-2xl font-bold text-blue-700",children:x.total||0}),e.jsx("p",{className:"text-sm text-blue-600",children:"Total Messages"})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg text-center",children:[e.jsx(Wt,{className:"w-8 h-8 mx-auto text-purple-600 mb-2"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-700",children:[xe.avgResponseTime||0,"s"]}),e.jsx("p",{className:"text-sm text-purple-600",children:"Avg Response Time"})]})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium mb-3",children:"Last 7 Days"}),e.jsx("div",{className:"space-y-2",children:(xe.daily||[]).slice(0,7).map((be,lt)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm text-gray-500 w-20",children:be.date}),e.jsx("div",{className:"flex-1 bg-gray-100 rounded-full h-4 overflow-hidden",children:e.jsx("div",{className:"bg-green-500 h-full",style:{width:`${Math.min(be.count/(Math.max(...(xe.daily||[]).map(Ue=>Ue.count))||1)*100,100)}%`}})}),e.jsx("span",{className:"text-sm font-medium w-10 text-right",children:be.count})]},lt))})]})]}),s==="fee_reminders"&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(vs,{className:"w-5 h-5 text-yellow-600"})," Fee Reminder Settings"]}),e.jsxs("button",{onClick:()=>ze(!0),className:"btn btn-primary flex items-center gap-2",children:[e.jsx(Ka,{className:"w-4 h-4"})," Configure"]})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:[e.jsx("h3",{className:"font-medium text-yellow-800 mb-2",children:" Automatic Fee Reminders"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"Send automatic WhatsApp reminders to parents about upcoming or overdue fees."})]}),e.jsxs("div",{className:"border rounded-lg p-4 mb-4",children:[e.jsxs("h3",{className:"font-medium mb-3 flex items-center gap-2",children:[e.jsx(Qs,{className:"w-5 h-5"})," Send to Specific Class"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("select",{value:ae,onChange:be=>{k(be.target.value),be.target.value&&Ne(be.target.value)},className:"input",children:[e.jsx("option",{value:"",children:"Select Class"}),I.map(be=>e.jsx("option",{value:be.id,children:be.class_name||be.name},be.id))]}),e.jsxs("button",{onClick:J,disabled:!ae,className:"btn bg-green-600 text-white hover:bg-green-700 disabled:opacity-50",children:["Load Parents (",g.length,")"]})]})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium mb-3",children:"Recent Fee Reminders"}),B.length===0?e.jsx("p",{className:"text-gray-500 text-sm",children:"No fee reminders sent yet"}):e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:B.map(be=>e.jsxs("div",{className:"flex items-center justify-between text-sm p-2 bg-gray-50 rounded",children:[e.jsxs("span",{children:[be.student_name," - GHS ",be.amount]}),e.jsx("span",{className:"text-gray-500",children:be.sent_at})]},be.id))})]})]}),s==="settings"&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:e.jsx(Ka,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"WhatsApp Business API Settings"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Configure your WhatsApp Business Cloud API credentials"})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[e.jsx("h3",{className:"font-medium text-blue-800 mb-2",children:" How to get WhatsApp Business API access:"}),e.jsxs("ol",{className:"text-sm text-blue-700 space-y-1 list-decimal list-inside",children:[e.jsxs("li",{children:["Go to ",e.jsx("a",{href:"https://developers.facebook.com",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"developers.facebook.com"})]}),e.jsx("li",{children:"Create a Meta Business Account (if you don't have one)"}),e.jsx("li",{children:'Create a new app and select "Business" type'}),e.jsx("li",{children:"Add WhatsApp product to your app"}),e.jsx("li",{children:"Get your Phone Number ID and Access Token from the WhatsApp settings"}),e.jsx("li",{children:"Copy the credentials below"})]}),e.jsx("p",{className:"text-xs text-blue-600 mt-2",children:"Note: WhatsApp Business API has a free tier with 1,000 free conversations per month."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Access Token (API Token) *"}),e.jsx("input",{type:"password",value:j.api_token,onChange:be=>T({...j,api_token:be.target.value}),className:"input font-mono text-sm",placeholder:"EAAxxxxxxxxxxxxxxx..."}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Found in WhatsApp  API Setup  Temporary/Permanent Access Token"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number ID *"}),e.jsx("input",{type:"text",value:j.phone_number_id,onChange:be=>T({...j,phone_number_id:be.target.value}),className:"input font-mono",placeholder:"1234567890123456"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Found in WhatsApp  API Setup  Phone Number ID"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Business Account ID (Optional)"}),e.jsx("input",{type:"text",value:j.business_account_id,onChange:be=>T({...j,business_account_id:be.target.value}),className:"input font-mono",placeholder:"1234567890123456"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Found in WhatsApp  API Setup  WhatsApp Business Account ID"})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsx("button",{onClick:ve,disabled:Q||!j.api_token||!j.phone_number_id,className:"btn btn-primary flex items-center gap-2",children:Q?e.jsxs(e.Fragment,{children:[e.jsx(hs,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Mt,{className:"w-4 h-4"}),"Save API Settings"]})})})]}),e.jsxs("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-yellow-800 mb-2",children:" Important Notes:"}),e.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[e.jsx("li",{children:" Messages can only be sent to users who have opted-in or messaged you first"}),e.jsx("li",{children:" Keep your Access Token secure - never share it publicly"}),e.jsx("li",{children:" Test with your own number first before sending to parents"}),e.jsx("li",{children:" Without API configuration, messages will open WhatsApp Web instead"})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"card p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Quick Templates"}),e.jsx("div",{className:"space-y-2",children:c.slice(0,5).map(be=>e.jsxs("button",{onClick:()=>Ze(be),className:"w-full text-left p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors",children:[e.jsx("p",{className:"font-medium text-sm text-gray-900",children:be.name}),e.jsx("p",{className:"text-xs text-gray-500 capitalize",children:be.category})]},be.id))})]}),e.jsxs("div",{className:"card p-4 bg-green-50 border-green-200",children:[e.jsx("h3",{className:"font-semibold text-green-800 mb-2",children:"How it works"}),e.jsxs("ul",{className:"text-sm text-green-700 space-y-2",children:[e.jsx("li",{children:e.jsx("strong",{children:"With API configured:"})}),e.jsx("li",{children:"1. Enter phone number and message"}),e.jsx("li",{children:'2. Click "Send via WhatsApp"'}),e.jsx("li",{children:"3. Message is sent directly! "}),e.jsx("li",{className:"pt-2",children:e.jsx("strong",{children:"Without API:"})}),e.jsx("li",{children:" Opens WhatsApp Web to send manually"})]}),e.jsx("p",{className:"text-xs text-green-600 mt-3",children:'Go to "API Settings" tab to configure direct sending.'})]})]})]}),z&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Create New Template"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Template Name"}),e.jsx("input",{type:"text",value:P.name,onChange:be=>se({...P,name:be.target.value}),className:"input",placeholder:"e.g., fee_reminder_urgent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),e.jsxs("select",{value:P.category,onChange:be=>se({...P,category:be.target.value}),className:"input",children:[e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"fee_reminder",children:"Fee Reminder"}),e.jsx("option",{value:"attendance",children:"Attendance"}),e.jsx("option",{value:"exam",children:"Exam"}),e.jsx("option",{value:"admission",children:"Admission"}),e.jsx("option",{value:"event",children:"Event"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message Template"}),e.jsx("textarea",{value:P.message_template,onChange:be=>se({...P,message_template:be.target.value}),className:"input",rows:"4",placeholder:"Dear {parent_name}, ..."}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Use ","{variable_name}"," for dynamic content"]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:()=>R(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{onClick:me,disabled:r,className:"btn btn-primary",children:r?"Saving...":"Save Template"})]})]})}),oe&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Ot,{className:"w-5 h-5 text-orange-600"})," Schedule Message"]}),e.jsx("button",{onClick:()=>ne(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:qe,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Recipients"}),e.jsxs("select",{value:Xe.recipient_type,onChange:be=>st({...Xe,recipient_type:be.target.value}),className:"input",children:[e.jsx("option",{value:"all_parents",children:"All Parents"}),e.jsx("option",{value:"all_teachers",children:"All Teachers"}),e.jsx("option",{value:"class_parents",children:"Parents with Active Students"}),re.map(be=>e.jsxs("option",{value:`group_${be.id}`,children:["Group: ",be.name]},be.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Date *"}),e.jsx("input",{type:"date",value:Xe.scheduled_date,onChange:be=>st({...Xe,scheduled_date:be.target.value}),className:"input",required:!0,min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Time *"}),e.jsx("input",{type:"time",value:Xe.scheduled_time,onChange:be=>st({...Xe,scheduled_time:be.target.value}),className:"input",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Repeat"}),e.jsxs("select",{value:Xe.repeat,onChange:be=>st({...Xe,repeat:be.target.value}),className:"input",children:[e.jsx("option",{value:"none",children:"Don't Repeat"}),e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Use Template"}),e.jsxs("select",{value:Xe.template_id,onChange:be=>{const lt=c.find(Ue=>Ue.id==be.target.value);st({...Xe,template_id:be.target.value,message:lt?.message_template||Xe.message})},className:"input",children:[e.jsx("option",{value:"",children:"-- Select Template --"}),c.map(be=>e.jsx("option",{value:be.id,children:be.name},be.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Message *"}),e.jsx("textarea",{value:Xe.message,onChange:be=>st({...Xe,message:be.target.value}),className:"input",rows:"4",required:!0,placeholder:"Type your message..."})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>ne(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-primary flex items-center gap-2",children:[e.jsx(Ot,{className:"w-4 h-4"})," Schedule"]})]})]})]})}),Fe&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Ti,{className:"w-5 h-5 text-indigo-600"})," Create Contact Group"]}),e.jsx("button",{onClick:()=>je(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:Ie,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Group Name *"}),e.jsx("input",{type:"text",value:ce.name,onChange:be=>_e({...ce,name:be.target.value}),className:"input",required:!0,placeholder:"e.g., Grade 6 Parents"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description"}),e.jsx("input",{type:"text",value:ce.description,onChange:be=>_e({...ce,description:be.target.value}),className:"input",placeholder:"Optional description"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Add Members From"}),e.jsxs("select",{onChange:async be=>{be.target.value&&(await Je(be.target.value),_e({...ce,members:g.map(lt=>lt.id)}))},className:"input",children:[e.jsx("option",{value:"",children:"-- Select Source --"}),e.jsx("option",{value:"all_parents",children:"All Parents"}),e.jsx("option",{value:"all_teachers",children:"All Teachers"})]}),ce.members.length>0&&e.jsxs("p",{className:"text-sm text-green-600 mt-1",children:[ce.members.length," members selected"]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>je(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-primary flex items-center gap-2",children:[e.jsx(Br,{className:"w-4 h-4"})," Save Group"]})]})]})]})}),Ge&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(vs,{className:"w-5 h-5 text-yellow-600"})," Fee Reminder Settings"]}),e.jsx("button",{onClick:()=>ze(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:kt,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Days Before Due Date"}),e.jsx("input",{type:"number",value:le.days_before_due,onChange:be=>Pe({...le,days_before_due:parseInt(be.target.value)}),className:"input",min:"1",max:"30"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Message Template"}),e.jsx("textarea",{value:le.message_template,onChange:be=>Pe({...le,message_template:be.target.value}),className:"input",rows:"4",placeholder:"Dear {parent_name}, this is a reminder that fees of GHS {amount} for {student_name} is due on {due_date}..."}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Variables: ","{parent_name}",", ","{student_name}",", ","{amount}",", ","{due_date}"]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:le.auto_send,onChange:be=>Pe({...le,auto_send:be.target.checked}),className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Enable automatic sending"})]})}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:le.include_amount,onChange:be=>Pe({...le,include_amount:be.target.checked}),className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Include fee amount in message"})]})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>ze(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-primary flex items-center gap-2",children:[e.jsx(Br,{className:"w-4 h-4"})," Save Settings"]})]})]})]})})]})}function UH(){const{user:t}=Us(),[s,a]=h.useState("send"),[r,l]=h.useState(!1),[c,o]=h.useState([]),[m,u]=h.useState([]),[x,A]=h.useState({total:0,sent:0,delivered:0,failed:0,today:0,credits:0}),[g,N]=h.useState([]),[f,y]=h.useState([]),[v,U]=h.useState(""),[D,M]=h.useState([]),[K,$]=h.useState([]),[P,se]=h.useState({status:"",dateFrom:"",dateTo:"",search:""}),[z,R]=h.useState({phone:"",recipient_name:"",message:""}),[j,T]=h.useState({recipient_type:"all_parents",message:"",template_name:""}),[Q,E]=h.useState({name:"",category:"general",message_template:""}),[te,C]=h.useState(!1),[O,V]=h.useState({recipient_type:"all_parents",message:"",scheduled_date:"",scheduled_time:"",repeat:"none"}),[re,ge]=h.useState(!1),[xe,Z]=h.useState({provider:"hubtel",api_key:"",api_secret:"",sender_id:""}),[I,H]=h.useState(!1),ae=`${ee}/sms.php`;h.useEffect(()=>{k(),B(),w(),oe(),ne(),Fe(),je()},[]);const k=async()=>{try{const q=await F.get(`${ae}?action=templates`);o(q.data.templates||[])}catch(q){console.error(q)}},B=async()=>{try{const q=await F.get(`${ae}?action=stats`);A(q.data.stats||{})}catch(q){console.error(q)}},w=async()=>{try{const q=await F.get(`${ae}?action=history&limit=100`);u(q.data.messages||[])}catch(q){console.error(q)}},oe=async()=>{try{const q=await F.get(`${ae}?action=settings`);q.data.settings&&Z(q.data.settings)}catch(q){console.error(q)}},ne=async()=>{try{const q=await F.get(`${ee}/classes.php`);y(q.data.classes||q.data||[])}catch(q){console.error(q)}},Fe=async()=>{try{const q=await F.get(`${ae}?action=scheduled`);$(q.data.scheduled||[])}catch(q){console.error(q)}},je=async()=>{try{const q=await F.get(`${ae}?action=groups`);M(q.data.groups||[])}catch(q){console.error(q)}},Ge=async q=>{try{l(!0);let pe=q==="all_parents"?`${ee}/parents.php`:q==="all_teachers"?`${ee}/teachers.php`:`${ee}/parents.php?has_students=true`;const Me=await F.get(pe),Se=Me.data.parents||Me.data.teachers||[];N(Se.map(Ne=>({id:Ne.id,name:`${Ne.first_name||""} ${Ne.last_name||""}`.trim()||Ne.name,phone:Ne.phone||Ne.guardian_phone,type:q.includes("parent")?"parent":"teacher"})))}catch(pe){console.error(pe),N([])}finally{l(!1)}},ze=async q=>{try{l(!0);const Me=(await F.get(`${ee}/parents.php?class_id=${q}`)).data.parents||[];N(Me.map(Se=>({id:Se.id,name:`${Se.first_name||""} ${Se.last_name||""}`.trim(),phone:Se.phone||Se.guardian_phone,type:"parent",student_name:Se.student_name})))}catch(pe){console.error(pe),N([])}finally{l(!1)}},Xe=async()=>{if(!z.phone||!z.message){alert("Enter phone and message");return}try{l(!0);const q=await F.post(`${ae}?action=send`,{...z,sent_by:t?.id});q.data.success?(alert(" SMS sent successfully!"),R({phone:"",recipient_name:"",message:""}),B(),w()):alert("Failed: "+(q.data.error||"Unknown error"))}catch{alert("Failed to send SMS")}finally{l(!1)}},st=async()=>{if(g.length===0||!j.message){alert("Select recipients and enter message");return}try{l(!0);const q=await F.post(`${ae}?action=send_bulk`,{recipients:g.filter(pe=>pe.phone).map(pe=>({phone:pe.phone,name:pe.name,type:pe.type})),message:j.message,template_name:j.template_name,sent_by:t?.id});q.data.success&&(alert(` ${q.data.sent_count} SMS messages sent!`),B(),w())}catch{alert("Failed to send")}finally{l(!1)}},ce=async()=>{if(!Q.name||!Q.message_template){alert("Enter name and message");return}try{l(!0),await F.post(`${ae}?action=save_template`,Q),alert(" Template saved!"),C(!1),E({name:"",category:"general",message_template:""}),k()}catch{alert("Failed")}finally{l(!1)}},_e=async()=>{try{H(!0),await F.post(`${ae}?action=save_settings`,xe),alert(" SMS settings saved!")}catch{alert("Failed")}finally{H(!1)}},le=async q=>{if(q.preventDefault(),!O.message||!O.scheduled_date||!O.scheduled_time){alert("Fill all fields");return}try{await F.post(`${ae}?action=schedule`,{...O,scheduled_at:`${O.scheduled_date} ${O.scheduled_time}`,created_by:t?.id}),alert(" SMS scheduled!"),ge(!1),V({recipient_type:"all_parents",message:"",scheduled_date:"",scheduled_time:"",repeat:"none"}),Fe()}catch{alert("Failed")}},Pe=async q=>{if(confirm("Cancel this scheduled SMS?"))try{await F.delete(`${ae}?action=schedule&id=${q}`),Fe()}catch{alert("Failed")}},we=async q=>{try{l(!0),await F.post(`${ae}?action=retry`,{message_id:q.id}),alert(" SMS resent!"),w(),B()}catch{alert("Failed")}finally{l(!1)}},fe=q=>{s==="send"?R(pe=>({...pe,message:q.message_template})):s==="bulk"&&T(pe=>({...pe,message:q.message_template,template_name:q.name}))},ye=m.filter(q=>{const pe=!P.status||q.status===P.status,Me=!P.search||q.recipient_name?.toLowerCase().includes(P.search.toLowerCase())||q.phone?.includes(P.search),Se=!P.dateFrom||new Date(q.sent_at)>=new Date(P.dateFrom),Ne=!P.dateTo||new Date(q.sent_at)<=new Date(P.dateTo+"T23:59:59");return pe&&Me&&Se&&Ne}),Ke=()=>{const q=new ms;q.setFontSize(18),q.text("SMS Message History",14,22),q.setFontSize(10),q.text(`Generated: ${new Date().toLocaleString()}`,14,30),Ma(q,{startY:36,head:[["Date","Recipient","Phone","Status","Message"]],body:ye.map(pe=>[pe.sent_at?.split(" ")[0]||"-",pe.recipient_name||"-",pe.phone||"-",pe.status||"-",(pe.message||"").substring(0,40)]),styles:{fontSize:8}}),q.save(`sms_history_${new Date().toISOString().split("T")[0]}.pdf`)},ve=()=>{const q=`Date,Recipient,Phone,Status,Message
`+ye.map(Se=>`"${Se.sent_at||""}","${Se.recipient_name||""}","${Se.phone||""}","${Se.status||""}","${(Se.message||"").replace(/"/g,'""')}"`).join(`
`),pe=new Blob([q],{type:"text/csv"}),Me=document.createElement("a");Me.href=URL.createObjectURL(pe),Me.download=`sms_history_${new Date().toISOString().split("T")[0]}.csv`,Me.click()},ie=q=>{switch(q){case"delivered":return e.jsx(Mt,{className:"w-4 h-4 text-green-600"});case"sent":return e.jsx(Wt,{className:"w-4 h-4 text-blue-600"});case"failed":return e.jsx(Js,{className:"w-4 h-4 text-red-600"});default:return e.jsx(Wt,{className:"w-4 h-4 text-gray-400"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(wa,{className:"w-7 h-7 text-blue-600"})," SMS Messaging"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Send SMS notifications to parents and staff"})]}),e.jsxs("button",{onClick:()=>{B(),w()},className:"btn bg-gray-100 hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ns,{className:"w-4 h-4"})," Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:[e.jsx(wa,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Total Sent"}),e.jsx("p",{className:"text-2xl font-bold",children:x.total||0})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-green-500 to-green-600 text-white",children:[e.jsx(Mt,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Delivered"}),e.jsx("p",{className:"text-2xl font-bold",children:x.delivered||0})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-red-500 to-red-600 text-white",children:[e.jsx(Js,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Failed"}),e.jsx("p",{className:"text-2xl font-bold",children:x.failed||0})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-purple-500 to-purple-600 text-white",children:[e.jsx(Wt,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Today"}),e.jsx("p",{className:"text-2xl font-bold",children:x.today||0})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-orange-500 to-orange-600 text-white",children:[e.jsx(Ot,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Scheduled"}),e.jsx("p",{className:"text-2xl font-bold",children:K.length})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-indigo-500 to-indigo-600 text-white",children:[e.jsx(Rt,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Groups"}),e.jsx("p",{className:"text-2xl font-bold",children:D.length})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-teal-500 to-teal-600 text-white",children:[e.jsx(Kt,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Templates"}),e.jsx("p",{className:"text-2xl font-bold",children:c.length})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-yellow-500 to-yellow-600 text-white",children:[e.jsx(aa,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"SMS Credits"}),e.jsx("p",{className:"text-2xl font-bold",children:x.credits||0})]})]}),e.jsx("div",{className:"flex gap-1 flex-wrap bg-gray-100 p-1 rounded-lg",children:[{id:"send",label:"Send",icon:va},{id:"bulk",label:"Bulk",icon:Rt},{id:"scheduled",label:"Scheduled",icon:Ot},{id:"templates",label:"Templates",icon:Kt},{id:"history",label:"History",icon:Sa},{id:"settings",label:"Settings",icon:Ka}].map(q=>e.jsxs("button",{onClick:()=>a(q.id),className:`px-3 py-2 rounded-md font-medium flex items-center gap-1 text-sm transition-colors ${s===q.id?"bg-blue-600 text-white shadow":"hover:bg-gray-200"}`,children:[e.jsx(q.icon,{className:"w-4 h-4"})," ",q.label]},q.id))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2",children:[s==="send"&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(va,{className:"w-5 h-5 text-blue-600"})," Send Single SMS"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:[e.jsx(er,{className:"w-4 h-4 inline mr-1"})," Phone *"]}),e.jsx("input",{type:"tel",value:z.phone,onChange:q=>R({...z,phone:q.target.value}),className:"input",placeholder:"0241234567"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:[e.jsx(ha,{className:"w-4 h-4 inline mr-1"})," Name"]}),e.jsx("input",{type:"text",value:z.recipient_name,onChange:q=>R({...z,recipient_name:q.target.value}),className:"input",placeholder:"Recipient Name"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Message * (",z.message.length,"/160)"]}),e.jsx("textarea",{value:z.message,onChange:q=>R({...z,message:q.target.value}),className:"input",rows:"4",placeholder:"Type your message...",maxLength:320})]}),e.jsxs("button",{onClick:Xe,disabled:r,className:"btn bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-2",children:[r?e.jsx(hs,{className:"w-4 h-4 animate-spin"}):e.jsx(va,{className:"w-4 h-4"})," Send SMS"]})]})]}),s==="bulk"&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Rt,{className:"w-5 h-5 text-blue-600"})," Send Bulk SMS"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Recipients"}),e.jsxs("select",{value:j.recipient_type,onChange:q=>{T({...j,recipient_type:q.target.value}),Ge(q.target.value)},className:"input",children:[e.jsx("option",{value:"",children:"Choose group"}),e.jsx("option",{value:"all_parents",children:"All Parents"}),e.jsx("option",{value:"all_teachers",children:"All Teachers"}),e.jsx("option",{value:"class_parents",children:"Parents with Students"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Or Select Class"}),e.jsxs("select",{value:v,onChange:q=>{U(q.target.value),q.target.value&&ze(q.target.value)},className:"input",children:[e.jsx("option",{value:"",children:"-- Select Class --"}),f.map(q=>e.jsx("option",{value:q.id,children:q.class_name||q.name},q.id))]})]})]}),g.length>0&&e.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:e.jsxs("p",{className:"text-sm font-medium text-blue-700",children:[g.length," recipients selected"]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Message * (",j.message.length,"/160)"]}),e.jsx("textarea",{value:j.message,onChange:q=>T({...j,message:q.target.value}),className:"input",rows:"4",placeholder:"Use {name} for personalization",maxLength:320})]}),e.jsxs("button",{onClick:st,disabled:r||g.length===0,className:"btn bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-2",children:[r?e.jsx(hs,{className:"w-4 h-4 animate-spin"}):e.jsx(va,{className:"w-4 h-4"})," Send to ",g.length," Recipients"]})]})]}),s==="scheduled"&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Ot,{className:"w-5 h-5 text-orange-600"})," Scheduled SMS"]}),e.jsxs("button",{onClick:()=>ge(!0),className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4"})," Schedule"]})]}),K.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Ot,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No scheduled messages"})]}):e.jsx("div",{className:"space-y-3",children:K.map(q=>e.jsx("div",{className:"border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${q.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:q.status}),e.jsx("span",{className:"text-sm text-gray-500",children:q.recipient_type})]}),e.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:q.message}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[e.jsx(Wt,{className:"w-3 h-3 inline"})," ",q.scheduled_at]})]}),q.status==="pending"&&e.jsx("button",{onClick:()=>Pe(q.id),className:"text-red-600 hover:bg-red-50 p-2 rounded",children:e.jsx(us,{className:"w-4 h-4"})})]})},q.id))})]}),s==="templates"&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Kt,{className:"w-5 h-5 text-blue-600"})," SMS Templates"]}),e.jsxs("button",{onClick:()=>C(!0),className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4"})," New Template"]})]}),c.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No templates yet"}):e.jsx("div",{className:"space-y-3",children:c.map(q=>e.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-medium",children:q.name}),e.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded",children:q.category})]}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:q.message_template})]}),e.jsx("button",{onClick:()=>fe(q),className:"btn bg-blue-100 text-blue-700 hover:bg-blue-200 text-sm",children:"Use"})]})},q.id))})]}),s==="history"&&e.jsxs("div",{className:"card overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Sa,{className:"w-5 h-5 text-blue-600"})," SMS History (",ye.length,")"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:Ke,className:"btn bg-blue-100 text-blue-700 hover:bg-blue-200 text-sm flex items-center gap-1",children:[e.jsx(xs,{className:"w-4 h-4"})," PDF"]}),e.jsxs("button",{onClick:ve,className:"btn bg-green-100 text-green-700 hover:bg-green-200 text-sm flex items-center gap-1",children:[e.jsx(qo,{className:"w-4 h-4"})," CSV"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ws,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search...",value:P.search,onChange:q=>se({...P,search:q.target.value}),className:"input pl-9 text-sm"})]}),e.jsxs("select",{value:P.status,onChange:q=>se({...P,status:q.target.value}),className:"input text-sm",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"sent",children:"Sent"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"failed",children:"Failed"})]}),e.jsx("input",{type:"date",value:P.dateFrom,onChange:q=>se({...P,dateFrom:q.target.value}),className:"input text-sm"}),e.jsx("input",{type:"date",value:P.dateTo,onChange:q=>se({...P,dateTo:q.target.value}),className:"input text-sm"})]})]}),e.jsx("div",{className:"divide-y max-h-[400px] overflow-y-auto",children:ye.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No messages found"}):ye.map(q=>e.jsx("div",{className:"p-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[ie(q.status),e.jsx("span",{className:"font-medium",children:q.recipient_name||"Unknown"}),e.jsx("span",{className:"text-sm text-gray-500",children:q.phone})]}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:q.message}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:q.sent_at})]}),q.status==="failed"&&e.jsx("button",{onClick:()=>we(q),className:"p-2 text-orange-600 hover:bg-orange-50 rounded-lg",title:"Retry",children:e.jsx(Ns,{className:"w-4 h-4"})})]})},q.id))})]}),s==="settings"&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:e.jsx(Ka,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"SMS Gateway Settings"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Configure your SMS provider credentials"})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[e.jsx("h3",{className:"font-medium text-blue-800 mb-2",children:" Supported SMS Providers:"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Hubtel (Ghana)"}),e.jsx("li",{children:"Arkesel (Ghana)"}),e.jsx("li",{children:"mNotify (Ghana)"}),e.jsx("li",{children:"Twilio (International)"}),e.jsx("li",{children:"Africa's Talking (Africa)"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"SMS Provider"}),e.jsxs("select",{value:xe.provider,onChange:q=>Z({...xe,provider:q.target.value}),className:"input",children:[e.jsx("option",{value:"hubtel",children:"Hubtel"}),e.jsx("option",{value:"arkesel",children:"Arkesel"}),e.jsx("option",{value:"mnotify",children:"mNotify"}),e.jsx("option",{value:"twilio",children:"Twilio"}),e.jsx("option",{value:"africastalking",children:"Africa's Talking"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"API Key / Client ID"}),e.jsx("input",{type:"text",value:xe.api_key,onChange:q=>Z({...xe,api_key:q.target.value}),className:"input",placeholder:"Enter API key"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"API Secret / Auth Token"}),e.jsx("input",{type:"password",value:xe.api_secret,onChange:q=>Z({...xe,api_secret:q.target.value}),className:"input",placeholder:"Enter API secret"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Sender ID"}),e.jsx("input",{type:"text",value:xe.sender_id,onChange:q=>Z({...xe,sender_id:q.target.value}),className:"input",placeholder:"e.g., SCHOOL",maxLength:11})]}),e.jsxs("button",{onClick:_e,disabled:I,className:"btn bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-2",children:[I?e.jsx(hs,{className:"w-4 h-4 animate-spin"}):e.jsx(Br,{className:"w-4 h-4"})," Save Settings"]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card p-4",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Quick Templates"}),e.jsx("div",{className:"space-y-2",children:c.slice(0,5).map(q=>e.jsxs("button",{onClick:()=>fe(q),className:"w-full text-left p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors",children:[e.jsx("p",{className:"font-medium text-sm",children:q.name}),e.jsx("p",{className:"text-xs text-gray-500",children:q.category})]},q.id))})]}),e.jsxs("div",{className:"card p-4 bg-blue-50 border-blue-200",children:[e.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:"SMS Tips"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:" Keep messages under 160 characters"}),e.jsxs("li",{children:[" Use ","{name}"," for personalization"]}),e.jsx("li",{children:" Schedule messages for optimal delivery"}),e.jsx("li",{children:" Check credits before bulk sending"})]})]})]})]}),te&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Create SMS Template"}),e.jsx("button",{onClick:()=>C(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Template Name"}),e.jsx("input",{type:"text",value:Q.name,onChange:q=>E({...Q,name:q.target.value}),className:"input",placeholder:"e.g., fee_reminder"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Category"}),e.jsxs("select",{value:Q.category,onChange:q=>E({...Q,category:q.target.value}),className:"input",children:[e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"fee_reminder",children:"Fee Reminder"}),e.jsx("option",{value:"attendance",children:"Attendance"}),e.jsx("option",{value:"exam",children:"Exam"}),e.jsx("option",{value:"event",children:"Event"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Message (",Q.message_template.length,"/160)"]}),e.jsx("textarea",{value:Q.message_template,onChange:q=>E({...Q,message_template:q.target.value}),className:"input",rows:"4",placeholder:"Dear {name}, ...",maxLength:320})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:()=>C(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{onClick:ce,disabled:r,className:"btn btn-primary",children:r?"Saving...":"Save"})]})]})}),re&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Ot,{className:"w-5 h-5 text-orange-600"})," Schedule SMS"]}),e.jsx("button",{onClick:()=>ge(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:le,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Recipients"}),e.jsxs("select",{value:O.recipient_type,onChange:q=>V({...O,recipient_type:q.target.value}),className:"input",children:[e.jsx("option",{value:"all_parents",children:"All Parents"}),e.jsx("option",{value:"all_teachers",children:"All Teachers"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Date *"}),e.jsx("input",{type:"date",value:O.scheduled_date,onChange:q=>V({...O,scheduled_date:q.target.value}),className:"input",required:!0,min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Time *"}),e.jsx("input",{type:"time",value:O.scheduled_time,onChange:q=>V({...O,scheduled_time:q.target.value}),className:"input",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Repeat"}),e.jsxs("select",{value:O.repeat,onChange:q=>V({...O,repeat:q.target.value}),className:"input",children:[e.jsx("option",{value:"none",children:"Don't Repeat"}),e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Message *"}),e.jsx("textarea",{value:O.message,onChange:q=>V({...O,message:q.target.value}),className:"input",rows:"4",required:!0,placeholder:"Type message..."})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>ge(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-primary flex items-center gap-2",children:[e.jsx(Ot,{className:"w-4 h-4"})," Schedule"]})]})]})]})})]})}function TH(){const{user:t}=Us(),[s,a]=h.useState("compose"),[r,l]=h.useState(!1),[c,o]=h.useState([]),[m,u]=h.useState([]),[x,A]=h.useState({total:0,sent:0,delivered:0,failed:0,today:0,opened:0}),[g,N]=h.useState([]),[f,y]=h.useState([]),[v,U]=h.useState(""),[D,M]=h.useState([]),[K,$]=h.useState([]),[P,se]=h.useState({status:"",dateFrom:"",dateTo:"",search:""}),[z,R]=h.useState({to:"",to_name:"",subject:"",body:"",attachments:[],is_html:!0}),[j,T]=h.useState({recipient_type:"all_parents",subject:"",body:"",attachments:[]}),[Q,E]=h.useState({name:"",category:"general",subject:"",body:""}),[te,C]=h.useState(!1),[O,V]=h.useState({recipient_type:"all_parents",subject:"",body:"",scheduled_date:"",scheduled_time:""}),[re,ge]=h.useState(!1),[xe,Z]=h.useState(!1),[I,H]=h.useState({smtp_host:"",smtp_port:"587",smtp_user:"",smtp_pass:"",from_email:"",from_name:"",encryption:"tls"}),[ae,k]=h.useState(!1),B=`${ee}/email.php`;h.useEffect(()=>{w(),oe(),ne(),Fe(),je(),Ge(),ze()},[]);const w=async()=>{try{const Ce=await F.get(`${B}?action=templates`);o(Ce.data.templates||[])}catch(Ce){console.error(Ce)}},oe=async()=>{try{const Ce=await F.get(`${B}?action=stats`);A(Ce.data.stats||{})}catch(Ce){console.error(Ce)}},ne=async()=>{try{const Ce=await F.get(`${B}?action=history&limit=100`);u(Ce.data.emails||[])}catch(Ce){console.error(Ce)}},Fe=async()=>{try{const Ce=await F.get(`${B}?action=settings`);Ce.data.settings&&H(Ce.data.settings)}catch(Ce){console.error(Ce)}},je=async()=>{try{const Ce=await F.get(`${ee}/classes.php`);y(Ce.data.classes||Ce.data||[])}catch(Ce){console.error(Ce)}},Ge=async()=>{try{const Ce=await F.get(`${B}?action=scheduled`);M(Ce.data.scheduled||[])}catch(Ce){console.error(Ce)}},ze=async()=>{try{const Ce=await F.get(`${B}?action=drafts`);$(Ce.data.drafts||[])}catch(Ce){console.error(Ce)}},Xe=async Ce=>{try{l(!0);let ft=Ce==="all_parents"?`${ee}/parents.php`:Ce==="all_teachers"?`${ee}/teachers.php`:`${ee}/parents.php?has_students=true`;const qe=await F.get(ft),W=qe.data.parents||qe.data.teachers||[];N(W.map(Ie=>({id:Ie.id,name:`${Ie.first_name||""} ${Ie.last_name||""}`.trim()||Ie.name,email:Ie.email,type:Ce.includes("parent")?"parent":"teacher"})))}catch(ft){console.error(ft),N([])}finally{l(!1)}},st=async Ce=>{try{l(!0);const qe=(await F.get(`${ee}/parents.php?class_id=${Ce}`)).data.parents||[];N(qe.map(W=>({id:W.id,name:`${W.first_name||""} ${W.last_name||""}`.trim(),email:W.email,type:"parent",student_name:W.student_name})))}catch(ft){console.error(ft),N([])}finally{l(!1)}},ce=async()=>{if(!z.to||!z.subject||!z.body){alert("Enter recipient, subject and body");return}try{l(!0);const Ce=await F.post(`${B}?action=send`,{...z,sent_by:t?.id});Ce.data.success?(alert(" Email sent successfully!"),R({to:"",to_name:"",subject:"",body:"",attachments:[],is_html:!0}),oe(),ne()):alert("Failed: "+(Ce.data.error||"Unknown error"))}catch{alert("Failed to send email")}finally{l(!1)}},_e=async()=>{if(g.length===0||!j.subject||!j.body){alert("Select recipients and fill subject/body");return}try{l(!0);const Ce=await F.post(`${B}?action=send_bulk`,{recipients:g.filter(ft=>ft.email).map(ft=>({email:ft.email,name:ft.name,type:ft.type})),subject:j.subject,body:j.body,sent_by:t?.id});Ce.data.success&&(alert(` ${Ce.data.sent_count} emails sent!`),oe(),ne())}catch{alert("Failed to send")}finally{l(!1)}},le=async()=>{try{await F.post(`${B}?action=save_draft`,{...z,user_id:t?.id}),alert(" Draft saved!"),ze()}catch{alert("Failed")}},Pe=Ce=>{R({to:Ce.to_email||"",to_name:Ce.to_name||"",subject:Ce.subject||"",body:Ce.body||"",attachments:[],is_html:!0}),a("compose")},we=async Ce=>{if(confirm("Delete this draft?"))try{await F.delete(`${B}?action=delete_draft&id=${Ce}`),ze()}catch{alert("Failed")}},fe=async()=>{if(!Q.name||!Q.subject||!Q.body){alert("Fill all fields");return}try{l(!0),await F.post(`${B}?action=save_template`,Q),alert(" Template saved!"),C(!1),E({name:"",category:"general",subject:"",body:""}),w()}catch{alert("Failed")}finally{l(!1)}},ye=async()=>{try{k(!0),await F.post(`${B}?action=save_settings`,I),alert(" Email settings saved!")}catch{alert("Failed")}finally{k(!1)}},Ke=async Ce=>{if(Ce.preventDefault(),!O.subject||!O.body||!O.scheduled_date||!O.scheduled_time){alert("Fill all fields");return}try{await F.post(`${B}?action=schedule`,{...O,scheduled_at:`${O.scheduled_date} ${O.scheduled_time}`,created_by:t?.id}),alert(" Email scheduled!"),ge(!1),V({recipient_type:"all_parents",subject:"",body:"",scheduled_date:"",scheduled_time:""}),Ge()}catch{alert("Failed")}},ve=async Ce=>{if(confirm("Cancel this scheduled email?"))try{await F.delete(`${B}?action=schedule&id=${Ce}`),Ge()}catch{alert("Failed")}},ie=async Ce=>{try{l(!0),await F.post(`${B}?action=retry`,{email_id:Ce.id}),alert(" Email resent!"),ne(),oe()}catch{alert("Failed")}finally{l(!1)}},q=Ce=>{s==="compose"?R(ft=>({...ft,subject:Ce.subject,body:Ce.body})):s==="bulk"&&T(ft=>({...ft,subject:Ce.subject,body:Ce.body}))},pe=m.filter(Ce=>{const ft=!P.status||Ce.status===P.status,qe=!P.search||Ce.to_name?.toLowerCase().includes(P.search.toLowerCase())||Ce.to_email?.includes(P.search)||Ce.subject?.toLowerCase().includes(P.search.toLowerCase()),W=!P.dateFrom||new Date(Ce.sent_at)>=new Date(P.dateFrom),Ie=!P.dateTo||new Date(Ce.sent_at)<=new Date(P.dateTo+"T23:59:59");return ft&&qe&&W&&Ie}),Me=()=>{const Ce=new ms;Ce.setFontSize(18),Ce.text("Email History",14,22),Ce.setFontSize(10),Ce.text(`Generated: ${new Date().toLocaleString()}`,14,30),Ma(Ce,{startY:36,head:[["Date","To","Subject","Status"]],body:pe.map(ft=>[ft.sent_at?.split(" ")[0]||"-",ft.to_email||"-",(ft.subject||"").substring(0,40),ft.status||"-"]),styles:{fontSize:8}}),Ce.save(`email_history_${new Date().toISOString().split("T")[0]}.pdf`)},Se=()=>{const Ce=`Date,To,Name,Subject,Status
`+pe.map(W=>`"${W.sent_at||""}","${W.to_email||""}","${W.to_name||""}","${(W.subject||"").replace(/"/g,'""')}","${W.status||""}"`).join(`
`),ft=new Blob([Ce],{type:"text/csv"}),qe=document.createElement("a");qe.href=URL.createObjectURL(ft),qe.download=`email_history_${new Date().toISOString().split("T")[0]}.csv`,qe.click()},Ne=Ce=>{switch(Ce){case"delivered":case"opened":return e.jsx(Mt,{className:"w-4 h-4 text-green-600"});case"sent":return e.jsx(Wt,{className:"w-4 h-4 text-blue-600"});case"failed":return e.jsx(Js,{className:"w-4 h-4 text-red-600"});default:return e.jsx(Wt,{className:"w-4 h-4 text-gray-400"})}},et=Ce=>{const ft=document.getElementById("email-body");if(!ft)return;const qe=ft.selectionStart,W=ft.selectionEnd,Ie=z.body,mt=Ie.substring(qe,W);let pt="";switch(Ce){case"bold":pt=`<strong>${mt||"text"}</strong>`;break;case"italic":pt=`<em>${mt||"text"}</em>`;break;case"link":pt=`<a href="url">${mt||"link text"}</a>`;break;case"list":pt=`<ul>
<li>${mt||"item"}</li>
</ul>`;break;default:pt=mt}R({...z,body:Ie.substring(0,qe)+pt+Ie.substring(W)})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(ra,{className:"w-7 h-7 text-indigo-600"})," Email Messaging"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Send email notifications to parents and staff"})]}),e.jsxs("button",{onClick:()=>{oe(),ne()},className:"btn bg-gray-100 hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Ns,{className:"w-4 h-4"})," Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-indigo-500 to-indigo-600 text-white",children:[e.jsx(ra,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Total Sent"}),e.jsx("p",{className:"text-2xl font-bold",children:x.total||0})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-green-500 to-green-600 text-white",children:[e.jsx(Mt,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Delivered"}),e.jsx("p",{className:"text-2xl font-bold",children:x.delivered||0})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:[e.jsx(na,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Opened"}),e.jsx("p",{className:"text-2xl font-bold",children:x.opened||0})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-red-500 to-red-600 text-white",children:[e.jsx(Js,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Failed"}),e.jsx("p",{className:"text-2xl font-bold",children:x.failed||0})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-purple-500 to-purple-600 text-white",children:[e.jsx(Wt,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Today"}),e.jsx("p",{className:"text-2xl font-bold",children:x.today||0})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-orange-500 to-orange-600 text-white",children:[e.jsx(Ot,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Scheduled"}),e.jsx("p",{className:"text-2xl font-bold",children:D.length})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-teal-500 to-teal-600 text-white",children:[e.jsx(Kt,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Templates"}),e.jsx("p",{className:"text-2xl font-bold",children:c.length})]}),e.jsxs("div",{className:"card p-4 bg-gradient-to-br from-gray-500 to-gray-600 text-white",children:[e.jsx(Kt,{className:"w-6 h-6 mb-2 opacity-80"}),e.jsx("p",{className:"text-sm opacity-80",children:"Drafts"}),e.jsx("p",{className:"text-2xl font-bold",children:K.length})]})]}),e.jsx("div",{className:"flex gap-1 flex-wrap bg-gray-100 p-1 rounded-lg",children:[{id:"compose",label:"Compose",icon:va},{id:"bulk",label:"Bulk",icon:Rt},{id:"scheduled",label:"Scheduled",icon:Ot},{id:"drafts",label:"Drafts",icon:Kt},{id:"templates",label:"Templates",icon:Kt},{id:"history",label:"History",icon:Sa},{id:"settings",label:"Settings",icon:Ka}].map(Ce=>e.jsxs("button",{onClick:()=>a(Ce.id),className:`px-3 py-2 rounded-md font-medium flex items-center gap-1 text-sm transition-colors ${s===Ce.id?"bg-indigo-600 text-white shadow":"hover:bg-gray-200"}`,children:[e.jsx(Ce.icon,{className:"w-4 h-4"})," ",Ce.label]},Ce.id))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2",children:[s==="compose"&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(va,{className:"w-5 h-5 text-indigo-600"})," Compose Email"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:[e.jsx(ra,{className:"w-4 h-4 inline mr-1"})," To (Email) *"]}),e.jsx("input",{type:"email",value:z.to,onChange:Ce=>R({...z,to:Ce.target.value}),className:"input",placeholder:"recipient@email.com"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:[e.jsx(ha,{className:"w-4 h-4 inline mr-1"})," Name"]}),e.jsx("input",{type:"text",value:z.to_name,onChange:Ce=>R({...z,to_name:Ce.target.value}),className:"input",placeholder:"Recipient Name"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Subject *"}),e.jsx("input",{type:"text",value:z.subject,onChange:Ce=>R({...z,subject:Ce.target.value}),className:"input",placeholder:"Email subject"})]}),e.jsxs("div",{className:"flex gap-1 border-b pb-2",children:[e.jsx("button",{type:"button",onClick:()=>et("bold"),className:"p-2 hover:bg-gray-100 rounded",title:"Bold",children:e.jsx(q3,{className:"w-4 h-4"})}),e.jsx("button",{type:"button",onClick:()=>et("italic"),className:"p-2 hover:bg-gray-100 rounded",title:"Italic",children:e.jsx(gk,{className:"w-4 h-4"})}),e.jsx("button",{type:"button",onClick:()=>et("link"),className:"p-2 hover:bg-gray-100 rounded",title:"Link",children:e.jsx(Hd,{className:"w-4 h-4"})}),e.jsx("button",{type:"button",onClick:()=>et("list"),className:"p-2 hover:bg-gray-100 rounded",title:"List",children:e.jsx(Ay,{className:"w-4 h-4"})}),e.jsx("div",{className:"flex-1"}),e.jsxs("button",{type:"button",onClick:()=>Z(!0),className:"p-2 hover:bg-gray-100 rounded flex items-center gap-1 text-sm",children:[e.jsx(na,{className:"w-4 h-4"})," Preview"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Body *"}),e.jsx("textarea",{id:"email-body",value:z.body,onChange:Ce=>R({...z,body:Ce.target.value}),className:"input font-mono text-sm",rows:"10",placeholder:"Email body (HTML supported)..."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:le,className:"btn bg-gray-200 hover:bg-gray-300 flex items-center gap-2",children:[e.jsx(Br,{className:"w-4 h-4"})," Save Draft"]}),e.jsxs("button",{onClick:ce,disabled:r,className:"btn bg-indigo-600 hover:bg-indigo-700 text-white flex items-center gap-2",children:[r?e.jsx(hs,{className:"w-4 h-4 animate-spin"}):e.jsx(va,{className:"w-4 h-4"})," Send Email"]})]})]})]}),s==="bulk"&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Rt,{className:"w-5 h-5 text-indigo-600"})," Send Bulk Email"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Recipients"}),e.jsxs("select",{value:j.recipient_type,onChange:Ce=>{T({...j,recipient_type:Ce.target.value}),Xe(Ce.target.value)},className:"input",children:[e.jsx("option",{value:"",children:"Choose group"}),e.jsx("option",{value:"all_parents",children:"All Parents"}),e.jsx("option",{value:"all_teachers",children:"All Teachers"}),e.jsx("option",{value:"class_parents",children:"Parents with Students"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Or Select Class"}),e.jsxs("select",{value:v,onChange:Ce=>{U(Ce.target.value),Ce.target.value&&st(Ce.target.value)},className:"input",children:[e.jsx("option",{value:"",children:"-- Select Class --"}),f.map(Ce=>e.jsx("option",{value:Ce.id,children:Ce.class_name||Ce.name},Ce.id))]})]})]}),g.length>0&&e.jsx("div",{className:"bg-indigo-50 p-3 rounded-lg",children:e.jsxs("p",{className:"text-sm font-medium text-indigo-700",children:[g.filter(Ce=>Ce.email).length," recipients with email selected"]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Subject *"}),e.jsx("input",{type:"text",value:j.subject,onChange:Ce=>T({...j,subject:Ce.target.value}),className:"input",placeholder:"Email subject"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Body *"}),e.jsx("textarea",{value:j.body,onChange:Ce=>T({...j,body:Ce.target.value}),className:"input",rows:"8",placeholder:"Use {name} for personalization"})]}),e.jsxs("button",{onClick:_e,disabled:r||g.filter(Ce=>Ce.email).length===0,className:"btn bg-indigo-600 hover:bg-indigo-700 text-white flex items-center gap-2",children:[r?e.jsx(hs,{className:"w-4 h-4 animate-spin"}):e.jsx(va,{className:"w-4 h-4"})," Send to ",g.filter(Ce=>Ce.email).length," Recipients"]})]})]}),s==="scheduled"&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Ot,{className:"w-5 h-5 text-orange-600"})," Scheduled Emails"]}),e.jsxs("button",{onClick:()=>ge(!0),className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4"})," Schedule"]})]}),D.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Ot,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No scheduled emails"})]}):e.jsx("div",{className:"space-y-3",children:D.map(Ce=>e.jsx("div",{className:"border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Ce.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:Ce.status}),e.jsx("span",{className:"text-sm text-gray-500",children:Ce.recipient_type})]}),e.jsx("p",{className:"font-medium",children:Ce.subject}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[e.jsx(Wt,{className:"w-3 h-3 inline"})," ",Ce.scheduled_at]})]}),Ce.status==="pending"&&e.jsx("button",{onClick:()=>ve(Ce.id),className:"text-red-600 hover:bg-red-50 p-2 rounded",children:e.jsx(us,{className:"w-4 h-4"})})]})},Ce.id))})]}),s==="drafts"&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Kt,{className:"w-5 h-5 text-gray-600"})," Drafts"]}),K.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Kt,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No drafts"})]}):e.jsx("div",{className:"space-y-3",children:K.map(Ce=>e.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>Pe(Ce),children:[e.jsx("p",{className:"font-medium",children:Ce.subject||"(No subject)"}),e.jsx("p",{className:"text-sm text-gray-500",children:Ce.to_email||"No recipient"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:Ce.updated_at})]}),e.jsx("button",{onClick:()=>we(Ce.id),className:"text-red-600 hover:bg-red-50 p-2 rounded",children:e.jsx(us,{className:"w-4 h-4"})})]})},Ce.id))})]}),s==="templates"&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Kt,{className:"w-5 h-5 text-indigo-600"})," Email Templates"]}),e.jsxs("button",{onClick:()=>C(!0),className:"btn btn-primary flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4"})," New Template"]})]}),c.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No templates yet"}):e.jsx("div",{className:"space-y-3",children:c.map(Ce=>e.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-medium",children:Ce.name}),e.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded",children:Ce.category})]}),e.jsx("p",{className:"text-sm text-gray-600",children:Ce.subject})]}),e.jsx("button",{onClick:()=>q(Ce),className:"btn bg-indigo-100 text-indigo-700 hover:bg-indigo-200 text-sm",children:"Use"})]})},Ce.id))})]}),s==="history"&&e.jsxs("div",{className:"card overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Sa,{className:"w-5 h-5 text-indigo-600"})," Email History (",pe.length,")"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:Me,className:"btn bg-blue-100 text-blue-700 hover:bg-blue-200 text-sm flex items-center gap-1",children:[e.jsx(xs,{className:"w-4 h-4"})," PDF"]}),e.jsxs("button",{onClick:Se,className:"btn bg-green-100 text-green-700 hover:bg-green-200 text-sm flex items-center gap-1",children:[e.jsx(qo,{className:"w-4 h-4"})," CSV"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ws,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search...",value:P.search,onChange:Ce=>se({...P,search:Ce.target.value}),className:"input pl-9 text-sm"})]}),e.jsxs("select",{value:P.status,onChange:Ce=>se({...P,status:Ce.target.value}),className:"input text-sm",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"sent",children:"Sent"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"opened",children:"Opened"}),e.jsx("option",{value:"failed",children:"Failed"})]}),e.jsx("input",{type:"date",value:P.dateFrom,onChange:Ce=>se({...P,dateFrom:Ce.target.value}),className:"input text-sm"}),e.jsx("input",{type:"date",value:P.dateTo,onChange:Ce=>se({...P,dateTo:Ce.target.value}),className:"input text-sm"})]})]}),e.jsx("div",{className:"divide-y max-h-[400px] overflow-y-auto",children:pe.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No emails found"}):pe.map(Ce=>e.jsx("div",{className:"p-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[Ne(Ce.status),e.jsx("span",{className:"font-medium",children:Ce.to_name||Ce.to_email})]}),e.jsx("p",{className:"text-sm text-gray-700",children:Ce.subject}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:Ce.sent_at})]}),Ce.status==="failed"&&e.jsx("button",{onClick:()=>ie(Ce),className:"p-2 text-orange-600 hover:bg-orange-50 rounded-lg",title:"Retry",children:e.jsx(Ns,{className:"w-4 h-4"})})]})},Ce.id))})]}),s==="settings"&&e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-indigo-100 rounded-xl flex items-center justify-center",children:e.jsx(Ka,{className:"w-6 h-6 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"SMTP Email Settings"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Configure your email server credentials"})]})]}),e.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4 mb-6",children:[e.jsx("h3",{className:"font-medium text-indigo-800 mb-2",children:" Common SMTP Providers:"}),e.jsxs("ul",{className:"text-sm text-indigo-700 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Gmail: smtp.gmail.com (Port 587, TLS)"}),e.jsx("li",{children:"Outlook: smtp.office365.com (Port 587, TLS)"}),e.jsx("li",{children:"SendGrid: smtp.sendgrid.net (Port 587, TLS)"}),e.jsx("li",{children:"Mailgun: smtp.mailgun.org (Port 587, TLS)"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"SMTP Host"}),e.jsx("input",{type:"text",value:I.smtp_host,onChange:Ce=>H({...I,smtp_host:Ce.target.value}),className:"input",placeholder:"smtp.gmail.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"SMTP Port"}),e.jsx("input",{type:"text",value:I.smtp_port,onChange:Ce=>H({...I,smtp_port:Ce.target.value}),className:"input",placeholder:"587"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"SMTP Username"}),e.jsx("input",{type:"text",value:I.smtp_user,onChange:Ce=>H({...I,smtp_user:Ce.target.value}),className:"input",placeholder:"your@email.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"SMTP Password"}),e.jsx("input",{type:"password",value:I.smtp_pass,onChange:Ce=>H({...I,smtp_pass:Ce.target.value}),className:"input",placeholder:"App password"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"From Email"}),e.jsx("input",{type:"email",value:I.from_email,onChange:Ce=>H({...I,from_email:Ce.target.value}),className:"input",placeholder:"noreply@school.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"From Name"}),e.jsx("input",{type:"text",value:I.from_name,onChange:Ce=>H({...I,from_name:Ce.target.value}),className:"input",placeholder:"School Name"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Encryption"}),e.jsxs("select",{value:I.encryption,onChange:Ce=>H({...I,encryption:Ce.target.value}),className:"input",children:[e.jsx("option",{value:"tls",children:"TLS"}),e.jsx("option",{value:"ssl",children:"SSL"}),e.jsx("option",{value:"none",children:"None"})]})]}),e.jsxs("button",{onClick:ye,disabled:ae,className:"btn bg-indigo-600 hover:bg-indigo-700 text-white flex items-center gap-2",children:[ae?e.jsx(hs,{className:"w-4 h-4 animate-spin"}):e.jsx(Br,{className:"w-4 h-4"})," Save Settings"]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card p-4",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Quick Templates"}),e.jsx("div",{className:"space-y-2",children:c.slice(0,5).map(Ce=>e.jsxs("button",{onClick:()=>q(Ce),className:"w-full text-left p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors",children:[e.jsx("p",{className:"font-medium text-sm",children:Ce.name}),e.jsx("p",{className:"text-xs text-gray-500",children:Ce.category})]},Ce.id))})]}),e.jsxs("div",{className:"card p-4 bg-indigo-50 border-indigo-200",children:[e.jsx("h3",{className:"font-semibold text-indigo-800 mb-2",children:"Email Tips"}),e.jsxs("ul",{className:"text-sm text-indigo-700 space-y-1",children:[e.jsx("li",{children:" Use clear, descriptive subjects"}),e.jsxs("li",{children:[" Personalize with ","{name}"]}),e.jsx("li",{children:" Test emails before bulk sending"}),e.jsx("li",{children:" Check spam folder for test emails"})]})]})]})]}),te&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Create Email Template"}),e.jsx("button",{onClick:()=>C(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Template Name"}),e.jsx("input",{type:"text",value:Q.name,onChange:Ce=>E({...Q,name:Ce.target.value}),className:"input",placeholder:"e.g., Welcome Email"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Category"}),e.jsxs("select",{value:Q.category,onChange:Ce=>E({...Q,category:Ce.target.value}),className:"input",children:[e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"fee_reminder",children:"Fee Reminder"}),e.jsx("option",{value:"attendance",children:"Attendance"}),e.jsx("option",{value:"exam",children:"Exam"}),e.jsx("option",{value:"event",children:"Event"}),e.jsx("option",{value:"newsletter",children:"Newsletter"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Subject"}),e.jsx("input",{type:"text",value:Q.subject,onChange:Ce=>E({...Q,subject:Ce.target.value}),className:"input",placeholder:"Email subject"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Body"}),e.jsx("textarea",{value:Q.body,onChange:Ce=>E({...Q,body:Ce.target.value}),className:"input",rows:"6",placeholder:"Email body (HTML supported)..."})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:()=>C(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{onClick:fe,disabled:r,className:"btn btn-primary",children:r?"Saving...":"Save"})]})]})}),re&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-lg w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Ot,{className:"w-5 h-5 text-orange-600"})," Schedule Email"]}),e.jsx("button",{onClick:()=>ge(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:Ke,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Recipients"}),e.jsxs("select",{value:O.recipient_type,onChange:Ce=>V({...O,recipient_type:Ce.target.value}),className:"input",children:[e.jsx("option",{value:"all_parents",children:"All Parents"}),e.jsx("option",{value:"all_teachers",children:"All Teachers"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Date *"}),e.jsx("input",{type:"date",value:O.scheduled_date,onChange:Ce=>V({...O,scheduled_date:Ce.target.value}),className:"input",required:!0,min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Time *"}),e.jsx("input",{type:"time",value:O.scheduled_time,onChange:Ce=>V({...O,scheduled_time:Ce.target.value}),className:"input",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Subject *"}),e.jsx("input",{type:"text",value:O.subject,onChange:Ce=>V({...O,subject:Ce.target.value}),className:"input",required:!0,placeholder:"Email subject"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Body *"}),e.jsx("textarea",{value:O.body,onChange:Ce=>V({...O,body:Ce.target.value}),className:"input",rows:"4",required:!0,placeholder:"Email body..."})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>ge(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-primary flex items-center gap-2",children:[e.jsx(Ot,{className:"w-4 h-4"})," Schedule"]})]})]})]})}),xe&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Email Preview"}),e.jsx("button",{onClick:()=>Z(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Nt,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:[e.jsxs("div",{className:"border-b pb-4 mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:["To: ",z.to||"recipient@email.com"]}),e.jsx("p",{className:"text-lg font-medium",children:z.subject||"(No subject)"})]}),e.jsx("div",{className:"prose max-w-none",dangerouslySetInnerHTML:{__html:z.body||"<p>No content</p>"}})]}),e.jsx("div",{className:"p-4 border-t flex justify-end",children:e.jsx("button",{onClick:()=>Z(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:"Close"})})]})})]})}function LH(){return e.jsx(By,{userType:"admin"})}function QH(){return e.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center px-4",children:e.jsx("div",{className:"max-w-md w-full text-center",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(_B,{className:"w-10 h-10 text-red-600"})})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"You don't have permission to access this page. Please contact your administrator if you believe this is an error."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[e.jsxs(dn,{to:"/",className:"inline-flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Lh,{className:"w-4 h-4 mr-2"}),"Go to Dashboard"]}),e.jsxs("button",{onClick:()=>window.history.back(),className:"inline-flex items-center justify-center px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:[e.jsx(ol,{className:"w-4 h-4 mr-2"}),"Go Back"]})]})]})})})}function eb(){const t=la(),{user:s,updateUser:a}=Us(),[r,l]=h.useState(!0),[c,o]=h.useState(!1),[m,u]=h.useState(!1),[x,A]=h.useState(!1),[g,N]=h.useState(null),[f,y]=h.useState(null),[v,U]=h.useState(""),[D,M]=h.useState({first_name:"",last_name:"",email:"",phone:"",address:"",city:"",region:"",photo:""}),[K,$]=h.useState({current_password:"",new_password:"",confirm_password:""});h.useEffect(()=>{se()},[s?.id]);const P=Q=>Q?Q.startsWith("http")?Q:`${ee.replace("/backend/api","")}${Q}`:null,se=async()=>{try{l(!0);const Q=await F.get(`${ee}/profile.php?user_id=${s?.id}`),E=Q.data.profile||Q.data.user||{};N(E);const te=E.profile_picture||E.photo||s?.profile_picture||"";M({first_name:E.first_name||s?.first_name||"",last_name:E.last_name||s?.last_name||"",email:E.email||s?.email||"",phone:E.phone||"",address:E.address||"",city:E.city||"",region:E.region||"",photo:te}),te&&y(P(te))}catch(Q){console.error("Error fetching profile:",Q);const E=s?.profile_picture||"";M({first_name:s?.first_name||s?.name?.split(" ")[0]||"",last_name:s?.last_name||s?.name?.split(" ").slice(1).join(" ")||"",email:s?.email||"",phone:s?.phone||"",address:"",city:"",region:"",photo:E}),E&&y(P(E))}finally{l(!1)}},z=async Q=>{const E=Q.target.files[0];if(!E)return;if(!E.type.startsWith("image/")){alert("Please select an image file");return}if(E.size>5*1024*1024){alert("File size must be less than 5MB");return}const te=new FileReader;te.onloadend=()=>{y(te.result)},te.readAsDataURL(E);try{const C=new FormData;C.append("profile_picture",E),C.append("type","user"),C.append("id",s?.id);const O=await F.post(`${ee}/upload_profile_picture.php`,C,{headers:{"Content-Type":"multipart/form-data"}});if(O.data.success){const V=O.data.path||O.data.url;M(re=>({...re,photo:V})),a&&a({...s,profile_picture:V})}}catch(C){console.error("Error uploading photo:",C),alert("Failed to upload photo: "+(C.response?.data?.error||C.message))}},R=async()=>{try{o(!0),(await F.put(`${ee}/profile.php?user_id=${s?.id}`,D)).data.success&&(U("Profile updated successfully!"),u(!1),a&&a({...s,first_name:D.first_name,last_name:D.last_name,email:D.email,name:`${D.first_name} ${D.last_name}`}),setTimeout(()=>U(""),3e3))}catch(Q){console.error("Error saving profile:",Q),alert("Failed to save profile: "+(Q.response?.data?.error||Q.message))}finally{o(!1)}},j=async()=>{if(K.new_password!==K.confirm_password){alert("New passwords do not match");return}if(K.new_password.length<6){alert("Password must be at least 6 characters");return}try{o(!0),(await F.post(`${ee}/profile.php?action=change_password`,{user_id:s?.id,current_password:K.current_password,new_password:K.new_password})).data.success&&(U("Password changed successfully!"),A(!1),$({current_password:"",new_password:"",confirm_password:""}),setTimeout(()=>U(""),3e3))}catch(Q){console.error("Error changing password:",Q),alert("Failed to change password: "+(Q.response?.data?.error||Q.message))}finally{o(!1)}},T=()=>s?.user_type==="admin"?"/admin":s?.user_type==="teacher"?"/teacher":s?.user_type==="parent"?"/parent":"/admin";return r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(hs,{className:"w-8 h-8 animate-spin text-blue-600"})}):e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[v&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-center gap-3 animate-fade-in",children:[e.jsx(Mt,{className:"w-5 h-5 text-green-600"}),e.jsx("p",{className:"text-green-800",children:v})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>t(`${T()}/dashboard`),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(ol,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Profile"}),e.jsx("p",{className:"text-gray-600",children:"Manage your personal information"})]})]}),m?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>u(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:"Cancel"}),e.jsxs("button",{onClick:R,disabled:c,className:"btn btn-primary flex items-center gap-2",children:[c?e.jsx(hs,{className:"w-4 h-4 animate-spin"}):e.jsx(Br,{className:"w-4 h-4"}),"Save Changes"]})]}):e.jsxs("button",{onClick:()=>u(!0),className:"btn btn-primary flex items-center gap-2",children:[e.jsx(ll,{className:"w-4 h-4"}),"Edit Profile"]})]}),e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-32 h-32 rounded-full overflow-hidden bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center",children:f||D.photo?e.jsx("img",{src:f||D.photo,alt:"Profile",className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-white text-4xl font-bold",children:D.first_name?.charAt(0)?.toUpperCase()||s?.name?.charAt(0)?.toUpperCase()||"U"})}),m&&e.jsxs("label",{className:"absolute bottom-0 right-0 w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center cursor-pointer hover:bg-blue-700 transition-colors shadow-lg",children:[e.jsx(Ld,{className:"w-5 h-5 text-white"}),e.jsx("input",{type:"file",accept:"image/*",onChange:z,className:"hidden"})]})]}),e.jsxs("h2",{className:"mt-4 text-xl font-semibold text-gray-900",children:[D.first_name," ",D.last_name]}),e.jsx("p",{className:"text-gray-500 capitalize",children:s?.user_type})]}),e.jsx("div",{className:"flex-1 space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name"}),m?e.jsx("input",{type:"text",value:D.first_name,onChange:Q=>M({...D,first_name:Q.target.value}),className:"input"}):e.jsx("p",{className:"text-gray-900",children:D.first_name||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name"}),m?e.jsx("input",{type:"text",value:D.last_name,onChange:Q=>M({...D,last_name:Q.target.value}),className:"input"}):e.jsx("p",{className:"text-gray-900",children:D.last_name||"-"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(ra,{className:"w-4 h-4 inline mr-2"}),"Email"]}),m?e.jsx("input",{type:"email",value:D.email,onChange:Q=>M({...D,email:Q.target.value}),className:"input"}):e.jsx("p",{className:"text-gray-900",children:D.email||"-"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(er,{className:"w-4 h-4 inline mr-2"}),"Phone"]}),m?e.jsx("input",{type:"tel",value:D.phone,onChange:Q=>M({...D,phone:Q.target.value}),className:"input"}):e.jsx("p",{className:"text-gray-900",children:D.phone||"-"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Qn,{className:"w-4 h-4 inline mr-2"}),"Address"]}),m?e.jsx("textarea",{value:D.address,onChange:Q=>M({...D,address:Q.target.value}),className:"input",rows:"2"}):e.jsx("p",{className:"text-gray-900",children:D.address||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City"}),m?e.jsx("input",{type:"text",value:D.city,onChange:Q=>M({...D,city:Q.target.value}),className:"input"}):e.jsx("p",{className:"text-gray-900",children:D.city||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Region"}),m?e.jsx("input",{type:"text",value:D.region,onChange:Q=>M({...D,region:Q.target.value}),className:"input"}):e.jsx("p",{className:"text-gray-900",children:D.region||"-"})]})]})})]})}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx($r,{className:"w-5 h-5"}),"Security"]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ui,{className:"w-5 h-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Password"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Last changed: Unknown"})]})]}),e.jsx("button",{onClick:()=>A(!0),className:"btn bg-gray-200 hover:bg-gray-300 text-sm",children:"Change Password"})]})})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(ha,{className:"w-5 h-5"}),"Account Information"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"User ID"}),e.jsx("p",{className:"font-medium text-gray-900",children:s?.id||"-"})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Role"}),e.jsx("p",{className:"font-medium text-gray-900 capitalize",children:s?.user_type||"-"})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Status"}),e.jsx("p",{className:"font-medium text-green-600",children:"Active"})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Member Since"}),e.jsx("p",{className:"font-medium text-gray-900",children:g?.created_at?new Date(g.created_at).toLocaleDateString():"-"})]})]})]}),x&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Change Password"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Password"}),e.jsx("input",{type:"password",value:K.current_password,onChange:Q=>$({...K,current_password:Q.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),e.jsx("input",{type:"password",value:K.new_password,onChange:Q=>$({...K,new_password:Q.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password"}),e.jsx("input",{type:"password",value:K.confirm_password,onChange:Q=>$({...K,confirm_password:Q.target.value}),className:"input"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:()=>A(!1),className:"btn bg-gray-200 hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{onClick:j,disabled:c,className:"btn btn-primary",children:c?"Changing...":"Change Password"})]})]})})]})}function tb(){const t=la(),{user:s}=Us(),[a,r]=h.useState([]),[l,c]=h.useState(!0),[o,m]=h.useState("all"),[u,x]=h.useState([]);h.useEffect(()=>{A()},[s?.id]);const A=async()=>{try{c(!0);const z=await F.get(`${ee}/notifications.php?user_id=${s?.id}&limit=100`);r(z.data.notifications||[])}catch(z){console.error("Error fetching notifications:",z)}finally{c(!1)}},g=async z=>{try{await F.put(`${ee}/notifications.php?id=${z}`,{is_read:!0}),r(R=>R.map(j=>j.id===z?{...j,is_read:!0}:j))}catch(R){console.error("Error marking notification read:",R)}},N=async()=>{try{await F.put(`${ee}/notifications.php?user_id=${s?.id}&action=mark_all_read`),r(z=>z.map(R=>({...R,is_read:!0})))}catch(z){console.error("Error marking all as read:",z)}},f=async z=>{try{await F.delete(`${ee}/notifications.php?id=${z}`),r(R=>R.filter(j=>j.id!==z))}catch(R){console.error("Error deleting notification:",R)}},y=async()=>{if(u.length!==0)try{await Promise.all(u.map(z=>F.delete(`${ee}/notifications.php?id=${z}`))),r(z=>z.filter(R=>!u.includes(R.id))),x([])}catch(z){console.error("Error deleting notifications:",z)}},v=z=>{x(R=>R.includes(z)?R.filter(j=>j!==z):[...R,z])},U=()=>{u.length===D.length?x([]):x(D.map(z=>z.id))},D=a.filter(z=>o==="unread"?!z.is_read:o==="read"?z.is_read:!0),M=z=>{switch(z){case"success":return e.jsx(Mt,{className:"w-5 h-5 text-green-600"});case"warning":return e.jsx(_s,{className:"w-5 h-5 text-orange-600"});case"error":return e.jsx(ka,{className:"w-5 h-5 text-red-600"});default:return e.jsx(fc,{className:"w-5 h-5 text-blue-600"})}},K=z=>{switch(z){case"success":return"bg-green-100";case"warning":return"bg-orange-100";case"error":return"bg-red-100";default:return"bg-blue-100"}},$=z=>{if(!z)return"";const R=new Date(z),T=Math.floor((new Date-R)/1e3);return T<60?"Just now":T<3600?`${Math.floor(T/60)} minutes ago`:T<86400?`${Math.floor(T/3600)} hours ago`:T<604800?`${Math.floor(T/86400)} days ago`:R.toLocaleDateString()},P=()=>s?.user_type==="admin"?"/admin":s?.user_type==="teacher"?"/teacher":s?.user_type==="parent"?"/parent":"/admin",se=a.filter(z=>!z.is_read).length;return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>t(`${P()}/dashboard`),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(ol,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(nl,{className:"w-6 h-6"}),"Notifications"]}),e.jsxs("p",{className:"text-gray-600",children:[se," unread notifications"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[se>0&&e.jsxs("button",{onClick:N,className:"btn bg-blue-100 text-blue-700 hover:bg-blue-200 flex items-center gap-2",children:[e.jsx(Q1,{className:"w-4 h-4"}),"Mark All Read"]}),u.length>0&&e.jsxs("button",{onClick:y,className:"btn bg-red-100 text-red-700 hover:bg-red-200 flex items-center gap-2",children:[e.jsx(us,{className:"w-4 h-4"}),"Delete (",u.length,")"]})]})]}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Ko,{className:"w-5 h-5 text-gray-500"}),e.jsx("div",{className:"flex gap-2",children:["all","unread","read"].map(z=>e.jsxs("button",{onClick:()=>m(z),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${o===z?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[z.charAt(0).toUpperCase()+z.slice(1),z==="unread"&&se>0&&e.jsx("span",{className:"ml-2 px-2 py-0.5 bg-white bg-opacity-20 rounded-full text-xs",children:se})]},z))}),e.jsx("div",{className:"ml-auto",children:e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:u.length===D.length&&D.length>0,onChange:U,className:"rounded"}),"Select All"]})})]})}),e.jsx("div",{className:"card overflow-hidden",children:l?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(hs,{className:"w-8 h-8 animate-spin mx-auto text-blue-600"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Loading notifications..."})]}):D.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(nl,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No notifications"}),e.jsx("p",{className:"text-gray-500 mt-1",children:o==="unread"?"You have no unread notifications":o==="read"?"You have no read notifications":"You have no notifications yet"})]}):e.jsx("div",{className:"divide-y divide-gray-100",children:D.map(z=>e.jsx("div",{className:`p-4 hover:bg-gray-50 transition-colors ${z.is_read?"":"bg-blue-50"}`,children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("input",{type:"checkbox",checked:u.includes(z.id),onChange:()=>v(z.id),className:"mt-1 rounded"}),e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 ${K(z.type)}`,children:M(z.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:z.title}),!z.is_read&&e.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:z.message}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:$(z.created_at)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!z.is_read&&e.jsx("button",{onClick:()=>g(z.id),className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Mark as read",children:e.jsx(Tn,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>f(z.id),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:e.jsx(us,{className:"w-4 h-4"})})]})]})},z.id))})})]})}const A1={dashboard:{name:"Dashboard",icon:Lh,category:"Main",color:"#6366f1",description:"Central hub showing key metrics, quick actions, and system overview.",roles:["admin","teacher","parent","finance","admissions","hr","principal"],features:["Real-time statistics and metrics","Quick action buttons for common tasks","Recent activity feed","Alerts and notifications","Role-specific widgets and charts","Student/teacher/financial summaries"],howToUse:["View your personalized dashboard after login","Click on stat cards to navigate to detailed views","Use quick actions for frequent tasks","Check notifications for important updates","Review charts for trends and patterns"],tips:["Dashboard updates automatically every few minutes","Click on charts for detailed breakdowns","Use the sidebar to navigate to other modules"]},users:{name:"User Management",icon:Rt,category:"Administration",color:"#8b5cf6",description:"Manage all system users including admins, teachers, parents, and staff.",roles:["admin"],features:["Create and manage user accounts","Assign roles and permissions","Reset passwords","Activate/deactivate accounts","View login history","Bulk user import via CSV","User profile management"],howToUse:["Navigate to User Management  Users",'Click "Add User" to create new accounts',"Fill in user details: name, email, role, password","Use the search to find specific users","Click on a user row to edit their details","Use the status toggle to activate/deactivate"],tips:["Use bulk import for adding many users at once","Deactivate accounts instead of deleting to preserve history","Assign appropriate roles to limit access","Use strong passwords for all accounts"]},roles:{name:"Roles & Permissions",icon:$r,category:"Administration",color:"#8b5cf6",description:"Define user roles and their access permissions throughout the system.",roles:["admin"],features:["Create custom roles","Define granular permissions","Assign modules to roles","View role assignments"],howToUse:["Go to User Management  Roles & Permissions","View existing roles and their permissions",'Click "Add Role" to create a custom role',"Select which modules/features the role can access","Assign the role to users"],tips:["Follow principle of least privilege","Create specific roles for different staff types","Review permissions periodically"]},students:{name:"Students",icon:Qs,category:"Academic",color:"#06b6d4",description:"View and manage all enrolled students with their profiles and academic records.",roles:["admin","teacher"],features:["Complete student directory","Student profile with photo","Academic history","Attendance records","Fee payment status","Parent/guardian information","Document management"],howToUse:["Navigate to Academic  Students","Use search and filters to find students","Click on a student to view full profile","View academic records, attendance, and fees","Update student information as needed"],tips:["Keep student photos updated","Verify parent contact information","Use filters to find students by class/section"]},admissions:{name:"Admissions",icon:Qs,category:"Academic",color:"#06b6d4",description:"Handle student admission applications from submission to enrollment.",roles:["admin","admissions"],features:["View pending applications","Review application documents","Approve or reject applications","Assign students to classes","Generate admission letters","Track application status","Parent communication"],howToUse:["Go to Academic  Admissions","View list of pending applications","Click on an application to review details","Check uploaded documents (birth certificate, photos, etc.)","Approve and assign to a class, or reject with reason","System notifies parent of decision"],tips:["Process applications in order of submission","Check class capacity before approving","Verify all required documents are present","Send notifications to parents after decisions"]},teachers:{name:"Teachers",icon:Rt,category:"Academic",color:"#06b6d4",description:"Manage teacher profiles, assignments, and qualifications.",roles:["admin","hr"],features:["Teacher directory","Profile management","Subject assignments","Class assignments","Qualification records","Performance tracking"],howToUse:["Navigate to Academic  Teachers","View all teachers in the system",'Click "Add Teacher" to register new staff',"Assign subjects and classes to teachers","View teacher profiles and assignments"],tips:["Keep qualifications updated","Balance class loads across teachers","Review assignments each term"]},classes:{name:"Classes",icon:il,category:"Academic",color:"#06b6d4",description:"Manage class levels, sections, and capacity.",roles:["admin"],features:["Create class levels (Grade 1, Grade 2, etc.)","Add sections (A, B, C)","Set class capacity","Assign class teachers","View enrolled students","Manage class settings"],howToUse:["Navigate to Academic  Classes",'Click "Add Class" to create a new class level',"Enter class name, code, and capacity","Add sections within each class","Assign a class teacher to each section"],tips:["Set up classes before the academic term begins","Set realistic capacity limits","Use consistent naming conventions"]},classSubjects:{name:"Class Curriculum",icon:as,category:"Academic",color:"#06b6d4",description:"Assign subjects to classes and manage curriculum.",roles:["admin"],features:["Assign subjects to classes","Set subject teachers","Define periods per week","Manage curriculum structure"],howToUse:["Go to Academic  Class Curriculum","Select a class to view/edit subjects","Add subjects from the subject library","Assign teachers to each subject","Set number of periods per week"],tips:["Ensure all core subjects are assigned","Balance teacher workloads","Review curriculum each academic year"]},subjects:{name:"Subjects",icon:V3,category:"Academic",color:"#06b6d4",description:"Define and manage academic subjects offered by the school.",roles:["admin"],features:["Create subjects with codes","Set subject types (core, elective)","Define credit hours","Subject descriptions","Prerequisite management"],howToUse:["Go to Academic  Subjects",'Click "Add Subject" to create new',"Enter subject name, code, and type","Set credit hours and description","Save and assign to classes"],tips:["Use consistent subject codes","Mark core vs elective subjects","Include clear descriptions"]},terms:{name:"Academic Terms",icon:Ot,category:"Academic",color:"#06b6d4",description:"Manage academic terms/semesters with dates and settings.",roles:["admin"],features:["Create academic terms","Set start/end dates","Set active term","Term-specific settings","Archive past terms"],howToUse:["Navigate to Academic  Terms",'Click "Add Term" to create new',"Enter term name, year, start and end dates",'Click "Set Active" when term begins',"Archive completed terms"],tips:["Only one term can be active at a time","Set up next term before current ends","Archive old terms to keep system clean"]},timetable:{name:"Timetable",icon:Wt,category:"Academic",color:"#06b6d4",description:"Create and manage class schedules and timetables.",roles:["admin"],features:["Visual timetable builder","Period management","Teacher availability","Room assignments","Conflict detection","Print/export timetables"],howToUse:["Go to Academic  Timetable","Select class and section","Define periods and break times","Drag and drop subjects into slots","Assign teachers and rooms","Check for conflicts and resolve"],tips:["Check teacher availability first","Spread difficult subjects across days","Include adequate break times"]},exams:{name:"Exams",icon:R1,category:"Academic",color:"#06b6d4",description:"Schedule and manage examinations.",roles:["admin"],features:["Create exam schedules","Define exam types (midterm, final)","Set exam dates and times","Room assignments","Invigilator assignments","Exam timetable generation"],howToUse:["Navigate to Academic  Exams",'Click "Create Exam Schedule"',"Select exam type and term","Add subjects with dates and times","Assign rooms and invigilators","Publish exam timetable"],tips:["Allow adequate time between exams","Check room capacity","Communicate schedule early to students"]},lms:{name:"Learning Management (LMS)",icon:al,category:"Academic",color:"#06b6d4",description:"Online learning platform with courses, content, and assessments.",roles:["admin","teacher"],features:["Course creation","Content upload (videos, documents)","Online assignments","Quizzes and tests","Discussion forums","Progress tracking"],howToUse:["Go to Academic  LMS","Create a course for your subject","Upload learning materials","Create assignments and quizzes","Monitor student progress","Provide feedback on submissions"],tips:["Organize content into modules","Use varied content types","Set clear deadlines"]},attendance:{name:"Attendance",icon:Wc,category:"Classroom",color:"#f59e0b",description:"Track and manage student attendance for classes.",roles:["admin","teacher"],features:["Daily attendance marking","Multiple status options (present, absent, late, excused)","Attendance history","Attendance reports","Pattern analysis","Parent notifications"],howToUse:["Go to Classroom  Attendance","Select your class and date","Mark each student as present, absent, late, or excused","Add notes for absences if known","Click Save to record attendance","View reports for patterns"],tips:["Take attendance at the start of each class","Note reasons for absences","Review weekly patterns to identify issues","Follow up on chronic absenteeism"]},grading:{name:"Grading",icon:Is,category:"Classroom",color:"#f59e0b",description:"Enter and manage student grades, assessments, and results.",roles:["admin","teacher"],features:["Enter CA scores","Enter exam marks","Automatic grade calculation","Grade scale configuration","Report card generation","Grade analytics","Publish results"],howToUse:["Navigate to Classroom  Grading","Select class, section, and subject","Enter continuous assessment scores","Enter examination scores","System calculates final grades automatically","Review and publish when ready"],tips:["Enter grades promptly after assessments","Double-check entries before publishing","Use analytics to identify struggling students","Keep backup of grades"]},homework:{name:"Homework",icon:as,category:"Classroom",color:"#f59e0b",description:"Assign and track homework for students.",roles:["admin","teacher","parent"],features:["Create homework assignments","Set due dates","Attach resources","Track submissions","Grade submissions","Provide feedback"],howToUse:["Go to Classroom  Homework",'Click "Create Homework"',"Enter title, description, and instructions","Attach any resources or files","Set the due date","Select target class(es)","Publish the assignment"],tips:["Give clear instructions","Set reasonable deadlines","Provide constructive feedback","Allow resubmissions when appropriate"]},finance:{name:"Finance Overview",icon:vs,category:"Finance",color:"#10b981",description:"Overview of financial status, collections, and pending payments.",roles:["admin","finance"],features:["Financial dashboard","Collection summary","Pending payments","Revenue trends","Expense tracking","Financial reports"],howToUse:["Navigate to Finance  Overview","View collection summary and trends","Check pending payments","Monitor revenue vs expenses","Generate financial reports"],tips:["Review dashboard daily","Follow up on overdue payments","Reconcile accounts regularly"]},feeStructure:{name:"Fee Structure",icon:aa,category:"Finance",color:"#10b981",description:"Define fee types, amounts, and payment structures for each class.",roles:["admin","finance"],features:["Create fee types (tuition, transport, etc.)","Set amounts per class level","Configure payment installments","Discount management","Scholarship setup","Fee templates"],howToUse:["Go to Finance  Fee Structure",'Click "Add Fee Type" to create new',"Enter fee name, category, and description","Set amounts for each class level","Configure installment options if needed","Set up discounts for siblings/scholarships"],tips:["Review fee structure before each term","Document any fee changes","Communicate changes to parents early"]},invoices:{name:"Invoices",icon:Kt,category:"Finance",color:"#10b981",description:"Generate and manage student fee invoices.",roles:["admin","finance"],features:["Generate invoices","Bulk invoice generation","Invoice templates","Send invoice notifications","Track invoice status","Print/email invoices"],howToUse:["Navigate to Finance  Invoices",'Click "Generate Invoices" for bulk creation',"Or create individual invoices","Select students and fee items","Set due date","Send notifications to parents"],tips:["Generate invoices at term start","Send reminders before due dates","Keep invoice records organized"]},payments:{name:"Payments",icon:vs,category:"Finance",color:"#10b981",description:"Record and track fee payments.",roles:["admin","finance"],features:["Record payments","Multiple payment methods","Payment receipts","Payment history","Partial payments","Payment reconciliation"],howToUse:["Go to Finance  Payments",'Click "Record Payment"',"Select student and invoice","Enter payment amount and method","Add payment reference if applicable","Generate and print receipt"],tips:["Record payments immediately","Always issue receipts","Reconcile daily"]},analytics:{name:"Analytics",icon:$s,category:"Advanced",color:"#8b5cf6",description:"Advanced analytics and insights across all school data.",roles:["admin","principal"],features:["Performance analytics","Trend analysis","Predictive insights","Custom dashboards","Data visualization","Export capabilities"],howToUse:["Navigate to Advanced  Analytics","Select analysis type","Choose date range and filters","View charts and insights","Export data as needed"],tips:["Use analytics for decision making","Track trends over time","Share insights with stakeholders"]},transport:{name:"Transport",icon:Qo,category:"Advanced",color:"#8b5cf6",description:"Manage school transport, routes, and vehicle tracking.",roles:["admin"],features:["Route management","Vehicle tracking","Driver management","Student transport assignments","Transport fees","GPS tracking"],howToUse:["Go to Advanced  Transport","Set up routes and stops","Add vehicles and drivers","Assign students to routes","Track vehicles in real-time"],tips:["Optimize routes for efficiency","Keep driver records updated","Communicate delays to parents"]},hrPayroll:{name:"HR & Payroll",icon:Pr,category:"Advanced",color:"#8b5cf6",description:"Human resources and payroll management for staff.",roles:["admin","hr"],features:["Employee management","Salary structure","Payroll processing","Leave management","Attendance tracking","Tax calculations","Payslip generation"],howToUse:["Navigate to Advanced  HR & Payroll","Set up employee records","Configure salary structures","Process monthly payroll","Manage leave requests","Generate payslips"],tips:["Keep employee records current","Process payroll on schedule","Maintain compliance with tax laws"]},biometric:{name:"Biometric",icon:Dd,category:"Advanced",color:"#8b5cf6",description:"Biometric attendance and access control integration.",roles:["admin"],features:["Fingerprint enrollment","Biometric attendance","Access control","Device management","Attendance sync"],howToUse:["Go to Advanced  Biometric","Configure biometric devices","Enroll student/staff fingerprints","Set up attendance sync","Monitor access logs"],tips:["Enroll multiple fingers per person","Clean devices regularly","Have backup attendance method"]},multiSchool:{name:"Multi-School",icon:mn,category:"Advanced",color:"#8b5cf6",description:"Manage multiple school branches from one system.",roles:["admin"],features:["Branch management","Centralized reporting","Cross-branch transfers","Unified settings","Branch-specific customization"],howToUse:["Navigate to Advanced  Multi-School","Add school branches","Configure branch settings","View consolidated reports","Manage cross-branch operations"],tips:["Standardize processes across branches","Use consolidated reports for oversight","Allow branch-specific customizations"]},aiFeatures:{name:"AI Features",icon:Jr,category:"Advanced",color:"#8b5cf6",description:"AI-powered insights, predictions, and automation.",roles:["admin","teacher"],features:["Performance predictions","At-risk student identification","Automated insights","Smart recommendations","Natural language queries","AI chatbot assistance"],howToUse:["Go to Advanced  AI Features","View AI-generated insights","Check at-risk student alerts","Use AI chatbot for help","Review recommendations"],tips:["Review AI insights regularly","Act on at-risk alerts promptly","Provide feedback to improve AI"]},messages:{name:"Messages",icon:wa,category:"Communication",color:"#ec4899",description:"Internal messaging system for school communication.",roles:["admin","teacher","parent"],features:["Send messages","Receive messages","Group messaging","Message history","Attachments"],howToUse:["Go to Communication  Messages",'Click "New Message"',"Select recipients","Compose message","Attach files if needed","Send"],tips:["Keep messages professional","Use groups for class-wide communication","Check messages regularly"]},whatsapp:{name:"WhatsApp Messaging",icon:zu,category:"Communication",color:"#ec4899",description:"Send notifications and updates via WhatsApp.",roles:["admin"],features:["WhatsApp integration","Bulk messaging","Template messages","Delivery tracking","Automated notifications"],howToUse:["Navigate to Communication  WhatsApp","Configure WhatsApp API","Create message templates","Select recipients","Send messages"],tips:["Use templates for common messages","Respect messaging limits","Track delivery status"]},sms:{name:"SMS Messaging",icon:er,category:"Communication",color:"#ec4899",description:"Send SMS notifications to parents and staff.",roles:["admin"],features:["SMS gateway integration","Bulk SMS","SMS templates","Delivery reports","Credit management"],howToUse:["Go to Communication  SMS","Configure SMS gateway","Create message templates","Select recipients","Send SMS"],tips:["Keep SMS short and clear","Monitor SMS credits","Use for urgent notifications"]},email:{name:"Email Messaging",icon:ra,category:"Communication",color:"#ec4899",description:"Send email communications to parents and staff.",roles:["admin"],features:["Email templates","Bulk email","HTML formatting","Attachments","Delivery tracking"],howToUse:["Navigate to Communication  Email","Configure email settings","Create email templates","Compose or use template","Select recipients and send"],tips:["Use professional templates","Include clear subject lines","Avoid spam triggers"]},reports:{name:"Reports Hub",icon:Fs,category:"Reports",color:"#64748b",description:"Central hub for all system reports.",roles:["admin","finance","principal"],features:["Academic reports","Financial reports","Student reports","Executive summaries","Custom reports","Export options"],howToUse:["Navigate to Reports","Select report category","Choose specific report","Set filters and date range","Generate and export"],tips:["Schedule regular reports","Use filters effectively","Export for offline analysis"]},bulkImport:{name:"Bulk Import",icon:Hr,category:"Reports",color:"#64748b",description:"Import data in bulk via CSV files.",roles:["admin"],features:["Student import","Teacher import","User import","Data validation","Error reporting","Template downloads"],howToUse:["Go to Reports  Bulk Import","Download CSV template","Fill in data following template format","Upload completed CSV","Review validation results","Confirm import"],tips:["Always use provided templates","Validate data before upload","Start with small batches"]},systemLogs:{name:"System Logs",icon:Ir,category:"Reports",color:"#64748b",description:"View system activity and audit logs.",roles:["admin"],features:["Activity logs","Login history","Change tracking","Error logs","Security events"],howToUse:["Navigate to Reports  System Logs","Filter by date, user, or action","View log details","Export logs if needed"],tips:["Review logs regularly","Investigate unusual activity","Archive old logs"]},systemConfig:{name:"System Configuration",icon:$1,category:"System",color:"#64748b",description:"Configure system-wide settings and preferences.",roles:["admin"],features:["School information","Logo and branding","Academic settings","Notification settings","Email configuration","System preferences"],howToUse:["Go to System  System Configuration","Update school name, address, contact","Upload school logo","Configure academic year settings","Set up email/SMS gateways","Save changes"],tips:["Complete all settings during setup","Keep information current","Test notification settings"]},systemReset:{name:"System Reset",icon:Ns,category:"System",color:"#64748b",description:"Reset system data for new academic year or fresh start.",roles:["admin"],features:["Selective data reset","Academic year rollover","Data backup","Archive old data"],howToUse:["Navigate to System  System Reset","Select what to reset","Create backup first","Confirm reset action","System processes reset"],tips:["ALWAYS backup before reset","Use for academic year transitions","Test in staging first if possible"]}},g1=[{id:"system_setup",name:"New School Setup Guide",icon:wh,description:"Complete step-by-step guide to set up your school from scratch",steps:[{title:"Configure School Info",description:"Go to System Configuration. Enter school name, address, phone, email. Upload school logo.",role:"Admin"},{title:"Create Academic Terms",description:"Go to Academic  Terms. Create your first term with start/end dates. Set it as active.",role:"Admin"},{title:"Set Up Classes",description:"Go to Academic  Classes. Create all class levels (Grade 1, 2, 3, etc.). Add sections (A, B, C) to each class.",role:"Admin"},{title:"Create Subjects",description:"Go to Academic  Subjects. Add all subjects offered (Math, English, Science, etc.).",role:"Admin"},{title:"Assign Subjects to Classes",description:"Go to Academic  Class Curriculum. For each class, assign the subjects that will be taught.",role:"Admin"},{title:"Set Up Fee Structure",description:"Go to Finance  Fee Structure. Create fee types (Tuition, Transport, etc.). Set amounts for each class.",role:"Admin"},{title:"Add Staff Users",description:"Go to User Management  Users. Create accounts for teachers, finance staff, admissions staff.",role:"Admin"},{title:"Assign Teachers",description:"Go to Academic  Teachers. Assign subjects and classes to each teacher.",role:"Admin"},{title:"Configure Notifications",description:"Go to System Configuration  Notifications. Set up email/SMS gateways if needed.",role:"Admin"},{title:"Ready for Admissions",description:"System is now ready! Parents can register and apply for admission.",role:"System"}]},{id:"admission_enrollment",name:"Admission to Enrollment",icon:Qs,description:"Complete process from application to student enrollment",steps:[{title:"Parent Registers",description:"Parent creates an account on the system",role:"Parent"},{title:"Submit Application",description:"Parent fills admission form, uploads documents (birth certificate, photos, previous reports)",role:"Parent"},{title:"Review Application",description:"Admissions staff reviews application and verifies documents",role:"Admissions"},{title:"Approve/Reject",description:"Decision made on application. If rejected, reason is provided.",role:"Admissions"},{title:"Assign Class",description:"Approved student is assigned to appropriate class and section",role:"Admin"},{title:"Generate Invoice",description:"Fee invoice is automatically generated based on class fee structure",role:"System"},{title:"Payment",description:"Parent views invoice and makes payment via available methods",role:"Parent"},{title:"Enrollment Complete",description:"Student is fully enrolled and appears in class roster",role:"System"}]},{id:"term_setup",name:"New Term/Semester Setup",icon:Ot,description:"How to prepare the system for a new academic term",steps:[{title:"Create New Term",description:"Go to Academic  Terms. Click Add Term. Enter name, year, start and end dates.",role:"Admin"},{title:"Review Fee Structure",description:"Check if fee amounts need updating for the new term. Update if necessary.",role:"Admin"},{title:"Promote Students (if new year)",description:"If starting a new academic year, promote students to next class level.",role:"Admin"},{title:"Update Class Assignments",description:"Review and update teacher-class-subject assignments if needed.",role:"Admin"},{title:"Set Term as Active",description:"When ready to start, set the new term as active. Previous term becomes inactive.",role:"Admin"},{title:"Generate Invoices",description:"Generate fee invoices for all enrolled students for the new term.",role:"Finance"},{title:"Notify Parents",description:"Send notifications to parents about new term and pending fees.",role:"System"}]},{id:"grade_entry",name:"Grade Entry Process",icon:Fs,description:"How grades are entered and results published",steps:[{title:"Enter CA Scores",description:"Teacher goes to Grading, selects class/subject, enters continuous assessment scores",role:"Teacher"},{title:"Enter Exam Scores",description:"After exams, teacher enters examination scores for each student",role:"Teacher"},{title:"Calculate Grades",description:"System automatically calculates final grades based on CA + Exam weights",role:"System"},{title:"Review Results",description:"Admin/Principal reviews results for accuracy and completeness",role:"Admin"},{title:"Publish Results",description:"Admin publishes results, making them visible to parents",role:"Admin"},{title:"Generate Report Cards",description:"System generates printable report cards for each student",role:"System"},{title:"Parent Views Results",description:"Parents can view and download their children's report cards",role:"Parent"}]},{id:"fee_collection",name:"Fee Collection",icon:vs,description:"From fee structure setup to payment collection",steps:[{title:"Setup Fee Structure",description:"Define fee types (Tuition, Transport, Uniform, etc.) and amounts per class",role:"Admin"},{title:"Generate Invoices",description:"Create invoices for enrolled students - can be done in bulk",role:"Finance"},{title:"Send Notifications",description:"System sends invoice notifications to parents via email/SMS",role:"System"},{title:"Parent Views Invoice",description:"Parent logs in and views pending invoice with breakdown",role:"Parent"},{title:"Make Payment",description:"Parent pays via mobile money, bank transfer, or at school office",role:"Parent"},{title:"Record Payment",description:"Finance staff records the payment against the invoice",role:"Finance"},{title:"Issue Receipt",description:"System generates receipt which parent can download/print",role:"System"},{title:"Track Outstanding",description:"Finance monitors outstanding balances and sends reminders",role:"Finance"}]},{id:"daily_attendance",name:"Daily Attendance Workflow",icon:Wc,description:"How to take and manage daily attendance",steps:[{title:"Open Attendance",description:"Teacher goes to Attendance module and selects their class",role:"Teacher"},{title:"Select Date",description:"Choose today's date (defaults to current date)",role:"Teacher"},{title:"Mark Students",description:"For each student, mark as Present, Absent, Late, or Excused",role:"Teacher"},{title:"Add Notes",description:'Add notes for absences if reason is known (e.g., "Sick", "Family emergency")',role:"Teacher"},{title:"Save Attendance",description:"Click Save to record the attendance for the day",role:"Teacher"},{title:"Parent Notification",description:"Parents of absent students receive automatic notification",role:"System"},{title:"Review Reports",description:"Admin can view attendance reports and identify patterns",role:"Admin"}]}],RH=[{category:"Getting Started",questions:[{q:"How do I log in to the system?",a:'Use your email and password provided by the school administrator. If you forgot your password, click "Forgot Password" on the login page.'},{q:"How do I change my password?",a:'Go to your Profile settings and click "Change Password". Enter your current password and your new password.'},{q:"What should I do if I cannot access certain features?",a:"Your access depends on your role. Contact your administrator if you believe you should have access to a feature."}]},{category:"For Parents",questions:[{q:"How do I apply for admission?",a:'Click "Apply for Admission" in your dashboard, fill in the required information, upload documents, and submit.'},{q:"How do I pay school fees?",a:'Go to Invoices, select the pending invoice, and click "Pay Now". You can pay via mobile money or bank transfer.'},{q:"How do I view my child's results?",a:"Navigate to Results in your dashboard. Select your child and the term to view their report card."}]},{category:"For Teachers",questions:[{q:"How do I take attendance?",a:"Go to Attendance, select your class and date, mark each student, and save."},{q:"How do I enter grades?",a:"Navigate to Grading, select your class and subject, enter scores for each student, and save."},{q:"How do I assign homework?",a:'Go to Homework, click "Create Homework", fill in details, select the class, and publish.'}]},{category:"For Administrators",questions:[{q:"How do I add a new user?",a:'Go to Users, click "Add User", fill in the details, assign a role, and save.'},{q:"How do I set up a new academic term?",a:'Navigate to Academic Terms, click "Add Term", enter dates and details, and save. Set it as active when ready.'},{q:"How do I generate reports?",a:"Go to Reports, select the report type, set filters and date range, and click Generate."}]}],MH=t=>{const s={admin:[{label:"Add User",path:"/admin/users",icon:Rt},{label:"View Admissions",path:"/admin/admissions",icon:Qs},{label:"Manage Classes",path:"/admin/classes",icon:il},{label:"System Settings",path:"/admin/system-config",icon:Ka}],teacher:[{label:"My Classes",path:"/teacher/classes",icon:il},{label:"Take Attendance",path:"/teacher/attendance",icon:Wc},{label:"Enter Grades",path:"/teacher/grading",icon:Fs},{label:"Assign Homework",path:"/teacher/homework",icon:Kt}],parent:[{label:"My Children",path:"/parent/dashboard",icon:Rt},{label:"Apply for Admission",path:"/parent/apply",icon:Qs},{label:"View Invoices",path:"/parent/invoices",icon:aa},{label:"View Results",path:"/parent/results",icon:Fs}],finance:[{label:"Finance Dashboard",path:"/finance/dashboard",icon:aa},{label:"Pending Invoices",path:"/admin/invoices",icon:Wt},{label:"Record Payment",path:"/admin/payments",icon:vs},{label:"Financial Reports",path:"/admin/reports/financial",icon:Fs}]};return s[t]||s.parent};function jm(){const{user:t}=Us(),s=t?.user_type||t?.role||"parent",[a,r]=h.useState(""),[l,c]=h.useState(null),[o,m]=h.useState(null),[u,x]=h.useState(null),[A,g]=h.useState("setup"),N=MH(s),f=Object.entries(A1).filter(([v,U])=>{if(!a)return!0;const D=a.toLowerCase();return U.name.toLowerCase().includes(D)||U.description.toLowerCase().includes(D)||U.category.toLowerCase().includes(D)}),y=Object.entries(A1).filter(([v,U])=>U.roles.includes(s));return e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl p-8 text-white mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(Ac,{className:"w-10 h-10"}),e.jsx("h1",{className:"text-3xl font-bold",children:"Help Center"})]}),e.jsx("p",{className:"text-indigo-100 mb-6 max-w-2xl",children:"Learn how to use each module in the system and understand how they work together"}),e.jsxs("div",{className:"relative max-w-xl",children:[e.jsx(Ws,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search for help topics...",value:a,onChange:v=>r(v.target.value),className:"w-full pl-12 pr-4 py-3 rounded-full bg-white text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-white/50"})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(Xu,{className:"w-5 h-5 text-indigo-600"}),"Quick Actions for ",s.charAt(0).toUpperCase()+s.slice(1)]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:N.map((v,U)=>e.jsxs(dn,{to:v.path,className:"flex items-center gap-3 p-4 bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 hover:border-indigo-500 hover:shadow-lg transition-all",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-500 rounded-lg flex items-center justify-center text-white",children:e.jsx(v.icon,{className:"w-5 h-5"})}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:v.label})]},U))})]}),e.jsx("div",{className:"flex gap-2 mb-6 border-b border-gray-200 dark:border-gray-700 overflow-x-auto",children:[{id:"setup",label:"Getting Started",icon:wh},{id:"modules",label:"All Modules",icon:as},{id:"workflows",label:"Workflows",icon:AF},{id:"faq",label:"FAQ",icon:Ac}].map(v=>e.jsxs("button",{onClick:()=>g(v.id),className:`flex items-center gap-2 px-4 py-3 font-medium transition-colors border-b-2 -mb-px ${A===v.id?"text-indigo-600 border-indigo-600":"text-gray-500 border-transparent hover:text-gray-700"}`,children:[e.jsx(v.icon,{className:"w-4 h-4"}),v.label]},v.id))}),A==="setup"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-emerald-600 rounded-2xl p-6 text-white mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(wh,{className:"w-8 h-8"}),e.jsx("h2",{className:"text-2xl font-bold",children:"New School Setup Guide"})]}),e.jsx("p",{className:"opacity-90",children:"Follow these steps to set up your school management system from scratch"})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:e.jsx("div",{className:"relative",children:g1.find(v=>v.id==="system_setup")?.steps.map((v,U)=>e.jsxs("div",{className:"relative pl-10 pb-8 last:pb-0",children:[U<9&&e.jsx("div",{className:"absolute left-4 top-8 w-0.5 h-full bg-gradient-to-b from-green-500 to-emerald-500"}),e.jsx("div",{className:"absolute left-0 top-0 w-8 h-8 bg-gradient-to-br from-green-500 to-emerald-600 text-white rounded-full flex items-center justify-center font-bold text-sm",children:U+1}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:v.title}),e.jsx("span",{className:"text-xs px-2 py-1 bg-green-100 dark:bg-green-900 text-green-600 dark:text-green-400 rounded-full",children:v.role})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm",children:v.description})]})]},U))})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(DA,{className:"w-5 h-5 text-green-500"}),"Setup Checklist"]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-3",children:[{item:"School name and logo configured",link:"/admin/system-config"},{item:"Academic term created and activated",link:"/admin/terms"},{item:"Classes and sections set up",link:"/admin/classes"},{item:"Subjects created",link:"/admin/subjects"},{item:"Subjects assigned to classes",link:"/admin/class-subjects"},{item:"Fee structure configured",link:"/admin/fee-structure"},{item:"Teacher accounts created",link:"/admin/teachers"},{item:"Teachers assigned to classes",link:"/admin/teachers"}].map((v,U)=>e.jsxs(dn,{to:v.link,className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 dark:border-gray-600 rounded flex items-center justify-center",children:e.jsx(DA,{className:"w-4 h-4 text-gray-300 dark:text-gray-600"})}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300 flex-1",children:v.item}),e.jsx(cr,{className:"w-4 h-4 text-gray-400"})]},U))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(al,{className:"w-5 h-5 text-indigo-600"}),"Video Tutorials"]}),e.jsx("div",{className:"grid md:grid-cols-3 gap-4",children:[{title:"System Overview",duration:"5 min"},{title:"Setting Up Classes",duration:"3 min"},{title:"Managing Admissions",duration:"4 min"}].map((v,U)=>e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-700 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-indigo-100 dark:bg-indigo-900 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(Qi,{className:"w-6 h-6 text-indigo-600 dark:text-indigo-400"})}),e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white text-sm",children:v.title}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:v.duration})]},U))}),e.jsx("p",{className:"text-center text-gray-500 text-sm mt-4",children:"Video tutorials coming soon!"})]})]}),A==="modules"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Modules Available to You"}),e.jsx("div",{className:"grid gap-3",children:y.map(([v,U])=>e.jsx("button",{onClick:()=>c(l===v?null:v),className:"w-full text-left",children:e.jsxs("div",{className:`p-4 bg-white dark:bg-gray-800 rounded-xl border transition-all ${l===v?"border-indigo-500 shadow-lg":"border-gray-200 dark:border-gray-700 hover:border-indigo-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-white",style:{backgroundColor:U.color},children:e.jsx(U.icon,{className:"w-6 h-6"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:U.name}),e.jsx("p",{className:"text-sm text-gray-500",children:U.description})]}),e.jsx(un,{className:`w-5 h-5 text-gray-400 transition-transform ${l===v?"rotate-180":""}`})]}),l===v&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100 dark:border-gray-700 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h5",{className:"font-medium text-gray-900 dark:text-white mb-2 flex items-center gap-2",children:[e.jsx(Ln,{className:"w-4 h-4 text-indigo-600"})," Key Features"]}),e.jsx("ul",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:U.features.map((D,M)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm text-gray-600 dark:text-gray-300",children:[e.jsx(DA,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),D]},M))})]}),e.jsxs("div",{children:[e.jsxs("h5",{className:"font-medium text-gray-900 dark:text-white mb-2 flex items-center gap-2",children:[e.jsx(Qi,{className:"w-4 h-4 text-indigo-600"})," How to Use"]}),e.jsx("ol",{className:"space-y-2",children:U.howToUse.map((D,M)=>e.jsxs("li",{className:"flex items-start gap-3 text-sm text-gray-600 dark:text-gray-300",children:[e.jsx("span",{className:"w-6 h-6 bg-indigo-100 dark:bg-indigo-900 text-indigo-600 dark:text-indigo-400 rounded-full flex items-center justify-center flex-shrink-0 font-medium",children:M+1}),D]},M))})]}),e.jsxs("div",{children:[e.jsxs("h5",{className:"font-medium text-gray-900 dark:text-white mb-2 flex items-center gap-2",children:[e.jsx(Sm,{className:"w-4 h-4 text-yellow-500"})," Tips"]}),e.jsx("ul",{className:"space-y-1",children:U.tips.map((D,M)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm text-gray-600 dark:text-gray-300",children:[e.jsx("span",{className:"text-yellow-500",children:""}),D]},M))})]})]})]})},v))})]}),a&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Search Results"}),e.jsx("div",{className:"grid gap-3",children:f.map(([v,U])=>e.jsx("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center text-white",style:{backgroundColor:U.color},children:e.jsx(U.icon,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:U.name}),e.jsx("p",{className:"text-sm text-gray-500",children:U.category})]})]})},v))})]})]}),A==="workflows"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Understand how different modules work together to complete common tasks."}),e.jsx("div",{className:"grid gap-4",children:g1.map(v=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsxs("button",{onClick:()=>m(o===v.id?null:v.id),className:"w-full p-4 flex items-center gap-4 text-left",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-indigo-500 to-purple-500 rounded-xl flex items-center justify-center text-white",children:e.jsx(v.icon,{className:"w-6 h-6"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:v.name}),e.jsx("p",{className:"text-sm text-gray-500",children:v.description})]}),e.jsx(un,{className:`w-5 h-5 text-gray-400 transition-transform ${o===v.id?"rotate-180":""}`})]}),o===v.id&&e.jsx("div",{className:"px-4 pb-4",children:e.jsx("div",{className:"relative pl-8 space-y-4",children:v.steps.map((U,D)=>e.jsxs("div",{className:"relative",children:[D<v.steps.length-1&&e.jsx("div",{className:"absolute left-[-20px] top-8 w-0.5 h-full bg-indigo-200 dark:bg-indigo-800"}),e.jsx("div",{className:"absolute left-[-24px] top-1 w-2 h-2 bg-indigo-500 rounded-full"}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h5",{className:"font-medium text-gray-900 dark:text-white",children:U.title}),e.jsx("span",{className:"text-xs px-2 py-1 bg-indigo-100 dark:bg-indigo-900 text-indigo-600 dark:text-indigo-400 rounded-full",children:U.role})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:U.description})]})]},D))})})]},v.id))})]}),A==="faq"&&e.jsx("div",{className:"space-y-6",children:RH.map((v,U)=>e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:v.category}),e.jsx("div",{className:"space-y-2",children:v.questions.map((D,M)=>{const K=`${U}-${M}`;return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsxs("button",{onClick:()=>x(u===K?null:K),className:"w-full p-4 flex items-center gap-3 text-left",children:[e.jsx(Ac,{className:"w-5 h-5 text-indigo-600 flex-shrink-0"}),e.jsx("span",{className:"flex-1 font-medium text-gray-900 dark:text-white",children:D.q}),e.jsx(un,{className:`w-5 h-5 text-gray-400 transition-transform ${u===K?"rotate-180":""}`})]}),u===K&&e.jsx("div",{className:"px-4 pb-4 pl-12",children:e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:D.a})})]},M)})})]},U))}),e.jsxs("div",{className:"mt-12 bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl p-8 text-center text-white",children:[e.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(wa,{className:"w-8 h-8"})}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"Still Need Help?"}),e.jsx("p",{className:"text-indigo-100 mb-4",children:"Contact your school administrator for additional support"})]})]})}function vm({children:t,allowedRoles:s}){const{isAuthenticated:a,user:r}=Us();if(!a)return e.jsx(pc,{to:"/login",replace:!0});const l=r?.user_type||r?.role||r?.type;return s&&!s.includes(l)?(console.log("Access denied - User role:",l,"Allowed roles:",s),e.jsx(pc,{to:"/unauthorized",replace:!0})):t}function IH(){return e.jsxs(d3,{children:[e.jsx(XE,{}),e.jsxs($6,{children:[e.jsx(Ut,{path:"/login",element:e.jsx(e7,{})}),e.jsx(Ut,{path:"/register",element:e.jsx(t7,{})}),e.jsx(Ut,{path:"/activate",element:e.jsx(a7,{})}),e.jsx(Ut,{path:"/forgot-password",element:e.jsx(s7,{})}),e.jsx(Ut,{path:"/unauthorized",element:e.jsx(QH,{})}),e.jsxs(Ut,{path:"/admin",element:e.jsx(vm,{allowedRoles:["admin"],children:e.jsx(pm,{})}),children:[e.jsx(Ut,{path:"dashboard",element:e.jsx(m7,{})}),e.jsx(Ut,{path:"users",element:e.jsx(x7,{})}),e.jsx(Ut,{path:"students",element:e.jsx(p7,{})}),e.jsx(Ut,{path:"students/:studentId",element:e.jsx(f7,{})}),e.jsx(Ut,{path:"admissions",element:e.jsx(b7,{})}),e.jsx(Ut,{path:"classes",element:e.jsx(y7,{})}),e.jsx(Ut,{path:"class-subjects",element:e.jsx(j7,{})}),e.jsx(Ut,{path:"education-levels",element:e.jsx(v7,{})}),e.jsx(Ut,{path:"subjects",element:e.jsx(N7,{})}),e.jsx(Ut,{path:"terms",element:e.jsx(w7,{})}),e.jsx(Ut,{path:"teachers",element:e.jsx(_7,{})}),e.jsx(Ut,{path:"teachers/:teacherId",element:e.jsx(C7,{})}),e.jsx(Ut,{path:"finance",element:e.jsx(S7,{})}),e.jsx(Ut,{path:"fee-structure",element:e.jsx(k7,{})}),e.jsx(Ut,{path:"invoices",element:e.jsx(B7,{})}),e.jsx(Ut,{path:"payments",element:e.jsx(F7,{})}),e.jsx(Ut,{path:"attendance",element:e.jsx(E7,{})}),e.jsx(Ut,{path:"grading",element:e.jsx(D7,{})}),e.jsx(Ut,{path:"homework",element:e.jsx(U7,{})}),e.jsx(Ut,{path:"roles",element:e.jsx(T7,{})}),e.jsx(Ut,{path:"reports",element:e.jsx(uT,{})}),e.jsx(Ut,{path:"reports/academic",element:e.jsx(xT,{})}),e.jsx(Ut,{path:"reports/financial",element:e.jsx(hT,{})}),e.jsx(Ut,{path:"reports/students",element:e.jsx(pT,{})}),e.jsx(Ut,{path:"reports/executive",element:e.jsx(AT,{})}),e.jsx(Ut,{path:"timetable",element:e.jsx(gT,{})}),e.jsx(Ut,{path:"exams",element:e.jsx(fT,{})}),e.jsx(Ut,{path:"lms",element:e.jsx(bT,{})}),e.jsx(Ut,{path:"analytics",element:e.jsx(yT,{})}),e.jsx(Ut,{path:"transport",element:e.jsx(jT,{})}),e.jsx(Ut,{path:"hr-payroll",element:e.jsx(vT,{})}),e.jsx(Ut,{path:"biometric",element:e.jsx(NT,{})}),e.jsx(Ut,{path:"multi-school",element:e.jsx(wT,{})}),e.jsx(Ut,{path:"ai-features",element:e.jsx(_T,{})}),e.jsx(Ut,{path:"advanced-analytics",element:e.jsx(CT,{})}),e.jsx(Ut,{path:"hr-management",element:e.jsx(ST,{})}),e.jsx(Ut,{path:"alumni",element:e.jsx(kT,{})}),e.jsx(Ut,{path:"integrations",element:e.jsx(BT,{})}),e.jsx(Ut,{path:"report-builder",element:e.jsx(FT,{})}),e.jsx(Ut,{path:"video-conferencing",element:e.jsx(ET,{})}),e.jsx(Ut,{path:"settings",element:e.jsx(pc,{to:"/admin/system-config",replace:!0})}),e.jsx(Ut,{path:"import",element:e.jsx(L7,{})}),e.jsx(Ut,{path:"system-config",element:e.jsx(dT,{})}),e.jsx(Ut,{path:"system-reset",element:e.jsx(mT,{})}),e.jsx(Ut,{path:"logs",element:e.jsx(oT,{})}),e.jsx(Ut,{path:"comprehensive-dashboard",element:e.jsx(UT,{})}),e.jsx(Ut,{path:"dashboard-selector",element:e.jsx(IT,{})}),e.jsx(Ut,{path:"profile",element:e.jsx(eb,{})}),e.jsx(Ut,{path:"notifications",element:e.jsx(tb,{})}),e.jsx(Ut,{path:"messages",element:e.jsx(LH,{})}),e.jsx(Ut,{path:"whatsapp",element:e.jsx(DH,{})}),e.jsx(Ut,{path:"sms",element:e.jsx(UH,{})}),e.jsx(Ut,{path:"email",element:e.jsx(TH,{})}),e.jsx(Ut,{path:"help",element:e.jsx(jm,{})}),e.jsx(Ut,{index:!0,element:e.jsx(pc,{to:"dashboard",replace:!0})})]}),e.jsxs(Ut,{path:"/principal",element:e.jsx(vm,{allowedRoles:["principal","admin"],children:e.jsx(pm,{})}),children:[e.jsx(Ut,{path:"dashboard",element:e.jsx(HT,{})}),e.jsx(Ut,{path:"help",element:e.jsx(jm,{})}),e.jsx(Ut,{index:!0,element:e.jsx(pc,{to:"dashboard",replace:!0})})]}),e.jsxs(Ut,{path:"/hr",element:e.jsx(vm,{allowedRoles:["hr","admin"],children:e.jsx(pm,{})}),children:[e.jsx(Ut,{path:"dashboard",element:e.jsx(qT,{})}),e.jsx(Ut,{path:"help",element:e.jsx(jm,{})}),e.jsx(Ut,{index:!0,element:e.jsx(pc,{to:"dashboard",replace:!0})})]}),e.jsxs(Ut,{path:"/finance",element:e.jsx(vm,{allowedRoles:["finance","admin"],children:e.jsx(pm,{})}),children:[e.jsx(Ut,{path:"dashboard",element:e.jsx(XT,{})}),e.jsx(Ut,{path:"help",element:e.jsx(jm,{})}),e.jsx(Ut,{index:!0,element:e.jsx(pc,{to:"dashboard",replace:!0})})]}),e.jsxs(Ut,{path:"/student",element:e.jsx(vm,{allowedRoles:["student","admin"],children:e.jsx(pm,{})}),children:[e.jsx(Ut,{path:"dashboard",element:e.jsx(aL,{})}),e.jsx(Ut,{path:"help",element:e.jsx(jm,{})}),e.jsx(Ut,{index:!0,element:e.jsx(pc,{to:"dashboard",replace:!0})})]}),e.jsxs(Ut,{path:"/teacher",element:e.jsx(vm,{allowedRoles:["teacher","admin"],children:e.jsx(pm,{})}),children:[e.jsx(Ut,{path:"dashboard",element:e.jsx(tL,{})}),e.jsx(Ut,{path:"classes",element:e.jsx(xL,{})}),e.jsx(Ut,{path:"students",element:e.jsx(hL,{})}),e.jsx(Ut,{path:"attendance",element:e.jsx(pL,{})}),e.jsx(Ut,{path:"homework",element:e.jsx(AL,{})}),e.jsx(Ut,{path:"grading",element:e.jsx(gL,{})}),e.jsx(Ut,{path:"reports",element:e.jsx(G$,{})}),e.jsx(Ut,{path:"messages",element:e.jsx(fL,{})}),e.jsx(Ut,{path:"ai-insights",element:e.jsx(q$,{})}),e.jsx(Ut,{path:"hr-portal",element:e.jsx(K$,{})}),e.jsx(Ut,{path:"lesson-planning",element:e.jsx(V$,{})}),e.jsx(Ut,{path:"student-progress",element:e.jsx(Y$,{})}),e.jsx(Ut,{path:"behavior",element:e.jsx(W$,{})}),e.jsx(Ut,{path:"resources",element:e.jsx(X$,{})}),e.jsx(Ut,{path:"seating",element:e.jsx(J$,{})}),e.jsx(Ut,{path:"substitute",element:e.jsx(Z$,{})}),e.jsx(Ut,{path:"settings",element:e.jsx(bL,{})}),e.jsx(Ut,{path:"profile",element:e.jsx(eb,{})}),e.jsx(Ut,{path:"notifications",element:e.jsx(tb,{})}),e.jsx(Ut,{path:"help",element:e.jsx(jm,{})}),e.jsx(Ut,{index:!0,element:e.jsx(pc,{to:"dashboard",replace:!0})})]}),e.jsxs(Ut,{path:"/parent",element:e.jsx(vm,{allowedRoles:["parent","admin"],children:e.jsx(pm,{})}),children:[e.jsx(Ut,{path:"dashboard",element:e.jsx(p1,{})}),e.jsx(Ut,{path:"dashboard-old",element:e.jsx(cL,{})}),e.jsx(Ut,{path:"dashboard-pro",element:e.jsx(p1,{})}),e.jsx(Ut,{path:"apply",element:e.jsx(aH,{})}),e.jsx(Ut,{path:"child/:childId",element:e.jsx(rH,{})}),e.jsx(Ut,{path:"child/:childId/attendance",element:e.jsx(CH,{})}),e.jsx(Ut,{path:"child/:childId/grades",element:e.jsx(SH,{})}),e.jsx(Ut,{path:"child/:childId/homework",element:e.jsx(kH,{})}),e.jsx(Ut,{path:"child/:childId/teachers",element:e.jsx(BH,{})}),e.jsx(Ut,{path:"child/:childId/report-cards",element:e.jsx(FH,{})}),e.jsx(Ut,{path:"enroll",element:e.jsx(nH,{})}),e.jsx(Ut,{path:"invoices",element:e.jsx(lH,{})}),e.jsx(Ut,{path:"payments",element:e.jsx(cH,{})}),e.jsx(Ut,{path:"messages",element:e.jsx(oH,{})}),e.jsx(Ut,{path:"meetings",element:e.jsx(EH,{})}),e.jsx(Ut,{path:"settings",element:e.jsx(dH,{})}),e.jsx(Ut,{path:"homework",element:e.jsx(mH,{})}),e.jsx(Ut,{path:"results",element:e.jsx(uH,{})}),e.jsx(Ut,{path:"profile",element:e.jsx(eb,{})}),e.jsx(Ut,{path:"notifications",element:e.jsx(tb,{})}),e.jsx(Ut,{path:"help",element:e.jsx(jm,{})}),e.jsx(Ut,{index:!0,element:e.jsx(pc,{to:"dashboard",replace:!0})})]}),e.jsx(Ut,{path:"/",element:e.jsx(pc,{to:"/login",replace:!0})}),e.jsx(Ut,{path:"*",element:e.jsx("div",{className:"p-8",children:e.jsx("h1",{className:"text-2xl",children:"404 - Page Not Found"})})})]}),e.jsx(WE,{})]})}function $H(){const{applyTheme:t}=dy();return h.useEffect(()=>{t()},[]),e.jsx(IH,{})}qC.createRoot(document.getElementById("root")).render(e.jsx(h.StrictMode,{children:e.jsx($H,{})}));export{Ra as _,HH as c,QC as g};
